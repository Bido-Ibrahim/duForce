[
  {
    "Variable": "AGDEM",
    "UsesVariable": "FDEM",
    "Distance": 0,
    "Code": "\r\r'dsr 2015/03/25 comment out following code since FDEM(R%, 2 and 3) now calculated above (use '')\r'dsr 2015/03/04 *** Start\r'   All but First 2:  FDEM for Meat and Fish Calculate as residual\r'   ----------------------------------------------------------------------------\r''        For f% = 2 To 3\r''            FDEM(R%, f%) = AGDEM(R%, f%) - FEDDEM(R%, f%) - INDEM(R%, f%) - FMDEM(R%, f%) - LOSS(R%, f%)\r'jrs 2014/12/01\r''            FDEM(R%, f%) = AMAX(0.01, Amin(FDEM(R%, f%), 1000))\r''        Next f%\r'dsr 2015/03/04 *** End\r\r'dsr 2015/03/25 Calculate final values of AGDEM **** start\rFor f% = 1 To 3\rAGDEM(R%, f%) = FDEM(R%, f%) + FEDDEM(R%, f%) + INDEM(R%, f%) + FMDEM(R%, f%) + AGLOSSTRANS(R%, f%)\r'dsr 2015/03/27 In next line, lower min to 0.000001; up max to 10000 from 1000 for China\rAGDEM(R%, f%) = AMAX(0.000001, Amin(AGDEM(R%, f%), 10000))\rNext f%\r\r\r'dsr 2015/03/25 comment out following code since FDEM(R%, 2 and 3) now calculated above (use '')\r'dsr 2015/03/04 *** Start\r'   All but First 2:  FDEM for Meat and Fish Calculate as residual\r'   ----------------------------------------------------------------------------\r''        For f% = 2 To 3\r''            FDEM(R%, f%) = AGDEM(R%, f%) - FEDDEM(R%, f%) - INDEM(R%, f%) - FMDEM(R%, f%) - LOSS(R%, f%)\r'jrs 2014/12/01\r''            FDEM(R%, f%) = AMAX(0.01, Amin(FDEM(R%, f%), 1000))\r''        Next f%\r'dsr 2015/03/04 *** End\r\r'dsr 2015/03/25 Calculate final values of AGDEM **** start\rFor f% = 1 To 3\rAGDEM(R%, f%) = FDEM(R%, f%) + FEDDEM(R%, f%) + INDEM(R%, f%) + FMDEM(R%, f%) + AGLOSSTRANS(R%, f%)\r'dsr 2015/03/27 In next line, lower min to 0.000001; up max to 10000 from 1000 for China\rAGDEM(R%, f%) = AMAX(0.000001, Amin(AGDEM(R%, f%), 10000))\rNext f%\r'dsr 2015/03/25 Calculate final values of AGDEM **** end\r\r"
  },
  {
    "Variable": "AGDEM",
    "UsesVariable": "FEDDEM",
    "Distance": 0,
    "Code": "\r\r'dsr 2015/03/25 comment out following code since FDEM(R%, 2 and 3) now calculated above (use '')\r'dsr 2015/03/04 *** Start\r'   All but First 2:  FDEM for Meat and Fish Calculate as residual\r'   ----------------------------------------------------------------------------\r''        For f% = 2 To 3\r''            FDEM(R%, f%) = AGDEM(R%, f%) - FEDDEM(R%, f%) - INDEM(R%, f%) - FMDEM(R%, f%) - LOSS(R%, f%)\r'jrs 2014/12/01\r''            FDEM(R%, f%) = AMAX(0.01, Amin(FDEM(R%, f%), 1000))\r''        Next f%\r'dsr 2015/03/04 *** End\r\r'dsr 2015/03/25 Calculate final values of AGDEM **** start\rFor f% = 1 To 3\rAGDEM(R%, f%) = FDEM(R%, f%) + FEDDEM(R%, f%) + INDEM(R%, f%) + FMDEM(R%, f%) + AGLOSSTRANS(R%, f%)\r'dsr 2015/03/27 In next line, lower min to 0.000001; up max to 10000 from 1000 for China\rAGDEM(R%, f%) = AMAX(0.000001, Amin(AGDEM(R%, f%), 10000))\rNext f%\r"
  },
  {
    "Variable": "AGDEM",
    "UsesVariable": "INDEM",
    "Distance": 0,
    "Code": "\r\r'dsr 2015/03/25 comment out following code since FDEM(R%, 2 and 3) now calculated above (use '')\r'dsr 2015/03/04 *** Start\r'   All but First 2:  FDEM for Meat and Fish Calculate as residual\r'   ----------------------------------------------------------------------------\r''        For f% = 2 To 3\r''            FDEM(R%, f%) = AGDEM(R%, f%) - FEDDEM(R%, f%) - INDEM(R%, f%) - FMDEM(R%, f%) - LOSS(R%, f%)\r'jrs 2014/12/01\r''            FDEM(R%, f%) = AMAX(0.01, Amin(FDEM(R%, f%), 1000))\r''        Next f%\r'dsr 2015/03/04 *** End\r\r'dsr 2015/03/25 Calculate final values of AGDEM **** start\rFor f% = 1 To 3\rAGDEM(R%, f%) = FDEM(R%, f%) + FEDDEM(R%, f%) + INDEM(R%, f%) + FMDEM(R%, f%) + AGLOSSTRANS(R%, f%)\r'dsr 2015/03/27 In next line, lower min to 0.000001; up max to 10000 from 1000 for China\rAGDEM(R%, f%) = AMAX(0.000001, Amin(AGDEM(R%, f%), 10000))\rNext f%\r"
  },
  {
    "Variable": "AGDEM",
    "UsesVariable": "FMDEM",
    "Distance": 0,
    "Code": "\r\r'dsr 2015/03/25 comment out following code since FDEM(R%, 2 and 3) now calculated above (use '')\r'dsr 2015/03/04 *** Start\r'   All but First 2:  FDEM for Meat and Fish Calculate as residual\r'   ----------------------------------------------------------------------------\r''        For f% = 2 To 3\r''            FDEM(R%, f%) = AGDEM(R%, f%) - FEDDEM(R%, f%) - INDEM(R%, f%) - FMDEM(R%, f%) - LOSS(R%, f%)\r'jrs 2014/12/01\r''            FDEM(R%, f%) = AMAX(0.01, Amin(FDEM(R%, f%), 1000))\r''        Next f%\r'dsr 2015/03/04 *** End\r\r'dsr 2015/03/25 Calculate final values of AGDEM **** start\rFor f% = 1 To 3\rAGDEM(R%, f%) = FDEM(R%, f%) + FEDDEM(R%, f%) + INDEM(R%, f%) + FMDEM(R%, f%) + AGLOSSTRANS(R%, f%)\r'dsr 2015/03/27 In next line, lower min to 0.000001; up max to 10000 from 1000 for China\rAGDEM(R%, f%) = AMAX(0.000001, Amin(AGDEM(R%, f%), 10000))\rNext f%\r"
  },
  {
    "Variable": "AGDEM",
    "UsesVariable": "AGLOSSTRANS",
    "Distance": 0,
    "Code": "\r\r'dsr 2015/03/25 comment out following code since FDEM(R%, 2 and 3) now calculated above (use '')\r'dsr 2015/03/04 *** Start\r'   All but First 2:  FDEM for Meat and Fish Calculate as residual\r'   ----------------------------------------------------------------------------\r''        For f% = 2 To 3\r''            FDEM(R%, f%) = AGDEM(R%, f%) - FEDDEM(R%, f%) - INDEM(R%, f%) - FMDEM(R%, f%) - LOSS(R%, f%)\r'jrs 2014/12/01\r''            FDEM(R%, f%) = AMAX(0.01, Amin(FDEM(R%, f%), 1000))\r''        Next f%\r'dsr 2015/03/04 *** End\r\r'dsr 2015/03/25 Calculate final values of AGDEM **** start\rFor f% = 1 To 3\rAGDEM(R%, f%) = FDEM(R%, f%) + FEDDEM(R%, f%) + INDEM(R%, f%) + FMDEM(R%, f%) + AGLOSSTRANS(R%, f%)\r'dsr 2015/03/27 In next line, lower min to 0.000001; up max to 10000 from 1000 for China\rAGDEM(R%, f%) = AMAX(0.000001, Amin(AGDEM(R%, f%), 10000))\rNext f%\r"
  },
  {
    "Variable": "AGDEM",
    "UsesVariable": "AGP",
    "Distance": 0,
    "Code": "\r\r'dsr 2015/04/17 Produce estimate of initial stocks. Assume these are a given fraction of the sum of\r'             production and total domestic supply.\rFor f% = 1 To 3\r'dsr 2015/03/26 Losses now dealt with elsewhere\r''            LOSS(R%, f%) = 0\r''            LOSSI(R%, f%) = LOSS(R%, f%)\r'dsr 2015/06/19 Change next line since AGP now is post-production loss\r'          AGDEM(R%, f%) = AGP(R%, f%) * (1! - LOSS(R%, f%)) - AGX(R%, f%) + AGM(R%, f%)\rAGDEM(R%, f%) = AGP(R%, f%) - AGX(R%, f%) + AGM(R%, f%)\r'           If f% = 2 Then AGDEM(R%, f%) = AGDEM(R%, f%) + _\r'(FISH(R%) - AGX(R%, 3) + AGM(R%, 3)) * (1! - LOSS(R%, f%)) 'more recent version\r'If f% = 2 Then AGDEM(R%, f%) = AGDEM(R%, f%) + _\r' (FISH(R%) * (1! - LOSS(R%, f%) - AGX(R%, 3) + AGM(R%, 3)))\r'This might be better; need to fix in preprocessor also\r''            AGDEM(R%, f%) = AGDEM(R%, f%) - agdstl * (AGDEM(R%, f%) + AGP(R%, f%)) * igdpr(R%)\r'Estimated demand because stocks not yet known\rFSTOCK(R%, f%) = CSng((AGP(R%, f%) + AGDEM(R%, f%)) * agdstl) 'Using estimated demand\r''            AGDEM(R%, f%) = AGDEM(R%, f%) + FSTOCK(R%, f%) * igdpr(R%) 'Actual demand\rsagdem(R%, f%) = AGDEM(R%, f%)\r\r'jrs 2015/11/13 causes run to run\r''dsr 2015/11/02 Adjust FDEM, FEEDEM, FMDEM, INDEM, and AGLOSSTRANS so sum to AGDEM\r'            adjfactor = AGDEM(R%, f%) / (FDEM(R%, f%) + FEDDEM(R%, f%) + FMDEM(R%, f%) + INDEM(R%, f%) + AGLOSSTRANS(R%, f%))\r'            FDEM(R%, f%) = FDEM(R%, f%) * adjfactor\r'            FEDDEM(R%, f%) = FEDDEM(R%, f%) * adjfactor\r'            FMDEM(R%, f%) = FMDEM(R%, f%) * adjfactor\r'            INDEM(R%, f%) = INDEM(R%, f%) * adjfactor\r'            AGLOSSTRANS(R%, f%) = AGLOSSTRANS(R%, f%) * adjfactor\r'\r''dsr 2015/06/19 Save pre-loss production as potential production\r''               for later use\r'            SAGP(R%, f%) = AGPppl(R%, f%) this line is not needed\r'            agpp(R%, f%) = AGPppl(R%, f%)\r'            AGPPI(R%, f%) = AGPppl(R%, f%) this parameter is never used\r'            agdemgrma(R%, f%) = 0.03\r'            AGPGRMA(R%, f%) = 0.03\r\r'jrs 2021/01/08\r'Save initial AGM value for bilateral trade adjustment\riAGM(R%, f%) = AGM(R%, f%)\r\rNext f%\r"
  },
  {
    "Variable": "AGDEM",
    "UsesVariable": "AGX",
    "Distance": 0,
    "Code": "\r\r'dsr 2015/04/17 Produce estimate of initial stocks. Assume these are a given fraction of the sum of\r'             production and total domestic supply.\rFor f% = 1 To 3\r'dsr 2015/03/26 Losses now dealt with elsewhere\r''            LOSS(R%, f%) = 0\r''            LOSSI(R%, f%) = LOSS(R%, f%)\r'dsr 2015/06/19 Change next line since AGP now is post-production loss\r'          AGDEM(R%, f%) = AGP(R%, f%) * (1! - LOSS(R%, f%)) - AGX(R%, f%) + AGM(R%, f%)\rAGDEM(R%, f%) = AGP(R%, f%) - AGX(R%, f%) + AGM(R%, f%)\r'           If f% = 2 Then AGDEM(R%, f%) = AGDEM(R%, f%) + _\r'(FISH(R%) - AGX(R%, 3) + AGM(R%, 3)) * (1! - LOSS(R%, f%)) 'more recent version\r'If f% = 2 Then AGDEM(R%, f%) = AGDEM(R%, f%) + _\r' (FISH(R%) * (1! - LOSS(R%, f%) - AGX(R%, 3) + AGM(R%, 3)))\r'This might be better; need to fix in preprocessor also\r''            AGDEM(R%, f%) = AGDEM(R%, f%) - agdstl * (AGDEM(R%, f%) + AGP(R%, f%)) * igdpr(R%)\r'Estimated demand because stocks not yet known\rFSTOCK(R%, f%) = CSng((AGP(R%, f%) + AGDEM(R%, f%)) * agdstl) 'Using estimated demand\r''            AGDEM(R%, f%) = AGDEM(R%, f%) + FSTOCK(R%, f%) * igdpr(R%) 'Actual demand\rsagdem(R%, f%) = AGDEM(R%, f%)\r\r'jrs 2015/11/13 causes run to run\r''dsr 2015/11/02 Adjust FDEM, FEEDEM, FMDEM, INDEM, and AGLOSSTRANS so sum to AGDEM\r'            adjfactor = AGDEM(R%, f%) / (FDEM(R%, f%) + FEDDEM(R%, f%) + FMDEM(R%, f%) + INDEM(R%, f%) + AGLOSSTRANS(R%, f%))\r'            FDEM(R%, f%) = FDEM(R%, f%) * adjfactor\r'            FEDDEM(R%, f%) = FEDDEM(R%, f%) * adjfactor\r'            FMDEM(R%, f%) = FMDEM(R%, f%) * adjfactor\r'            INDEM(R%, f%) = INDEM(R%, f%) * adjfactor\r'            AGLOSSTRANS(R%, f%) = AGLOSSTRANS(R%, f%) * adjfactor\r'\r''dsr 2015/06/19 Save pre-loss production as potential production\r''               for later use\r'            SAGP(R%, f%) = AGPppl(R%, f%) this line is not needed\r'            agpp(R%, f%) = AGPppl(R%, f%)\r'            AGPPI(R%, f%) = AGPppl(R%, f%) this parameter is never used\r'            agdemgrma(R%, f%) = 0.03\r'            AGPGRMA(R%, f%) = 0.03\r\r'jrs 2021/01/08\r'Save initial AGM value for bilateral trade adjustment\riAGM(R%, f%) = AGM(R%, f%)\r\rNext f%\r"
  },
  {
    "Variable": "AGDEM",
    "UsesVariable": "AGM",
    "Distance": 0,
    "Code": "\r\r'dsr 2015/04/17 Produce estimate of initial stocks. Assume these are a given fraction of the sum of\r'             production and total domestic supply.\rFor f% = 1 To 3\r'dsr 2015/03/26 Losses now dealt with elsewhere\r''            LOSS(R%, f%) = 0\r''            LOSSI(R%, f%) = LOSS(R%, f%)\r'dsr 2015/06/19 Change next line since AGP now is post-production loss\r'          AGDEM(R%, f%) = AGP(R%, f%) * (1! - LOSS(R%, f%)) - AGX(R%, f%) + AGM(R%, f%)\rAGDEM(R%, f%) = AGP(R%, f%) - AGX(R%, f%) + AGM(R%, f%)\r'           If f% = 2 Then AGDEM(R%, f%) = AGDEM(R%, f%) + _\r'(FISH(R%) - AGX(R%, 3) + AGM(R%, 3)) * (1! - LOSS(R%, f%)) 'more recent version\r'If f% = 2 Then AGDEM(R%, f%) = AGDEM(R%, f%) + _\r' (FISH(R%) * (1! - LOSS(R%, f%) - AGX(R%, 3) + AGM(R%, 3)))\r'This might be better; need to fix in preprocessor also\r''            AGDEM(R%, f%) = AGDEM(R%, f%) - agdstl * (AGDEM(R%, f%) + AGP(R%, f%)) * igdpr(R%)\r'Estimated demand because stocks not yet known\rFSTOCK(R%, f%) = CSng((AGP(R%, f%) + AGDEM(R%, f%)) * agdstl) 'Using estimated demand\r''            AGDEM(R%, f%) = AGDEM(R%, f%) + FSTOCK(R%, f%) * igdpr(R%) 'Actual demand\rsagdem(R%, f%) = AGDEM(R%, f%)\r\r'jrs 2015/11/13 causes run to run\r''dsr 2015/11/02 Adjust FDEM, FEEDEM, FMDEM, INDEM, and AGLOSSTRANS so sum to AGDEM\r'            adjfactor = AGDEM(R%, f%) / (FDEM(R%, f%) + FEDDEM(R%, f%) + FMDEM(R%, f%) + INDEM(R%, f%) + AGLOSSTRANS(R%, f%))\r'            FDEM(R%, f%) = FDEM(R%, f%) * adjfactor\r'            FEDDEM(R%, f%) = FEDDEM(R%, f%) * adjfactor\r'            FMDEM(R%, f%) = FMDEM(R%, f%) * adjfactor\r'            INDEM(R%, f%) = INDEM(R%, f%) * adjfactor\r'            AGLOSSTRANS(R%, f%) = AGLOSSTRANS(R%, f%) * adjfactor\r'\r''dsr 2015/06/19 Save pre-loss production as potential production\r''               for later use\r'            SAGP(R%, f%) = AGPppl(R%, f%) this line is not needed\r'            agpp(R%, f%) = AGPppl(R%, f%)\r'            AGPPI(R%, f%) = AGPppl(R%, f%) this parameter is never used\r'            agdemgrma(R%, f%) = 0.03\r'            AGPGRMA(R%, f%) = 0.03\r\r'jrs 2021/01/08\r'Save initial AGM value for bilateral trade adjustment\riAGM(R%, f%) = AGM(R%, f%)\r\rNext f%\r"
  },
  {
    "Variable": "AGFISHCATCH",
    "UsesVariable": "fishcatchm",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "AGFISHCATCH",
    "UsesVariable": "aglossprodm",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "AGFISHCATCH",
    "UsesVariable": "GDPPCP",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "AGLOSSCONS",
    "UsesVariable": "FDEM",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "AGLOSSCONS",
    "UsesVariable": "aglossconsm",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "AGLOSSCONS",
    "UsesVariable": "GDPPCP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "AGLOSSPROD",
    "UsesVariable": "AQUACUL",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "AGLOSSPROD",
    "UsesVariable": "aquaculm",
    "Distance": 12,
    "Code": "\r'dsr 2015/06/09 Save total pre loss meat production as meat production potential for later use\r'        agpp(R%, 2) = AGPppl(R%, 2)\r'        SAGP(R%, 2) = AGP(R%, 2)\r\r'dsr 2015/06/09 FISH PRODUCTION\r'dsr 2015/06/09   AQUACULTURE\r'dsr 2015/06/09 Have growth rate decline from initial value to 0 over aquaculconv years\rDim aquaculgrcomp = ConvergeOverTime(aquaculgr(R%) / 100, 0, aquaculconv)\r"
  },
  {
    "Variable": "AGLOSSPROD",
    "UsesVariable": "aglossprodm",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "AGLOSSPROD",
    "UsesVariable": "fishcatchm",
    "Distance": 5,
    "Code": "\rAgFishCatchI(R%) = AGFISHCATCHppl(R%)\r"
  },
  {
    "Variable": "AGLOSSPROD",
    "UsesVariable": "aquaculgr",
    "Distance": 13,
    "Code": "\r'jrs 2024/06/11\r'Call XYTABL(\"GDP/Capita (PPP 2011) Versus Fish Production Losses (Log)\", GDPPCP(R%), aglossfishfunc, context)\rCall XYTABL(TFNameFishProdLoss, GDPPCP(R%), aglossfishfunc, context)\r"
  },
  {
    "Variable": "AGLOSSPROD",
    "UsesVariable": "aquaculconv",
    "Distance": 13,
    "Code": "\r'jrs 2024/06/11\r'Call XYTABL(\"GDP/Capita (PPP 2011) Versus Fish Production Losses (Log)\", GDPPCP(R%), aglossfishfunc, context)\rCall XYTABL(TFNameFishProdLoss, GDPPCP(R%), aglossfishfunc, context)\r"
  },
  {
    "Variable": "AGLOSSPROD",
    "UsesVariable": "GDPPCP",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "AGLOSSPROD",
    "UsesVariable": "AGFISHCATCH",
    "Distance": 316,
    "Code": "0"
  },
  {
    "Variable": "AGLOSSPROD",
    "UsesVariable": "LVHERD",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "AGLOSSPROD",
    "UsesVariable": "slr",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "AGLOSSPROD",
    "UsesVariable": "AGPMILKEGGS",
    "Distance": 321,
    "Code": "\rAGPppl(R%, 2) = AGP(R%, 2) / (1 - (aglossmeatperc / 100))\r"
  },
  {
    "Variable": "AGLOSSPROD",
    "UsesVariable": "AGP",
    "Distance": 323,
    "Code": "0"
  },
  {
    "Variable": "AGLOSSPROD",
    "UsesVariable": "YL",
    "Distance": 4,
    "Code": "\rDim aglossprodcrop = Amin(AMAX(aglossprodcropfunc * aglossprodm(R%, 1), 2), 20) 'Losses capped here\r\r'bbh 2022/11/28 End of code area changed subsantially to moderate year-to-year changes in yields by limiting annual change in % change\r'If IY% + 2016 >= 2035 And RegName$(R%) = \"Central African Republic\" Then Stop 'bbh 2022/12/13 Important debugging line in YL calculation\r\r'\r'   All but First 1:  Agricultural Production\r'   -----------------------------------------\r'dsr 2015/06/09 CROP PRODUCTION\r'dsr 2015/06/22 Compute pre loss production\r'dkb 2021/06/08 added * (1 - ldcropunusedshare(R%))\rAGPppl(R%, 1) = YL(R%) * LD(R%, 1) * (1 - ldcropunusedshare(R%))\r\r'kbn 2017/08/28 end\r'kbn 2017/09/13 Add multiplier below for crop production\rAGLOSSPROD(R%, 1) = AGPppl(R%, 1) * (aglossprodcrop / 100)\r"
  },
  {
    "Variable": "AGLOSSPROD",
    "UsesVariable": "LD",
    "Distance": 4,
    "Code": "\rDim aglossprodcrop = Amin(AMAX(aglossprodcropfunc * aglossprodm(R%, 1), 2), 20) 'Losses capped here\r"
  },
  {
    "Variable": "AGLOSSPROD",
    "UsesVariable": "ldcropunusedshare",
    "Distance": 4,
    "Code": "\rDim aglossprodcrop = Amin(AMAX(aglossprodcropfunc * aglossprodm(R%, 1), 2), 20) 'Losses capped here\r"
  },
  {
    "Variable": "AGLOSSTRANS",
    "UsesVariable": "AGDEM",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "AGLOSSTRANS",
    "UsesVariable": "FSTOCK",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "AGLOSSTRANS",
    "UsesVariable": "AGP",
    "Distance": 33,
    "Code": "0"
  },
  {
    "Variable": "AGLOSSTRANS",
    "UsesVariable": "AGX",
    "Distance": 32,
    "Code": "\r\r'   First Year:  Profits and Prices\r'   -------------------------------\r\rFor f% = 1 To 3\rFPROFITR(R%, f%) = 1\rsfprofitr(R%, f%) = 1\rSSFProfitR(R%, f%) = 1\rsbalance(R%, f%) = 0\rSBalanceForYl(R%) = 0 'bbh 2022/11/28\rcumstk(R%, f%) = FSTOCK(R%, f%)\rscumstk(R%, f%) = cumstk(R%, f%)\rCumStkNegOK(R%, f%) = FSTOCK(R%, f%) 'bbh 2022/10/27 Added 2 lines allowing Negative Stocks\rSCumStkNegOK(R%, f%) = CumStkNegOK(R%, f%)\rscountryextrasurdef(R%, f%) = 0  'For trade adjustment\rNext f%\r"
  },
  {
    "Variable": "AGLOSSTRANS",
    "UsesVariable": "AGM",
    "Distance": 32,
    "Code": "\r\r'   First Year:  Profits and Prices\r'   -------------------------------\r\rFor f% = 1 To 3\rFPROFITR(R%, f%) = 1\rsfprofitr(R%, f%) = 1\rSSFProfitR(R%, f%) = 1\rsbalance(R%, f%) = 0\rSBalanceForYl(R%) = 0 'bbh 2022/11/28\rcumstk(R%, f%) = FSTOCK(R%, f%)\rscumstk(R%, f%) = cumstk(R%, f%)\rCumStkNegOK(R%, f%) = FSTOCK(R%, f%) 'bbh 2022/10/27 Added 2 lines allowing Negative Stocks\rSCumStkNegOK(R%, f%) = CumStkNegOK(R%, f%)\rscountryextrasurdef(R%, f%) = 0  'For trade adjustment\rNext f%\r"
  },
  {
    "Variable": "AGLOSSTRANS",
    "UsesVariable": "FDEM",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "AGLOSSTRANS",
    "UsesVariable": "aglosstransm",
    "Distance": 0,
    "Code": "\rFor f% = 1 To 3\rIf f% = 1 Then 'Decreases with increasing GDP/Capita for crops\rCall XYTABL(\"GDP/Capita (PPP 2011) Versus Waste to Food Ratio Crops (2011) Log\", GDPPCPI(R%), predaglosstransI, context)\rCall XYTABL(\"GDP/Capita (PPP 2011) Versus Waste to Food Ratio Crops (2011) Log\", GDPPCP(R%), predaglosstrans, context)\rElseIf f% = 2 Then 'Decreases with increasing GDP/Capita for meat\rCall XYTABL(\"GDP/Capita (PPP 2011) Versus Waste to Food Ratio Meat (2011) Log\", GDPPCPI(R%), predaglosstransI, context)\rCall XYTABL(\"GDP/Capita (PPP 2011) Versus Waste to Food Ratio Meat (2011) Log\", GDPPCP(R%), predaglosstrans, context)\rpredaglosstrans = 1\rEnd If\r'dsr 2015/05/06 Add aglosstransm to following equation; values less than 1 will reduce intermediate loss\rAGLOSSTRANS(R%, f%) = AgLossTransToFoodRatI(R%, f%) * FDEM(R%, f%) * (predaglosstrans / predaglosstransI) * aglosstransm(R%, f%)\rNext f%\r\rFor f% = 1 To 3\rIf f% = 1 Then 'Decreases with increasing GDP/Capita for crops\rCall XYTABL(\"GDP/Capita (PPP 2011) Versus Waste to Food Ratio Crops (2011) Log\", GDPPCPI(R%), predaglosstransI, context)\rCall XYTABL(\"GDP/Capita (PPP 2011) Versus Waste to Food Ratio Crops (2011) Log\", GDPPCP(R%), predaglosstrans, context)\rElseIf f% = 2 Then 'Decreases with increasing GDP/Capita for meat\rCall XYTABL(\"GDP/Capita (PPP 2011) Versus Waste to Food Ratio Meat (2011) Log\", GDPPCPI(R%), predaglosstransI, context)\rCall XYTABL(\"GDP/Capita (PPP 2011) Versus Waste to Food Ratio Meat (2011) Log\", GDPPCP(R%), predaglosstrans, context)\rpredaglosstrans = 1\rEnd If\r'dsr 2015/05/06 Add aglosstransm to following equation; values less than 1 will reduce intermediate loss\rAGLOSSTRANS(R%, f%) = AgLossTransToFoodRatI(R%, f%) * FDEM(R%, f%) * (predaglosstrans / predaglosstransI) * aglosstransm(R%, f%)\rNext f%\r"
  },
  {
    "Variable": "AGLOSSTRANS",
    "UsesVariable": "GDPPCP",
    "Distance": 233,
    "Code": "\rGDPPCPI(R%) = GDPPCP(R%)\r\r"
  },
  {
    "Variable": "AGM",
    "UsesVariable": "AGDEM",
    "Distance": 69,
    "Code": "0"
  },
  {
    "Variable": "AGM",
    "UsesVariable": "AGP",
    "Distance": 69,
    "Code": "0"
  },
  {
    "Variable": "AGM",
    "UsesVariable": "AGX",
    "Distance": 24,
    "Code": "0"
  },
  {
    "Variable": "AGM",
    "UsesVariable": "agmm",
    "Distance": 0,
    "Code": "\r\r'bbh 2020/06/21 start moved from earlier becuase deficit adjustment logic was overriding impact\r'If RegName$(R%) = \"Nigeria\" And f% = 1 And IY% >= 15 Then Stop\rAGM(R%, f%) = AGM(R%, f%) * agmm(R%, f%) '\r\rDim wmd = 0!\r"
  },
  {
    "Variable": "AGM",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "AGM",
    "UsesVariable": "WAP",
    "Distance": 297,
    "Code": "0"
  },
  {
    "Variable": "AGM",
    "UsesVariable": "AGMVALUE",
    "Distance": 309,
    "Code": "\r\rFor f% = 1 To 3\rswapi(f%) = WAP(f%)\rswxc(f%) = 1\rswmd(f%) = 1\rGlobalSurDefRate(f%) = 0 'bbh 2022/10/27\rSGlobalSurDefRate(f%) = 0 'bbh 2022/11/28\rWTFoodType(f%) = 0 'bbh 2022/10/27 Initialize global trade by food type\rFor R% = 1 To NR%\rWTFoodType(f%) = WTFoodType(f%) + AGX(R%, f%)\rNext R%\rNext f%\r"
  },
  {
    "Variable": "AGM",
    "UsesVariable": "AGLOSSPROD",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "AGM",
    "UsesVariable": "GDPR",
    "Distance": 2,
    "Code": "\r'jrs 2020/10/23 end\r'bbh 2022/10/27 adding price and exchange rate responsiveness to crops; then removed but keep in case\r''            If f% = 1 Then\r''                AGX(R%, f%) = AGX(R%, f%) * (1 + (WP(1) - FPRI(R%, 1) / 100 * EXRATE(R%)) * 0.2) 'elastrpr(R%, 1))\r''                AGM(R%, f%) = AGM(R%, f%) * (1 + (FPRI(R%, 1) / 100 * EXRATE(R%) - WP(1)) * 0.2) 'elastrpr(R%, 1))\r''            'If RegName$(R%) = \"Burundi\" And IY% + 2016 >= 2025 Then Stop\r''            End If\r\r'If RegName$(R%) = \"Nigeria\" Then Stop\r'bbh 2019/10/12 end\r\r'jrs 2020/06/23 *** begin ***\rIf gdprext(R%) > -99 Then\rDim factorm As Single\rDim factorx As Single\r'jrs 2020/07/06 changed parameter name\rfactorm = AMAX(1 + (GDPR(R%) - SmoothGDPR(R%)) * elasmincshock(R%, 1), 0.00001F) 'jrs 2020/07/01 added AMAX(,0)\rfactorx = AMAX(1 + (GDPR(R%) - SmoothGDPR(R%)) * elasxincshock(R%, 1), 0.00001F) 'jrs 2020/07/01 added AMAX(,0)\rAGM(R%, f%) = AGM(R%, f%) * factorm\rAGX(R%, f%) = AGX(R%, f%) * factorx\rEnd If\r\r'jrs 2020/10/23 end\r'bbh 2022/10/27 adding price and exchange rate responsiveness to crops; then removed but keep in case\r''            If f% = 1 Then\r''                AGX(R%, f%) = AGX(R%, f%) * (1 + (WP(1) - FPRI(R%, 1) / 100 * EXRATE(R%)) * 0.2) 'elastrpr(R%, 1))\r''                AGM(R%, f%) = AGM(R%, f%) * (1 + (FPRI(R%, 1) / 100 * EXRATE(R%) - WP(1)) * 0.2) 'elastrpr(R%, 1))\r''            'If RegName$(R%) = \"Burundi\" And IY% + 2016 >= 2025 Then Stop\r''            End If\r\r'If RegName$(R%) = \"Nigeria\" Then Stop\r'bbh 2019/10/12 end\r\r'jrs 2020/06/23 *** begin ***\rIf gdprext(R%) > -99 Then\rDim factorm As Single\rDim factorx As Single\r'jrs 2020/07/06 changed parameter name\rfactorm = AMAX(1 + (GDPR(R%) - SmoothGDPR(R%)) * elasmincshock(R%, 1), 0.00001F) 'jrs 2020/07/01 added AMAX(,0)\rfactorx = AMAX(1 + (GDPR(R%) - SmoothGDPR(R%)) * elasxincshock(R%, 1), 0.00001F) 'jrs 2020/07/01 added AMAX(,0)\rAGM(R%, f%) = AGM(R%, f%) * factorm\rAGX(R%, f%) = AGX(R%, f%) * factorx\rEnd If\r\r'bbh 2022/12/13 End - sudden jumps\r\r\r'If IY% + 2016 >= 2036 And RegName$(R%) = \"Central African Republic\" And f% = 1 Then Stop                    '            If countryextrasurdefadj < 0 Then 'Deficit, reduce exports and increase imports\r'                AGX(R%, f%) = AMAX(0.5 * AGX(R%, f%), _\r'                    AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul)\r'                AGM(R%, f%) = Amin(2 * AGM(R%, f%), _\r'                    AGM(R%, f%) - countryextrasurdefadj * (1 - exportshare) * defadjmul * ImportBoost)\r'\r'            Else   'Surplus, increase exports and decrease imports\r'                AGX(R%, f%) = Amin(2 * AGX(R%, f%), _\r'                    AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul)\r'                AGM(R%, f%) = AMAX(0.5 * AGM(R%, f%), _\r'                    AGM(R%, f%) - countryextrasurdefadj * (1 - exportshare) * defadjmul)\r\r'bbh 2019/03/15 and dkb 2019/03/06 Yemen START\rIf agtrdadjsw(R%) > 0.5 Then\r'                If countryextrasurdefadj < 0 Then\rAGX(R%, f%) = AGX(R%, f%)\rAGM(R%, f%) = AGM(R%, f%)\r'                Else\r'                    AGX(R%, f%) = AGX(R%, f%)\r'                    AGM(R%, f%) = AGM(R%, f%)\r'                End If\rElse\r'bbh 2020/12/10 start Considered replacing use of countryextra both to control branch and to adjust trade levels with stock term\r'Earlier code could increase AGM even when country had a surplus of stocks, etc.\r'surpdef(r%,f%) blew up in IntlPol in 2021 Belize on negative imports in log function so bound agm and agx to be positive\r'then surpdef(r%,f%) blew up in 2029 in IfsEconIntl2, overflow; tried substituting ld countryextrasurdefadj but no real impact by itself or times 5\r'                If cumstk(R%, f%) < agdstl * (AGDEM(R%, f%) + AGP(R%, f%)) Then 'Deficit, reduce exports and increase imports\r'                    AGX(R%, f%) = AMAX(0.5 * AGX(R%, f%), AGX(R%, f%) + surpdef(R%, f%) * 0.1 * exportshare * defadjmul)\r'                    AGM(R%, f%) = Amin(2 * AGM(R%, f%), AGM(R%, f%) - surpdef(R%, f%) * 0.1 * (1 - exportshare) * defadjmul * importboost)\r'                    AGM(R%, f%) = AMAX(0.00001, AGM(R%, f%))\r'                Else 'Surplus, increase exports and decrease imports\r'                    AGX(R%, f%) = Amin(2 * AGX(R%, f%), AGX(R%, f%) + surpdef(R%, f%) * 0.1 * exportshare * defadjmul)\r'                    AGM(R%, f%) = AMAX(0.5 * AGM(R%, f%), AGM(R%, f%) - surpdef(R%, f%) * 0.1 * (1 - exportshare) * defadjmul)\r'                    AGX(R%, f%) = AMAX(0.00001, AGX(R%, f%))\r'                End If\r'                AGM(R%, f%) = AMAX(0.00001, AGM(R%, f%))\r'                AGX(R%, f%) = AMAX(0.00001, AGX(R%, f%))\r\r'If IY% >= 47 And RegName$(R%) = \"Equa Guinea\" And f% = 1 Then Stop\r\r'If IY% >= 13 And RegName$(R%) = \"Pakistan\" And f% = 1 Then Stop\r'If (RegName$(R%) = \"Congo, Democratic Republic of\" Or RegName$(R%) = \"China\") And f% = 1 Then Stop\r\r'Considered requiring both country surplus relative to global average surplus and to local desired;\r'                If (countryextrasurdefadj < 0) And (cumstk(R%, f%) < agdstl * (AGDEM(R%, f%) + AGP(R%, f%))) Then 'Deficit, reduce exports and increase imports\r'                    AGX(R%, f%) = AMAX(0.5 * AGX(R%, f%), AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul)\r'                    AGM(R%, f%) = Amin(2 * AGM(R%, f%), AGM(R%, f%) - countryextrasurdefadj * (1 - exportshare) * defadjmul * importboost)\r''If RegName$(R%) = \"Congo, Democratic Republic of\" And f% = 1 Then Stop\r'                End If\r'                If (countryextrasurdefadj > 0) And (cumstk(R%, f%) > agdstl * (AGDEM(R%, f%) + AGP(R%, f%))) Then  'Surplus, increase exports and decrease imports\r'                    AGX(R%, f%) = Amin(2 * AGX(R%, f%), AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul)\r'                    AGM(R%, f%) = AMAX(0.5 * AGM(R%, f%), AGM(R%, f%) - countryextrasurdefadj * (1 - exportshare) * defadjmul)\r''If RegName$(R%) = \"Congo, Democratic Republic of\" And f% = 1 Then Stop\r'                End If\r\r'Looking at a comparison of local stock levels versus global avoids pushing up imports when the world is awash in production with high/wide ylm\rIf countryextrasurdefadj < 0 Then 'Deficit, reduce exports and increase imports\r'wv 2022/08/22 change max min to 0.2 and 5 rather then 0.5 and 2 to allow for stronger feedback of stocks to export/import dynamics\r'wv 2022/08/22 add exportboost to allow for faster rise in exports with surplus\rAGX(R%, f%) = AMAX(0.2 * AGX(R%, f%), AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul)\rAGM(R%, f%) = Amin(5 * AGM(R%, f%), AGM(R%, f%) - countryextrasurdefadj * (1 - exportshare) * defadjmul * ImportBoost)\r'If RegName$(R%) = \"Congo, Democratic Republic of\" And f% = 1 Then Stop\rElse   'Surplus, increase exports and decrease imports\r'bbh 2022/10/27 Start Boost exports when rate is low and stocks are in surplus\rIf AGX(R%, f%) < 0.05 * countryextrasurdef Then\rAGX(R%, f%) = Amin(8 * AGX(R%, f%), AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul * exportboost)\rElseIf AGX(R%, f%) < 0.1 * countryextrasurdef Then\rAGX(R%, f%) = Amin(5 * AGX(R%, f%), AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul * exportboost)\rElseIf AGX(R%, f%) < 0.2 * countryextrasurdef Then\rAGX(R%, f%) = Amin(3 * AGX(R%, f%), AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul * exportboost)\rElse\rAGX(R%, f%) = Amin(2 * AGX(R%, f%), AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul * exportboost)\rEnd If\r'If IY% + 2016 >= 2029 And RegName$(R%) = \"India\" And f% = 2 Then Stop\r'If IY% + 2016 >= 2022 And RegName$(R%) = \"Micronesia\" And f% = 3 Then Stop\r'bbh 2022/10/27 End Boost exports\r'AGX(R%, f%) = Amin(2 * AGX(R%, f%), AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul * exportboost)\r'AGX(R%, f%) = Amin(2 * AGX(R%, f%), AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul)\rAGM(R%, f%) = AMAX(0.5 * AGM(R%, f%), AGM(R%, f%) - countryextrasurdefadj * (1 - exportshare) * defadjmul)\r'If IY% + 2016 >= 2035 And RegName$(R%) = \"Central African Republic\" And f% = 1 Then Stop\rEnd If\rAGM(R%, f%) = AMAX(0.00001, AGM(R%, f%))\rAGX(R%, f%) = AMAX(0.00001, AGX(R%, f%))\r'bbh 2020/12/10 end\r'bbh 2019/03/15 and dkb 2019/03/06  end\r'            'dkb 2019/03/06 for Yemen - START\r''                AGM(R%, f%) = Amin(2 * AGM(R%, f%), _\r'                    AGM(R%, f%) - countryextrasurdefadj * (1 - exportshare) * defadjmul * ImportBoost)\r'                If RegName$(R%) = \"Yemen\" Then\r'                    AGM(R%, f%) = AGM(R%, f%)\r'                Else\r'                    AGM(R%, f%) = Amin(2 * AGM(R%, f%), AGM(R%, f%) - countryextrasurdefadj * (1 - exportshare) * defadjmul * ImportBoost)\r'                End If\r'            'dkb 2019/03/06 for Yemen - END\r'            'dkb 2019/03/06 for Yemen - START\r''               AGX(R%, f%) = Amin(2 * AGX(R%, f%), _\r'                    AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul)\r''               AGM(R%, f%) = AMAX(0.5 * AGM(R%, f%), _\r'                    AGM(R%, f%) - countryextrasurdefadj * (1 - exportshare) * defadjmul)\r'                If RegName$(R%) = \"Yemen\" Then\r'                    AGM(R%, f%) = AGM(R%, f%)\r'                Else\r'                AGX(R%, f%) = Amin(2 * AGX(R%, f%), AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul)\r'                AGM(R%, f%) = AMAX(0.5 * AGM(R%, f%), AGM(R%, f%) - countryextrasurdefadj * (1 - exportshare) * defadjmul)\r'                End If\r'            'dkb 2019/03/06 for Yemen - END\r\rEnd If\r"
  },
  {
    "Variable": "AGM",
    "UsesVariable": "elasmincshock",
    "Distance": 2,
    "Code": "\r'jrs 2020/10/23 end\r'bbh 2022/10/27 adding price and exchange rate responsiveness to crops; then removed but keep in case\r''            If f% = 1 Then\r''                AGX(R%, f%) = AGX(R%, f%) * (1 + (WP(1) - FPRI(R%, 1) / 100 * EXRATE(R%)) * 0.2) 'elastrpr(R%, 1))\r''                AGM(R%, f%) = AGM(R%, f%) * (1 + (FPRI(R%, 1) / 100 * EXRATE(R%) - WP(1)) * 0.2) 'elastrpr(R%, 1))\r''            'If RegName$(R%) = \"Burundi\" And IY% + 2016 >= 2025 Then Stop\r''            End If\r\r'If RegName$(R%) = \"Nigeria\" Then Stop\r'bbh 2019/10/12 end\r\r'jrs 2020/06/23 *** begin ***\rIf gdprext(R%) > -99 Then\rDim factorm As Single\rDim factorx As Single\r'jrs 2020/07/06 changed parameter name\rfactorm = AMAX(1 + (GDPR(R%) - SmoothGDPR(R%)) * elasmincshock(R%, 1), 0.00001F) 'jrs 2020/07/01 added AMAX(,0)\rfactorx = AMAX(1 + (GDPR(R%) - SmoothGDPR(R%)) * elasxincshock(R%, 1), 0.00001F) 'jrs 2020/07/01 added AMAX(,0)\rAGM(R%, f%) = AGM(R%, f%) * factorm\rAGX(R%, f%) = AGX(R%, f%) * factorx\rEnd If\r"
  },
  {
    "Variable": "AGM",
    "UsesVariable": "MTARIFFTAXR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "AGMVALUE",
    "UsesVariable": "AGXVALUE",
    "Distance": 5,
    "Code": "\r'   All but First 2:  Translation for Economic Model\r'   ------------------------------------------------\r\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\rFor f% = 1 To 3\r'        WM = 0!\r'        WX = 0!\rWM(f%) = 0!\rWX(f%) = 0!\rNext f%\r\r'   All but First 2:  Translation for Economic Model\r'   ------------------------------------------------\r\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\rFor f% = 1 To 3\r'        WM = 0!\r'        WX = 0!\rWM(f%) = 0!\rWX(f%) = 0!\rNext f%\r\r'   All but First 2:  Translation for Economic Model\r'   ------------------------------------------------\r\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\rFor f% = 1 To 3\r'        WM = 0!\r'        WX = 0!\rWM(f%) = 0!\rWX(f%) = 0!\rNext f%\r\r'   If RegName$(R%) = \"Australia\" Then Stop\r\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\r'jrs 2007/01/12 no double counting\rIf RegiontoSum(R%) Then\rFor f% = 1 To 3\r'                WX = WX + XS(R%, 1)\r'                WM = WM + MS(R%, 1)\rWM(f%) = WM(f%) + AGMVALUE(R%, f%)\rWX(f%) = WX(f%) + AGXVALUE(R%, f%)\rNext f%\rEnd If\r\r'   All but First 2:  Translation for Economic Model\r'   ------------------------------------------------\r\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\rFor f% = 1 To 3\r'        WM = 0!\r'        WX = 0!\rWM(f%) = 0!\rWX(f%) = 0!\rNext f%\r\r'   If RegName$(R%) = \"Australia\" Then Stop\r\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\r'jrs 2007/01/12 no double counting\rIf RegiontoSum(R%) Then\rFor f% = 1 To 3\r'                WX = WX + XS(R%, 1)\r'                WM = WM + MS(R%, 1)\rWM(f%) = WM(f%) + AGMVALUE(R%, f%)\rWX(f%) = WX(f%) + AGXVALUE(R%, f%)\rNext f%\rEnd If\r\r'   All but First 2:  Translation for Economic Model\r'   ------------------------------------------------\r\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\rFor f% = 1 To 3\r'        WM = 0!\r'        WX = 0!\rWM(f%) = 0!\rWX(f%) = 0!\rNext f%\r\r'   If RegName$(R%) = \"Australia\" Then Stop\r\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\r'jrs 2007/01/12 no double counting\rIf RegiontoSum(R%) Then\rFor f% = 1 To 3\r'                WX = WX + XS(R%, 1)\r'                WM = WM + MS(R%, 1)\rWM(f%) = WM(f%) + AGMVALUE(R%, f%)\rWX(f%) = WX(f%) + AGXVALUE(R%, f%)\rNext f%\rEnd If\r\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\r'    WTRA = (WX + WM) / 2\rFor f% = 1 To 3\rDim WTRA = (WX(f%) + WM(f%)) / 2\rFor R% = 1 To NR%\r'             XS(R%, 1) = XS(R%, 1) * WTRA / AMAX(WX, 0.001)\r'             MS(R%, 1) = MS(R%, 1) * WTRA / AMAX(WM, 0.001)\rAGMVALUE(R%, f%) = CSng(AGMVALUE(R%, f%) * WTRA / AMAX(WM(f%), 0.001))\rAGXVALUE(R%, f%) = CSng(AGXVALUE(R%, f%) * WTRA / AMAX(WX(f%), 0.001))\rMS(R%, 1) = MS(R%, 1) + AGMVALUE(R%, f%)\rXS(R%, 1) = XS(R%, 1) + AGXVALUE(R%, f%)\rNext R%\rNext f%\r\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\r'    WTRA = (WX + WM) / 2\rFor f% = 1 To 3\rDim WTRA = (WX(f%) + WM(f%)) / 2\rFor R% = 1 To NR%\r'             XS(R%, 1) = XS(R%, 1) * WTRA / AMAX(WX, 0.001)\r'             MS(R%, 1) = MS(R%, 1) * WTRA / AMAX(WM, 0.001)\rAGMVALUE(R%, f%) = CSng(AGMVALUE(R%, f%) * WTRA / AMAX(WM(f%), 0.001))\rAGXVALUE(R%, f%) = CSng(AGXVALUE(R%, f%) * WTRA / AMAX(WX(f%), 0.001))\rMS(R%, 1) = MS(R%, 1) + AGMVALUE(R%, f%)\rXS(R%, 1) = XS(R%, 1) + AGXVALUE(R%, f%)\rNext R%\rNext f%\r"
  },
  {
    "Variable": "AGMVALUE",
    "UsesVariable": "agmvaluem",
    "Distance": 0,
    "Code": "\rFor f% = 1 To 3\rAGMVALUE(R%, f%) = msf(R%, f%) * AGM(R%, f%) * swapi(f%)\rAGXVALUE(R%, f%) = xsf(R%, f%) * AGX(R%, f%) * swapi(f%)\r'wv 2022/01/05 Added a multiplier on AGMVALUE and AGXVALUE\rAGMVALUE(R%, f%) = AGMVALUE(R%, f%) * agmvaluem(R%, f%)\rAGXVALUE(R%, f%) = AGXVALUE(R%, f%) * agxvaluem(R%, f%)\rNext f%\r\r'   All but First 2:  Translation for Economic Model\r'   ------------------------------------------------\r\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\rFor f% = 1 To 3\r'        WM = 0!\r'        WX = 0!\rWM(f%) = 0!\rWX(f%) = 0!\rNext f%\r"
  },
  {
    "Variable": "AGMVALUE",
    "UsesVariable": "AGM",
    "Distance": 0,
    "Code": "\rFor f% = 1 To 3\rAGMVALUE(R%, f%) = msf(R%, f%) * AGM(R%, f%) * swapi(f%)\rAGXVALUE(R%, f%) = xsf(R%, f%) * AGX(R%, f%) * swapi(f%)\r'wv 2022/01/05 Added a multiplier on AGMVALUE and AGXVALUE\rAGMVALUE(R%, f%) = AGMVALUE(R%, f%) * agmvaluem(R%, f%)\rAGXVALUE(R%, f%) = AGXVALUE(R%, f%) * agxvaluem(R%, f%)\rNext f%\r"
  },
  {
    "Variable": "AGMVALUE",
    "UsesVariable": "WAP",
    "Distance": 470,
    "Code": "\r\rFor f% = 1 To 3\rswapi(f%) = WAP(f%)\rswxc(f%) = 1\rswmd(f%) = 1\rGlobalSurDefRate(f%) = 0 'bbh 2022/10/27\rSGlobalSurDefRate(f%) = 0 'bbh 2022/11/28\rWTFoodType(f%) = 0 'bbh 2022/10/27 Initialize global trade by food type\rFor R% = 1 To NR%\rWTFoodType(f%) = WTFoodType(f%) + AGX(R%, f%)\rNext R%\rNext f%\r"
  },
  {
    "Variable": "AGP",
    "UsesVariable": "AGFISHCATCH",
    "Distance": 0,
    "Code": "\rAGP(R%, 3) = AGFISHCATCH(R%) + AQUACUL(R%)\r"
  },
  {
    "Variable": "AGP",
    "UsesVariable": "AQUACUL",
    "Distance": 0,
    "Code": "\rAGP(R%, 3) = AGFISHCATCH(R%) + AQUACUL(R%)\r"
  },
  {
    "Variable": "AGP",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "\rAGP(R%, 3) = AGFISHCATCH(R%) + AQUACUL(R%)\r"
  },
  {
    "Variable": "AGP",
    "UsesVariable": "AGLOSSPROD",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "AGP",
    "UsesVariable": "LVHERD",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "AGP",
    "UsesVariable": "slr",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "AGP",
    "UsesVariable": "AGPMILKEGGS",
    "Distance": 322,
    "Code": "\rAGPppl(R%, 2) = AGP(R%, 2) / (1 - (aglossmeatperc / 100))\r"
  },
  {
    "Variable": "AGP",
    "UsesVariable": "aglossprodm",
    "Distance": 325,
    "Code": "0"
  },
  {
    "Variable": "AGP",
    "UsesVariable": "YL",
    "Distance": 5,
    "Code": "\r'bbh 2022/11/28 End of code area changed subsantially to moderate year-to-year changes in yields by limiting annual change in % change\r'If IY% + 2016 >= 2035 And RegName$(R%) = \"Central African Republic\" Then Stop 'bbh 2022/12/13 Important debugging line in YL calculation\r\r'\r'   All but First 1:  Agricultural Production\r'   -----------------------------------------\r'dsr 2015/06/09 CROP PRODUCTION\r'dsr 2015/06/22 Compute pre loss production\r'dkb 2021/06/08 added * (1 - ldcropunusedshare(R%))\rAGPppl(R%, 1) = YL(R%) * LD(R%, 1) * (1 - ldcropunusedshare(R%))\r"
  },
  {
    "Variable": "AGP",
    "UsesVariable": "LD",
    "Distance": 5,
    "Code": "\r'bbh 2022/11/28 End of code area changed subsantially to moderate year-to-year changes in yields by limiting annual change in % change\r'If IY% + 2016 >= 2035 And RegName$(R%) = \"Central African Republic\" Then Stop 'bbh 2022/12/13 Important debugging line in YL calculation\r\r'\r'   All but First 1:  Agricultural Production\r'   -----------------------------------------\r'dsr 2015/06/09 CROP PRODUCTION\r'dsr 2015/06/22 Compute pre loss production\r'dkb 2021/06/08 added * (1 - ldcropunusedshare(R%))\rAGPppl(R%, 1) = YL(R%) * LD(R%, 1) * (1 - ldcropunusedshare(R%))\r"
  },
  {
    "Variable": "AGP",
    "UsesVariable": "ldcropunusedshare",
    "Distance": 5,
    "Code": "\r'bbh 2022/11/28 End of code area changed subsantially to moderate year-to-year changes in yields by limiting annual change in % change\r'If IY% + 2016 >= 2035 And RegName$(R%) = \"Central African Republic\" Then Stop 'bbh 2022/12/13 Important debugging line in YL calculation\r\r'\r'   All but First 1:  Agricultural Production\r'   -----------------------------------------\r'dsr 2015/06/09 CROP PRODUCTION\r'dsr 2015/06/22 Compute pre loss production\r'dkb 2021/06/08 added * (1 - ldcropunusedshare(R%))\rAGPppl(R%, 1) = YL(R%) * LD(R%, 1) * (1 - ldcropunusedshare(R%))\r"
  },
  {
    "Variable": "AGPMILKEGGS",
    "UsesVariable": "aglossprodm",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "AGPMILKEGGS",
    "UsesVariable": "LVHERD",
    "Distance": 6,
    "Code": "\rAGPppl(R%, 2) = AGP(R%, 2) / (1 - (aglossmeatperc / 100))\r\rAGPMILKEGGSppl(R%) = AGPMILKEGGS(R%) / (1 - aglossmeatperc / 100)\r"
  },
  {
    "Variable": "AGPMILKEGGS",
    "UsesVariable": "slr",
    "Distance": 6,
    "Code": "\rAGPppl(R%, 2) = AGP(R%, 2) / (1 - (aglossmeatperc / 100))\r"
  },
  {
    "Variable": "AGPMILKEGGS",
    "UsesVariable": "AGP",
    "Distance": 325,
    "Code": "\r'sgh 2018/01/04 - END\r\r'dsr 2014/12/21 For some reason, wrong line was commented out\r'jrs 2014/12/03\r'dsr 2015/06/15 Compute Pre-Production Loss Production in first year\r'dsr 2015/06/15 Compute Production Loss in first year\r'dsr 2015/06/15 Compute Pre-Production Loss Non-Animal Production in first year\r'kbn 2017/09/13 As no data on meat losses are available, these are kept constant at 10 percent. Have added this temporary\r' variable below so the value of the multiplier can be maintained.\rDim aglossmeatperc = Amin(AMAX(10 * aglossprodm(R%, 2), 2), 20)\r"
  },
  {
    "Variable": "AGTEC",
    "UsesVariable": "MFPRATE",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "AGTEC",
    "UsesVariable": "TGRYL",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "AGTEC",
    "UsesVariable": "YL",
    "Distance": 88,
    "Code": "0"
  },
  {
    "Variable": "AGTEC",
    "UsesVariable": "ylexp",
    "Distance": 88,
    "Code": "0"
  },
  {
    "Variable": "AGTEC",
    "UsesVariable": "elfdpr1",
    "Distance": 21,
    "Code": "\rswbalance = 0!\r\rwbalance = 0\r\r'ttt 2019/10/08 TakeOut\rArray.Copy(xsfi, xsf, xsfi.Length)\rArray.Copy(msfi, msf, msfi.Length)\rArray.Copy(ZSFI, ZSF, NR + 1)\rArray.Copy(CSFI, CSF, NR + 1)\rArray.Copy(FSFI, FSF, NR + 1)\r\rFor R% = 1 To NR%\r'XSF(R%) = ConvergeOverTime(XSFI(R%), WTarConvF, 50)\r'MSF(R%) = ConvergeOverTime(MSFI(R%), WTarConvF, 50)\r'ZSF(R%) = ConvergeOverTime(ZSFI(R%), WTarConvF, 50)\r'CSF(R%) = ConvergeOverTime(CSFI(R%), WTarConvF, 50)\r'For Eritrea, big push up in CS with converenge is problem\r'sgh 2015/07/24 - xsf and msf now have second dimension START\r'xsf and msf remain constant over time; i.e., no change in ratio of monetary value to price index\r'    xsf(R%) = xsfi(R%)\r'    msf(R%) = msfi(R%)\r'ttt 2019/10/08 TakenOut\r'For f% = 1 To 3\r'    xsf(R%, f%) = xsfi(R%, f%)\r'    msf(R%, f%) = msfi(R%, f%)\r'Next f%\r''sgh 2015/07/24 - xsf and msf now have second dimension  END\r'        If gdprext(R%) > -90 Then 'bbh 2021/09/30 start; did not work, but leave block, may revisit at some point\r'            ZSFI(R%) = ZSFI(R%) * (1 + gdprext(R%) / 100) '- IGDPRCor(R%)) 'igdpr(R%))\r'        Else\r'            ZSFI(R%) = sZSFI(R%)\r'        End If 'bbh 2021/09/30 end\r'ZSF(R%) = ZSFI(R%)\r'CSF(R%) = CSFI(R%)\r''FSF(R%) = ConvergeOverTime(FSFI(R%), WTarConvF, 50)\r'FSF(R%) = FSFI(R%) 'Stock targets different, physical, monetary\r'jrs 2007/01/12 no double counting\r'dsr 2015/07/01 Compute world crop demand base and balance, where balance equals stocks\r'    (including shortages) minus desired stocks, which are a fraction of the demand base\rIf RegiontoSum(R%) Then\r'Use post-loss production to compute demand base\rwdmbase = wdmbase + sagdem(R%, 1) + SAGP(R%, 1)\rdmbase = sagdem(R%, 1) + SAGP(R%, 1)\rwbalance = wbalance + scumstk(R%, 1) - dmbase * agdstl\rEnd If\rNext R%\rCOMPLETE STRUCTURE:End Sub:3235|\r\rPublic Sub IfsAg1AllButFirstYear(context As IForecastContext)\r'AllButFirst:\r\r\r'FirstCall:\r\rwdmbase = 0\r\r'ttt 2019/10/08 TakeOut\rArray.Copy(xsfi, xsf, xsfi.Length)\rArray.Copy(msfi, msf, msfi.Length)\rArray.Copy(ZSFI, ZSF, NR + 1)\rArray.Copy(CSFI, CSF, NR + 1)\rArray.Copy(FSFI, FSF, NR + 1)\r\rFor R% = 1 To NR%\r'XSF(R%) = ConvergeOverTime(XSFI(R%), WTarConvF, 50)\r'MSF(R%) = ConvergeOverTime(MSFI(R%), WTarConvF, 50)\r'ZSF(R%) = ConvergeOverTime(ZSFI(R%), WTarConvF, 50)\r'CSF(R%) = ConvergeOverTime(CSFI(R%), WTarConvF, 50)\r'For Eritrea, big push up in CS with converenge is problem\r'sgh 2015/07/24 - xsf and msf now have second dimension START\r'xsf and msf remain constant over time; i.e., no change in ratio of monetary value to price index\r'    xsf(R%) = xsfi(R%)\r'    msf(R%) = msfi(R%)\r'ttt 2019/10/08 TakenOut\r'For f% = 1 To 3\r'    xsf(R%, f%) = xsfi(R%, f%)\r'    msf(R%, f%) = msfi(R%, f%)\r'Next f%\r''sgh 2015/07/24 - xsf and msf now have second dimension  END\r'        If gdprext(R%) > -90 Then 'bbh 2021/09/30 start; did not work, but leave block, may revisit at some point\r'            ZSFI(R%) = ZSFI(R%) * (1 + gdprext(R%) / 100) '- IGDPRCor(R%)) 'igdpr(R%))\r'        Else\r'            ZSFI(R%) = sZSFI(R%)\r'        End If 'bbh 2021/09/30 end\r'ZSF(R%) = ZSFI(R%)\r'CSF(R%) = CSFI(R%)\r''FSF(R%) = ConvergeOverTime(FSFI(R%), WTarConvF, 50)\r'FSF(R%) = FSFI(R%) 'Stock targets different, physical, monetary\r'jrs 2007/01/12 no double counting\r'dsr 2015/07/01 Compute world crop demand base and balance, where balance equals stocks\r'    (including shortages) minus desired stocks, which are a fraction of the demand base\rIf RegiontoSum(R%) Then\r'Use post-loss production to compute demand base\rwdmbase = wdmbase + sagdem(R%, 1) + SAGP(R%, 1)\rdmbase = sagdem(R%, 1) + SAGP(R%, 1)\rwbalance = wbalance + scumstk(R%, 1) - dmbase * agdstl\rEnd If\rNext R%\r"
  },
  {
    "Variable": "AGTEC",
    "UsesVariable": "elfdpr2",
    "Distance": 21,
    "Code": "\rswbalance = 0!\r"
  },
  {
    "Variable": "AGTEC",
    "UsesVariable": "AGDEM",
    "Distance": 25,
    "Code": "0"
  },
  {
    "Variable": "AGTEC",
    "UsesVariable": "AGP",
    "Distance": 25,
    "Code": "0"
  },
  {
    "Variable": "AGTEC",
    "UsesVariable": "YIELDINT",
    "Distance": 284,
    "Code": "0"
  },
  {
    "Variable": "AGTEC",
    "UsesVariable": "dstl",
    "Distance": 233,
    "Code": "\r\r'   First Year:  Profits and Prices\r'   -------------------------------\r\rFor f% = 1 To 3\rFPROFITR(R%, f%) = 1\rsfprofitr(R%, f%) = 1\rSSFProfitR(R%, f%) = 1\rsbalance(R%, f%) = 0\rSBalanceForYl(R%) = 0 'bbh 2022/11/28\rcumstk(R%, f%) = FSTOCK(R%, f%)\rscumstk(R%, f%) = cumstk(R%, f%)\rCumStkNegOK(R%, f%) = FSTOCK(R%, f%) 'bbh 2022/10/27 Added 2 lines allowing Negative Stocks\rSCumStkNegOK(R%, f%) = CumStkNegOK(R%, f%)\rscountryextrasurdef(R%, f%) = 0  'For trade adjustment\rNext f%\r"
  },
  {
    "Variable": "AGTEC",
    "UsesVariable": "ifsexomodelid",
    "Distance": 233,
    "Code": "0"
  },
  {
    "Variable": "AGTEC",
    "UsesVariable": "FSTOCK",
    "Distance": 75,
    "Code": "\r'wv 2020/12/17 agpy update the calculation of satk based on the initial yield intensity, initial year always be equal to 1\rsatk(R%) = CSng(AMAX(0.1, Amin((YLLim(R%) - syl(R%)) / (YLLim(R%) - iyl(R%)), 1)) ^ ylexp)\r\r\r'  All but First 1: Technological Growth\r'  -------------------------------------\r\r' wv 2020/12/17 agpy *** start updating the yield growth logic here ***\rIf IY% = 2 Then 'Compute YL growth attributable to Capital, etc.\rDim YlGroTechTemp = (TGRYL(R%) +\r                MFPRATE(R%, 1) - mfprateagi(R%)) * satk(R%)\r' wv 2020/12/17 agpy updated the technology growth to increase over time, not decrease. assumes knowledge cannot be lost\rDim agtectemp As Single\rIf YlGroTechTemp > 0 Then\ragtectemp = 1 + YlGroTechTemp\rEnd If\rcapterm = CSng(KAG(R%) ^ alpha(R%))\rlabterm = CSng(labagi(R%) ^ (1 - alpha(R%)))\r' wv 2020/12/12 agpy change the structure such that the saturation limits the change in yield not the yield itself\r' wv 2020/12/17 agpy  and do not allow for a drop in yields relative to the previous year\r'old formulation byl(R%) = agtectemp(R%) * cD(R%) * capterm(R%) * labterm(R%) * satk(R%)\rbyl(R%) = agtectemp * cD(R%) * capterm * labterm\rIf byl(R%) > iyl(R%) Then\rbyl(R%) = iyl(R%) + ((byl(R%) - iyl(R%)) * satk(R%))\rElse\rbyl(R%) = AMAX(syl(R%), iyl(R%))\rEnd If\rDim YlGr = byl(R%) / iyl(R%) - 1\r'wv 2020/12/12 agpy updated the calculation here to only allow for positive change, bounded by 0. otherwise countries have continuous negative draws on their techn yield growth\r'yladj(R%) = YlGr(R%) - TGRYL(R%)\rIf YlGr > TGRYL(R%) And TGRYL(R%) > 0 Then\ryladj(R%) = YlGr - TGRYL(R%)\rEnd If\rEnd If\r\r\r' wv 2020/12/17 agpy *** start updating the maximum yield***\r'based on data, and make it country specific, also added the YLLim, and SYLLim already in the first year\r\riyl(R%) = YL(R%)\r"
  },
  {
    "Variable": "AGTEC",
    "UsesVariable": "KAG",
    "Distance": 124,
    "Code": "0"
  },
  {
    "Variable": "AGTEC",
    "UsesVariable": "LABS",
    "Distance": 124,
    "Code": "0"
  },
  {
    "Variable": "AGTEC",
    "UsesVariable": "CDALF",
    "Distance": 126,
    "Code": "0"
  },
  {
    "Variable": "AGX",
    "UsesVariable": "AGDEM",
    "Distance": 67,
    "Code": "0"
  },
  {
    "Variable": "AGX",
    "UsesVariable": "AGP",
    "Distance": 67,
    "Code": "0"
  },
  {
    "Variable": "AGX",
    "UsesVariable": "AGM",
    "Distance": 21,
    "Code": "0"
  },
  {
    "Variable": "AGX",
    "UsesVariable": "agxm",
    "Distance": 0,
    "Code": "\rAGX(R%, f%) = AGX(R%, f%) * agxm(R%, f%)\r"
  },
  {
    "Variable": "AGX",
    "UsesVariable": "AGLOSSPROD",
    "Distance": 17,
    "Code": "0"
  },
  {
    "Variable": "AGX",
    "UsesVariable": "gdprext",
    "Distance": 0,
    "Code": "\r'jrs 2020/10/23 end\r'bbh 2022/10/27 adding price and exchange rate responsiveness to crops; then removed but keep in case\r''            If f% = 1 Then\r''                AGX(R%, f%) = AGX(R%, f%) * (1 + (WP(1) - FPRI(R%, 1) / 100 * EXRATE(R%)) * 0.2) 'elastrpr(R%, 1))\r''                AGM(R%, f%) = AGM(R%, f%) * (1 + (FPRI(R%, 1) / 100 * EXRATE(R%) - WP(1)) * 0.2) 'elastrpr(R%, 1))\r''            'If RegName$(R%) = \"Burundi\" And IY% + 2016 >= 2025 Then Stop\r''            End If\r\r'If RegName$(R%) = \"Nigeria\" Then Stop\r'bbh 2019/10/12 end\r\r'jrs 2020/06/23 *** begin ***\rIf gdprext(R%) > -99 Then\rDim factorm As Single\rDim factorx As Single\r'jrs 2020/07/06 changed parameter name\rfactorm = AMAX(1 + (GDPR(R%) - SmoothGDPR(R%)) * elasmincshock(R%, 1), 0.00001F) 'jrs 2020/07/01 added AMAX(,0)\rfactorx = AMAX(1 + (GDPR(R%) - SmoothGDPR(R%)) * elasxincshock(R%, 1), 0.00001F) 'jrs 2020/07/01 added AMAX(,0)\rAGM(R%, f%) = AGM(R%, f%) * factorm\rAGX(R%, f%) = AGX(R%, f%) * factorx\rEnd If\r\r'jrs 2020/10/23 end\r'bbh 2022/10/27 adding price and exchange rate responsiveness to crops; then removed but keep in case\r''            If f% = 1 Then\r''                AGX(R%, f%) = AGX(R%, f%) * (1 + (WP(1) - FPRI(R%, 1) / 100 * EXRATE(R%)) * 0.2) 'elastrpr(R%, 1))\r''                AGM(R%, f%) = AGM(R%, f%) * (1 + (FPRI(R%, 1) / 100 * EXRATE(R%) - WP(1)) * 0.2) 'elastrpr(R%, 1))\r''            'If RegName$(R%) = \"Burundi\" And IY% + 2016 >= 2025 Then Stop\r''            End If\r\r'If RegName$(R%) = \"Nigeria\" Then Stop\r'bbh 2019/10/12 end\r\r'jrs 2020/06/23 *** begin ***\rIf gdprext(R%) > -99 Then\rDim factorm As Single\rDim factorx As Single\r'jrs 2020/07/06 changed parameter name\rfactorm = AMAX(1 + (GDPR(R%) - SmoothGDPR(R%)) * elasmincshock(R%, 1), 0.00001F) 'jrs 2020/07/01 added AMAX(,0)\rfactorx = AMAX(1 + (GDPR(R%) - SmoothGDPR(R%)) * elasxincshock(R%, 1), 0.00001F) 'jrs 2020/07/01 added AMAX(,0)\rAGM(R%, f%) = AGM(R%, f%) * factorm\rAGX(R%, f%) = AGX(R%, f%) * factorx\rEnd If\r\r'bbh 2022/12/13 End - sudden jumps\r\r\r'If IY% + 2016 >= 2036 And RegName$(R%) = \"Central African Republic\" And f% = 1 Then Stop                    '            If countryextrasurdefadj < 0 Then 'Deficit, reduce exports and increase imports\r'                AGX(R%, f%) = AMAX(0.5 * AGX(R%, f%), _\r'                    AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul)\r'                AGM(R%, f%) = Amin(2 * AGM(R%, f%), _\r'                    AGM(R%, f%) - countryextrasurdefadj * (1 - exportshare) * defadjmul * ImportBoost)\r'\r'            Else   'Surplus, increase exports and decrease imports\r'                AGX(R%, f%) = Amin(2 * AGX(R%, f%), _\r'                    AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul)\r'                AGM(R%, f%) = AMAX(0.5 * AGM(R%, f%), _\r'                    AGM(R%, f%) - countryextrasurdefadj * (1 - exportshare) * defadjmul)\r\r'bbh 2019/03/15 and dkb 2019/03/06 Yemen START\rIf agtrdadjsw(R%) > 0.5 Then\r'                If countryextrasurdefadj < 0 Then\rAGX(R%, f%) = AGX(R%, f%)\rAGM(R%, f%) = AGM(R%, f%)\r'                Else\r'                    AGX(R%, f%) = AGX(R%, f%)\r'                    AGM(R%, f%) = AGM(R%, f%)\r'                End If\rElse\r'bbh 2020/12/10 start Considered replacing use of countryextra both to control branch and to adjust trade levels with stock term\r'Earlier code could increase AGM even when country had a surplus of stocks, etc.\r'surpdef(r%,f%) blew up in IntlPol in 2021 Belize on negative imports in log function so bound agm and agx to be positive\r'then surpdef(r%,f%) blew up in 2029 in IfsEconIntl2, overflow; tried substituting ld countryextrasurdefadj but no real impact by itself or times 5\r'                If cumstk(R%, f%) < agdstl * (AGDEM(R%, f%) + AGP(R%, f%)) Then 'Deficit, reduce exports and increase imports\r'                    AGX(R%, f%) = AMAX(0.5 * AGX(R%, f%), AGX(R%, f%) + surpdef(R%, f%) * 0.1 * exportshare * defadjmul)\r'                    AGM(R%, f%) = Amin(2 * AGM(R%, f%), AGM(R%, f%) - surpdef(R%, f%) * 0.1 * (1 - exportshare) * defadjmul * importboost)\r'                    AGM(R%, f%) = AMAX(0.00001, AGM(R%, f%))\r'                Else 'Surplus, increase exports and decrease imports\r'                    AGX(R%, f%) = Amin(2 * AGX(R%, f%), AGX(R%, f%) + surpdef(R%, f%) * 0.1 * exportshare * defadjmul)\r'                    AGM(R%, f%) = AMAX(0.5 * AGM(R%, f%), AGM(R%, f%) - surpdef(R%, f%) * 0.1 * (1 - exportshare) * defadjmul)\r'                    AGX(R%, f%) = AMAX(0.00001, AGX(R%, f%))\r'                End If\r'                AGM(R%, f%) = AMAX(0.00001, AGM(R%, f%))\r'                AGX(R%, f%) = AMAX(0.00001, AGX(R%, f%))\r\r'If IY% >= 47 And RegName$(R%) = \"Equa Guinea\" And f% = 1 Then Stop\r\r'If IY% >= 13 And RegName$(R%) = \"Pakistan\" And f% = 1 Then Stop\r'If (RegName$(R%) = \"Congo, Democratic Republic of\" Or RegName$(R%) = \"China\") And f% = 1 Then Stop\r\r'Considered requiring both country surplus relative to global average surplus and to local desired;\r'                If (countryextrasurdefadj < 0) And (cumstk(R%, f%) < agdstl * (AGDEM(R%, f%) + AGP(R%, f%))) Then 'Deficit, reduce exports and increase imports\r'                    AGX(R%, f%) = AMAX(0.5 * AGX(R%, f%), AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul)\r'                    AGM(R%, f%) = Amin(2 * AGM(R%, f%), AGM(R%, f%) - countryextrasurdefadj * (1 - exportshare) * defadjmul * importboost)\r''If RegName$(R%) = \"Congo, Democratic Republic of\" And f% = 1 Then Stop\r'                End If\r'                If (countryextrasurdefadj > 0) And (cumstk(R%, f%) > agdstl * (AGDEM(R%, f%) + AGP(R%, f%))) Then  'Surplus, increase exports and decrease imports\r'                    AGX(R%, f%) = Amin(2 * AGX(R%, f%), AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul)\r'                    AGM(R%, f%) = AMAX(0.5 * AGM(R%, f%), AGM(R%, f%) - countryextrasurdefadj * (1 - exportshare) * defadjmul)\r''If RegName$(R%) = \"Congo, Democratic Republic of\" And f% = 1 Then Stop\r'                End If\r\r'Looking at a comparison of local stock levels versus global avoids pushing up imports when the world is awash in production with high/wide ylm\rIf countryextrasurdefadj < 0 Then 'Deficit, reduce exports and increase imports\r'wv 2022/08/22 change max min to 0.2 and 5 rather then 0.5 and 2 to allow for stronger feedback of stocks to export/import dynamics\r'wv 2022/08/22 add exportboost to allow for faster rise in exports with surplus\rAGX(R%, f%) = AMAX(0.2 * AGX(R%, f%), AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul)\rAGM(R%, f%) = Amin(5 * AGM(R%, f%), AGM(R%, f%) - countryextrasurdefadj * (1 - exportshare) * defadjmul * ImportBoost)\r'If RegName$(R%) = \"Congo, Democratic Republic of\" And f% = 1 Then Stop\rElse   'Surplus, increase exports and decrease imports\r'bbh 2022/10/27 Start Boost exports when rate is low and stocks are in surplus\rIf AGX(R%, f%) < 0.05 * countryextrasurdef Then\rAGX(R%, f%) = Amin(8 * AGX(R%, f%), AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul * exportboost)\rElseIf AGX(R%, f%) < 0.1 * countryextrasurdef Then\rAGX(R%, f%) = Amin(5 * AGX(R%, f%), AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul * exportboost)\rElseIf AGX(R%, f%) < 0.2 * countryextrasurdef Then\rAGX(R%, f%) = Amin(3 * AGX(R%, f%), AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul * exportboost)\rElse\rAGX(R%, f%) = Amin(2 * AGX(R%, f%), AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul * exportboost)\rEnd If\r'If IY% + 2016 >= 2029 And RegName$(R%) = \"India\" And f% = 2 Then Stop\r'If IY% + 2016 >= 2022 And RegName$(R%) = \"Micronesia\" And f% = 3 Then Stop\r'bbh 2022/10/27 End Boost exports\r'AGX(R%, f%) = Amin(2 * AGX(R%, f%), AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul * exportboost)\r'AGX(R%, f%) = Amin(2 * AGX(R%, f%), AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul)\rAGM(R%, f%) = AMAX(0.5 * AGM(R%, f%), AGM(R%, f%) - countryextrasurdefadj * (1 - exportshare) * defadjmul)\r'If IY% + 2016 >= 2035 And RegName$(R%) = \"Central African Republic\" And f% = 1 Then Stop\rEnd If\rAGM(R%, f%) = AMAX(0.00001, AGM(R%, f%))\rAGX(R%, f%) = AMAX(0.00001, AGX(R%, f%))\r'bbh 2020/12/10 end\r'bbh 2019/03/15 and dkb 2019/03/06  end\r'            'dkb 2019/03/06 for Yemen - START\r''                AGM(R%, f%) = Amin(2 * AGM(R%, f%), _\r'                    AGM(R%, f%) - countryextrasurdefadj * (1 - exportshare) * defadjmul * ImportBoost)\r'                If RegName$(R%) = \"Yemen\" Then\r'                    AGM(R%, f%) = AGM(R%, f%)\r'                Else\r'                    AGM(R%, f%) = Amin(2 * AGM(R%, f%), AGM(R%, f%) - countryextrasurdefadj * (1 - exportshare) * defadjmul * ImportBoost)\r'                End If\r'            'dkb 2019/03/06 for Yemen - END\r'            'dkb 2019/03/06 for Yemen - START\r''               AGX(R%, f%) = Amin(2 * AGX(R%, f%), _\r'                    AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul)\r''               AGM(R%, f%) = AMAX(0.5 * AGM(R%, f%), _\r'                    AGM(R%, f%) - countryextrasurdefadj * (1 - exportshare) * defadjmul)\r'                If RegName$(R%) = \"Yemen\" Then\r'                    AGM(R%, f%) = AGM(R%, f%)\r'                Else\r'                AGX(R%, f%) = Amin(2 * AGX(R%, f%), AGX(R%, f%) + countryextrasurdefadj * exportshare * defadjmul)\r'                AGM(R%, f%) = AMAX(0.5 * AGM(R%, f%), AGM(R%, f%) - countryextrasurdefadj * (1 - exportshare) * defadjmul)\r'                End If\r'            'dkb 2019/03/06 for Yemen - END\r\rEnd If\r"
  },
  {
    "Variable": "AGX",
    "UsesVariable": "GDPR",
    "Distance": 2,
    "Code": "\r'jrs 2020/10/23 end\r'bbh 2022/10/27 adding price and exchange rate responsiveness to crops; then removed but keep in case\r''            If f% = 1 Then\r''                AGX(R%, f%) = AGX(R%, f%) * (1 + (WP(1) - FPRI(R%, 1) / 100 * EXRATE(R%)) * 0.2) 'elastrpr(R%, 1))\r''                AGM(R%, f%) = AGM(R%, f%) * (1 + (FPRI(R%, 1) / 100 * EXRATE(R%) - WP(1)) * 0.2) 'elastrpr(R%, 1))\r''            'If RegName$(R%) = \"Burundi\" And IY% + 2016 >= 2025 Then Stop\r''            End If\r\r'If RegName$(R%) = \"Nigeria\" Then Stop\r'bbh 2019/10/12 end\r\r'jrs 2020/06/23 *** begin ***\rIf gdprext(R%) > -99 Then\rDim factorm As Single\rDim factorx As Single\r'jrs 2020/07/06 changed parameter name\rfactorm = AMAX(1 + (GDPR(R%) - SmoothGDPR(R%)) * elasmincshock(R%, 1), 0.00001F) 'jrs 2020/07/01 added AMAX(,0)\rfactorx = AMAX(1 + (GDPR(R%) - SmoothGDPR(R%)) * elasxincshock(R%, 1), 0.00001F) 'jrs 2020/07/01 added AMAX(,0)\rAGM(R%, f%) = AGM(R%, f%) * factorm\rAGX(R%, f%) = AGX(R%, f%) * factorx\rEnd If\r"
  },
  {
    "Variable": "AGX",
    "UsesVariable": "elasxincshock",
    "Distance": 2,
    "Code": "\r'jrs 2020/10/23 end\r'bbh 2022/10/27 adding price and exchange rate responsiveness to crops; then removed but keep in case\r''            If f% = 1 Then\r''                AGX(R%, f%) = AGX(R%, f%) * (1 + (WP(1) - FPRI(R%, 1) / 100 * EXRATE(R%)) * 0.2) 'elastrpr(R%, 1))\r''                AGM(R%, f%) = AGM(R%, f%) * (1 + (FPRI(R%, 1) / 100 * EXRATE(R%) - WP(1)) * 0.2) 'elastrpr(R%, 1))\r''            'If RegName$(R%) = \"Burundi\" And IY% + 2016 >= 2025 Then Stop\r''            End If\r\r'If RegName$(R%) = \"Nigeria\" Then Stop\r'bbh 2019/10/12 end\r\r'jrs 2020/06/23 *** begin ***\rIf gdprext(R%) > -99 Then\rDim factorm As Single\rDim factorx As Single\r'jrs 2020/07/06 changed parameter name\rfactorm = AMAX(1 + (GDPR(R%) - SmoothGDPR(R%)) * elasmincshock(R%, 1), 0.00001F) 'jrs 2020/07/01 added AMAX(,0)\rfactorx = AMAX(1 + (GDPR(R%) - SmoothGDPR(R%)) * elasxincshock(R%, 1), 0.00001F) 'jrs 2020/07/01 added AMAX(,0)\rAGM(R%, f%) = AGM(R%, f%) * factorm\rAGX(R%, f%) = AGX(R%, f%) * factorx\rEnd If\r"
  },
  {
    "Variable": "AGXVALUE",
    "UsesVariable": "AGMVALUE",
    "Distance": 7,
    "Code": "\r'   All but First 2:  Translation for Economic Model\r'   ------------------------------------------------\r\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\rFor f% = 1 To 3\r'        WM = 0!\r'        WX = 0!\rWM(f%) = 0!\rWX(f%) = 0!\rNext f%\r\r'   All but First 2:  Translation for Economic Model\r'   ------------------------------------------------\r\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\rFor f% = 1 To 3\r'        WM = 0!\r'        WX = 0!\rWM(f%) = 0!\rWX(f%) = 0!\rNext f%\r\r'   All but First 2:  Translation for Economic Model\r'   ------------------------------------------------\r\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\rFor f% = 1 To 3\r'        WM = 0!\r'        WX = 0!\rWM(f%) = 0!\rWX(f%) = 0!\rNext f%\r\r'   All but First 2:  Translation for Economic Model\r'   ------------------------------------------------\r\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\rFor f% = 1 To 3\r'        WM = 0!\r'        WX = 0!\rWM(f%) = 0!\rWX(f%) = 0!\rNext f%\r\r'   If RegName$(R%) = \"Australia\" Then Stop\r\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\r'jrs 2007/01/12 no double counting\rIf RegiontoSum(R%) Then\rFor f% = 1 To 3\r'                WX = WX + XS(R%, 1)\r'                WM = WM + MS(R%, 1)\rWM(f%) = WM(f%) + AGMVALUE(R%, f%)\rWX(f%) = WX(f%) + AGXVALUE(R%, f%)\rNext f%\rEnd If\r\r'   All but First 2:  Translation for Economic Model\r'   ------------------------------------------------\r\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\rFor f% = 1 To 3\r'        WM = 0!\r'        WX = 0!\rWM(f%) = 0!\rWX(f%) = 0!\rNext f%\r\r'   If RegName$(R%) = \"Australia\" Then Stop\r\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\r'jrs 2007/01/12 no double counting\rIf RegiontoSum(R%) Then\rFor f% = 1 To 3\r'                WX = WX + XS(R%, 1)\r'                WM = WM + MS(R%, 1)\rWM(f%) = WM(f%) + AGMVALUE(R%, f%)\rWX(f%) = WX(f%) + AGXVALUE(R%, f%)\rNext f%\rEnd If\r\r'   All but First 2:  Translation for Economic Model\r'   ------------------------------------------------\r\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\rFor f% = 1 To 3\r'        WM = 0!\r'        WX = 0!\rWM(f%) = 0!\rWX(f%) = 0!\rNext f%\r\r'   If RegName$(R%) = \"Australia\" Then Stop\r\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\r'jrs 2007/01/12 no double counting\rIf RegiontoSum(R%) Then\rFor f% = 1 To 3\r'                WX = WX + XS(R%, 1)\r'                WM = WM + MS(R%, 1)\rWM(f%) = WM(f%) + AGMVALUE(R%, f%)\rWX(f%) = WX(f%) + AGXVALUE(R%, f%)\rNext f%\rEnd If\r\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\r'    WTRA = (WX + WM) / 2\rFor f% = 1 To 3\rDim WTRA = (WX(f%) + WM(f%)) / 2\rFor R% = 1 To NR%\r'             XS(R%, 1) = XS(R%, 1) * WTRA / AMAX(WX, 0.001)\r'             MS(R%, 1) = MS(R%, 1) * WTRA / AMAX(WM, 0.001)\rAGMVALUE(R%, f%) = CSng(AGMVALUE(R%, f%) * WTRA / AMAX(WM(f%), 0.001))\rAGXVALUE(R%, f%) = CSng(AGXVALUE(R%, f%) * WTRA / AMAX(WX(f%), 0.001))\rMS(R%, 1) = MS(R%, 1) + AGMVALUE(R%, f%)\rXS(R%, 1) = XS(R%, 1) + AGXVALUE(R%, f%)\rNext R%\rNext f%\r\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\r'    WTRA = (WX + WM) / 2\rFor f% = 1 To 3\rDim WTRA = (WX(f%) + WM(f%)) / 2\rFor R% = 1 To NR%\r'             XS(R%, 1) = XS(R%, 1) * WTRA / AMAX(WX, 0.001)\r'             MS(R%, 1) = MS(R%, 1) * WTRA / AMAX(WM, 0.001)\rAGMVALUE(R%, f%) = CSng(AGMVALUE(R%, f%) * WTRA / AMAX(WM(f%), 0.001))\rAGXVALUE(R%, f%) = CSng(AGXVALUE(R%, f%) * WTRA / AMAX(WX(f%), 0.001))\rMS(R%, 1) = MS(R%, 1) + AGMVALUE(R%, f%)\rXS(R%, 1) = XS(R%, 1) + AGXVALUE(R%, f%)\rNext R%\rNext f%\r"
  },
  {
    "Variable": "AGXVALUE",
    "UsesVariable": "agxvaluem",
    "Distance": 0,
    "Code": "\rFor f% = 1 To 3\rAGMVALUE(R%, f%) = msf(R%, f%) * AGM(R%, f%) * swapi(f%)\rAGXVALUE(R%, f%) = xsf(R%, f%) * AGX(R%, f%) * swapi(f%)\r'wv 2022/01/05 Added a multiplier on AGMVALUE and AGXVALUE\rAGMVALUE(R%, f%) = AGMVALUE(R%, f%) * agmvaluem(R%, f%)\rAGXVALUE(R%, f%) = AGXVALUE(R%, f%) * agxvaluem(R%, f%)\rNext f%\r"
  },
  {
    "Variable": "AGXVALUE",
    "UsesVariable": "AGX",
    "Distance": 0,
    "Code": "\rFor f% = 1 To 3\rAGMVALUE(R%, f%) = msf(R%, f%) * AGM(R%, f%) * swapi(f%)\rAGXVALUE(R%, f%) = xsf(R%, f%) * AGX(R%, f%) * swapi(f%)\r'wv 2022/01/05 Added a multiplier on AGMVALUE and AGXVALUE\rAGMVALUE(R%, f%) = AGMVALUE(R%, f%) * agmvaluem(R%, f%)\rAGXVALUE(R%, f%) = AGXVALUE(R%, f%) * agxvaluem(R%, f%)\rNext f%\r"
  },
  {
    "Variable": "AGXVALUE",
    "UsesVariable": "WAP",
    "Distance": 471,
    "Code": "\r\rFor f% = 1 To 3\rswapi(f%) = WAP(f%)\rswxc(f%) = 1\rswmd(f%) = 1\rGlobalSurDefRate(f%) = 0 'bbh 2022/10/27\rSGlobalSurDefRate(f%) = 0 'bbh 2022/11/28\rWTFoodType(f%) = 0 'bbh 2022/10/27 Initialize global trade by food type\rFor R% = 1 To NR%\rWTFoodType(f%) = WTFoodType(f%) + AGX(R%, f%)\rNext R%\rNext f%\r"
  },
  {
    "Variable": "AID",
    "UsesVariable": "AIDRECEIPT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "AID",
    "UsesVariable": "AIDDONATE",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "AID",
    "UsesVariable": "bilateralsw",
    "Distance": 0,
    "Code": "\rAID(R%) = AIDRECEIPT(R%) - AIDDONATE(R%) 'Net aid as used extensively aross model\rNext R%\rEnd If\r'***END*** clp 2023/12/20 create new process for adding dyadic aid flows that also increases monadic; Calls in ifsEcoDyadic1AllButFirst\r'and ifsEcoDyadic1FirstYear; dyadaidexoadd also added to ForAid at end\r\r"
  },
  {
    "Variable": "AIDDONATE",
    "UsesVariable": "aiddon",
    "Distance": 0,
    "Code": "\r\r'   Determine Size of Aid Pool and Aid Demands\r'   ------------------------------------------\r'\r'bbh 2022/04/19 start: Introduce gross aid receipts as step toward net (AID)\rFor R% = 1 To NR%\r\r\rAIDRECEIPT(R%) = AidRecPcnt(R%) / 100 * GDP(R%)\rAIDDONATE(R%) = aiddon(R%) / 100 * GDP(R%)\r\rAIDR = AIDR + AIDRECEIPT(R%)\rAIDP = AIDP + AIDDONATE(R%)\r\r'        'mti 2016/11/02 Start\r'        'AID(R%) = (aidrec(R%) - aiddon(R%)) / 100 * GDP(R%)\r'        AID(R%) = (AidRecPcnt(R%) - aiddon(R%)) / 100 * GDP(R%)\r'        'mti 2016/11/02 End\r'\r'        If (AID(R%) > 0) Then    'Net Aid recipient\r'            AIDR = AIDR + AID(R%)\r'        Else                     'Aid donor (AID is negative)\r'            AIDP = AIDP + AID(R%)\r'        End If\r\rNext R%\r"
  },
  {
    "Variable": "AIDDONATE",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "\r\r'   Determine Size of Aid Pool and Aid Demands\r'   ------------------------------------------\r'\r'bbh 2022/04/19 start: Introduce gross aid receipts as step toward net (AID)\rFor R% = 1 To NR%\r\r\rAIDRECEIPT(R%) = AidRecPcnt(R%) / 100 * GDP(R%)\rAIDDONATE(R%) = aiddon(R%) / 100 * GDP(R%)\r\rAIDR = AIDR + AIDRECEIPT(R%)\rAIDP = AIDP + AIDDONATE(R%)\r\r'        'mti 2016/11/02 Start\r'        'AID(R%) = (aidrec(R%) - aiddon(R%)) / 100 * GDP(R%)\r'        AID(R%) = (AidRecPcnt(R%) - aiddon(R%)) / 100 * GDP(R%)\r'        'mti 2016/11/02 End\r'\r'        If (AID(R%) > 0) Then    'Net Aid recipient\r'            AIDR = AIDR + AID(R%)\r'        Else                     'Aid donor (AID is negative)\r'            AIDP = AIDP + AID(R%)\r'        End If\r\rNext R%\r"
  },
  {
    "Variable": "aidlp",
    "UsesVariable": "aidlpm",
    "Distance": 0,
    "Code": "\rAIDLPI(R%) = aidlp(R%)\r\rFor R% = 1 To NR%\rXRPA(R%) = XRPA(R%) / AMAX(0.01, WX) * WT\rMRPA(R%) = MRPA(R%) / AMAX(0.01, WM) * WT\r'TRADEBAL(R%) = XRPA(R%) - MRPA(R%)\rTRADEBAL(R%) = X(R%) - M(R%) 'bbh 2021/07/07\rSExRate(R%) = EXRATE(R%)\r'jrs 2014/04/11\r'             SX(R%) = X(R%)\r'             SM(R%) = M(R%)\rIf IY% > 1 Then\raidlp(R%) = AMAX(0, Amin(1, AIDLPI(R%) * aidlpm))\rEnd If\rIf AID(R%) > 0 Then 'Recipients\rSumAid = SumAid + AID(R%)\rSumAidLP = SumAidLP + AID(R%) * aidlp(R%)\rEnd If\rNext R%\r"
  },
  {
    "Variable": "AIDRECEIPT",
    "UsesVariable": "AIDDONATE",
    "Distance": 4,
    "Code": "\r'mti 2016/11/02 End\r\rAIDP = 0!\r\rAIDR = 0!\r\r'mti 2016/11/02 End\r\rAIDP = 0!\r\r\r'   Determine Size of Aid Pool and Aid Demands\r'   ------------------------------------------\r'\r'bbh 2022/04/19 start: Introduce gross aid receipts as step toward net (AID)\rFor R% = 1 To NR%\r\r\rAIDRECEIPT(R%) = AidRecPcnt(R%) / 100 * GDP(R%)\rAIDDONATE(R%) = aiddon(R%) / 100 * GDP(R%)\r\rAIDR = AIDR + AIDRECEIPT(R%)\rAIDP = AIDP + AIDDONATE(R%)\r\r'        'mti 2016/11/02 Start\r'        'AID(R%) = (aidrec(R%) - aiddon(R%)) / 100 * GDP(R%)\r'        AID(R%) = (AidRecPcnt(R%) - aiddon(R%)) / 100 * GDP(R%)\r'        'mti 2016/11/02 End\r'\r'        If (AID(R%) > 0) Then    'Net Aid recipient\r'            AIDR = AIDR + AID(R%)\r'        Else                     'Aid donor (AID is negative)\r'            AIDP = AIDP + AID(R%)\r'        End If\r\rNext R%\r\rAIDR = 0!\r\r\r'   Determine Size of Aid Pool and Aid Demands\r'   ------------------------------------------\r'\r'bbh 2022/04/19 start: Introduce gross aid receipts as step toward net (AID)\rFor R% = 1 To NR%\r\r\rAIDRECEIPT(R%) = AidRecPcnt(R%) / 100 * GDP(R%)\rAIDDONATE(R%) = aiddon(R%) / 100 * GDP(R%)\r\rAIDR = AIDR + AIDRECEIPT(R%)\rAIDP = AIDP + AIDDONATE(R%)\r\r'        'mti 2016/11/02 Start\r'        'AID(R%) = (aidrec(R%) - aiddon(R%)) / 100 * GDP(R%)\r'        AID(R%) = (AidRecPcnt(R%) - aiddon(R%)) / 100 * GDP(R%)\r'        'mti 2016/11/02 End\r'\r'        If (AID(R%) > 0) Then    'Net Aid recipient\r'            AIDR = AIDR + AID(R%)\r'        Else                     'Aid donor (AID is negative)\r'            AIDP = AIDP + AID(R%)\r'        End If\r\rNext R%\r\rIf AIDP < 0.01 Then AIDP = 0.01\r\r\r'   Impose Aid Pool on Recipients and Donors\r'   ----------------------------------------\rIf AIDR < 0.01 Then AIDR = 0.01\r\rAIDTot = AIDP\r\rFor R% = 1 To NR%\rIf (AIDRECEIPT(R%) > 0) Then\rAIDRECEIPT(R%) = AIDRECEIPT(R%) * AIDTot / AIDR\rEnd If\rAID(R%) = AIDRECEIPT(R%) - AIDDONATE(R%) 'Net aid as used extensively aross model\rNext R%\r"
  },
  {
    "Variable": "AIDRECEIPT",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "\r\rPrivate Sub ForAid(NR%)\r'- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r'   Last Changed by BBH: 2005\r'mti 2016/11/02 - Take full procedure\r\r'mti 2016/11/02 Start\rDim calaidrec As Single\r'jrs 2014/09/15\rDim AIDP As Single, AIDR As Single, R As Integer, AIDTot As Single\r\rIf IY = 1 Then\rReDim AidRecPcntShift(NR%), AidRecPcnt(NR%)\r'mti 2016/11/02 End\r\r'   FOREIGN AID CALCULATION\r'   -----------------------\r\r'mti 2016/11/02 Start\rFor R% = 1 To NR%\rcalaidrec = CSng(5.3753 * Math.Log(aidgradpoint) - 5.3753 * Math.Log(GDPPCP(R%)))\rAidRecPcntShift(R%) = AIDREC(R%) - AMAX(0, calaidrec)\rAidRecPcnt(R%) = AIDREC(R%)\rNext\r\r\rElse\rFor R% = 1 To NR%\r'path obtained from a regression of aidrec% with GDPPCP with graduation at 14k (regression saved in TablFunc)\r'Intercept = 5.3753 * Log(aidgradpoint)\rcalaidrec = CSng(5.3753 * Math.Log(aidgradpoint) - 5.3753 * Math.Log(GDPPCP(R%)))\r'bbh 2020/05/07 start\r'The line below was causing major transients in aid receipts after 2015+75 is 2090, even as approached after 2085\r'Problem likely related to magnitude of AidRecPcntShift from year 1, but code there not transparent so not clear how to fix\r'My extension to 100 years will leave a problem for runs of that length, probably even 95 years\r'AidRecPcnt(R%) = Amin(90, (AMAX(0, AMAX(0, calaidrec) + ConvergeOverTime(AidRecPcntShift(R%), 0, 75))) * aidrecm(R%))\rAidRecPcnt(R%) = Amin(90, (AMAX(0, AMAX(0, calaidrec) + ConvergeOverTime(AidRecPcntShift(R%), 0, 100))) * aidrecm(R%))\r'bbh 2020/05/07 end\rNext\r\rEnd If\r\r\r'   Determine Size of Aid Pool and Aid Demands\r'   ------------------------------------------\r'\r'bbh 2022/04/19 start: Introduce gross aid receipts as step toward net (AID)\rFor R% = 1 To NR%\r\r\rAIDRECEIPT(R%) = AidRecPcnt(R%) / 100 * GDP(R%)\rAIDDONATE(R%) = aiddon(R%) / 100 * GDP(R%)\r\rAIDR = AIDR + AIDRECEIPT(R%)\rAIDP = AIDP + AIDDONATE(R%)\r\r'        'mti 2016/11/02 Start\r'        'AID(R%) = (aidrec(R%) - aiddon(R%)) / 100 * GDP(R%)\r'        AID(R%) = (AidRecPcnt(R%) - aiddon(R%)) / 100 * GDP(R%)\r'        'mti 2016/11/02 End\r'\r'        If (AID(R%) > 0) Then    'Net Aid recipient\r'            AIDR = AIDR + AID(R%)\r'        Else                     'Aid donor (AID is negative)\r'            AIDP = AIDP + AID(R%)\r'        End If\r\rNext R%\r"
  },
  {
    "Variable": "AIDRECEIPT",
    "UsesVariable": "aidrecm",
    "Distance": 3,
    "Code": "\r\rPrivate Sub ForAid(NR%)\r'- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r'   Last Changed by BBH: 2005\r'mti 2016/11/02 - Take full procedure\r\r'mti 2016/11/02 Start\rDim calaidrec As Single\r'jrs 2014/09/15\rDim AIDP As Single, AIDR As Single, R As Integer, AIDTot As Single\r\rIf IY = 1 Then\rReDim AidRecPcntShift(NR%), AidRecPcnt(NR%)\r'mti 2016/11/02 End\r\r'   FOREIGN AID CALCULATION\r'   -----------------------\r\r'mti 2016/11/02 Start\rFor R% = 1 To NR%\rcalaidrec = CSng(5.3753 * Math.Log(aidgradpoint) - 5.3753 * Math.Log(GDPPCP(R%)))\rAidRecPcntShift(R%) = AIDREC(R%) - AMAX(0, calaidrec)\rAidRecPcnt(R%) = AIDREC(R%)\rNext\r\r\rElse\rFor R% = 1 To NR%\r'path obtained from a regression of aidrec% with GDPPCP with graduation at 14k (regression saved in TablFunc)\r'Intercept = 5.3753 * Log(aidgradpoint)\rcalaidrec = CSng(5.3753 * Math.Log(aidgradpoint) - 5.3753 * Math.Log(GDPPCP(R%)))\r'bbh 2020/05/07 start\r'The line below was causing major transients in aid receipts after 2015+75 is 2090, even as approached after 2085\r'Problem likely related to magnitude of AidRecPcntShift from year 1, but code there not transparent so not clear how to fix\r'My extension to 100 years will leave a problem for runs of that length, probably even 95 years\r'AidRecPcnt(R%) = Amin(90, (AMAX(0, AMAX(0, calaidrec) + ConvergeOverTime(AidRecPcntShift(R%), 0, 75))) * aidrecm(R%))\rAidRecPcnt(R%) = Amin(90, (AMAX(0, AMAX(0, calaidrec) + ConvergeOverTime(AidRecPcntShift(R%), 0, 100))) * aidrecm(R%))\r'bbh 2020/05/07 end\rNext\r\rEnd If\r\r\rPrivate Sub ForAid(NR%)\r'- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r'   Last Changed by BBH: 2005\r'mti 2016/11/02 - Take full procedure\r\r'mti 2016/11/02 Start\rDim calaidrec As Single\r'jrs 2014/09/15\rDim AIDP As Single, AIDR As Single, R As Integer, AIDTot As Single\r\rIf IY = 1 Then\rReDim AidRecPcntShift(NR%), AidRecPcnt(NR%)\r'mti 2016/11/02 End\r\r'   FOREIGN AID CALCULATION\r'   -----------------------\r\r'mti 2016/11/02 Start\rFor R% = 1 To NR%\rcalaidrec = CSng(5.3753 * Math.Log(aidgradpoint) - 5.3753 * Math.Log(GDPPCP(R%)))\rAidRecPcntShift(R%) = AIDREC(R%) - AMAX(0, calaidrec)\rAidRecPcnt(R%) = AIDREC(R%)\rNext\r\r\rElse\rFor R% = 1 To NR%\r'path obtained from a regression of aidrec% with GDPPCP with graduation at 14k (regression saved in TablFunc)\r'Intercept = 5.3753 * Log(aidgradpoint)\rcalaidrec = CSng(5.3753 * Math.Log(aidgradpoint) - 5.3753 * Math.Log(GDPPCP(R%)))\r'bbh 2020/05/07 start\r'The line below was causing major transients in aid receipts after 2015+75 is 2090, even as approached after 2085\r'Problem likely related to magnitude of AidRecPcntShift from year 1, but code there not transparent so not clear how to fix\r'My extension to 100 years will leave a problem for runs of that length, probably even 95 years\r'AidRecPcnt(R%) = Amin(90, (AMAX(0, AMAX(0, calaidrec) + ConvergeOverTime(AidRecPcntShift(R%), 0, 75))) * aidrecm(R%))\rAidRecPcnt(R%) = Amin(90, (AMAX(0, AMAX(0, calaidrec) + ConvergeOverTime(AidRecPcntShift(R%), 0, 100))) * aidrecm(R%))\r'bbh 2020/05/07 end\rNext\r\rEnd If\r"
  },
  {
    "Variable": "AIDRECEIPT",
    "UsesVariable": "aidgradpoint",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "AIDRECEIPT",
    "UsesVariable": "GDPPCP",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "AIDRECEIPT",
    "UsesVariable": "AIDREC",
    "Distance": 6,
    "Code": "\r\rPrivate Sub ForAid(NR%)\r'- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r'   Last Changed by BBH: 2005\r'mti 2016/11/02 - Take full procedure\r\r'mti 2016/11/02 Start\rDim calaidrec As Single\r'jrs 2014/09/15\rDim AIDP As Single, AIDR As Single, R As Integer, AIDTot As Single\r\rIf IY = 1 Then\rReDim AidRecPcntShift(NR%), AidRecPcnt(NR%)\r'mti 2016/11/02 End\r\r'   FOREIGN AID CALCULATION\r'   -----------------------\r\r'mti 2016/11/02 Start\rFor R% = 1 To NR%\rcalaidrec = CSng(5.3753 * Math.Log(aidgradpoint) - 5.3753 * Math.Log(GDPPCP(R%)))\rAidRecPcntShift(R%) = AIDREC(R%) - AMAX(0, calaidrec)\rAidRecPcnt(R%) = AIDREC(R%)\rNext\r\r\rElse\rFor R% = 1 To NR%\r'path obtained from a regression of aidrec% with GDPPCP with graduation at 14k (regression saved in TablFunc)\r'Intercept = 5.3753 * Log(aidgradpoint)\rcalaidrec = CSng(5.3753 * Math.Log(aidgradpoint) - 5.3753 * Math.Log(GDPPCP(R%)))\r'bbh 2020/05/07 start\r'The line below was causing major transients in aid receipts after 2015+75 is 2090, even as approached after 2085\r'Problem likely related to magnitude of AidRecPcntShift from year 1, but code there not transparent so not clear how to fix\r'My extension to 100 years will leave a problem for runs of that length, probably even 95 years\r'AidRecPcnt(R%) = Amin(90, (AMAX(0, AMAX(0, calaidrec) + ConvergeOverTime(AidRecPcntShift(R%), 0, 75))) * aidrecm(R%))\rAidRecPcnt(R%) = Amin(90, (AMAX(0, AMAX(0, calaidrec) + ConvergeOverTime(AidRecPcntShift(R%), 0, 100))) * aidrecm(R%))\r'bbh 2020/05/07 end\rNext\r\rEnd If\r"
  },
  {
    "Variable": "AIDSDRATE",
    "UsesVariable": "HIVRATE",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "AIDSDRATE",
    "UsesVariable": "aidsdratem",
    "Distance": 0,
    "Code": "\r'sgh 2016/11/28 - no longer use the moving average of prevalence\rHIVAIDSRI(R%) = AMAX(3, Amin(1000, HIVRATE(R%) / AMAX(0.001, AIDSDRATE(R%))))\r"
  },
  {
    "Variable": "AIDSDRATE",
    "UsesVariable": "aidsdrtadvr",
    "Distance": 0,
    "Code": "\r'sgh 2016/11/28 - no longer use the moving average of prevalence\rHIVAIDSRI(R%) = AMAX(3, Amin(1000, HIVRATE(R%) / AMAX(0.001, AIDSDRATE(R%))))\r"
  },
  {
    "Variable": "AIDSDRATE",
    "UsesVariable": "AIDSDTHS",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "AIDSDRATE",
    "UsesVariable": "POP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "AIDSDRATE",
    "UsesVariable": "hlmodelsw",
    "Distance": 0,
    "Code": "\r\r'All Years: Sum for Total DEATHCAT\r'-------------------------------------\r'jrs 2007/04/30 Save DEATHCAT '*** BEGIN ***'\rDim rr As Integer\r'jrs 2010/04/07\rIf hlstddthsw = 0 Then\rFor rr = 1 To NR%\r'jrs 2007/07/09\r'        DEATHCAT(rr, 1, 3) = DEATHCAT(rr, 1, 1) + DEATHCAT(rr, 1, 2)\r'        DEATHCAT(rr, 2, 3) = DEATHCAT(rr, 2, 1) + DEATHCAT(rr, 2, 2)\r'        DEATHCAT(rr, 3, 3) = DEATHCAT(rr, 3, 1) + DEATHCAT(rr, 3, 2)\rFor k = 1 To CInt(Ntypes / 2)\rDEATHCAT(rr, k, 3) = DEATHCAT(rr, k, 1) + DEATHCAT(rr, k, 2)\rNext k\r'jrs 2012/11/20 *** begin ***\rIf hlmodelsw = 1 And IY > 1 Then 'jrs 2013/02/18 added and iy>1\r'This is only necessary when there's a multiplier on the health module mortality, otherwise should be already the same\rAIDSDTHS(rr) = DEATHCAT(rr, 11, 3)\rAIDSDRATE(rr) = AIDSDTHS(rr) / POP(rr) * 100\rEnd If\r'jrs 2012/11/20 *** end ***\rNext rr\rEnd If\r"
  },
  {
    "Variable": "AIDSDTHS",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "AIDSDTHS",
    "UsesVariable": "AIDSDRATE",
    "Distance": 0,
    "Code": "\rAIDSDTHS(R%) = POP(R%) * AIDSDRATE(R%) / 100\r"
  },
  {
    "Variable": "AIDSDTHS",
    "UsesVariable": "DEATHCAT",
    "Distance": 0,
    "Code": "\r\r'All Years: Sum for Total DEATHCAT\r'-------------------------------------\r'jrs 2007/04/30 Save DEATHCAT '*** BEGIN ***'\rDim rr As Integer\r'jrs 2010/04/07\rIf hlstddthsw = 0 Then\rFor rr = 1 To NR%\r'jrs 2007/07/09\r'        DEATHCAT(rr, 1, 3) = DEATHCAT(rr, 1, 1) + DEATHCAT(rr, 1, 2)\r'        DEATHCAT(rr, 2, 3) = DEATHCAT(rr, 2, 1) + DEATHCAT(rr, 2, 2)\r'        DEATHCAT(rr, 3, 3) = DEATHCAT(rr, 3, 1) + DEATHCAT(rr, 3, 2)\rFor k = 1 To CInt(Ntypes / 2)\rDEATHCAT(rr, k, 3) = DEATHCAT(rr, k, 1) + DEATHCAT(rr, k, 2)\rNext k\r'jrs 2012/11/20 *** begin ***\rIf hlmodelsw = 1 And IY > 1 Then 'jrs 2013/02/18 added and iy>1\r'This is only necessary when there's a multiplier on the health module mortality, otherwise should be already the same\rAIDSDTHS(rr) = DEATHCAT(rr, 11, 3)\rAIDSDRATE(rr) = AIDSDTHS(rr) / POP(rr) * 100\rEnd If\r'jrs 2012/11/20 *** end ***\rNext rr\rEnd If\r"
  },
  {
    "Variable": "AIDSDTHSCM",
    "UsesVariable": "AIDSDTHS",
    "Distance": 0,
    "Code": "\r'If RegName$(R%) = \"Kenya\" Then Stop\rSAIDSDTHSCM(R%) = SAIDSDTHSCM(R%) + AIDSDTHS(R%)\r"
  },
  {
    "Variable": "AIMACHIQ",
    "UsesVariable": "aimachiqm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "AIMACHIQ",
    "UsesVariable": "AITASK",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "AITASK",
    "UsesVariable": "AITASKGR",
    "Distance": 0,
    "Code": "\r\rPublic Sub ifsTechAllbutFirstYear(context As IForecastContext)\r'All Years but First\r'-------------------\rDim i As Integer\rFor i = 1 To 6\r'Growth must start decreasing once level reaches 5\rIf SAITASK(i) < 5 Then\rAITASKGR(i) = IAITASKGR(i) * aitaskm(i)\rElse\rAITASKGR(i) = CSng(IAITASKGR(i) * ((10 - SAITASK(i)) / 5) ^ 2 * aitaskm(i))\rEnd If\r'Apply multiplier\r'AITASK(i) = AITASK(i) * aitaskm(i)\r'Check limits\rAITASK(i) = AMAX(Amin(AITASK(i), 10), 0)\r'Apply Growth\rAITASK(i) = SAITASK(i) * (1 + AITASKGR(i) / 100)\r'SAVE RESULTING VALUE\rSAITASK(i) = AITASK(i)\r'SAITASKGR(i) = AITASKGR(i)\rNext i\rIf AITASK(6) < 5 Then\rAIMACHIQ = 60 * AITASK(6) / 5\rElse\rAIMACHIQ = 60 + 140 * (AITASK(6) - 5) / 5\rEnd If\r'Apply multiplier\rAIMACHIQ = AIMACHIQ * aimachiqm\r\rEnd Sub\r"
  },
  {
    "Variable": "AITASKGR",
    "UsesVariable": "AITASK",
    "Distance": 0,
    "Code": "\rImports IFs.Data\r\rNamespace Models\r\rPartial Public Module Technology\r'\r'------------------------------------------InfraStr.Bas-------------------------------------\r'-------------------------------------------------------------------------------------------------------------------\r'International Futures System (IFs) - General Public License (GPL) Declaration\r'-------------------------------------------------------------------------------------------------------------------\r'\r'\r'    Copyright 1988-2009 Barry B. Hughes\r'\r'\r'    This file is part of International Futures (IFs) developed by Barry B. Hughes, bhughes@du.edu\r'\r'    IFs is free software: you can redistribute it and/or modify\r'    it under the terms of the GNU General Public License as published by\r'    the Free Software Foundation, either version 3 of the License, or\r'    (at your option) any later version.\r'\r'    IFs is distributed in the hope that it will be useful,\r'    but WITHOUT ANY WARRANTY; without even the implied warranty of\r'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r'    GNU General Public License for more details.\r'\r'    You should have received a copy of the GNU General Public License\r'    along with International Futures System Development Version. If not, please see http://www.gnu.org/licenses/\r'\r'    Developers of International Futures System are required to send the modified code to the IFs core team\r'    Developers should send such code updates, if any, twice every year, on April 1st and on October 1st\r'    Code updates should be sent to Frederick S. Pardee Center for International Futures (contact: pardee@du.edu)\r'-------------------------------------------------------------------------------------------------------------------\r'------------------------------------------------------------------------------------------\r'\r'\r\r\r'\r'   Copyright by Barry B. Hughes 1988-2017\r'   Model code available for review and education only\r'   Reproduction or incorporation in other software by permission only\r'\r\r' Technology made large populations possible; large populations now make technology indispensable.\r' Joseph Wood Krutch\r'Created by\r'jrs 2017/03/28\rDim SAITASK(), IAITASKGR(), IYEAR1(), IYEAR2() As Single\r\rPublic Sub ifsTechFirstYear(context As IForecastContext)\rReDim SAITASK(6), IAITASKGR(6), IYEAR1(6), IYEAR2(6)\rDim i As Integer\rFor i = 1 To 6\r'SAVE RESULTiNG VALUE\rSAITASK(i) = AITASK(i)\rIAITASKGR(i) = AITASKGR(i)\rNext i\rIf AITASK(6) < 5 Then\rAIMACHIQ = 60 * AITASK(6) / 5\rElse\rAIMACHIQ = 60 + 140 * (AITASK(6) - 5) / 5\rEnd If\r'Apply multiplier\rAIMACHIQ = AIMACHIQ * aimachiqm\rEnd Sub\r\r\rPublic Sub ifsTechAllbutFirstYear(context As IForecastContext)\r'All Years but First\r'-------------------\rDim i As Integer\rFor i = 1 To 6\r'Growth must start decreasing once level reaches 5\rIf SAITASK(i) < 5 Then\rAITASKGR(i) = IAITASKGR(i) * aitaskm(i)\rElse\rAITASKGR(i) = CSng(IAITASKGR(i) * ((10 - SAITASK(i)) / 5) ^ 2 * aitaskm(i))\rEnd If\r'Apply multiplier\r'AITASK(i) = AITASK(i) * aitaskm(i)\r'Check limits\rAITASK(i) = AMAX(Amin(AITASK(i), 10), 0)\r'Apply Growth\rAITASK(i) = SAITASK(i) * (1 + AITASKGR(i) / 100)\r'SAVE RESULTING VALUE\rSAITASK(i) = AITASK(i)\r'SAITASKGR(i) = AITASKGR(i)\rNext i\rIf AITASK(6) < 5 Then\rAIMACHIQ = 60 * AITASK(6) / 5\rElse\rAIMACHIQ = 60 + 140 * (AITASK(6) - 5) / 5\rEnd If\r'Apply multiplier\rAIMACHIQ = AIMACHIQ * aimachiqm\r\rEnd Sub\r"
  },
  {
    "Variable": "AITASKGR",
    "UsesVariable": "aitaskm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "AQUACUL",
    "UsesVariable": "aquaculm",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "AQUACUL",
    "UsesVariable": "aquaculgr",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "AQUACUL",
    "UsesVariable": "aquaculconv",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "AQUACUL",
    "UsesVariable": "aglossprodm",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "AQUACUL",
    "UsesVariable": "GDPPCP",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "ASAGDP",
    "UsesVariable": "WATUSE",
    "Distance": 0,
    "Code": "\rASAGDP(R%, 4) = WATUSE(R%) * 1000 / AMAX(0.001, GDP(R%)) '\r"
  },
  {
    "Variable": "ASAGDP",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ASAGDP",
    "UsesVariable": "LD",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "ASAGDP",
    "UsesVariable": "CARANN",
    "Distance": 0,
    "Code": "\rASAGDP(R%, 2) = CARANN(R%) * 1000 / AMAX(0.001, GDP(R%)) 'tons/1000 currency\r"
  },
  {
    "Variable": "ASAGDP",
    "UsesVariable": "ENP",
    "Distance": 26,
    "Code": "\rSumCarb(R%) = 0\r"
  },
  {
    "Variable": "ASAGDPCUMCHG",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ASAGDPDMAT",
    "UsesVariable": "ASAGDP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ASAGDPGRRB",
    "UsesVariable": "ASAGDP",
    "Distance": 0,
    "Code": "\r\rFor ICount% = 1 To 4\rASAGDPGRRB(R%, ICount%) = ASAGDP(R%, ICount%) * (GDP(R%) - GDPI(R%)) / 1000\rASAPOPGRRB(R%, ICount%) = ASAPOP(R%, ICount%) * (POP(R%) - popi(R%)) / 1000\rASALABGRRB(R%, ICount%) = ASALAB(R%, ICount%) * (LAB(R%) - LABI(R%)) / 1000\rNext ICount%\r"
  },
  {
    "Variable": "ASAGDPGRRB",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ASALAB",
    "UsesVariable": "WATUSE",
    "Distance": 0,
    "Code": "\rASALAB(R%, 4) = WATUSE(R%) * 1000 / AMAX(0.001, LAB(R%))\r"
  },
  {
    "Variable": "ASALAB",
    "UsesVariable": "LAB",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ASALAB",
    "UsesVariable": "LD",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "ASALAB",
    "UsesVariable": "CARANN",
    "Distance": 0,
    "Code": "\rASALAB(R%, 2) = CARANN(R%) * 1000 / AMAX(0.001, LAB(R%))\r"
  },
  {
    "Variable": "ASALAB",
    "UsesVariable": "ENP",
    "Distance": 28,
    "Code": "\rSumCarb(R%) = 0\r"
  },
  {
    "Variable": "ASALABCUMCHG",
    "UsesVariable": "LAB",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ASALABDMAT",
    "UsesVariable": "ASALAB",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ASALABGRRB",
    "UsesVariable": "ASALAB",
    "Distance": 0,
    "Code": "\r\rFor ICount% = 1 To 4\rASAGDPGRRB(R%, ICount%) = ASAGDP(R%, ICount%) * (GDP(R%) - GDPI(R%)) / 1000\rASAPOPGRRB(R%, ICount%) = ASAPOP(R%, ICount%) * (POP(R%) - popi(R%)) / 1000\rASALABGRRB(R%, ICount%) = ASALAB(R%, ICount%) * (LAB(R%) - LABI(R%)) / 1000\rNext ICount%\r\r"
  },
  {
    "Variable": "ASALABGRRB",
    "UsesVariable": "LAB",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ASAPOP",
    "UsesVariable": "WATUSE",
    "Distance": 0,
    "Code": "\rASAPOP(R%, 4) = WATUSE(R%) * 1000 / AMAX(0.001, POP(R%))\r"
  },
  {
    "Variable": "ASAPOP",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ASAPOP",
    "UsesVariable": "LD",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "ASAPOP",
    "UsesVariable": "CARANN",
    "Distance": 0,
    "Code": "\rASAPOP(R%, 2) = CARANN(R%) * 1000 / AMAX(0.001, POP(R%))\r"
  },
  {
    "Variable": "ASAPOP",
    "UsesVariable": "ENP",
    "Distance": 27,
    "Code": "\rSumCarb(R%) = 0\r"
  },
  {
    "Variable": "ASAPOPCUMCHG",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ASAPOPDMAT",
    "UsesVariable": "ASAPOP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ASAPOPGRRB",
    "UsesVariable": "ASAPOP",
    "Distance": 0,
    "Code": "\r\rFor ICount% = 1 To 4\rASAGDPGRRB(R%, ICount%) = ASAGDP(R%, ICount%) * (GDP(R%) - GDPI(R%)) / 1000\rASAPOPGRRB(R%, ICount%) = ASAPOP(R%, ICount%) * (POP(R%) - popi(R%)) / 1000\rASALABGRRB(R%, ICount%) = ASALAB(R%, ICount%) * (LAB(R%) - LABI(R%)) / 1000\rNext ICount%\r"
  },
  {
    "Variable": "ASAPOPGRRB",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ASARAW",
    "UsesVariable": "WATUSE",
    "Distance": 0,
    "Code": "\r\r\rASARAW(R%, 4) = WATUSE(R%)\r"
  },
  {
    "Variable": "ASARAW",
    "UsesVariable": "LD",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "ASARAW",
    "UsesVariable": "CARANN",
    "Distance": 0,
    "Code": "\r\rASARAW(R%, 2) = CARANN(R%)\r"
  },
  {
    "Variable": "ASARAW",
    "UsesVariable": "ENP",
    "Distance": 25,
    "Code": "\rSumCarb(R%) = 0\r\r'If GRPS(1, R) = \"Bosnia\" And IY = 2 Then Stop\rFor e% = Oil To Coal\rSumCarb(R%) = SumCarb(R%) + ENP(R%, e%)\rNext e%\r\r\r'       All Years:  ASA\r'       -----------------\rASARAW(R%, 1) = SumCarb(R%) 'Production side; could be switched to consumption side estimate\r"
  },
  {
    "Variable": "ASARAWDMAT",
    "UsesVariable": "ASARAW",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "BIRTHS",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\rFor j% = 1 To NCohorts\r'            FertDstM = FerDst(j%, r%) * FB(r%) * TFR(r%) / TFRI(r%)\rfertdstm = ferdst(j%, R%) / AMAX(0.0001, tfrdst(R%)) * TFR(R%)\r'jrs 2012/08/31\r'jrs 2019/07/26 If Not IsNull(fertdstm) Then\rBIRTHS(R%) = CSng(BIRTHS(R%) + agedst(j%, R%, 2) * fertdstm)\r'End If\rmodFERDST(j%, R%) = fertdstm * 1000\rNext j%\r"
  },
  {
    "Variable": "BIRTHS",
    "UsesVariable": "TFR",
    "Distance": 1,
    "Code": "\rFor j% = 0 To NCohorts\r'jrs 2012/08/31\r'jrs 2019/07/26 Not IsNull(ferdst(j%, R%)) AndAlso\rIf agedst(j, R, 2) > 0 Then 'jrs 2012/12/17 added and agedst(j,r,2)>0\r'jrs 2013/01/04 *** begin ***\rIf (j% * 5) < agestopT OrElse agestopT = 0 Then\rtfrdst(R%) = tfrdst(R%) + ferdst(j%, R%) * 5\rElseIf ferdst(j%, R%) > 0 AndAlso (agestopT - (j% - 1) * 5) > 0 Then\rtfrdst(R%) = tfrdst(R%) + ferdst(j%, R%) * (agestopT - (j% - 1) * 5)\rEnd If\r'jrs 2013/01/04 *** end ***\rEnd If\r'*5 because of 5 year cohorts\rNext j%\r\r'Rebuild Fertility Distribution with Target Parameters\rFor j% = 0 To NCohorts\r'1. 0 before ageinit, Initialization age\rIf (j% - 1) * 5 < ageinitT Then\rferdst(j%, R%) = 0\r'2. linear growth to peak\rElseIf (j% - 1) * 5 <= agepeakT Then\rIf agepeakT = ageinitT Then\rferdst(j%, R%) = peaklevelT / 1000\rElse\rferdst(j%, R%) = peaklevelT / 1000 * ((j% - 1) * 5 - ageinitT + 1) / (agepeakT - ageinitT + 1)\rEnd If\r'3. exponential drop from peak to menopause\rElseIf (j% - 1) * 5 < agestopT Then\rferdst(j%, R%) = peaklevelT / 1000 * (1 + grt) ^ ((j% - 1) * 5 - agepeakT)\rEnd If\rNext j%\r\rFor j% = 1 To NCohorts\r'            FertDstM = FerDst(j%, r%) * FB(r%) * TFR(r%) / TFRI(r%)\rfertdstm = ferdst(j%, R%) / AMAX(0.0001, tfrdst(R%)) * TFR(R%)\r'jrs 2012/08/31\r'jrs 2019/07/26 If Not IsNull(fertdstm) Then\rBIRTHS(R%) = CSng(BIRTHS(R%) + agedst(j%, R%, 2) * fertdstm)\r'End If\rmodFERDST(j%, R%) = fertdstm * 1000\rNext j%\r"
  },
  {
    "Variable": "BIRTHS",
    "UsesVariable": "hltfrpeaklevel",
    "Distance": 19,
    "Code": "0"
  },
  {
    "Variable": "BIRTHS",
    "UsesVariable": "hltfragepeak",
    "Distance": 20,
    "Code": "0"
  },
  {
    "Variable": "BIRTHS",
    "UsesVariable": "hltfragestop",
    "Distance": 21,
    "Code": "0"
  },
  {
    "Variable": "BIRTHS",
    "UsesVariable": "hltfragehalflife",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "HLSMOKING",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "hlsmokingceiling",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "cexovals",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "cconstsw",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "IGCF",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "CS",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "GDPRPA",
    "Distance": 202,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "elasit",
    "Distance": 202,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "VADD",
    "Distance": 861,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "WP",
    "Distance": 861,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "XWORKREMIT",
    "Distance": 0,
    "Code": "\r\r'bbh 2021/06/01 start\r'       All but First 4:  Adjust Consumption if Remittances have risen relative to Base Case\r'       -----------------------------------------------------------------------------------\r'                ReDim DeathsBase(IY)\r'                frm_MainMenu.IFsGUIctrl1.getLoadForDisplay \"DEATHS\", -1, GRPS(1, R%), R%, \"\", -1, \"\", -1, _\r'                \"\", 1, True, True, False, 1, DeathsBase, 1, 1, FirstYear, FirstYear + IY - 1, _\r'                0, True, \"\", False\r'                If DeathsBase(IY) > 0 Then\rIf NotBaseRun > 0.5 Then\rReDim REMITBASE(IY)\rIf dfBaseXWORKREMIT.RowCount > (IY - 1) * NR Then\rREMITBASE(IY) = CSng(dfBaseXWORKREMIT(getDataFrameIdxFromDims(CShort(FirstYear + IY - 1), FirstYear, CShort(R), CShort(NR))))\rEnd If\r\rIf XWORKREMIT(R%) - REMITBASE(IY) > 0.001 * C(R%) Then\r'If RegName$(R%) = \"Yemen\" Then Stop\rC(R%) = CSng(C(R%) + Amin(0.1 * C(R%), XWORKREMIT(R%) - REMITBASE(IY)))\r'bbh 2021/06/15 C(R%) = Amin(C(R%), HHINCDIS(R%, Unskilled) + HHINCDIS(R%, Skilled))\rEnd If\rEnd If\r"
  },
  {
    "Variable": "C",
    "UsesVariable": "enon",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "agon",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "GDPPOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "GDPPCP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "GDP",
    "Distance": 1950,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "HHINCDIS",
    "Distance": 106,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "HHINCDISPERM",
    "Distance": 106,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "gdprext",
    "Distance": 106,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "invm",
    "Distance": 2,
    "Code": "\riadj = IGCF(R%) * (invm(R%) - 1) ' + lifexpterm\r"
  },
  {
    "Variable": "C",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "HHSAVSURSTOCK",
    "Distance": 59,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "ST",
    "Distance": 500,
    "Code": "\rExcessSt(R%) = 0\r"
  },
  {
    "Variable": "C",
    "UsesVariable": "dstl",
    "Distance": 500,
    "Code": "\r\r'   First Year: Compute Initial Stocks and Recompute Stock Ratio\r'       Based on Computed VADD\r'   ------------------------------------------------------------\rFor S% = 1 To NSec%\rims(R%, S%) = MS(R%, S%)\r'bbh 2020/08/03 Start; need to switch stock base from ZS to VADD because over time\r'   the ratio of ZS/VADD changes (in China manufacturing almost doubles); VADD/PFD more stable\r'   Perhaps should even be PFD given the close link of PFD to stock accummulation\r'   Problem with ZS is that over time the swings of ST and CAPUT become reinforcing and very large\rStBase(R%, S%) = ZS(R%, S%) + ims(R%, S%)\r'StBase(R%, S%) = PFD(R%, S%) + ims(R%, S%) 'bbh 2022/10/27\rMovAvgMS(R%, S%) = ims(R%, S%) 'bbh 2022/10/27\r'StBase(R%, S%) = VADD(R%, S%) + ims(R%, S%)\r'bbh 2020/08/03 end\rSMS(R%, S%) = MS(R%, S%) 'bbh 2019/09/13\r\r'mti 2018/10/01 Start\r'            sms(R%, S%) = MS(R%, S%)\r'            StBase(R%, S%) = ZS(R%, S%) + sms(R%, S%)\r'mti 2018/10/01 End\r\rST(R%, S%) = StBase(R%, S%) * dstl\rNext S%\r\rFor S% = 1 To NSec%\r'If RegName$(R%) = \"China\" And S% = 2 Then Stop\r\r'bbh 2020/08/03 Start\rStBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%) 'bbh 2021/09/30 ims DOES NOT grow and fixed causes problems, e.g. Vietnam materials\r'StBase(R%, S%) = PFD(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%) 'bbh 2022/10/27\r'StBase(R%, S%) = PFD(R%, S%) + MovAvgMS(R%, S%) 'bbh 2022/10/27 Replaced line above for more control over import contribution to stock need\r'StBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) 'bbh 2021/09/21 ims itself grows; GTPPOT/GDPI was causing problems\r'for countries like China with large stock demands\r'StBase(R%, S%) = VADD(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%)\r'bbh 2020/08/03 end\r\r'mti 2018/10/01 Start\r'            StBase(R%, S%) = zsp(R%, S%) + sms(R%, S%)\r'mti 2018/10/01 End\rIf ((S% > Ener) OrElse (S% = Agri AndAlso agon < 0.9) OrElse (S% = Ener AndAlso enon < 0.9)) Then\rDiff1 = SST(R%, S%) - dstl * StBase(R%, S%)\r'Diff2 = sst(R%, S%) - SSTS(R%, S%) * (1! + igdpr(R%))\rDiff2 = SST(R%, S%) - SSTS(R%, S%) * (1.0! + igdprcor(R%))\rCall ADJSTR(StBase(R%, S%), Diff1, Diff2, elinst1, elinst2, Mul)\r'mti 2018/07/02 Start\rIDS(R%, S%) = IGCF(R%) * IDK(R%, S%) * idsm(R%, S%) * Mul\r'mti 2018/07/02 End\rEnd If\rMinIDS = IDK(R%, S%) * IGCF(R%) * 0.5!\r'If GRPS(1, R%) = \"Guinea Bissau\" And S% = 2 And IY >= 7 Then Stop\rIDS(R%, S%) = AMAX(MinIDS, Amin(IDS(R%, S%), IGCF(R%)))\r\r\r\rIf S% = 1 Then\rIDS(R%, S%) = CSng(Amin(IGCF(R%) * 0.3, Amin(IGCF(R%) * sidk(R%, S%) * 2.5, IDS(R%, S%))))\r'If RegName$(R%) = \"Congo, Democratic Republic Of\" And IY% >= 50 Then Stop\rEnd If\rIf S% = 2 Then\r'jrs 2022/04/18\r'if IGCF(R%) * sidk(R%, S%) > 0.1 then\r'jrs 2022/05/02 If GRPS(1, R%) <> \"Guinea Bissau\" Or context.HistoricMode = True Then\rIf ennoprodsw(R%) = 0 Or context.HistoricMode = True Then\rIDS(R%, S%) = CSng(Amin(IGCF(R%) * 0.5, Amin(IGCF(R%) * sidk(R%, S%) * 3, IDS(R%, S%))))\rEnd If\rEnd If\r\rtids = tids + IDS(R%, S%)\rNext S%\r"
  },
  {
    "Variable": "C",
    "UsesVariable": "INTR",
    "Distance": 1944,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "ZS",
    "Distance": 2490,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "HHSAV",
    "Distance": 1153,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "FIRMSAV",
    "Distance": 1153,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "MS",
    "Distance": 2331,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "POPPREWORK",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "workageentry",
    "Distance": 19,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "POPWORKING",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "cpctnduse",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "POPRETIRED",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "workageretire",
    "Distance": 17,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "LIFEXP",
    "Distance": 17,
    "Code": "\r\rIf cpctnduse(R%) > 0 Then\r'bbh 2014/06/18 start\r'Find Savings needed at needed retirement age\r'Annuity of 20 during working years PV = C * [(1-(1+i)^-n)/i]\rSavingsNew(R%) = CSng(20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - WORKAGERETIREND(R%))) /\r               (savingsdiscountrt(R%) / 100)))\r'Find current Savings\rSavingsOld(R%) = CSng(20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - workageretire(R%))) /\r               (savingsdiscountrt(R%) / 100)))\r'Find hole in $\rSavingsNeeded(R%) = SavingsNew(R%) - SavingsOld(R%)\r\r\rSavingsNeeded(R%) = SavingsNeeded(R%) * cpctnduse(R%) / 100\rSavingsAdjustNeeded = SavingsNeeded(R%) / AMAX(0.0001, SavingsOld(R%)) * 100\rworkercon = workercon - Amin(15, AMAX(0, SavingsAdjustNeeded))\r\r'            'jrs 2013/05/28\r'            TotSavingsNeeded = SavingsOld(R%) + SavingsNeeded(R%) * cpctnduse(R%) / 100\r'            'C = PV/((1-(1+i)^-n)/i)\r'            TotSavingsNeeded = TotSavingsNeeded / _\r'                ((1 - (1 + savingsdiscountrt(R%)) ^ (workageentry(R%) - workageretiresv)) _\r'                / savingsdiscountrt(R%) / 100)\r'            workercon = 100 - TotSavingsNeeded 'May replace function based computation above\r'bbh 2014/06/18 end\rEnd If\r"
  },
  {
    "Variable": "C",
    "UsesVariable": "savingsdiscountrt",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "C",
    "UsesVariable": "WORKAGERETIREND",
    "Distance": 14,
    "Code": "\r\rIf cpctnduse(R%) > 0 Then\r'bbh 2014/06/18 start\r'Find Savings needed at needed retirement age\r'Annuity of 20 during working years PV = C * [(1-(1+i)^-n)/i]\rSavingsNew(R%) = CSng(20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - WORKAGERETIREND(R%))) /\r               (savingsdiscountrt(R%) / 100)))\r'Find current Savings\rSavingsOld(R%) = CSng(20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - workageretire(R%))) /\r               (savingsdiscountrt(R%) / 100)))\r'Find hole in $\rSavingsNeeded(R%) = SavingsNew(R%) - SavingsOld(R%)\r\r\rSavingsNeeded(R%) = SavingsNeeded(R%) * cpctnduse(R%) / 100\rSavingsAdjustNeeded = SavingsNeeded(R%) / AMAX(0.0001, SavingsOld(R%)) * 100\rworkercon = workercon - Amin(15, AMAX(0, SavingsAdjustNeeded))\r\r'            'jrs 2013/05/28\r'            TotSavingsNeeded = SavingsOld(R%) + SavingsNeeded(R%) * cpctnduse(R%) / 100\r'            'C = PV/((1-(1+i)^-n)/i)\r'            TotSavingsNeeded = TotSavingsNeeded / _\r'                ((1 - (1 + savingsdiscountrt(R%)) ^ (workageentry(R%) - workageretiresv)) _\r'                / savingsdiscountrt(R%) / 100)\r'            workercon = 100 - TotSavingsNeeded 'May replace function based computation above\r'bbh 2014/06/18 end\rEnd If\r"
  },
  {
    "Variable": "C",
    "UsesVariable": "CRA",
    "Distance": 2,
    "Code": "\r'HHINCDISPERM(R%, Total) = HHINCDIS(R%, Unskilled) + HHINCDIS(R%, Skilled)\rIf gdprext(R%) > -80 Then\r'Shocks like COVID do not pass through through well with moving average, need current year income\rhhincskilled = HHINCDIS(R%, Skilled)\rhhincunskilled = HHINCDIS(R%, Unskilled)\r'jrs 2022/05/25\rLastExogenousYear(R%) = IY\rElse\r'            hhincskilled = hhdispincperm(R%, Skilled)\r'            hhincunskilled = hhdispincperm(R%, Unskilled)\r\r'jrs 2022/05/25 *** start ***\r'hhincskilled = HHINCDISPERM(R%, Skilled)\r'hhincunskilled = HHINCDISPERM(R%, Unskilled)\rhhincskilled = ConvergeOverTimeStartX(HHINCDIS(R%, Skilled), HHINCDISPERM(R%, Skilled), LastExogenousYear(R%) + 5, LastExogenousYear(R%))\rhhincunskilled = ConvergeOverTimeStartX(HHINCDIS(R%, Unskilled), HHINCDISPERM(R%, Unskilled), LastExogenousYear(R%) + 5, LastExogenousYear(R%))\r'jrs 2022/05/25 *** end ***\rEnd If\r"
  },
  {
    "Variable": "CAPUT",
    "UsesVariable": "caputtar",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CAPUT",
    "UsesVariable": "dstl",
    "Distance": 2,
    "Code": "\rPar2 = elerca2 * Mul * 2 '*2 helps avoid overshoot of debtor correction into net assets (e.g. Timor-Leste does without *2)\r\rPar1 = elerca1 * Mul\r\r\r'bbh 2022/09/05 If/then added mostly to smooth oscillation in Luxembourg from very high asset ratios to GDP\rIf XDEBTRPA(R%) / GDPPOT(R%) < -1 Then\rDiff1 = Diff1 / Abs(XDEBTRPA(R%) / GDPPOT(R%))\rDiff2 = Diff2 / Abs(XDEBTRPA(R%) / GDPPOT(R%))\rEnd If\r\r\r'bbh 2022/09/05 If/then added mostly to smooth oscillation in Luxembourg from very high asset ratios to GDP\rIf XDEBTRPA(R%) / GDPPOT(R%) < -1 Then\rDiff1 = Diff1 / Abs(XDEBTRPA(R%) / GDPPOT(R%))\rDiff2 = Diff2 / Abs(XDEBTRPA(R%) / GDPPOT(R%))\rEnd If\r\rSCaputErr(R%, NSec%) = 0 'bbh 2020/08/04\r\rElse\r'bbh 2020/08/22 start  - CAPUT for partial equilibrium models handled there in other ways\rIf ((S% > Ener) Or (S% = Agri And agon < 0.9) Or (S% = Ener And enon < 0.9)) Then\r'If R% = 1 And S% = 3 Then Stop\r'bbh 2020/08/03 Start  Consider replacing zs/zsp with VADD and ims with sims\rStBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%) 'bbh 2021/09/30 ims DOES NOT grow and fixed causes problems, e.g. Vietnam materials\r'StBase(R%, S%) = PFD(R%, S%) + MovAvgMS(R%, S%) 'bbh 2022/10/27 Replaced line above for more control over import contribution to stock need\r'StBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) 'bbh 2021/09/21 ims itself grows; GTPPOT/GDPI was causing problems\r'StBase(R%, S%) = VADD(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%)\r'bbh 2020/08/03 end\rcaput_1 = (dstl * StBase(R%, S%) - SST(R%, S%) * (1 + IGDPRCor(R%))) / StBase(R%, S%)\r'bbh 2020/07/01  - allow a stock deviation to have some lasting impact but\r'drifting back toward target; materials and ICT sectors are imbalanced initially and\r'have stock swings; needs some subsequent attention, not treating different here\r'problem:  I am changing value of elaszs by sector but it is scalar; should dimension\r'by sector, fix in global parameters, and replace hard-coded numbers with elaszs(s%)\r'CAPUT(R%, S%) = caputtar + caput_1 * 0.7 'elaszs\r'bbh 2020/07/23 start\r'            If S% = Mate Or S% = ICT Then\r'                CAPUT(R%, S%) = caputtar + caput_1 * 0.3 'elaszs\r'            Else\r'                CAPUT(R%, S%) = caputtar + caput_1 * 0.7 'elaszs\r'                CAPUT(R%, S%) = SCAPUT(R%, S%) * 0.8 + CAPUT(R%, S%) * 0.2\r'            End If\r\r'            If S% = Mate Or S% = ICT Then\r'                CAPUT(R%, S%) = caputtar + caput_1 * 0.5 'elaszs\r'            Else\r'                CAPUT(R%, S%) = caputtar + caput_1 * 0.7  'elaszs\r'                CAPUT(R%, S%) = SCAPUT(R%, S%) * 0.9 + CAPUT(R%, S%) * 0.1\r'bbh 2020/07/31 make caput more responsive to stocks\r'CAPUT(R%, S%) = caputtar + caput_1 * 1#   'elaszs\r'                If S% = 6 Then\r'                    CAPUT(R%, S%) = SCAPUT(R%, S%) + caput_1 * 0.8     'elaszs\r'                    CAPUT(R%, S%) = SCAPUT(R%, S%) * 0.7 + CAPUT(R%, S%) * 0.3\rDim Mul As Single\r'Call ADJSTR(1, caput_1, caput_1 - SCaputErr(R%, S%), 0.2, 0.4, Mul)\rCall ADJSTR(1, caput_1, caput_1 - SCaputErr(R%, S%), 0.1, 0.2, Mul) 'bbh 2020/11/22 reduced CAPUT swing\r'If RegName$(R%) = \"India\" And IY% > 6 Then Stop\rCAPUT(R%, S%) = SCAPUT(R%, S%) * Mul\rCAPUT(R%, S%) = CSng(CAPUT(R%, S%) * 0.9 + caputtar * 0.1) 'bbh 2021/08/04 Anchor caput ultimately to target\r'bbh 2020/11/10 Timor-Leste was going wild on CAPUT; some other countries wildly swinging also.\rCAPUT(R%, S%) = CSng(Amin(1.2, AMAX(0.5, CAPUT(R%, S%))))\rSCaputErr(R%, S%) = caput_1\r\r'bbh 2020/11/22 start Code below involved false starts around different ideas to adjust CAPUT to offset adjustments in TEFF\r'                        If (gdprext(R%) > -70) And (IY% - 1 + FirstYear = 2025) Then\r'                            CAPUT(R%, S%) = caputtar\r'                            SCaputErr(R%, NSec%) = 0\r'                        End If\r'                        If (gdprext(R%) > -70) Then\r'                            CAPUT(R%, S%) = caputtar + AMAX(0#, Amin(1#, (1# - tfpshockadjshr(R%)))) * (CAPUT(R%, S%) - caputtar)\r'                            SCaputErr(R%, NSec%) = 0\r'                        End If\r'bbh 2020/11/22 end\r\r'                Else\r'                    CAPUT(R%, S%) = SCAPUT(R%, S%) + caput_1 * 1#    'elaszs\r'                    CAPUT(R%, S%) = SCAPUT(R%, S%) * 0.9 + CAPUT(R%, S%) * 0.1\r'                End If\r'            End If\r'CAPUT(R%, S%) = AMAX(0.5, Amin(1, CAPUT(R%, S%)))\r'If RegName(R%) = \"Uganda\" Then CAPUT(R%, S%) = caputtar\r'test to see if stock problem in late yaars is CAPUT reated\r'CAPUT(R%, S%) = caputtar\rSCAPUT(R%, S%) = CAPUT(R%, S%)\rElse\rCAPUT(R%, S%) = caputtar\rSCAPUT(R%, S%) = CAPUT(R%, S%)\r'bbh 2020/07/23 end\rEnd If\r\r\r'bbh 2014/04/02 End Reworked exchange rate logic\r\r'Diff1 = XGOVTDEBT(R%) - XGovtDebtTargetPerGDP * GDPPOT(R%)\r'Diff2 = XGOVTDEBT(R%) - SSXGovtDebt(R%)\r'bbh 2019/01/21 2 lines\r'Call ADJSTR(GDPPOT(R%), Diff1, Diff2, Par1, Par2, Mul)\rCall ADJSTR(200, Diff1, Diff2, Par1, Par2, Mul)\r\rElse\r'bbh 2020/08/22 start  - CAPUT for partial equilibrium models handled there in other ways\rIf ((S% > Ener) Or (S% = Agri And agon < 0.9) Or (S% = Ener And enon < 0.9)) Then\r'If R% = 1 And S% = 3 Then Stop\r'bbh 2020/08/03 Start  Consider replacing zs/zsp with VADD and ims with sims\rStBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%) 'bbh 2021/09/30 ims DOES NOT grow and fixed causes problems, e.g. Vietnam materials\r'StBase(R%, S%) = PFD(R%, S%) + MovAvgMS(R%, S%) 'bbh 2022/10/27 Replaced line above for more control over import contribution to stock need\r'StBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) 'bbh 2021/09/21 ims itself grows; GTPPOT/GDPI was causing problems\r'StBase(R%, S%) = VADD(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%)\r'bbh 2020/08/03 end\rcaput_1 = (dstl * StBase(R%, S%) - SST(R%, S%) * (1 + IGDPRCor(R%))) / StBase(R%, S%)\r'bbh 2020/07/01  - allow a stock deviation to have some lasting impact but\r'drifting back toward target; materials and ICT sectors are imbalanced initially and\r'have stock swings; needs some subsequent attention, not treating different here\r'problem:  I am changing value of elaszs by sector but it is scalar; should dimension\r'by sector, fix in global parameters, and replace hard-coded numbers with elaszs(s%)\r'CAPUT(R%, S%) = caputtar + caput_1 * 0.7 'elaszs\r'bbh 2020/07/23 start\r'            If S% = Mate Or S% = ICT Then\r'                CAPUT(R%, S%) = caputtar + caput_1 * 0.3 'elaszs\r'            Else\r'                CAPUT(R%, S%) = caputtar + caput_1 * 0.7 'elaszs\r'                CAPUT(R%, S%) = SCAPUT(R%, S%) * 0.8 + CAPUT(R%, S%) * 0.2\r'            End If\r\r'            If S% = Mate Or S% = ICT Then\r'                CAPUT(R%, S%) = caputtar + caput_1 * 0.5 'elaszs\r'            Else\r'                CAPUT(R%, S%) = caputtar + caput_1 * 0.7  'elaszs\r'                CAPUT(R%, S%) = SCAPUT(R%, S%) * 0.9 + CAPUT(R%, S%) * 0.1\r'bbh 2020/07/31 make caput more responsive to stocks\r'CAPUT(R%, S%) = caputtar + caput_1 * 1#   'elaszs\r'                If S% = 6 Then\r'                    CAPUT(R%, S%) = SCAPUT(R%, S%) + caput_1 * 0.8     'elaszs\r'                    CAPUT(R%, S%) = SCAPUT(R%, S%) * 0.7 + CAPUT(R%, S%) * 0.3\rDim Mul As Single\r'Call ADJSTR(1, caput_1, caput_1 - SCaputErr(R%, S%), 0.2, 0.4, Mul)\rCall ADJSTR(1, caput_1, caput_1 - SCaputErr(R%, S%), 0.1, 0.2, Mul) 'bbh 2020/11/22 reduced CAPUT swing\r'If RegName$(R%) = \"India\" And IY% > 6 Then Stop\rCAPUT(R%, S%) = SCAPUT(R%, S%) * Mul\rCAPUT(R%, S%) = CSng(CAPUT(R%, S%) * 0.9 + caputtar * 0.1) 'bbh 2021/08/04 Anchor caput ultimately to target\r'bbh 2020/11/10 Timor-Leste was going wild on CAPUT; some other countries wildly swinging also.\rCAPUT(R%, S%) = CSng(Amin(1.2, AMAX(0.5, CAPUT(R%, S%))))\rSCaputErr(R%, S%) = caput_1\r\r'bbh 2020/11/22 start Code below involved false starts around different ideas to adjust CAPUT to offset adjustments in TEFF\r'                        If (gdprext(R%) > -70) And (IY% - 1 + FirstYear = 2025) Then\r'                            CAPUT(R%, S%) = caputtar\r'                            SCaputErr(R%, NSec%) = 0\r'                        End If\r'                        If (gdprext(R%) > -70) Then\r'                            CAPUT(R%, S%) = caputtar + AMAX(0#, Amin(1#, (1# - tfpshockadjshr(R%)))) * (CAPUT(R%, S%) - caputtar)\r'                            SCaputErr(R%, NSec%) = 0\r'                        End If\r'bbh 2020/11/22 end\r\r'                Else\r'                    CAPUT(R%, S%) = SCAPUT(R%, S%) + caput_1 * 1#    'elaszs\r'                    CAPUT(R%, S%) = SCAPUT(R%, S%) * 0.9 + CAPUT(R%, S%) * 0.1\r'                End If\r'            End If\r'CAPUT(R%, S%) = AMAX(0.5, Amin(1, CAPUT(R%, S%)))\r'If RegName(R%) = \"Uganda\" Then CAPUT(R%, S%) = caputtar\r'test to see if stock problem in late yaars is CAPUT reated\r'CAPUT(R%, S%) = caputtar\rSCAPUT(R%, S%) = CAPUT(R%, S%)\rElse\rCAPUT(R%, S%) = caputtar\rSCAPUT(R%, S%) = CAPUT(R%, S%)\r'bbh 2020/07/23 end\rEnd If\r\rElse\r'bbh 2020/08/22 start  - CAPUT for partial equilibrium models handled there in other ways\rIf ((S% > Ener) Or (S% = Agri And agon < 0.9) Or (S% = Ener And enon < 0.9)) Then\r'If R% = 1 And S% = 3 Then Stop\r'bbh 2020/08/03 Start  Consider replacing zs/zsp with VADD and ims with sims\rStBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%) 'bbh 2021/09/30 ims DOES NOT grow and fixed causes problems, e.g. Vietnam materials\r'StBase(R%, S%) = PFD(R%, S%) + MovAvgMS(R%, S%) 'bbh 2022/10/27 Replaced line above for more control over import contribution to stock need\r'StBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) 'bbh 2021/09/21 ims itself grows; GTPPOT/GDPI was causing problems\r'StBase(R%, S%) = VADD(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%)\r'bbh 2020/08/03 end\rcaput_1 = (dstl * StBase(R%, S%) - SST(R%, S%) * (1 + IGDPRCor(R%))) / StBase(R%, S%)\r'bbh 2020/07/01  - allow a stock deviation to have some lasting impact but\r'drifting back toward target; materials and ICT sectors are imbalanced initially and\r'have stock swings; needs some subsequent attention, not treating different here\r'problem:  I am changing value of elaszs by sector but it is scalar; should dimension\r'by sector, fix in global parameters, and replace hard-coded numbers with elaszs(s%)\r'CAPUT(R%, S%) = caputtar + caput_1 * 0.7 'elaszs\r'bbh 2020/07/23 start\r'            If S% = Mate Or S% = ICT Then\r'                CAPUT(R%, S%) = caputtar + caput_1 * 0.3 'elaszs\r'            Else\r'                CAPUT(R%, S%) = caputtar + caput_1 * 0.7 'elaszs\r'                CAPUT(R%, S%) = SCAPUT(R%, S%) * 0.8 + CAPUT(R%, S%) * 0.2\r'            End If\r\r'            If S% = Mate Or S% = ICT Then\r'                CAPUT(R%, S%) = caputtar + caput_1 * 0.5 'elaszs\r'            Else\r'                CAPUT(R%, S%) = caputtar + caput_1 * 0.7  'elaszs\r'                CAPUT(R%, S%) = SCAPUT(R%, S%) * 0.9 + CAPUT(R%, S%) * 0.1\r'bbh 2020/07/31 make caput more responsive to stocks\r'CAPUT(R%, S%) = caputtar + caput_1 * 1#   'elaszs\r'                If S% = 6 Then\r'                    CAPUT(R%, S%) = SCAPUT(R%, S%) + caput_1 * 0.8     'elaszs\r'                    CAPUT(R%, S%) = SCAPUT(R%, S%) * 0.7 + CAPUT(R%, S%) * 0.3\rDim Mul As Single\r'Call ADJSTR(1, caput_1, caput_1 - SCaputErr(R%, S%), 0.2, 0.4, Mul)\rCall ADJSTR(1, caput_1, caput_1 - SCaputErr(R%, S%), 0.1, 0.2, Mul) 'bbh 2020/11/22 reduced CAPUT swing\r'If RegName$(R%) = \"India\" And IY% > 6 Then Stop\rCAPUT(R%, S%) = SCAPUT(R%, S%) * Mul\rCAPUT(R%, S%) = CSng(CAPUT(R%, S%) * 0.9 + caputtar * 0.1) 'bbh 2021/08/04 Anchor caput ultimately to target\r'bbh 2020/11/10 Timor-Leste was going wild on CAPUT; some other countries wildly swinging also.\rCAPUT(R%, S%) = CSng(Amin(1.2, AMAX(0.5, CAPUT(R%, S%))))\rSCaputErr(R%, S%) = caput_1\r\r'bbh 2020/11/22 start Code below involved false starts around different ideas to adjust CAPUT to offset adjustments in TEFF\r'                        If (gdprext(R%) > -70) And (IY% - 1 + FirstYear = 2025) Then\r'                            CAPUT(R%, S%) = caputtar\r'                            SCaputErr(R%, NSec%) = 0\r'                        End If\r'                        If (gdprext(R%) > -70) Then\r'                            CAPUT(R%, S%) = caputtar + AMAX(0#, Amin(1#, (1# - tfpshockadjshr(R%)))) * (CAPUT(R%, S%) - caputtar)\r'                            SCaputErr(R%, NSec%) = 0\r'                        End If\r'bbh 2020/11/22 end\r\r'                Else\r'                    CAPUT(R%, S%) = SCAPUT(R%, S%) + caput_1 * 1#    'elaszs\r'                    CAPUT(R%, S%) = SCAPUT(R%, S%) * 0.9 + CAPUT(R%, S%) * 0.1\r'                End If\r'            End If\r'CAPUT(R%, S%) = AMAX(0.5, Amin(1, CAPUT(R%, S%)))\r'If RegName(R%) = \"Uganda\" Then CAPUT(R%, S%) = caputtar\r'test to see if stock problem in late yaars is CAPUT reated\r'CAPUT(R%, S%) = caputtar\rSCAPUT(R%, S%) = CAPUT(R%, S%)\rElse\rCAPUT(R%, S%) = caputtar\rSCAPUT(R%, S%) = CAPUT(R%, S%)\r'bbh 2020/07/23 end\rEnd If\r"
  },
  {
    "Variable": "CAPUT",
    "UsesVariable": "ST",
    "Distance": 2,
    "Code": "\r\r'   First Year: Compute Initial Stocks and Recompute Stock Ratio\r'       Based on Computed VADD\r'   ------------------------------------------------------------\rFor S% = 1 To NSec%\rims(R%, S%) = MS(R%, S%)\r'bbh 2020/08/03 Start; need to switch stock base from ZS to VADD because over time\r'   the ratio of ZS/VADD changes (in China manufacturing almost doubles); VADD/PFD more stable\r'   Perhaps should even be PFD given the close link of PFD to stock accummulation\r'   Problem with ZS is that over time the swings of ST and CAPUT become reinforcing and very large\rStBase(R%, S%) = ZS(R%, S%) + ims(R%, S%)\r'StBase(R%, S%) = PFD(R%, S%) + ims(R%, S%) 'bbh 2022/10/27\rMovAvgMS(R%, S%) = ims(R%, S%) 'bbh 2022/10/27\r'StBase(R%, S%) = VADD(R%, S%) + ims(R%, S%)\r'bbh 2020/08/03 end\rSMS(R%, S%) = MS(R%, S%) 'bbh 2019/09/13\r\r'mti 2018/10/01 Start\r'            sms(R%, S%) = MS(R%, S%)\r'            StBase(R%, S%) = ZS(R%, S%) + sms(R%, S%)\r'mti 2018/10/01 End\r\rST(R%, S%) = StBase(R%, S%) * dstl\rNext S%\r\rFor S% = 1 To NSec%\r'If RegName$(R%) = \"China\" And S% = 2 Then Stop\r\r'bbh 2020/08/03 Start\rStBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%) 'bbh 2021/09/30 ims DOES NOT grow and fixed causes problems, e.g. Vietnam materials\r'StBase(R%, S%) = PFD(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%) 'bbh 2022/10/27\r'StBase(R%, S%) = PFD(R%, S%) + MovAvgMS(R%, S%) 'bbh 2022/10/27 Replaced line above for more control over import contribution to stock need\r'StBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) 'bbh 2021/09/21 ims itself grows; GTPPOT/GDPI was causing problems\r'for countries like China with large stock demands\r'StBase(R%, S%) = VADD(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%)\r'bbh 2020/08/03 end\r\r'mti 2018/10/01 Start\r'            StBase(R%, S%) = zsp(R%, S%) + sms(R%, S%)\r'mti 2018/10/01 End\rIf ((S% > Ener) OrElse (S% = Agri AndAlso agon < 0.9) OrElse (S% = Ener AndAlso enon < 0.9)) Then\rDiff1 = SST(R%, S%) - dstl * StBase(R%, S%)\r'Diff2 = sst(R%, S%) - SSTS(R%, S%) * (1! + igdpr(R%))\rDiff2 = SST(R%, S%) - SSTS(R%, S%) * (1.0! + igdprcor(R%))\rCall ADJSTR(StBase(R%, S%), Diff1, Diff2, elinst1, elinst2, Mul)\r'mti 2018/07/02 Start\rIDS(R%, S%) = IGCF(R%) * IDK(R%, S%) * idsm(R%, S%) * Mul\r'mti 2018/07/02 End\rEnd If\rMinIDS = IDK(R%, S%) * IGCF(R%) * 0.5!\r'If GRPS(1, R%) = \"Guinea Bissau\" And S% = 2 And IY >= 7 Then Stop\rIDS(R%, S%) = AMAX(MinIDS, Amin(IDS(R%, S%), IGCF(R%)))\r\r\r\rIf S% = 1 Then\rIDS(R%, S%) = CSng(Amin(IGCF(R%) * 0.3, Amin(IGCF(R%) * sidk(R%, S%) * 2.5, IDS(R%, S%))))\r'If RegName$(R%) = \"Congo, Democratic Republic Of\" And IY% >= 50 Then Stop\rEnd If\rIf S% = 2 Then\r'jrs 2022/04/18\r'if IGCF(R%) * sidk(R%, S%) > 0.1 then\r'jrs 2022/05/02 If GRPS(1, R%) <> \"Guinea Bissau\" Or context.HistoricMode = True Then\rIf ennoprodsw(R%) = 0 Or context.HistoricMode = True Then\rIDS(R%, S%) = CSng(Amin(IGCF(R%) * 0.5, Amin(IGCF(R%) * sidk(R%, S%) * 3, IDS(R%, S%))))\rEnd If\rEnd If\r\rtids = tids + IDS(R%, S%)\rNext S%\r\rElse\r'bbh 2020/08/22 start  - CAPUT for partial equilibrium models handled there in other ways\rIf ((S% > Ener) Or (S% = Agri And agon < 0.9) Or (S% = Ener And enon < 0.9)) Then\r'If R% = 1 And S% = 3 Then Stop\r'bbh 2020/08/03 Start  Consider replacing zs/zsp with VADD and ims with sims\rStBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%) 'bbh 2021/09/30 ims DOES NOT grow and fixed causes problems, e.g. Vietnam materials\r'StBase(R%, S%) = PFD(R%, S%) + MovAvgMS(R%, S%) 'bbh 2022/10/27 Replaced line above for more control over import contribution to stock need\r'StBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) 'bbh 2021/09/21 ims itself grows; GTPPOT/GDPI was causing problems\r'StBase(R%, S%) = VADD(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%)\r'bbh 2020/08/03 end\rcaput_1 = (dstl * StBase(R%, S%) - SST(R%, S%) * (1 + IGDPRCor(R%))) / StBase(R%, S%)\r'bbh 2020/07/01  - allow a stock deviation to have some lasting impact but\r'drifting back toward target; materials and ICT sectors are imbalanced initially and\r'have stock swings; needs some subsequent attention, not treating different here\r'problem:  I am changing value of elaszs by sector but it is scalar; should dimension\r'by sector, fix in global parameters, and replace hard-coded numbers with elaszs(s%)\r'CAPUT(R%, S%) = caputtar + caput_1 * 0.7 'elaszs\r'bbh 2020/07/23 start\r'            If S% = Mate Or S% = ICT Then\r'                CAPUT(R%, S%) = caputtar + caput_1 * 0.3 'elaszs\r'            Else\r'                CAPUT(R%, S%) = caputtar + caput_1 * 0.7 'elaszs\r'                CAPUT(R%, S%) = SCAPUT(R%, S%) * 0.8 + CAPUT(R%, S%) * 0.2\r'            End If\r\r'            If S% = Mate Or S% = ICT Then\r'                CAPUT(R%, S%) = caputtar + caput_1 * 0.5 'elaszs\r'            Else\r'                CAPUT(R%, S%) = caputtar + caput_1 * 0.7  'elaszs\r'                CAPUT(R%, S%) = SCAPUT(R%, S%) * 0.9 + CAPUT(R%, S%) * 0.1\r'bbh 2020/07/31 make caput more responsive to stocks\r'CAPUT(R%, S%) = caputtar + caput_1 * 1#   'elaszs\r'                If S% = 6 Then\r'                    CAPUT(R%, S%) = SCAPUT(R%, S%) + caput_1 * 0.8     'elaszs\r'                    CAPUT(R%, S%) = SCAPUT(R%, S%) * 0.7 + CAPUT(R%, S%) * 0.3\rDim Mul As Single\r'Call ADJSTR(1, caput_1, caput_1 - SCaputErr(R%, S%), 0.2, 0.4, Mul)\rCall ADJSTR(1, caput_1, caput_1 - SCaputErr(R%, S%), 0.1, 0.2, Mul) 'bbh 2020/11/22 reduced CAPUT swing\r'If RegName$(R%) = \"India\" And IY% > 6 Then Stop\rCAPUT(R%, S%) = SCAPUT(R%, S%) * Mul\rCAPUT(R%, S%) = CSng(CAPUT(R%, S%) * 0.9 + caputtar * 0.1) 'bbh 2021/08/04 Anchor caput ultimately to target\r'bbh 2020/11/10 Timor-Leste was going wild on CAPUT; some other countries wildly swinging also.\rCAPUT(R%, S%) = CSng(Amin(1.2, AMAX(0.5, CAPUT(R%, S%))))\rSCaputErr(R%, S%) = caput_1\r\r'bbh 2020/11/22 start Code below involved false starts around different ideas to adjust CAPUT to offset adjustments in TEFF\r'                        If (gdprext(R%) > -70) And (IY% - 1 + FirstYear = 2025) Then\r'                            CAPUT(R%, S%) = caputtar\r'                            SCaputErr(R%, NSec%) = 0\r'                        End If\r'                        If (gdprext(R%) > -70) Then\r'                            CAPUT(R%, S%) = caputtar + AMAX(0#, Amin(1#, (1# - tfpshockadjshr(R%)))) * (CAPUT(R%, S%) - caputtar)\r'                            SCaputErr(R%, NSec%) = 0\r'                        End If\r'bbh 2020/11/22 end\r\r'                Else\r'                    CAPUT(R%, S%) = SCAPUT(R%, S%) + caput_1 * 1#    'elaszs\r'                    CAPUT(R%, S%) = SCAPUT(R%, S%) * 0.9 + CAPUT(R%, S%) * 0.1\r'                End If\r'            End If\r'CAPUT(R%, S%) = AMAX(0.5, Amin(1, CAPUT(R%, S%)))\r'If RegName(R%) = \"Uganda\" Then CAPUT(R%, S%) = caputtar\r'test to see if stock problem in late yaars is CAPUT reated\r'CAPUT(R%, S%) = caputtar\rSCAPUT(R%, S%) = CAPUT(R%, S%)\rElse\rCAPUT(R%, S%) = caputtar\rSCAPUT(R%, S%) = CAPUT(R%, S%)\r'bbh 2020/07/23 end\rEnd If\r"
  },
  {
    "Variable": "CAPUT",
    "UsesVariable": "igdpr",
    "Distance": 2,
    "Code": "\r\r'   First Year: Compute Initial Stocks and Recompute Stock Ratio\r'       Based on Computed VADD\r'   ------------------------------------------------------------\rFor S% = 1 To NSec%\rims(R%, S%) = MS(R%, S%)\r'bbh 2020/08/03 Start; need to switch stock base from ZS to VADD because over time\r'   the ratio of ZS/VADD changes (in China manufacturing almost doubles); VADD/PFD more stable\r'   Perhaps should even be PFD given the close link of PFD to stock accummulation\r'   Problem with ZS is that over time the swings of ST and CAPUT become reinforcing and very large\rStBase(R%, S%) = ZS(R%, S%) + ims(R%, S%)\r'StBase(R%, S%) = PFD(R%, S%) + ims(R%, S%) 'bbh 2022/10/27\rMovAvgMS(R%, S%) = ims(R%, S%) 'bbh 2022/10/27\r'StBase(R%, S%) = VADD(R%, S%) + ims(R%, S%)\r'bbh 2020/08/03 end\rSMS(R%, S%) = MS(R%, S%) 'bbh 2019/09/13\r\r'mti 2018/10/01 Start\r'            sms(R%, S%) = MS(R%, S%)\r'            StBase(R%, S%) = ZS(R%, S%) + sms(R%, S%)\r'mti 2018/10/01 End\r\rST(R%, S%) = StBase(R%, S%) * dstl\rNext S%\r"
  },
  {
    "Variable": "CAPUT",
    "UsesVariable": "XDEBTRPA",
    "Distance": 917,
    "Code": "0"
  },
  {
    "Variable": "CAPUT",
    "UsesVariable": "GDPPOT",
    "Distance": 917,
    "Code": "0"
  },
  {
    "Variable": "CAPUT",
    "UsesVariable": "elerca1",
    "Distance": 927,
    "Code": "\r'Diff2 = (XDEBTRPA(R%) / GDPPOT(R%) - ssxdebtrpa(R%) / GDPPOT(R%)) * 100\rDiff2 = (XDEBTRPA(R%) / GDPPOT(R%) * 100) - ssxdebtrpapercent(R%)\r"
  },
  {
    "Variable": "CAPUT",
    "UsesVariable": "elerca2",
    "Distance": 926,
    "Code": "\r\r'   All but First:  Exchange Rates\r'   --------------------------------\r\r'If RegName$(R%) = \"Britain\" Then Stop\r'bbh 2014/04/02 Start Reworked exchange rate logic\r'bbh 2019/01/21 4 lines\r'bbh 2022/06/23 start reworking of exchange rates to prevent debt overshoot and also to keep\r'   change in trade from being so fast as to mess up C and therefore poverty\r'        Par1 = elerca1\r'        Par2 = elerca2\r'Par1 = elerca1 * 0.2\r'Par2 = elerca2 * 0.2\r\r'bbh 2021/09/09 Start: Cut these substantially and dampened exchange rates and current account, also C and Poverty swings\r'Via scenario tried globally and had lesser but positive effect; so am requesting global parameter change instead of this code\r'If RegName$(R%) = \"Guinea Bissau\" Then\r'    Par1 = -0.1\r'    Par2 = -0.2\r'End If\r'bbh 2021/09/09 end\r\r'If (SX(R%) + SM(R%)) > GDPPOT(R%) Then\r'    Mul = CSng(AMAX(0.5, (GDPPOT(R%) / (SX(R%) + SM(R%))) ^ 3))\r'    'Scale back entrepot economies or they over-react\r'    Par1 = CSng(elerca1 * Mul * 0.5)\r'    Par2 = CSng(elerca2 * Mul * 0.7 * 0.5)\r'    '        Else\r'    '            Mul = 1\r'End If\r'bbh 2022/06/23 testing to get exchange rate to change with debt; helps considerably\r'   Probably reactivate something like it and generalize across high trade economies but\r'   after rework treatment of XDEBT, XNFA, and XNIIP logic in preprocresor and model\r'If RegName$(R%) = \"Brunei Darussalam\" Then\r\rIf XDEBTRPA(R%) / GDPPOT(R%) > 1 Then 'run up multiplier from 1 to as much as 3 with positive debt levels/GDP\r'Mul = Amin(3, XDEBTRPA(R%) / GDPPOT(R%) - 1)\rMul = Amin(3, XDEBTRPA(R%) / GDPPOT(R%)) 'bbh 2022/10/27 replaced above because was transient\rEnd If\r"
  },
  {
    "Variable": "CAPUT",
    "UsesVariable": "ZS",
    "Distance": 3913,
    "Code": "0"
  },
  {
    "Variable": "CAPUT",
    "UsesVariable": "MS",
    "Distance": 3754,
    "Code": "0"
  },
  {
    "Variable": "CAPUT",
    "UsesVariable": "GDP",
    "Distance": 3779,
    "Code": "0"
  },
  {
    "Variable": "CAPUT",
    "UsesVariable": "tfpshockadjshr",
    "Distance": 0,
    "Code": "\r'jrs 2019/09/26 adjgr = NeededNonPhyAdj / TotalVadd\radjgr = AMAX(-0.9, NeededNonPhyAdj / TotalVadd)\r\r'Load Base Case Adjustment\r'bbh 2017/10/20 start\r'The following block, if gdpadjsw=1 does the following:\r'   It reaches out to the GUI to draw upon the IFsBase.run to pull in values of GDPADJBASE that\r'   correspond to the values of adjgr when the base was last rebuilt; thus if the switch is on,\r'   any scenario changes (including gdprext, mfpadd, gdsm) will affect gdpr on top of base case adjustment related to gdprest;\r'   if full control in scenarios is wanted with gdprext (new values will totally control gdpr), set switch to 0\r'   simultaneously when making such full control changes with gdprext\r'bbh 2017/10/20 end\rIf gdpadjsw = 1 Then\rReDim GDPADJBASE(IY)\r'ttt Skip this line\r'        frm_MainMenu.IFsGUIctrl1.getLoadForDisplay \"GDPADJ\", -1, GRPS(1, R%), R%, \"\", -1, \"\", -1,\r'\"\", 1, True, True, False, 1, GDPADJBASE, 1, 1, FirstYear, FirstYear + IY - 1,\r'0, True, \"\", False\rIf dfBaseGDPADJ.RowCount > (IY - 1) * NR Then\rGDPADJBASE(IY) = CSng(dfBaseGDPADJ(getDataFrameIdxFromDims(CShort(FirstYear + IY - 1), FirstYear, CShort(R), CShort(NR))))\rEnd If\r\r'if it's 0, we're rebuilding the base, or no adjustment was needed, so do nothing\r'only if it's non 0\r'GDPf = GDPi1*(1+adj1)\r'GDPf = GDPi2*(1+adj2)\r'where GDPf is the same, so we want to preserve GDPi2/GDPi1, which is equal to (1+adj1)/(1+adj2)\r'Then we'll find a new GDPf * (1+adj1)/(1+adj2), but since GDPf = GDPi2 * (1+adj2), then we multiply times (1+adj1)/(1+adj2) both sides\r'and we get that the new GDPf2 = GDPi2 * (1+adj1)\rIf GDPADJBASE(IY) <> 0 Then\radjgr = GDPADJBASE(IY)\rEnd If\rEnd If\r\r'jrs 2016/09/22 *** end ***\r\r'bbh 2020/12/17 start\rFor S% = 1 To NSec%\rIf ((S% > Ener) Or (S% = Agri And agon < 0.9) Or (S% = Ener And enon < 0.9)) Then\r'bbh 2020/08/26 start\r'If gdprext(R%) > -70 Then 'shock period; divide shock between downward TEF and CAPUT\r'If GRPS(1, R%) = \"Mongolia\" And S% = 3 And IY% >= 2 Then Stop\rIf (IY% - 1 + FirstYear < 2020) Or (IY% - 1 + FirstYear > 2021) Then 'Non shock years\r'If IY% <= 5 Then\r'Found that dividing \"error\" between tef and CAPUT in years before 2020 was making the error\r'continue to grow across some countries like Angola over time becuase VADD equation was continuing to diverge\r'from gdprext; these changes were being made to facilitate COVID shock analysis in 2020 and 2021 so\r'divided period of gdprext growth into shock years (2020-21) and other; should be ok if base year changes\r'may wish to handle via parameter\r'bbh 2020/11/14 start wrapped else TEF line in if-then-else\r'                        If (gdprext(R%) >= -65) And (IY% - 1 + FirstYear > 2021) Then\r'                            'If still exogenous, recognize that tef adjustment needed already offset by CAPUT change\r'                            tef(R%, S%) = tef(R%, S%) * (1 + adjgr + (caputtar - CAPUT(R%, S%)))\r'                        Else\rIf (IY% - 1 + FirstYear > 2021) Then 'All adjustment is to TEF when exogenous years extend past shock\r'assumes exogenous is properly adjusting GDP in subsequent years for shock impact and recovery\rtef(R%, S%) = tef(R%, S%) * (1 + adjgr)\rCAPUT(R%, S%) = caputtar\rSCAPUT(R%, S%) = CAPUT(R%, S%)\rElse 'before 2020\rtef(R%, S%) = tef(R%, S%) * (1 + adjgr)\rEnd If\r'                        End If\r'bbh 2020/11/14 end\rElse 'for 2020 and 2021 only; could generalize with new parameter that indicated econshockyr\r'bbh 2020/10/14 start; from hard-coded to parameter use\rIf COVIDShock < 1 Then  '2020-2021 not COVID shock years (as in No COVID scenario and for unaffected countries)\rtef(R%, S%) = tef(R%, S%) * (1 + adjgr)\rCAPUT(R%, S%) = caputtar\rSCAPUT(R%, S%) = CAPUT(R%, S%)\rElse '2020-2021 COVID shock years\rtef(R%, S%) = tef(R%, S%) * (1 + adjgr * tfpshockadjshr(R%))\rCAPUT(R%, S%) = CAPUT(R%, S%) * (1 + adjgr * (1 - tfpshockadjshr(R%)))\rIf IY% - 1 + FirstYear = 2020 Then\rSCAPUT(R%, S%) = caputtar 'Cannot carry forward a shock-year catch-up to VADD; is lost production\rElse 'This approach basically assumes that 2021 year in pandemic is not so affected by extraordinary CAPUT reduction\rSCAPUT(R%, S%) = CAPUT(R%, S%)\rEnd If\rEnd If\r\r'                        tef(R%, S%) = tef(R%, S%) * (1 + adjgr * 0.2)\r'                        CAPUT(R%, S%) = CAPUT(R%, S%) * (1 + adjgr * 0.8)\r'bbh 2020/10/14 start;\rEnd If\r"
  },
  {
    "Variable": "CAPUT",
    "UsesVariable": "VADD",
    "Distance": 20,
    "Code": "0"
  },
  {
    "Variable": "CAPUT",
    "UsesVariable": "gdprext",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "CAPUT",
    "UsesVariable": "agon",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "CAPUT",
    "UsesVariable": "enon",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "CARANN",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "\r\r'     All Years:  Normalize demand side to supply side (more accurate for world total); compute ASA\r'     -----------------------------------------------------------------------------------------------\r\rFor R% = 1 To NR%\r'jrs 2010/03/06\rIf IY = 1 Then\rCARANNShift(R%) = CARANN(R%) - CARANNShift(R%) * WCARANNSUPSide / WCARANNDemSide\rElse\rCARANN(R%) = CARANN(R%) * WCARANNSUPSide / WCARANNDemSide\rCARANN(R%) = CARANN(R%) + CARANNShift(R%)\rEnd If\r"
  },
  {
    "Variable": "CARANN",
    "UsesVariable": "ENP",
    "Distance": 36,
    "Code": "0"
  },
  {
    "Variable": "CARANN",
    "UsesVariable": "carfuel1",
    "Distance": 36,
    "Code": "0"
  },
  {
    "Variable": "CARANN",
    "UsesVariable": "carfuel2",
    "Distance": 36,
    "Code": "0"
  },
  {
    "Variable": "CARANN",
    "UsesVariable": "carfuel3",
    "Distance": 36,
    "Code": "0"
  },
  {
    "Variable": "CARANN",
    "UsesVariable": "carannwi",
    "Distance": 109,
    "Code": "0"
  },
  {
    "Variable": "CARANN",
    "UsesVariable": "ENDEM",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "CARFOROTH",
    "UsesVariable": "carforst",
    "Distance": 0,
    "Code": "\rFor R% = 1 To NR%\rwfor = wfor + LD(R%, Fors)\rNext R%\r\rFor R% = 1 To NR%\rswfor = swfor + LD(R%, Fors)\rSForest(R%) = LD(R%, Fors)\rWCarbEm = WCarbEm + ENP(R%, Oil) * carfuel1 +\r                ENP(R%, Gas) * carfuel2 + ENP(R%, Coal) * carfuel3\rNext R%\r\r'\r'     All Years:  Indicators of Carbon Dioxide Build-up - Use Production Data\r'     -------------------------------------------------------------------------\r'     Ratio of carbon dioxide weight to carbon is 3.67\r\r'bbh 2020/02/24 start\rCARFOROTH = (swfor - wfor) * carforst\r"
  },
  {
    "Variable": "CARFOROTH",
    "UsesVariable": "LD",
    "Distance": 75,
    "Code": "0"
  },
  {
    "Variable": "CARS",
    "UsesVariable": "CARSTOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CARS",
    "UsesVariable": "carsm",
    "Distance": 0,
    "Code": "\rFor cc% = 1 To 11 'Could use MaxVal(11) from IFs.grp\r'            If cc% = 11 Then Stop\rTitle$ = \"CarsTot Versus Cars\" + GRPS$(11, cc%)\rCall XYTABL(Title$, CARSTOT(R%) / AMAX(0.001, POP(R%)) / 1000000, carscomp, context)\rCall XYTABL(Title$, CSng(carstotpci(R%)), carscomp2, context)\rIf carscomp < 0.9 * carscomp2 Then\rcarscomp = CSng(0.9 * carscomp2)\rEnd If\r\rIf carscomp <= 0 Or carscomp2 <= 0 Then\rcarscomp = 1\rcarscomp2 = 1\rEnd If\rDim carsmul = carscomp / AMAX(0.000001, carscomp2)\rTimeFAc = Amin(IY%, carsconv)\rDim carsbase = (carsi(R%, cc%) *\r               (carsconv - TimeFAc) + carscomp * TimeFAc) / AMAX(1, carsconv)\rCARS(R%, cc%) = AMAX(0, carsbase * carsmul) * CARSTOT(R%) * carsm(R%, cc%)\rCarsTotCalc = CarsTotCalc + CARS(R%, cc%)\rNext cc%\r"
  },
  {
    "Variable": "CARS",
    "UsesVariable": "carsconv",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "CARS",
    "UsesVariable": "trucksconv",
    "Distance": 15,
    "Code": "\rFor cc% = 1 To 11\rcarsi(R%, cc%) = CARS(R%, cc%) / AMAX(1, CARSTOT(R%))\rSumCars = SumCars + carsi(R%, cc%)\rNext cc%\r"
  },
  {
    "Variable": "CARS",
    "UsesVariable": "GDP",
    "Distance": 30,
    "Code": "0"
  },
  {
    "Variable": "CARS",
    "UsesVariable": "POP",
    "Distance": 137,
    "Code": "0"
  },
  {
    "Variable": "CARS",
    "UsesVariable": "GDPPCP",
    "Distance": 32,
    "Code": "0"
  },
  {
    "Variable": "CARS",
    "UsesVariable": "TRADSRAT",
    "Distance": 32,
    "Code": "0"
  },
  {
    "Variable": "CARSALPC",
    "UsesVariable": "CARSTOT",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:End Sub:186|\r\rPrivate Sub AllSteps()\r'   **********************\r'\r'   ALL TIME STEPS\r'\r'   ***********************\r'\r'AllSteps:\r\r'jrs 2007/10/17\rDim TechImpr As Single\r\r'\r'   Carry fleet forward; calculate annual sales\r'   -------------------------------------------\r\rFor R% = 1 To NR%\rCARSALPC(R%) = CARSTOT(R%) / AMAX(0.001, POP(R%) * 1000000)\r"
  },
  {
    "Variable": "CARSALPC",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:End Sub:186|\r\rPrivate Sub AllSteps()\r'   **********************\r'\r'   ALL TIME STEPS\r'\r'   ***********************\r'\r'AllSteps:\r\r'jrs 2007/10/17\rDim TechImpr As Single\r\r'\r'   Carry fleet forward; calculate annual sales\r'   -------------------------------------------\r\rFor R% = 1 To NR%\rCARSALPC(R%) = CARSTOT(R%) / AMAX(0.001, POP(R%) * 1000000)\r"
  },
  {
    "Variable": "CARSTOT",
    "UsesVariable": "carstotm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CARSTOT",
    "UsesVariable": "carsconv",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CARSTOT",
    "UsesVariable": "GDP",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "CARSTOT",
    "UsesVariable": "GDPPCP",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "CARSTOT",
    "UsesVariable": "TRADSRAT",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "CARSTOT",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CARSTOT",
    "UsesVariable": "SURVSE",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "CBR",
    "UsesVariable": "BIRTHS",
    "Distance": 0,
    "Code": "\r'jrs 2019/11/18             ifsPopWorkDB.Flush()\r'ifsPopWorkDB.Database.CommitTransaction()\r\r'\r'   All Years 2:  CBR, CDR\r'   ----------------------\rIf (IY% > 1) Then\rFor R% = 1 To NR%\rCBR(R%) = BIRTHS(R%) / POP(R%) * 1000.0!\rCDR(R%) = DEATHS(R%) / POP(R%) * 1000.0!\r'jrs 2016/05/04\r'SCBR(R%) = CBR(R%)\r'dsr 2016/05/04 CDR and SCDR get overwritten in health model when hlmodelsw = 1\r'writing SCDR here was causing problems with using exogenous series, so only\r'calculate here when hlmodelsw <> 1\r'SCDR(R%) = CDR(R%)\rIf hlmodelsw <> 1 Then\rSCDR(R%) = CDR(R%) 'Save IY > 1\r'jrs 2016/05/04\rSCBR(R%) = CBR(R%)\rEnd If\r'            SmoothGDPPCP(R%) = SmoothGDPPCP(R%) * 0.6 + GDPPCP(R%) * 0.4\r'If RegName$(R%) = \"Israel\" Then Stop\rNext R%\rEnd If\r"
  },
  {
    "Variable": "CBR",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CBR",
    "UsesVariable": "hlmodelsw",
    "Distance": 0,
    "Code": "\r'jrs 2019/11/18             ifsPopWorkDB.Flush()\r'ifsPopWorkDB.Database.CommitTransaction()\r\r'\r'   All Years 2:  CBR, CDR\r'   ----------------------\rIf (IY% > 1) Then\rFor R% = 1 To NR%\rCBR(R%) = BIRTHS(R%) / POP(R%) * 1000.0!\rCDR(R%) = DEATHS(R%) / POP(R%) * 1000.0!\r'jrs 2016/05/04\r'SCBR(R%) = CBR(R%)\r'dsr 2016/05/04 CDR and SCDR get overwritten in health model when hlmodelsw = 1\r'writing SCDR here was causing problems with using exogenous series, so only\r'calculate here when hlmodelsw <> 1\r'SCDR(R%) = CDR(R%)\rIf hlmodelsw <> 1 Then\rSCDR(R%) = CDR(R%) 'Save IY > 1\r'jrs 2016/05/04\rSCBR(R%) = CBR(R%)\rEnd If\r'            SmoothGDPPCP(R%) = SmoothGDPPCP(R%) * 0.6 + GDPPCP(R%) * 0.4\r'If RegName$(R%) = \"Israel\" Then Stop\rNext R%\rEnd If\r"
  },
  {
    "Variable": "CDALF",
    "UsesVariable": "igdpr",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "CDALF",
    "UsesVariable": "POP",
    "Distance": 2,
    "Code": "\r'jrs 2014/10/24 GDPP95(R%) = GDP(R%) * PPPCONV95(R%)\rSGDPPOTPCDALF(R%) = GDP(R%) * PPPCONV(R%)\r"
  },
  {
    "Variable": "CDALF",
    "UsesVariable": "GDP",
    "Distance": 1741,
    "Code": "\r'jrs 2014/10/24 GDPP95(R%) = GDP(R%) * PPPCONV95(R%)\rSGDPPOTPCDALF(R%) = GDP(R%) * PPPCONV(R%)\r"
  },
  {
    "Variable": "CDALF",
    "UsesVariable": "PPPCONV",
    "Distance": 1741,
    "Code": "\r'jrs 2014/10/24 GDPP95(R%) = GDP(R%) * PPPCONV95(R%)\rSGDPPOTPCDALF(R%) = GDP(R%) * PPPCONV(R%)\r"
  },
  {
    "Variable": "CDALF",
    "UsesVariable": "GDPPCP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CDR",
    "UsesVariable": "DEATHS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CDR",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CDR",
    "UsesVariable": "CBR",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "CDR",
    "UsesVariable": "LIFEXP",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "CHILDDTHR",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CHILDDTHR",
    "UsesVariable": "DEATHS",
    "Distance": 53,
    "Code": "0"
  },
  {
    "Variable": "CHILDDTHR",
    "UsesVariable": "NEONATMOR",
    "Distance": 77,
    "Code": "0"
  },
  {
    "Variable": "CHILDDTHR",
    "UsesVariable": "INFMOR",
    "Distance": 79,
    "Code": "0"
  },
  {
    "Variable": "CHLMOR",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CHLMOR",
    "UsesVariable": "DEATHS",
    "Distance": 43,
    "Code": "0"
  },
  {
    "Variable": "CHLMOR",
    "UsesVariable": "NEONATMOR",
    "Distance": 67,
    "Code": "0"
  },
  {
    "Variable": "CHLMOR",
    "UsesVariable": "INFMOR",
    "Distance": 69,
    "Code": "0"
  },
  {
    "Variable": "CIVDM",
    "UsesVariable": "NPOW",
    "Distance": 1,
    "Code": "\rFor tar% = 1 To NR%\rIf CWAR(act%, tar%) > 0.5 Then 'Conventional war with target, add damage\rConvDAM = cwarsv * CPOW(tar%)\rCIVDM(act%) = CIVDM(act%) + ConvDAM / AMAX(0.01, GDP(act%)) * cdmf\rCPOWDM(act%) = CPOWDM(act%) + ConvDAM * cpowdf\rEnd If\rIf NWAR(act%, tar%) > 0.5 Then 'Nuclear war with target, add damage\rNuclDam = CSng(1.0! - 0.5 ^ ((NPOW(tar%) * nwarsv / 1000) ^ elndpow))\rCIVDM(act%) = CIVDM(act%) + NuclDam\rCPOWDM(act%) = CPOWDM(act%) + NuclDam\rNPOWDM(act%) = nwarsv * NPOW(act%)\rEnd If\rNext tar%\r\rFor tar% = 1 To NR%\rIf CWAR(act%, tar%) > 0.5 Then 'Conventional war with target, add damage\rConvDAM = cwarsv * CPOW(tar%)\rCIVDM(act%) = CIVDM(act%) + ConvDAM / AMAX(0.01, GDP(act%)) * cdmf\rCPOWDM(act%) = CPOWDM(act%) + ConvDAM * cpowdf\rEnd If\rIf NWAR(act%, tar%) > 0.5 Then 'Nuclear war with target, add damage\rNuclDam = CSng(1.0! - 0.5 ^ ((NPOW(tar%) * nwarsv / 1000) ^ elndpow))\rCIVDM(act%) = CIVDM(act%) + NuclDam\rCPOWDM(act%) = CPOWDM(act%) + NuclDam\rNPOWDM(act%) = nwarsv * NPOW(act%)\rEnd If\rNext tar%\r\rCIVDM(act%) = CSng(Amin(0.8, CIVDM(act%)))\r"
  },
  {
    "Variable": "CIVDM",
    "UsesVariable": "nwarsv",
    "Distance": 1,
    "Code": "\rFor tar% = 1 To NR%\rIf CWAR(act%, tar%) > 0.5 Then 'Conventional war with target, add damage\rConvDAM = cwarsv * CPOW(tar%)\rCIVDM(act%) = CIVDM(act%) + ConvDAM / AMAX(0.01, GDP(act%)) * cdmf\rCPOWDM(act%) = CPOWDM(act%) + ConvDAM * cpowdf\rEnd If\rIf NWAR(act%, tar%) > 0.5 Then 'Nuclear war with target, add damage\rNuclDam = CSng(1.0! - 0.5 ^ ((NPOW(tar%) * nwarsv / 1000) ^ elndpow))\rCIVDM(act%) = CIVDM(act%) + NuclDam\rCPOWDM(act%) = CPOWDM(act%) + NuclDam\rNPOWDM(act%) = nwarsv * NPOW(act%)\rEnd If\rNext tar%\r"
  },
  {
    "Variable": "CIVDM",
    "UsesVariable": "elndpow",
    "Distance": 1,
    "Code": "\rFor tar% = 1 To NR%\rIf CWAR(act%, tar%) > 0.5 Then 'Conventional war with target, add damage\rConvDAM = cwarsv * CPOW(tar%)\rCIVDM(act%) = CIVDM(act%) + ConvDAM / AMAX(0.01, GDP(act%)) * cdmf\rCPOWDM(act%) = CPOWDM(act%) + ConvDAM * cpowdf\rEnd If\rIf NWAR(act%, tar%) > 0.5 Then 'Nuclear war with target, add damage\rNuclDam = CSng(1.0! - 0.5 ^ ((NPOW(tar%) * nwarsv / 1000) ^ elndpow))\rCIVDM(act%) = CIVDM(act%) + NuclDam\rCPOWDM(act%) = CPOWDM(act%) + NuclDam\rNPOWDM(act%) = nwarsv * NPOW(act%)\rEnd If\rNext tar%\r"
  },
  {
    "Variable": "CIVDM",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "\rFor tar% = 1 To NR%\rIf CWAR(act%, tar%) > 0.5 Then 'Conventional war with target, add damage\rConvDAM = cwarsv * CPOW(tar%)\rCIVDM(act%) = CIVDM(act%) + ConvDAM / AMAX(0.01, GDP(act%)) * cdmf\rCPOWDM(act%) = CPOWDM(act%) + ConvDAM * cpowdf\rEnd If\rIf NWAR(act%, tar%) > 0.5 Then 'Nuclear war with target, add damage\rNuclDam = CSng(1.0! - 0.5 ^ ((NPOW(tar%) * nwarsv / 1000) ^ elndpow))\rCIVDM(act%) = CIVDM(act%) + NuclDam\rCPOWDM(act%) = CPOWDM(act%) + NuclDam\rNPOWDM(act%) = nwarsv * NPOW(act%)\rEnd If\rNext tar%\r\rFor tar% = 1 To NR%\rIf CWAR(act%, tar%) > 0.5 Then 'Conventional war with target, add damage\rConvDAM = cwarsv * CPOW(tar%)\rCIVDM(act%) = CIVDM(act%) + ConvDAM / AMAX(0.01, GDP(act%)) * cdmf\rCPOWDM(act%) = CPOWDM(act%) + ConvDAM * cpowdf\rEnd If\rIf NWAR(act%, tar%) > 0.5 Then 'Nuclear war with target, add damage\rNuclDam = CSng(1.0! - 0.5 ^ ((NPOW(tar%) * nwarsv / 1000) ^ elndpow))\rCIVDM(act%) = CIVDM(act%) + NuclDam\rCPOWDM(act%) = CPOWDM(act%) + NuclDam\rNPOWDM(act%) = nwarsv * NPOW(act%)\rEnd If\rNext tar%\r"
  },
  {
    "Variable": "CIVDM",
    "UsesVariable": "cdmf",
    "Distance": 0,
    "Code": "\rFor tar% = 1 To NR%\rIf CWAR(act%, tar%) > 0.5 Then 'Conventional war with target, add damage\rConvDAM = cwarsv * CPOW(tar%)\rCIVDM(act%) = CIVDM(act%) + ConvDAM / AMAX(0.01, GDP(act%)) * cdmf\rCPOWDM(act%) = CPOWDM(act%) + ConvDAM * cpowdf\rEnd If\rIf NWAR(act%, tar%) > 0.5 Then 'Nuclear war with target, add damage\rNuclDam = CSng(1.0! - 0.5 ^ ((NPOW(tar%) * nwarsv / 1000) ^ elndpow))\rCIVDM(act%) = CIVDM(act%) + NuclDam\rCPOWDM(act%) = CPOWDM(act%) + NuclDam\rNPOWDM(act%) = nwarsv * NPOW(act%)\rEnd If\rNext tar%\r"
  },
  {
    "Variable": "CIVDM",
    "UsesVariable": "cwarsv",
    "Distance": 1,
    "Code": "\rFor tar% = 1 To NR%\rIf CWAR(act%, tar%) > 0.5 Then 'Conventional war with target, add damage\rConvDAM = cwarsv * CPOW(tar%)\rCIVDM(act%) = CIVDM(act%) + ConvDAM / AMAX(0.01, GDP(act%)) * cdmf\rCPOWDM(act%) = CPOWDM(act%) + ConvDAM * cpowdf\rEnd If\rIf NWAR(act%, tar%) > 0.5 Then 'Nuclear war with target, add damage\rNuclDam = CSng(1.0! - 0.5 ^ ((NPOW(tar%) * nwarsv / 1000) ^ elndpow))\rCIVDM(act%) = CIVDM(act%) + NuclDam\rCPOWDM(act%) = CPOWDM(act%) + NuclDam\rNPOWDM(act%) = nwarsv * NPOW(act%)\rEnd If\rNext tar%\r"
  },
  {
    "Variable": "CIVDM",
    "UsesVariable": "CPOW",
    "Distance": 1,
    "Code": "\rFor tar% = 1 To NR%\rIf CWAR(act%, tar%) > 0.5 Then 'Conventional war with target, add damage\rConvDAM = cwarsv * CPOW(tar%)\rCIVDM(act%) = CIVDM(act%) + ConvDAM / AMAX(0.01, GDP(act%)) * cdmf\rCPOWDM(act%) = CPOWDM(act%) + ConvDAM * cpowdf\rEnd If\rIf NWAR(act%, tar%) > 0.5 Then 'Nuclear war with target, add damage\rNuclDam = CSng(1.0! - 0.5 ^ ((NPOW(tar%) * nwarsv / 1000) ^ elndpow))\rCIVDM(act%) = CIVDM(act%) + NuclDam\rCPOWDM(act%) = CPOWDM(act%) + NuclDam\rNPOWDM(act%) = nwarsv * NPOW(act%)\rEnd If\rNext tar%\r"
  },
  {
    "Variable": "CLAVAL",
    "UsesVariable": "CLPC",
    "Distance": 0,
    "Code": "\r'jrs 2014/11/25 claval_1 = sho(R%, 1) * FDEM(R%) / AGDEM(R%, 1) + sho(R%, 2) * lvcfr(R%)\r\r'dsr 2015/03/26 Comment out following code since calories adjustments dealt with above\r''        claval_1 = sho(R%, 1) * FDEM(R%, 1) / AGDEM(R%, 1) + sho(R%, 2) * lvcfr(R%)\r''        claval_1 = AMAX(0, claval_1) ' Make sure shortages are positive\r'jrs 2014/11/25 CLAVAL(R%) = AMAX(0, sclavf(R%) * (FDEM(R%) + AGDEM(R%, 2) * lvcfr(R%) - claval_1))\r'dsr 2015/03/26 Change how CLAVAL is computed\r'        CLAVAL(R%) = AMAX(0, sclavf(R%) * (FDEM(R%, 1) + AGDEM(R%, 2) * lvcfr(R%) - claval_1))\rCLAVAL(R%) = AMAX(0, CLPC(R%, 4)) * POP(R%)\r'    If RegName$(R%) = \"Somalia\" Then Stop\r\r"
  },
  {
    "Variable": "CLAVAL",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r'jrs 2014/11/25 claval_1 = sho(R%, 1) * FDEM(R%) / AGDEM(R%, 1) + sho(R%, 2) * lvcfr(R%)\r\r'dsr 2015/03/26 Comment out following code since calories adjustments dealt with above\r''        claval_1 = sho(R%, 1) * FDEM(R%, 1) / AGDEM(R%, 1) + sho(R%, 2) * lvcfr(R%)\r''        claval_1 = AMAX(0, claval_1) ' Make sure shortages are positive\r'jrs 2014/11/25 CLAVAL(R%) = AMAX(0, sclavf(R%) * (FDEM(R%) + AGDEM(R%, 2) * lvcfr(R%) - claval_1))\r'dsr 2015/03/26 Change how CLAVAL is computed\r'        CLAVAL(R%) = AMAX(0, sclavf(R%) * (FDEM(R%, 1) + AGDEM(R%, 2) * lvcfr(R%) - claval_1))\rCLAVAL(R%) = AMAX(0, CLPC(R%, 4)) * POP(R%)\r'    If RegName$(R%) = \"Somalia\" Then Stop\r\r"
  },
  {
    "Variable": "CLD",
    "UsesVariable": "IDS",
    "Distance": 0,
    "Code": "\r'jrs 2007/01/15 remove not used\r'        WZS = WZS + ZS(R%, 1)\r'        WCS = WCS + CS(R%, 1)\r'        WZSPhys = WZSPhys + ProdVal\r'        WCSPhys = WCSPhys + DemVal\r'   First Year:  Cost of Land\r'   -------------------------\r\r'FORESTI(R%) = LD(R%, 3)\rCLD(R%) = CSng(IDS(R%, 1) * IALK(R%) / AMAX(LD(R%, 1) * (dkl + tgrld(R%)), 0.001))\r\rCLD(R%) = AMAX(0.01, CLD(R%))\rCOMPLETE STRUCTURE:Next R%:3230|\r\r'ttt 2019/10/08 TakenOut\r'KAG(R%) = SKAG(R%)\rCLD(R%) = AMAX(0.01, scld(R%))\r"
  },
  {
    "Variable": "CLD",
    "UsesVariable": "IALK",
    "Distance": 0,
    "Code": "\r'jrs 2007/01/15 remove not used\r'        WZS = WZS + ZS(R%, 1)\r'        WCS = WCS + CS(R%, 1)\r'        WZSPhys = WZSPhys + ProdVal\r'        WCSPhys = WCSPhys + DemVal\r'   First Year:  Cost of Land\r'   -------------------------\r\r'FORESTI(R%) = LD(R%, 3)\rCLD(R%) = CSng(IDS(R%, 1) * IALK(R%) / AMAX(LD(R%, 1) * (dkl + tgrld(R%)), 0.001))\r"
  },
  {
    "Variable": "CLD",
    "UsesVariable": "LD",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CLD",
    "UsesVariable": "dkl",
    "Distance": 0,
    "Code": "\r'jrs 2007/01/15 remove not used\r'        WZS = WZS + ZS(R%, 1)\r'        WCS = WCS + CS(R%, 1)\r'        WZSPhys = WZSPhys + ProdVal\r'        WCSPhys = WCSPhys + DemVal\r'   First Year:  Cost of Land\r'   -------------------------\r\r'FORESTI(R%) = LD(R%, 3)\rCLD(R%) = CSng(IDS(R%, 1) * IALK(R%) / AMAX(LD(R%, 1) * (dkl + tgrld(R%)), 0.001))\r"
  },
  {
    "Variable": "CLD",
    "UsesVariable": "tgrld",
    "Distance": 0,
    "Code": "\r'jrs 2007/01/15 remove not used\r'        WZS = WZS + ZS(R%, 1)\r'        WCS = WCS + CS(R%, 1)\r'        WZSPhys = WZSPhys + ProdVal\r'        WCSPhys = WCSPhys + DemVal\r'   First Year:  Cost of Land\r'   -------------------------\r\r'FORESTI(R%) = LD(R%, 3)\rCLD(R%) = CSng(IDS(R%, 1) * IALK(R%) / AMAX(LD(R%, 1) * (dkl + tgrld(R%)), 0.001))\r"
  },
  {
    "Variable": "CLD",
    "UsesVariable": "GDPPCP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CLD",
    "UsesVariable": "landarablepot",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "CLIMECONIMP",
    "UsesVariable": "climeconimplin",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CLIMECONIMP",
    "UsesVariable": "WTEMP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CLIMECONIMP",
    "UsesVariable": "climeconimpsq",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CLIMECONIMP",
    "UsesVariable": "climeconimpperctrysw",
    "Distance": 0,
    "Code": "\r'bbh 2022/04/26 end\rIf fIY = 1 Then WTEMPI = WTEMP 'bbh 2017/10/05\r"
  },
  {
    "Variable": "CLIMECONIMP",
    "UsesVariable": "ifsexomodelid",
    "Distance": 105,
    "Code": "\r'bbh 2022/04/26 end\rIf fIY = 1 Then WTEMPI = WTEMP 'bbh 2017/10/05\r"
  },
  {
    "Variable": "CLIMECONIMP",
    "UsesVariable": "ENVTPCHG",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CLNEED",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\rFor j% = 1 To NCohorts\rIf IY% > 1 Then POP(R%) = CSng(POP(R%) + agedst(j%, R%, 1) + agedst(j%, R%, 2))\r'jrs 2012/09/03\r'If Not IsNull(clage(j%)) Then\rCLNEED(R%) = CSng(CLNEED(R%) +\r                    (agedst(j%, R%, 1) + agedst(j%, R%, 2)) * clage(j%) * clnf(R%))\r'jrs 2012/10/30\r'Else\r'    j% = NCohorts\r'End If\rNext j%\r\r\r'If RegName$(R%) = \"Israel\" Then Stop\rCLNEED(R%) = CLNEED(R%) * 1000\r\rCLNEED(R%) = AMAX(0.001, CLNEED(R%))\r"
  },
  {
    "Variable": "CLNEED",
    "UsesVariable": "clnf",
    "Distance": 0,
    "Code": "\rFor j% = 1 To NCohorts\rIf IY% > 1 Then POP(R%) = CSng(POP(R%) + agedst(j%, R%, 1) + agedst(j%, R%, 2))\r'jrs 2012/09/03\r'If Not IsNull(clage(j%)) Then\rCLNEED(R%) = CSng(CLNEED(R%) +\r                    (agedst(j%, R%, 1) + agedst(j%, R%, 2)) * clage(j%) * clnf(R%))\r'jrs 2012/10/30\r'Else\r'    j% = NCohorts\r'End If\rNext j%\r"
  },
  {
    "Variable": "CLNEED",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "\rFor j% = 1 To NCohorts\rIf IY% > 1 Then POP(R%) = CSng(POP(R%) + agedst(j%, R%, 1) + agedst(j%, R%, 2))\r'jrs 2012/09/03\r'If Not IsNull(clage(j%)) Then\rCLNEED(R%) = CSng(CLNEED(R%) +\r                    (agedst(j%, R%, 1) + agedst(j%, R%, 2)) * clage(j%) * clnf(R%))\r'jrs 2012/10/30\r'Else\r'    j% = NCohorts\r'End If\rNext j%\r"
  },
  {
    "Variable": "CLPC",
    "UsesVariable": "CLAVAL",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CLPC",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CLPC",
    "UsesVariable": "clpcexovals",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CLPC",
    "UsesVariable": "GRAMSPC",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CLPC",
    "UsesVariable": "aglossconsm",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "CLPC",
    "UsesVariable": "GDPPCP",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "CLPC",
    "UsesVariable": "malelimprecisesw",
    "Distance": 13,
    "Code": "\r'sgh 2016/02/15 -END-\r\r'sgh 2016/02/14 -START- Apply the eliminate hunger parameters here. This increases CLPC to the required\r'level, specific to each country, to eliminate (5 percent) hunger. If MALNPOPP does not decrease to 5 percent\r'by the target year, then adajust malnconv in the scenario tree as well.\rIf malnelimstartyr(R%) <> 0 AndAlso malnelimtargetyr(R%) <> 0 AndAlso malnelimstartyr(R%) < malnelimtargetyr(R%) Then\r'If RegName$(R%) = \"Tanzania\" Then Stop\rDim clcgr = 0!\rDim clpcgr = 0!\rIf (IY% + BaseYear - 1) >= malnelimstartyr(R%) AndAlso (IY% + BaseYear - 1) <= malnelimtargetyr(R%) Then\r'jrs 2024/01/29 Dim malnelimtarget = Math.Exp((Math.Log(5) - 46.95226 + 0.18422 * Math.Log(HHINC(R%, 1) / labsups(R%))) / -5.643)\rDim malnelimtarget = Math.Exp((Math.Log(5) - 46.95226 + 0.18422 * Math.Log(HHINCDIS(R%, 1) / labsups(R%))) / -5.643)\rDim timeToTarget = malnelimtargetyr(R%) + 1 - (BaseYear + IY% - 1)\rclpcgr = CSng((malnelimtarget / (TotalCalPerCap * CLPCCUM(R%))) ^\r(1 / timeToTarget))\rIf TotalCalPerCap > malnelimtarget Then\rCLPCCUM(R%) = 1\rElse\rCLPCCUM(R%) = CLPCCUM(R%) * clpcgr\rEnd If\rEnd If\rEnd If\r\rTotalCalPerCap = CLPC(R%, 1) + CLPC(R%, 2) + CLPC(R%, 3)\r\r'sgh 2016/02/15 -END-\r\r'sgh 2016/02/14 -START- Apply the eliminate hunger parameters here. This increases CLPC to the required\r'level, specific to each country, to eliminate (5 percent) hunger. If MALNPOPP does not decrease to 5 percent\r'by the target year, then adajust malnconv in the scenario tree as well.\rIf malnelimstartyr(R%) <> 0 AndAlso malnelimtargetyr(R%) <> 0 AndAlso malnelimstartyr(R%) < malnelimtargetyr(R%) Then\r'If RegName$(R%) = \"Tanzania\" Then Stop\rDim clcgr = 0!\rDim clpcgr = 0!\rIf (IY% + BaseYear - 1) >= malnelimstartyr(R%) AndAlso (IY% + BaseYear - 1) <= malnelimtargetyr(R%) Then\r'jrs 2024/01/29 Dim malnelimtarget = Math.Exp((Math.Log(5) - 46.95226 + 0.18422 * Math.Log(HHINC(R%, 1) / labsups(R%))) / -5.643)\rDim malnelimtarget = Math.Exp((Math.Log(5) - 46.95226 + 0.18422 * Math.Log(HHINCDIS(R%, 1) / labsups(R%))) / -5.643)\rDim timeToTarget = malnelimtargetyr(R%) + 1 - (BaseYear + IY% - 1)\rclpcgr = CSng((malnelimtarget / (TotalCalPerCap * CLPCCUM(R%))) ^\r(1 / timeToTarget))\rIf TotalCalPerCap > malnelimtarget Then\rCLPCCUM(R%) = 1\rElse\rCLPCCUM(R%) = CLPCCUM(R%) * clpcgr\rEnd If\rEnd If\rEnd If\r\r'sgh 2016/02/15 -END-\r\r'sgh 2016/02/14 -START- Apply the eliminate hunger parameters here. This increases CLPC to the required\r'level, specific to each country, to eliminate (5 percent) hunger. If MALNPOPP does not decrease to 5 percent\r'by the target year, then adajust malnconv in the scenario tree as well.\rIf malnelimstartyr(R%) <> 0 AndAlso malnelimtargetyr(R%) <> 0 AndAlso malnelimstartyr(R%) < malnelimtargetyr(R%) Then\r'If RegName$(R%) = \"Tanzania\" Then Stop\rDim clcgr = 0!\rDim clpcgr = 0!\rIf (IY% + BaseYear - 1) >= malnelimstartyr(R%) AndAlso (IY% + BaseYear - 1) <= malnelimtargetyr(R%) Then\r'jrs 2024/01/29 Dim malnelimtarget = Math.Exp((Math.Log(5) - 46.95226 + 0.18422 * Math.Log(HHINC(R%, 1) / labsups(R%))) / -5.643)\rDim malnelimtarget = Math.Exp((Math.Log(5) - 46.95226 + 0.18422 * Math.Log(HHINCDIS(R%, 1) / labsups(R%))) / -5.643)\rDim timeToTarget = malnelimtargetyr(R%) + 1 - (BaseYear + IY% - 1)\rclpcgr = CSng((malnelimtarget / (TotalCalPerCap * CLPCCUM(R%))) ^\r(1 / timeToTarget))\rIf TotalCalPerCap > malnelimtarget Then\rCLPCCUM(R%) = 1\rElse\rCLPCCUM(R%) = CLPCCUM(R%) * clpcgr\rEnd If\rEnd If\rEnd If\r\r\r'sgh 2016/02/14 Set saved value to CLPC in first year\rCLPCCUM(R%) = 1\r\r'sgh 2016/02/15 -END-\r\r'sgh 2016/02/14 -START- Apply the eliminate hunger parameters here. This increases CLPC to the required\r'level, specific to each country, to eliminate (5 percent) hunger. If MALNPOPP does not decrease to 5 percent\r'by the target year, then adajust malnconv in the scenario tree as well.\rIf malnelimstartyr(R%) <> 0 AndAlso malnelimtargetyr(R%) <> 0 AndAlso malnelimstartyr(R%) < malnelimtargetyr(R%) Then\r'If RegName$(R%) = \"Tanzania\" Then Stop\rDim clcgr = 0!\rDim clpcgr = 0!\rIf (IY% + BaseYear - 1) >= malnelimstartyr(R%) AndAlso (IY% + BaseYear - 1) <= malnelimtargetyr(R%) Then\r'jrs 2024/01/29 Dim malnelimtarget = Math.Exp((Math.Log(5) - 46.95226 + 0.18422 * Math.Log(HHINC(R%, 1) / labsups(R%))) / -5.643)\rDim malnelimtarget = Math.Exp((Math.Log(5) - 46.95226 + 0.18422 * Math.Log(HHINCDIS(R%, 1) / labsups(R%))) / -5.643)\rDim timeToTarget = malnelimtargetyr(R%) + 1 - (BaseYear + IY% - 1)\rclpcgr = CSng((malnelimtarget / (TotalCalPerCap * CLPCCUM(R%))) ^\r(1 / timeToTarget))\rIf TotalCalPerCap > malnelimtarget Then\rCLPCCUM(R%) = 1\rElse\rCLPCCUM(R%) = CLPCCUM(R%) * clpcgr\rEnd If\rEnd If\rEnd If\r\rIf malelimprecisesw(R%) = 1 Then\rDim CalDefPC = AMAX(0, (Amin(55, SMalnPopP(R%)) - 5)) / 50 * 422\r'1844 not malnourished person; 1000=worst maln and still alive; assume normal distrib; so 422=(1844-1000)/2\r'55% maln generates 422 calorie shortage per undernourished person; 5% maln generates 0 calorie shortage\rDim MalnPop = SMalnPopP(R%) / 100 * POP(R%)\rDim CalTarSup = MalnPop * CalDefPC / POP(R%)\rCalTarSupCrop = CalTarSup * CLPC(R%, 1) / TotalCalPerCap\rCalTarSupMeat = CalTarSup * CLPC(R%, 2) / TotalCalPerCap\rCalTarSupFish = CalTarSup * CLPC(R%, 3) / TotalCalPerCap\rCalTarSupMeat = 0\rCalTarSupFish = 0\rEnd If\r\r\r'sgh 2016/02/14 Set saved value to CLPC in first year\rCLPCCUM(R%) = 1\r\r'sgh 2016/02/15 -END-\r\r'sgh 2016/02/14 -START- Apply the eliminate hunger parameters here. This increases CLPC to the required\r'level, specific to each country, to eliminate (5 percent) hunger. If MALNPOPP does not decrease to 5 percent\r'by the target year, then adajust malnconv in the scenario tree as well.\rIf malnelimstartyr(R%) <> 0 AndAlso malnelimtargetyr(R%) <> 0 AndAlso malnelimstartyr(R%) < malnelimtargetyr(R%) Then\r'If RegName$(R%) = \"Tanzania\" Then Stop\rDim clcgr = 0!\rDim clpcgr = 0!\rIf (IY% + BaseYear - 1) >= malnelimstartyr(R%) AndAlso (IY% + BaseYear - 1) <= malnelimtargetyr(R%) Then\r'jrs 2024/01/29 Dim malnelimtarget = Math.Exp((Math.Log(5) - 46.95226 + 0.18422 * Math.Log(HHINC(R%, 1) / labsups(R%))) / -5.643)\rDim malnelimtarget = Math.Exp((Math.Log(5) - 46.95226 + 0.18422 * Math.Log(HHINCDIS(R%, 1) / labsups(R%))) / -5.643)\rDim timeToTarget = malnelimtargetyr(R%) + 1 - (BaseYear + IY% - 1)\rclpcgr = CSng((malnelimtarget / (TotalCalPerCap * CLPCCUM(R%))) ^\r(1 / timeToTarget))\rIf TotalCalPerCap > malnelimtarget Then\rCLPCCUM(R%) = 1\rElse\rCLPCCUM(R%) = CLPCCUM(R%) * clpcgr\rEnd If\rEnd If\rEnd If\r\r'sgh 2016/02/15 -END-\r\r'sgh 2016/02/14 -START- Apply the eliminate hunger parameters here. This increases CLPC to the required\r'level, specific to each country, to eliminate (5 percent) hunger. If MALNPOPP does not decrease to 5 percent\r'by the target year, then adajust malnconv in the scenario tree as well.\rIf malnelimstartyr(R%) <> 0 AndAlso malnelimtargetyr(R%) <> 0 AndAlso malnelimstartyr(R%) < malnelimtargetyr(R%) Then\r'If RegName$(R%) = \"Tanzania\" Then Stop\rDim clcgr = 0!\rDim clpcgr = 0!\rIf (IY% + BaseYear - 1) >= malnelimstartyr(R%) AndAlso (IY% + BaseYear - 1) <= malnelimtargetyr(R%) Then\r'jrs 2024/01/29 Dim malnelimtarget = Math.Exp((Math.Log(5) - 46.95226 + 0.18422 * Math.Log(HHINC(R%, 1) / labsups(R%))) / -5.643)\rDim malnelimtarget = Math.Exp((Math.Log(5) - 46.95226 + 0.18422 * Math.Log(HHINCDIS(R%, 1) / labsups(R%))) / -5.643)\rDim timeToTarget = malnelimtargetyr(R%) + 1 - (BaseYear + IY% - 1)\rclpcgr = CSng((malnelimtarget / (TotalCalPerCap * CLPCCUM(R%))) ^\r(1 / timeToTarget))\rIf TotalCalPerCap > malnelimtarget Then\rCLPCCUM(R%) = 1\rElse\rCLPCCUM(R%) = CLPCCUM(R%) * clpcgr\rEnd If\rEnd If\rEnd If\r\r'dsr 2015/06/08 Use newly added parameter for price elasticity of fish demand\r'        CLPC(R%, 3) = CLPC(R%, 3) * (WAP(3) / swapi(3)) ^ (-0.3) 'elasmd(R%)  which is -.3\rCLPC(R%, 3) = CLPC(R%, 3) * CLPCCUM(R%) + CalTarSupFish   'bbh 2016/02/01\r"
  },
  {
    "Variable": "CLPC",
    "UsesVariable": "HHINCDIS",
    "Distance": 28,
    "Code": "0"
  },
  {
    "Variable": "CLPC",
    "UsesVariable": "MALNPOPP",
    "Distance": 17,
    "Code": "0"
  },
  {
    "Variable": "CLPC",
    "UsesVariable": "clpcm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CLPC",
    "UsesVariable": "WAP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CLPC",
    "UsesVariable": "elasfd",
    "Distance": 0,
    "Code": "\r\rFor f% = 1 To 3\rswapi(f%) = WAP(f%)\rswxc(f%) = 1\rswmd(f%) = 1\rGlobalSurDefRate(f%) = 0 'bbh 2022/10/27\rSGlobalSurDefRate(f%) = 0 'bbh 2022/11/28\rWTFoodType(f%) = 0 'bbh 2022/10/27 Initialize global trade by food type\rFor R% = 1 To NR%\rWTFoodType(f%) = WTFoodType(f%) + AGX(R%, f%)\rNext R%\rNext f%\r"
  },
  {
    "Variable": "CLPC",
    "UsesVariable": "elasmd",
    "Distance": 0,
    "Code": "\r\rFor f% = 1 To 3\rswapi(f%) = WAP(f%)\rswxc(f%) = 1\rswmd(f%) = 1\rGlobalSurDefRate(f%) = 0 'bbh 2022/10/27\rSGlobalSurDefRate(f%) = 0 'bbh 2022/11/28\rWTFoodType(f%) = 0 'bbh 2022/10/27 Initialize global trade by food type\rFor R% = 1 To NR%\rWTFoodType(f%) = WTFoodType(f%) + AGX(R%, f%)\rNext R%\rNext f%\r"
  },
  {
    "Variable": "CLPC",
    "UsesVariable": "elascd",
    "Distance": 0,
    "Code": "\r\rFor f% = 1 To 3\rswapi(f%) = WAP(f%)\rswxc(f%) = 1\rswmd(f%) = 1\rGlobalSurDefRate(f%) = 0 'bbh 2022/10/27\rSGlobalSurDefRate(f%) = 0 'bbh 2022/11/28\rWTFoodType(f%) = 0 'bbh 2022/10/27 Initialize global trade by food type\rFor R% = 1 To NR%\rWTFoodType(f%) = WTFoodType(f%) + AGX(R%, f%)\rNext R%\rNext f%\r"
  },
  {
    "Variable": "CLPC",
    "UsesVariable": "calmax",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "CLPC",
    "UsesVariable": "agconv",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "CLPC",
    "UsesVariable": "GDP",
    "Distance": 22,
    "Code": "0"
  },
  {
    "Variable": "CLPC",
    "UsesVariable": "CULTREG",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "CLPCCV",
    "UsesVariable": "clpccvm",
    "Distance": 0,
    "Code": "\rElse\r'Forecast\rFor R% = 1 To NR\r'jrs 2021/04/07 Call AnalFunc(\"Coeff. of Var. (Linear) versus GDPPCP, GINIDOM, INFRAELECACC, POLITY\",\r'New Single() {GDPPCP(R%), sGINIDOM(R%), sINFRAELECACC(R%, 3), SDEMOCPOLITY(R%)}, Est,\r'New String() {\"GDPPCP\", \"GINIDOM\", \"INFRAELECACC\", \"DEMOCPOLITY\"}, context)\r\r'jrs 2021/04/15\r'jrs 2022/01/10 If clpccvr(R%) = 0 Then\rSelect Case clpccvr(R%)\rCase 0\rCall AnalFunc(\"Coeff. of Var. (Linear) versus GDPPCP, GINIDOM, LABPARR(Female), Youth Dep.\",\r                                New Single() {GDPPCP(R%), sGINIDOM(R%), LABPARR(R%, 2), 100 * POPLE15(R%) / POP(R%)}, Est,\r                                New String() {\"GDPPCP\", \"GINIDOM\", \"LABPARR(Female)\", \"Youth Dep.\"}, context)\r\rCLPCCV(R%) = CLPCCVShift(R%) * Est\r'jrs 2021/03/09\r'jrs 2022/01/10 CLPCCV(R%) = CLPCCV(R%) * clpccvm(R%)\r'Else jrs 2022/01/10\rCase 1 'Constant\r'jrs 2021/08/04 CLPCCV(R%) = CLPCCVShift(R%)\rCLPCCV(R%) = SCLPCCV(R%)\r'jrs 2021/06/07\r'jrs 2022/01/10 CLPCCV(R%) = CLPCCV(R%) * clpccvm(R%)\rCase 2 'Median\rXYTABL(\"Coef. of Variance versus GDP per Capita at PPP (Power) (Median)\", GDPPCP(R%), Est, context)\rCLPCCV(R%) = CLPCCVShift(R%) * Est\rCase 3 'Optimistic\rXYTABL(\"Coef. of Variance versus GDP per Capita at PPP (Power) (Optimistic)\", GDPPCP(R%), Est, context)\rCLPCCV(R%) = CLPCCVShift(R%) * Est\rCase 4 'Pessimistic\rXYTABL(\"Coef. of Variance versus GDP per Capita at PPP (Power) (Pessimistic)\", GDPPCP(R%), Est, context)\rCLPCCV(R%) = CLPCCVShift(R%) * Est\r'End If jrs 2022/01/10\rEnd Select\rCLPCCV(R%) = CLPCCV(R%) * clpccvm(R%)\r\r'jrs 2021/08/04\rSCLPCCV(R%) = CLPCCV(R%)\r\rCall XYTABL(\"CLPCMDER (Linear) versus POPMEDAGE (X^2)\", POPMEDAGE(R%), Est, context)\rCLPCMDER(R%) = CLPCMDERShift(R%) * Est\r'jrs 2021/03/09\rCLPCMDER(R%) = CLPCMDER(R%) * clpcmderm(R%)\r\rNext R%\r"
  },
  {
    "Variable": "CLPCCV",
    "UsesVariable": "GDPPCP",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "CLPCCV",
    "UsesVariable": "GINIDOM",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "CLPCCV",
    "UsesVariable": "LABPARR",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "CLPCCV",
    "UsesVariable": "POPLE15",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "CLPCCV",
    "UsesVariable": "POP",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "CLPCCV",
    "UsesVariable": "POPMEDAGE",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "CLPCCV",
    "UsesVariable": "GOVRISK",
    "Distance": 502,
    "Code": "0"
  },
  {
    "Variable": "CLPCMDER",
    "UsesVariable": "clpcmderm",
    "Distance": 0,
    "Code": "\rElse\r'Forecast\rFor R% = 1 To NR\r'jrs 2021/04/07 Call AnalFunc(\"Coeff. of Var. (Linear) versus GDPPCP, GINIDOM, INFRAELECACC, POLITY\",\r'New Single() {GDPPCP(R%), sGINIDOM(R%), sINFRAELECACC(R%, 3), SDEMOCPOLITY(R%)}, Est,\r'New String() {\"GDPPCP\", \"GINIDOM\", \"INFRAELECACC\", \"DEMOCPOLITY\"}, context)\r\r'jrs 2021/04/15\r'jrs 2022/01/10 If clpccvr(R%) = 0 Then\rSelect Case clpccvr(R%)\rCase 0\rCall AnalFunc(\"Coeff. of Var. (Linear) versus GDPPCP, GINIDOM, LABPARR(Female), Youth Dep.\",\r                                New Single() {GDPPCP(R%), sGINIDOM(R%), LABPARR(R%, 2), 100 * POPLE15(R%) / POP(R%)}, Est,\r                                New String() {\"GDPPCP\", \"GINIDOM\", \"LABPARR(Female)\", \"Youth Dep.\"}, context)\r\rCLPCCV(R%) = CLPCCVShift(R%) * Est\r'jrs 2021/03/09\r'jrs 2022/01/10 CLPCCV(R%) = CLPCCV(R%) * clpccvm(R%)\r'Else jrs 2022/01/10\rCase 1 'Constant\r'jrs 2021/08/04 CLPCCV(R%) = CLPCCVShift(R%)\rCLPCCV(R%) = SCLPCCV(R%)\r'jrs 2021/06/07\r'jrs 2022/01/10 CLPCCV(R%) = CLPCCV(R%) * clpccvm(R%)\rCase 2 'Median\rXYTABL(\"Coef. of Variance versus GDP per Capita at PPP (Power) (Median)\", GDPPCP(R%), Est, context)\rCLPCCV(R%) = CLPCCVShift(R%) * Est\rCase 3 'Optimistic\rXYTABL(\"Coef. of Variance versus GDP per Capita at PPP (Power) (Optimistic)\", GDPPCP(R%), Est, context)\rCLPCCV(R%) = CLPCCVShift(R%) * Est\rCase 4 'Pessimistic\rXYTABL(\"Coef. of Variance versus GDP per Capita at PPP (Power) (Pessimistic)\", GDPPCP(R%), Est, context)\rCLPCCV(R%) = CLPCCVShift(R%) * Est\r'End If jrs 2022/01/10\rEnd Select\rCLPCCV(R%) = CLPCCV(R%) * clpccvm(R%)\r\r'jrs 2021/08/04\rSCLPCCV(R%) = CLPCCV(R%)\r\rCall XYTABL(\"CLPCMDER (Linear) versus POPMEDAGE (X^2)\", POPMEDAGE(R%), Est, context)\rCLPCMDER(R%) = CLPCMDERShift(R%) * Est\r'jrs 2021/03/09\rCLPCMDER(R%) = CLPCMDER(R%) * clpcmderm(R%)\r\rNext R%\r"
  },
  {
    "Variable": "CLPCMDER",
    "UsesVariable": "POPMEDAGE",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "CLPCMDER",
    "UsesVariable": "GDPPCP",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "CLPCMDER",
    "UsesVariable": "GINIDOM",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "CLPCMDER",
    "UsesVariable": "LABPARR",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "CLPCMDER",
    "UsesVariable": "POPLE15",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "CLPCMDER",
    "UsesVariable": "POP",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "CLPCMDER",
    "UsesVariable": "GOVRISK",
    "Distance": 506,
    "Code": "\r\r'All but First: Forced Migrants\r'---------------------------------------------------\rDim Est As Single\rFor i = 1 To NR\rIf SMIGFORCEDEST(i) > 0 Then\r'JRS 2018/02/26\r'Est = 1.2825 + 17.3877 * SSFINTLWARMAG(i) / POP(i)\r'jrs 2018/06/19 Est = AMAX((-0.076 + (1.103 * SGOVRISK(i) ^ 2)) * POP(i), 0)\rEst = CSng(Math.Exp(3.469 - 12.8129 * SGOVINDSECUR(i)) * POP(i) / 100)\rMIGRANTSFORCEDOUT(i) = 0\r'If i = 10 Then Stop\rMIGRANTSFORCEDOUT(i) = MIGRANTSFORCEDOUT(i) * Est / SMIGFORCEDEST(i)\rSMIGFORCEDEST(i) = Est\r\r'If i = 70 Then Stop\r'JRS 2018/02/26\r'ElseIf SSFINTLWARMAG(i) > 0 Then\rElseIf SGOVRISK(i) > 0 Then\r'14 pc -> 4%\r'Est = 1.2825 + 17.3877 * SSFINTLWARMAG(i) / POP(i)\rEst = AMAX((-0.076 + (1.103 * SGOVRISK(i) ^ 2)) * POP(i), 0)\rMIGRANTSFORCEDOUT(i) = Est\rSMIGFORCEDEST(i) = Est\rEnd If\rNext i\r"
  },
  {
    "Variable": "CO2PER",
    "UsesVariable": "carprein",
    "Distance": 0,
    "Code": "\r'jrs 2010/03/10\rsacarb = sacarb + CSng((CARFOROTH - carabr + WCARANNSUPSide) / 2.13)\r\r'bbh 2019/04/06\r' CO2PER = (sacarb - carprein) / carprein * 100!\r'jrs 2023/02/16 it was 280 carprein = 560\rCO2PER = (sacarb - carprein) / carprein * 100.0! * co2perm\r"
  },
  {
    "Variable": "CO2PER",
    "UsesVariable": "co2perm",
    "Distance": 0,
    "Code": "\r'jrs 2010/03/10\rsacarb = sacarb + CSng((CARFOROTH - carabr + WCARANNSUPSide) / 2.13)\r"
  },
  {
    "Variable": "CO2PER",
    "UsesVariable": "CARFOROTH",
    "Distance": 2,
    "Code": "\rsacarb = carinit\r"
  },
  {
    "Variable": "CO2PER",
    "UsesVariable": "carabr",
    "Distance": 2,
    "Code": "\rsacarb = carinit\r"
  },
  {
    "Variable": "CO2PER",
    "UsesVariable": "carinit",
    "Distance": 77,
    "Code": "\r\r'jrs 2010/03/02\rFor R% = 1 To NR%\r'   BBH 1/29/04 V5_0\r'jrs 2010/03/10\r'          CARANN(R%) = (ENP(R%, Oil) * carfuel1 + _\r'          ENP(R%, Gas) * carfuel2 + ENP(R%, Coal) * carfuel3) * WCarbM\r'          sacarb = sacarb + CARANN(R%)\r'          WCARANNSUPSide = WCARANNSUPSide + CARANN(R%)\rWCARANNSUPSide = WCARANNSUPSide + (ENP(R%, Oil) * carfuel1 +\r                ENP(R%, Gas) * carfuel2 + ENP(R%, Coal) * carfuel3) * WCarbM\r'Emissions of carbon from each barrel of oil equivalent of 3 fossil fuels (carfuel1, 2, 3):\r'At https://www.epa.gov/energy/greenhouse-gases-equivalencies-calculator-calculations-and-references\r'the EPA says that a barrel of oil contains  0.43 metric tons of carbon (the Google blurb says 4.2961\r'kilograms per barrel).  Divide that by 3.664 (next entry below) and you have 0.11735 metric tons per barrel.\r'The old value in IFs was 0.0831, so replaced with this.\r'The EIA at https://www.eia.gov/tools/faqs/faq.php?id=73&t=11 gives relative CO2 content for various fossil fuel\r'BTU equivalents.  Using that can set gas at 0.0857 (was 0.0581) and coal at 0.15536 (was 0.01040).\r'When these are swapped into GlobalParameters the global fossil fuel production in IFs in 2015 times them\r'produces a total emissions very close to the CMIP project numbers; before they had to be scaled up\r'to exogenous annual emissions with a significant shift factor.\rNext R%\r"
  },
  {
    "Variable": "CO2PER",
    "UsesVariable": "ENP",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "CO2PER",
    "UsesVariable": "carfuel1",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "CO2PER",
    "UsesVariable": "carfuel2",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "CO2PER",
    "UsesVariable": "carfuel3",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "CO2PER",
    "UsesVariable": "carannwi",
    "Distance": 76,
    "Code": "\r'jrs 2023/02/16 sacarb = 802.98\r'bbh 2020/02/24 start\r'Atomic weight of carbon is 12, oxygen is 16; 12 + 2*16 =44\r'  Hence to move from carbon to CO2, multiply by 44/12 = 3.67; Carbon Project says 3.664\r'  To move from CO2 to carbon, divide by 3.664\r'In 2015 the CO2PPM value of 401.5 was associaed with 797.61 billion tons of carbon\r'  Hence to move from PPM to weight of carbon, multiply by 797.61/401.5=1.9866\r'  To move from weight of carbon (billion tons?) to PPM, divide by 1.9866\r'  With preindustrial PPM level of 280, preindustrial weight of carbon would be 280*1.9866=556.24\r'  Model was assuming 560 preindustrial carbon weight in atmosphere (carprein)\r'At https://cdiac.ess-dive.lbl.gov/pns/faq.html (great source) it says \"1 ppmv of CO2= 2.13 Gt of carbon\"\r'  Hence 280 ppm pre-industrial = 596.4 gigatons of carbon\r'  Hence 400.83 ppm (Mauna Loa) in 2015 = 853.77 gigatons of carbon = 3128.21 gigatons of CO2\r'bbh 2020/02/24 end\r\r'Moved value from 740 to 755 to make PPM in 2005 379.8; data from Mauna Loa\r'October 10, 2008 BBH\r'Moved value from 755 to 774.37 to make PPM in 2010 389.85 average ML value for 2010.\r'BBH 2013/05/27\r'Could have moved value from 774.37 to 774.37*401.5/389.85=797.61 to get CO2PPM value of 401.5 for 2015.\r'Went back to formulation in all years, whichis\r'CO2PER = (sacarb - carprein) / carprein * 100!\r'CO2PPM = co2prein + co2prein * CO2PER / 100\r'carprein=560 and CO2prein=280 in Global parameters\r'for CO2PPM=401.5 in 2015, CO2PER= (401.5-280)*100/280=43.39\r'carinit=CO2PER/100*carprein + carprein =43.39/100*560+560=802.98 'bbh 2017/04/26\rWCarbM = carannwi / AMAX(0.01, WCarbEm)\r"
  },
  {
    "Variable": "CO2PPM",
    "UsesVariable": "co2prein",
    "Distance": 0,
    "Code": "\r'bbh 2020/02/24 end\r\rCO2PPM = co2prein + co2prein * CO2PER / 100\r"
  },
  {
    "Variable": "CO2PPM",
    "UsesVariable": "CO2PER",
    "Distance": 0,
    "Code": "\r'bbh 2020/02/24 end\r\rCO2PPM = co2prein + co2prein * CO2PER / 100\r"
  },
  {
    "Variable": "CONTRUSE",
    "UsesVariable": "contrusm",
    "Distance": 0,
    "Code": "\rcontrcomp = AMAX(1, contrbase + (IY% - 1) * tconr)\r\rIf IY% > 1 Then CONTRUSE(R%) = Amin(100, AMAX(1, contrcomp * contrusm(R%)))\r"
  },
  {
    "Variable": "CONTRUSE",
    "UsesVariable": "tconr",
    "Distance": 1,
    "Code": "\rcontrbase = Amin(100, contrbase)\r"
  },
  {
    "Variable": "CONTRUSE",
    "UsesVariable": "GDPPCP",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "COOKSTOVES",
    "UsesVariable": "HHTOTAL",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "COOKSTOVES",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "\r'jrs 2024/02/29\rIf COOKSTOVES(R, 3) < 0 Then\rCOOKSTOVES(R, 3) = 0\rEnd If\r\r'jrs 2024/01/15 adding cap\rDim CookStovesTot As Single = 0\r\rFor i = 1 To 3\rCookStovesTot = CookStovesTot + COOKSTOVES(R, i)\rNext i\r"
  },
  {
    "Variable": "COOKSTOVES",
    "UsesVariable": "cookstovesadd",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "COOKSTOVES",
    "UsesVariable": "ENSOLFUEL",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CPCTND",
    "UsesVariable": "LIFEXP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "CPCTND",
    "UsesVariable": "workageretiresv",
    "Distance": 1,
    "Code": "\r\r'jrs 2013/05/03\rPrivate Function SavingsAtWorkingAge(ByRef LE As Single, RetireAge As Single, workageentry As Single, DiscountRt As Single) As Single\rDim YrsWorked As Single\rYrsWorked = RetireAge - workageentry - 10\rIf YrsWorked <= 0 Then\rSavingsAtWorkingAge = 0\rExit Function\rEnd If\rDim SurvivorYrs As Single\rSurvivorYrs = LE - RetireAge\rIf SurvivorYrs <= 0 Then\rSavingsAtWorkingAge = 0\rExit Function\rEnd If\r'jrs 2013/05/27\rIf DiscountRt = 0 Then\rSavingsAtWorkingAge = SurvivorYrs / YrsWorked\rExit Function\rEnd If\r'jrs 2013/05/27 adding new parameter for savings discount rate (3%)\rSavingsAtWorkingAge = CSng(100 * (1 - (1 + DiscountRt / 100) ^ (-1 * SurvivorYrs)) / ((1 + DiscountRt / 100) ^ YrsWorked - 1))\rEnd Function\r"
  },
  {
    "Variable": "CPCTND",
    "UsesVariable": "workageentry",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "CPCTND",
    "UsesVariable": "savingsdiscountrt",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "CPCTND",
    "UsesVariable": "workageretire",
    "Distance": 0,
    "Code": "\r'jrs 2013/04/12 *** end ***\r'jrs 2013/05/27 using workageretiresv instead to independently find required savings\r'in case changing workageretire in mixed scenario\r'jrs 2013/05/03\rCPCTND(R%) = 100 - SavingsAtWorkingAge(AMAX(LIFEXP(R%, 3), 85), CSng(workageretire(R%)), CSng(workageentry(R%)), CSng(savingsdiscountrt(R%)))\r"
  },
  {
    "Variable": "CPOW",
    "UsesVariable": "drcpow",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CPOW",
    "UsesVariable": "GDS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CPOW",
    "UsesVariable": "nmilf",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CPOW",
    "UsesVariable": "cpowf",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CPOW",
    "UsesVariable": "igdpr",
    "Distance": 0,
    "Code": "\r\r'   First Year: Initial Conventional Power, Other Government Expenditures\r'   ---------------------------------------------------------------------\rCPOW(R%) = GDS(R%, Mil) *\r                (1 - nmilf(R%)) * cpowf(R%) / AMAX(0.001, igdpr(R%) + drcpow)\r"
  },
  {
    "Variable": "CPOW",
    "UsesVariable": "cpowdf",
    "Distance": 6,
    "Code": "\rFor tar% = 1 To NR%\rIf CWAR(act%, tar%) > 0.5 Then 'Conventional war with target, add damage\rConvDAM = cwarsv * CPOW(tar%)\rCIVDM(act%) = CIVDM(act%) + ConvDAM / AMAX(0.01, GDP(act%)) * cdmf\rCPOWDM(act%) = CPOWDM(act%) + ConvDAM * cpowdf\rEnd If\rIf NWAR(act%, tar%) > 0.5 Then 'Nuclear war with target, add damage\rNuclDam = CSng(1.0! - 0.5 ^ ((NPOW(tar%) * nwarsv / 1000) ^ elndpow))\rCIVDM(act%) = CIVDM(act%) + NuclDam\rCPOWDM(act%) = CPOWDM(act%) + NuclDam\rNPOWDM(act%) = nwarsv * NPOW(act%)\rEnd If\rNext tar%\r\rCPOWDM(act%) = 0\r\rFor tar% = 1 To NR%\rIf CWAR(act%, tar%) > 0.5 Then 'Conventional war with target, add damage\rConvDAM = cwarsv * CPOW(tar%)\rCIVDM(act%) = CIVDM(act%) + ConvDAM / AMAX(0.01, GDP(act%)) * cdmf\rCPOWDM(act%) = CPOWDM(act%) + ConvDAM * cpowdf\rEnd If\rIf NWAR(act%, tar%) > 0.5 Then 'Nuclear war with target, add damage\rNuclDam = CSng(1.0! - 0.5 ^ ((NPOW(tar%) * nwarsv / 1000) ^ elndpow))\rCIVDM(act%) = CIVDM(act%) + NuclDam\rCPOWDM(act%) = CPOWDM(act%) + NuclDam\rNPOWDM(act%) = nwarsv * NPOW(act%)\rEnd If\rNext tar%\r\rFor tar% = 1 To NR%\rIf CWAR(act%, tar%) > 0.5 Then 'Conventional war with target, add damage\rConvDAM = cwarsv * CPOW(tar%)\rCIVDM(act%) = CIVDM(act%) + ConvDAM / AMAX(0.01, GDP(act%)) * cdmf\rCPOWDM(act%) = CPOWDM(act%) + ConvDAM * cpowdf\rEnd If\rIf NWAR(act%, tar%) > 0.5 Then 'Nuclear war with target, add damage\rNuclDam = CSng(1.0! - 0.5 ^ ((NPOW(tar%) * nwarsv / 1000) ^ elndpow))\rCIVDM(act%) = CIVDM(act%) + NuclDam\rCPOWDM(act%) = CPOWDM(act%) + NuclDam\rNPOWDM(act%) = nwarsv * NPOW(act%)\rEnd If\rNext tar%\r\rFor tar% = 1 To NR%\rIf CWAR(act%, tar%) > 0.5 Then 'Conventional war with target, add damage\rConvDAM = cwarsv * CPOW(tar%)\rCIVDM(act%) = CIVDM(act%) + ConvDAM / AMAX(0.01, GDP(act%)) * cdmf\rCPOWDM(act%) = CPOWDM(act%) + ConvDAM * cpowdf\rEnd If\rIf NWAR(act%, tar%) > 0.5 Then 'Nuclear war with target, add damage\rNuclDam = CSng(1.0! - 0.5 ^ ((NPOW(tar%) * nwarsv / 1000) ^ elndpow))\rCIVDM(act%) = CIVDM(act%) + NuclDam\rCPOWDM(act%) = CPOWDM(act%) + NuclDam\rNPOWDM(act%) = nwarsv * NPOW(act%)\rEnd If\rNext tar%\r\rSCPOW(act%) = CSng(SCPOW(act%) * (1 - Amin(0.8, CPOWDM(act%))))\r"
  },
  {
    "Variable": "CPOW",
    "UsesVariable": "CWAR",
    "Distance": 6,
    "Code": "\rFor tar% = 1 To NR%\rIf CWAR(act%, tar%) > 0.5 Then 'Conventional war with target, add damage\rConvDAM = cwarsv * CPOW(tar%)\rCIVDM(act%) = CIVDM(act%) + ConvDAM / AMAX(0.01, GDP(act%)) * cdmf\rCPOWDM(act%) = CPOWDM(act%) + ConvDAM * cpowdf\rEnd If\rIf NWAR(act%, tar%) > 0.5 Then 'Nuclear war with target, add damage\rNuclDam = CSng(1.0! - 0.5 ^ ((NPOW(tar%) * nwarsv / 1000) ^ elndpow))\rCIVDM(act%) = CIVDM(act%) + NuclDam\rCPOWDM(act%) = CPOWDM(act%) + NuclDam\rNPOWDM(act%) = nwarsv * NPOW(act%)\rEnd If\rNext tar%\r"
  },
  {
    "Variable": "CPOW",
    "UsesVariable": "NPOW",
    "Distance": 5,
    "Code": "\rFor tar% = 1 To NR%\rIf CWAR(act%, tar%) > 0.5 Then 'Conventional war with target, add damage\rConvDAM = cwarsv * CPOW(tar%)\rCIVDM(act%) = CIVDM(act%) + ConvDAM / AMAX(0.01, GDP(act%)) * cdmf\rCPOWDM(act%) = CPOWDM(act%) + ConvDAM * cpowdf\rEnd If\rIf NWAR(act%, tar%) > 0.5 Then 'Nuclear war with target, add damage\rNuclDam = CSng(1.0! - 0.5 ^ ((NPOW(tar%) * nwarsv / 1000) ^ elndpow))\rCIVDM(act%) = CIVDM(act%) + NuclDam\rCPOWDM(act%) = CPOWDM(act%) + NuclDam\rNPOWDM(act%) = nwarsv * NPOW(act%)\rEnd If\rNext tar%\r"
  },
  {
    "Variable": "CPOW",
    "UsesVariable": "nwarsv",
    "Distance": 5,
    "Code": "\rFor tar% = 1 To NR%\rIf CWAR(act%, tar%) > 0.5 Then 'Conventional war with target, add damage\rConvDAM = cwarsv * CPOW(tar%)\rCIVDM(act%) = CIVDM(act%) + ConvDAM / AMAX(0.01, GDP(act%)) * cdmf\rCPOWDM(act%) = CPOWDM(act%) + ConvDAM * cpowdf\rEnd If\rIf NWAR(act%, tar%) > 0.5 Then 'Nuclear war with target, add damage\rNuclDam = CSng(1.0! - 0.5 ^ ((NPOW(tar%) * nwarsv / 1000) ^ elndpow))\rCIVDM(act%) = CIVDM(act%) + NuclDam\rCPOWDM(act%) = CPOWDM(act%) + NuclDam\rNPOWDM(act%) = nwarsv * NPOW(act%)\rEnd If\rNext tar%\r"
  },
  {
    "Variable": "CPOW",
    "UsesVariable": "elndpow",
    "Distance": 5,
    "Code": "\rFor tar% = 1 To NR%\rIf CWAR(act%, tar%) > 0.5 Then 'Conventional war with target, add damage\rConvDAM = cwarsv * CPOW(tar%)\rCIVDM(act%) = CIVDM(act%) + ConvDAM / AMAX(0.01, GDP(act%)) * cdmf\rCPOWDM(act%) = CPOWDM(act%) + ConvDAM * cpowdf\rEnd If\rIf NWAR(act%, tar%) > 0.5 Then 'Nuclear war with target, add damage\rNuclDam = CSng(1.0! - 0.5 ^ ((NPOW(tar%) * nwarsv / 1000) ^ elndpow))\rCIVDM(act%) = CIVDM(act%) + NuclDam\rCPOWDM(act%) = CPOWDM(act%) + NuclDam\rNPOWDM(act%) = nwarsv * NPOW(act%)\rEnd If\rNext tar%\r"
  },
  {
    "Variable": "CPOW",
    "UsesVariable": "cwarsv",
    "Distance": 8,
    "Code": "\rFor tar% = 1 To NR%\rIf CWAR(act%, tar%) > 0.5 Then 'Conventional war with target, add damage\rConvDAM = cwarsv * CPOW(tar%)\rCIVDM(act%) = CIVDM(act%) + ConvDAM / AMAX(0.01, GDP(act%)) * cdmf\rCPOWDM(act%) = CPOWDM(act%) + ConvDAM * cpowdf\rEnd If\rIf NWAR(act%, tar%) > 0.5 Then 'Nuclear war with target, add damage\rNuclDam = CSng(1.0! - 0.5 ^ ((NPOW(tar%) * nwarsv / 1000) ^ elndpow))\rCIVDM(act%) = CIVDM(act%) + NuclDam\rCPOWDM(act%) = CPOWDM(act%) + NuclDam\rNPOWDM(act%) = nwarsv * NPOW(act%)\rEnd If\rNext tar%\r"
  },
  {
    "Variable": "cpowf",
    "UsesVariable": "cpowldcf",
    "Distance": 0,
    "Code": "\r\r'kbn 2018/02/16 Start Drug model below\rCall ComputeDrugs(context)\r'kbn 2018/02/16 end\r\r\r'   All but First 1:  Power:  Conventional and Nuclear\r'   ------------------------------------------------\r\rFor R% = 1 To NR%\rNPOW(R%) = SNPOW(R%) * (1 - drnpow) + GDS(R%, Mil) * nmilf(R%) * npowf\r'Note:  This is inconsistent with specification in preprocessor\r' (.002 billion/warhead)\r'and results in sharp decline in arsenals; result right, but wrong reasons\rcpowf(R%) = cpowldcf - (cpowldcf - 1) * Amin(10, GDPPC(R%)) / 10 'as in preprocessor\rCPOW(R%) = SCPOW(R%) * (1 - drcpow) + GDS(R%, Mil) * (1 - nmilf(R%)) * cpowf(R%)\rNPOW(R%) = AMAX(0, Amin(NPOW(R%), 100000))\rCPOW(R%) = AMAX(0, Amin(CPOW(R%), 100000))\r'bbh 2011/08/18\rGOVNUCWP(R%) = GOVNUCWP(R%) + govnucwpadd(R%)\rGOVNUCWP(R%) = AMAX(0, Amin(GOVNUCWP(R%), 900000))\r'bbh 2011/08/18 end\r'jrs 2011/10/11\rSGOVNUCWP(R%) = GOVNUCWP(R%)\rNext R%\r"
  },
  {
    "Variable": "cpowf",
    "UsesVariable": "GDPPC",
    "Distance": 0,
    "Code": "\r\r'kbn 2018/02/16 Start Drug model below\rCall ComputeDrugs(context)\r'kbn 2018/02/16 end\r\r\r'   All but First 1:  Power:  Conventional and Nuclear\r'   ------------------------------------------------\r\rFor R% = 1 To NR%\rNPOW(R%) = SNPOW(R%) * (1 - drnpow) + GDS(R%, Mil) * nmilf(R%) * npowf\r'Note:  This is inconsistent with specification in preprocessor\r' (.002 billion/warhead)\r'and results in sharp decline in arsenals; result right, but wrong reasons\rcpowf(R%) = cpowldcf - (cpowldcf - 1) * Amin(10, GDPPC(R%)) / 10 'as in preprocessor\rCPOW(R%) = SCPOW(R%) * (1 - drcpow) + GDS(R%, Mil) * (1 - nmilf(R%)) * cpowf(R%)\rNPOW(R%) = AMAX(0, Amin(NPOW(R%), 100000))\rCPOW(R%) = AMAX(0, Amin(CPOW(R%), 100000))\r'bbh 2011/08/18\rGOVNUCWP(R%) = GOVNUCWP(R%) + govnucwpadd(R%)\rGOVNUCWP(R%) = AMAX(0, Amin(GOVNUCWP(R%), 900000))\r'bbh 2011/08/18 end\r'jrs 2011/10/11\rSGOVNUCWP(R%) = GOVNUCWP(R%)\rNext R%\r"
  },
  {
    "Variable": "CPREWORK",
    "UsesVariable": "C",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CPREWORK",
    "UsesVariable": "CRETIRE",
    "Distance": 1,
    "Code": "\r\r\rCNonRetire = CPREWORK(R%) + CWORKING(R%)\r"
  },
  {
    "Variable": "CPREWORK",
    "UsesVariable": "CWORKING",
    "Distance": 2,
    "Code": "\r\r\rCNonRetire = CPREWORK(R%) + CWORKING(R%)\r"
  },
  {
    "Variable": "CPREWORK",
    "UsesVariable": "POPPREWORK",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "CPREWORK",
    "UsesVariable": "POP",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "CPREWORK",
    "UsesVariable": "workageentry",
    "Distance": 22,
    "Code": "0"
  },
  {
    "Variable": "CPREWORK",
    "UsesVariable": "POPWORKING",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "CPREWORK",
    "UsesVariable": "cpctnduse",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "CPREWORK",
    "UsesVariable": "POPRETIRED",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "CPREWORK",
    "UsesVariable": "workageretire",
    "Distance": 20,
    "Code": "0"
  },
  {
    "Variable": "CPREWORK",
    "UsesVariable": "LIFEXP",
    "Distance": 20,
    "Code": "\r\rIf cpctnduse(R%) > 0 Then\r'bbh 2014/06/18 start\r'Find Savings needed at needed retirement age\r'Annuity of 20 during working years PV = C * [(1-(1+i)^-n)/i]\rSavingsNew(R%) = CSng(20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - WORKAGERETIREND(R%))) /\r               (savingsdiscountrt(R%) / 100)))\r'Find current Savings\rSavingsOld(R%) = CSng(20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - workageretire(R%))) /\r               (savingsdiscountrt(R%) / 100)))\r'Find hole in $\rSavingsNeeded(R%) = SavingsNew(R%) - SavingsOld(R%)\r\r\rSavingsNeeded(R%) = SavingsNeeded(R%) * cpctnduse(R%) / 100\rSavingsAdjustNeeded = SavingsNeeded(R%) / AMAX(0.0001, SavingsOld(R%)) * 100\rworkercon = workercon - Amin(15, AMAX(0, SavingsAdjustNeeded))\r\r'            'jrs 2013/05/28\r'            TotSavingsNeeded = SavingsOld(R%) + SavingsNeeded(R%) * cpctnduse(R%) / 100\r'            'C = PV/((1-(1+i)^-n)/i)\r'            TotSavingsNeeded = TotSavingsNeeded / _\r'                ((1 - (1 + savingsdiscountrt(R%)) ^ (workageentry(R%) - workageretiresv)) _\r'                / savingsdiscountrt(R%) / 100)\r'            workercon = 100 - TotSavingsNeeded 'May replace function based computation above\r'bbh 2014/06/18 end\rEnd If\r"
  },
  {
    "Variable": "CPREWORK",
    "UsesVariable": "savingsdiscountrt",
    "Distance": 16,
    "Code": "0"
  },
  {
    "Variable": "CPREWORK",
    "UsesVariable": "WORKAGERETIREND",
    "Distance": 17,
    "Code": "\r\rIf cpctnduse(R%) > 0 Then\r'bbh 2014/06/18 start\r'Find Savings needed at needed retirement age\r'Annuity of 20 during working years PV = C * [(1-(1+i)^-n)/i]\rSavingsNew(R%) = CSng(20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - WORKAGERETIREND(R%))) /\r               (savingsdiscountrt(R%) / 100)))\r'Find current Savings\rSavingsOld(R%) = CSng(20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - workageretire(R%))) /\r               (savingsdiscountrt(R%) / 100)))\r'Find hole in $\rSavingsNeeded(R%) = SavingsNew(R%) - SavingsOld(R%)\r\r\rSavingsNeeded(R%) = SavingsNeeded(R%) * cpctnduse(R%) / 100\rSavingsAdjustNeeded = SavingsNeeded(R%) / AMAX(0.0001, SavingsOld(R%)) * 100\rworkercon = workercon - Amin(15, AMAX(0, SavingsAdjustNeeded))\r\r'            'jrs 2013/05/28\r'            TotSavingsNeeded = SavingsOld(R%) + SavingsNeeded(R%) * cpctnduse(R%) / 100\r'            'C = PV/((1-(1+i)^-n)/i)\r'            TotSavingsNeeded = TotSavingsNeeded / _\r'                ((1 - (1 + savingsdiscountrt(R%)) ^ (workageentry(R%) - workageretiresv)) _\r'                / savingsdiscountrt(R%) / 100)\r'            workercon = 100 - TotSavingsNeeded 'May replace function based computation above\r'bbh 2014/06/18 end\rEnd If\r"
  },
  {
    "Variable": "CRA",
    "UsesVariable": "C",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "CRA",
    "UsesVariable": "HHINCDIS",
    "Distance": 115,
    "Code": "0"
  },
  {
    "Variable": "CRA",
    "UsesVariable": "HHINCDISPERM",
    "Distance": 115,
    "Code": "0"
  },
  {
    "Variable": "CRA",
    "UsesVariable": "gdprext",
    "Distance": 115,
    "Code": "0"
  },
  {
    "Variable": "CRA",
    "UsesVariable": "GDP",
    "Distance": 101,
    "Code": "0"
  },
  {
    "Variable": "CRA",
    "UsesVariable": "HHSAVSURSTOCK",
    "Distance": 103,
    "Code": "0"
  },
  {
    "Variable": "CRA",
    "UsesVariable": "GDPPCP",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "CRETIRE",
    "UsesVariable": "C",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CRETIRE",
    "UsesVariable": "GDPPC",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "CRETIRE",
    "UsesVariable": "POPRETIRED",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "CRETIRE",
    "UsesVariable": "GOVHHPENT",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "CRETIRE",
    "UsesVariable": "GDP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "CRETIRE",
    "UsesVariable": "POP",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "CRETIRE",
    "UsesVariable": "workageretire",
    "Distance": 23,
    "Code": "0"
  },
  {
    "Variable": "CRETIRE",
    "UsesVariable": "LIFEXP",
    "Distance": 23,
    "Code": "0"
  },
  {
    "Variable": "CRETIRE",
    "UsesVariable": "POPPREWORK",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "CRETIRE",
    "UsesVariable": "workageentry",
    "Distance": 25,
    "Code": "0"
  },
  {
    "Variable": "CRETIRE",
    "UsesVariable": "POPWORKING",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "CRETIRE",
    "UsesVariable": "cpctnduse",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "CRETIRE",
    "UsesVariable": "savingsdiscountrt",
    "Distance": 19,
    "Code": "0"
  },
  {
    "Variable": "CRETIRE",
    "UsesVariable": "WORKAGERETIREND",
    "Distance": 20,
    "Code": "\r\rIf cpctnduse(R%) > 0 Then\r'bbh 2014/06/18 start\r'Find Savings needed at needed retirement age\r'Annuity of 20 during working years PV = C * [(1-(1+i)^-n)/i]\rSavingsNew(R%) = CSng(20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - WORKAGERETIREND(R%))) /\r               (savingsdiscountrt(R%) / 100)))\r'Find current Savings\rSavingsOld(R%) = CSng(20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - workageretire(R%))) /\r               (savingsdiscountrt(R%) / 100)))\r'Find hole in $\rSavingsNeeded(R%) = SavingsNew(R%) - SavingsOld(R%)\r\r\rSavingsNeeded(R%) = SavingsNeeded(R%) * cpctnduse(R%) / 100\rSavingsAdjustNeeded = SavingsNeeded(R%) / AMAX(0.0001, SavingsOld(R%)) * 100\rworkercon = workercon - Amin(15, AMAX(0, SavingsAdjustNeeded))\r\r'            'jrs 2013/05/28\r'            TotSavingsNeeded = SavingsOld(R%) + SavingsNeeded(R%) * cpctnduse(R%) / 100\r'            'C = PV/((1-(1+i)^-n)/i)\r'            TotSavingsNeeded = TotSavingsNeeded / _\r'                ((1 - (1 + savingsdiscountrt(R%)) ^ (workageentry(R%) - workageretiresv)) _\r'                / savingsdiscountrt(R%) / 100)\r'            workercon = 100 - TotSavingsNeeded 'May replace function based computation above\r'bbh 2014/06/18 end\rEnd If\r"
  },
  {
    "Variable": "CS",
    "UsesVariable": "CSHHU",
    "Distance": 0,
    "Code": "\rFor S% = 1 To NSec%\rCS(R%, S%) = CSHHU(R%, S%) + CSHHS(R%, S%)\rSumCS = SumCS + CS(R%, S%)\r'If RegName$(R%) = \"Afghanistan\" And S% = 6 Then Stop\r\rNext S%\r"
  },
  {
    "Variable": "CS",
    "UsesVariable": "CSHHS",
    "Distance": 0,
    "Code": "\rFor S% = 1 To NSec%\rCS(R%, S%) = CSHHU(R%, S%) + CSHHS(R%, S%)\rSumCS = SumCS + CS(R%, S%)\r'If RegName$(R%) = \"Afghanistan\" And S% = 6 Then Stop\r\rNext S%\r"
  },
  {
    "Variable": "CS",
    "UsesVariable": "IGCF",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "CS",
    "UsesVariable": "enon",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "CS",
    "UsesVariable": "C",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "CS",
    "UsesVariable": "agon",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "CS",
    "UsesVariable": "GDPRPA",
    "Distance": 157,
    "Code": "0"
  },
  {
    "Variable": "CS",
    "UsesVariable": "elasit",
    "Distance": 157,
    "Code": "0"
  },
  {
    "Variable": "CS",
    "UsesVariable": "VADD",
    "Distance": 816,
    "Code": "0"
  },
  {
    "Variable": "CS",
    "UsesVariable": "WP",
    "Distance": 816,
    "Code": "0"
  },
  {
    "Variable": "CS",
    "UsesVariable": "FDEM",
    "Distance": 0,
    "Code": "\r'        XS(R%, 1) = xsf(R%, 1) * AGX(R%, 1) * swapi(1) + xsf(R%, 2) * AGX(R%, 2) * swapi(2) + _\r'            xsf(R%, 3) * AGX(R%, 3) * swapi(3)\r'        MS(R%, 1) = msf(R%, 1) * AGM(R%, 1) * swapi(1) + msf(R%, 2) * AGM(R%, 2) * swapi(2) + _\r'            msf(R%, 3) * AGM(R%, 3) * swapi(3)\r\r\r'jrs 2014/11/25 CS(R%, 1) = CSF(R%) * (FDEM(R%) * swapi(1) + AGDEM(R%, 2) * swapi(2) + AGDEM(R%, 3) * swapi(3))\r'bbh 2017/01/24\r'CS(R%, 1) = CSF(R%) * (FDEM(R%, 1) * swapi(1) + AGDEM(R%, 2) * swapi(2) + AGDEM(R%, 3) * swapi(3))\rCS(R%, 1) = CSF(R%) * (FDEM(R%, 1) * swapi(1) + FDEM(R%, 2) * swapi(2) + FDEM(R%, 3) * swapi(3))\r"
  },
  {
    "Variable": "CS",
    "UsesVariable": "WAP",
    "Distance": 474,
    "Code": "\r\rFor f% = 1 To 3\rswapi(f%) = WAP(f%)\rswxc(f%) = 1\rswmd(f%) = 1\rGlobalSurDefRate(f%) = 0 'bbh 2022/10/27\rSGlobalSurDefRate(f%) = 0 'bbh 2022/11/28\rWTFoodType(f%) = 0 'bbh 2022/10/27 Initialize global trade by food type\rFor R% = 1 To NR%\rWTFoodType(f%) = WTFoodType(f%) + AGX(R%, f%)\rNext R%\rNext f%\r"
  },
  {
    "Variable": "CS",
    "UsesVariable": "ENDEM",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CSHHS",
    "UsesVariable": "CSHHU",
    "Distance": 7,
    "Code": "\r'        For S% = 1 To NSec%\r'            CSHHU(R%, S%) = CSHHU(R%, S%) * consumhh(R%, Unskilled) / SumCSU\r'            CSHHS(R%, S%) = CSHHS(R%, S%) * consumhh(R%, Skilled) / SumCSS\r'        Next S%\r\r'If RegName$(R%) = \"United States of America\" Then Stop\r\r' bbh 2019/03/09 end revised section\r\r' bbh 2019/03/09 beginning of edit section, removing old marginal budget/Engel's approach\r'   and leaving residual sector normalization\r\r'   All but First 4:  Expenditure Components by Origin Sector - Consumption, Unskilled\r'   ----------------------------------------------------------------------------------\r\r'        For S% = 1 To NSec% 'Needs to be in call4: because call2 to IFsAg computes CS\r'            If ((S% > Ener) Or (S% = Agri And agon < 0.9) Or (S% = Ener And enon < 0.9)) Then\r'                CSHHU(R%, S%) = sminexhh(R%, S%, Unskilled) + smarbdhh(R%, S%, Unskilled) * _\r'                    (consumhh(R%, Unskilled) - sfloorhh(R%, Unskilled))\r'                CSHHU(R%, S%) = AMAX(0.2 * sminexhh(R%, S%, Unskilled), CSHHU(R%, S%))\r'            Else\r'                CSHHU(R%, S%) = CS(R%, S%) * consumhh(R%, Unskilled) / AMAX(0.001, C(R%))\r'                    'Divide energy and ag according to consumption share\r'            End If\r'        Next S%\rSumCS = 0\r\rconsumhh(R%, Skilled) = consumhh(R%, Skilled) / consumtotal * C(R%)\r\rFor S% = 3 To NSec%\rSumCS = SumCS + CSHHU(R%, S%)\rNext S%\r\r\r'   All but First 4:  Expenditure Components by Origin Sector - Consumption, Skilled\r'   ----------------------------------------------------------------------------------\r\r'        For S% = 1 To NSec% 'Needs to be in call4: because call2 to IFsAg computes CS\r'            If ((S% > Ener) Or (S% = Agri And agon < 0.9) Or (S% = Ener And enon < 0.9)) Then\r'                CSHHS(R%, S%) = sminexhh(R%, S%, Skilled) + smarbdhh(R%, S%, Skilled) * _\r'                    (consumhh(R%, Skilled) - sfloorhh(R%, Skilled))\r'                CSHHS(R%, S%) = AMAX(0.2 * sminexhh(R%, S%, Skilled), CSHHS(R%, S%))\r'            Else\r'                CSHHS(R%, S%) = CS(R%, S%) * consumhh(R%, Skilled) / AMAX(0.001, C(R%))\r'                    'Divide energy and ag according to consumption share\r'            End If\r'        Next S%\r'If RegName$(R%) = \"Hong Kong\" And IY% >= 91 Then Stop\r\rSumCS = 0\r\rFor S% = 3 To NSec% 'Normalize nonphysical sectors to remainder of C\rresidc = AMAX(0.05 * consumhh(R%, Skilled),\r                consumhh(R%, Skilled) - CSHHS(R%, 1) - CSHHS(R%, 2))\rCSHHS(R%, S%) = CSHHS(R%, S%) / AMAX(0.001, SumCS) * residc\rCSHHS(R%, S%) = AMAX(0.0001, CSHHS(R%, S%))\rNext S%\r\rFor S% = 3 To NSec%\rSumCS = SumCS + CSHHS(R%, S%)\rNext S%\r\rFor S% = 3 To NSec% 'Normalize nonphysical sectors to remainder of C\rresidc = AMAX(0.05 * consumhh(R%, Skilled),\r                consumhh(R%, Skilled) - CSHHS(R%, 1) - CSHHS(R%, 2))\rCSHHS(R%, S%) = CSHHS(R%, S%) / AMAX(0.001, SumCS) * residc\rCSHHS(R%, S%) = AMAX(0.0001, CSHHS(R%, S%))\rNext S%\r\rFor S% = 3 To NSec% 'Normalize nonphysical sectors to remainder of C\rresidc = AMAX(0.05 * consumhh(R%, Skilled),\r                consumhh(R%, Skilled) - CSHHS(R%, 1) - CSHHS(R%, 2))\rCSHHS(R%, S%) = CSHHS(R%, S%) / AMAX(0.001, SumCS) * residc\rCSHHS(R%, S%) = AMAX(0.0001, CSHHS(R%, S%))\rNext S%\r"
  },
  {
    "Variable": "CSHHS",
    "UsesVariable": "C",
    "Distance": 23,
    "Code": "0"
  },
  {
    "Variable": "CSHHS",
    "UsesVariable": "CRA",
    "Distance": 163,
    "Code": "0"
  },
  {
    "Variable": "CSHHS",
    "UsesVariable": "HHINCDIS",
    "Distance": 180,
    "Code": "0"
  },
  {
    "Variable": "CSHHS",
    "UsesVariable": "HHINCDISPERM",
    "Distance": 180,
    "Code": "0"
  },
  {
    "Variable": "CSHHS",
    "UsesVariable": "GDP",
    "Distance": 165,
    "Code": "0"
  },
  {
    "Variable": "CSHHS",
    "UsesVariable": "HHSAVSURSTOCK",
    "Distance": 167,
    "Code": "0"
  },
  {
    "Variable": "CSHHS",
    "UsesVariable": "CS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CSHHS",
    "UsesVariable": "HHPOP",
    "Distance": 3,
    "Code": "\rconsumhh(R%, Skilled) = consumhh(R%, Skilled) / consumtotal * C(R%)\r"
  },
  {
    "Variable": "CSHHS",
    "UsesVariable": "GDPPCP",
    "Distance": 17,
    "Code": "0"
  },
  {
    "Variable": "CSHHU",
    "UsesVariable": "C",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "CSHHU",
    "UsesVariable": "CRA",
    "Distance": 158,
    "Code": "0"
  },
  {
    "Variable": "CSHHU",
    "UsesVariable": "HHINCDIS",
    "Distance": 175,
    "Code": "0"
  },
  {
    "Variable": "CSHHU",
    "UsesVariable": "HHINCDISPERM",
    "Distance": 175,
    "Code": "0"
  },
  {
    "Variable": "CSHHU",
    "UsesVariable": "GDP",
    "Distance": 160,
    "Code": "0"
  },
  {
    "Variable": "CSHHU",
    "UsesVariable": "HHSAVSURSTOCK",
    "Distance": 162,
    "Code": "0"
  },
  {
    "Variable": "CSHHU",
    "UsesVariable": "CS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CSHHU",
    "UsesVariable": "HHPOP",
    "Distance": 2,
    "Code": "\rconsumhh(R%, Skilled) = consumhh(R%, Skilled) / consumtotal * C(R%)\r"
  },
  {
    "Variable": "CSHHU",
    "UsesVariable": "GDPPCP",
    "Distance": 16,
    "Code": "0"
  },
  {
    "Variable": "CURACT",
    "UsesVariable": "MTARIFFREV",
    "Distance": 0,
    "Code": "\r'Definitionally, CURACT does include trade balance, unilateral transfers such as remittances and aid, and\r'   also income receipts (e.g. dividend and interest payments from foreign assets); was finding that\r'   the Interest term here was not behaving very well; need to revisit foreign assets treatment\r'FORSAV(R%) = CURACT(R%) 'bbh 2020/07/07\r'FORSAV(R%) = -CURACT(R%) 'bbh 2021/07/07 'this is right, -CURACT, but FORSAV now computed elsewhere\rFor S% = 1 To NSec% 'bbh 2022/12/13 For-Next added because earlier SMTariffRev was added to GOVREV, so this needed in SAM logic\rCURACT(R%) = CURACT(R%) + SMTariffRev(R%, S%)\rNext S%\r"
  },
  {
    "Variable": "CURACT",
    "UsesVariable": "TRADEBAL",
    "Distance": 0,
    "Code": "\rCURACT(R%) = TRADEBAL(R%) + AID(R%) + XWORKREMIT(R%) '- NetInterestPaidAbroad Turn back off for now\r"
  },
  {
    "Variable": "CURACT",
    "UsesVariable": "AID",
    "Distance": 0,
    "Code": "\rCURACT(R%) = TRADEBAL(R%) + AID(R%) + XWORKREMIT(R%) '- NetInterestPaidAbroad Turn back off for now\r"
  },
  {
    "Variable": "CURACT",
    "UsesVariable": "XWORKREMIT",
    "Distance": 0,
    "Code": "\rCURACT(R%) = TRADEBAL(R%) + AID(R%) + XWORKREMIT(R%) '- NetInterestPaidAbroad Turn back off for now\r"
  },
  {
    "Variable": "CURACTDATATOP",
    "UsesVariable": "TRADEBAL",
    "Distance": 0,
    "Code": "\rCURACTDATATOP(R%) = TRADEBAL(R%) / GDPPOT(R%) * 100 + CURACTNETPRI(R%) + CURACTNETSEC(R%)\r"
  },
  {
    "Variable": "CURACTDATATOP",
    "UsesVariable": "GDPPOT",
    "Distance": 0,
    "Code": "\rCURACTDATATOP(R%) = TRADEBAL(R%) / GDPPOT(R%) * 100 + CURACTNETPRI(R%) + CURACTNETSEC(R%)\r"
  },
  {
    "Variable": "CURACTDATATOP",
    "UsesVariable": "CURACTNETPRI",
    "Distance": 0,
    "Code": "\rCURACTDATATOP(R%) = TRADEBAL(R%) / GDPPOT(R%) * 100 + CURACTNETPRI(R%) + CURACTNETSEC(R%)\r"
  },
  {
    "Variable": "CURACTDATATOP",
    "UsesVariable": "CURACTNETSEC",
    "Distance": 0,
    "Code": "\rCURACTDATATOP(R%) = TRADEBAL(R%) / GDPPOT(R%) * 100 + CURACTNETPRI(R%) + CURACTNETSEC(R%)\r"
  },
  {
    "Variable": "CURACTNETPRI",
    "UsesVariable": "GDPPOT",
    "Distance": 0,
    "Code": "\rNetInterestPaidAbroad = DebtToIFIs * lintr + NetFirmDebtAbroad * lintr +\r                 NetGovtDebtAbroad * lintr\r\r\rCURACTNETPRI(R%) = -NetInterestPaidAbroad / GDPPOT(R%) * 100 '- NetInterestPaidAbroad Turn back off for now\r"
  },
  {
    "Variable": "CURACTNETPRI",
    "UsesVariable": "lintr",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "CURACTNETPRI",
    "UsesVariable": "XIMFCREDIT",
    "Distance": 9,
    "Code": "\rNetGovtDebtAbroad = XGOVTDEBT(R%) 'Need to subtract govt assets abroad term\r"
  },
  {
    "Variable": "CURACTNETPRI",
    "UsesVariable": "XWBLOANS",
    "Distance": 9,
    "Code": "\rNetGovtDebtAbroad = XGOVTDEBT(R%) 'Need to subtract govt assets abroad term\r"
  },
  {
    "Variable": "CURACTNETPRI",
    "UsesVariable": "XFIRMDEBT",
    "Distance": 8,
    "Code": "\rNetGovtDebtAbroad = XGOVTDEBT(R%) 'Need to subtract govt assets abroad term\r"
  },
  {
    "Variable": "CURACTNETPRI",
    "UsesVariable": "XGOVTDEBT",
    "Distance": 7,
    "Code": "\rNetGovtDebtAbroad = XGOVTDEBT(R%) 'Need to subtract govt assets abroad term\r"
  },
  {
    "Variable": "CURACTNETSEC",
    "UsesVariable": "MTARIFFREV",
    "Distance": 0,
    "Code": "\rFor S% = 1 To NSec% 'bbh 2022/12/13 For-Next added because earlier SMTariffRev was added to GOVREV, so this needed in SAM logic\rCURACTNETSEC(R%) = CURACTNETSEC(R%) + SMTariffRev(R%, S%) / GDPPOT(R%) * 100\rNext S\r"
  },
  {
    "Variable": "CURACTNETSEC",
    "UsesVariable": "GDPPOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CURACTNETSEC",
    "UsesVariable": "AID",
    "Distance": 0,
    "Code": "\rCURACTNETSEC(R%) = (AID(R%) + XWORKREMIT(R%)) / GDPPOT(R%) * 100\r"
  },
  {
    "Variable": "CURACTNETSEC",
    "UsesVariable": "XWORKREMIT",
    "Distance": 0,
    "Code": "\rCURACTNETSEC(R%) = (AID(R%) + XWORKREMIT(R%)) / GDPPOT(R%) * 100\r"
  },
  {
    "Variable": "CWARPB",
    "UsesVariable": "cwarbase",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CWARPB",
    "UsesVariable": "THREAT",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "CWARPB",
    "UsesVariable": "wpthrwar",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "CWORKING",
    "UsesVariable": "C",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "CWORKING",
    "UsesVariable": "CRETIRE",
    "Distance": 2,
    "Code": "\r\r\rCNonRetire = CPREWORK(R%) + CWORKING(R%)\r"
  },
  {
    "Variable": "CWORKING",
    "UsesVariable": "CPREWORK",
    "Distance": 3,
    "Code": "\r\r\rCNonRetire = CPREWORK(R%) + CWORKING(R%)\r"
  },
  {
    "Variable": "CWORKING",
    "UsesVariable": "POPWORKING",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "CWORKING",
    "UsesVariable": "POP",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "CWORKING",
    "UsesVariable": "cpctnduse",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "CWORKING",
    "UsesVariable": "workageentry",
    "Distance": 22,
    "Code": "0"
  },
  {
    "Variable": "CWORKING",
    "UsesVariable": "workageretire",
    "Distance": 22,
    "Code": "0"
  },
  {
    "Variable": "CWORKING",
    "UsesVariable": "POPPREWORK",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "CWORKING",
    "UsesVariable": "POPRETIRED",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "CWORKING",
    "UsesVariable": "LIFEXP",
    "Distance": 21,
    "Code": "\r\rIf cpctnduse(R%) > 0 Then\r'bbh 2014/06/18 start\r'Find Savings needed at needed retirement age\r'Annuity of 20 during working years PV = C * [(1-(1+i)^-n)/i]\rSavingsNew(R%) = CSng(20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - WORKAGERETIREND(R%))) /\r               (savingsdiscountrt(R%) / 100)))\r'Find current Savings\rSavingsOld(R%) = CSng(20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - workageretire(R%))) /\r               (savingsdiscountrt(R%) / 100)))\r'Find hole in $\rSavingsNeeded(R%) = SavingsNew(R%) - SavingsOld(R%)\r\r\rSavingsNeeded(R%) = SavingsNeeded(R%) * cpctnduse(R%) / 100\rSavingsAdjustNeeded = SavingsNeeded(R%) / AMAX(0.0001, SavingsOld(R%)) * 100\rworkercon = workercon - Amin(15, AMAX(0, SavingsAdjustNeeded))\r\r'            'jrs 2013/05/28\r'            TotSavingsNeeded = SavingsOld(R%) + SavingsNeeded(R%) * cpctnduse(R%) / 100\r'            'C = PV/((1-(1+i)^-n)/i)\r'            TotSavingsNeeded = TotSavingsNeeded / _\r'                ((1 - (1 + savingsdiscountrt(R%)) ^ (workageentry(R%) - workageretiresv)) _\r'                / savingsdiscountrt(R%) / 100)\r'            workercon = 100 - TotSavingsNeeded 'May replace function based computation above\r'bbh 2014/06/18 end\rEnd If\r"
  },
  {
    "Variable": "CWORKING",
    "UsesVariable": "savingsdiscountrt",
    "Distance": 17,
    "Code": "0"
  },
  {
    "Variable": "CWORKING",
    "UsesVariable": "WORKAGERETIREND",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "DEATHCAT",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "DEATHS",
    "UsesVariable": "POP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "DEATHS",
    "UsesVariable": "tmortr2",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "DEATHS",
    "UsesVariable": "tmortr",
    "Distance": 16,
    "Code": "0"
  },
  {
    "Variable": "DEATHS",
    "UsesVariable": "GDPPCP",
    "Distance": 564,
    "Code": "0"
  },
  {
    "Variable": "DEATHS",
    "UsesVariable": "LIFEXP",
    "Distance": 33,
    "Code": "0"
  },
  {
    "Variable": "DEATHS",
    "UsesVariable": "CIVDM",
    "Distance": 17,
    "Code": "0"
  },
  {
    "Variable": "DEATHS",
    "UsesVariable": "mortconv",
    "Distance": 422,
    "Code": "0"
  },
  {
    "Variable": "DEATHS",
    "UsesVariable": "CLNEED",
    "Distance": 28,
    "Code": "0"
  },
  {
    "Variable": "DEATHS",
    "UsesVariable": "clsexp",
    "Distance": 28,
    "Code": "0"
  },
  {
    "Variable": "DEATHS",
    "UsesVariable": "mortm",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "DEATHS",
    "UsesVariable": "MORTMG",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "DEATHS",
    "UsesVariable": "AIDSDTHS",
    "Distance": 425,
    "Code": "0"
  },
  {
    "Variable": "DEATHS",
    "UsesVariable": "CLAVAL",
    "Distance": 31,
    "Code": "0"
  },
  {
    "Variable": "DEATHS",
    "UsesVariable": "agon",
    "Distance": 31,
    "Code": "0"
  },
  {
    "Variable": "DEATHS",
    "UsesVariable": "NEONATMOR",
    "Distance": 64,
    "Code": "0"
  },
  {
    "Variable": "DEATHS",
    "UsesVariable": "INFMOR",
    "Distance": 66,
    "Code": "0"
  },
  {
    "Variable": "DEATHTRPV",
    "UsesVariable": "deathtrpvm",
    "Distance": 0,
    "Code": "\r'jrs 2009/09/23\r'ttt why if IY\rIf IY = 1 Then\rIf DEATHTRPV(R%) = 0 Then\rDEATHTRPV(R%) = DeathPV\rDeathPV = 0\rEnd If\rIf DeathPV <> 0 Then\r'DEATHTRPVShift(R%) = DEATHTRPV(R%) - DeathPV\rDEATHTRPVShift(R%) = DEATHTRPV(R%) / DeathPV\rEnd If\r'JRS 2009/09/25\rDEATHTRPVI(R%) = DEATHTRPV(R%)\r'jrs 2011/11/01\rIf deathtrpvsetar(R%) <> 0 Then\rEffectSE = StdErrorMultShift(SE, CSng(DeathPV), CSng(DEATHTRPVShift(R%)), CSng(DEATHTRPVShift(R%)),\r                        CSng(deathtrpvsetar(R%)), CInt(FirstYear + deathtrpvseyrtar(R%)), FirstYear + IY - 1, CSng(DEATHTRPVI(R%)), FirstYear)\rEnd If\r\r'jrs 2009/07/07\r'Minimum is set to half of the minimum of the lowest country\r'Slovak Replublic at the time 2009/09/23\r'DEATHTRPV(R%) = Amin(AMAX((DeathPV + DEATHTRPVShift(R%)) * deathtrpvm(R%), LowLimit), 1000)\r'jrs 2011/11/01 DEATHTRPV(R%) = Amin(AMAX((DeathPV * DEATHTRPVShift(R%)) * deathtrpvm(R%), LowLimit), 1000)\r'DEATHTRPV(R%) = Amin(AMAX((DeathPV * DEATHTRPVShift(R%)) * deathtrpvm(R%), 0.045 / 2), 1000)\r'DEATHTRPV(R%) = Amin(AMAX((DeathPV + DEATHTRPVShift(R%)) * deathtrpvm(R%), 0), 1000)\rDEATHTRPV(R%) = Amin(AMAX((DeathPV * DEATHTRPVShift(R%)) * deathtrpvm(R%) * EffectSE, LowLimit), 1000)\rEnd If\r\r'jrs 2009/09/23\r'ttt why if IY\rIf IY = 1 Then\rIf DEATHTRPV(R%) = 0 Then\rDEATHTRPV(R%) = DeathPV\rDeathPV = 0\rEnd If\rIf DeathPV <> 0 Then\r'DEATHTRPVShift(R%) = DEATHTRPV(R%) - DeathPV\rDEATHTRPVShift(R%) = DEATHTRPV(R%) / DeathPV\rEnd If\r'JRS 2009/09/25\rDEATHTRPVI(R%) = DEATHTRPV(R%)\r'jrs 2011/11/01\rIf deathtrpvsetar(R%) <> 0 Then\rEffectSE = StdErrorMultShift(SE, CSng(DeathPV), CSng(DEATHTRPVShift(R%)), CSng(DEATHTRPVShift(R%)),\r                        CSng(deathtrpvsetar(R%)), CInt(FirstYear + deathtrpvseyrtar(R%)), FirstYear + IY - 1, CSng(DEATHTRPVI(R%)), FirstYear)\rEnd If\r\r'jrs 2009/07/07\r'Minimum is set to half of the minimum of the lowest country\r'Slovak Replublic at the time 2009/09/23\r'DEATHTRPV(R%) = Amin(AMAX((DeathPV + DEATHTRPVShift(R%)) * deathtrpvm(R%), LowLimit), 1000)\r'jrs 2011/11/01 DEATHTRPV(R%) = Amin(AMAX((DeathPV * DEATHTRPVShift(R%)) * deathtrpvm(R%), LowLimit), 1000)\r'DEATHTRPV(R%) = Amin(AMAX((DeathPV * DEATHTRPVShift(R%)) * deathtrpvm(R%), 0.045 / 2), 1000)\r'DEATHTRPV(R%) = Amin(AMAX((DeathPV + DEATHTRPVShift(R%)) * deathtrpvm(R%), 0), 1000)\rDEATHTRPV(R%) = Amin(AMAX((DeathPV * DEATHTRPVShift(R%)) * deathtrpvm(R%) * EffectSE, LowLimit), 1000)\rEnd If\rNext\r"
  },
  {
    "Variable": "DEATHTRPV",
    "UsesVariable": "deathtrpvsetar",
    "Distance": 1,
    "Code": "\r'jrs 2009/09/23\r'ttt why if IY\rIf IY = 1 Then\rIf DEATHTRPV(R%) = 0 Then\rDEATHTRPV(R%) = DeathPV\rDeathPV = 0\rEnd If\rIf DeathPV <> 0 Then\r'DEATHTRPVShift(R%) = DEATHTRPV(R%) - DeathPV\rDEATHTRPVShift(R%) = DEATHTRPV(R%) / DeathPV\rEnd If\r'JRS 2009/09/25\rDEATHTRPVI(R%) = DEATHTRPV(R%)\r'jrs 2011/11/01\rIf deathtrpvsetar(R%) <> 0 Then\rEffectSE = StdErrorMultShift(SE, CSng(DeathPV), CSng(DEATHTRPVShift(R%)), CSng(DEATHTRPVShift(R%)),\r                        CSng(deathtrpvsetar(R%)), CInt(FirstYear + deathtrpvseyrtar(R%)), FirstYear + IY - 1, CSng(DEATHTRPVI(R%)), FirstYear)\rEnd If\r\r'jrs 2009/07/07\r'Minimum is set to half of the minimum of the lowest country\r'Slovak Replublic at the time 2009/09/23\r'DEATHTRPV(R%) = Amin(AMAX((DeathPV + DEATHTRPVShift(R%)) * deathtrpvm(R%), LowLimit), 1000)\r'jrs 2011/11/01 DEATHTRPV(R%) = Amin(AMAX((DeathPV * DEATHTRPVShift(R%)) * deathtrpvm(R%), LowLimit), 1000)\r'DEATHTRPV(R%) = Amin(AMAX((DeathPV * DEATHTRPVShift(R%)) * deathtrpvm(R%), 0.045 / 2), 1000)\r'DEATHTRPV(R%) = Amin(AMAX((DeathPV + DEATHTRPVShift(R%)) * deathtrpvm(R%), 0), 1000)\rDEATHTRPV(R%) = Amin(AMAX((DeathPV * DEATHTRPVShift(R%)) * deathtrpvm(R%) * EffectSE, LowLimit), 1000)\rEnd If\r\r'jrs 2009/09/23\r'ttt why if IY\rIf IY = 1 Then\rIf DEATHTRPV(R%) = 0 Then\rDEATHTRPV(R%) = DeathPV\rDeathPV = 0\rEnd If\rIf DeathPV <> 0 Then\r'DEATHTRPVShift(R%) = DEATHTRPV(R%) - DeathPV\rDEATHTRPVShift(R%) = DEATHTRPV(R%) / DeathPV\rEnd If\r'JRS 2009/09/25\rDEATHTRPVI(R%) = DEATHTRPV(R%)\r'jrs 2011/11/01\rIf deathtrpvsetar(R%) <> 0 Then\rEffectSE = StdErrorMultShift(SE, CSng(DeathPV), CSng(DEATHTRPVShift(R%)), CSng(DEATHTRPVShift(R%)),\r                        CSng(deathtrpvsetar(R%)), CInt(FirstYear + deathtrpvseyrtar(R%)), FirstYear + IY - 1, CSng(DEATHTRPVI(R%)), FirstYear)\rEnd If\r\r'jrs 2009/07/07\r'Minimum is set to half of the minimum of the lowest country\r'Slovak Replublic at the time 2009/09/23\r'DEATHTRPV(R%) = Amin(AMAX((DeathPV + DEATHTRPVShift(R%)) * deathtrpvm(R%), LowLimit), 1000)\r'jrs 2011/11/01 DEATHTRPV(R%) = Amin(AMAX((DeathPV * DEATHTRPVShift(R%)) * deathtrpvm(R%), LowLimit), 1000)\r'DEATHTRPV(R%) = Amin(AMAX((DeathPV * DEATHTRPVShift(R%)) * deathtrpvm(R%), 0.045 / 2), 1000)\r'DEATHTRPV(R%) = Amin(AMAX((DeathPV + DEATHTRPVShift(R%)) * deathtrpvm(R%), 0), 1000)\rDEATHTRPV(R%) = Amin(AMAX((DeathPV * DEATHTRPVShift(R%)) * deathtrpvm(R%) * EffectSE, LowLimit), 1000)\rEnd If\r\r'pop is multiplied by 1000 because it's in millions\r\r'JRS 2009/09/25\rDim LowLimit As Single\r'jrs 2011/11/01\rDim EffectSE As Single, SE As Single\rSE = 9.49\r\r'jrs 2009/09/23\r'ttt why if IY\rIf IY = 1 Then\rIf DEATHTRPV(R%) = 0 Then\rDEATHTRPV(R%) = DeathPV\rDeathPV = 0\rEnd If\rIf DeathPV <> 0 Then\r'DEATHTRPVShift(R%) = DEATHTRPV(R%) - DeathPV\rDEATHTRPVShift(R%) = DEATHTRPV(R%) / DeathPV\rEnd If\r'JRS 2009/09/25\rDEATHTRPVI(R%) = DEATHTRPV(R%)\r'jrs 2011/11/01\rIf deathtrpvsetar(R%) <> 0 Then\rEffectSE = StdErrorMultShift(SE, CSng(DeathPV), CSng(DEATHTRPVShift(R%)), CSng(DEATHTRPVShift(R%)),\r                        CSng(deathtrpvsetar(R%)), CInt(FirstYear + deathtrpvseyrtar(R%)), FirstYear + IY - 1, CSng(DEATHTRPVI(R%)), FirstYear)\rEnd If\r\r'jrs 2009/07/07\r'Minimum is set to half of the minimum of the lowest country\r'Slovak Replublic at the time 2009/09/23\r'DEATHTRPV(R%) = Amin(AMAX((DeathPV + DEATHTRPVShift(R%)) * deathtrpvm(R%), LowLimit), 1000)\r'jrs 2011/11/01 DEATHTRPV(R%) = Amin(AMAX((DeathPV * DEATHTRPVShift(R%)) * deathtrpvm(R%), LowLimit), 1000)\r'DEATHTRPV(R%) = Amin(AMAX((DeathPV * DEATHTRPVShift(R%)) * deathtrpvm(R%), 0.045 / 2), 1000)\r'DEATHTRPV(R%) = Amin(AMAX((DeathPV + DEATHTRPVShift(R%)) * deathtrpvm(R%), 0), 1000)\rDEATHTRPV(R%) = Amin(AMAX((DeathPV * DEATHTRPVShift(R%)) * deathtrpvm(R%) * EffectSE, LowLimit), 1000)\rEnd If\r"
  },
  {
    "Variable": "DEATHTRPV",
    "UsesVariable": "deathtrpvseyrtar",
    "Distance": 1,
    "Code": "\r'jrs 2009/09/23\r'ttt why if IY\rIf IY = 1 Then\rIf DEATHTRPV(R%) = 0 Then\rDEATHTRPV(R%) = DeathPV\rDeathPV = 0\rEnd If\rIf DeathPV <> 0 Then\r'DEATHTRPVShift(R%) = DEATHTRPV(R%) - DeathPV\rDEATHTRPVShift(R%) = DEATHTRPV(R%) / DeathPV\rEnd If\r'JRS 2009/09/25\rDEATHTRPVI(R%) = DEATHTRPV(R%)\r'jrs 2011/11/01\rIf deathtrpvsetar(R%) <> 0 Then\rEffectSE = StdErrorMultShift(SE, CSng(DeathPV), CSng(DEATHTRPVShift(R%)), CSng(DEATHTRPVShift(R%)),\r                        CSng(deathtrpvsetar(R%)), CInt(FirstYear + deathtrpvseyrtar(R%)), FirstYear + IY - 1, CSng(DEATHTRPVI(R%)), FirstYear)\rEnd If\r\r'jrs 2009/07/07\r'Minimum is set to half of the minimum of the lowest country\r'Slovak Replublic at the time 2009/09/23\r'DEATHTRPV(R%) = Amin(AMAX((DeathPV + DEATHTRPVShift(R%)) * deathtrpvm(R%), LowLimit), 1000)\r'jrs 2011/11/01 DEATHTRPV(R%) = Amin(AMAX((DeathPV * DEATHTRPVShift(R%)) * deathtrpvm(R%), LowLimit), 1000)\r'DEATHTRPV(R%) = Amin(AMAX((DeathPV * DEATHTRPVShift(R%)) * deathtrpvm(R%), 0.045 / 2), 1000)\r'DEATHTRPV(R%) = Amin(AMAX((DeathPV + DEATHTRPVShift(R%)) * deathtrpvm(R%), 0), 1000)\rDEATHTRPV(R%) = Amin(AMAX((DeathPV * DEATHTRPVShift(R%)) * deathtrpvm(R%) * EffectSE, LowLimit), 1000)\rEnd If\r"
  },
  {
    "Variable": "DEATHTRPV",
    "UsesVariable": "VEHICFLPC",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "DEATHTRPV",
    "UsesVariable": "POP",
    "Distance": 3,
    "Code": "\r\r'jrs 2007/10/08\r'Smeed's Law\r'===========\r'D = .0003(np^2)^(1/3)\r\r'D is annual road deaths\r'n is number of registered vehicles\r'p is population\r'-----------\r\r'jrs 2009/09/23\rDim DeathPV As Single\rIf VEHICFLPC(R%) > 0 Then\r'jrs 2007/10/17\r'Technological Improvement of 1% per year\rTechImpr = CSng((0.99) ^ (IY - 1))\r'This is Deaths per 1,000 vehicles, so D/n*1,000, 1E+15 = 1k * 1M^2\rDeathPV = CSng((0.0003 * (VEHICFLPC(R%) * 1.0E+15 * POP(R%) ^ 3) ^ (1 / 3)) / (VEHICFLPC(R%) * POP(R%)))\r\r'jrs 2007/10/17\r'Add Technological Improvement Factor\rDeathPV = DeathPV * TechImpr\r\rEnd If\r"
  },
  {
    "Variable": "DEMOCEXP",
    "UsesVariable": "GDPPCP",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "DEMOCEXP",
    "UsesVariable": "EDYRSAG15",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "DEMOCPOLITY",
    "UsesVariable": "DEMOCWAVE",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "DEMOCPOLITY",
    "UsesVariable": "swseffmax",
    "Distance": 0,
    "Code": "\r\r\r'Swing state addition, if turned on\r'DEMOCPOLITY(R%) = SDemocPolity(R%) 'to maximize swing effects\rIf swseffects = 1 Then\rDEMOCPOLITY(R%) = DEMOCPOLITY(R%) +\r                        AMAX(-swseffmax * (IY% - 1), Amin(swseffmax * (IY% - 1), swingeffects(R%)))\rEnd If\r\rDEMOCPOLITYI(R%) = DEMOCPOLITY(R%)\r\rDEMOCPOLITYI(R%) = DEMOCPOLITY(R%)\r"
  },
  {
    "Variable": "DEMOCPOLITY",
    "UsesVariable": "swseffects",
    "Distance": 0,
    "Code": "\rFor R% = 1 To NR%\rWDemoc = WDemoc + SDEMOCPOLITY(R%)\rswingeffects(R%) = 0\rNext R%\r"
  },
  {
    "Variable": "DEMOCPOLITY",
    "UsesVariable": "democconv",
    "Distance": 0,
    "Code": "\r'If RegName(R%) = \"Tanzania\" And IY% >= 29 Then Stop\rdemoccomp(R%) = AMAX(1, Amin(20, Prediction))\r\rDEMOCPOLITY(R%) = ConvergeOverTime(DEMOCPOLITY(R%), democcomp(R%), CSng(democconv * 1.5))\r"
  },
  {
    "Variable": "DEMOCPOLITY",
    "UsesVariable": "GEM",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "DEMOCPOLITY",
    "UsesVariable": "YTHBULGE",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "DEMOCPOLITY",
    "UsesVariable": "ENX",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "DEMOCPOLITY",
    "UsesVariable": "ENPRI",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "DEMOCPOLITY",
    "UsesVariable": "GDP",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "DEMOCPOLITY",
    "UsesVariable": "democm",
    "Distance": 0,
    "Code": "\r'If RegName(R%) = \"Chad\" Then Stop\r\r' Basic domestic calculation - equal to expected value\r' If RegName(R%) = \"Armenia\" Then Stop\r\r'        democmul = democcomp(R%) / AMAX(0.01, democcomp2)\r'        DEMOCPOLITY(R%) = DEMOCPOLITYI(R%) * democmul\r\r'        If democcomp(R%) > DemocPolityI(R%) And DEMOCPOLITY(R%) > democcomp(R%) Then\r'            DEMOCPOLITY(R%) = democcomp(R%) 'Hold down growth realted to small initial\r'        End If\r'The above logic created a discontinuity (e.g. Tanzania in 2030) when democcomp\r'became just larger than democpolityi; big downward shift because democmul was about\r'1.6, so lost that multiplier on deomcpolityi=democcomp\rDEMOCPOLITY(R%) = DEMOCPOLITY(R%) * democm(R%)\r"
  },
  {
    "Variable": "DEMOCPOLITY",
    "UsesVariable": "democpolitysetar",
    "Distance": 1,
    "Code": "\rdemocpolityri(R%) = DEMOCPOLITY(R%) / AMAX(0.01, democcomp(R%))\r\rIf context.HistoricMode = True Then\r'            Call AnalFunc(\"Polity Democracy with GDPPCP and Surv-SE (1960)\", _\r'                Array(GDPPCP(R%), SURVSE(R%, WVSCohorts)), Prediction)\r'            democcomp(R%) = AMAX(1, Amin(20, Prediction))\r'            Call AnalFunc(\"Polity Democracy with GDPPCP and Surv-SE (1960)\", _\r'                Array(GDPPCIP(R%), SSURVSEI(R%, WVSCohorts)), Prediction)\r'            democcomp2 = AMAX(1, Amin(20, Prediction))\r'            'bbh 2011/05/02\r'bbh 2011/08/19\r'Call AnalFunc(\"Polity Democ versus Edyears, YthBulge, ln(EnExDep) 2005\", _\r'Array(educ15term, YTHBULGE(R%), energydepend(R%)), Prediction)\r'jrs 2011/10/05 Call AnalFunc(\"Polity Democracy versus GEM, YTHBULGE, En Export Dependence (2010)\", _\r'Array(SGEM(R%), YTHBULGE(R%), energydepend(R%)), Prediction)\r'    Call AnalFuncSE(\"Polity Democracy versus GEM, YTHBULGE, En Export Dependence (2010)\",\r'Array(SGEM(R%), YTHBULGE(R%), energydepend(R%)), Prediction, SE,\r'Array(\"GEM[0](0) (Linear)\", \"YTHBULGE[0](0) (Linear)\", \"EnExValPerGDP(0) (Linear)\")) 'jrs 2014/10/09 added DepVar Names to check order\r\r\rCall AnalFuncSE(\"Polity Democracy versus GEM, YTHBULGE, En Export Dependence (2010)\",\r                                New Single() {SGEM(R%), YTHBULGE(R%), energydepend(R%)}, Prediction, SE,\r                               New String() {\"GEM[0](0) (Linear)\", \"YTHBULGE[0](0) (Linear)\", \"EnExValPerGDP(0) (Linear)\"}, context) 'jrs 2014/10/09 added DepVar Names to check order\r\r'            Call AnalFunc(\"Polity Democ with EdYearsAg15, YthBulge, EnExDep (2005)\", _\r'Array(educ15term, YTHBULGE(R%), energydepend(R%)), Prediction)\rdemoccomp(R%) = AMAX(1, Amin(20, Prediction))\r'Note: if 0 used as minimum creates great instability at low GDPPCP\r'bbh 2011/06/23\rExpPrediction = Prediction\r'bbh 2011/06/23\r'Call AnalFunc(\"Polity Democ with GDPPCP and EdYears 15 (2005)\",\r'    Array(GDPPCP(R%), educ15term), ExpPrediction,\r'    Array(\"GDPPCP\", \"Educ15\")) 'jrs 2014/10/09 added DepVar Names to check order\r\rCall AnalFunc(\"Polity Democ with GDPPCP and EdYears 15 (2005)\",\r                    New Single() {GDPPCP(R%), educ15term}, ExpPrediction,\r                    New String() {\"GDPPCP\", \"Educ15\"}, context)\r\rElse\r'bbh 2011/06/23\r'Call AnalFunc(\"Polity Democ with GDPPCP and EdYears 15 (2005)\",\r'    Array(GDPPCP(R%), educ15term), ExpPrediction,\r'    Array(\"GDPPCP\", \"Educ15\")) 'jrs 2014/10/09 added DepVar Names to check order\r\r\rCall AnalFunc(\"Polity Democ with GDPPCP and EdYears 15 (2005)\",\r                    New Single() {GDPPCP(R%), educ15term}, ExpPrediction,\r                    New String() {\"GDPPCP\", \"Educ15\"}, context)\r\r\r'            Call AnalFunc(\"Polity Democracy with GDPPCP and Surv-SE (2000)\", _\r'                Array(GDPPCP(R%), SURVSE(R%, WVSCohorts)), Prediction)\r'            Call AnalFunc(\"Polity Democ with GDPPCP and EdYears 15 (2005)\", _\r'                Array(GDPPCP(R%), educ15term), Prediction)\r'bbh 2011/05/02\r'bbh 2011/08/19\r'Call AnalFunc(\"Polity Democ versus Edyears, YthBulge, ln(EnExDep) 2005\", _\r'Array(educ15term, YTHBULGE(R%), energydepend(R%)), Prediction)\r'jrs 2011/10/05 Call AnalFunc(\"Polity Democracy versus GEM, YTHBULGE, En Export Dependence (2010)\", _\r'Array(SGEM(R%), YTHBULGE(R%), energydepend(R%)), Prediction)\r'    Call AnalFuncSE(\"Polity Democracy versus GEM, YTHBULGE, En Export Dependence (2010)\",\r'Array(SGEM(R%), YTHBULGE(R%), energydepend(R%)), Prediction, SE,\r'Array(\"GEM[0](0) (Linear)\", \"YTHBULGE[0](0) (Linear)\", \"EnExValPerGDP(0) (Linear)\")) 'jrs 2014/10/09 added DepVar Names to check order\r\rCall AnalFuncSE(\"Polity Democracy versus GEM, YTHBULGE, En Export Dependence (2010)\",\r                     New Single() {SGEM(R%), YTHBULGE(R%), energydepend(R%)}, Prediction, SE,\r                     New String() {\"GEM[0](0) (Linear)\", \"YTHBULGE[0](0) (Linear)\", \"EnExValPerGDP(0) (Linear)\"}, context) 'jrs 2014/10/09 added DepVar Names to check order\r\r\r\r'            Call AnalFunc(\"Polity Democ with EdYearsAg15, YthBulge, EnExDep (2005)\", _\r'Array(educ15term, YTHBULGE(R%), energydepend(R%)), Prediction)\rdemoccomp(R%) = AMAX(1, Amin(20, Prediction))\r'            democcomp(R%) = AMAX(1, Amin(20, Prediction))\r'            educ15term = EDYRSAG15I(R%)\r'            Call AnalFunc(\"Polity Democ with GDPPCP and EdYears 15 (2005)\", _\r'                Array(GDPPCIP(R%), educ15term), Prediction)\r'            democcomp2 = AMAX(1, Amin(20, Prediction))\rEnd If\r\rIf context.HistoricMode = True Then\r'            Call AnalFunc(\"Polity Democracy with GDPPCP and Surv-SE (1960)\", _\r'                Array(GDPPCP(R%), SURVSE(R%, WVSCohorts)), Prediction)\r'            democcomp(R%) = AMAX(1, Amin(20, Prediction))\r'            Call AnalFunc(\"Polity Democracy with GDPPCP and Surv-SE (1960)\", _\r'                Array(GDPPCIP(R%), SSURVSEI(R%, WVSCohorts)), Prediction)\r'            democcomp2 = AMAX(1, Amin(20, Prediction))\r'            'bbh 2011/05/02\r'bbh 2011/08/19\r'Call AnalFunc(\"Polity Democ versus Edyears, YthBulge, ln(EnExDep) 2005\", _\r'Array(educ15term, YTHBULGE(R%), energydepend(R%)), Prediction)\r'jrs 2011/10/05 Call AnalFunc(\"Polity Democracy versus GEM, YTHBULGE, En Export Dependence (2010)\", _\r'Array(SGEM(R%), YTHBULGE(R%), energydepend(R%)), Prediction)\r'    Call AnalFuncSE(\"Polity Democracy versus GEM, YTHBULGE, En Export Dependence (2010)\",\r'Array(SGEM(R%), YTHBULGE(R%), energydepend(R%)), Prediction, SE,\r'Array(\"GEM[0](0) (Linear)\", \"YTHBULGE[0](0) (Linear)\", \"EnExValPerGDP(0) (Linear)\")) 'jrs 2014/10/09 added DepVar Names to check order\r\r\rCall AnalFuncSE(\"Polity Democracy versus GEM, YTHBULGE, En Export Dependence (2010)\",\r                                New Single() {SGEM(R%), YTHBULGE(R%), energydepend(R%)}, Prediction, SE,\r                               New String() {\"GEM[0](0) (Linear)\", \"YTHBULGE[0](0) (Linear)\", \"EnExValPerGDP(0) (Linear)\"}, context) 'jrs 2014/10/09 added DepVar Names to check order\r\r'            Call AnalFunc(\"Polity Democ with EdYearsAg15, YthBulge, EnExDep (2005)\", _\r'Array(educ15term, YTHBULGE(R%), energydepend(R%)), Prediction)\rdemoccomp(R%) = AMAX(1, Amin(20, Prediction))\r'Note: if 0 used as minimum creates great instability at low GDPPCP\r'bbh 2011/06/23\rExpPrediction = Prediction\r'bbh 2011/06/23\r'Call AnalFunc(\"Polity Democ with GDPPCP and EdYears 15 (2005)\",\r'    Array(GDPPCP(R%), educ15term), ExpPrediction,\r'    Array(\"GDPPCP\", \"Educ15\")) 'jrs 2014/10/09 added DepVar Names to check order\r\rCall AnalFunc(\"Polity Democ with GDPPCP and EdYears 15 (2005)\",\r                    New Single() {GDPPCP(R%), educ15term}, ExpPrediction,\r                    New String() {\"GDPPCP\", \"Educ15\"}, context)\r\rElse\r'bbh 2011/06/23\r'Call AnalFunc(\"Polity Democ with GDPPCP and EdYears 15 (2005)\",\r'    Array(GDPPCP(R%), educ15term), ExpPrediction,\r'    Array(\"GDPPCP\", \"Educ15\")) 'jrs 2014/10/09 added DepVar Names to check order\r\r\rCall AnalFunc(\"Polity Democ with GDPPCP and EdYears 15 (2005)\",\r                    New Single() {GDPPCP(R%), educ15term}, ExpPrediction,\r                    New String() {\"GDPPCP\", \"Educ15\"}, context)\r\r\r'            Call AnalFunc(\"Polity Democracy with GDPPCP and Surv-SE (2000)\", _\r'                Array(GDPPCP(R%), SURVSE(R%, WVSCohorts)), Prediction)\r'            Call AnalFunc(\"Polity Democ with GDPPCP and EdYears 15 (2005)\", _\r'                Array(GDPPCP(R%), educ15term), Prediction)\r'bbh 2011/05/02\r'bbh 2011/08/19\r'Call AnalFunc(\"Polity Democ versus Edyears, YthBulge, ln(EnExDep) 2005\", _\r'Array(educ15term, YTHBULGE(R%), energydepend(R%)), Prediction)\r'jrs 2011/10/05 Call AnalFunc(\"Polity Democracy versus GEM, YTHBULGE, En Export Dependence (2010)\", _\r'Array(SGEM(R%), YTHBULGE(R%), energydepend(R%)), Prediction)\r'    Call AnalFuncSE(\"Polity Democracy versus GEM, YTHBULGE, En Export Dependence (2010)\",\r'Array(SGEM(R%), YTHBULGE(R%), energydepend(R%)), Prediction, SE,\r'Array(\"GEM[0](0) (Linear)\", \"YTHBULGE[0](0) (Linear)\", \"EnExValPerGDP(0) (Linear)\")) 'jrs 2014/10/09 added DepVar Names to check order\r\rCall AnalFuncSE(\"Polity Democracy versus GEM, YTHBULGE, En Export Dependence (2010)\",\r                     New Single() {SGEM(R%), YTHBULGE(R%), energydepend(R%)}, Prediction, SE,\r                     New String() {\"GEM[0](0) (Linear)\", \"YTHBULGE[0](0) (Linear)\", \"EnExValPerGDP(0) (Linear)\"}, context) 'jrs 2014/10/09 added DepVar Names to check order\r\r\r\r'            Call AnalFunc(\"Polity Democ with EdYearsAg15, YthBulge, EnExDep (2005)\", _\r'Array(educ15term, YTHBULGE(R%), energydepend(R%)), Prediction)\rdemoccomp(R%) = AMAX(1, Amin(20, Prediction))\r'            democcomp(R%) = AMAX(1, Amin(20, Prediction))\r'            educ15term = EDYRSAG15I(R%)\r'            Call AnalFunc(\"Polity Democ with GDPPCP and EdYears 15 (2005)\", _\r'                Array(GDPPCIP(R%), educ15term), Prediction)\r'            democcomp2 = AMAX(1, Amin(20, Prediction))\rEnd If\r\rIf context.HistoricMode Then\r'            Call AnalFunc(\"Polity Democracy with GDPPCP and Surv-SE (1960)\", _\r'                Array(GDPPCP(R%), SURVSE(R%, WVSCohorts)), Prediction)\r'bbh 2011/05/02\r'bbh 2011/08/19\r' Call AnalFunc(\"Polity Democ versus Edyears, YthBulge, ln(EnExDep) 2005\", _\r'Array(educ15term, YTHBULGE(R%), energydepend(R%)), Prediction)\r'    Call AnalFunc(\"Polity Democracy versus GEM, YTHBULGE, En Export Dependence (2010)\",\r'Array(GEM(R%), YTHBULGE(R%), energydepend(R%)), Prediction,\r'Array(\"GEM[0](0) (Linear)\", \"YTHBULGE[0](0) (Linear)\", \"EnExValPerGDP(0) (Linear)\")) 'jrs 2014/10/09 added DepVar Names to check order\r\rCall AnalFunc(\"Polity Democracy versus GEM, YTHBULGE, En Export Dependence (2010)\",\r                    New Single() {GEM(R%), YTHBULGE(R%), energydepend(R%)}, Prediction,\r                    New String() {\"GEM[0](0) (Linear)\", \"YTHBULGE[0](0) (Linear)\", \"EnExValPerGDP(0) (Linear)\"}, context)\r\r\r\r'            Call AnalFunc(\"Polity Democ with EdYearsAg15, YthBulge, EnExDep (2005)\", _\r'Array(educ15term, YTHBULGE(R%), energydepend(R%)), Prediction)\r'Last, WVSCohorts cohort is total adult population\rdemoccomp(R%) = AMAX(1, Amin(20, Prediction))\rExpPrediction = Prediction\rElse\r'bbh 2011/06/23\r'Call AnalFunc(\"Polity Democ with GDPPCP and EdYears 15 (2005)\",\r'    Array(GDPPCP(R%), educ15term), ExpPrediction,\r'    Array(\"GDPPCP\", \"Educ15\")) 'jrs 2014/10/09 added DepVar Names to check order\r\rCall AnalFunc(\"Polity Democ with GDPPCP and EdYears 15 (2005)\",\r                    New Single() {GDPPCP(R%), educ15term}, ExpPrediction,\r                    New String() {\"GDPPCP\", \"Educ15\"}, context)\r\r\r'bbh 2011/05/02\r'bbh 2011/08/19\r'            Call AnalFunc(\"Polity Democ versus Edyears, YthBulge, ln(EnExDep) 2005\", _\r'Array(educ15term, YTHBULGE(R%), energydepend(R%)), Prediction)\r'    Call AnalFunc(\"Polity Democracy versus GEM, YTHBULGE, En Export Dependence (2010)\",\r'Array(GEM(R%), YTHBULGE(R%), energydepend(R%)), Prediction,\r'Array(\"GEM[0](0) (Linear)\", \"YTHBULGE[0](0) (Linear)\", \"EnExValPerGDP(0) (Linear)\")) 'jrs 2014/10/09 added DepVar Names to check order\r\rCall AnalFunc(\"Polity Democracy versus GEM, YTHBULGE, En Export Dependence (2010)\",\r                    New Single() {GEM(R%), YTHBULGE(R%), energydepend(R%)}, Prediction,\r                    New String() {\"GEM[0](0) (Linear)\", \"YTHBULGE[0](0) (Linear)\", \"EnExValPerGDP(0) (Linear)\"}, context)\r\r\r'            Call AnalFunc(\"Polity Democ with EdYearsAg15, YthBulge, EnExDep (2005)\", _\r'Array(educ15term, YTHBULGE(R%), energydepend(R%)), Prediction)\rdemoccomp(R%) = AMAX(1, Amin(20, Prediction))\rEnd If\r\r'jrs 2011/10/05\r'dkb 2013/09/18 added dimension 1 to democpolitysetar and democpolityseyrtar\rIf democpolitysetar(R%) <> 0 Then\rEffectSE = StdErrorMultShift(SE, CSng(democcomp(R%)), CSng(democpolityri(R%)), CSng(democpolityri(R%)),\r                    CSng(democpolitysetar(R%)), CInt(FirstYear + democpolityseyrtar(R%)), FirstYear + IY - 1, CSng(DEMOCPOLITYI(R%)), FirstYear)\rEnd If\r\rIf context.HistoricMode = True Then\r'            Call AnalFunc(\"Polity Democracy with GDPPCP and Surv-SE (1960)\", _\r'                Array(GDPPCP(R%), SURVSE(R%, WVSCohorts)), Prediction)\r'            democcomp(R%) = AMAX(1, Amin(20, Prediction))\r'            Call AnalFunc(\"Polity Democracy with GDPPCP and Surv-SE (1960)\", _\r'                Array(GDPPCIP(R%), SSURVSEI(R%, WVSCohorts)), Prediction)\r'            democcomp2 = AMAX(1, Amin(20, Prediction))\r'            'bbh 2011/05/02\r'bbh 2011/08/19\r'Call AnalFunc(\"Polity Democ versus Edyears, YthBulge, ln(EnExDep) 2005\", _\r'Array(educ15term, YTHBULGE(R%), energydepend(R%)), Prediction)\r'jrs 2011/10/05 Call AnalFunc(\"Polity Democracy versus GEM, YTHBULGE, En Export Dependence (2010)\", _\r'Array(SGEM(R%), YTHBULGE(R%), energydepend(R%)), Prediction)\r'    Call AnalFuncSE(\"Polity Democracy versus GEM, YTHBULGE, En Export Dependence (2010)\",\r'Array(SGEM(R%), YTHBULGE(R%), energydepend(R%)), Prediction, SE,\r'Array(\"GEM[0](0) (Linear)\", \"YTHBULGE[0](0) (Linear)\", \"EnExValPerGDP(0) (Linear)\")) 'jrs 2014/10/09 added DepVar Names to check order\r\r\rCall AnalFuncSE(\"Polity Democracy versus GEM, YTHBULGE, En Export Dependence (2010)\",\r                                New Single() {SGEM(R%), YTHBULGE(R%), energydepend(R%)}, Prediction, SE,\r                               New String() {\"GEM[0](0) (Linear)\", \"YTHBULGE[0](0) (Linear)\", \"EnExValPerGDP(0) (Linear)\"}, context) 'jrs 2014/10/09 added DepVar Names to check order\r\r'            Call AnalFunc(\"Polity Democ with EdYearsAg15, YthBulge, EnExDep (2005)\", _\r'Array(educ15term, YTHBULGE(R%), energydepend(R%)), Prediction)\rdemoccomp(R%) = AMAX(1, Amin(20, Prediction))\r'Note: if 0 used as minimum creates great instability at low GDPPCP\r'bbh 2011/06/23\rExpPrediction = Prediction\r'bbh 2011/06/23\r'Call AnalFunc(\"Polity Democ with GDPPCP and EdYears 15 (2005)\",\r'    Array(GDPPCP(R%), educ15term), ExpPrediction,\r'    Array(\"GDPPCP\", \"Educ15\")) 'jrs 2014/10/09 added DepVar Names to check order\r\rCall AnalFunc(\"Polity Democ with GDPPCP and EdYears 15 (2005)\",\r                    New Single() {GDPPCP(R%), educ15term}, ExpPrediction,\r                    New String() {\"GDPPCP\", \"Educ15\"}, context)\r\rElse\r'bbh 2011/06/23\r'Call AnalFunc(\"Polity Democ with GDPPCP and EdYears 15 (2005)\",\r'    Array(GDPPCP(R%), educ15term), ExpPrediction,\r'    Array(\"GDPPCP\", \"Educ15\")) 'jrs 2014/10/09 added DepVar Names to check order\r\r\rCall AnalFunc(\"Polity Democ with GDPPCP and EdYears 15 (2005)\",\r                    New Single() {GDPPCP(R%), educ15term}, ExpPrediction,\r                    New String() {\"GDPPCP\", \"Educ15\"}, context)\r\r\r'            Call AnalFunc(\"Polity Democracy with GDPPCP and Surv-SE (2000)\", _\r'                Array(GDPPCP(R%), SURVSE(R%, WVSCohorts)), Prediction)\r'            Call AnalFunc(\"Polity Democ with GDPPCP and EdYears 15 (2005)\", _\r'                Array(GDPPCP(R%), educ15term), Prediction)\r'bbh 2011/05/02\r'bbh 2011/08/19\r'Call AnalFunc(\"Polity Democ versus Edyears, YthBulge, ln(EnExDep) 2005\", _\r'Array(educ15term, YTHBULGE(R%), energydepend(R%)), Prediction)\r'jrs 2011/10/05 Call AnalFunc(\"Polity Democracy versus GEM, YTHBULGE, En Export Dependence (2010)\", _\r'Array(SGEM(R%), YTHBULGE(R%), energydepend(R%)), Prediction)\r'    Call AnalFuncSE(\"Polity Democracy versus GEM, YTHBULGE, En Export Dependence (2010)\",\r'Array(SGEM(R%), YTHBULGE(R%), energydepend(R%)), Prediction, SE,\r'Array(\"GEM[0](0) (Linear)\", \"YTHBULGE[0](0) (Linear)\", \"EnExValPerGDP(0) (Linear)\")) 'jrs 2014/10/09 added DepVar Names to check order\r\rCall AnalFuncSE(\"Polity Democracy versus GEM, YTHBULGE, En Export Dependence (2010)\",\r                     New Single() {SGEM(R%), YTHBULGE(R%), energydepend(R%)}, Prediction, SE,\r                     New String() {\"GEM[0](0) (Linear)\", \"YTHBULGE[0](0) (Linear)\", \"EnExValPerGDP(0) (Linear)\"}, context) 'jrs 2014/10/09 added DepVar Names to check order\r\r\r\r'            Call AnalFunc(\"Polity Democ with EdYearsAg15, YthBulge, EnExDep (2005)\", _\r'Array(educ15term, YTHBULGE(R%), energydepend(R%)), Prediction)\rdemoccomp(R%) = AMAX(1, Amin(20, Prediction))\r'            democcomp(R%) = AMAX(1, Amin(20, Prediction))\r'            educ15term = EDYRSAG15I(R%)\r'            Call AnalFunc(\"Polity Democ with GDPPCP and EdYears 15 (2005)\", _\r'                Array(GDPPCIP(R%), educ15term), Prediction)\r'            democcomp2 = AMAX(1, Amin(20, Prediction))\rEnd If\r\rdemocpolityri(R%) = DEMOCPOLITY(R%) / AMAX(0.01, democcomp(R%))\r\r'jrs 2011/10/05 DEMOCPOLITY(R%) = democpolityri(R%) * democcomp(R%)\rDEMOCPOLITY(R%) = democpolityri(R%) * democcomp(R%) * EffectSE\r\rDEMOCPOLITY(R%) = AMAX(1, Amin(20, DEMOCPOLITY(R%)))\r"
  },
  {
    "Variable": "DEMOCPOLITY",
    "UsesVariable": "democpolityseyrtar",
    "Distance": 1,
    "Code": "\rdemocpolityri(R%) = DEMOCPOLITY(R%) / AMAX(0.01, democcomp(R%))\r"
  },
  {
    "Variable": "DEMOCPOLYARCHY",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "\rDEMOCPOLYARCHY(R%) = AMAX(Amin(DEMOCPOLYARCHY(R%), 1), 0)\r"
  },
  {
    "Variable": "DEMOCPOLYARCHY",
    "UsesVariable": "democpolyarchyadd",
    "Distance": 0,
    "Code": "\rDEMOCPOLYARCHY(R%) = DEMOCPOLYARCHY(R%) + democpolyarchyadd(R%)\r"
  },
  {
    "Variable": "DEMOCPOLYARCHY",
    "UsesVariable": "democpolyarchym",
    "Distance": 0,
    "Code": "\r\r'If GRPS(1, R%) = \"Zambia\" And IY = 4 Then Stop\r'If PolyarchyGR(R%) = 0 Then\r'    PolyarchyGR(R%) = PolyarchyVal / SDEMOCPOLYARCHYFX(R%) - 1\r'End If\r'DEMOCPOLYARCHY(R%) = CSng(SDEMOCPOLYARCHY(R%) * (1 + PolyarchyGR(R%)))\r'If IY > 3 Then\r'    If SDEMOCPOLYARCHYFX(R%) <> 0 Then\r'        PolyarchyGR(R%) = CSng(0.8 * PolyarchyGR(R%) + 0.2 * (PolyarchyVal / SDEMOCPOLYARCHYFX(R%) - 1))\r'    End If\r'End If\r'End If\rDEMOCPOLYARCHY(R%) = DEMOCPOLYARCHY(R%) * democpolyarchym(R%)\r"
  },
  {
    "Variable": "DEMOCPOLYARCHY",
    "UsesVariable": "EDYRSAG15",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "DEMOCPOLYARCHY",
    "UsesVariable": "INFMOR",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "DEMOCPOLYARCHY",
    "UsesVariable": "ENPRI",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "DEMOCPOLYARCHY",
    "UsesVariable": "ENP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "DEMOCPOLYARCHY",
    "UsesVariable": "POP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "DEMOCWAVE",
    "UsesVariable": "democwvmax",
    "Distance": 1,
    "Code": "\r\r'\r'   All but First 1:  Democracy:  Global Contributions\r'   --------------------------------------------------\r\rDemocImpMax = 3\r\rMaxDemocShift = (DemocImpMax + democwvmax) / 2\r\rDEMOCWAVE = AMAX(-MaxDemocShift, Amin(DEMOCWAVE, MaxDemocShift))\r"
  },
  {
    "Variable": "DEMOCWAVE",
    "UsesVariable": "democimpoth",
    "Distance": 0,
    "Code": "\rDemocImpLead = (democimpus - democimpusn) * eldemocimp / AMAX(10, democwvlen)\r\rDEMOCWAVE = SDEMOCWAVE + DemocImpLead + democimpoth + DemocWaveShift\r"
  },
  {
    "Variable": "DEMOCWAVE",
    "UsesVariable": "democimpus",
    "Distance": 1,
    "Code": "\rDemocImpLead = (democimpus - democimpusn) * eldemocimp / AMAX(10, democwvlen)\r"
  },
  {
    "Variable": "DEMOCWAVE",
    "UsesVariable": "democimpusn",
    "Distance": 1,
    "Code": "\rDemocImpLead = (democimpus - democimpusn) * eldemocimp / AMAX(10, democwvlen)\r"
  },
  {
    "Variable": "DEMOCWAVE",
    "UsesVariable": "eldemocimp",
    "Distance": 1,
    "Code": "\rDemocImpLead = (democimpus - democimpusn) * eldemocimp / AMAX(10, democwvlen)\r"
  },
  {
    "Variable": "DEMOCWAVE",
    "UsesVariable": "democwvlen",
    "Distance": 1,
    "Code": "\rDemocImpLead = (democimpus - democimpusn) * eldemocimp / AMAX(10, democwvlen)\r"
  },
  {
    "Variable": "DEMOCWVDIR",
    "UsesVariable": "DEMOCWVCOUNT",
    "Distance": 0,
    "Code": "\rIf DEMOCWVCOUNT >= democwvlen Then\rDEMOCWVCOUNT = 0\rDEMOCWVDIR = DEMOCWVDIR * (-1)\rEnd If\r"
  },
  {
    "Variable": "DEMOCWVDIR",
    "UsesVariable": "democwvlen",
    "Distance": 0,
    "Code": "\rIf DEMOCWVCOUNT >= democwvlen Then\rDEMOCWVCOUNT = 0\rDEMOCWVDIR = DEMOCWVDIR * (-1)\rEnd If\r"
  },
  {
    "Variable": "DIPLOEMBASSY",
    "UsesVariable": "DIPLOEMBASSYMAX",
    "Distance": 0,
    "Code": "\r\r'jrs 2013/01/02\rDIPLOEMBASSY(R) = Amin(DIPLOEMBASSY(R), DIPLOEMBASSYMAX)\r\r'jrs 2023/12/05\rDIPLOEMBASSY(R) = CSng(AMAX(DIPLOEMBASSY(R), 0.0001))\r"
  },
  {
    "Variable": "DIPLOEMBASSY",
    "UsesVariable": "diploembassym",
    "Distance": 0,
    "Code": "\r\r'jrs 2021/01/07\rIf IY > 1 Then\rDIPLOEMBASSY(R) = DIPLOEMBASSY(R) * diploembassym(R)\rEnd If\r"
  },
  {
    "Variable": "DIPLOEMBASSY",
    "UsesVariable": "M",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "DIPLOEMBASSY",
    "UsesVariable": "GDP",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "DIPLOEMBASSY",
    "UsesVariable": "X",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "DIPLOEMBASSY",
    "UsesVariable": "POWERHH",
    "Distance": 6,
    "Code": "COMPLETE STRUCTURE:Next R:2117|\r\r'jrs 2013/02/19 *** begin ***\r'jrs 2012/11/05\r\r'All Years: DIPLOMETRICS FORECAST\r'==================================\r\r'dkb 2014/08/01 - the following commented code has been moved above because DIPLOEMBASSYMAX, DIPLOIGOMAX, _\r'DIPLOTREATYMAX are used in WDPI - START\r'    Dim EmbassyEstimate As Single, EmbassyMaxEstimate As Single\r'    Dim IGOEstimate As Single, IGOMaxEstimate As Single\r'    Dim TreatyEstimate As Single, TreatyMaxEstimate As Single\r\rDim EmbassyEstimate As Single\rDim IGOEstimate As Single\rDim TreatyEstimate As Single\r\r'jrs 2016/01/18\rDim INGOProgramEstimate As Single\rDim INGOAdvocacyEstimate As Single\r\r'Estimation\r'jrs 2013/01/21\r'    EmbassyMaxEstimate = 1.1125 * Log(IY - 1 + FirstYear) - 0.8026\r'    IGOMaxEstimate = 0.001 * (IY - 1 + FirstYear) ^ 2 + 0.047 * (IY - 1 + FirstYear) - 0.3923\r'    TreatyMaxEstimate = 0.001 * (IY - 1 + FirstYear) ^ 2 + 0.0073 * (IY - 1 + FirstYear) - 0.5559\r'jrs 2013/02/19\r'    EmbassyMaxEstimate = 0.012 * (IY - 1 + FirstYear) - 20.286\r'    IGOMaxEstimate = 0.045 * (IY - 1 + FirstYear) - 341.91\r'    TreatyMaxEstimate = 0.0505 * (IY - 1 + FirstYear) + 3.1859\r'    EmbassyMaxEstimate = 0.012 * (IY - 1 + FirstYear) - 20.663\r'    IGOMaxEstimate = 0.1019 * (IY - 1 + FirstYear) - 398.46\r'    TreatyMaxEstimate = 0.0505 * (IY - 1 + FirstYear) + 3.1859\r\r'dkb 2013/08/14 Updated forecast equations with those found with JDM\r'dkb 2013/08/29 New forecast equations look worse than earlier - TreatyMax is obviously off. - START\r'    EmbassyMaxEstimate = 1.1125 * Log(IY - 1 + FirstYear) - 0.8026\r'    IGOMaxEstimate = 0.1864 * (IY - 1 + FirstYear) - 367.42\r'    TreatyMaxEstimate = 0.0005 * (IY - 1 + FirstYear) ^ 2 + -1.7645 * (IY - 1 + FirstYear) + 1646.3\r'dkb 2013/08/29 - END\r\r'    If IY = 1 Then\r'        'Find shift factor\r'        DIPLOEMBASSYMAXShift = DIPLOEMBASSYMAX - EmbassyMaxEstimate\r'        DIPLOIGOMAXShift = DIPLOIGOMAX - IGOMaxEstimate\r'        DIPLOTREATYMAXShift = DIPLOTREATYMAX - TreatyMaxEstimate\r'    End If\r'    DIPLOEMBASSYMAX = EmbassyMaxEstimate + DIPLOEMBASSYMAXShift\r'    DIPLOIGOMAX = IGOMaxEstimate + DIPLOIGOMAXShift\r'    DIPLOTREATYMAX = TreatyMaxEstimate + DIPLOTREATYMAXShift\r'    'Apply multipliers\r'    DIPLOEMBASSYMAX = DIPLOEMBASSYMAX * diploembassymaxm\r'    DIPLOIGOMAX = DIPLOIGOMAX * diploigomaxm\r'    DIPLOTREATYMAX = DIPLOTREATYMAX * diplotreatymaxm\r'dkb 2014/08/01 - END\r\r'jrs 2013/01/02 moved down this loop to use the max calculated above\rFor R = 1 To NR\r'Estimation\r'jrs 2013/02/19\r'        EmbassyEstimate = -11.36 + (0.1306 * Log(M(R) / GDP(R) + X(R) / GDP(R))) + (0.479 * Log(POWER(R))) + (0.00636 * (IY - 1 + FirstYear))\r'        IGOEstimate = -96.31 + (0.0191 * DEMOCPOLITY(R)) + (0.1715 * Log(GDPPCP(R))) + (0.04835 * (IY - 1 + FirstYear))\r'        TreatyEstimate = -97.06 - 0.000045 * diplodistancetoeu(R) + 0.038 * DEMOCPOLITY(R) + 0.0488 * (IY - 1 + FirstYear)\r'dkb 2013/09/30 Changed POWER(R) to POWERHH(R) to avoid multicolinearity in EmbassyEstimate - START\r'dkb 2014/07/07 Changed POWERHH(R) to POWERHHMI(R) - START\r'dkb 2014/10/23 Changed POWERHHMI(R) to POWER(R) so that small logged POWERHHMI did not make DIPLOEMBASSY negative - START\r'clp 2016/08/23 - Updated equations per Mickey\r'EmbassyEstimate = -26.2711 + (0.12909 * Log(M(R) / GDP(R) + X(R) / GDP(R))) + (0.468811 * Log(POWER(R))) + (0.0138 * (IY - 1 + FirstYear))\r'IGOEstimate = -96.31 + (0.0191 * DEMOCPOLITY(R)) + (0.1715 * Log(GDPPCP(R))) + (0.04835 * (IY - 1 + FirstYear))\r'TreatyEstimate = -97.06 - 0.000045 * diplodistancetoeu(R) + 0.038 * DEMOCPOLITY(R) + 0.0488 * (IY - 1 + FirstYear)\r\r'mtr 2016/10 update to EmbassyEstimate using the new unstandardized DV for embassies\r'EmbassyEstimate = -0.388141 + (0.0079443 * Log(M(R) / GDP(R) + X(R) / GDP(R))) + (0.0784585 * Log(POWER(R))) + (0.00041 * (IY - 1 + FirstYear))\r'jrs 2021/12/05 added switch\rIf wppowhhsw = 0 Then\rEmbassyEstimate = CSng(-784.1326443 + (3.0130231 * Log(M(R) / GDP(R) + X(R) / GDP(R))) + (14.0734501 * Log(POWER(R))) + (0.4320105 * (IY - 1 + FirstYear)))\rElse\rEmbassyEstimate = CSng(-784.1326443 + (3.0130231 * Log(M(R) / GDP(R) + X(R) / GDP(R))) + (14.0734501 * Log(POWERHH(R))) + (0.4320105 * (IY - 1 + FirstYear)))\rEnd If\r"
  },
  {
    "Variable": "DIPLOEMBASSY",
    "UsesVariable": "wppowhhsw",
    "Distance": 6,
    "Code": "COMPLETE STRUCTURE:Next R:2117|\r\r'jrs 2013/02/19 *** begin ***\r'jrs 2012/11/05\r\r'All Years: DIPLOMETRICS FORECAST\r'==================================\r\r'dkb 2014/08/01 - the following commented code has been moved above because DIPLOEMBASSYMAX, DIPLOIGOMAX, _\r'DIPLOTREATYMAX are used in WDPI - START\r'    Dim EmbassyEstimate As Single, EmbassyMaxEstimate As Single\r'    Dim IGOEstimate As Single, IGOMaxEstimate As Single\r'    Dim TreatyEstimate As Single, TreatyMaxEstimate As Single\r\rDim EmbassyEstimate As Single\rDim IGOEstimate As Single\rDim TreatyEstimate As Single\r\r'jrs 2016/01/18\rDim INGOProgramEstimate As Single\rDim INGOAdvocacyEstimate As Single\r\r'Estimation\r'jrs 2013/01/21\r'    EmbassyMaxEstimate = 1.1125 * Log(IY - 1 + FirstYear) - 0.8026\r'    IGOMaxEstimate = 0.001 * (IY - 1 + FirstYear) ^ 2 + 0.047 * (IY - 1 + FirstYear) - 0.3923\r'    TreatyMaxEstimate = 0.001 * (IY - 1 + FirstYear) ^ 2 + 0.0073 * (IY - 1 + FirstYear) - 0.5559\r'jrs 2013/02/19\r'    EmbassyMaxEstimate = 0.012 * (IY - 1 + FirstYear) - 20.286\r'    IGOMaxEstimate = 0.045 * (IY - 1 + FirstYear) - 341.91\r'    TreatyMaxEstimate = 0.0505 * (IY - 1 + FirstYear) + 3.1859\r'    EmbassyMaxEstimate = 0.012 * (IY - 1 + FirstYear) - 20.663\r'    IGOMaxEstimate = 0.1019 * (IY - 1 + FirstYear) - 398.46\r'    TreatyMaxEstimate = 0.0505 * (IY - 1 + FirstYear) + 3.1859\r\r'dkb 2013/08/14 Updated forecast equations with those found with JDM\r'dkb 2013/08/29 New forecast equations look worse than earlier - TreatyMax is obviously off. - START\r'    EmbassyMaxEstimate = 1.1125 * Log(IY - 1 + FirstYear) - 0.8026\r'    IGOMaxEstimate = 0.1864 * (IY - 1 + FirstYear) - 367.42\r'    TreatyMaxEstimate = 0.0005 * (IY - 1 + FirstYear) ^ 2 + -1.7645 * (IY - 1 + FirstYear) + 1646.3\r'dkb 2013/08/29 - END\r\r'    If IY = 1 Then\r'        'Find shift factor\r'        DIPLOEMBASSYMAXShift = DIPLOEMBASSYMAX - EmbassyMaxEstimate\r'        DIPLOIGOMAXShift = DIPLOIGOMAX - IGOMaxEstimate\r'        DIPLOTREATYMAXShift = DIPLOTREATYMAX - TreatyMaxEstimate\r'    End If\r'    DIPLOEMBASSYMAX = EmbassyMaxEstimate + DIPLOEMBASSYMAXShift\r'    DIPLOIGOMAX = IGOMaxEstimate + DIPLOIGOMAXShift\r'    DIPLOTREATYMAX = TreatyMaxEstimate + DIPLOTREATYMAXShift\r'    'Apply multipliers\r'    DIPLOEMBASSYMAX = DIPLOEMBASSYMAX * diploembassymaxm\r'    DIPLOIGOMAX = DIPLOIGOMAX * diploigomaxm\r'    DIPLOTREATYMAX = DIPLOTREATYMAX * diplotreatymaxm\r'dkb 2014/08/01 - END\r\r'jrs 2013/01/02 moved down this loop to use the max calculated above\rFor R = 1 To NR\r'Estimation\r'jrs 2013/02/19\r'        EmbassyEstimate = -11.36 + (0.1306 * Log(M(R) / GDP(R) + X(R) / GDP(R))) + (0.479 * Log(POWER(R))) + (0.00636 * (IY - 1 + FirstYear))\r'        IGOEstimate = -96.31 + (0.0191 * DEMOCPOLITY(R)) + (0.1715 * Log(GDPPCP(R))) + (0.04835 * (IY - 1 + FirstYear))\r'        TreatyEstimate = -97.06 - 0.000045 * diplodistancetoeu(R) + 0.038 * DEMOCPOLITY(R) + 0.0488 * (IY - 1 + FirstYear)\r'dkb 2013/09/30 Changed POWER(R) to POWERHH(R) to avoid multicolinearity in EmbassyEstimate - START\r'dkb 2014/07/07 Changed POWERHH(R) to POWERHHMI(R) - START\r'dkb 2014/10/23 Changed POWERHHMI(R) to POWER(R) so that small logged POWERHHMI did not make DIPLOEMBASSY negative - START\r'clp 2016/08/23 - Updated equations per Mickey\r'EmbassyEstimate = -26.2711 + (0.12909 * Log(M(R) / GDP(R) + X(R) / GDP(R))) + (0.468811 * Log(POWER(R))) + (0.0138 * (IY - 1 + FirstYear))\r'IGOEstimate = -96.31 + (0.0191 * DEMOCPOLITY(R)) + (0.1715 * Log(GDPPCP(R))) + (0.04835 * (IY - 1 + FirstYear))\r'TreatyEstimate = -97.06 - 0.000045 * diplodistancetoeu(R) + 0.038 * DEMOCPOLITY(R) + 0.0488 * (IY - 1 + FirstYear)\r\r'mtr 2016/10 update to EmbassyEstimate using the new unstandardized DV for embassies\r'EmbassyEstimate = -0.388141 + (0.0079443 * Log(M(R) / GDP(R) + X(R) / GDP(R))) + (0.0784585 * Log(POWER(R))) + (0.00041 * (IY - 1 + FirstYear))\r'jrs 2021/12/05 added switch\rIf wppowhhsw = 0 Then\rEmbassyEstimate = CSng(-784.1326443 + (3.0130231 * Log(M(R) / GDP(R) + X(R) / GDP(R))) + (14.0734501 * Log(POWER(R))) + (0.4320105 * (IY - 1 + FirstYear)))\rElse\rEmbassyEstimate = CSng(-784.1326443 + (3.0130231 * Log(M(R) / GDP(R) + X(R) / GDP(R))) + (14.0734501 * Log(POWERHH(R))) + (0.4320105 * (IY - 1 + FirstYear)))\rEnd If\r"
  },
  {
    "Variable": "DIPLOEMBASSY",
    "UsesVariable": "POWER",
    "Distance": 7,
    "Code": "COMPLETE STRUCTURE:Next R:2117|\r\r'jrs 2013/02/19 *** begin ***\r'jrs 2012/11/05\r\r'All Years: DIPLOMETRICS FORECAST\r'==================================\r\r'dkb 2014/08/01 - the following commented code has been moved above because DIPLOEMBASSYMAX, DIPLOIGOMAX, _\r'DIPLOTREATYMAX are used in WDPI - START\r'    Dim EmbassyEstimate As Single, EmbassyMaxEstimate As Single\r'    Dim IGOEstimate As Single, IGOMaxEstimate As Single\r'    Dim TreatyEstimate As Single, TreatyMaxEstimate As Single\r\rDim EmbassyEstimate As Single\rDim IGOEstimate As Single\rDim TreatyEstimate As Single\r\r'jrs 2016/01/18\rDim INGOProgramEstimate As Single\rDim INGOAdvocacyEstimate As Single\r\r'Estimation\r'jrs 2013/01/21\r'    EmbassyMaxEstimate = 1.1125 * Log(IY - 1 + FirstYear) - 0.8026\r'    IGOMaxEstimate = 0.001 * (IY - 1 + FirstYear) ^ 2 + 0.047 * (IY - 1 + FirstYear) - 0.3923\r'    TreatyMaxEstimate = 0.001 * (IY - 1 + FirstYear) ^ 2 + 0.0073 * (IY - 1 + FirstYear) - 0.5559\r'jrs 2013/02/19\r'    EmbassyMaxEstimate = 0.012 * (IY - 1 + FirstYear) - 20.286\r'    IGOMaxEstimate = 0.045 * (IY - 1 + FirstYear) - 341.91\r'    TreatyMaxEstimate = 0.0505 * (IY - 1 + FirstYear) + 3.1859\r'    EmbassyMaxEstimate = 0.012 * (IY - 1 + FirstYear) - 20.663\r'    IGOMaxEstimate = 0.1019 * (IY - 1 + FirstYear) - 398.46\r'    TreatyMaxEstimate = 0.0505 * (IY - 1 + FirstYear) + 3.1859\r\r'dkb 2013/08/14 Updated forecast equations with those found with JDM\r'dkb 2013/08/29 New forecast equations look worse than earlier - TreatyMax is obviously off. - START\r'    EmbassyMaxEstimate = 1.1125 * Log(IY - 1 + FirstYear) - 0.8026\r'    IGOMaxEstimate = 0.1864 * (IY - 1 + FirstYear) - 367.42\r'    TreatyMaxEstimate = 0.0005 * (IY - 1 + FirstYear) ^ 2 + -1.7645 * (IY - 1 + FirstYear) + 1646.3\r'dkb 2013/08/29 - END\r\r'    If IY = 1 Then\r'        'Find shift factor\r'        DIPLOEMBASSYMAXShift = DIPLOEMBASSYMAX - EmbassyMaxEstimate\r'        DIPLOIGOMAXShift = DIPLOIGOMAX - IGOMaxEstimate\r'        DIPLOTREATYMAXShift = DIPLOTREATYMAX - TreatyMaxEstimate\r'    End If\r'    DIPLOEMBASSYMAX = EmbassyMaxEstimate + DIPLOEMBASSYMAXShift\r'    DIPLOIGOMAX = IGOMaxEstimate + DIPLOIGOMAXShift\r'    DIPLOTREATYMAX = TreatyMaxEstimate + DIPLOTREATYMAXShift\r'    'Apply multipliers\r'    DIPLOEMBASSYMAX = DIPLOEMBASSYMAX * diploembassymaxm\r'    DIPLOIGOMAX = DIPLOIGOMAX * diploigomaxm\r'    DIPLOTREATYMAX = DIPLOTREATYMAX * diplotreatymaxm\r'dkb 2014/08/01 - END\r\r'jrs 2013/01/02 moved down this loop to use the max calculated above\rFor R = 1 To NR\r'Estimation\r'jrs 2013/02/19\r'        EmbassyEstimate = -11.36 + (0.1306 * Log(M(R) / GDP(R) + X(R) / GDP(R))) + (0.479 * Log(POWER(R))) + (0.00636 * (IY - 1 + FirstYear))\r'        IGOEstimate = -96.31 + (0.0191 * DEMOCPOLITY(R)) + (0.1715 * Log(GDPPCP(R))) + (0.04835 * (IY - 1 + FirstYear))\r'        TreatyEstimate = -97.06 - 0.000045 * diplodistancetoeu(R) + 0.038 * DEMOCPOLITY(R) + 0.0488 * (IY - 1 + FirstYear)\r'dkb 2013/09/30 Changed POWER(R) to POWERHH(R) to avoid multicolinearity in EmbassyEstimate - START\r'dkb 2014/07/07 Changed POWERHH(R) to POWERHHMI(R) - START\r'dkb 2014/10/23 Changed POWERHHMI(R) to POWER(R) so that small logged POWERHHMI did not make DIPLOEMBASSY negative - START\r'clp 2016/08/23 - Updated equations per Mickey\r'EmbassyEstimate = -26.2711 + (0.12909 * Log(M(R) / GDP(R) + X(R) / GDP(R))) + (0.468811 * Log(POWER(R))) + (0.0138 * (IY - 1 + FirstYear))\r'IGOEstimate = -96.31 + (0.0191 * DEMOCPOLITY(R)) + (0.1715 * Log(GDPPCP(R))) + (0.04835 * (IY - 1 + FirstYear))\r'TreatyEstimate = -97.06 - 0.000045 * diplodistancetoeu(R) + 0.038 * DEMOCPOLITY(R) + 0.0488 * (IY - 1 + FirstYear)\r\r'mtr 2016/10 update to EmbassyEstimate using the new unstandardized DV for embassies\r'EmbassyEstimate = -0.388141 + (0.0079443 * Log(M(R) / GDP(R) + X(R) / GDP(R))) + (0.0784585 * Log(POWER(R))) + (0.00041 * (IY - 1 + FirstYear))\r'jrs 2021/12/05 added switch\rIf wppowhhsw = 0 Then\rEmbassyEstimate = CSng(-784.1326443 + (3.0130231 * Log(M(R) / GDP(R) + X(R) / GDP(R))) + (14.0734501 * Log(POWER(R))) + (0.4320105 * (IY - 1 + FirstYear)))\rElse\rEmbassyEstimate = CSng(-784.1326443 + (3.0130231 * Log(M(R) / GDP(R) + X(R) / GDP(R))) + (14.0734501 * Log(POWERHH(R))) + (0.4320105 * (IY - 1 + FirstYear)))\rEnd If\r"
  },
  {
    "Variable": "DIPLOEMBASSYMAX",
    "UsesVariable": "diploembassymaxm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "DIPLOIGO",
    "UsesVariable": "DIPLOIGOMAX",
    "Distance": 0,
    "Code": "\r\r'jrs 2013/01/02\rDIPLOIGO(R) = Amin(DIPLOIGO(R), DIPLOIGOMAX)\r"
  },
  {
    "Variable": "DIPLOIGO",
    "UsesVariable": "DEMOCPOLITY",
    "Distance": 9,
    "Code": "\r'mtr 2016/10 updating model of IGOEstimate to include only data from 2000 to capture prevailing trend in membership\r'IGOEstimate = -8472.629416 + (2.84705 * DEMOCPOLITY(R)) + (23.168069 * Log(GDPPCP(R))) + (4.290947 * (IY - 1 + FirstYear))\rIGOEstimate = CSng(-2522.218911 + (4.51878 * DEMOCPOLITY(R)) + (32.892498 * Log(GDPPCP(R))) + (1.273021 * (IY - 1 + FirstYear)))\r\r\r'jrs 2023/03/16\rIf IY > 1 Then\rDIPLOIGO(R) = IGOEstimate + DIPLOIGOShift(R)\rEnd If\r"
  },
  {
    "Variable": "DIPLOIGO",
    "UsesVariable": "GDPPCP",
    "Distance": 9,
    "Code": "\r'mtr 2016/10 updating model of IGOEstimate to include only data from 2000 to capture prevailing trend in membership\r'IGOEstimate = -8472.629416 + (2.84705 * DEMOCPOLITY(R)) + (23.168069 * Log(GDPPCP(R))) + (4.290947 * (IY - 1 + FirstYear))\rIGOEstimate = CSng(-2522.218911 + (4.51878 * DEMOCPOLITY(R)) + (32.892498 * Log(GDPPCP(R))) + (1.273021 * (IY - 1 + FirstYear)))\r"
  },
  {
    "Variable": "DIPLOIGOMAX",
    "UsesVariable": "diploigomaxm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "DIPLOINGOADVOCACY",
    "UsesVariable": "diploingoadvocacym",
    "Distance": 0,
    "Code": "\rDIPLOINGOADVOCACY(R%) = DIPLOINGOADVOCACY(R%) * diploingoadvocacym(R%)\r\rDIPLOINGOADVOCACY(R%) = AMAX(Amin(DIPLOINGOADVOCACY(R%), 200), 0)\r'jrs 2016/01/18 *** end ***\r'mtr 2017/01/17 *** end ***\r'jrs 2013/02/19 *** end ***\r"
  },
  {
    "Variable": "DIPLOINGOADVOCACY",
    "UsesVariable": "diploingoadvocacyconv",
    "Distance": 0,
    "Code": "\r\r'Call AnalFunc(\"INGO Advocacy (2012)\", _\r'   Array(DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), Log(POP(R%)), _\r'  UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOAdvocacyEstimate, _\r' Array(\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\", _\r'\"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\r'    Call AnalFunc(\"INGO Advocacy (2017)\",\r'Array(DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), POP(R%),\r'UKcol(R%), GERcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOAdvocacyEstimate,\r'Array(\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\",\r'\"UKCOL\", \"GERCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\rCall AnalFunc(\"INGO Advocacy (2017)\",\r                        New Single() {DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), POP(R%),\r                                UKcol(R%), GERcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)}, INGOAdvocacyEstimate,\r                        New String() {\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\",\r                                \"UKCOL\", \"GERCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"}, context)\r\r\rDIPLOINGOADVOCACY(R%) = INGOAdvocacyEstimate + ConvergeOverTime(DIPLOINGOADVOCACYShift(R%), 0, diploingoadvocacyconv)\r"
  },
  {
    "Variable": "DIPLOINGOADVOCACY",
    "UsesVariable": "DIPLOEMBASSY",
    "Distance": 1,
    "Code": "\r\r'Call AnalFunc(\"INGO Advocacy (2012)\", _\r'   Array(DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), Log(POP(R%)), _\r'  UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOAdvocacyEstimate, _\r' Array(\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\", _\r'\"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\r'    Call AnalFunc(\"INGO Advocacy (2017)\",\r'Array(DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), POP(R%),\r'UKcol(R%), GERcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOAdvocacyEstimate,\r'Array(\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\",\r'\"UKCOL\", \"GERCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\rCall AnalFunc(\"INGO Advocacy (2017)\",\r                        New Single() {DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), POP(R%),\r                                UKcol(R%), GERcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)}, INGOAdvocacyEstimate,\r                        New String() {\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\",\r                                \"UKCOL\", \"GERCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"}, context)\r"
  },
  {
    "Variable": "DIPLOINGOADVOCACY",
    "UsesVariable": "X",
    "Distance": 1,
    "Code": "\r\r'Call AnalFunc(\"INGO Advocacy (2012)\", _\r'   Array(DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), Log(POP(R%)), _\r'  UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOAdvocacyEstimate, _\r' Array(\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\", _\r'\"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\r'    Call AnalFunc(\"INGO Advocacy (2017)\",\r'Array(DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), POP(R%),\r'UKcol(R%), GERcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOAdvocacyEstimate,\r'Array(\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\",\r'\"UKCOL\", \"GERCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\rCall AnalFunc(\"INGO Advocacy (2017)\",\r                        New Single() {DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), POP(R%),\r                                UKcol(R%), GERcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)}, INGOAdvocacyEstimate,\r                        New String() {\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\",\r                                \"UKCOL\", \"GERCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"}, context)\r"
  },
  {
    "Variable": "DIPLOINGOADVOCACY",
    "UsesVariable": "M",
    "Distance": 1,
    "Code": "\r\r'Call AnalFunc(\"INGO Advocacy (2012)\", _\r'   Array(DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), Log(POP(R%)), _\r'  UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOAdvocacyEstimate, _\r' Array(\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\", _\r'\"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\r'    Call AnalFunc(\"INGO Advocacy (2017)\",\r'Array(DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), POP(R%),\r'UKcol(R%), GERcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOAdvocacyEstimate,\r'Array(\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\",\r'\"UKCOL\", \"GERCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\rCall AnalFunc(\"INGO Advocacy (2017)\",\r                        New Single() {DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), POP(R%),\r                                UKcol(R%), GERcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)}, INGOAdvocacyEstimate,\r                        New String() {\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\",\r                                \"UKCOL\", \"GERCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"}, context)\r"
  },
  {
    "Variable": "DIPLOINGOADVOCACY",
    "UsesVariable": "GDP",
    "Distance": 1,
    "Code": "\r\r'Call AnalFunc(\"INGO Advocacy (2012)\", _\r'   Array(DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), Log(POP(R%)), _\r'  UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOAdvocacyEstimate, _\r' Array(\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\", _\r'\"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\r'    Call AnalFunc(\"INGO Advocacy (2017)\",\r'Array(DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), POP(R%),\r'UKcol(R%), GERcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOAdvocacyEstimate,\r'Array(\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\",\r'\"UKCOL\", \"GERCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\rCall AnalFunc(\"INGO Advocacy (2017)\",\r                        New Single() {DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), POP(R%),\r                                UKcol(R%), GERcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)}, INGOAdvocacyEstimate,\r                        New String() {\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\",\r                                \"UKCOL\", \"GERCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"}, context)\r"
  },
  {
    "Variable": "DIPLOINGOADVOCACY",
    "UsesVariable": "DEMOCPOLITY",
    "Distance": 1,
    "Code": "\r\r'Call AnalFunc(\"INGO Advocacy (2012)\", _\r'   Array(DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), Log(POP(R%)), _\r'  UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOAdvocacyEstimate, _\r' Array(\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\", _\r'\"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\r'    Call AnalFunc(\"INGO Advocacy (2017)\",\r'Array(DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), POP(R%),\r'UKcol(R%), GERcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOAdvocacyEstimate,\r'Array(\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\",\r'\"UKCOL\", \"GERCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\rCall AnalFunc(\"INGO Advocacy (2017)\",\r                        New Single() {DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), POP(R%),\r                                UKcol(R%), GERcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)}, INGOAdvocacyEstimate,\r                        New String() {\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\",\r                                \"UKCOL\", \"GERCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"}, context)\r"
  },
  {
    "Variable": "DIPLOINGOADVOCACY",
    "UsesVariable": "GOVREGQUAL",
    "Distance": 1,
    "Code": "\r\r'Call AnalFunc(\"INGO Advocacy (2012)\", _\r'   Array(DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), Log(POP(R%)), _\r'  UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOAdvocacyEstimate, _\r' Array(\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\", _\r'\"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\r'    Call AnalFunc(\"INGO Advocacy (2017)\",\r'Array(DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), POP(R%),\r'UKcol(R%), GERcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOAdvocacyEstimate,\r'Array(\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\",\r'\"UKCOL\", \"GERCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\rCall AnalFunc(\"INGO Advocacy (2017)\",\r                        New Single() {DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), POP(R%),\r                                UKcol(R%), GERcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)}, INGOAdvocacyEstimate,\r                        New String() {\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\",\r                                \"UKCOL\", \"GERCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"}, context)\r"
  },
  {
    "Variable": "DIPLOINGOADVOCACY",
    "UsesVariable": "POP",
    "Distance": 1,
    "Code": "\r\r'Call AnalFunc(\"INGO Advocacy (2012)\", _\r'   Array(DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), Log(POP(R%)), _\r'  UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOAdvocacyEstimate, _\r' Array(\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\", _\r'\"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\r'    Call AnalFunc(\"INGO Advocacy (2017)\",\r'Array(DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), POP(R%),\r'UKcol(R%), GERcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOAdvocacyEstimate,\r'Array(\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\",\r'\"UKCOL\", \"GERCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\rCall AnalFunc(\"INGO Advocacy (2017)\",\r                        New Single() {DIPLOEMBASSY(R%), (X(R%) + M(R%)) / GDP(R%), DEMOCPOLITY(R%), GOVREGQUAL(R%), POP(R%),\r                                UKcol(R%), GERcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)}, INGOAdvocacyEstimate,\r                        New String() {\"DIPLOEMBASSY\", \"XMPERGDP\", \"DEMOCPOLITY\", \"GOVREGQUAL\", \"LNPOP\",\r                                \"UKCOL\", \"GERCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"}, context)\r"
  },
  {
    "Variable": "DIPLOINGOPROGRAM",
    "UsesVariable": "diploingoprogramm",
    "Distance": 0,
    "Code": "\rDIPLOINGOPROGRAM(R%) = DIPLOINGOPROGRAM(R%) * diploingoprogramm(R%)\r\rDIPLOINGOPROGRAM(R%) = AMAX(Amin(DIPLOINGOPROGRAM(R%), 200), 0)\r"
  },
  {
    "Variable": "DIPLOINGOPROGRAM",
    "UsesVariable": "diploingoprogramconv",
    "Distance": 0,
    "Code": "\rElse\r'Call AnalFunc(\"INGO Programmatic (2012)\", _\r'   Array(INFRAROADPAVEDPCNT(R%), GOVCORRUPT(R%), DIPLOEMBASSY(R%), DEMOCPOLITY(R%), SSFINTLWARMAG(R%), Log(POP(R%)), _\r'  UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOProgramEstimate, _\r' Array(\"PAVEDROADSPCT\", \"GOVCORRUPT\", \"DIPLOEMBASSY\", \"DEMOCPOLITY\", \"SFINTLWARMAG\", \"LNPOP\", _\r'\"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\r'    Call AnalFunc(\"INGO Programmatic (2017)\",\r'Array(INFRAROADPAVEDPCNT(R%), GOVCORRUPT(R%), DIPLOEMBASSY(R%), DEMOCPOLITY(R%), POP(R%),\r'UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOProgramEstimate,\r'Array(\"PAVEDROADSPCT\", \"GOVCORRUPT\", \"DIPLOEMBASSY\", \"DEMOCPOLITY\", \"LNPOP\",\r'\"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\rCall AnalFunc(\"INGO Programmatic (2017)\",\r                        New Single() {INFRAROADPAVEDPCNT(R%), GOVCORRUPT(R%), DIPLOEMBASSY(R%), DEMOCPOLITY(R%), POP(R%),\r                                UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)}, INGOProgramEstimate,\r                        New String() {\"PAVEDROADSPCT\", \"GOVCORRUPT\", \"DIPLOEMBASSY\", \"DEMOCPOLITY\", \"LNPOP\",\r                                \"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"}, context)\r\r\rDIPLOINGOPROGRAM(R%) = INGOProgramEstimate + ConvergeOverTime(DIPLOINGOPROGRAMShift(R%), 0, diploingoprogramconv)\r"
  },
  {
    "Variable": "DIPLOINGOPROGRAM",
    "UsesVariable": "INFRAROADPAVEDPCNT",
    "Distance": 1,
    "Code": "\rElse\r'Call AnalFunc(\"INGO Programmatic (2012)\", _\r'   Array(INFRAROADPAVEDPCNT(R%), GOVCORRUPT(R%), DIPLOEMBASSY(R%), DEMOCPOLITY(R%), SSFINTLWARMAG(R%), Log(POP(R%)), _\r'  UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOProgramEstimate, _\r' Array(\"PAVEDROADSPCT\", \"GOVCORRUPT\", \"DIPLOEMBASSY\", \"DEMOCPOLITY\", \"SFINTLWARMAG\", \"LNPOP\", _\r'\"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\r'    Call AnalFunc(\"INGO Programmatic (2017)\",\r'Array(INFRAROADPAVEDPCNT(R%), GOVCORRUPT(R%), DIPLOEMBASSY(R%), DEMOCPOLITY(R%), POP(R%),\r'UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOProgramEstimate,\r'Array(\"PAVEDROADSPCT\", \"GOVCORRUPT\", \"DIPLOEMBASSY\", \"DEMOCPOLITY\", \"LNPOP\",\r'\"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\rCall AnalFunc(\"INGO Programmatic (2017)\",\r                        New Single() {INFRAROADPAVEDPCNT(R%), GOVCORRUPT(R%), DIPLOEMBASSY(R%), DEMOCPOLITY(R%), POP(R%),\r                                UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)}, INGOProgramEstimate,\r                        New String() {\"PAVEDROADSPCT\", \"GOVCORRUPT\", \"DIPLOEMBASSY\", \"DEMOCPOLITY\", \"LNPOP\",\r                                \"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"}, context)\r"
  },
  {
    "Variable": "DIPLOINGOPROGRAM",
    "UsesVariable": "GOVCORRUPT",
    "Distance": 1,
    "Code": "\rElse\r'Call AnalFunc(\"INGO Programmatic (2012)\", _\r'   Array(INFRAROADPAVEDPCNT(R%), GOVCORRUPT(R%), DIPLOEMBASSY(R%), DEMOCPOLITY(R%), SSFINTLWARMAG(R%), Log(POP(R%)), _\r'  UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOProgramEstimate, _\r' Array(\"PAVEDROADSPCT\", \"GOVCORRUPT\", \"DIPLOEMBASSY\", \"DEMOCPOLITY\", \"SFINTLWARMAG\", \"LNPOP\", _\r'\"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\r'    Call AnalFunc(\"INGO Programmatic (2017)\",\r'Array(INFRAROADPAVEDPCNT(R%), GOVCORRUPT(R%), DIPLOEMBASSY(R%), DEMOCPOLITY(R%), POP(R%),\r'UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOProgramEstimate,\r'Array(\"PAVEDROADSPCT\", \"GOVCORRUPT\", \"DIPLOEMBASSY\", \"DEMOCPOLITY\", \"LNPOP\",\r'\"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\rCall AnalFunc(\"INGO Programmatic (2017)\",\r                        New Single() {INFRAROADPAVEDPCNT(R%), GOVCORRUPT(R%), DIPLOEMBASSY(R%), DEMOCPOLITY(R%), POP(R%),\r                                UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)}, INGOProgramEstimate,\r                        New String() {\"PAVEDROADSPCT\", \"GOVCORRUPT\", \"DIPLOEMBASSY\", \"DEMOCPOLITY\", \"LNPOP\",\r                                \"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"}, context)\r"
  },
  {
    "Variable": "DIPLOINGOPROGRAM",
    "UsesVariable": "DIPLOEMBASSY",
    "Distance": 1,
    "Code": "\rElse\r'Call AnalFunc(\"INGO Programmatic (2012)\", _\r'   Array(INFRAROADPAVEDPCNT(R%), GOVCORRUPT(R%), DIPLOEMBASSY(R%), DEMOCPOLITY(R%), SSFINTLWARMAG(R%), Log(POP(R%)), _\r'  UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOProgramEstimate, _\r' Array(\"PAVEDROADSPCT\", \"GOVCORRUPT\", \"DIPLOEMBASSY\", \"DEMOCPOLITY\", \"SFINTLWARMAG\", \"LNPOP\", _\r'\"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\r'    Call AnalFunc(\"INGO Programmatic (2017)\",\r'Array(INFRAROADPAVEDPCNT(R%), GOVCORRUPT(R%), DIPLOEMBASSY(R%), DEMOCPOLITY(R%), POP(R%),\r'UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOProgramEstimate,\r'Array(\"PAVEDROADSPCT\", \"GOVCORRUPT\", \"DIPLOEMBASSY\", \"DEMOCPOLITY\", \"LNPOP\",\r'\"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\rCall AnalFunc(\"INGO Programmatic (2017)\",\r                        New Single() {INFRAROADPAVEDPCNT(R%), GOVCORRUPT(R%), DIPLOEMBASSY(R%), DEMOCPOLITY(R%), POP(R%),\r                                UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)}, INGOProgramEstimate,\r                        New String() {\"PAVEDROADSPCT\", \"GOVCORRUPT\", \"DIPLOEMBASSY\", \"DEMOCPOLITY\", \"LNPOP\",\r                                \"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"}, context)\r"
  },
  {
    "Variable": "DIPLOINGOPROGRAM",
    "UsesVariable": "DEMOCPOLITY",
    "Distance": 1,
    "Code": "\rElse\r'Call AnalFunc(\"INGO Programmatic (2012)\", _\r'   Array(INFRAROADPAVEDPCNT(R%), GOVCORRUPT(R%), DIPLOEMBASSY(R%), DEMOCPOLITY(R%), SSFINTLWARMAG(R%), Log(POP(R%)), _\r'  UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOProgramEstimate, _\r' Array(\"PAVEDROADSPCT\", \"GOVCORRUPT\", \"DIPLOEMBASSY\", \"DEMOCPOLITY\", \"SFINTLWARMAG\", \"LNPOP\", _\r'\"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\r'    Call AnalFunc(\"INGO Programmatic (2017)\",\r'Array(INFRAROADPAVEDPCNT(R%), GOVCORRUPT(R%), DIPLOEMBASSY(R%), DEMOCPOLITY(R%), POP(R%),\r'UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOProgramEstimate,\r'Array(\"PAVEDROADSPCT\", \"GOVCORRUPT\", \"DIPLOEMBASSY\", \"DEMOCPOLITY\", \"LNPOP\",\r'\"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\rCall AnalFunc(\"INGO Programmatic (2017)\",\r                        New Single() {INFRAROADPAVEDPCNT(R%), GOVCORRUPT(R%), DIPLOEMBASSY(R%), DEMOCPOLITY(R%), POP(R%),\r                                UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)}, INGOProgramEstimate,\r                        New String() {\"PAVEDROADSPCT\", \"GOVCORRUPT\", \"DIPLOEMBASSY\", \"DEMOCPOLITY\", \"LNPOP\",\r                                \"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"}, context)\r"
  },
  {
    "Variable": "DIPLOINGOPROGRAM",
    "UsesVariable": "POP",
    "Distance": 1,
    "Code": "\rElse\r'Call AnalFunc(\"INGO Programmatic (2012)\", _\r'   Array(INFRAROADPAVEDPCNT(R%), GOVCORRUPT(R%), DIPLOEMBASSY(R%), DEMOCPOLITY(R%), SSFINTLWARMAG(R%), Log(POP(R%)), _\r'  UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOProgramEstimate, _\r' Array(\"PAVEDROADSPCT\", \"GOVCORRUPT\", \"DIPLOEMBASSY\", \"DEMOCPOLITY\", \"SFINTLWARMAG\", \"LNPOP\", _\r'\"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\r'    Call AnalFunc(\"INGO Programmatic (2017)\",\r'Array(INFRAROADPAVEDPCNT(R%), GOVCORRUPT(R%), DIPLOEMBASSY(R%), DEMOCPOLITY(R%), POP(R%),\r'UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)), INGOProgramEstimate,\r'Array(\"PAVEDROADSPCT\", \"GOVCORRUPT\", \"DIPLOEMBASSY\", \"DEMOCPOLITY\", \"LNPOP\",\r'\"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"))\r\rCall AnalFunc(\"INGO Programmatic (2017)\",\r                        New Single() {INFRAROADPAVEDPCNT(R%), GOVCORRUPT(R%), DIPLOEMBASSY(R%), DEMOCPOLITY(R%), POP(R%),\r                                UKcol(R%), FRAcol(R%), GERcol(R%), PORcol(R%), SPAcol(R%), NETcol(R%), RUScol(R%)}, INGOProgramEstimate,\r                        New String() {\"PAVEDROADSPCT\", \"GOVCORRUPT\", \"DIPLOEMBASSY\", \"DEMOCPOLITY\", \"LNPOP\",\r                                \"UKCOL\", \"FRACOL\", \"GERCOL\", \"PORCOL\", \"SPACOL\", \"NETCOL\", \"RUSCOL\"}, context)\r"
  },
  {
    "Variable": "DIPLOTREATY",
    "UsesVariable": "DIPLOTREATYMAX",
    "Distance": 0,
    "Code": "\rIf DIPLOTREATYShift(R) > -99999 Then\rDIPLOTREATY(R) = TreatyEstimate + DIPLOTREATYShift(R)\r'jrs 2013/01/02\rDIPLOTREATY(R) = Amin(DIPLOTREATY(R), DIPLOTREATYMAX)\rEnd If\r"
  },
  {
    "Variable": "DIPLOTREATY",
    "UsesVariable": "diplodistancetoeu",
    "Distance": 10,
    "Code": "\r\rTreatyEstimate = CSng(-48033.84 - 0.0208028 * diplodistancetoeu(R) + 22.61359 * DEMOCPOLITY(R) + 24.50642 * (IY - 1 + FirstYear))\r\rIf DIPLOTREATYShift(R) > -99999 Then\rDIPLOTREATY(R) = TreatyEstimate + DIPLOTREATYShift(R)\r'jrs 2013/01/02\rDIPLOTREATY(R) = Amin(DIPLOTREATY(R), DIPLOTREATYMAX)\rEnd If\r"
  },
  {
    "Variable": "DIPLOTREATY",
    "UsesVariable": "DEMOCPOLITY",
    "Distance": 10,
    "Code": "\r\rTreatyEstimate = CSng(-48033.84 - 0.0208028 * diplodistancetoeu(R) + 22.61359 * DEMOCPOLITY(R) + 24.50642 * (IY - 1 + FirstYear))\r"
  },
  {
    "Variable": "DIPLOTREATYMAX",
    "UsesVariable": "diplotreatymaxm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEAMPHETAMINE",
    "UsesVariable": "druguseamphetaminem",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEAMPHETAMINE",
    "UsesVariable": "drugusepolyindex",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEAMPHETAMINE",
    "UsesVariable": "DRUGUSECOCAINE",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEAMPHETAMINE",
    "UsesVariable": "DRUGUSEOPIATES",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEAMPHETAMINE",
    "UsesVariable": "DRUGUSEPRESCRIPTOPIOID",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEAMPHETAMINE",
    "UsesVariable": "drugglobalconv",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEAMPHETAMINE",
    "UsesVariable": "YTHBULGE",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEAMPHETAMINE",
    "UsesVariable": "C",
    "Distance": 24,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEAMPHETAMINE",
    "UsesVariable": "POP",
    "Distance": 24,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEAMPHETAMINE",
    "UsesVariable": "GEM",
    "Distance": 2,
    "Code": "\r\r'--------------------Amphetamines----------------------------\r'kbn 2018/01/20 Call logistic function and apply shift factor below. Apply upper and lower bounds\r'dkb 2018/05/09 - First order forecasts are now just the growth in the forecast equation (recall that the shift factors are really just initial values)\r\r'Call AnalFunc(\"Amphetmanine Drug prevalence versus youth bulge and GEM\", Array(YTHBULGE(R%), GEM(R%)), Zamph, Array(\"Youthbulge\", \"GEM\"))\r\r'--------------------------------------------------\rCall AnalFunc(\"Amphetmanine Drug prevalence versus youth bulge and GEM\",\r                        New Single() {YTHBULGE(R%), GEM(R%)}, Zamph,\r                        New String() {\"Youthbulge\", \"GEM\"}, context)\r"
  },
  {
    "Variable": "DRUGUSECOCAINE",
    "UsesVariable": "drugusecocainem",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSECOCAINE",
    "UsesVariable": "drugusepolyindex",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSECOCAINE",
    "UsesVariable": "DRUGUSEAMPHETAMINE",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSECOCAINE",
    "UsesVariable": "DRUGUSEOPIATES",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSECOCAINE",
    "UsesVariable": "DRUGUSEPRESCRIPTOPIOID",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSECOCAINE",
    "UsesVariable": "drugglobalconv",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSECOCAINE",
    "UsesVariable": "YTHBULGE",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSECOCAINE",
    "UsesVariable": "C",
    "Distance": 25,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSECOCAINE",
    "UsesVariable": "POP",
    "Distance": 25,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSECOCAINE",
    "UsesVariable": "GEM",
    "Distance": 2,
    "Code": "\r\r\r'jrs 2009/06/09 added sedyrsag15 as parameter\rPrivate Sub ComputeDrugs(context As IForecastContext)\r'kbn 2018/05/09- Take Entire Procedure\r'sErrorSub = \"ComputeDrugs\" & CStr(IFUN)\r'   'dkb 2018/05/09\rDim RemainingPotentialHHConPC As Single\rDim Zamph As Single\rDim sdrugtotal As Single\rDim drugtotal As Single\rDim zcoke As Single\rDim Zopiate As Single\rDim Zpresopioid As Single\rDim drugest As Single\rDim Ztotdrug As Single\rDim drugadjust As Single\rDim RemainingPotentialAmph As Single\rDim RemainingPotentialCocaine As Single\rDim RemainingPotentialOpiates As Single\rDim RemainingPotentialOpioids As Single\r\rIf IY% > 1 Then\rFor R% = 1 To NR%\r\rIf C(R%) / POP(R%) >= 30 Then\rhhconpc(R%) = shhconpc(R%)\rElseIf (C(R%) / POP(R%)) > 25 And (C(R%) / POP(R%)) < 30 Then\rRemainingPotentialHHConPC = 30 - (C(R%) / POP(R%))\rhhconpc(R%) = AMAX(0.002, Amin((C(R%) / POP(R%)), hhconpc(R%) + (RemainingPotentialHHConPC / 20)))\rElse\rhhconpc(R%) = C(R%) / POP(R%)\rEnd If\r\r\r'--------------------Cocaine--------------------\r'kbn 2018/01/20 Call logistic function and apply shift factor below. Apply upper and lower bounds\r'          Call AnalFunc(\"Cocaine Drug prevalence versus consumption per person, GEM and GINI\",\r'Array(hhconpc(R%), GEM(R%), GINIDOM(R%)), zcoke, Array(\"C/POP\", \"GEM\", \"GINIDOM\"))            'dkb: Limited HHConPC (asuming theres a limit to how much happiness money can buy)\r\rCall AnalFunc(\"Cocaine Drug prevalence versus consumption per person, GEM and GINI\",\r                        New Single() {hhconpc(R%), GEM(R%), GINIDOM(R%)}, zcoke,\r                        New String() {\"C/POP\", \"GEM\", \"GINIDOM\"}, context)\r\r\rDrugCocaineEst(R%) = CSng(AMAX(Amin((100 * (Exp(zcoke) / (1 + Exp(zcoke)))), 2.5), 0.002))\r\rDRUGUSECOCAINE(R%) = CSng(SDRUGUSECOCAINE(R%) * AMAX(Amin(DrugCocaineEst(R%) / sDrugCocaineEst(R%), 1.05), 0.95))\r"
  },
  {
    "Variable": "DRUGUSECOCAINE",
    "UsesVariable": "GINIDOM",
    "Distance": 2,
    "Code": "\r\r\r'jrs 2009/06/09 added sedyrsag15 as parameter\rPrivate Sub ComputeDrugs(context As IForecastContext)\r'kbn 2018/05/09- Take Entire Procedure\r'sErrorSub = \"ComputeDrugs\" & CStr(IFUN)\r'   'dkb 2018/05/09\rDim RemainingPotentialHHConPC As Single\rDim Zamph As Single\rDim sdrugtotal As Single\rDim drugtotal As Single\rDim zcoke As Single\rDim Zopiate As Single\rDim Zpresopioid As Single\rDim drugest As Single\rDim Ztotdrug As Single\rDim drugadjust As Single\rDim RemainingPotentialAmph As Single\rDim RemainingPotentialCocaine As Single\rDim RemainingPotentialOpiates As Single\rDim RemainingPotentialOpioids As Single\r\rIf IY% > 1 Then\rFor R% = 1 To NR%\r\rIf C(R%) / POP(R%) >= 30 Then\rhhconpc(R%) = shhconpc(R%)\rElseIf (C(R%) / POP(R%)) > 25 And (C(R%) / POP(R%)) < 30 Then\rRemainingPotentialHHConPC = 30 - (C(R%) / POP(R%))\rhhconpc(R%) = AMAX(0.002, Amin((C(R%) / POP(R%)), hhconpc(R%) + (RemainingPotentialHHConPC / 20)))\rElse\rhhconpc(R%) = C(R%) / POP(R%)\rEnd If\r"
  },
  {
    "Variable": "DRUGUSEOPIATES",
    "UsesVariable": "druguseopiatesm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEOPIATES",
    "UsesVariable": "drugusepolyindex",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEOPIATES",
    "UsesVariable": "DRUGUSEAMPHETAMINE",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEOPIATES",
    "UsesVariable": "DRUGUSECOCAINE",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEOPIATES",
    "UsesVariable": "DRUGUSEPRESCRIPTOPIOID",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEOPIATES",
    "UsesVariable": "drugglobalconv",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEOPIATES",
    "UsesVariable": "YTHBULGE",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEOPIATES",
    "UsesVariable": "C",
    "Distance": 26,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEOPIATES",
    "UsesVariable": "POP",
    "Distance": 26,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEOPIATES",
    "UsesVariable": "INCOMELT365LN",
    "Distance": 2,
    "Code": "\r\r'-------------------Opiates---------------------\r'kbn 2018/01/20 Call logistic function and apply shift factor below. Apply upper and lower bounds\r'            Call AnalFunc(\"Opiate Drug prevalence\",\r'Array((100 * SINCOMELT310LN(R%) / POP(R%)), (100 * POPGT65(R%) / POP(R%)), (100 * SPOPURBAN(R%) / POP(R%))), Zopiate, Array(\"Poverty\", \"POP over the age of 65\", \"Urbanpopulation\")) 'dkb: Swaped in POPGT65% for YouthBulge\r\r'jrs 2021/09/02 changed from 3.10 to 3.20/day\r'Call AnalFunc(\"Opiate Drug prevalence\",\r'    New Single() {(100 * SINCOMELT310LN(R%) / POP(R%)), (100 * POPGT65(R%) / POP(R%)), (100 * SPOPURBAN(R%) / POP(R%))}, Zopiate,\r'    New String() {\"Poverty\", \"POP over the age of 65\", \"Urbanpopulation\"}, context)\r'jrs 2022/11/21\rIf ConstantDollarsYear = 2011 Then\rCall AnalFunc(\"Opiate Drug prevalence\",\r                        New Single() {(100 * SINCOMELT320LN(R%) / POP(R%)), (100 * POPGT65(R%) / POP(R%)), (100 * SPOPURBAN(R%) / POP(R%))}, Zopiate,\r                        New String() {\"Poverty\", \"POP over the age of 65\", \"Urbanpopulation\"}, context)\rElse\rCall AnalFunc(\"Opiate Drug prevalence\",\r                        New Single() {(100 * SINCOMELT365LN(R%) / POP(R%)), (100 * POPGT65(R%) / POP(R%)), (100 * SPOPURBAN(R%) / POP(R%))}, Zopiate,\r                        New String() {\"Poverty\", \"POP over the age of 65\", \"Urbanpopulation\"}, context)\rEnd If\r\r\rDrugOpiateEst(R%) = CSng(AMAX(Amin((100 * (Exp(Zopiate) / (1 + Exp(Zopiate)))), 4), 0.002))\r\rDRUGUSEOPIATES(R%) = CSng(SDRUGUSEOPIATES(R%) * AMAX(Amin((DrugOpiateEst(R%) / sDrugOpiateEst(R%)), 1.05), 0.95))\r"
  },
  {
    "Variable": "DRUGUSEOPIATES",
    "UsesVariable": "POPGT65",
    "Distance": 2,
    "Code": "\r\r'-------------------Opiates---------------------\r'kbn 2018/01/20 Call logistic function and apply shift factor below. Apply upper and lower bounds\r'            Call AnalFunc(\"Opiate Drug prevalence\",\r'Array((100 * SINCOMELT310LN(R%) / POP(R%)), (100 * POPGT65(R%) / POP(R%)), (100 * SPOPURBAN(R%) / POP(R%))), Zopiate, Array(\"Poverty\", \"POP over the age of 65\", \"Urbanpopulation\")) 'dkb: Swaped in POPGT65% for YouthBulge\r\r'jrs 2021/09/02 changed from 3.10 to 3.20/day\r'Call AnalFunc(\"Opiate Drug prevalence\",\r'    New Single() {(100 * SINCOMELT310LN(R%) / POP(R%)), (100 * POPGT65(R%) / POP(R%)), (100 * SPOPURBAN(R%) / POP(R%))}, Zopiate,\r'    New String() {\"Poverty\", \"POP over the age of 65\", \"Urbanpopulation\"}, context)\r'jrs 2022/11/21\rIf ConstantDollarsYear = 2011 Then\rCall AnalFunc(\"Opiate Drug prevalence\",\r                        New Single() {(100 * SINCOMELT320LN(R%) / POP(R%)), (100 * POPGT65(R%) / POP(R%)), (100 * SPOPURBAN(R%) / POP(R%))}, Zopiate,\r                        New String() {\"Poverty\", \"POP over the age of 65\", \"Urbanpopulation\"}, context)\rElse\rCall AnalFunc(\"Opiate Drug prevalence\",\r                        New Single() {(100 * SINCOMELT365LN(R%) / POP(R%)), (100 * POPGT65(R%) / POP(R%)), (100 * SPOPURBAN(R%) / POP(R%))}, Zopiate,\r                        New String() {\"Poverty\", \"POP over the age of 65\", \"Urbanpopulation\"}, context)\rEnd If\r"
  },
  {
    "Variable": "DRUGUSEOPIATES",
    "UsesVariable": "POPURBAN",
    "Distance": 2,
    "Code": "\r\r'-------------------Opiates---------------------\r'kbn 2018/01/20 Call logistic function and apply shift factor below. Apply upper and lower bounds\r'            Call AnalFunc(\"Opiate Drug prevalence\",\r'Array((100 * SINCOMELT310LN(R%) / POP(R%)), (100 * POPGT65(R%) / POP(R%)), (100 * SPOPURBAN(R%) / POP(R%))), Zopiate, Array(\"Poverty\", \"POP over the age of 65\", \"Urbanpopulation\")) 'dkb: Swaped in POPGT65% for YouthBulge\r\r'jrs 2021/09/02 changed from 3.10 to 3.20/day\r'Call AnalFunc(\"Opiate Drug prevalence\",\r'    New Single() {(100 * SINCOMELT310LN(R%) / POP(R%)), (100 * POPGT65(R%) / POP(R%)), (100 * SPOPURBAN(R%) / POP(R%))}, Zopiate,\r'    New String() {\"Poverty\", \"POP over the age of 65\", \"Urbanpopulation\"}, context)\r'jrs 2022/11/21\rIf ConstantDollarsYear = 2011 Then\rCall AnalFunc(\"Opiate Drug prevalence\",\r                        New Single() {(100 * SINCOMELT320LN(R%) / POP(R%)), (100 * POPGT65(R%) / POP(R%)), (100 * SPOPURBAN(R%) / POP(R%))}, Zopiate,\r                        New String() {\"Poverty\", \"POP over the age of 65\", \"Urbanpopulation\"}, context)\rElse\rCall AnalFunc(\"Opiate Drug prevalence\",\r                        New Single() {(100 * SINCOMELT365LN(R%) / POP(R%)), (100 * POPGT65(R%) / POP(R%)), (100 * SPOPURBAN(R%) / POP(R%))}, Zopiate,\r                        New String() {\"Poverty\", \"POP over the age of 65\", \"Urbanpopulation\"}, context)\rEnd If\r"
  },
  {
    "Variable": "DRUGUSEPRESCRIPTOPIOID",
    "UsesVariable": "druguseprescriptopioidm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEPRESCRIPTOPIOID",
    "UsesVariable": "drugusepolyindex",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEPRESCRIPTOPIOID",
    "UsesVariable": "DRUGUSEAMPHETAMINE",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEPRESCRIPTOPIOID",
    "UsesVariable": "DRUGUSECOCAINE",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEPRESCRIPTOPIOID",
    "UsesVariable": "DRUGUSEOPIATES",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEPRESCRIPTOPIOID",
    "UsesVariable": "drugglobalconv",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEPRESCRIPTOPIOID",
    "UsesVariable": "YTHBULGE",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEPRESCRIPTOPIOID",
    "UsesVariable": "C",
    "Distance": 27,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEPRESCRIPTOPIOID",
    "UsesVariable": "POP",
    "Distance": 27,
    "Code": "0"
  },
  {
    "Variable": "DRUGUSEPRESCRIPTOPIOID",
    "UsesVariable": "GDS",
    "Distance": 2,
    "Code": "\r\r''------------------PrecriptionOpioids---------------------------\r'kbn 2018/01/20 Call logistic function and apply shift factor below. Apply upper and lower bounds\r'jrs 2019/08/02 added max of 100% for Health Expenditures\r'Call AnalFunc(\"Prescription Drug Use prevalence versus health expenditure\", _\r'Array((100 * (GDS(R%, Health) + HLEXPENDPRIV(R%)) / GDP(R%))), Zpresopioid, Array(\"Healthexpenditure\")) 'prescription opioids\r'            Call AnalFunc(\"Prescription Drug Use prevalence versus health expenditure\",\r'Array((100 * Amin((GDS(R%, Health) + HLEXPENDPRIV(R%)) / GDP(R%), 1))), Zpresopioid, Array(\"Healthexpenditure\")) 'prescription opioids\r\rCall AnalFunc(\"Prescription Drug Use prevalence versus health expenditure\",\r                        New Single() {(100 * Amin((GDS(R%, Health) + HLEXPENDPRIV(R%)) / GDP(R%), 1))}, Zpresopioid,\r                        New String() {\"Healthexpenditure\"}, context)\r\r\rDrugPrescriptionOpioidEst(R%) = CSng(AMAX(Amin((100 * (Exp(Zpresopioid) / (1 + Exp(Zpresopioid)))), 5.5), 0.002))\r\rDRUGUSEPRESCRIPTOPIOID(R%) = CSng(SDRUGUSEPRESCRIPTOPIOID(R%) * AMAX(Amin(DrugPrescriptionOpioidEst(R%) / sDrugPrescriptionOpioidEst(R%), 1.05), 0.95))\r"
  },
  {
    "Variable": "DRUGUSEPRESCRIPTOPIOID",
    "UsesVariable": "HLEXPENDPRIV",
    "Distance": 2,
    "Code": "\r\r''------------------PrecriptionOpioids---------------------------\r'kbn 2018/01/20 Call logistic function and apply shift factor below. Apply upper and lower bounds\r'jrs 2019/08/02 added max of 100% for Health Expenditures\r'Call AnalFunc(\"Prescription Drug Use prevalence versus health expenditure\", _\r'Array((100 * (GDS(R%, Health) + HLEXPENDPRIV(R%)) / GDP(R%))), Zpresopioid, Array(\"Healthexpenditure\")) 'prescription opioids\r'            Call AnalFunc(\"Prescription Drug Use prevalence versus health expenditure\",\r'Array((100 * Amin((GDS(R%, Health) + HLEXPENDPRIV(R%)) / GDP(R%), 1))), Zpresopioid, Array(\"Healthexpenditure\")) 'prescription opioids\r\rCall AnalFunc(\"Prescription Drug Use prevalence versus health expenditure\",\r                        New Single() {(100 * Amin((GDS(R%, Health) + HLEXPENDPRIV(R%)) / GDP(R%), 1))}, Zpresopioid,\r                        New String() {\"Healthexpenditure\"}, context)\r"
  },
  {
    "Variable": "DRUGUSEPRESCRIPTOPIOID",
    "UsesVariable": "GDP",
    "Distance": 2,
    "Code": "\r\r''------------------PrecriptionOpioids---------------------------\r'kbn 2018/01/20 Call logistic function and apply shift factor below. Apply upper and lower bounds\r'jrs 2019/08/02 added max of 100% for Health Expenditures\r'Call AnalFunc(\"Prescription Drug Use prevalence versus health expenditure\", _\r'Array((100 * (GDS(R%, Health) + HLEXPENDPRIV(R%)) / GDP(R%))), Zpresopioid, Array(\"Healthexpenditure\")) 'prescription opioids\r'            Call AnalFunc(\"Prescription Drug Use prevalence versus health expenditure\",\r'Array((100 * Amin((GDS(R%, Health) + HLEXPENDPRIV(R%)) / GDP(R%), 1))), Zpresopioid, Array(\"Healthexpenditure\")) 'prescription opioids\r\rCall AnalFunc(\"Prescription Drug Use prevalence versus health expenditure\",\r                        New Single() {(100 * Amin((GDS(R%, Health) + HLEXPENDPRIV(R%)) / GDP(R%), 1))}, Zpresopioid,\r                        New String() {\"Healthexpenditure\"}, context)\r"
  },
  {
    "Variable": "ECGRCAPUTGDP",
    "UsesVariable": "VADD",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "ECGRCLIMGDP",
    "UsesVariable": "climeconimpsw",
    "Distance": 0,
    "Code": "\r'bbh 2019/03/15 start\rClimImp = CSng(Amin(0.5, (SClimEconImp(R%) - ClimEconImpI(R%)) / 100)) 'bbh 2020/02/24 2 lines\r\r\rFor S% = 1 To NSec%\r\r'  All but First 2: Update CDALF and Sectoral Alphas\r'  -------------------------------------------------\r\ralphas(R%, S%) = CDALF(R%) * salphas(R%, S%)\ralphas(R%, S%) = AMAX(0, Amin(alphas(R%, S%), 1))\r\r'  All but First 2: Determine Potential Value Added\r'  ------------------------------------------------\rIf ((S% > Ener) OrElse (S% = Agri AndAlso agon < 0.9) OrElse (S% = Ener AndAlso enon < 0.9)) Then\rvadd_k = CSng(KS(R%, S%) ^ alphas(R%, S%))\rvadd_l = CSng(LABS(R%, S%) ^ (1.0! - alphas(R%, S%)))\r'If IY >= 2 And GRPS(1, R) = \"United States of America\" And S = 5 Then Stop\rVADD(R%, S%) = cda(R%, S%) * tef(R%, S%) * vadd_k * vadd_l\rIf climeconimpsw > 0.5 Then 'bbh 2017/10/04\r'bbh 2020/02/24 start\r'   2 forces can work to offset the impact of climate change on VADD:\r'    1. tef rises becuase some of the changes, like education advance, occur even\r'        without rise in GDPPCP; the residuals pass through to productivity rise relative\r'        to scenarios without climate change turned on\r'    2. When VADD is held back, it was slowing down rise in GDPPOT, SGDPPOTPCDALF and egdppcp (above)\r'        That was causing CDALPH to rise relative to the base case\r'        (capital share is higher in less developed countries); fixed in code for SGDPPOTPCDALF\r'    But Nordhaus parameterization of impact was net of all other effects including education etc/TEF\r'    Since that effect was cutting the impact of climate change on Value added by about 1/2,\r'    I doubled it here\r'VADD(R%, S%) = VADD(R%, S%) * (1 - ClimImp * 2)\rVADD(R%, S%) = VADD(R%, S%) * (1 - ClimImp)  'bbh 2022/06/23 Removed the factor of 2 shown in RCP analysis to be overshooting impact\r'Changed the sign so that the growth rate impact shows as negative with\r'    ClimImp being postive with impact; also changed so that shows\r'    full impact magnitude climb from year 1; was just difference\r'ECGRCLIMGDP(R%, S%) = -ClimImp * 2 * 100\rECGRCLIMGDP(R%, S%) = -ClimImp * 100 'bbh 2022/06/23 Removed the factor of 2 shown in RCP analysis to be overshooting impact\rEnd If\rVADD(R%, S%) = AMAX(0.0001, Amin(VADD(R%, S%), 100000))\rElseIf S% = Agri And envylchgm(R%) < 0.01 And climeconimpsw > 0.5 Then\r'bbh 2022/06/23 Added elseIF branch to possibly add general economy impact if direct climate impact on yield is simultaneously shut down\rZS(R%, S%) = ZS(R%, S%) * (1 - ClimImp)\rEnd If\r'If RegName$(R%) = \"Ukraine\" And S% = 2 Then Stop\rNext S%\r"
  },
  {
    "Variable": "ECGRCLIMGDP",
    "UsesVariable": "CLIMECONIMP",
    "Distance": 8,
    "Code": "\r'bbh 2019/03/15 start\rClimImp = CSng(Amin(0.5, (SClimEconImp(R%) - ClimEconImpI(R%)) / 100)) 'bbh 2020/02/24 2 lines\r"
  },
  {
    "Variable": "ECGRCLIMTEF",
    "UsesVariable": "CLIMECONIMP",
    "Distance": 2,
    "Code": "\r'mti 2014/11/27 - end\r\r'   All but First 1:  TEF Adjustment Factor from Climate Change\r'   --------------------------------------------------------------------------------\r'bbh 2019/03/15 moved climate change here from inside loop only for exogenous growth rates\r\r'climeconimpstk = 10 'bbh 2023/12/06 probably raise limit on parameter in IFsvar and change in files\r\rClimImpTEF = SClimEconImp(R%) / 100 * climeconimpstk 'bbh 2020/02/24 two lines\r\r\r'If IY = 40 And GRPS(1, R) = \"Eritrea\" And S% = 5 Then Stop\r'tef(R%, S%) = tef(R%, S%) * (1 + ClimImpTEF)\r'bbh 2020/02/24 end\r' ECGRCLIMTEF(R%, S%) = (ClimImpTEF - SClimImpTEF(R%, S%)) * 100 'Percentage change on last year's\rECGRCLIMTEF(R%, S%) = -ClimImpTEF * 100  ''bbh 2020/02/24 two lines\r"
  },
  {
    "Variable": "ECGRCLIMTEF",
    "UsesVariable": "climeconimpstk",
    "Distance": 2,
    "Code": "\r'mti 2014/11/27 - end\r\r'   All but First 1:  TEF Adjustment Factor from Climate Change\r'   --------------------------------------------------------------------------------\r'bbh 2019/03/15 moved climate change here from inside loop only for exogenous growth rates\r\r'climeconimpstk = 10 'bbh 2023/12/06 probably raise limit on parameter in IFsvar and change in files\r\rClimImpTEF = SClimEconImp(R%) / 100 * climeconimpstk 'bbh 2020/02/24 two lines\r"
  },
  {
    "Variable": "ECGRINFTEF",
    "UsesVariable": "tefinfadjm",
    "Distance": 3,
    "Code": "\r'bbh 2015/03/28 end\rTefInfAdjustFac = TefInfAdjustFac - 1\r\r'bbh 2021/05/15 end\r\r'mti 2014/11/27 - start\r\r'bbh 2019/03/15 start\r'tefinfadjm(R%) = 0 'bbh 2023/12/06 test\rInfImpTEF = TefInfAdjustFac * tefinfadjm(R%)\r\r'ECGRINFTEF(R%, S%) = (InfImpTEF - SInfImpTEF(R%, S%)) * 100 'Percentage change on last year's\rECGRINFTEF(R%, S%) = InfImpTEF * 100  'Percentage impact on top of stock of imapct last year\r"
  },
  {
    "Variable": "ECGRINFTEF",
    "UsesVariable": "GDPSHADOWSHR",
    "Distance": 32,
    "Code": "0"
  },
  {
    "Variable": "ECGRINFTEF",
    "UsesVariable": "gdpshadowon",
    "Distance": 32,
    "Code": "0"
  },
  {
    "Variable": "ECGRINFTEF",
    "UsesVariable": "GDPPCP",
    "Distance": 35,
    "Code": "0"
  },
  {
    "Variable": "ECGRINFTEF",
    "UsesVariable": "LABINFORMSHR",
    "Distance": 29,
    "Code": "0"
  },
  {
    "Variable": "ECONFREE",
    "UsesVariable": "econfreem",
    "Distance": 0,
    "Code": "\rPrediction = AMAX(0.01, Amin(10, Prediction))\r\reconfreeri(R%) = ECONFREE(R%) / AMAX(0.01, Prediction)\r\rECONFREE(R%) = (AMAX(0.01, Amin(10, econfreeri(R%) * Prediction * econfreem(R%))))\r"
  },
  {
    "Variable": "ECONFREE",
    "UsesVariable": "confforsw",
    "Distance": 202,
    "Code": "0"
  },
  {
    "Variable": "ECONFREE",
    "UsesVariable": "GDPPCP",
    "Distance": 203,
    "Code": "0"
  },
  {
    "Variable": "ECONFREE",
    "UsesVariable": "DEMOCPOLITY",
    "Distance": 203,
    "Code": "0"
  },
  {
    "Variable": "ECONFREE",
    "UsesVariable": "ENX",
    "Distance": 223,
    "Code": "0"
  },
  {
    "Variable": "ECONFREE",
    "UsesVariable": "ENPRI",
    "Distance": 223,
    "Code": "0"
  },
  {
    "Variable": "ECONFREE",
    "UsesVariable": "GDP",
    "Distance": 223,
    "Code": "0"
  },
  {
    "Variable": "ECONINTEG",
    "UsesVariable": "XRPA",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "ECONINTEG",
    "UsesVariable": "MRPA",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "ECONINTEG",
    "UsesVariable": "GDPPOT",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "ECONINTEG",
    "UsesVariable": "XFDISTOCK",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "ECONINTEG",
    "UsesVariable": "XFDISTOUT",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "ECONINTEG",
    "UsesVariable": "WGDP",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "EDBASENRG",
    "UsesVariable": "EDSECLOWRENRG",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDBASENRG",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDBASENRG",
    "UsesVariable": "EDPRIENRG",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDBASENRG",
    "UsesVariable": "PRI",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "EDBASENRG",
    "UsesVariable": "edpristart",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "EDBASENRG",
    "UsesVariable": "edprilen",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "EDBASENRG",
    "UsesVariable": "edseclowrlen",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERPRI",
    "UsesVariable": "GDPPC",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERPRI",
    "UsesVariable": "EDPRITOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERPRI",
    "UsesVariable": "GDSED",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERPRI",
    "UsesVariable": "gdsedm",
    "Distance": 19,
    "Code": "\r\r'mti commented from here - Nov 25, 2008\r\r'            If budgetdiff > 0 Then\r'            'if more surplus, distribute that surplus to all levels\r'\r'               'new (current) year spending percentage -normalized and saved - before intervention\r'               'not used anymore - feb 2008\r'                sGDSEDPri = demandpri / AMAX(0.0000001, demandsum) '* GDS(R%, Educ) / AMAX(0.0000001, GOVCON(R%))\r'\r'                sGDSEDSecLowr = demandseclowr / AMAX(0.0000001, demandsum) '* GDS(R%, Educ) / AMAX(0.0000001, GOVCON(R%))\r'                sGDSEDSecUppr = demandsecuppr / AMAX(0.0000001, demandsum) '* GDS(R%, Educ) / AMAX(0.0000001, GOVCON(R%))\r'\r'                sGDSEDSec = demandsec / AMAX(0.0000001, demandsum) '* GDS(R%, Educ) / AMAX(0.0000001, GOVCON(R%))\r'                sGDSEDTer = demandter / AMAX(0.0000001, demandsum) '* GDS(R%, Educ) / AMAX(0.0000001, GOVCON(R%))\r'    '      If GRPS(1,R%) = \"Bhutan\" Then Stop\r'\r'                supplypri = sGDSEDPri * calctotsupply\r'\r'                supplyseclowr = sGDSEDSecLowr * calctotsupply\r'                supplysecuppr = sGDSEDSecUppr * calctotsupply\r'\r'                supplysec = sGDSEDSec * calctotsupply\r'                supplyter = sGDSEDTer * calctotsupply\r'\r'                priadd = 0\r'\r'                seclowradd = 0\r'                secuppradd = 0\r'                SecAdd = 0\r'\r'                teradd = 0\r'\r'\r'\r'                If supplypri < demandpri Then\r'                     priadd = Amin(budgetdiff, demandpri - supplypri)\r'                     budgetdiff = budgetdiff - priadd\r'                     supplypri = demandpri + priadd\r'                End If\r'\r'                If budgetdiff > 0 Then\r'                    If supplyseclowr < demandseclowr Then\r'                         seclowradd = Amin(budgetdiff, demandseclowr - supplyseclowr)\r'                         budgetdiff = budgetdiff - seclowradd\r'                         supplyseclowr = demandseclowr + seclowradd\r'                    End If\r'                End If\r'\r''                If Budgetdiff > 0 Then\r'\r''                    If supplysec < demandsec Then\r''                         SecAdd = Amin(Budgetdiff, demandsec - supplysec)\r''                         Budgetdiff = Budgetdiff - SecAdd\r''                         supplysec = demandsec + SecAdd\r''                    End If\r''                End If\r'\r'                If budgetdiff > 0 Then\r'\r'                    If supplysecuppr < demandsecuppr Then\r'                         secuppradd = Amin(budgetdiff, demandsecuppr - supplysecuppr)\r'                         budgetdiff = budgetdiff - secuppradd\r'                         supplysecuppr = demandsecuppr + secuppradd\r'                    End If\r'\r'                End If\r'\r'\r'\r'                If budgetdiff > 0 Then\r'                    If supplyter < demandter Then\r'                         teradd = Amin(budgetdiff, demandter - supplyter)\r'                         budgetdiff = budgetdiff - teradd\r'                         supplyter = demandter + teradd\r'                    End If\r'                End If\r'\r'                If budgetdiff > 0 Then 'still surplus\r'                    prigap = 100 - edprinetrate\r'\r'                    seclowrgap = 100 - Amin(100, edseclowrgrossrate)\r'                    secupprgap = 70 - Amin(70, edsecupprgrossrate)\r'\r'                    'secgap = 70 - Amin(70, edsecgrossrate)\r'\r'                    tergap = 40 - Amin(40, edtergrossrate)\r'\r'                    secgap = seclowrgap + secupprgap\r'                    totgap = prigap + secgap + tergap\r'\r'                    If totgap > 0 Then\r'\r'                        'mti May 2008: the following looks wrong\r'                        'it should really be-\r'                        'supplypri = demandpri + priadd + Budgetdiff * prigap / totgap  'need to initialize priadd\r'                        'but it was already like this; so, change it later after testin other changes\r'\r'                        'supplypri = demandpri + Budgetdiff * prigap / totgap\r'                        supplypri = demandpri + priadd + budgetdiff * prigap / totgap\r'\r'                        'supplyseclowr = demandseclowr + Budgetdiff * seclowrgap / totgap\r'                        'supplysecuppr = demandsecuppr + Budgetdiff * secupprgap / totgap\r'\r'                        supplyseclowr = demandseclowr + seclowradd + budgetdiff * seclowrgap / totgap\r'                        supplysecuppr = demandsecuppr + secuppradd + budgetdiff * secupprgap / totgap\r'\r'\r'                        'supplysec = demandsec + Budgetdiff * secgap / totgap\r'\r'                        'supplyter = demandter + Budgetdiff * tergap / totgap\r'                        supplyter = demandter + teradd + budgetdiff * tergap / totgap\r'                    End If\r'\r'                End If\r'\r'                supplysec = supplyseclowr + supplysecuppr\r'\r'            Else\r'mti commented from here - Nov 25, 2008 -end\rDim supplypri = demandpri\r\rcalctotsupply = calctotsupply / spendcostRI\r"
  },
  {
    "Variable": "EDEXPERPRI",
    "UsesVariable": "GDS",
    "Distance": 50,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERPRI",
    "UsesVariable": "EDTERTOT",
    "Distance": 451,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERPRI",
    "UsesVariable": "EDSECLOWRTOT",
    "Distance": 453,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERPRI",
    "UsesVariable": "EDSECUPPRTOT",
    "Distance": 452,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERPRI",
    "UsesVariable": "EDEXPERTER",
    "Distance": 455,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERPRI",
    "UsesVariable": "EDEXPERSECLOWR",
    "Distance": 457,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERPRI",
    "UsesVariable": "EDEXPERSECUPPR",
    "Distance": 456,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERPRI",
    "UsesVariable": "GDPPCP",
    "Distance": 91,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERPRI",
    "UsesVariable": "edexperprim",
    "Distance": 0,
    "Code": "\r\r'Final pre-budget per student cost; this will be used to split GDS (Education) into GDSED by level; and for computing budget impact\rEDEXPERPRI(R%) = EDEXPERPRI(R%) * psCostPerDeltaPri * edexperprim(R%) '* edqtqltrm(R%, Primary)\r"
  },
  {
    "Variable": "EDEXPERPRI",
    "UsesVariable": "EDPRIPTR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERPRI",
    "UsesVariable": "edpricostadjrural",
    "Distance": 0,
    "Code": "\rDim RuralFrac = 1 - UrbanFrac\r\r\r'per student cost adjustment urban versus rural; turned off now\r'jrs 2009/09/30 changed to lagged version of POPURBAN\rDim UrbanFrac = SPOPURBAN(R%) / POP(R%)\r\rEDEXPERPRI(R%) = EDEXPERPRI(R%) * UrbanFrac + EDEXPERPRI(R%) * RuralFrac * edpricostadjrural(R%)\r"
  },
  {
    "Variable": "EDEXPERPRI",
    "UsesVariable": "POPURBAN",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERPRI",
    "UsesVariable": "POP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERPRI",
    "UsesVariable": "edexppconv",
    "Distance": 0,
    "Code": "\r'     If GRPS(1,R) = \"Angola\" Then Stop\r' Debug.Print GRPS(1,R%); \",\"; spendcostRI; \",\"; 100 * GDS(R%, Educ) / GDP(R%)\r'mti 2017/07/13 start\rIf context.HistoricMode = True Then\r'mti 2024/05/14 start\r'Call XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (1970)\",\r'GDPPCP(R%), calexpperstudpri(R%), context)\rCall XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (1970)\",\r                Amin(GDPPCP(R%), 30), calexpperstudpri(R%), context) '\r'mti 2024/05/14 end\rElse\r\r\r'Call XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (2000)\", _\r'GDPPCP(R%), calexpperstud)\r\r'mti 2024/05/14 start\r'Call XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (MostRecent)\",\r'GDPPCP(R%), calexpperstudpri(R%), context) 'Amin(GDPPCP(R%), 30)\rCall XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (MostRecent)\",\r                Amin(GDPPCP(R%), 30), calexpperstudpri(R%), context) '\r'mti 2024/05/14 end\r'mti 2017/07/13 End\r\rEnd If\r\r'     If GRPS(1,R) = \"Angola\" Then Stop\r' Debug.Print GRPS(1,R%); \",\"; spendcostRI; \",\"; 100 * GDS(R%, Educ) / GDP(R%)\r'mti 2017/07/13 start\rIf context.HistoricMode = True Then\r'mti 2024/05/14 start\r'Call XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (1970)\",\r'GDPPCP(R%), calexpperstudpri(R%), context)\rCall XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (1970)\",\r                Amin(GDPPCP(R%), 30), calexpperstudpri(R%), context) '\r'mti 2024/05/14 end\rElse\r\r\r'Call XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (2000)\", _\r'GDPPCP(R%), calexpperstud)\r\r'mti 2024/05/14 start\r'Call XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (MostRecent)\",\r'GDPPCP(R%), calexpperstudpri(R%), context) 'Amin(GDPPCP(R%), 30)\rCall XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (MostRecent)\",\r                Amin(GDPPCP(R%), 30), calexpperstudpri(R%), context) '\r'mti 2024/05/14 end\r'mti 2017/07/13 End\r\rEnd If\r\r\rPrivate Sub PerStudentCostCalc(R%, pedexpperPriShift As Single, psEdPriPTR As Single, ByRef piEDEXPERPRI As Single, ByRef piASEDEXPERPRI As Single, psCostPerDeltaPri As Single,\r                pedexpperSecLowrShift As Single, ByRef piEDEXPERSECLOWR As Single, ByRef piASEDEXPERSECLOWR As Single, psCostPerDeltaSecLowr As Single,\r                    pedexpperSecUpprShift As Single, ByRef psedexpperSecUpprShift As Single, ByRef piEDEXPERSECUPPR As Single, ByRef piASEDEXPERSECUPPR As Single, psCostPerDeltaSecUppr As Single, pYrsAhead_USec As Single,\r                        ByRef psedexpperTerShift As Single, pedexpperTerShift As Single, ByRef piEDEXPERTER As Single, ByRef piASEDEXPERTER As Single, sCostPerDeltaTer As Single, pYrsAhead_Ter As Single, context As IForecastContext)\r'mti 2019/12/09 - whole proc\r'mti 2019/11/01 - take entire procedure\r\r\r\r'            'mti 2019/10/19 start\r'            psCostPerDeltaPri = 1\r'            psCostPerDeltaSecLowr = 1\r'            psCostPerDeltaSecUppr = 1\r'            sCostPerDeltaTer = 1\r'            'mti 2019/10/19 End\r\r'All years but First: Primary Per Student Cost\r'-----------------------------------------------\rIf edprigoalexperon(R%) = 1 Then\r'seeking per student cost goal - not being used now; needs to be taken off\rEDEXPERPRI(R%) = edprigoalexper(R%)\rElse\r\rIf context.HistoricMode = True Then\r'mti 2024/05/14 start\r'Call XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (1970)\",\r'    GDPPCP(R%), calexpperstudpri(R%), context)\rCall XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (1970)\",\r                        Amin(GDPPCP(R%), 30), calexpperstudpri(R%), context)\r'mti 2024/05/14 end\rElse\r\r'mti 2017/07/13 start\r'Call XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (2000)\", _\r'GDPPCP(R%), calexpperstudpri(R%))\r'mti 2024/05/14 start\r'Call XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (MostRecent)\",\r'    GDPPCP(R%), calexpperstudpri(R%), context) 'Amin(GDPPCP(R%), 30)\rCall XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (MostRecent)\",\r                        Amin(GDPPCP(R%), 30), calexpperstudpri(R%), context) 'Amin(GDPPCP(R%), 30)\r'mti 2024/05/14 end\r'mti 2017/07/13 End\r\rEnd If\r\r'mti 2024/05/14 start\redexppconv = 40\r'mti 2024/05/14 end\r\r'edexppconv is time for convergence to per student cost function; base case value 50 years; can be changed in scenario\rEDEXPERPRI(R%) = calexpperstudpri(R%) + ConvergeOverTime1(pedexpperPriShift, 0, CInt(edexppconv))\r\rEnd If 'If edprigoalexperon(R%, gndr) = 0 Then\r\r\rPrivate Sub PerStudentCostCalc(R%, pedexpperPriShift As Single, psEdPriPTR As Single, ByRef piEDEXPERPRI As Single, ByRef piASEDEXPERPRI As Single, psCostPerDeltaPri As Single,\r                pedexpperSecLowrShift As Single, ByRef piEDEXPERSECLOWR As Single, ByRef piASEDEXPERSECLOWR As Single, psCostPerDeltaSecLowr As Single,\r                    pedexpperSecUpprShift As Single, ByRef psedexpperSecUpprShift As Single, ByRef piEDEXPERSECUPPR As Single, ByRef piASEDEXPERSECUPPR As Single, psCostPerDeltaSecUppr As Single, pYrsAhead_USec As Single,\r                        ByRef psedexpperTerShift As Single, pedexpperTerShift As Single, ByRef piEDEXPERTER As Single, ByRef piASEDEXPERTER As Single, sCostPerDeltaTer As Single, pYrsAhead_Ter As Single, context As IForecastContext)\r'mti 2019/12/09 - whole proc\r'mti 2019/11/01 - take entire procedure\r\r\r\r'            'mti 2019/10/19 start\r'            psCostPerDeltaPri = 1\r'            psCostPerDeltaSecLowr = 1\r'            psCostPerDeltaSecUppr = 1\r'            sCostPerDeltaTer = 1\r'            'mti 2019/10/19 End\r\r'All years but First: Primary Per Student Cost\r'-----------------------------------------------\rIf edprigoalexperon(R%) = 1 Then\r'seeking per student cost goal - not being used now; needs to be taken off\rEDEXPERPRI(R%) = edprigoalexper(R%)\rElse\r\rIf context.HistoricMode = True Then\r'mti 2024/05/14 start\r'Call XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (1970)\",\r'    GDPPCP(R%), calexpperstudpri(R%), context)\rCall XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (1970)\",\r                        Amin(GDPPCP(R%), 30), calexpperstudpri(R%), context)\r'mti 2024/05/14 end\rElse\r\r'mti 2017/07/13 start\r'Call XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (2000)\", _\r'GDPPCP(R%), calexpperstudpri(R%))\r'mti 2024/05/14 start\r'Call XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (MostRecent)\",\r'    GDPPCP(R%), calexpperstudpri(R%), context) 'Amin(GDPPCP(R%), 30)\rCall XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (MostRecent)\",\r                        Amin(GDPPCP(R%), 30), calexpperstudpri(R%), context) 'Amin(GDPPCP(R%), 30)\r'mti 2024/05/14 end\r'mti 2017/07/13 End\r\rEnd If\r\r'mti 2024/05/14 start\redexppconv = 40\r'mti 2024/05/14 end\r\r'edexppconv is time for convergence to per student cost function; base case value 50 years; can be changed in scenario\rEDEXPERPRI(R%) = calexpperstudpri(R%) + ConvergeOverTime1(pedexpperPriShift, 0, CInt(edexppconv))\r\rEnd If 'If edprigoalexperon(R%, gndr) = 0 Then\r\r\rPrivate Sub PerStudentCostCalc(R%, pedexpperPriShift As Single, psEdPriPTR As Single, ByRef piEDEXPERPRI As Single, ByRef piASEDEXPERPRI As Single, psCostPerDeltaPri As Single,\r                pedexpperSecLowrShift As Single, ByRef piEDEXPERSECLOWR As Single, ByRef piASEDEXPERSECLOWR As Single, psCostPerDeltaSecLowr As Single,\r                    pedexpperSecUpprShift As Single, ByRef psedexpperSecUpprShift As Single, ByRef piEDEXPERSECUPPR As Single, ByRef piASEDEXPERSECUPPR As Single, psCostPerDeltaSecUppr As Single, pYrsAhead_USec As Single,\r                        ByRef psedexpperTerShift As Single, pedexpperTerShift As Single, ByRef piEDEXPERTER As Single, ByRef piASEDEXPERTER As Single, sCostPerDeltaTer As Single, pYrsAhead_Ter As Single, context As IForecastContext)\r'mti 2019/12/09 - whole proc\r'mti 2019/11/01 - take entire procedure\r\r\r\r'            'mti 2019/10/19 start\r'            psCostPerDeltaPri = 1\r'            psCostPerDeltaSecLowr = 1\r'            psCostPerDeltaSecUppr = 1\r'            sCostPerDeltaTer = 1\r'            'mti 2019/10/19 End\r\r'All years but First: Primary Per Student Cost\r'-----------------------------------------------\rIf edprigoalexperon(R%) = 1 Then\r'seeking per student cost goal - not being used now; needs to be taken off\rEDEXPERPRI(R%) = edprigoalexper(R%)\rElse\r\rIf context.HistoricMode = True Then\r'mti 2024/05/14 start\r'Call XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (1970)\",\r'    GDPPCP(R%), calexpperstudpri(R%), context)\rCall XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (1970)\",\r                        Amin(GDPPCP(R%), 30), calexpperstudpri(R%), context)\r'mti 2024/05/14 end\rElse\r\r'mti 2017/07/13 start\r'Call XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (2000)\", _\r'GDPPCP(R%), calexpperstudpri(R%))\r'mti 2024/05/14 start\r'Call XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (MostRecent)\",\r'    GDPPCP(R%), calexpperstudpri(R%), context) 'Amin(GDPPCP(R%), 30)\rCall XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (MostRecent)\",\r                        Amin(GDPPCP(R%), 30), calexpperstudpri(R%), context) 'Amin(GDPPCP(R%), 30)\r'mti 2024/05/14 end\r'mti 2017/07/13 End\r\rEnd If\r\r'mti 2024/05/14 start\redexppconv = 40\r'mti 2024/05/14 end\r\r'edexppconv is time for convergence to per student cost function; base case value 50 years; can be changed in scenario\rEDEXPERPRI(R%) = calexpperstudpri(R%) + ConvergeOverTime1(pedexpperPriShift, 0, CInt(edexppconv))\r\rEnd If 'If edprigoalexperon(R%, gndr) = 0 Then\r"
  },
  {
    "Variable": "EDEXPERPRI",
    "UsesVariable": "edprigoalexper",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:End Sub:10197|\r\rPrivate Sub PerStudentCostCalc(R%, pedexpperPriShift As Single, psEdPriPTR As Single, ByRef piEDEXPERPRI As Single, ByRef piASEDEXPERPRI As Single, psCostPerDeltaPri As Single,\r                pedexpperSecLowrShift As Single, ByRef piEDEXPERSECLOWR As Single, ByRef piASEDEXPERSECLOWR As Single, psCostPerDeltaSecLowr As Single,\r                    pedexpperSecUpprShift As Single, ByRef psedexpperSecUpprShift As Single, ByRef piEDEXPERSECUPPR As Single, ByRef piASEDEXPERSECUPPR As Single, psCostPerDeltaSecUppr As Single, pYrsAhead_USec As Single,\r                        ByRef psedexpperTerShift As Single, pedexpperTerShift As Single, ByRef piEDEXPERTER As Single, ByRef piASEDEXPERTER As Single, sCostPerDeltaTer As Single, pYrsAhead_Ter As Single, context As IForecastContext)\r'mti 2019/12/09 - whole proc\r'mti 2019/11/01 - take entire procedure\r\r\r\r'            'mti 2019/10/19 start\r'            psCostPerDeltaPri = 1\r'            psCostPerDeltaSecLowr = 1\r'            psCostPerDeltaSecUppr = 1\r'            sCostPerDeltaTer = 1\r'            'mti 2019/10/19 End\r\r'All years but First: Primary Per Student Cost\r'-----------------------------------------------\rIf edprigoalexperon(R%) = 1 Then\r'seeking per student cost goal - not being used now; needs to be taken off\rEDEXPERPRI(R%) = edprigoalexper(R%)\rElse\r\rIf context.HistoricMode = True Then\r'mti 2024/05/14 start\r'Call XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (1970)\",\r'    GDPPCP(R%), calexpperstudpri(R%), context)\rCall XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (1970)\",\r                        Amin(GDPPCP(R%), 30), calexpperstudpri(R%), context)\r'mti 2024/05/14 end\rElse\r\r'mti 2017/07/13 start\r'Call XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (2000)\", _\r'GDPPCP(R%), calexpperstudpri(R%))\r'mti 2024/05/14 start\r'Call XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (MostRecent)\",\r'    GDPPCP(R%), calexpperstudpri(R%), context) 'Amin(GDPPCP(R%), 30)\rCall XYTABL(\"GDP/Capita (PPP) Versus Primary Expenditures Per Student as % of GDPPC (MostRecent)\",\r                        Amin(GDPPCP(R%), 30), calexpperstudpri(R%), context) 'Amin(GDPPCP(R%), 30)\r'mti 2024/05/14 end\r'mti 2017/07/13 End\r\rEnd If\r\r'mti 2024/05/14 start\redexppconv = 40\r'mti 2024/05/14 end\r\r'edexppconv is time for convergence to per student cost function; base case value 50 years; can be changed in scenario\rEDEXPERPRI(R%) = calexpperstudpri(R%) + ConvergeOverTime1(pedexpperPriShift, 0, CInt(edexppconv))\r\rEnd If 'If edprigoalexperon(R%, gndr) = 0 Then\r"
  },
  {
    "Variable": "EDEXPERSEC",
    "UsesVariable": "EDSECTOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERSEC",
    "UsesVariable": "GDPPC",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERSEC",
    "UsesVariable": "EDEXPERSECLOWR",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERSEC",
    "UsesVariable": "EDSECLOWRTOT",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERSEC",
    "UsesVariable": "EDEXPERSECUPPR",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERSEC",
    "UsesVariable": "EDSECUPPRTOT",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERSECLOWR",
    "UsesVariable": "GDPPCP",
    "Distance": 80,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERSECLOWR",
    "UsesVariable": "edexperseclowrm",
    "Distance": 0,
    "Code": "\r\rEDEXPERSECLOWR(R%) = EDEXPERSECLOWR(R%) * psCostPerDeltaSecLowr * edexperseclowrm(R%) '* edqtqltrm(R%, SecLowr)\r"
  },
  {
    "Variable": "EDEXPERSECLOWR",
    "UsesVariable": "edexpslconv",
    "Distance": 0,
    "Code": "\r'mti 2018/06/18 End\r'mti 2019/12/09 End\r\r'            'save at this point with the smoothing ; needed to separate out quality quantity tradeoff parameter impacts\r'            piASEDEXPERPRI = EDEXPERPRI(R%)\r'\r'            EDEXPERPRI(R%) = EDEXPERPRI(R%) * edexperprim(R%)\r\r'            EDEXPERPRI(R%) = EDEXPERPRI(R%) * psCostPerDeltaPri * edexperprim(R%)\r'            piEDEXPERPRI = EDEXPERPRI(R%)\r\r'mti 2018/06/18 End\r'mti 2019/11/22 End\r\r\r\r\r'            EDEXPERPRI(R%) = EDEXPERPRI(R%) * edexperprim(R%)\r'            EDEXPERPRI(R%) = EDEXPERPRI(R%) * psCostPerDeltaPri\r'            piEDEXPERPRI = EDEXPERPRI(R%)\r'mti 2018/06/18 End\r\r'Note: psCostPerDeltaPri is the smoothed ratio of the final and the pre-budget costs-per-student; this is needed to check transient from budget impact\r'piEDEXPERPRI stores the pre-budget cost-per-student to be used for computing the ratio;\r'piEDEXPERPRI need to be saved after the previous years ratio and any other multiplier applued\r'mti 2019/10/19 End\r\r\r\r'All years but First: Lower Secondary Per Student Cost\r'---------------------------------------------------------\r'mti 2017/07/13 Start\r'Call XYTABL(\"GDP/Capita (PPP) Versus Secondary Lower Exp Per Student as % of GDPPC (M Recent)\", _\r'GDPPCP(R%), calexpperstudseclowr(R%))\r'mti 2024/05/14 start\r'Call XYTABL(\"GDP/Capita (PPP) Versus Secondary Lower Exp Per Student as % of GDPPC (MostRecent)\",\r'GDPPCP(R%), calexpperstudseclowr(R%), context) 'Amin(GDPPCP(R%), 30)\rCall XYTABL(\"GDP/Capita (PPP) Versus Secondary Lower Exp Per Student as % of GDPPC (MostRecent)\",\r                    Amin(GDPPCP(R%), 30), calexpperstudseclowr(R%), context) 'Amin(GDPPCP(R%), 30)\r\r'mti 2024/05/14 end\r\r'edexpslconv is time for convergence to cost function; base case value 50 years; can be changed in scenario\rEDEXPERSECLOWR(R%) = calexpperstudseclowr(R%) + ConvergeOverTime1(pedexpperSecLowrShift, 0, CInt(edexpslconv))\r"
  },
  {
    "Variable": "EDEXPERSECLOWR",
    "UsesVariable": "GDS",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERSECLOWR",
    "UsesVariable": "GDSED",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERSECLOWR",
    "UsesVariable": "GDPPC",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERSECLOWR",
    "UsesVariable": "EDSECLOWRTOT",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERSECLOWR",
    "UsesVariable": "EDPRITOT",
    "Distance": 54,
    "Code": "\r\r'express per student costs from % of GDP per capita to constant exchange rate dollars\rpriperstdntDollar = EDEXPERPRI(R%) * GDPPC(R%) * 10\r\r\r\r\rexpendter = terperstdntDollar / 1000 * (EDTERTOT(R%, 1) + EDTERTOT(R%, 2))  'EDTERTOT(R%)\r\r\rexpendsec = expendseclowr + expendsecuppr\r\r'expenditure not by gender - Add both genders to get total students\r'in billion dollars -> dollars per student / 1000 * million students\rexpendpri = priperstdntDollar / 1000 * (EDPRITOT(R%, 1) + EDPRITOT(R%, 2))\r\r\r'spending cost ratio initial shift\rspendcostRIShift(R%) = CSng(spendcostRI(R%) - 1.1)\rCOMPLETE STRUCTURE:End Sub:9875|\r\rPrivate Sub BudgetInitialize(R%, ByRef spendcostRI As Single, ByRef edexpperPriShift As Single,\r                                     ByRef edexpperSecLowrShift As Single, ByRef edexpperSecUpprShift As Single,\r                                     ByRef edexpperTerShift As Single, ByRef YrsAheadUSec As Single,\r                                     ByRef YrsAheadTer As Single, context As IForecastContext)\r'--- Education Module ----------------------------------------------------------------------------------------\r'mti 2016/03/30 - take whole proc\rDim convtoexchange1, calctotspend, priperstdntDollar, seclowrperstdntDollar, secupprperstdntDollar As Single\rDim GDPPCP_Ahead As Single\rconvtoexchange1 = 1 'GDPPC(R%) / AMAX(0.001, GDPPCP(R%))\r\r\r\rDim calctotcost As Single\rcalctotcost = expendpri + expendsec + expendter\rCOMPLETE STRUCTURE:End Sub:9875|\r\rPrivate Sub BudgetInitialize(R%, ByRef spendcostRI As Single, ByRef edexpperPriShift As Single,\r                                     ByRef edexpperSecLowrShift As Single, ByRef edexpperSecUpprShift As Single,\r                                     ByRef edexpperTerShift As Single, ByRef YrsAheadUSec As Single,\r                                     ByRef YrsAheadTer As Single, context As IForecastContext)\r'--- Education Module ----------------------------------------------------------------------------------------\r'mti 2016/03/30 - take whole proc\rDim convtoexchange1, calctotspend, priperstdntDollar, seclowrperstdntDollar, secupprperstdntDollar As Single\rDim GDPPCP_Ahead As Single\rconvtoexchange1 = 1 'GDPPC(R%) / AMAX(0.001, GDPPCP(R%))\r"
  },
  {
    "Variable": "EDEXPERSECLOWR",
    "UsesVariable": "EDTERTOT",
    "Distance": 51,
    "Code": "\r\r'secperstdntDollar = EDEXPERSEC(R%) * GDPPC(R%) * 10\rDim terperstdntDollar, expendpri, expendseclowr, expendsecuppr, expendter, expendsec As Single\rterperstdntDollar = EDEXPERTER(R%) * GDPPC(R%) * 10\r\rexpendsecuppr = secupprperstdntDollar / 1000 * (EDSECUPPRTOT(R%, 1) + EDSECUPPRTOT(R%, 2))\r\r\rexpendseclowr = seclowrperstdntDollar / 1000 * (EDSECLOWRTOT(R%, 1) + EDSECLOWRTOT(R%, 2))\r"
  },
  {
    "Variable": "EDEXPERSECLOWR",
    "UsesVariable": "EDEXPERPRI",
    "Distance": 58,
    "Code": "\r\r'secperstdntDollar = EDEXPERSEC(R%) * GDPPC(R%) * 10\rDim terperstdntDollar, expendpri, expendseclowr, expendsecuppr, expendter, expendsec As Single\rterperstdntDollar = EDEXPERTER(R%) * GDPPC(R%) * 10\r"
  },
  {
    "Variable": "EDEXPERSECLOWR",
    "UsesVariable": "EDSECUPPRTOT",
    "Distance": 52,
    "Code": "\rsecupprperstdntDollar = EDEXPERSECUPPR(R%) * GDPPC(R%) * 10\r"
  },
  {
    "Variable": "EDEXPERSECLOWR",
    "UsesVariable": "EDEXPERTER",
    "Distance": 55,
    "Code": "\rsecupprperstdntDollar = EDEXPERSECUPPR(R%) * GDPPC(R%) * 10\r"
  },
  {
    "Variable": "EDEXPERSECLOWR",
    "UsesVariable": "EDEXPERSECUPPR",
    "Distance": 56,
    "Code": "\rsecupprperstdntDollar = EDEXPERSECUPPR(R%) * GDPPC(R%) * 10\r"
  },
  {
    "Variable": "EDEXPERSECUPPR",
    "UsesVariable": "GDPPCP",
    "Distance": 76,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERSECUPPR",
    "UsesVariable": "edexpersecupprm",
    "Distance": 0,
    "Code": "\r\r\rEDEXPERSECUPPR(R%) = EDEXPERSECUPPR(R%) * psCostPerDeltaSecUppr * edexpersecupprm(R%) '* edqtqltrm(R%, SecUppr)\r"
  },
  {
    "Variable": "EDEXPERSECUPPR",
    "UsesVariable": "edexpsuconv",
    "Distance": 0,
    "Code": "\r'mti 2024/05/14 End\r\r\r\r'If GRPS(1, R%) = \"Eritrea\" Then Stop\r'mti 2017/07/13 Start\r'Call XYTABL(\"GDP/Capita (PPP) Versus Secondary Upper Exp Per Student as % of GDPPC (M Recent)\", _\r'GDPPCP_Ahead, calexpperstudsecuppr(R%))\rCall XYTABL(\"GDP/Capita (PPP) Versus Secondary Upper Exp Per Student as % of GDPPC (MostRecent)\",\r                    GDPPCP_Ahead, calexpperstudsecuppr(R%), context) 'Amin(GDPPCP_Ahead, 30)\r\r'mti 2024/05/14 end\r\r'mti 2024/05/14 Start\r''edexpsuconv is time for Convergence to Function; can be changed in scenario\r'If Abs(psedexpperSecUpprShift) < 2 Or IY > edexpsuconv - 5 Then\r'    'mti 2021/08/10 start\r'    EDEXPERSECUPPR(R%) = AMAX(1, calexpperstudsecuppr(R%) + ConvergeOverTimeSmooth(psedexpperSecUpprShift, 0, CInt(edexpsuconv * 0.5)))\r'    'mti 2021/08/10 end\r'Else\r'    psedexpperSecUpprShift = ConvergeOverTime1(pedexpperSecUpprShift, 0, CInt(edexpsuconv))\r'    'mti 2021/08/10 start\r'    EDEXPERSECUPPR(R%) = AMAX(1, calexpperstudsecuppr(R%) + psedexpperSecUpprShift) 'ConvergeOverTime1(edexpperSecUpprShift(R%), 0, edexpsuconv))\r'    'mti 2021/08/10 end\r'End If\r\r\r''mti 2019/11/22 start\r''mti 2019/10/19 Start\r\rEDEXPERSECUPPR(R%) = AMAX(1, calexpperstudsecuppr(R%) + ConvergeOverTime1(pedexpperSecUpprShift, 0, CInt(edexpsuconv)))\r"
  },
  {
    "Variable": "EDEXPERSECUPPR",
    "UsesVariable": "GDS",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERSECUPPR",
    "UsesVariable": "GDSED",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERSECUPPR",
    "UsesVariable": "GDPPC",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERSECUPPR",
    "UsesVariable": "EDSECUPPRTOT",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERSECUPPR",
    "UsesVariable": "EDPRITOT",
    "Distance": 57,
    "Code": "\r\r'express per student costs from % of GDP per capita to constant exchange rate dollars\rpriperstdntDollar = EDEXPERPRI(R%) * GDPPC(R%) * 10\r\r\r\r\rexpendter = terperstdntDollar / 1000 * (EDTERTOT(R%, 1) + EDTERTOT(R%, 2))  'EDTERTOT(R%)\r\r\rexpendsec = expendseclowr + expendsecuppr\r\r'expenditure not by gender - Add both genders to get total students\r'in billion dollars -> dollars per student / 1000 * million students\rexpendpri = priperstdntDollar / 1000 * (EDPRITOT(R%, 1) + EDPRITOT(R%, 2))\rCOMPLETE STRUCTURE:End Sub:9875|\r\rPrivate Sub BudgetInitialize(R%, ByRef spendcostRI As Single, ByRef edexpperPriShift As Single,\r                                     ByRef edexpperSecLowrShift As Single, ByRef edexpperSecUpprShift As Single,\r                                     ByRef edexpperTerShift As Single, ByRef YrsAheadUSec As Single,\r                                     ByRef YrsAheadTer As Single, context As IForecastContext)\r'--- Education Module ----------------------------------------------------------------------------------------\r'mti 2016/03/30 - take whole proc\rDim convtoexchange1, calctotspend, priperstdntDollar, seclowrperstdntDollar, secupprperstdntDollar As Single\rDim GDPPCP_Ahead As Single\rconvtoexchange1 = 1 'GDPPC(R%) / AMAX(0.001, GDPPCP(R%))\r\r\r\rDim calctotcost As Single\rcalctotcost = expendpri + expendsec + expendter\rCOMPLETE STRUCTURE:End Sub:9875|\r\rPrivate Sub BudgetInitialize(R%, ByRef spendcostRI As Single, ByRef edexpperPriShift As Single,\r                                     ByRef edexpperSecLowrShift As Single, ByRef edexpperSecUpprShift As Single,\r                                     ByRef edexpperTerShift As Single, ByRef YrsAheadUSec As Single,\r                                     ByRef YrsAheadTer As Single, context As IForecastContext)\r'--- Education Module ----------------------------------------------------------------------------------------\r'mti 2016/03/30 - take whole proc\rDim convtoexchange1, calctotspend, priperstdntDollar, seclowrperstdntDollar, secupprperstdntDollar As Single\rDim GDPPCP_Ahead As Single\rconvtoexchange1 = 1 'GDPPC(R%) / AMAX(0.001, GDPPCP(R%))\r"
  },
  {
    "Variable": "EDEXPERSECUPPR",
    "UsesVariable": "EDTERTOT",
    "Distance": 54,
    "Code": "\r\r'secperstdntDollar = EDEXPERSEC(R%) * GDPPC(R%) * 10\rDim terperstdntDollar, expendpri, expendseclowr, expendsecuppr, expendter, expendsec As Single\rterperstdntDollar = EDEXPERTER(R%) * GDPPC(R%) * 10\r\rexpendsecuppr = secupprperstdntDollar / 1000 * (EDSECUPPRTOT(R%, 1) + EDSECUPPRTOT(R%, 2))\r\r\rexpendseclowr = seclowrperstdntDollar / 1000 * (EDSECLOWRTOT(R%, 1) + EDSECLOWRTOT(R%, 2))\r"
  },
  {
    "Variable": "EDEXPERSECUPPR",
    "UsesVariable": "EDEXPERPRI",
    "Distance": 61,
    "Code": "\r\r'secperstdntDollar = EDEXPERSEC(R%) * GDPPC(R%) * 10\rDim terperstdntDollar, expendpri, expendseclowr, expendsecuppr, expendter, expendsec As Single\rterperstdntDollar = EDEXPERTER(R%) * GDPPC(R%) * 10\r"
  },
  {
    "Variable": "EDEXPERSECUPPR",
    "UsesVariable": "EDSECLOWRTOT",
    "Distance": 56,
    "Code": "\r\rseclowrperstdntDollar = EDEXPERSECLOWR(R%) * GDPPC(R%) * 10\r"
  },
  {
    "Variable": "EDEXPERSECUPPR",
    "UsesVariable": "EDEXPERTER",
    "Distance": 58,
    "Code": "\rsecupprperstdntDollar = EDEXPERSECUPPR(R%) * GDPPC(R%) * 10\r"
  },
  {
    "Variable": "EDEXPERSECUPPR",
    "UsesVariable": "EDEXPERSECLOWR",
    "Distance": 60,
    "Code": "\rsecupprperstdntDollar = EDEXPERSECUPPR(R%) * GDPPC(R%) * 10\r"
  },
  {
    "Variable": "EDEXPERTER",
    "UsesVariable": "GDPPCP",
    "Distance": 71,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERTER",
    "UsesVariable": "edexperterm",
    "Distance": 0,
    "Code": "\rEDEXPERTER(R%) = EDEXPERTER(R%) * sCostPerDeltaTer * edexperterm(R%) '* edqtqltrm(R%, Tertiary)\r\r'            'save at this point with the smoothing ; needed to separate out quality quantity tradeoff parameter impacts\r'            piASEDEXPERTER = EDEXPERTER(R%)\r'\r'\r'            'mti 2018/06/18 Start\r'            EDEXPERTER(R%) = EDEXPERTER(R%) * edexperterm(R%)\r'            'mti 2018/06/18 End\r\r'            EDEXPERTER(R%) = EDEXPERTER(R%) * sCostPerDeltaTer * edexperterm(R%)\r'            piEDEXPERTER = EDEXPERTER(R%)\r\r'See notes on sCostPerDeltaTer and piEDEXPERTER in the primary-per-student-cost section above\r'mti 2019/10/19 End\r'mti 2019/11/22 End\r\r\r'            EDEXPERTER(R%) = EDEXPERTER(R%) * edexperterm(R%)\r'            EDEXPERTER(R%) = EDEXPERTER(R%) * sCostPerDeltaTer\r'            piEDEXPERTER = EDEXPERTER(R%)\r\r'See notes on sCostPerDeltaTer and piEDEXPERTER in the primary-per-student-cost section above\r'mti 2019/10/19 End\r'mti 2019/12/09 End\r\r"
  },
  {
    "Variable": "EDEXPERTER",
    "UsesVariable": "edexptconv",
    "Distance": 0,
    "Code": "\r'mti 2024/05/14 end\r'Estimate from  cross-sectional function\rIf context.HistoricMode Then\rCall XYTABL(\"GDP/Capita (PPP) Versus Tertiary Expenditures Per Student as % of GDPPC (1970)\",\r                    GDPPCP_Ahead, calexpperstudter(R%), context)\rElse\r'mti 2017/07/13 start\r'Call XYTABL(\"GDP/Capita (PPP) Versus Tertiary Expenditures Per Student as % of GDPPC (2000)\", _\r'GDPPCP_Ahead, calexpperstudter(R%))\rCall XYTABL(\"GDP/Capita (PPP) Versus Tertiary Expenditures Per Student EP as % of GDPPC (MostRecent)\",\r                    GDPPCP_Ahead, calexpperstudter(R%), context)  'Amin(GDPPCP_Ahead, 50)\r'mti 2017/07/13 End\rEnd If\r\r'mti 2024/05/14 end\r\r'mti 2024/05/14 start\r'calexpperstudter(R%) = AMAX(calexpperstudsecuppr(R%) + 2, calexpperstudter(R%)) '30\r'mti 2024/05/14 end\r\r'mti 2024/05/14 start\r'If Abs(psedexpperTerShift) < 2 Or IY > edexptconv - 5 Then\r'    'mti 2021/08/11 added AMAX(5,\r'    EDEXPERTER(R%) = AMAX(5, calexpperstudter(R%) + ConvergeOverTimeSmooth(psedexpperTerShift, 0, CInt(edexptconv * 0.5)))\r'Else\r'    'mti 2021/07/21 added ,false, changed from ConvergeOverTime1 to ConvergeOverTimeSmooth\r'    psedexpperTerShift = ConvergeOverTimeSmooth(pedexpperTerShift, 0, CInt(edexptconv), False)\r'    'mti 2021/08/11 added AMAX(5,\r'    EDEXPERTER(R%) = AMAX(5, calexpperstudter(R%) + psedexpperTerShift) 'ConvergeOverTime1(edexpperTerShift(R%), 0, edexptconv)\r'End If\r\rEDEXPERTER(R%) = AMAX(5, calexpperstudter(R%) + ConvergeOverTime1(pedexpperTerShift, 0, CInt(edexptconv)))\r"
  },
  {
    "Variable": "EDEXPERTER",
    "UsesVariable": "GDS",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERTER",
    "UsesVariable": "GDSED",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERTER",
    "UsesVariable": "GDPPC",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERTER",
    "UsesVariable": "EDTERTOT",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDEXPERTER",
    "UsesVariable": "EDPRITOT",
    "Distance": 60,
    "Code": "\r\r'express per student costs from % of GDP per capita to constant exchange rate dollars\rpriperstdntDollar = EDEXPERPRI(R%) * GDPPC(R%) * 10\r\r\r\r\rexpendter = terperstdntDollar / 1000 * (EDTERTOT(R%, 1) + EDTERTOT(R%, 2))  'EDTERTOT(R%)\r\r\rexpendsec = expendseclowr + expendsecuppr\r\r'expenditure not by gender - Add both genders to get total students\r'in billion dollars -> dollars per student / 1000 * million students\rexpendpri = priperstdntDollar / 1000 * (EDPRITOT(R%, 1) + EDPRITOT(R%, 2))\rCOMPLETE STRUCTURE:End Sub:9875|\r\rPrivate Sub BudgetInitialize(R%, ByRef spendcostRI As Single, ByRef edexpperPriShift As Single,\r                                     ByRef edexpperSecLowrShift As Single, ByRef edexpperSecUpprShift As Single,\r                                     ByRef edexpperTerShift As Single, ByRef YrsAheadUSec As Single,\r                                     ByRef YrsAheadTer As Single, context As IForecastContext)\r'--- Education Module ----------------------------------------------------------------------------------------\r'mti 2016/03/30 - take whole proc\rDim convtoexchange1, calctotspend, priperstdntDollar, seclowrperstdntDollar, secupprperstdntDollar As Single\rDim GDPPCP_Ahead As Single\rconvtoexchange1 = 1 'GDPPC(R%) / AMAX(0.001, GDPPCP(R%))\r\r\r\rDim calctotcost As Single\rcalctotcost = expendpri + expendsec + expendter\rCOMPLETE STRUCTURE:End Sub:9875|\r\rPrivate Sub BudgetInitialize(R%, ByRef spendcostRI As Single, ByRef edexpperPriShift As Single,\r                                     ByRef edexpperSecLowrShift As Single, ByRef edexpperSecUpprShift As Single,\r                                     ByRef edexpperTerShift As Single, ByRef YrsAheadUSec As Single,\r                                     ByRef YrsAheadTer As Single, context As IForecastContext)\r'--- Education Module ----------------------------------------------------------------------------------------\r'mti 2016/03/30 - take whole proc\rDim convtoexchange1, calctotspend, priperstdntDollar, seclowrperstdntDollar, secupprperstdntDollar As Single\rDim GDPPCP_Ahead As Single\rconvtoexchange1 = 1 'GDPPC(R%) / AMAX(0.001, GDPPCP(R%))\r"
  },
  {
    "Variable": "EDEXPERTER",
    "UsesVariable": "EDEXPERPRI",
    "Distance": 64,
    "Code": "\r\r'secperstdntDollar = EDEXPERSEC(R%) * GDPPC(R%) * 10\rDim terperstdntDollar, expendpri, expendseclowr, expendsecuppr, expendter, expendsec As Single\rterperstdntDollar = EDEXPERTER(R%) * GDPPC(R%) * 10\r"
  },
  {
    "Variable": "EDEXPERTER",
    "UsesVariable": "EDSECLOWRTOT",
    "Distance": 59,
    "Code": "\r\rseclowrperstdntDollar = EDEXPERSECLOWR(R%) * GDPPC(R%) * 10\r"
  },
  {
    "Variable": "EDEXPERTER",
    "UsesVariable": "EDSECUPPRTOT",
    "Distance": 58,
    "Code": "\rsecupprperstdntDollar = EDEXPERSECUPPR(R%) * GDPPC(R%) * 10\r"
  },
  {
    "Variable": "EDEXPERTER",
    "UsesVariable": "EDEXPERSECLOWR",
    "Distance": 63,
    "Code": "\rsecupprperstdntDollar = EDEXPERSECUPPR(R%) * GDPPC(R%) * 10\r"
  },
  {
    "Variable": "EDEXPERTER",
    "UsesVariable": "EDEXPERSECUPPR",
    "Distance": 62,
    "Code": "\rsecupprperstdntDollar = EDEXPERSECUPPR(R%) * GDPPC(R%) * 10\r"
  },
  {
    "Variable": "EDPRICR",
    "UsesVariable": "edprilen",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDPRICR",
    "UsesVariable": "EDPRIINT",
    "Distance": 3,
    "Code": "\r\r\rFor GCount% = 1 To CInt(edprilen(R%))\rdrpoutgr(GCount%) = EdPriDropoutByGrade(GCount%, R%, gndr%)\r"
  },
  {
    "Variable": "EDPRICR",
    "UsesVariable": "edpridrpgrdm",
    "Distance": 1810,
    "Code": "0"
  },
  {
    "Variable": "EDPRICR",
    "UsesVariable": "edprienrgrdm",
    "Distance": 1801,
    "Code": "0"
  },
  {
    "Variable": "EDPRICR",
    "UsesVariable": "EDPRIDRPGRD",
    "Distance": 1921,
    "Code": "0"
  },
  {
    "Variable": "EDPRICR",
    "UsesVariable": "edprienrm",
    "Distance": 1804,
    "Code": "0"
  },
  {
    "Variable": "EDPRICR",
    "UsesVariable": "EDPRISUR",
    "Distance": 1814,
    "Code": "0"
  },
  {
    "Variable": "EDPRICR",
    "UsesVariable": "EDSECLOWRENRGGRD",
    "Distance": 2240,
    "Code": "0"
  },
  {
    "Variable": "EDPRICR",
    "UsesVariable": "EDPRIENRGGRD",
    "Distance": 1912,
    "Code": "0"
  },
  {
    "Variable": "EDPRICR",
    "UsesVariable": "EDSECLOWRDRPGRD",
    "Distance": 2219,
    "Code": "0"
  },
  {
    "Variable": "EDPRICR",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRICR",
    "UsesVariable": "edpristart",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRIDRPGRD",
    "UsesVariable": "edprilen",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRIDRPGRD",
    "UsesVariable": "EDPRIENRGGRD",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "EDPRIDRPGRD",
    "UsesVariable": "POP",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "EDPRIDRPGRD",
    "UsesVariable": "edpristart",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "EDPRIDRPGRD",
    "UsesVariable": "EDPRICR",
    "Distance": 2,
    "Code": "\r'mti 2022/04/12 start\rpristudents(GCount%, R%, gndr%) = pristudents(GCount%, R%, gndr%) * If(edprienrgrdm(R%, NGender) <> 1, edprienrgrdm(R%, NGender), edprienrgrdm(R%, gndr))\r"
  },
  {
    "Variable": "EDPRIDRPGRD",
    "UsesVariable": "edpridrpgrdm",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "EDPRIDRPGRD",
    "UsesVariable": "edprienrgrdm",
    "Distance": 6,
    "Code": "\r'mti 2022/04/12 start\r'* Amin(2, AMAX(1, IIf(edpriintnm(R%, NGender) <> 1, edpriintnm(R%, NGender), edpriintnm(R%, gndr))))\rpristudents(GCount%, R%, gndr) = pristudents(GCount%, R%, gndr) * Amin(3, AMAX(0.05, If(edprienrm(R%, NGender) <> 1, edprienrm(R%, NGender), edprienrm(R%, gndr))))\r"
  },
  {
    "Variable": "EDPRIDRPGRD",
    "UsesVariable": "edprienrm",
    "Distance": 9,
    "Code": "\rpristudents(GCount%, R%, gndr) = pristudents(GCount%, R%, gndr) + SaveStudentCohorts(R%, GCount%, gndr, 1) * RptGr(GCount%)\r\ri1EdPriDropoutByGrade(GCount%, R%, gndr%) = EDPRIDRPGRD(R%, GCount%, gndr%)\r\rNext\ri1EdPriSur(R%, gndr%) = EDPRISUR(R%, gndr%)\r\r'  If GRPS(1,R%) = \"Ethiopia\" Then Stop\r\r\r'calculate grade-wise headcounts using last years grade-wise rates saved in an array (above)\r\r'mti 2016/12/09 start\r'Call GradeWiseEnrollmentCalc(R%, gndr, secStart(R%), cint(edseclowrlen(R%)), caledsecint, EDSECLOWRSUR(R%, gndr), _\r'seclowrstudents(), SaveSecLowUpStudentCohorts(), 1, EdSecTot_Gen, , True)\r\r\r'  If GRPS(1,R%) = \"Egypt\" And gndr = 1 And IY > 15 Then Stop\r\r'SRate = 100 * EDSECLOWRGRATE(R%, gndr) / caledsecint\r'Dropoutrate = AMAX(0, 1 - (EDSECLOWRGRATE(R%, gndr) / caledsecint) ^ (1 / edseclowrlen(R%)))\r'If GRPS(1,R%) = \"Angola\" Then Stop\r'If GRPS(1,R%) = \"Cambodia\" Then Stop\rDim SurvTrgtCovd As Single, SecLowrRptGr1 As Single\rIf ilEdSecLowrSur(R%, gndr%) < 95 Then 'ilEdSecLowrSur\rSurvTrgtCovd = (sEdSecLowrSur(R%, gndr%) - ilEdSecLowrSur(R%, gndr%)) / (100 - ilEdSecLowrSur(R%, gndr%))\rSecLowrRptGr1 = ConvergeOverPath(EdSecLowrRptrGr(1, R%, gndr), 0, sEdSecLowrSur(R%, gndr%), ilEdSecLowrSur(R%, gndr%), 95)\rDim ConvTime = CInt(Floor(Abs(EdSecLowrRptrGr(1, R%, gndr)) / 0.01)) '03    '3% repitition reduction at most per year\rSecLowrRptGr1 = ConvergeOverTime(EdSecLowrRptrGr(1, R%, gndr), 0, AMAX(5, ConvTime))\rEnd If\r\r\r'mti dec 15 08 - commented this; using  saved value\r'save secondary lower last grade enrollment from last year - to use with transition rate\r'        FinalGrade(SecLowr, gndr) = SaveSecLowUpStudentCohorts(cint(edseclowrlen(R%)), gndr, 1)\r\r'   If GRPS(1,R%) = \"Ethiopia\" Then Stop\r'All Years but First: Lower Secondary Final: grade-specific enrollment rates, total students - general curriculum only\r'Call GradeWiseEnrollmentCalc(R%, gndr, secStart(R%), cint(edseclowrlen(R%)), caledsecint, EDSECLOWRSUR(R%, gndr), _\r'seclowrstudents(), SaveSecLowUpStudentCohorts(), 1, EdSecTot_Gen)\r'        Dropoutrate = AMAX(0, 1 - (EDSECLOWRGRATE(R%, gndr) / caledsecint) ^ (1 / edseclowrlen(R%)))\r'\r'        'before procedure: SaveSecLowUpStudentCohorts = gradewise students from the previous year (saved before budget allocation); seclowrstudents = supposed to save seclowrstudents () for next year\r'        Call GradeWiseEnrollmentCalc(R%, gndr, secStart(R%), cint(edseclowrlen(R%)), caledsecint, 0, _\r'                seclowrstudents(), SaveSecLowUpStudentCohorts(), 1, EDSECLOWRTOT(R%, gndr), Dropoutrate)\r\r'            If ilEdSecLowrSur(R%, gndr%) = 100 Then\r'                SurvTrgtCovd = 1\r'            Else\r'                SurvTrgtCovd = (sEdSecLowrSur(R%, gndr%) - ilEdSecLowrSur(R%, gndr%)) / (100 - ilEdSecLowrSur(R%, gndr%))\r'            End If\r\rDim SurvTrgtCovd, SecLowrRptGr1 As Single\rIf ilEdSecLowrSur(R%, gndr%) < 95 Then 'ilEdSecLowrSur\rSurvTrgtCovd = (sEdSecLowrSur(R%, gndr%) - ilEdSecLowrSur(R%, gndr%)) / (100 - ilEdSecLowrSur(R%, gndr%))\rSecLowrRptGr1 = ConvergeOverPath(EdSecLowrRptrGr(1, R%, gndr), 0, sEdSecLowrSur(R%, gndr%), ilEdSecLowrSur(R%, gndr%), 95)\rDim ConvTime = CInt(Floor(Abs(EdSecLowrRptrGr(1, R%, gndr)) / 0.01))     '3% repitition reduction at most per year\rSecLowrRptGr1 = ConvergeOverTime(EdSecLowrRptrGr(1, R%, gndr), 0, AMAX(5, ConvTime))\r\rEnd If\r\r\r' If GRPS(1, R%) = \"Burundi\" And gndr = 1 Then\r'    'Stop\r'    Debug.Print IY; \",\"; GRPS(1, R%); \",\"; EDPRIINT(R%, gndr%); \",\"; EDPRISUR(R%, gndr%); \",\"; EDPRIINT(R%, gndr%) * EDPRISUR(R%, gndr%) / 100; \",\";\r' End If\r\r\rIf i1EdPriSur(R%, gndr%) > 90 Then\rFor GCount% = 1 To CInt(edprilen(R%)) '\rEdPriDropoutByGrade(GCount%, R%, gndr%) = ConvergeOverTime1(i1EdPriDropoutByGrade(GCount%, R%, gndr%), 0, 15)\rNext GCount%\r'what if survival goes down through scenario - add branch\rElse\r'SurvTrgtCovd = (sEDPRISUR(R%, gndr%) - i1EdPriSur(R%, gndr%)) / (100 - i1EdPriSur(R%, gndr%))\rSurvTrgtCovd = AMAX(-0.2, Amin(1, (EDPRISUR(R%, gndr%) - i1EdPriSur(R%, gndr%)) / (100 - i1EdPriSur(R%, gndr%))))\rFor GCount% = 1 To CInt(edprilen(R%)) '\rEdPriDropoutByGrade(GCount%, R%, gndr%) = CSng(AMAX(0, Amin(0.9, i1EdPriDropoutByGrade(GCount%, R%, gndr%) + SurvTrgtCovd * (0 - i1EdPriDropoutByGrade(GCount%, R%, gndr%))))) 'AMAX(0, (can be in both direction)\rNext GCount%\rEnd If\r\ri1EdPriDropoutByGrade(GCount%, R%, gndr%) = EDPRIDRPGRD(R%, GCount%, gndr%)\r"
  },
  {
    "Variable": "EDPRIDRPGRD",
    "UsesVariable": "EDPRISUR",
    "Distance": 19,
    "Code": "0"
  },
  {
    "Variable": "EDPRIDRPGRD",
    "UsesVariable": "EDSECLOWRENRGGRD",
    "Distance": 445,
    "Code": "0"
  },
  {
    "Variable": "EDPRIDRPGRD",
    "UsesVariable": "EDSECLOWRDRPGRD",
    "Distance": 424,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRG",
    "UsesVariable": "EDPRITOT",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRG",
    "UsesVariable": "POP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRG",
    "UsesVariable": "PRI",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRG",
    "UsesVariable": "edpristart",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRG",
    "UsesVariable": "edprilen",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRGGRD",
    "UsesVariable": "POP",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRGGRD",
    "UsesVariable": "edpristart",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRGGRD",
    "UsesVariable": "edprienrgrdm",
    "Distance": 5,
    "Code": "\r'mti 2022/04/12 start\r'* Amin(2, AMAX(1, IIf(edpriintnm(R%, NGender) <> 1, edpriintnm(R%, NGender), edpriintnm(R%, gndr))))\rpristudents(GCount%, R%, gndr) = pristudents(GCount%, R%, gndr) * Amin(3, AMAX(0.05, If(edprienrm(R%, NGender) <> 1, edprienrm(R%, NGender), edprienrm(R%, gndr))))\r\r'mti 2022/04/12 start\rpristudents(GCount%, R%, gndr%) = pristudents(GCount%, R%, gndr%) * If(edprienrgrdm(R%, NGender) <> 1, edprienrgrdm(R%, NGender), edprienrgrdm(R%, gndr))\r\r'mti 07/24/2020 End\r\rFor GCount% = 1 To CInt(edprilen(R%)) '+ 1 To NPriGr\rEDPRIENRGGRD(R%, GCount%, gndr%) = pristudents(GCount%, R%, gndr%)\r"
  },
  {
    "Variable": "EDPRIENRGGRD",
    "UsesVariable": "edprienrm",
    "Distance": 8,
    "Code": "\rpristudents(GCount%, R%, gndr) = pristudents(GCount%, R%, gndr) + SaveStudentCohorts(R%, GCount%, gndr, 1) * RptGr(GCount%)\r"
  },
  {
    "Variable": "EDPRIENRGGRD",
    "UsesVariable": "edpridrpgrdm",
    "Distance": 14,
    "Code": "\rNext\r\r'Dropouts by grade\r'mti 2022/04/12 start\rFor GCount% = 1 To CInt(edprilen(R%))     '- 1\rEdPriDropoutByGrade(GCount%, R%, gndr%) = EDPRIDRPGRD(R%, GCount%, gndr%) 'initialized in pre-processor\r\r\r' If GRPS(1, R%) = \"Burundi\" And gndr = 1 Then\r'    'Stop\r'    Debug.Print IY; \",\"; GRPS(1, R%); \",\"; EDPRIINT(R%, gndr%); \",\"; EDPRISUR(R%, gndr%); \",\"; EDPRIINT(R%, gndr%) * EDPRISUR(R%, gndr%) / 100; \",\";\r' End If\r\r\rIf i1EdPriSur(R%, gndr%) > 90 Then\rFor GCount% = 1 To CInt(edprilen(R%)) '\rEdPriDropoutByGrade(GCount%, R%, gndr%) = ConvergeOverTime1(i1EdPriDropoutByGrade(GCount%, R%, gndr%), 0, 15)\rNext GCount%\r'what if survival goes down through scenario - add branch\rElse\r'SurvTrgtCovd = (sEDPRISUR(R%, gndr%) - i1EdPriSur(R%, gndr%)) / (100 - i1EdPriSur(R%, gndr%))\rSurvTrgtCovd = AMAX(-0.2, Amin(1, (EDPRISUR(R%, gndr%) - i1EdPriSur(R%, gndr%)) / (100 - i1EdPriSur(R%, gndr%))))\rFor GCount% = 1 To CInt(edprilen(R%)) '\rEdPriDropoutByGrade(GCount%, R%, gndr%) = CSng(AMAX(0, Amin(0.9, i1EdPriDropoutByGrade(GCount%, R%, gndr%) + SurvTrgtCovd * (0 - i1EdPriDropoutByGrade(GCount%, R%, gndr%))))) 'AMAX(0, (can be in both direction)\rNext GCount%\rEnd If\r\r\r' If GRPS(1, R%) = \"Burundi\" And gndr = 1 Then\r'    'Stop\r'    Debug.Print IY; \",\"; GRPS(1, R%); \",\"; EDPRIINT(R%, gndr%); \",\"; EDPRISUR(R%, gndr%); \",\"; EDPRIINT(R%, gndr%) * EDPRISUR(R%, gndr%) / 100; \",\";\r' End If\r\r\rIf i1EdPriSur(R%, gndr%) > 90 Then\rFor GCount% = 1 To CInt(edprilen(R%)) '\rEdPriDropoutByGrade(GCount%, R%, gndr%) = ConvergeOverTime1(i1EdPriDropoutByGrade(GCount%, R%, gndr%), 0, 15)\rNext GCount%\r'what if survival goes down through scenario - add branch\rElse\r'SurvTrgtCovd = (sEDPRISUR(R%, gndr%) - i1EdPriSur(R%, gndr%)) / (100 - i1EdPriSur(R%, gndr%))\rSurvTrgtCovd = AMAX(-0.2, Amin(1, (EDPRISUR(R%, gndr%) - i1EdPriSur(R%, gndr%)) / (100 - i1EdPriSur(R%, gndr%))))\rFor GCount% = 1 To CInt(edprilen(R%)) '\rEdPriDropoutByGrade(GCount%, R%, gndr%) = CSng(AMAX(0, Amin(0.9, i1EdPriDropoutByGrade(GCount%, R%, gndr%) + SurvTrgtCovd * (0 - i1EdPriDropoutByGrade(GCount%, R%, gndr%))))) 'AMAX(0, (can be in both direction)\rNext GCount%\rEnd If\rCOMPLETE STRUCTURE:End If:8461|\r\r' If GRPS(1,R%) = \"Thailand\" Then Stop\r\r'---------- Grade-specific enrollment and dropout -------\r'Grade-specific gross enrollment rate\rIf EDSECLOWRENRGGRD(R%, 1, gndr%) > 0 And EDSECLOWRENRGGRD(R%, 1, gndr%) < 999 Then\r'already initialized with historical in pre-processor\rFor GCount% = 1 To CInt(edseclowrlen(R%))\rseclowrstudents(GCount%, R%, gndr%) = EDSECLOWRENRGGRD(R%, GCount%, gndr%)  'Load intermediate variables (not needed; ultimately)\r\r\r'                EdSecLowrTot_From_GradeEnr = 0\r'                PopTot = 0\r'                For GCount% = 1 To edseclowrlen(R%)\r'\r'                    Gr_Students = fagedst(edpristart(R%) + edprilen(R%) + GCount% - 1, R%, gndr%) * seclowrstudents(GCount%, R%, gndr%) / 100\r'                    EdSecLowrTot_From_GradeEnr = EdSecLowrTot_From_GradeEnr + Gr_Students\r'                    PopTot = PopTot + fagedst(edpristart(R%) + edprilen(R%) + GCount% - 1, R%, gndr%)\r'                Next\r'\r'                EDSECLOWRTOT(R%, gndr) = EDSECLOWRENRG(R%, gndr) * PopTot / 100    'mti 2021/04/27\r'\r'                Rat_Gr_Lvl = EDSECLOWRTOT(R%, gndr) * (1 - EDSECLOWRVOC(R%, gndr%) / 100) / AMAX(0.000001, EdSecLowrTot_From_GradeEnr)\r'\r'          'If RegName(R%) = \"Angola\" Then Stop\r''          If RegName(R%) = \"Cambodia\" Then Stop\r'\r'                If Round(Rat_Gr_Lvl, 4) <> 1 Then\r'                    For GCount% = 1 To edseclowrlen(R%)\r'                        seclowrstudents(GCount%, R%, gndr%) = seclowrstudents(GCount%, R%, gndr%) * Rat_Gr_Lvl\r'\r'                        EDSECLOWRENRGGRD(R%, GCount%, gndr%) = seclowrstudents(GCount%, R%, gndr%)\r'\r'                        'SaveStudentCohorts(R%, GCount%, gndr, SecLowr) = seclowrstudents(GCount%, R%, gndr)\r'                    Next\r'                End If\r\r'mti 2022/04/12 - End\r\r\r'Unused Grade Variables set to 0\rFor GCount% = CInt(edseclowrlen(R%) + 1) To NPriGr\rseclowrstudents(GCount%, R%, gndr%) = 0\r\rNext\ri1EdPriSur(R%, gndr%) = EDPRISUR(R%, gndr%)\r\r\rFor GCount% = 2 To CInt(edprilen(R%))  'mti 2021/05/06\r'If GRPS(1, R%) = \"China\" And gndr = 1 And GCount% = CInt(edprilen(R%)) Then Stop\rIf pristudents(GCount%, R%, gndr%) = 0 Then\redPriRptrGr(GCount%, R%, gndr) = 0\rElse\redPriRptrGr(GCount%, R%, gndr) = CSng(Amin(0.9, AMAX(0, (EDPRIENRGGRD(R%, GCount%, gndr%) -\r                                                    (EDPRIENRGGRD(R%, GCount% - 1, gndr%) *\r                                                    AMAX(0.001, (1 - EDPRIDRPGRD(R%, GCount% - 1, gndr%) -\r                                                    edPriRptrGr(GCount% - 1, R%, gndr))))) / EDPRIENRGGRD(R%, GCount%, gndr%))))\rEnd If\rCOMPLETE STRUCTURE:End If:8461|\r\r' If GRPS(1,R%) = \"Thailand\" Then Stop\r\r'---------- Grade-specific enrollment and dropout -------\r'Grade-specific gross enrollment rate\rIf EDSECLOWRENRGGRD(R%, 1, gndr%) > 0 And EDSECLOWRENRGGRD(R%, 1, gndr%) < 999 Then\r'already initialized with historical in pre-processor\rFor GCount% = 1 To CInt(edseclowrlen(R%))\rseclowrstudents(GCount%, R%, gndr%) = EDSECLOWRENRGGRD(R%, GCount%, gndr%)  'Load intermediate variables (not needed; ultimately)\r\r\r'                EdSecLowrTot_From_GradeEnr = 0\r'                PopTot = 0\r'                For GCount% = 1 To edseclowrlen(R%)\r'\r'                    Gr_Students = fagedst(edpristart(R%) + edprilen(R%) + GCount% - 1, R%, gndr%) * seclowrstudents(GCount%, R%, gndr%) / 100\r'                    EdSecLowrTot_From_GradeEnr = EdSecLowrTot_From_GradeEnr + Gr_Students\r'                    PopTot = PopTot + fagedst(edpristart(R%) + edprilen(R%) + GCount% - 1, R%, gndr%)\r'                Next\r'\r'                EDSECLOWRTOT(R%, gndr) = EDSECLOWRENRG(R%, gndr) * PopTot / 100    'mti 2021/04/27\r'\r'                Rat_Gr_Lvl = EDSECLOWRTOT(R%, gndr) * (1 - EDSECLOWRVOC(R%, gndr%) / 100) / AMAX(0.000001, EdSecLowrTot_From_GradeEnr)\r'\r'          'If RegName(R%) = \"Angola\" Then Stop\r''          If RegName(R%) = \"Cambodia\" Then Stop\r'\r'                If Round(Rat_Gr_Lvl, 4) <> 1 Then\r'                    For GCount% = 1 To edseclowrlen(R%)\r'                        seclowrstudents(GCount%, R%, gndr%) = seclowrstudents(GCount%, R%, gndr%) * Rat_Gr_Lvl\r'\r'                        EDSECLOWRENRGGRD(R%, GCount%, gndr%) = seclowrstudents(GCount%, R%, gndr%)\r'\r'                        'SaveStudentCohorts(R%, GCount%, gndr, SecLowr) = seclowrstudents(GCount%, R%, gndr)\r'                    Next\r'                End If\r\r'mti 2022/04/12 - End\r\r\r'Unused Grade Variables set to 0\rFor GCount% = CInt(edseclowrlen(R%) + 1) To NPriGr\rseclowrstudents(GCount%, R%, gndr%) = 0\r\r'If GRPS(1, R%) = \"Oman\" And gndr = 1 Then Stop\r\r\r'Repeaters as a share of grade enrollment (with constant grade-enrollment assumption)\rFor GCount% = 1 To CInt(edprilen(R%))\rIf i1EdPriSur(R%, gndr%) < 95 Then '95\rRptGr(GCount%) = ConvergeOverPath(edPriRptrGr(GCount%, R%, gndr), 0, EDPRISUR(R%, gndr%), i1EdPriSur(R%, gndr%), 100)   '95\rElse\r'mti 2023/12/01 start\rRptGr(GCount%) = ConvergeOverTime1(edPriRptrGr(GCount%, R%, gndr), 0, 10)  'mti 2023/12/01 was 5\r'mti 2023/12/01 End\rEnd If\rNext GCount%\r\r\r'            'mti 2022/04/12 start\r'survival will change now only by budget\r'Cumdrp = 100\rFor GCount% = 1 To CInt(edprilen(R%) - 1)\rEdPriDropoutByGrade(GCount%, R%, gndr%) = CSng(AMAX(0, Amin(0.9, EdPriDropoutByGrade(GCount%, R%, gndr%) * If(edpridrpgrdm(R%, NGender) <> 1, edpridrpgrdm(R%, NGender), edpridrpgrdm(R%, gndr)))))\r\r'mti 2022/04/12 end\r\r\r'             'before procedure: seclowrstudents() = gradewise students from the previous year; SaveSecLowUpStudentCohorts = supposed to save seclowrstudents () for post budget allocation use\r'             Call GradeWiseEnrollmentCalc(R%, gndr, secStart(R%), cint(edseclowrlen(R%)), caledsecint, SRate, _\r'                seclowrstudents(), SaveSecLowUpStudentCohorts(), 1, EDSECLOWRTOT(R%, gndr), Dropoutrate, True)\r'            'after procedure: seclowrstudents() = gradewise students this year (pre-budget); SaveSecLowUpStudentCohorts = gradewise students from the previous year\r'             'mti 2016/12/09 End\r\rFor GCount% = 1 To CInt(edseclowrlen(R%)) 'save last year's grade specific enrollment for post budget use\rSaveStudentCohorts(R%, GCount%, gndr, SecLowr) = seclowrstudents(GCount%, R%, gndr)\r\r\r\r'gender parity parameters\rGenderParityCalc(edsecupprgndreqtran(R%), EDSECUPPRTRAN(R%, Male), EDSECUPPRTRAN(R%, Female), \"SecUppr\")\rGenderParityCalc(edsecupprgndreqgrad(R%), EDSECUPPRGRATE(R%, Male), EDSECUPPRGRATE(R%, Female), \"SecUppr\")\r\r\rFor gndr = 1 To NGender - 1\r'mti 2023/11/28 end\r\r'save flow rates for multiplier calculation later\riEdIntk(R%, gndr, SecUppr) = EDSECUPPRTRAN(R%, gndr)\r\r\riEdSurv(R%, gndr, SecUppr) = EDSECUPPRGRATE(R%, gndr) ' EDSECUPPRSUR(R%, gndr)\r\r'All years but first: Upper Secondary Initial: calculate intake using last year's lower secondary final grade and transition rate this year\r\r'All years but first: Upper Secondary Initial: School-age population\r'            secupprpop(R%, gndr) = CalcPopFrom1Year(secStart + edseclowrlen(R%), edsecupprlen(R%), R%, gndr)\r\r'make both general and vocational from lower available for upper general\r'            If edseclowrtrancap(R%) = 1 Then 'vocational/general split at the first grade\r'            'mti 2014/03/27 - start\r'                Add2Final = sEdSecLowrShareVoc(R%, gndr) * (sedseclowrenrg(R%, gndr%) / 100)\r'            Else  'vocational general split later; more vocational in later grades (than in earlier grades)\r'                Add2Final = sEdSecLowrShareVoc(R%, gndr) * (sedseclowrenrg(R%, gndr%) / 100) '* ConvergeOverTime(1.8, 1.2, 15) ' 1.8\r'            End If\r\r'caledsecint = (FinalGrade(SecLowr, gndr) + Add2Final) * EDSECUPPRTRAN(R%, gndr) / 100\r'caledsecint = (SaveSecLowUpStudentCohorts(R%, cint(edseclowrlen(R%)), gndr, 1) + Add2Final) * EDSECUPPRTRAN(R%, gndr) / 100\rcaledsecint = SaveSecLowUpStudentCohorts(R%, CInt(edseclowrlen(R%)), gndr, 1) * EDSECUPPRTRAN(R%, gndr) / 100\r'mti December 11, 2008 - end\r\r\r'All years but first: Upper Secondary Initial: Total Students\r'Call GradeWiseEnrollmentCalc(R%, gndr, secStart(R%) + edseclowrlen(R%), edsecupprlen(R%), caledsecint, EDSECUPPRSUR(R%, gndr), _\r'secupprstudents(), SaveSecLowUpStudentCohorts(), 2, EdSecTot_Gen, , True)\r\r\r'SRate = 100 * EDSECUPPRGRATE(R%, gndr) / caledsecint\rDropoutrate = CSng(AMAX(0, 1 - (EDSECUPPRGRATE(R%, gndr) / caledsecint) ^ (1 / edsecupprlen(R%))))\r\r'mti 2023/11/28 start\rFor GCount% = 1 To CInt(edsecupprlen(R%)) 'save last year's grade specific enrollment for post budget use\rSaveStudentCohorts(R%, GCount%, gndr, SecUppr) = secupprstudents(GCount%, R%, gndr)\rNext\r'mti 2023/11/28 end\r\rCall GradeWiseEnrollmentCalc(R%, gndr, secStart(R%) + edseclowrlen(R%), edsecupprlen(R%), caledsecint, 0,\r                    secupprstudents, SaveSecLowUpStudentCohorts, 2, EDSECUPPRTOT(R%, gndr), Dropoutrate, True)\r'mti 2014/03/27 - start\r'Vocational share (of total, i.e., gen + voc)) is forecast as constant (=initial val.) or constant * multiplier; capping at 70% as the maximum share\r'            If edsecupprvocm(R%, Total) <> 1 Or edsecupprvocm(R%, gndr) <> 1 Then\r'                EDSECUPPRVOCI(R%, gndr) = AMAX(EDSECUPPRVOCI(R%, gndr), 0.01)  'multiplier won't work for zero, so give a small value\r'            End If\r\rEDSECUPPRVOC(R%, gndr) = AMAX(0, Amin(70, EDSECUPPRVOCI(R%, gndr) + If(edsecupprvocadd(R%, Total) <> 0, edsecupprvocadd(R%, Total), edsecupprvocadd(R%, gndr))))\r\r'All years but first: Upper Secondary Initial: Add Vocational\r'EDSECUPPRTOT(R%, gndr) = EdSecTot_Gen + secupprpop(R%, gndr) * sEdSecUpprShareVoc(R%, gndr) / 100\r'EDSECUPPRTOT(R%, gndr) = EdSecTot_Gen / (1 - EDSECUPPRVOC(R%, gndr) / 100)\r\r'mti October 2008 adjust for shift, or total students for budget'll be less\r'EDSECUPPRTOT(R%, gndr) = EDSECUPPRTOT(R%, gndr) + secupprpop(R%, gndr) * (ConvergeOverTimeSmooth(edsecUpprenrgshift(R%, gndr), 0, edsecUpprenrgshiftCur(R%, gndr), False) / 100) '25\rEDSECUPPRTOT(R%, gndr) = EDSECUPPRTOT(R%, gndr) + secupprpop(R%, gndr) * edsecUpprenrgshiftCur(R%, gndr) / 100\r'-- Demand determined (constrained with multiplier) transition, survival and gross enrollment ----------------\r\r\r'Constrain the total enrollment for budget demand only : it is not necessary to adjust intake/survival here\r'mti 2022/04/12 start\r'EDSECUPPRTOT(R%, gndr) = Amin(1.5 * secupprpop(R%, gndr), EDSECUPPRTOT(R%, gndr))\rEDSECUPPRTOT(R%, gndr) = CSng(AMAX(0.01 * secupprpop(R%, gndr), Amin(1.5 * secupprpop(R%, gndr), EDSECUPPRTOT(R%, gndr))))\r'mti 2022/04/12 End\r'mti 2014/03/27 - end\r\r'commented october 2008\r'All years but first: Upper Secondary Initial: add each gender to total students and graduates\r'EDSECUPPRTOT(R%, Total) = EDSECUPPRTOT(R%, Total) + EDSECUPPRTOT(R%, gndr)\r\rNext gndr\r\rNext R%\r\r'If GRPS(1, R%) = \"Oman\" And gndr = 1 Then Stop\r\r\r'Repeaters as a share of grade enrollment (with constant grade-enrollment assumption)\rFor GCount% = 1 To CInt(edprilen(R%))\rIf i1EdPriSur(R%, gndr%) < 95 Then '95\rRptGr(GCount%) = ConvergeOverPath(edPriRptrGr(GCount%, R%, gndr), 0, EDPRISUR(R%, gndr%), i1EdPriSur(R%, gndr%), 100)   '95\rElse\r'mti 2023/12/01 start\rRptGr(GCount%) = ConvergeOverTime1(edPriRptrGr(GCount%, R%, gndr), 0, 10)  'mti 2023/12/01 was 5\r'mti 2023/12/01 End\rEnd If\rNext GCount%\r\r'mti 2022/04/12 end\r\r\r'             'before procedure: seclowrstudents() = gradewise students from the previous year; SaveSecLowUpStudentCohorts = supposed to save seclowrstudents () for post budget allocation use\r'             Call GradeWiseEnrollmentCalc(R%, gndr, secStart(R%), cint(edseclowrlen(R%)), caledsecint, SRate, _\r'                seclowrstudents(), SaveSecLowUpStudentCohorts(), 1, EDSECLOWRTOT(R%, gndr), Dropoutrate, True)\r'            'after procedure: seclowrstudents() = gradewise students this year (pre-budget); SaveSecLowUpStudentCohorts = gradewise students from the previous year\r'             'mti 2016/12/09 End\r\rFor GCount% = 1 To CInt(edseclowrlen(R%)) 'save last year's grade specific enrollment for post budget use\rSaveStudentCohorts(R%, GCount%, gndr, SecLowr) = seclowrstudents(GCount%, R%, gndr)\r\r\r\r'gender parity parameters\rGenderParityCalc(edsecupprgndreqtran(R%), EDSECUPPRTRAN(R%, Male), EDSECUPPRTRAN(R%, Female), \"SecUppr\")\rGenderParityCalc(edsecupprgndreqgrad(R%), EDSECUPPRGRATE(R%, Male), EDSECUPPRGRATE(R%, Female), \"SecUppr\")\r\r\rFor gndr = 1 To NGender - 1\r'mti 2023/11/28 end\r\r'save flow rates for multiplier calculation later\riEdIntk(R%, gndr, SecUppr) = EDSECUPPRTRAN(R%, gndr)\r\r\riEdSurv(R%, gndr, SecUppr) = EDSECUPPRGRATE(R%, gndr) ' EDSECUPPRSUR(R%, gndr)\r\r'All years but first: Upper Secondary Initial: calculate intake using last year's lower secondary final grade and transition rate this year\r\r'All years but first: Upper Secondary Initial: School-age population\r'            secupprpop(R%, gndr) = CalcPopFrom1Year(secStart + edseclowrlen(R%), edsecupprlen(R%), R%, gndr)\r\r'make both general and vocational from lower available for upper general\r'            If edseclowrtrancap(R%) = 1 Then 'vocational/general split at the first grade\r'            'mti 2014/03/27 - start\r'                Add2Final = sEdSecLowrShareVoc(R%, gndr) * (sedseclowrenrg(R%, gndr%) / 100)\r'            Else  'vocational general split later; more vocational in later grades (than in earlier grades)\r'                Add2Final = sEdSecLowrShareVoc(R%, gndr) * (sedseclowrenrg(R%, gndr%) / 100) '* ConvergeOverTime(1.8, 1.2, 15) ' 1.8\r'            End If\r\r'caledsecint = (FinalGrade(SecLowr, gndr) + Add2Final) * EDSECUPPRTRAN(R%, gndr) / 100\r'caledsecint = (SaveSecLowUpStudentCohorts(R%, cint(edseclowrlen(R%)), gndr, 1) + Add2Final) * EDSECUPPRTRAN(R%, gndr) / 100\rcaledsecint = SaveSecLowUpStudentCohorts(R%, CInt(edseclowrlen(R%)), gndr, 1) * EDSECUPPRTRAN(R%, gndr) / 100\r'mti December 11, 2008 - end\r\r\r'All years but first: Upper Secondary Initial: Total Students\r'Call GradeWiseEnrollmentCalc(R%, gndr, secStart(R%) + edseclowrlen(R%), edsecupprlen(R%), caledsecint, EDSECUPPRSUR(R%, gndr), _\r'secupprstudents(), SaveSecLowUpStudentCohorts(), 2, EdSecTot_Gen, , True)\r\r\r'SRate = 100 * EDSECUPPRGRATE(R%, gndr) / caledsecint\rDropoutrate = CSng(AMAX(0, 1 - (EDSECUPPRGRATE(R%, gndr) / caledsecint) ^ (1 / edsecupprlen(R%))))\r\r'mti 2023/11/28 start\rFor GCount% = 1 To CInt(edsecupprlen(R%)) 'save last year's grade specific enrollment for post budget use\rSaveStudentCohorts(R%, GCount%, gndr, SecUppr) = secupprstudents(GCount%, R%, gndr)\rNext\r'mti 2023/11/28 end\r\rCall GradeWiseEnrollmentCalc(R%, gndr, secStart(R%) + edseclowrlen(R%), edsecupprlen(R%), caledsecint, 0,\r                    secupprstudents, SaveSecLowUpStudentCohorts, 2, EDSECUPPRTOT(R%, gndr), Dropoutrate, True)\r'mti 2014/03/27 - start\r'Vocational share (of total, i.e., gen + voc)) is forecast as constant (=initial val.) or constant * multiplier; capping at 70% as the maximum share\r'            If edsecupprvocm(R%, Total) <> 1 Or edsecupprvocm(R%, gndr) <> 1 Then\r'                EDSECUPPRVOCI(R%, gndr) = AMAX(EDSECUPPRVOCI(R%, gndr), 0.01)  'multiplier won't work for zero, so give a small value\r'            End If\r\rEDSECUPPRVOC(R%, gndr) = AMAX(0, Amin(70, EDSECUPPRVOCI(R%, gndr) + If(edsecupprvocadd(R%, Total) <> 0, edsecupprvocadd(R%, Total), edsecupprvocadd(R%, gndr))))\r\r'All years but first: Upper Secondary Initial: Add Vocational\r'EDSECUPPRTOT(R%, gndr) = EdSecTot_Gen + secupprpop(R%, gndr) * sEdSecUpprShareVoc(R%, gndr) / 100\r'EDSECUPPRTOT(R%, gndr) = EdSecTot_Gen / (1 - EDSECUPPRVOC(R%, gndr) / 100)\r\r'mti October 2008 adjust for shift, or total students for budget'll be less\r'EDSECUPPRTOT(R%, gndr) = EDSECUPPRTOT(R%, gndr) + secupprpop(R%, gndr) * (ConvergeOverTimeSmooth(edsecUpprenrgshift(R%, gndr), 0, edsecUpprenrgshiftCur(R%, gndr), False) / 100) '25\rEDSECUPPRTOT(R%, gndr) = EDSECUPPRTOT(R%, gndr) + secupprpop(R%, gndr) * edsecUpprenrgshiftCur(R%, gndr) / 100\r'-- Demand determined (constrained with multiplier) transition, survival and gross enrollment ----------------\r\r\r'Constrain the total enrollment for budget demand only : it is not necessary to adjust intake/survival here\r'mti 2022/04/12 start\r'EDSECUPPRTOT(R%, gndr) = Amin(1.5 * secupprpop(R%, gndr), EDSECUPPRTOT(R%, gndr))\rEDSECUPPRTOT(R%, gndr) = CSng(AMAX(0.01 * secupprpop(R%, gndr), Amin(1.5 * secupprpop(R%, gndr), EDSECUPPRTOT(R%, gndr))))\r'mti 2022/04/12 End\r'mti 2014/03/27 - end\r\r'commented october 2008\r'All years but first: Upper Secondary Initial: add each gender to total students and graduates\r'EDSECUPPRTOT(R%, Total) = EDSECUPPRTOT(R%, Total) + EDSECUPPRTOT(R%, gndr)\r\rNext gndr\r\rNext R%\r\r\r\r'Other grades with dropout and repeaters\rFor GCount% = 2 To CInt(edprilen(R%))\r'If GRPS(1, R%) = \"Vanuatu\" And gndr = 2 And GCount% = 5 Then Stop\rpristudents(GCount%, R%, gndr) = AMAX(5, (SaveStudentCohorts(R%, GCount% - 1, gndr, 1) * (1 - EdPriDropoutByGrade(GCount% - 1, R%, gndr) - RptGr(GCount% - 1))))\r"
  },
  {
    "Variable": "EDPRIENRGGRD",
    "UsesVariable": "EDSECLOWRENRGGRD",
    "Distance": 444,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRGGRD",
    "UsesVariable": "EDPRIDRPGRD",
    "Distance": 116,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRGGRD",
    "UsesVariable": "EDPRISUR",
    "Distance": 123,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRGGRD",
    "UsesVariable": "EDSECLOWRDRPGRD",
    "Distance": 423,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRN",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRN",
    "UsesVariable": "edpristart",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRN",
    "UsesVariable": "EDPRIINTN",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRN",
    "UsesVariable": "edprilen",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRN",
    "UsesVariable": "POPEDPRI",
    "Distance": 1607,
    "Code": "\r\r'    If RegName(R%) = \"Nicaragua\" And gndr% = 1 Then Stop\r\rEdPriEnrRatioNG = Amin(1, EDPRIENRN(R%, gndr%) / EDPRIENRG(R%, gndr%))\r\r\r'Other grades with dropout and repeaters\rFor GCount% = 2 To CInt(edprilen(R%))\r'If GRPS(1, R%) = \"Vanuatu\" And gndr = 2 And GCount% = 5 Then Stop\rpristudents(GCount%, R%, gndr) = AMAX(5, (SaveStudentCohorts(R%, GCount% - 1, gndr, 1) * (1 - EdPriDropoutByGrade(GCount% - 1, R%, gndr) - RptGr(GCount% - 1))))\rpristudents(GCount%, R%, gndr) = pristudents(GCount%, R%, gndr) + SaveStudentCohorts(R%, GCount%, gndr, 1) * RptGr(GCount%)\r'mti 2022/04/12 start\r'* Amin(2, AMAX(1, IIf(edpriintnm(R%, NGender) <> 1, edpriintnm(R%, NGender), edpriintnm(R%, gndr))))\rpristudents(GCount%, R%, gndr) = pristudents(GCount%, R%, gndr) * Amin(3, AMAX(0.05, If(edprienrm(R%, NGender) <> 1, edprienrm(R%, NGender), edprienrm(R%, gndr))))\r'mti 2022/04/12 End\r\rNext\r\rEDPRITOT(R%, gndr) = 0\r\r\rFor GCount% = 1 To CInt(edprilen(R%)) 'go back to previous year values\rEdPriDropoutByGrade(GCount%, R%, gndr%) = drpoutgr(GCount%)\r'mti 2022/04/12 start\rpristudents(GCount%, R%, gndr%) = pristudents(GCount%, R%, gndr%) * If(edprienrgrdm(R%, NGender) <> 1, edprienrgrdm(R%, NGender), edprienrgrdm(R%, gndr))\r'mti 2022/04/12 end\r\rEDPRITOT(R%, gndr) = CSng(EDPRITOT(R%, gndr) + fagedst(CInt(edpristart(R%) + GCount% - 1), R%, gndr%) *\r                            pristudents(GCount%, R%, gndr%) / 100)\rNext\r\r\rNext gndr\r\rNext R%\r\rDim sdout = AMAX(0, 1 - ((sEDPRISUR(R%, gndr) / 100) ^ (1 / (edprilen(R%) - 1))))\r"
  },
  {
    "Variable": "EDPRIENRN",
    "UsesVariable": "EDPRISUR",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRN",
    "UsesVariable": "edprienrgrdm",
    "Distance": 1686,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRN",
    "UsesVariable": "EDPRIENRG",
    "Distance": 1612,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRN",
    "UsesVariable": "edprienrm",
    "Distance": 1689,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRN",
    "UsesVariable": "edpridrpgrdm",
    "Distance": 1698,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRN",
    "UsesVariable": "EDPRIENRGGRD",
    "Distance": 1934,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRN",
    "UsesVariable": "EDPRIDRPGRD",
    "Distance": 1934,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRN",
    "UsesVariable": "EDSECLOWRENRGGRD",
    "Distance": 2262,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRN",
    "UsesVariable": "EDSECLOWRDRPGRD",
    "Distance": 2241,
    "Code": "0"
  },
  {
    "Variable": "EDPRIENRN",
    "UsesVariable": "PRI",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "edprigoalexper",
    "UsesVariable": "edprigoalexperon",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "edprigoalexper",
    "UsesVariable": "EDEXPERPRI",
    "Distance": 1727,
    "Code": "0"
  },
  {
    "Variable": "EDPRIGRADS",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRIGRADS",
    "UsesVariable": "edpristart",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRIGRADS",
    "UsesVariable": "edprilen",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRIGRADS",
    "UsesVariable": "EDPRICR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRIGRADS",
    "UsesVariable": "PRI",
    "Distance": 0,
    "Code": "\r\rPrivate Sub InitTots(R%, level$)\r'---------------------------------------------------------\r'mti December 2009 - Knowledge Indices - new proc\r\rIf level$ = \"Pri\" Then\rEDPRITOT(R%, Total) = 0\rEDPRIGRADS(R%, Total) = 0\r'    EDSECGRADS(R%, Total) = 0\r\rEDSECLOWRTOT(R%, Total) = 0\rEDSECLOWRGRADS(R%, Total) = 0\r\rEDSECUPPRTOT(R%, Total) = 0\rEDSECUPPRGRADS(R%, Total) = 0\rEDTERGRADS(R%, Total) = 0\r\rEnd If\r\rEnd Sub\r\rEDPRIGRADS(R%, Total) = 0\r"
  },
  {
    "Variable": "EDPRIINT",
    "UsesVariable": "EDPRIINTN",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINT",
    "UsesVariable": "POP",
    "Distance": 70,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINT",
    "UsesVariable": "edpristart",
    "Distance": 70,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINT",
    "UsesVariable": "edpriintnm",
    "Distance": 74,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINT",
    "UsesVariable": "edprilen",
    "Distance": 83,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINT",
    "UsesVariable": "EDPRICR",
    "Distance": 2070,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINT",
    "UsesVariable": "edpridrpgrdm",
    "Distance": 2083,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINT",
    "UsesVariable": "edprienrgrdm",
    "Distance": 2074,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINT",
    "UsesVariable": "EDPRIDRPGRD",
    "Distance": 2194,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINT",
    "UsesVariable": "edprienrm",
    "Distance": 2077,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINT",
    "UsesVariable": "EDPRISUR",
    "Distance": 2087,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINT",
    "UsesVariable": "EDPRIENRN",
    "Distance": 1858,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINT",
    "UsesVariable": "POPEDPRI",
    "Distance": 1858,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINT",
    "UsesVariable": "EDPRIENRG",
    "Distance": 1863,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINT",
    "UsesVariable": "EDSECLOWRENRGGRD",
    "Distance": 2513,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINT",
    "UsesVariable": "EDPRIENRGGRD",
    "Distance": 2185,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINT",
    "UsesVariable": "EDSECLOWRDRPGRD",
    "Distance": 2492,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINT",
    "UsesVariable": "edqtqltrm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINT",
    "UsesVariable": "EDTERINT",
    "Distance": 70,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINT",
    "UsesVariable": "EDSECUPPRTRAN",
    "Distance": 109,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINT",
    "UsesVariable": "EDPRIINTNEXT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINT",
    "UsesVariable": "EDSECLOWRTRAN",
    "Distance": 288,
    "Code": "\r\r'Enforce gender parity now (after individual flow multipliers)\rGenderParityCalc(edseclowrgndreqtran(R%), EDSECLOWRTRAN(R%, Male), EDSECLOWRTRAN(R%, Female), \"SecLowr\")\rGenderParityCalc(edseclowrgndreqgrad(R%), EDSECLOWRGRATE(R%, Male), EDSECLOWRGRATE(R%, Female), \"SecLowr\")\r\r\r\rFor gndr = 1 To NGender - 1\r\r'mti 2023/11/28 End\r\r'All years but first: Lower Secondary Initial: save flow rates for multiplier calculation later\riEdIntk(R%, gndr, SecLowr) = EDSECLOWRTRAN(R%, gndr)\r"
  },
  {
    "Variable": "EDPRIINTN",
    "UsesVariable": "edpriintnm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTN",
    "UsesVariable": "EDSECUPPRTRAN",
    "Distance": 327,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTN",
    "UsesVariable": "edsecupprtranm",
    "Distance": 327,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTN",
    "UsesVariable": "gdsm",
    "Distance": 327,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTN",
    "UsesVariable": "EDTERINT",
    "Distance": 373,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTN",
    "UsesVariable": "edterintm",
    "Distance": 541,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTN",
    "UsesVariable": "GDS",
    "Distance": 1118,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTN",
    "UsesVariable": "EDPRITOT",
    "Distance": 1113,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTN",
    "UsesVariable": "EDTERTOT",
    "Distance": 1110,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTN",
    "UsesVariable": "EDEXPERPRI",
    "Distance": 1117,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTN",
    "UsesVariable": "GDPPC",
    "Distance": 1117,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTN",
    "UsesVariable": "EDSECLOWRTOT",
    "Distance": 1112,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTN",
    "UsesVariable": "EDSECUPPRTOT",
    "Distance": 1111,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTN",
    "UsesVariable": "EDEXPERTER",
    "Distance": 1114,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTN",
    "UsesVariable": "EDEXPERSECLOWR",
    "Distance": 1116,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTN",
    "UsesVariable": "EDEXPERSECUPPR",
    "Distance": 1115,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTN",
    "UsesVariable": "edpriintngr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTN",
    "UsesVariable": "edpriintntrgtyr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTN",
    "UsesVariable": "GDPPCP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTN",
    "UsesVariable": "edqtqltrm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTN",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTN",
    "UsesVariable": "edpristart",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTN",
    "UsesVariable": "EDSECLOWRTRAN",
    "Distance": 436,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTNEXT",
    "UsesVariable": "EDPRIINTN",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRIINTNEXT",
    "UsesVariable": "EDPRISUR",
    "Distance": 235,
    "Code": "0"
  },
  {
    "Variable": "EDPRIPER",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRIPER",
    "UsesVariable": "EDPRICR",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "EDPRIPER15TO19",
    "UsesVariable": "EDPRICR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRIPER15TO24",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRIPER15TO24",
    "UsesVariable": "EDPRICR",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "EDPRIPER15TO24",
    "UsesVariable": "EDPRIPER",
    "Distance": 1065,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "edprisurm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "edprisurtrgtyr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "edprisurgr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "EDSECUPPRGRATE",
    "Distance": 320,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "edsecupprgram",
    "Distance": 320,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "gdsm",
    "Distance": 320,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "EDTERGRATE",
    "Distance": 373,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "edtergradm",
    "Distance": 533,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "GDS",
    "Distance": 1119,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "EDPRITOT",
    "Distance": 1114,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "EDTERTOT",
    "Distance": 1111,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "EDEXPERPRI",
    "Distance": 1118,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "GDPPC",
    "Distance": 1118,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "EDSECLOWRTOT",
    "Distance": 1113,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "EDSECUPPRTOT",
    "Distance": 1112,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "EDEXPERTER",
    "Distance": 1115,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "EDEXPERSECLOWR",
    "Distance": 1117,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "EDEXPERSECUPPR",
    "Distance": 1116,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "GOVINDSECUR",
    "Distance": 781,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "GDPPCP",
    "Distance": 784,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "edqtqltrm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "EDPRIINT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "edpristart",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRISUR",
    "UsesVariable": "EDSECLOWRGRATE",
    "Distance": 436,
    "Code": "0"
  },
  {
    "Variable": "EDPRITOT",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRITOT",
    "UsesVariable": "EDPRIENRG",
    "Distance": 1672,
    "Code": "0"
  },
  {
    "Variable": "EDPRITOT",
    "UsesVariable": "EDPRISUR",
    "Distance": 892,
    "Code": "0"
  },
  {
    "Variable": "EDPRITOT",
    "UsesVariable": "edpristart",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDPRITOT",
    "UsesVariable": "EDPRIINT",
    "Distance": 1,
    "Code": "\r\r'first graders from the new intake rate\rpristudents(1, R%, gndr) = EDPRIINT(R%, gndr)\r"
  },
  {
    "Variable": "EDPRITOT",
    "UsesVariable": "edpriintnm",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "EDPRITOT",
    "UsesVariable": "edseclowrenrgrdm",
    "Distance": 1993,
    "Code": "0"
  },
  {
    "Variable": "EDPRITOT",
    "UsesVariable": "edprienrgrdm",
    "Distance": 1797,
    "Code": "0"
  },
  {
    "Variable": "EDPRITOT",
    "UsesVariable": "edprilen",
    "Distance": 1793,
    "Code": "0"
  },
  {
    "Variable": "EDPRITOT",
    "UsesVariable": "EDPRICR",
    "Distance": 1793,
    "Code": "0"
  },
  {
    "Variable": "EDPRITOT",
    "UsesVariable": "edpridrpgrdm",
    "Distance": 1806,
    "Code": "0"
  },
  {
    "Variable": "EDPRITOT",
    "UsesVariable": "edseclowrenrm",
    "Distance": 1994,
    "Code": "0"
  },
  {
    "Variable": "EDPRITOT",
    "UsesVariable": "edprienrm",
    "Distance": 1800,
    "Code": "0"
  },
  {
    "Variable": "EDPRITOT",
    "UsesVariable": "EDPRIDRPGRD",
    "Distance": 1917,
    "Code": "0"
  },
  {
    "Variable": "EDPRITOT",
    "UsesVariable": "edseclowrdrpgrdm",
    "Distance": 2002,
    "Code": "0"
  },
  {
    "Variable": "EDPRITOT",
    "UsesVariable": "EDSECLOWRENRGGRD",
    "Distance": 2236,
    "Code": "0"
  },
  {
    "Variable": "EDPRITOT",
    "UsesVariable": "EDSECLOWRDRPGRD",
    "Distance": 2200,
    "Code": "0"
  },
  {
    "Variable": "EDPRITOT",
    "UsesVariable": "EDPRIENRGGRD",
    "Distance": 1908,
    "Code": "0"
  },
  {
    "Variable": "EDPRITOT",
    "UsesVariable": "POPEDPRI",
    "Distance": 0,
    "Code": "\r\r'mti 2022/04/12 - start\r\r\r'                'done in ppc now\r'                'Reconcile grade specific gross enrollment rates with Levelwide rates\r'                'EDPRITOT(R%, gndr) = EDPRIENRG(R%, gndr) * POPEDPRI(R%, gndr) / 100     'mti 2021/04/27\r'                EdPriTot_From_GradeEnr = 0\r'                PopTot = 0\r'                For GCount% = 1 To edprilen(R%)\r'                    Gr_Students = fagedst(edpristart(R%) + GCount% - 1, R%, gndr%) * pristudents(GCount%, R%, gndr%) / 100\r'                    EdPriTot_From_GradeEnr = EdPriTot_From_GradeEnr + Gr_Students\r'                    PopTot = PopTot + fagedst(edpristart(R%) + GCount% - 1, R%, gndr%)\r'                    'needs to be commented (RHS is still empty); check first\r'                    drpoutgr(GCount%) = EdPriDropoutByGrade(GCount%, R%, gndr%)\r'                Next\r\r\r\r'EDPRITOT(R%, gndr) = EDPRIENRG(R%, gndr) * PopTot / 100\r\r'                Rat_Gr_Lvl = EDPRITOT(R%, gndr) / AMAX(0.000001, EdPriTot_From_GradeEnr)    'Ratio of level and grade-sum\r'       'If gndr = 1 Then Debug.Print CountryName(R%); Rat_Gr_Lvl\r'\r''If RegName(R%) = \"Austria\" Then Stop\r'\r'                If Round(Rat_Gr_Lvl, 4) <> 1 Then\r'                    For GCount% = 1 To edprilen(R%)\r'                        pristudents(GCount%, R%, gndr%) = pristudents(GCount%, R%, gndr%) * Rat_Gr_Lvl\r'                        EDPRIENRGGRD(R%, GCount%, gndr%) = pristudents(GCount%, R%, gndr%)\r'                    Next\r'                End If\r\rEDPRITOT(R%, gndr) = EDPRIENRG(R%, gndr) * POPEDPRI(R%, gndr%) / 100\r"
  },
  {
    "Variable": "EDQUALAG15",
    "UsesVariable": "EDQUALAG15PRI",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDQUALAG15",
    "UsesVariable": "EDQUALAG15SEC",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDQUALAG15",
    "UsesVariable": "edqualag15m",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDQUALAG15PRI",
    "UsesVariable": "POP",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "EDQUALAG15PRI",
    "UsesVariable": "EDQUALPRIALL",
    "Distance": 10,
    "Code": "\r\r\rFor gndr% = 1 To 2\rFor j% = 4 To NCohorts  '4 = 15-19\r'EdQualAgeDst(j%, R%, gndr%) = EDQUALAG15(R%, gndr%)\rEdQualPriAgeDst(j%, R%, gndr%) = EDQUALAG15PRI(R%, gndr%)\rEdQualSecAgeDst(j%, R%, gndr%) = EDQUALAG15SEC(R%, gndr%)\rNext j%\rNext gndr%\rCOMPLETE STRUCTURE:Next gndr:10856|\r\rFor gndr = 1 To 2\rEdQualPriAgeDst(4, R%, gndr%) = CSng(EdQualPriAgeDst(4, R%, gndr%) * 0.8 + EDQUALPRIALL(R%, gndr) * 0.2)\r"
  },
  {
    "Variable": "EDQUALAG15SEC",
    "UsesVariable": "POP",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "EDQUALAG15SEC",
    "UsesVariable": "EDQUALSECALL",
    "Distance": 10,
    "Code": "\r\r\rFor gndr% = 1 To 2\rFor j% = 4 To NCohorts  '4 = 15-19\r'EdQualAgeDst(j%, R%, gndr%) = EDQUALAG15(R%, gndr%)\rEdQualPriAgeDst(j%, R%, gndr%) = EDQUALAG15PRI(R%, gndr%)\rEdQualSecAgeDst(j%, R%, gndr%) = EDQUALAG15SEC(R%, gndr%)\rNext j%\rNext gndr%\r\rEdQualSecAgeDst(4, R%, gndr%) = CSng(EdQualSecAgeDst(4, R%, gndr%) * 0.8 + EDQUALSECALL(R%, gndr) * 0.2)\r"
  },
  {
    "Variable": "EDQUALPRIALL",
    "UsesVariable": "EDQUALPRIMATH",
    "Distance": 0,
    "Code": "\r\r\rFor gndr% = 1 To 3\r\r'            EDQUALPRIMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIMATH(R%, gndr%) * edqualpriallm(R%, gndr%)))\r'            EDQUALPRISCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRISCI(R%, gndr%) * edqualpriallm(R%, gndr%)))\r'            EDQUALPRIREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIREAD(R%, gndr%) * edqualpriallm(R%, gndr%)))\r'            EDQUALPRIALL(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIALL(R%, gndr%) * edqualpriallm(R%, gndr%))\r\rEDQUALPRIMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIMATH(R%, gndr%) * edqualprimathm(R%, gndr%)))\rEDQUALPRISCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRISCI(R%, gndr%) * edqualpriscim(R%, gndr%)))\rEDQUALPRIREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIREAD(R%, gndr%) * edqualprireadm(R%, gndr%)))\r\rEDQUALPRIALL(R%, gndr%) = AMAX(1, Amin(100, (EDQUALPRIMATH(R%, gndr%) + EDQUALPRISCI(R%, gndr%) + EDQUALPRIREAD(R%, gndr%)) / 3))\rNext gndr%\r"
  },
  {
    "Variable": "EDQUALPRIALL",
    "UsesVariable": "EDQUALPRISCI",
    "Distance": 0,
    "Code": "\r\r\rFor gndr% = 1 To 3\r\r'            EDQUALPRIMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIMATH(R%, gndr%) * edqualpriallm(R%, gndr%)))\r'            EDQUALPRISCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRISCI(R%, gndr%) * edqualpriallm(R%, gndr%)))\r'            EDQUALPRIREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIREAD(R%, gndr%) * edqualpriallm(R%, gndr%)))\r'            EDQUALPRIALL(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIALL(R%, gndr%) * edqualpriallm(R%, gndr%))\r\rEDQUALPRIMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIMATH(R%, gndr%) * edqualprimathm(R%, gndr%)))\rEDQUALPRISCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRISCI(R%, gndr%) * edqualpriscim(R%, gndr%)))\rEDQUALPRIREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIREAD(R%, gndr%) * edqualprireadm(R%, gndr%)))\r\rEDQUALPRIALL(R%, gndr%) = AMAX(1, Amin(100, (EDQUALPRIMATH(R%, gndr%) + EDQUALPRISCI(R%, gndr%) + EDQUALPRIREAD(R%, gndr%)) / 3))\rNext gndr%\r"
  },
  {
    "Variable": "EDQUALPRIALL",
    "UsesVariable": "EDQUALPRIREAD",
    "Distance": 0,
    "Code": "\r\r\rFor gndr% = 1 To 3\r\r'            EDQUALPRIMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIMATH(R%, gndr%) * edqualpriallm(R%, gndr%)))\r'            EDQUALPRISCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRISCI(R%, gndr%) * edqualpriallm(R%, gndr%)))\r'            EDQUALPRIREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIREAD(R%, gndr%) * edqualpriallm(R%, gndr%)))\r'            EDQUALPRIALL(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIALL(R%, gndr%) * edqualpriallm(R%, gndr%))\r\rEDQUALPRIMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIMATH(R%, gndr%) * edqualprimathm(R%, gndr%)))\rEDQUALPRISCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRISCI(R%, gndr%) * edqualpriscim(R%, gndr%)))\rEDQUALPRIREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIREAD(R%, gndr%) * edqualprireadm(R%, gndr%)))\r\rEDQUALPRIALL(R%, gndr%) = AMAX(1, Amin(100, (EDQUALPRIMATH(R%, gndr%) + EDQUALPRISCI(R%, gndr%) + EDQUALPRIREAD(R%, gndr%)) / 3))\rNext gndr%\r"
  },
  {
    "Variable": "EDQUALPRIALL",
    "UsesVariable": "GOVINDSECUR",
    "Distance": 594,
    "Code": "0"
  },
  {
    "Variable": "EDQUALPRIALL",
    "UsesVariable": "GDPPCP",
    "Distance": 598,
    "Code": "0"
  },
  {
    "Variable": "EDQUALPRIALL",
    "UsesVariable": "edqualprispndimp",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "EDQUALPRIALL",
    "UsesVariable": "edqualprispndimpthreshold",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "EDQUALPRIALL",
    "UsesVariable": "edqualprispndimpthresholdval",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "EDQUALPRIALL",
    "UsesVariable": "EDEXPERPRI",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "EDQUALPRIALL",
    "UsesVariable": "EDYRSAG25",
    "Distance": 19,
    "Code": "0"
  },
  {
    "Variable": "EDQUALPRIMATH",
    "UsesVariable": "edqualprimathm",
    "Distance": 0,
    "Code": "\r\r\rFor gndr% = 1 To 3\r\r'            EDQUALPRIMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIMATH(R%, gndr%) * edqualpriallm(R%, gndr%)))\r'            EDQUALPRISCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRISCI(R%, gndr%) * edqualpriallm(R%, gndr%)))\r'            EDQUALPRIREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIREAD(R%, gndr%) * edqualpriallm(R%, gndr%)))\r'            EDQUALPRIALL(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIALL(R%, gndr%) * edqualpriallm(R%, gndr%))\r\rEDQUALPRIMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIMATH(R%, gndr%) * edqualprimathm(R%, gndr%)))\rEDQUALPRISCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRISCI(R%, gndr%) * edqualpriscim(R%, gndr%)))\rEDQUALPRIREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIREAD(R%, gndr%) * edqualprireadm(R%, gndr%)))\r\rEDQUALPRIALL(R%, gndr%) = AMAX(1, Amin(100, (EDQUALPRIMATH(R%, gndr%) + EDQUALPRISCI(R%, gndr%) + EDQUALPRIREAD(R%, gndr%)) / 3))\rNext gndr%\r"
  },
  {
    "Variable": "EDQUALPRIMATH",
    "UsesVariable": "GDPPCP",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "EDQUALPRIMATH",
    "UsesVariable": "EDQUALPRIALL",
    "Distance": 0,
    "Code": "\rEDQUALPRIMATH(R%, 3) = EDQUALPRIALL(R%, 3) + EdQualPriMathShift2Tot(R%, 3)\r"
  },
  {
    "Variable": "edqualprimathm",
    "UsesVariable": "edqualpriallm",
    "Distance": 0,
    "Code": "\rFor gndr% = 1 To NGender\rIf edqualpriallm(R%, gndr%) <> 1 Then\redqualprimathm(R%, gndr%) = edqualpriallm(R%, gndr%)\redqualprireadm(R%, gndr%) = edqualpriallm(R%, gndr%)\redqualpriscim(R%, gndr%) = edqualpriallm(R%, gndr%)\rEnd If\rNext gndr\r\rIf edqualprimathm(R%, 3) <> 1 Then\redqualprimathm(R%, 1) = edqualprimathm(R%, 3)\redqualprimathm(R%, 2) = edqualprimathm(R%, 3)\rEnd If\r\rIf edqualprimathm(R%, 3) <> 1 Then\redqualprimathm(R%, 1) = edqualprimathm(R%, 3)\redqualprimathm(R%, 2) = edqualprimathm(R%, 3)\rEnd If\r"
  },
  {
    "Variable": "EDQUALPRIREAD",
    "UsesVariable": "edqualprireadm",
    "Distance": 0,
    "Code": "\r\r\rFor gndr% = 1 To 3\r\r'            EDQUALPRIMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIMATH(R%, gndr%) * edqualpriallm(R%, gndr%)))\r'            EDQUALPRISCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRISCI(R%, gndr%) * edqualpriallm(R%, gndr%)))\r'            EDQUALPRIREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIREAD(R%, gndr%) * edqualpriallm(R%, gndr%)))\r'            EDQUALPRIALL(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIALL(R%, gndr%) * edqualpriallm(R%, gndr%))\r\rEDQUALPRIMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIMATH(R%, gndr%) * edqualprimathm(R%, gndr%)))\rEDQUALPRISCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRISCI(R%, gndr%) * edqualpriscim(R%, gndr%)))\rEDQUALPRIREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIREAD(R%, gndr%) * edqualprireadm(R%, gndr%)))\r\rEDQUALPRIALL(R%, gndr%) = AMAX(1, Amin(100, (EDQUALPRIMATH(R%, gndr%) + EDQUALPRISCI(R%, gndr%) + EDQUALPRIREAD(R%, gndr%)) / 3))\rNext gndr%\r"
  },
  {
    "Variable": "EDQUALPRIREAD",
    "UsesVariable": "GDPPCP",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "EDQUALPRIREAD",
    "UsesVariable": "EDQUALPRIALL",
    "Distance": 0,
    "Code": "\r'mti 2018/06/18 End\r\r\rEDQUALPRIREAD(R%, 3) = EDQUALPRIALL(R%, 3) + EdQualPriReadShift2Tot(R%, 3)\r"
  },
  {
    "Variable": "edqualprireadm",
    "UsesVariable": "edqualpriallm",
    "Distance": 0,
    "Code": "\rFor gndr% = 1 To NGender\rIf edqualpriallm(R%, gndr%) <> 1 Then\redqualprimathm(R%, gndr%) = edqualpriallm(R%, gndr%)\redqualprireadm(R%, gndr%) = edqualpriallm(R%, gndr%)\redqualpriscim(R%, gndr%) = edqualpriallm(R%, gndr%)\rEnd If\rNext gndr\r\rIf edqualprireadm(R%, 3) <> 1 Then\redqualprireadm(R%, 1) = edqualprireadm(R%, 3)\redqualprireadm(R%, 2) = edqualprireadm(R%, 3)\rEnd If\r\rIf edqualprireadm(R%, 3) <> 1 Then\redqualprireadm(R%, 1) = edqualprireadm(R%, 3)\redqualprireadm(R%, 2) = edqualprireadm(R%, 3)\rEnd If\r"
  },
  {
    "Variable": "EDQUALPRISCI",
    "UsesVariable": "edqualpriscim",
    "Distance": 0,
    "Code": "\r\r\rFor gndr% = 1 To 3\r\r'            EDQUALPRIMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIMATH(R%, gndr%) * edqualpriallm(R%, gndr%)))\r'            EDQUALPRISCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRISCI(R%, gndr%) * edqualpriallm(R%, gndr%)))\r'            EDQUALPRIREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIREAD(R%, gndr%) * edqualpriallm(R%, gndr%)))\r'            EDQUALPRIALL(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIALL(R%, gndr%) * edqualpriallm(R%, gndr%))\r\rEDQUALPRIMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIMATH(R%, gndr%) * edqualprimathm(R%, gndr%)))\rEDQUALPRISCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRISCI(R%, gndr%) * edqualpriscim(R%, gndr%)))\rEDQUALPRIREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALPRIREAD(R%, gndr%) * edqualprireadm(R%, gndr%)))\r\rEDQUALPRIALL(R%, gndr%) = AMAX(1, Amin(100, (EDQUALPRIMATH(R%, gndr%) + EDQUALPRISCI(R%, gndr%) + EDQUALPRIREAD(R%, gndr%)) / 3))\rNext gndr%\r"
  },
  {
    "Variable": "EDQUALPRISCI",
    "UsesVariable": "GDPPCP",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "EDQUALPRISCI",
    "UsesVariable": "EDQUALPRIALL",
    "Distance": 0,
    "Code": "\rEDQUALPRISCI(R%, 3) = EDQUALPRIALL(R%, 3) + EdQualPriSciShift2Tot(R%, 3)\r"
  },
  {
    "Variable": "edqualpriscim",
    "UsesVariable": "edqualpriallm",
    "Distance": 0,
    "Code": "\rFor gndr% = 1 To NGender\rIf edqualpriallm(R%, gndr%) <> 1 Then\redqualprimathm(R%, gndr%) = edqualpriallm(R%, gndr%)\redqualprireadm(R%, gndr%) = edqualpriallm(R%, gndr%)\redqualpriscim(R%, gndr%) = edqualpriallm(R%, gndr%)\rEnd If\rNext gndr\r\rIf edqualpriscim(R%, 3) <> 1 Then\redqualpriscim(R%, 1) = edqualpriscim(R%, 3)\redqualpriscim(R%, 2) = edqualpriscim(R%, 3)\rEnd If\r\rIf edqualpriscim(R%, 3) <> 1 Then\redqualpriscim(R%, 1) = edqualpriscim(R%, 3)\redqualpriscim(R%, 2) = edqualpriscim(R%, 3)\rEnd If\r"
  },
  {
    "Variable": "EDQUALSECALL",
    "UsesVariable": "EDQUALSECMATH",
    "Distance": 0,
    "Code": "\r\r\rFor gndr% = 1 To 3\r\r'            EDQUALsecMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecMATH(R%, gndr%) * edqualsecallm(R%, gndr%)))\r'            EDQUALsecSCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecSCI(R%, gndr%) * edqualsecallm(R%, gndr%)))\r'            EDQUALsecREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecREAD(R%, gndr%) * edqualsecallm(R%, gndr%)))\r'            EDQUALsecALL(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecALL(R%, gndr%) * edqualsecallm(R%, gndr%))\r\rEDQUALSECMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALSECMATH(R%, gndr%) * edqualsecmathm(R%, gndr%)))\rEDQUALSECSCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALSECSCI(R%, gndr%) * edqualsecscim(R%, gndr%)))\rEDQUALSECREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALSECREAD(R%, gndr%) * edqualsecreadm(R%, gndr%)))\r\rEDQUALSECALL(R%, gndr%) = AMAX(1, Amin(100, (EDQUALSECMATH(R%, gndr%) + EDQUALSECSCI(R%, gndr%) + EDQUALSECREAD(R%, gndr%)) / 3))\rNext gndr%\r"
  },
  {
    "Variable": "EDQUALSECALL",
    "UsesVariable": "EDQUALSECSCI",
    "Distance": 0,
    "Code": "\r\r\rFor gndr% = 1 To 3\r\r'            EDQUALsecMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecMATH(R%, gndr%) * edqualsecallm(R%, gndr%)))\r'            EDQUALsecSCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecSCI(R%, gndr%) * edqualsecallm(R%, gndr%)))\r'            EDQUALsecREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecREAD(R%, gndr%) * edqualsecallm(R%, gndr%)))\r'            EDQUALsecALL(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecALL(R%, gndr%) * edqualsecallm(R%, gndr%))\r\rEDQUALSECMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALSECMATH(R%, gndr%) * edqualsecmathm(R%, gndr%)))\rEDQUALSECSCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALSECSCI(R%, gndr%) * edqualsecscim(R%, gndr%)))\rEDQUALSECREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALSECREAD(R%, gndr%) * edqualsecreadm(R%, gndr%)))\r\rEDQUALSECALL(R%, gndr%) = AMAX(1, Amin(100, (EDQUALSECMATH(R%, gndr%) + EDQUALSECSCI(R%, gndr%) + EDQUALSECREAD(R%, gndr%)) / 3))\rNext gndr%\r"
  },
  {
    "Variable": "EDQUALSECALL",
    "UsesVariable": "EDQUALSECREAD",
    "Distance": 0,
    "Code": "\r\r\rFor gndr% = 1 To 3\r\r'            EDQUALsecMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecMATH(R%, gndr%) * edqualsecallm(R%, gndr%)))\r'            EDQUALsecSCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecSCI(R%, gndr%) * edqualsecallm(R%, gndr%)))\r'            EDQUALsecREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecREAD(R%, gndr%) * edqualsecallm(R%, gndr%)))\r'            EDQUALsecALL(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecALL(R%, gndr%) * edqualsecallm(R%, gndr%))\r\rEDQUALSECMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALSECMATH(R%, gndr%) * edqualsecmathm(R%, gndr%)))\rEDQUALSECSCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALSECSCI(R%, gndr%) * edqualsecscim(R%, gndr%)))\rEDQUALSECREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALSECREAD(R%, gndr%) * edqualsecreadm(R%, gndr%)))\r\rEDQUALSECALL(R%, gndr%) = AMAX(1, Amin(100, (EDQUALSECMATH(R%, gndr%) + EDQUALSECSCI(R%, gndr%) + EDQUALSECREAD(R%, gndr%)) / 3))\rNext gndr%\r"
  },
  {
    "Variable": "EDQUALSECALL",
    "UsesVariable": "GOVINDSECUR",
    "Distance": 647,
    "Code": "0"
  },
  {
    "Variable": "EDQUALSECALL",
    "UsesVariable": "GDPPCP",
    "Distance": 651,
    "Code": "0"
  },
  {
    "Variable": "EDQUALSECALL",
    "UsesVariable": "edqualsecspndimp",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "EDQUALSECALL",
    "UsesVariable": "edqualsecspndimpthreshold",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "EDQUALSECALL",
    "UsesVariable": "edqualsecspndimpthresholdval",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "EDQUALSECALL",
    "UsesVariable": "EDEXPERSEC",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "EDQUALSECALL",
    "UsesVariable": "edqualsecspndimpgov",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "EDQUALSECALL",
    "UsesVariable": "GOVCORRUPT",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "EDQUALSECALL",
    "UsesVariable": "edqualprispndimp",
    "Distance": 59,
    "Code": "0"
  },
  {
    "Variable": "EDQUALSECALL",
    "UsesVariable": "edqualprispndimpthreshold",
    "Distance": 64,
    "Code": "0"
  },
  {
    "Variable": "EDQUALSECALL",
    "UsesVariable": "edqualprispndimpthresholdval",
    "Distance": 64,
    "Code": "0"
  },
  {
    "Variable": "EDQUALSECALL",
    "UsesVariable": "EDEXPERPRI",
    "Distance": 64,
    "Code": "0"
  },
  {
    "Variable": "EDQUALSECALL",
    "UsesVariable": "EDYRSAG25",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "EDQUALSECMATH",
    "UsesVariable": "edqualsecmathm",
    "Distance": 0,
    "Code": "\r\r\rFor gndr% = 1 To 3\r\r'            EDQUALsecMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecMATH(R%, gndr%) * edqualsecallm(R%, gndr%)))\r'            EDQUALsecSCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecSCI(R%, gndr%) * edqualsecallm(R%, gndr%)))\r'            EDQUALsecREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecREAD(R%, gndr%) * edqualsecallm(R%, gndr%)))\r'            EDQUALsecALL(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecALL(R%, gndr%) * edqualsecallm(R%, gndr%))\r\rEDQUALSECMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALSECMATH(R%, gndr%) * edqualsecmathm(R%, gndr%)))\rEDQUALSECSCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALSECSCI(R%, gndr%) * edqualsecscim(R%, gndr%)))\rEDQUALSECREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALSECREAD(R%, gndr%) * edqualsecreadm(R%, gndr%)))\r\rEDQUALSECALL(R%, gndr%) = AMAX(1, Amin(100, (EDQUALSECMATH(R%, gndr%) + EDQUALSECSCI(R%, gndr%) + EDQUALSECREAD(R%, gndr%)) / 3))\rNext gndr%\r"
  },
  {
    "Variable": "EDQUALSECMATH",
    "UsesVariable": "GDPPCP",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "EDQUALSECMATH",
    "UsesVariable": "EDQUALSECALL",
    "Distance": 0,
    "Code": "\rEDQUALSECMATH(R%, 3) = EDQUALSECALL(R%, 3) + EdQualSecMathShift2Tot(R%, 3)\r"
  },
  {
    "Variable": "edqualsecmathm",
    "UsesVariable": "edqualsecallm",
    "Distance": 0,
    "Code": "\rFor gndr% = 1 To NGender\rIf edqualsecallm(R%, gndr%) <> 1 Then\redqualsecmathm(R%, gndr%) = edqualsecallm(R%, gndr%)\redqualsecreadm(R%, gndr%) = edqualsecallm(R%, gndr%)\redqualsecscim(R%, gndr%) = edqualsecallm(R%, gndr%)\rEnd If\rNext gndr\r\rIf edqualsecmathm(R%, 3) <> 1 Then\redqualsecmathm(R%, 1) = edqualsecmathm(R%, 3)\redqualsecmathm(R%, 2) = edqualsecmathm(R%, 3)\rEnd If\r\rIf edqualsecmathm(R%, 3) <> 1 Then\redqualsecmathm(R%, 1) = edqualsecmathm(R%, 3)\redqualsecmathm(R%, 2) = edqualsecmathm(R%, 3)\rEnd If\r"
  },
  {
    "Variable": "EDQUALSECREAD",
    "UsesVariable": "edqualsecreadm",
    "Distance": 0,
    "Code": "\r\r\rFor gndr% = 1 To 3\r\r'            EDQUALsecMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecMATH(R%, gndr%) * edqualsecallm(R%, gndr%)))\r'            EDQUALsecSCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecSCI(R%, gndr%) * edqualsecallm(R%, gndr%)))\r'            EDQUALsecREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecREAD(R%, gndr%) * edqualsecallm(R%, gndr%)))\r'            EDQUALsecALL(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecALL(R%, gndr%) * edqualsecallm(R%, gndr%))\r\rEDQUALSECMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALSECMATH(R%, gndr%) * edqualsecmathm(R%, gndr%)))\rEDQUALSECSCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALSECSCI(R%, gndr%) * edqualsecscim(R%, gndr%)))\rEDQUALSECREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALSECREAD(R%, gndr%) * edqualsecreadm(R%, gndr%)))\r\rEDQUALSECALL(R%, gndr%) = AMAX(1, Amin(100, (EDQUALSECMATH(R%, gndr%) + EDQUALSECSCI(R%, gndr%) + EDQUALSECREAD(R%, gndr%)) / 3))\rNext gndr%\r"
  },
  {
    "Variable": "EDQUALSECREAD",
    "UsesVariable": "GDPPCP",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "EDQUALSECREAD",
    "UsesVariable": "EDQUALSECALL",
    "Distance": 0,
    "Code": "\r'mti 2018/06/18 End\r\rEDQUALSECREAD(R%, 3) = EDQUALSECALL(R%, 3) + EdQualSecReadShift2Tot(R%, 3)\r"
  },
  {
    "Variable": "edqualsecreadm",
    "UsesVariable": "edqualsecallm",
    "Distance": 0,
    "Code": "\rFor gndr% = 1 To NGender\rIf edqualsecallm(R%, gndr%) <> 1 Then\redqualsecmathm(R%, gndr%) = edqualsecallm(R%, gndr%)\redqualsecreadm(R%, gndr%) = edqualsecallm(R%, gndr%)\redqualsecscim(R%, gndr%) = edqualsecallm(R%, gndr%)\rEnd If\rNext gndr\r\rIf edqualsecreadm(R%, 3) <> 1 Then\redqualsecreadm(R%, 1) = edqualsecreadm(R%, 3)\redqualsecreadm(R%, 2) = edqualsecreadm(R%, 3)\rEnd If\r\rIf edqualsecreadm(R%, 3) <> 1 Then\redqualsecreadm(R%, 1) = edqualsecreadm(R%, 3)\redqualsecreadm(R%, 2) = edqualsecreadm(R%, 3)\rEnd If\r"
  },
  {
    "Variable": "EDQUALSECSCI",
    "UsesVariable": "edqualsecscim",
    "Distance": 0,
    "Code": "\r\r\rFor gndr% = 1 To 3\r\r'            EDQUALsecMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecMATH(R%, gndr%) * edqualsecallm(R%, gndr%)))\r'            EDQUALsecSCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecSCI(R%, gndr%) * edqualsecallm(R%, gndr%)))\r'            EDQUALsecREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecREAD(R%, gndr%) * edqualsecallm(R%, gndr%)))\r'            EDQUALsecALL(R%, gndr%) = AMAX(1, Amin(100, EDQUALsecALL(R%, gndr%) * edqualsecallm(R%, gndr%))\r\rEDQUALSECMATH(R%, gndr%) = AMAX(1, Amin(100, EDQUALSECMATH(R%, gndr%) * edqualsecmathm(R%, gndr%)))\rEDQUALSECSCI(R%, gndr%) = AMAX(1, Amin(100, EDQUALSECSCI(R%, gndr%) * edqualsecscim(R%, gndr%)))\rEDQUALSECREAD(R%, gndr%) = AMAX(1, Amin(100, EDQUALSECREAD(R%, gndr%) * edqualsecreadm(R%, gndr%)))\r\rEDQUALSECALL(R%, gndr%) = AMAX(1, Amin(100, (EDQUALSECMATH(R%, gndr%) + EDQUALSECSCI(R%, gndr%) + EDQUALSECREAD(R%, gndr%)) / 3))\rNext gndr%\r"
  },
  {
    "Variable": "EDQUALSECSCI",
    "UsesVariable": "GDPPCP",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "EDQUALSECSCI",
    "UsesVariable": "EDQUALSECALL",
    "Distance": 0,
    "Code": "\rEDQUALSECSCI(R%, 3) = EDQUALSECALL(R%, 3) + EdQualSecSciShift2Tot(R%, 3)\r"
  },
  {
    "Variable": "edqualsecscim",
    "UsesVariable": "edqualsecallm",
    "Distance": 0,
    "Code": "\rFor gndr% = 1 To NGender\rIf edqualsecallm(R%, gndr%) <> 1 Then\redqualsecmathm(R%, gndr%) = edqualsecallm(R%, gndr%)\redqualsecreadm(R%, gndr%) = edqualsecallm(R%, gndr%)\redqualsecscim(R%, gndr%) = edqualsecallm(R%, gndr%)\rEnd If\rNext gndr\r\rIf edqualsecscim(R%, 3) <> 1 Then\redqualsecscim(R%, 1) = edqualsecscim(R%, 3)\redqualsecscim(R%, 2) = edqualsecscim(R%, 3)\rEnd If\r\rIf edqualsecscim(R%, 3) <> 1 Then\redqualsecscim(R%, 1) = edqualsecscim(R%, 3)\redqualsecscim(R%, 2) = edqualsecscim(R%, 3)\rEnd If\r"
  },
  {
    "Variable": "EDSECENRG",
    "UsesVariable": "EDSECTOT",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDSECENRG",
    "UsesVariable": "POP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDSECENRG",
    "UsesVariable": "edseclowrlen",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "EDSECENRG",
    "UsesVariable": "edsecupprlen",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "EDSECENRN",
    "UsesVariable": "EDSECENRG",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECENRN",
    "UsesVariable": "edseclowrlen",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "EDSECENRN",
    "UsesVariable": "edsecupprlen",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRDRPGRD",
    "UsesVariable": "edseclowrlen",
    "Distance": 0,
    "Code": "\rDim Pupils_Total = Pupils_Male + Pupils_Female\r\rDim Pupils_Female = EDSECLOWRENRGGRD(R%, GCount%, Female) * fagedst(seclowrStart + GCount% - 1, R%, Female)\r\r\r'mti 2020/09/01  Start\rFor GCount% = 1 To CInt(edseclowrlen(R%)) '+ 1 To NPriGr\rDim Pupils_Male = EDSECLOWRENRGGRD(R%, GCount%, Male) * fagedst(seclowrStart + GCount% - 1, R%, Male)\r\r\rIf GCount% < edseclowrlen(R%) Then\rEDSECLOWRDRPGRD(R%, GCount%, Total) = CSng((EDSECLOWRDRPGRD(R%, GCount%, Male) * Pupils_Male + EDSECLOWRDRPGRD(R%, GCount%, Female) * Pupils_Female) / AMAX(0.000001, Pupils_Total))\rEnd If\r"
  },
  {
    "Variable": "EDSECLOWRDRPGRD",
    "UsesVariable": "EDSECLOWRENRGGRD",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRDRPGRD",
    "UsesVariable": "POP",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRDRPGRD",
    "UsesVariable": "edpristart",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRDRPGRD",
    "UsesVariable": "edprilen",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRDRPGRD",
    "UsesVariable": "edseclowrdrpgrdm",
    "Distance": 1,
    "Code": "\r'mti 2023/12/01 end\r\r\r'mti 2024/01/24 start - need to take the save for next year code after its use below\r'save for next year\r'sEdSecLowrSur(R%, gndr%) = EDSECLOWRSUR(R%, gndr%)      'note, survival is a computed variable now;\r'it needs to get budget and scenario driver impacts though (same as grate?)\r'mti 2024/01/24 end\r\r\rFor GCount% = 1 To CInt(edseclowrlen(R%)) '\rIf ilEdSecLowrSur(R%, gndr%) < 90 Then\rEdSecLowrDropoutByGrade(GCount%, R%, gndr%) = CSng(AMAX(0, Amin(0.9, i1EdSecLowrDropoutByGrade(GCount%, R%, gndr%) + SurvTrgtCovd * (0 - i1EdSecLowrDropoutByGrade(GCount%, R%, gndr%))))) 'AMAX(0, (can be in both direction)\rElse\rEdSecLowrDropoutByGrade(GCount%, R%, gndr%) = ConvergeOverTime1(i1EdSecLowrDropoutByGrade(GCount%, R%, gndr%), 0, 15)\rEnd If\r'mti 2022/04/12 start\rEdSecLowrDropoutByGrade(GCount%, R%, gndr%) = CSng(AMAX(0, Amin(0.9, EdSecLowrDropoutByGrade(GCount%, R%, gndr%) * If(edseclowrdrpgrdm(R%, NGender) <> 1, edseclowrdrpgrdm(R%, NGender), edseclowrdrpgrdm(R%, gndr)))))\r'mti 2022/04/12 end 'grate impact?\r\rEDSECLOWRDRPGRD(R%, GCount%, gndr%) = EdSecLowrDropoutByGrade(GCount%, R%, gndr%)\rNext GCount%\r\r'mti 2023/12/01 end\r\r\r'mti 2024/01/24 start - need to take the save for next year code after its use below\r'save for next year\r'sEdSecLowrSur(R%, gndr%) = EDSECLOWRSUR(R%, gndr%)      'note, survival is a computed variable now;\r'it needs to get budget and scenario driver impacts though (same as grate?)\r'mti 2024/01/24 end\r\r\rFor GCount% = 1 To CInt(edseclowrlen(R%)) '\rIf ilEdSecLowrSur(R%, gndr%) < 90 Then\rEdSecLowrDropoutByGrade(GCount%, R%, gndr%) = CSng(AMAX(0, Amin(0.9, i1EdSecLowrDropoutByGrade(GCount%, R%, gndr%) + SurvTrgtCovd * (0 - i1EdSecLowrDropoutByGrade(GCount%, R%, gndr%))))) 'AMAX(0, (can be in both direction)\rElse\rEdSecLowrDropoutByGrade(GCount%, R%, gndr%) = ConvergeOverTime1(i1EdSecLowrDropoutByGrade(GCount%, R%, gndr%), 0, 15)\rEnd If\r'mti 2022/04/12 start\rEdSecLowrDropoutByGrade(GCount%, R%, gndr%) = CSng(AMAX(0, Amin(0.9, EdSecLowrDropoutByGrade(GCount%, R%, gndr%) * If(edseclowrdrpgrdm(R%, NGender) <> 1, edseclowrdrpgrdm(R%, NGender), edseclowrdrpgrdm(R%, gndr)))))\r'mti 2022/04/12 end 'grate impact?\r\rEDSECLOWRDRPGRD(R%, GCount%, gndr%) = EdSecLowrDropoutByGrade(GCount%, R%, gndr%)\rNext GCount%\r\r'mti 2023/12/01 end\r\r\r'mti 2024/01/24 start - need to take the save for next year code after its use below\r'save for next year\r'sEdSecLowrSur(R%, gndr%) = EDSECLOWRSUR(R%, gndr%)      'note, survival is a computed variable now;\r'it needs to get budget and scenario driver impacts though (same as grate?)\r'mti 2024/01/24 end\r\r\rFor GCount% = 1 To CInt(edseclowrlen(R%)) '\rIf ilEdSecLowrSur(R%, gndr%) < 90 Then\rEdSecLowrDropoutByGrade(GCount%, R%, gndr%) = CSng(AMAX(0, Amin(0.9, i1EdSecLowrDropoutByGrade(GCount%, R%, gndr%) + SurvTrgtCovd * (0 - i1EdSecLowrDropoutByGrade(GCount%, R%, gndr%))))) 'AMAX(0, (can be in both direction)\rElse\rEdSecLowrDropoutByGrade(GCount%, R%, gndr%) = ConvergeOverTime1(i1EdSecLowrDropoutByGrade(GCount%, R%, gndr%), 0, 15)\rEnd If\r'mti 2022/04/12 start\rEdSecLowrDropoutByGrade(GCount%, R%, gndr%) = CSng(AMAX(0, Amin(0.9, EdSecLowrDropoutByGrade(GCount%, R%, gndr%) * If(edseclowrdrpgrdm(R%, NGender) <> 1, edseclowrdrpgrdm(R%, NGender), edseclowrdrpgrdm(R%, gndr)))))\r'mti 2022/04/12 end 'grate impact?\r\rEDSECLOWRDRPGRD(R%, GCount%, gndr%) = EdSecLowrDropoutByGrade(GCount%, R%, gndr%)\rNext GCount%\r"
  },
  {
    "Variable": "EDSECLOWRENRG",
    "UsesVariable": "EDSECLOWRTOT",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRENRG",
    "UsesVariable": "POP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRENRG",
    "UsesVariable": "POPEDSECLOWR",
    "Distance": 1885,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRENRG",
    "UsesVariable": "edseclowrlen",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRENRG",
    "UsesVariable": "edpristart",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRENRG",
    "UsesVariable": "edprilen",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRENRGGRD",
    "UsesVariable": "POP",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRENRGGRD",
    "UsesVariable": "edpristart",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRENRGGRD",
    "UsesVariable": "edprilen",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRENRGGRD",
    "UsesVariable": "edseclowrenrgrdm",
    "Distance": 4,
    "Code": "\rseclowrstudents(GCount%, R%, gndr) = seclowrstudents(GCount%, R%, gndr) * Amin(3, AMAX(0.05, If(edseclowrenrm(R%, NGender) <> 1, edseclowrenrm(R%, NGender), edseclowrenrm(R%, gndr))))\r\r'mti 2022/04/12 End\r\rNext\r'mti 2023/12/01 end\r\r'grade-specific parameter\r'mti 2023/11/01 - why not looping over all grades\rseclowrstudents(GCount%, R%, gndr%) = seclowrstudents(GCount%, R%, gndr%) * If(edseclowrenrgrdm(R%, NGender) <> 1, edseclowrenrgrdm(R%, NGender), edseclowrenrgrdm(R%, gndr))\rCOMPLETE STRUCTURE:Next gndr:8744|\rNext\r\rFor GCount% = 1 To CInt(edseclowrlen(R%))\rEDSECLOWRENRGGRD(R%, GCount%, gndr%) = seclowrstudents(GCount%, R%, gndr%)\r"
  },
  {
    "Variable": "EDSECLOWRENRGGRD",
    "UsesVariable": "edseclowrenrm",
    "Distance": 5,
    "Code": "\rseclowrstudents(GCount%, R%, gndr) = seclowrstudents(GCount%, R%, gndr) + SaveStudentCohorts(R%, GCount%, gndr, SecLowr) * RptGr(GCount%)\r"
  },
  {
    "Variable": "EDSECLOWRENRGGRD",
    "UsesVariable": "edseclowrdrpgrdm",
    "Distance": 13,
    "Code": "\r'mti 2023/12/01 end\r\r\r'mti 2024/01/24 start - need to take the save for next year code after its use below\r'save for next year\r'sEdSecLowrSur(R%, gndr%) = EDSECLOWRSUR(R%, gndr%)      'note, survival is a computed variable now;\r'it needs to get budget and scenario driver impacts though (same as grate?)\r'mti 2024/01/24 end\r\r\rFor GCount% = 1 To CInt(edseclowrlen(R%)) '\rIf ilEdSecLowrSur(R%, gndr%) < 90 Then\rEdSecLowrDropoutByGrade(GCount%, R%, gndr%) = CSng(AMAX(0, Amin(0.9, i1EdSecLowrDropoutByGrade(GCount%, R%, gndr%) + SurvTrgtCovd * (0 - i1EdSecLowrDropoutByGrade(GCount%, R%, gndr%))))) 'AMAX(0, (can be in both direction)\rElse\rEdSecLowrDropoutByGrade(GCount%, R%, gndr%) = ConvergeOverTime1(i1EdSecLowrDropoutByGrade(GCount%, R%, gndr%), 0, 15)\rEnd If\r'mti 2022/04/12 start\rEdSecLowrDropoutByGrade(GCount%, R%, gndr%) = CSng(AMAX(0, Amin(0.9, EdSecLowrDropoutByGrade(GCount%, R%, gndr%) * If(edseclowrdrpgrdm(R%, NGender) <> 1, edseclowrdrpgrdm(R%, NGender), edseclowrdrpgrdm(R%, gndr)))))\r'mti 2022/04/12 end 'grate impact?\r\rEDSECLOWRDRPGRD(R%, GCount%, gndr%) = EdSecLowrDropoutByGrade(GCount%, R%, gndr%)\rNext GCount%\rCOMPLETE STRUCTURE:End If:8461|\r\r' If GRPS(1,R%) = \"Thailand\" Then Stop\r\r'---------- Grade-specific enrollment and dropout -------\r'Grade-specific gross enrollment rate\rIf EDSECLOWRENRGGRD(R%, 1, gndr%) > 0 And EDSECLOWRENRGGRD(R%, 1, gndr%) < 999 Then\r'already initialized with historical in pre-processor\rFor GCount% = 1 To CInt(edseclowrlen(R%))\rseclowrstudents(GCount%, R%, gndr%) = EDSECLOWRENRGGRD(R%, GCount%, gndr%)  'Load intermediate variables (not needed; ultimately)\r\r\r'                EdSecLowrTot_From_GradeEnr = 0\r'                PopTot = 0\r'                For GCount% = 1 To edseclowrlen(R%)\r'\r'                    Gr_Students = fagedst(edpristart(R%) + edprilen(R%) + GCount% - 1, R%, gndr%) * seclowrstudents(GCount%, R%, gndr%) / 100\r'                    EdSecLowrTot_From_GradeEnr = EdSecLowrTot_From_GradeEnr + Gr_Students\r'                    PopTot = PopTot + fagedst(edpristart(R%) + edprilen(R%) + GCount% - 1, R%, gndr%)\r'                Next\r'\r'                EDSECLOWRTOT(R%, gndr) = EDSECLOWRENRG(R%, gndr) * PopTot / 100    'mti 2021/04/27\r'\r'                Rat_Gr_Lvl = EDSECLOWRTOT(R%, gndr) * (1 - EDSECLOWRVOC(R%, gndr%) / 100) / AMAX(0.000001, EdSecLowrTot_From_GradeEnr)\r'\r'          'If RegName(R%) = \"Angola\" Then Stop\r''          If RegName(R%) = \"Cambodia\" Then Stop\r'\r'                If Round(Rat_Gr_Lvl, 4) <> 1 Then\r'                    For GCount% = 1 To edseclowrlen(R%)\r'                        seclowrstudents(GCount%, R%, gndr%) = seclowrstudents(GCount%, R%, gndr%) * Rat_Gr_Lvl\r'\r'                        EDSECLOWRENRGGRD(R%, GCount%, gndr%) = seclowrstudents(GCount%, R%, gndr%)\r'\r'                        'SaveStudentCohorts(R%, GCount%, gndr, SecLowr) = seclowrstudents(GCount%, R%, gndr)\r'                    Next\r'                End If\r\r'mti 2022/04/12 - End\r\r\r'Unused Grade Variables set to 0\rFor GCount% = CInt(edseclowrlen(R%) + 1) To NPriGr\rseclowrstudents(GCount%, R%, gndr%) = 0\r\rNext\rilEdSecLowrSur(R%, gndr%) = EDSECLOWRSUR(R%, gndr%)\r\r'mti 2024/01/24 End\r\r'mti 2023/12/01 start\r'If GRPS(1, R) = \"India\" And gndr = 2 Then Stop\rFor GCount% = 2 To CInt(edseclowrlen(R%))  'mti 2021/05/06\r'If GRPS(1, R%) = \"China\" And gndr = 1 And GCount% = CInt(edseclowrlen(R%)) Then Stop\rIf seclowrstudents(GCount%, R%, gndr%) = 0 Then\rEdSecLowrRptrGr(GCount%, R%, gndr) = 0\rElse\rEdSecLowrRptrGr(GCount%, R%, gndr) = CSng(Amin(0.9, AMAX(0, (EDSECLOWRENRGGRD(R%, GCount%, gndr%) -\r                                                    (EDSECLOWRENRGGRD(R%, GCount% - 1, gndr%) *\r                                                    AMAX(0.001, (1 - EDSECLOWRDRPGRD(R%, GCount% - 1, gndr%) -\r                                                    EdSecLowrRptrGr(GCount% - 1, R%, gndr))))) / EDSECLOWRENRGGRD(R%, GCount%, gndr%))))\rEnd If\rCOMPLETE STRUCTURE:End If:8461|\r\r' If GRPS(1,R%) = \"Thailand\" Then Stop\r\r'---------- Grade-specific enrollment and dropout -------\r'Grade-specific gross enrollment rate\rIf EDSECLOWRENRGGRD(R%, 1, gndr%) > 0 And EDSECLOWRENRGGRD(R%, 1, gndr%) < 999 Then\r'already initialized with historical in pre-processor\rFor GCount% = 1 To CInt(edseclowrlen(R%))\rseclowrstudents(GCount%, R%, gndr%) = EDSECLOWRENRGGRD(R%, GCount%, gndr%)  'Load intermediate variables (not needed; ultimately)\r\r\r'                EdSecLowrTot_From_GradeEnr = 0\r'                PopTot = 0\r'                For GCount% = 1 To edseclowrlen(R%)\r'\r'                    Gr_Students = fagedst(edpristart(R%) + edprilen(R%) + GCount% - 1, R%, gndr%) * seclowrstudents(GCount%, R%, gndr%) / 100\r'                    EdSecLowrTot_From_GradeEnr = EdSecLowrTot_From_GradeEnr + Gr_Students\r'                    PopTot = PopTot + fagedst(edpristart(R%) + edprilen(R%) + GCount% - 1, R%, gndr%)\r'                Next\r'\r'                EDSECLOWRTOT(R%, gndr) = EDSECLOWRENRG(R%, gndr) * PopTot / 100    'mti 2021/04/27\r'\r'                Rat_Gr_Lvl = EDSECLOWRTOT(R%, gndr) * (1 - EDSECLOWRVOC(R%, gndr%) / 100) / AMAX(0.000001, EdSecLowrTot_From_GradeEnr)\r'\r'          'If RegName(R%) = \"Angola\" Then Stop\r''          If RegName(R%) = \"Cambodia\" Then Stop\r'\r'                If Round(Rat_Gr_Lvl, 4) <> 1 Then\r'                    For GCount% = 1 To edseclowrlen(R%)\r'                        seclowrstudents(GCount%, R%, gndr%) = seclowrstudents(GCount%, R%, gndr%) * Rat_Gr_Lvl\r'\r'                        EDSECLOWRENRGGRD(R%, GCount%, gndr%) = seclowrstudents(GCount%, R%, gndr%)\r'\r'                        'SaveStudentCohorts(R%, GCount%, gndr, SecLowr) = seclowrstudents(GCount%, R%, gndr)\r'                    Next\r'                End If\r\r'mti 2022/04/12 - End\r\r\r'Unused Grade Variables set to 0\rFor GCount% = CInt(edseclowrlen(R%) + 1) To NPriGr\rseclowrstudents(GCount%, R%, gndr%) = 0\r\r\r'If GRPS(1, R) = \"Congo\" And gndr = 1 Then Stop\r\r'mti 2023/12/01 start\r'Repeaters as a share of grade enrollment (with constant grade-enrollment assumption)\rFor GCount% = 1 To CInt(edseclowrlen(R%))\rIf ilEdSecLowrSur(R%, gndr%) < 99 And EdSecLowrRptrGr(GCount%, R%, gndr) > 0 Then '95 'mti 2023/12/01 was 95\rRptGr(GCount%) = ConvergeOverPath(EdSecLowrRptrGr(GCount%, R%, gndr), 0, sEdSecLowrSur(R%, gndr%), ilEdSecLowrSur(R%, gndr%), 100)   '95\rElse\rRptGr(GCount%) = ConvergeOverTime1(EdSecLowrRptrGr(GCount%, R%, gndr), 0, 10) 'was 5\rEnd If\rNext GCount%\r\r'mti 2023/12/01 end\r\r\r'mti 2024/01/24 start - need to take the save for next year code after its use below\r'save for next year\r'sEdSecLowrSur(R%, gndr%) = EDSECLOWRSUR(R%, gndr%)      'note, survival is a computed variable now;\r'it needs to get budget and scenario driver impacts though (same as grate?)\r'mti 2024/01/24 end\r\r\rFor GCount% = 1 To CInt(edseclowrlen(R%)) '\rIf ilEdSecLowrSur(R%, gndr%) < 90 Then\rEdSecLowrDropoutByGrade(GCount%, R%, gndr%) = CSng(AMAX(0, Amin(0.9, i1EdSecLowrDropoutByGrade(GCount%, R%, gndr%) + SurvTrgtCovd * (0 - i1EdSecLowrDropoutByGrade(GCount%, R%, gndr%))))) 'AMAX(0, (can be in both direction)\rElse\rEdSecLowrDropoutByGrade(GCount%, R%, gndr%) = ConvergeOverTime1(i1EdSecLowrDropoutByGrade(GCount%, R%, gndr%), 0, 15)\rEnd If\r'mti 2022/04/12 start\rEdSecLowrDropoutByGrade(GCount%, R%, gndr%) = CSng(AMAX(0, Amin(0.9, EdSecLowrDropoutByGrade(GCount%, R%, gndr%) * If(edseclowrdrpgrdm(R%, NGender) <> 1, edseclowrdrpgrdm(R%, NGender), edseclowrdrpgrdm(R%, gndr)))))\r'mti 2022/04/12 end 'grate impact?\r\rEDSECLOWRDRPGRD(R%, GCount%, gndr%) = EdSecLowrDropoutByGrade(GCount%, R%, gndr%)\rNext GCount%\r\r'mti 2022/04/12 end\r\r\r'             'before procedure: seclowrstudents() = gradewise students from the previous year; SaveSecLowUpStudentCohorts = supposed to save seclowrstudents () for post budget allocation use\r'             Call GradeWiseEnrollmentCalc(R%, gndr, secStart(R%), cint(edseclowrlen(R%)), caledsecint, SRate, _\r'                seclowrstudents(), SaveSecLowUpStudentCohorts(), 1, EDSECLOWRTOT(R%, gndr), Dropoutrate, True)\r'            'after procedure: seclowrstudents() = gradewise students this year (pre-budget); SaveSecLowUpStudentCohorts = gradewise students from the previous year\r'             'mti 2016/12/09 End\r\rFor GCount% = 1 To CInt(edseclowrlen(R%)) 'save last year's grade specific enrollment for post budget use\rSaveStudentCohorts(R%, GCount%, gndr, SecLowr) = seclowrstudents(GCount%, R%, gndr)\r\r\r\r'gender parity parameters\rGenderParityCalc(edsecupprgndreqtran(R%), EDSECUPPRTRAN(R%, Male), EDSECUPPRTRAN(R%, Female), \"SecUppr\")\rGenderParityCalc(edsecupprgndreqgrad(R%), EDSECUPPRGRATE(R%, Male), EDSECUPPRGRATE(R%, Female), \"SecUppr\")\r\r\rFor gndr = 1 To NGender - 1\r'mti 2023/11/28 end\r\r'save flow rates for multiplier calculation later\riEdIntk(R%, gndr, SecUppr) = EDSECUPPRTRAN(R%, gndr)\r\r\riEdSurv(R%, gndr, SecUppr) = EDSECUPPRGRATE(R%, gndr) ' EDSECUPPRSUR(R%, gndr)\r\r'All years but first: Upper Secondary Initial: calculate intake using last year's lower secondary final grade and transition rate this year\r\r'All years but first: Upper Secondary Initial: School-age population\r'            secupprpop(R%, gndr) = CalcPopFrom1Year(secStart + edseclowrlen(R%), edsecupprlen(R%), R%, gndr)\r\r'make both general and vocational from lower available for upper general\r'            If edseclowrtrancap(R%) = 1 Then 'vocational/general split at the first grade\r'            'mti 2014/03/27 - start\r'                Add2Final = sEdSecLowrShareVoc(R%, gndr) * (sedseclowrenrg(R%, gndr%) / 100)\r'            Else  'vocational general split later; more vocational in later grades (than in earlier grades)\r'                Add2Final = sEdSecLowrShareVoc(R%, gndr) * (sedseclowrenrg(R%, gndr%) / 100) '* ConvergeOverTime(1.8, 1.2, 15) ' 1.8\r'            End If\r\r'caledsecint = (FinalGrade(SecLowr, gndr) + Add2Final) * EDSECUPPRTRAN(R%, gndr) / 100\r'caledsecint = (SaveSecLowUpStudentCohorts(R%, cint(edseclowrlen(R%)), gndr, 1) + Add2Final) * EDSECUPPRTRAN(R%, gndr) / 100\rcaledsecint = SaveSecLowUpStudentCohorts(R%, CInt(edseclowrlen(R%)), gndr, 1) * EDSECUPPRTRAN(R%, gndr) / 100\r'mti December 11, 2008 - end\r\r\r'All years but first: Upper Secondary Initial: Total Students\r'Call GradeWiseEnrollmentCalc(R%, gndr, secStart(R%) + edseclowrlen(R%), edsecupprlen(R%), caledsecint, EDSECUPPRSUR(R%, gndr), _\r'secupprstudents(), SaveSecLowUpStudentCohorts(), 2, EdSecTot_Gen, , True)\r\r\r'SRate = 100 * EDSECUPPRGRATE(R%, gndr) / caledsecint\rDropoutrate = CSng(AMAX(0, 1 - (EDSECUPPRGRATE(R%, gndr) / caledsecint) ^ (1 / edsecupprlen(R%))))\r\r'mti 2023/11/28 start\rFor GCount% = 1 To CInt(edsecupprlen(R%)) 'save last year's grade specific enrollment for post budget use\rSaveStudentCohorts(R%, GCount%, gndr, SecUppr) = secupprstudents(GCount%, R%, gndr)\rNext\r'mti 2023/11/28 end\r\rCall GradeWiseEnrollmentCalc(R%, gndr, secStart(R%) + edseclowrlen(R%), edsecupprlen(R%), caledsecint, 0,\r                    secupprstudents, SaveSecLowUpStudentCohorts, 2, EDSECUPPRTOT(R%, gndr), Dropoutrate, True)\r'mti 2014/03/27 - start\r'Vocational share (of total, i.e., gen + voc)) is forecast as constant (=initial val.) or constant * multiplier; capping at 70% as the maximum share\r'            If edsecupprvocm(R%, Total) <> 1 Or edsecupprvocm(R%, gndr) <> 1 Then\r'                EDSECUPPRVOCI(R%, gndr) = AMAX(EDSECUPPRVOCI(R%, gndr), 0.01)  'multiplier won't work for zero, so give a small value\r'            End If\r\rEDSECUPPRVOC(R%, gndr) = AMAX(0, Amin(70, EDSECUPPRVOCI(R%, gndr) + If(edsecupprvocadd(R%, Total) <> 0, edsecupprvocadd(R%, Total), edsecupprvocadd(R%, gndr))))\r\r'All years but first: Upper Secondary Initial: Add Vocational\r'EDSECUPPRTOT(R%, gndr) = EdSecTot_Gen + secupprpop(R%, gndr) * sEdSecUpprShareVoc(R%, gndr) / 100\r'EDSECUPPRTOT(R%, gndr) = EdSecTot_Gen / (1 - EDSECUPPRVOC(R%, gndr) / 100)\r\r'mti October 2008 adjust for shift, or total students for budget'll be less\r'EDSECUPPRTOT(R%, gndr) = EDSECUPPRTOT(R%, gndr) + secupprpop(R%, gndr) * (ConvergeOverTimeSmooth(edsecUpprenrgshift(R%, gndr), 0, edsecUpprenrgshiftCur(R%, gndr), False) / 100) '25\rEDSECUPPRTOT(R%, gndr) = EDSECUPPRTOT(R%, gndr) + secupprpop(R%, gndr) * edsecUpprenrgshiftCur(R%, gndr) / 100\r'-- Demand determined (constrained with multiplier) transition, survival and gross enrollment ----------------\r\r\r'Constrain the total enrollment for budget demand only : it is not necessary to adjust intake/survival here\r'mti 2022/04/12 start\r'EDSECUPPRTOT(R%, gndr) = Amin(1.5 * secupprpop(R%, gndr), EDSECUPPRTOT(R%, gndr))\rEDSECUPPRTOT(R%, gndr) = CSng(AMAX(0.01 * secupprpop(R%, gndr), Amin(1.5 * secupprpop(R%, gndr), EDSECUPPRTOT(R%, gndr))))\r'mti 2022/04/12 End\r'mti 2014/03/27 - end\r\r'commented october 2008\r'All years but first: Upper Secondary Initial: add each gender to total students and graduates\r'EDSECUPPRTOT(R%, Total) = EDSECUPPRTOT(R%, Total) + EDSECUPPRTOT(R%, gndr)\r\rNext gndr\r\rNext R%\r\r\r'If GRPS(1, R) = \"Congo\" And gndr = 1 Then Stop\r\r'mti 2023/12/01 start\r'Repeaters as a share of grade enrollment (with constant grade-enrollment assumption)\rFor GCount% = 1 To CInt(edseclowrlen(R%))\rIf ilEdSecLowrSur(R%, gndr%) < 99 And EdSecLowrRptrGr(GCount%, R%, gndr) > 0 Then '95 'mti 2023/12/01 was 95\rRptGr(GCount%) = ConvergeOverPath(EdSecLowrRptrGr(GCount%, R%, gndr), 0, sEdSecLowrSur(R%, gndr%), ilEdSecLowrSur(R%, gndr%), 100)   '95\rElse\rRptGr(GCount%) = ConvergeOverTime1(EdSecLowrRptrGr(GCount%, R%, gndr), 0, 10) 'was 5\rEnd If\rNext GCount%\r\r'mti 2022/04/12 end\r\r\r'             'before procedure: seclowrstudents() = gradewise students from the previous year; SaveSecLowUpStudentCohorts = supposed to save seclowrstudents () for post budget allocation use\r'             Call GradeWiseEnrollmentCalc(R%, gndr, secStart(R%), cint(edseclowrlen(R%)), caledsecint, SRate, _\r'                seclowrstudents(), SaveSecLowUpStudentCohorts(), 1, EDSECLOWRTOT(R%, gndr), Dropoutrate, True)\r'            'after procedure: seclowrstudents() = gradewise students this year (pre-budget); SaveSecLowUpStudentCohorts = gradewise students from the previous year\r'             'mti 2016/12/09 End\r\rFor GCount% = 1 To CInt(edseclowrlen(R%)) 'save last year's grade specific enrollment for post budget use\rSaveStudentCohorts(R%, GCount%, gndr, SecLowr) = seclowrstudents(GCount%, R%, gndr)\r\r\r\r'gender parity parameters\rGenderParityCalc(edsecupprgndreqtran(R%), EDSECUPPRTRAN(R%, Male), EDSECUPPRTRAN(R%, Female), \"SecUppr\")\rGenderParityCalc(edsecupprgndreqgrad(R%), EDSECUPPRGRATE(R%, Male), EDSECUPPRGRATE(R%, Female), \"SecUppr\")\r\r\rFor gndr = 1 To NGender - 1\r'mti 2023/11/28 end\r\r'save flow rates for multiplier calculation later\riEdIntk(R%, gndr, SecUppr) = EDSECUPPRTRAN(R%, gndr)\r\r\riEdSurv(R%, gndr, SecUppr) = EDSECUPPRGRATE(R%, gndr) ' EDSECUPPRSUR(R%, gndr)\r\r'All years but first: Upper Secondary Initial: calculate intake using last year's lower secondary final grade and transition rate this year\r\r'All years but first: Upper Secondary Initial: School-age population\r'            secupprpop(R%, gndr) = CalcPopFrom1Year(secStart + edseclowrlen(R%), edsecupprlen(R%), R%, gndr)\r\r'make both general and vocational from lower available for upper general\r'            If edseclowrtrancap(R%) = 1 Then 'vocational/general split at the first grade\r'            'mti 2014/03/27 - start\r'                Add2Final = sEdSecLowrShareVoc(R%, gndr) * (sedseclowrenrg(R%, gndr%) / 100)\r'            Else  'vocational general split later; more vocational in later grades (than in earlier grades)\r'                Add2Final = sEdSecLowrShareVoc(R%, gndr) * (sedseclowrenrg(R%, gndr%) / 100) '* ConvergeOverTime(1.8, 1.2, 15) ' 1.8\r'            End If\r\r'caledsecint = (FinalGrade(SecLowr, gndr) + Add2Final) * EDSECUPPRTRAN(R%, gndr) / 100\r'caledsecint = (SaveSecLowUpStudentCohorts(R%, cint(edseclowrlen(R%)), gndr, 1) + Add2Final) * EDSECUPPRTRAN(R%, gndr) / 100\rcaledsecint = SaveSecLowUpStudentCohorts(R%, CInt(edseclowrlen(R%)), gndr, 1) * EDSECUPPRTRAN(R%, gndr) / 100\r'mti December 11, 2008 - end\r\r\r'All years but first: Upper Secondary Initial: Total Students\r'Call GradeWiseEnrollmentCalc(R%, gndr, secStart(R%) + edseclowrlen(R%), edsecupprlen(R%), caledsecint, EDSECUPPRSUR(R%, gndr), _\r'secupprstudents(), SaveSecLowUpStudentCohorts(), 2, EdSecTot_Gen, , True)\r\r\r'SRate = 100 * EDSECUPPRGRATE(R%, gndr) / caledsecint\rDropoutrate = CSng(AMAX(0, 1 - (EDSECUPPRGRATE(R%, gndr) / caledsecint) ^ (1 / edsecupprlen(R%))))\r\r'mti 2023/11/28 start\rFor GCount% = 1 To CInt(edsecupprlen(R%)) 'save last year's grade specific enrollment for post budget use\rSaveStudentCohorts(R%, GCount%, gndr, SecUppr) = secupprstudents(GCount%, R%, gndr)\rNext\r'mti 2023/11/28 end\r\rCall GradeWiseEnrollmentCalc(R%, gndr, secStart(R%) + edseclowrlen(R%), edsecupprlen(R%), caledsecint, 0,\r                    secupprstudents, SaveSecLowUpStudentCohorts, 2, EDSECUPPRTOT(R%, gndr), Dropoutrate, True)\r'mti 2014/03/27 - start\r'Vocational share (of total, i.e., gen + voc)) is forecast as constant (=initial val.) or constant * multiplier; capping at 70% as the maximum share\r'            If edsecupprvocm(R%, Total) <> 1 Or edsecupprvocm(R%, gndr) <> 1 Then\r'                EDSECUPPRVOCI(R%, gndr) = AMAX(EDSECUPPRVOCI(R%, gndr), 0.01)  'multiplier won't work for zero, so give a small value\r'            End If\r\rEDSECUPPRVOC(R%, gndr) = AMAX(0, Amin(70, EDSECUPPRVOCI(R%, gndr) + If(edsecupprvocadd(R%, Total) <> 0, edsecupprvocadd(R%, Total), edsecupprvocadd(R%, gndr))))\r\r'All years but first: Upper Secondary Initial: Add Vocational\r'EDSECUPPRTOT(R%, gndr) = EdSecTot_Gen + secupprpop(R%, gndr) * sEdSecUpprShareVoc(R%, gndr) / 100\r'EDSECUPPRTOT(R%, gndr) = EdSecTot_Gen / (1 - EDSECUPPRVOC(R%, gndr) / 100)\r\r'mti October 2008 adjust for shift, or total students for budget'll be less\r'EDSECUPPRTOT(R%, gndr) = EDSECUPPRTOT(R%, gndr) + secupprpop(R%, gndr) * (ConvergeOverTimeSmooth(edsecUpprenrgshift(R%, gndr), 0, edsecUpprenrgshiftCur(R%, gndr), False) / 100) '25\rEDSECUPPRTOT(R%, gndr) = EDSECUPPRTOT(R%, gndr) + secupprpop(R%, gndr) * edsecUpprenrgshiftCur(R%, gndr) / 100\r'-- Demand determined (constrained with multiplier) transition, survival and gross enrollment ----------------\r\r\r'Constrain the total enrollment for budget demand only : it is not necessary to adjust intake/survival here\r'mti 2022/04/12 start\r'EDSECUPPRTOT(R%, gndr) = Amin(1.5 * secupprpop(R%, gndr), EDSECUPPRTOT(R%, gndr))\rEDSECUPPRTOT(R%, gndr) = CSng(AMAX(0.01 * secupprpop(R%, gndr), Amin(1.5 * secupprpop(R%, gndr), EDSECUPPRTOT(R%, gndr))))\r'mti 2022/04/12 End\r'mti 2014/03/27 - end\r\r'commented october 2008\r'All years but first: Upper Secondary Initial: add each gender to total students and graduates\r'EDSECUPPRTOT(R%, Total) = EDSECUPPRTOT(R%, Total) + EDSECUPPRTOT(R%, gndr)\r\rNext gndr\r\rNext R%\r\r'it needs to get budget and scenario driver impacts though (same as grate?)\r'mti 2024/01/24 end\r\r'Other grades with dropout and repeaters\rFor GCount% = 2 To CInt(edseclowrlen(R%))\r'If GRPS(1, R%) = \"Vanuatu\" And gndr = 2 And GCount% = 5 Then Stop\rseclowrstudents(GCount%, R%, gndr) = AMAX(1, (SaveStudentCohorts(R%, GCount% - 1, gndr, SecLowr) * (1 - EdSecLowrDropoutByGrade(GCount% - 1, R%, gndr) - RptGr(GCount% - 1))))\r"
  },
  {
    "Variable": "EDSECLOWRENRGGRD",
    "UsesVariable": "EDSECLOWRDRPGRD",
    "Distance": 211,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRADS",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRADS",
    "UsesVariable": "edseclowrlen",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRADS",
    "UsesVariable": "EDSECLOWRGRATE",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRADS",
    "UsesVariable": "edpristart",
    "Distance": 1127,
    "Code": "\r'mti 2019/12/09 End\r\r\rNext\r\r'First Year : Initiaize Intake and Survival Impact Values to 1\r'-------------------------------------------------------------\rFor lvl% = 1 To 5\rFor gndr = 1 To 2\rsIntakeImpact(R%, gndr, lvl%) = 1\rsSurvImpact(R%, gndr, lvl%) = 1\rNext\rsCostPerDelta(R%, lvl%) = 1\rNext\r\r'Cycle Length etc\r'----------------\rsecStart(R%) = edpristart(R%) + edprilen(R%)\r'seccohort(R%) = 1 + (edpristart(R%) + edprilen(R%)) \\ 5\r\rDim edseclenR = edseclowrlen(R%) + edsecupprlen(R%)\r\r'secendcohort(R%) = 1 + (edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r'upper secondary ends at this cohort\rusec(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r\rterendcohort(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR + 5) \\ 5\rterstart(R%) = edpristart(R%) + edprilen(R%) + edseclenR\rterlen(R%) = 5\r\rNext R%\r"
  },
  {
    "Variable": "EDSECLOWRGRADS",
    "UsesVariable": "edprilen",
    "Distance": 1127,
    "Code": "\r'mti 2019/12/09 End\r\r\rNext\r\r'First Year : Initiaize Intake and Survival Impact Values to 1\r'-------------------------------------------------------------\rFor lvl% = 1 To 5\rFor gndr = 1 To 2\rsIntakeImpact(R%, gndr, lvl%) = 1\rsSurvImpact(R%, gndr, lvl%) = 1\rNext\rsCostPerDelta(R%, lvl%) = 1\rNext\r\r'Cycle Length etc\r'----------------\rsecStart(R%) = edpristart(R%) + edprilen(R%)\r'seccohort(R%) = 1 + (edpristart(R%) + edprilen(R%)) \\ 5\r\rDim edseclenR = edseclowrlen(R%) + edsecupprlen(R%)\r\r'secendcohort(R%) = 1 + (edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r'upper secondary ends at this cohort\rusec(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r\rterendcohort(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR + 5) \\ 5\rterstart(R%) = edpristart(R%) + edprilen(R%) + edseclenR\rterlen(R%) = 5\r\rNext R%\r"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "edseclowrlen",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "edqtqltrm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "edseclowrgram",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "gdsm",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "EDTERGRATE",
    "Distance": 26,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "EDSECUPPRGRATE",
    "Distance": 27,
    "Code": "\r'mti 2018/06/05 End\r'If GRPS(1,R%) = \"Sudan South\" And IY > 5 Then Stop\r'If edbudgon(R%) = 0 Then GoTo AfterSecBudgetImpact  'budget neutral\rIf edbudgon(R%) = 0 Then\rCall AfterSecBudgetImpact(R, context)\r'jrs 2023/11/06 Return\rElse 'jrs 2023/11/06 else used to have Return, but that would exit the procedure on the first country, and didn't run the all years\r'All Years but First: Lower Secondary Final: Calculate Budget Impact\rBudgetImpactParam = CalcBudgetImpact(\"SecLowr\", R%, spendcostRI(R%)) '(calctotseclowrspend / AMAX(0.0000001, calctotseclowrcost))\r"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "edseclowrenrgrdm",
    "Distance": 1931,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "edprienrgrdm",
    "Distance": 1735,
    "Code": "\r'mti 2022/04/12 start\r'* Amin(2, AMAX(1, IIf(edpriintnm(R%, NGender) <> 1, edpriintnm(R%, NGender), edpriintnm(R%, gndr))))\rpristudents(GCount%, R%, gndr) = pristudents(GCount%, R%, gndr) * Amin(3, AMAX(0.05, If(edprienrm(R%, NGender) <> 1, edprienrm(R%, NGender), edprienrm(R%, gndr))))\r"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "edseclowrenrm",
    "Distance": 1932,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "edprienrm",
    "Distance": 1738,
    "Code": "\rpristudents(GCount%, R%, gndr) = pristudents(GCount%, R%, gndr) + SaveStudentCohorts(R%, GCount%, gndr, 1) * RptGr(GCount%)\r"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "GDS",
    "Distance": 784,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "edseclowrdrpgrdm",
    "Distance": 1940,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "EDSECLOWRENRGGRD",
    "Distance": 2174,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "EDSECLOWRDRPGRD",
    "Distance": 2138,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "edpridrpgrdm",
    "Distance": 1744,
    "Code": "\rNext\r\r'Dropouts by grade\r'mti 2022/04/12 start\rFor GCount% = 1 To CInt(edprilen(R%))     '- 1\rEdPriDropoutByGrade(GCount%, R%, gndr%) = EDPRIDRPGRD(R%, GCount%, gndr%) 'initialized in pre-processor\r\r\r' If GRPS(1, R%) = \"Burundi\" And gndr = 1 Then\r'    'Stop\r'    Debug.Print IY; \",\"; GRPS(1, R%); \",\"; EDPRIINT(R%, gndr%); \",\"; EDPRISUR(R%, gndr%); \",\"; EDPRIINT(R%, gndr%) * EDPRISUR(R%, gndr%) / 100; \",\";\r' End If\r\r\rIf i1EdPriSur(R%, gndr%) > 90 Then\rFor GCount% = 1 To CInt(edprilen(R%)) '\rEdPriDropoutByGrade(GCount%, R%, gndr%) = ConvergeOverTime1(i1EdPriDropoutByGrade(GCount%, R%, gndr%), 0, 15)\rNext GCount%\r'what if survival goes down through scenario - add branch\rElse\r'SurvTrgtCovd = (sEDPRISUR(R%, gndr%) - i1EdPriSur(R%, gndr%)) / (100 - i1EdPriSur(R%, gndr%))\rSurvTrgtCovd = AMAX(-0.2, Amin(1, (EDPRISUR(R%, gndr%) - i1EdPriSur(R%, gndr%)) / (100 - i1EdPriSur(R%, gndr%))))\rFor GCount% = 1 To CInt(edprilen(R%)) '\rEdPriDropoutByGrade(GCount%, R%, gndr%) = CSng(AMAX(0, Amin(0.9, i1EdPriDropoutByGrade(GCount%, R%, gndr%) + SurvTrgtCovd * (0 - i1EdPriDropoutByGrade(GCount%, R%, gndr%))))) 'AMAX(0, (can be in both direction)\rNext GCount%\rEnd If\r\r\r' If GRPS(1, R%) = \"Burundi\" And gndr = 1 Then\r'    'Stop\r'    Debug.Print IY; \",\"; GRPS(1, R%); \",\"; EDPRIINT(R%, gndr%); \",\"; EDPRISUR(R%, gndr%); \",\"; EDPRIINT(R%, gndr%) * EDPRISUR(R%, gndr%) / 100; \",\";\r' End If\r\r\rIf i1EdPriSur(R%, gndr%) > 90 Then\rFor GCount% = 1 To CInt(edprilen(R%)) '\rEdPriDropoutByGrade(GCount%, R%, gndr%) = ConvergeOverTime1(i1EdPriDropoutByGrade(GCount%, R%, gndr%), 0, 15)\rNext GCount%\r'what if survival goes down through scenario - add branch\rElse\r'SurvTrgtCovd = (sEDPRISUR(R%, gndr%) - i1EdPriSur(R%, gndr%)) / (100 - i1EdPriSur(R%, gndr%))\rSurvTrgtCovd = AMAX(-0.2, Amin(1, (EDPRISUR(R%, gndr%) - i1EdPriSur(R%, gndr%)) / (100 - i1EdPriSur(R%, gndr%))))\rFor GCount% = 1 To CInt(edprilen(R%)) '\rEdPriDropoutByGrade(GCount%, R%, gndr%) = CSng(AMAX(0, Amin(0.9, i1EdPriDropoutByGrade(GCount%, R%, gndr%) + SurvTrgtCovd * (0 - i1EdPriDropoutByGrade(GCount%, R%, gndr%))))) 'AMAX(0, (can be in both direction)\rNext GCount%\rEnd If\rCOMPLETE STRUCTURE:End If:8461|\r\r' If GRPS(1,R%) = \"Thailand\" Then Stop\r\r'---------- Grade-specific enrollment and dropout -------\r'Grade-specific gross enrollment rate\rIf EDSECLOWRENRGGRD(R%, 1, gndr%) > 0 And EDSECLOWRENRGGRD(R%, 1, gndr%) < 999 Then\r'already initialized with historical in pre-processor\rFor GCount% = 1 To CInt(edseclowrlen(R%))\rseclowrstudents(GCount%, R%, gndr%) = EDSECLOWRENRGGRD(R%, GCount%, gndr%)  'Load intermediate variables (not needed; ultimately)\r\r\r'                EdSecLowrTot_From_GradeEnr = 0\r'                PopTot = 0\r'                For GCount% = 1 To edseclowrlen(R%)\r'\r'                    Gr_Students = fagedst(edpristart(R%) + edprilen(R%) + GCount% - 1, R%, gndr%) * seclowrstudents(GCount%, R%, gndr%) / 100\r'                    EdSecLowrTot_From_GradeEnr = EdSecLowrTot_From_GradeEnr + Gr_Students\r'                    PopTot = PopTot + fagedst(edpristart(R%) + edprilen(R%) + GCount% - 1, R%, gndr%)\r'                Next\r'\r'                EDSECLOWRTOT(R%, gndr) = EDSECLOWRENRG(R%, gndr) * PopTot / 100    'mti 2021/04/27\r'\r'                Rat_Gr_Lvl = EDSECLOWRTOT(R%, gndr) * (1 - EDSECLOWRVOC(R%, gndr%) / 100) / AMAX(0.000001, EdSecLowrTot_From_GradeEnr)\r'\r'          'If RegName(R%) = \"Angola\" Then Stop\r''          If RegName(R%) = \"Cambodia\" Then Stop\r'\r'                If Round(Rat_Gr_Lvl, 4) <> 1 Then\r'                    For GCount% = 1 To edseclowrlen(R%)\r'                        seclowrstudents(GCount%, R%, gndr%) = seclowrstudents(GCount%, R%, gndr%) * Rat_Gr_Lvl\r'\r'                        EDSECLOWRENRGGRD(R%, GCount%, gndr%) = seclowrstudents(GCount%, R%, gndr%)\r'\r'                        'SaveStudentCohorts(R%, GCount%, gndr, SecLowr) = seclowrstudents(GCount%, R%, gndr)\r'                    Next\r'                End If\r\r'mti 2022/04/12 - End\r\r\r'Unused Grade Variables set to 0\rFor GCount% = CInt(edseclowrlen(R%) + 1) To NPriGr\rseclowrstudents(GCount%, R%, gndr%) = 0\rCOMPLETE STRUCTURE:Next R%:8518|\rFor GCount% = 1 To CInt(edseclowrlen(R%)) - 1\rEDSECLOWRSUR(R%, gndr%) = EDSECLOWRSUR(R%, gndr%) * (1 - EdSecLowrDropoutByGrade(GCount%, R%, gndr%))\rCOMPLETE STRUCTURE:End If:8461|\r\r' If GRPS(1,R%) = \"Thailand\" Then Stop\r\r'---------- Grade-specific enrollment and dropout -------\r'Grade-specific gross enrollment rate\rIf EDSECLOWRENRGGRD(R%, 1, gndr%) > 0 And EDSECLOWRENRGGRD(R%, 1, gndr%) < 999 Then\r'already initialized with historical in pre-processor\rFor GCount% = 1 To CInt(edseclowrlen(R%))\rseclowrstudents(GCount%, R%, gndr%) = EDSECLOWRENRGGRD(R%, GCount%, gndr%)  'Load intermediate variables (not needed; ultimately)\r\r\r'                EdSecLowrTot_From_GradeEnr = 0\r'                PopTot = 0\r'                For GCount% = 1 To edseclowrlen(R%)\r'\r'                    Gr_Students = fagedst(edpristart(R%) + edprilen(R%) + GCount% - 1, R%, gndr%) * seclowrstudents(GCount%, R%, gndr%) / 100\r'                    EdSecLowrTot_From_GradeEnr = EdSecLowrTot_From_GradeEnr + Gr_Students\r'                    PopTot = PopTot + fagedst(edpristart(R%) + edprilen(R%) + GCount% - 1, R%, gndr%)\r'                Next\r'\r'                EDSECLOWRTOT(R%, gndr) = EDSECLOWRENRG(R%, gndr) * PopTot / 100    'mti 2021/04/27\r'\r'                Rat_Gr_Lvl = EDSECLOWRTOT(R%, gndr) * (1 - EDSECLOWRVOC(R%, gndr%) / 100) / AMAX(0.000001, EdSecLowrTot_From_GradeEnr)\r'\r'          'If RegName(R%) = \"Angola\" Then Stop\r''          If RegName(R%) = \"Cambodia\" Then Stop\r'\r'                If Round(Rat_Gr_Lvl, 4) <> 1 Then\r'                    For GCount% = 1 To edseclowrlen(R%)\r'                        seclowrstudents(GCount%, R%, gndr%) = seclowrstudents(GCount%, R%, gndr%) * Rat_Gr_Lvl\r'\r'                        EDSECLOWRENRGGRD(R%, GCount%, gndr%) = seclowrstudents(GCount%, R%, gndr%)\r'\r'                        'SaveStudentCohorts(R%, GCount%, gndr, SecLowr) = seclowrstudents(GCount%, R%, gndr)\r'                    Next\r'                End If\r\r'mti 2022/04/12 - End\r\r\r'Unused Grade Variables set to 0\rFor GCount% = CInt(edseclowrlen(R%) + 1) To NPriGr\rseclowrstudents(GCount%, R%, gndr%) = 0\rCOMPLETE STRUCTURE:Next gndr:8499|\r'mti 2024/01/24 End\r\r'mti 2023/12/01 start\r'If GRPS(1, R) = \"India\" And gndr = 2 Then Stop\rFor GCount% = 2 To CInt(edseclowrlen(R%))  'mti 2021/05/06\r'If GRPS(1, R%) = \"China\" And gndr = 1 And GCount% = CInt(edseclowrlen(R%)) Then Stop\rIf seclowrstudents(GCount%, R%, gndr%) = 0 Then\rEdSecLowrRptrGr(GCount%, R%, gndr) = 0\rElse\rEdSecLowrRptrGr(GCount%, R%, gndr) = CSng(Amin(0.9, AMAX(0, (EDSECLOWRENRGGRD(R%, GCount%, gndr%) -\r                                                    (EDSECLOWRENRGGRD(R%, GCount% - 1, gndr%) *\r                                                    AMAX(0.001, (1 - EDSECLOWRDRPGRD(R%, GCount% - 1, gndr%) -\r                                                    EdSecLowrRptrGr(GCount% - 1, R%, gndr))))) / EDSECLOWRENRGGRD(R%, GCount%, gndr%))))\rEnd If\r"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "EDPRIENRGGRD",
    "Distance": 1846,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "EDPRIDRPGRD",
    "Distance": 1846,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "EDPRISUR",
    "Distance": 1853,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "EDPRITOT",
    "Distance": 779,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "EDTERTOT",
    "Distance": 776,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "EDEXPERPRI",
    "Distance": 783,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "GDPPC",
    "Distance": 783,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "EDSECLOWRTOT",
    "Distance": 778,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "EDSECUPPRTOT",
    "Distance": 777,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "EDEXPERTER",
    "Distance": 780,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "EDEXPERSECLOWR",
    "Distance": 782,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "EDEXPERSECUPPR",
    "Distance": 781,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "edtergradm",
    "Distance": 77,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "edprisurm",
    "Distance": 1642,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "marriageedseclowr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "MARRIEDFEMSHR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "marriedfemshrm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "GOVINDSECUR",
    "Distance": 328,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "GDPPCP",
    "Distance": 331,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "POP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "edpristart",
    "Distance": 555,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRGRATE",
    "UsesVariable": "edprilen",
    "Distance": 555,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTOT",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTOT",
    "UsesVariable": "EDSECLOWRGRATE",
    "Distance": 429,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTOT",
    "UsesVariable": "EDSECLOWRENRG",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTOT",
    "UsesVariable": "EDSECLOWRVOC",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTOT",
    "UsesVariable": "edpristart",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTOT",
    "UsesVariable": "edprilen",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTOT",
    "UsesVariable": "edseclowrenrgrdm",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTOT",
    "UsesVariable": "edseclowrenrm",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTOT",
    "UsesVariable": "edseclowrdrpgrdm",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTOT",
    "UsesVariable": "EDSECLOWRENRGGRD",
    "Distance": 248,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTOT",
    "UsesVariable": "EDSECLOWRDRPGRD",
    "Distance": 212,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTOT",
    "UsesVariable": "POPEDSECLOWR",
    "Distance": 0,
    "Code": "\r'     If GRPS(1,R%) = \"Solomon Islands\" Then Stop\r'Reconcile grade specific gross enrollment rates with Levelwide rates\r'EDPRITOT(R%, gndr) = EDPRIENRG(R%, gndr) * POPEDPRI(R%, gndr) / 100     'mti 2021/04/27\r\r'mti 2022/04/12 - start\rEDSECLOWRTOT(R%, gndr) = EDSECLOWRENRG(R%, gndr) * POPEDSECLOWR(R%, gndr%) / 100\r"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "edqtqltrm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "edseclowrtranm",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "gdsm",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "GDS",
    "Distance": 775,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "EDPRITOT",
    "Distance": 770,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "EDTERTOT",
    "Distance": 767,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "EDEXPERPRI",
    "Distance": 774,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "GDPPC",
    "Distance": 774,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "EDSECLOWRTOT",
    "Distance": 769,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "EDSECUPPRTOT",
    "Distance": 768,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "EDEXPERTER",
    "Distance": 771,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "EDEXPERSECLOWR",
    "Distance": 773,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "EDEXPERSECUPPR",
    "Distance": 772,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "edseclowrtrangr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "edseclowrtrantrgtyr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "EDTERINT",
    "Distance": 84,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "edterintm",
    "Distance": 84,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "EDPRIINTN",
    "Distance": 1493,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "edpriintnm",
    "Distance": 1654,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "GDPPCP",
    "Distance": 22,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "EDSECUPPRTRAN",
    "Distance": 2008,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "edpristart",
    "Distance": 541,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRTRAN",
    "UsesVariable": "edprilen",
    "Distance": 541,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRVOC",
    "UsesVariable": "edseclowrvocadd",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRVOC",
    "UsesVariable": "edseclowrlen",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRVOC",
    "UsesVariable": "edpristart",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "EDSECLOWRVOC",
    "UsesVariable": "edprilen",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "EDSECPER",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECPER",
    "UsesVariable": "edpristart",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "EDSECPER",
    "UsesVariable": "edprilen",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "EDSECPER",
    "UsesVariable": "edseclowrlen",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "EDSECPER",
    "UsesVariable": "edsecupprlen",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "EDSECPER",
    "UsesVariable": "EDSECUPPRGRATE",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "EDSECPER15TO24",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECPER15TO24",
    "UsesVariable": "edpristart",
    "Distance": 1148,
    "Code": "0"
  },
  {
    "Variable": "EDSECPER15TO24",
    "UsesVariable": "edprilen",
    "Distance": 1148,
    "Code": "0"
  },
  {
    "Variable": "EDSECPER15TO24",
    "UsesVariable": "edseclowrlen",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "EDSECPER15TO24",
    "UsesVariable": "edsecupprlen",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "EDSECPER15TO24",
    "UsesVariable": "EDSECUPPRGRATE",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "EDSECPER20TO24",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECPER20TO24",
    "UsesVariable": "edpristart",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "EDSECPER20TO24",
    "UsesVariable": "edprilen",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "EDSECPER20TO24",
    "UsesVariable": "edseclowrlen",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "EDSECPER20TO24",
    "UsesVariable": "edsecupprlen",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "EDSECPER20TO24",
    "UsesVariable": "EDSECUPPRGRATE",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "EDSECTOT",
    "UsesVariable": "EDSECLOWRTOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECTOT",
    "UsesVariable": "EDSECUPPRTOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRENRG",
    "UsesVariable": "EDSECUPPRTOT",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRENRG",
    "UsesVariable": "POP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRENRG",
    "UsesVariable": "edsecupprlen",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRENRG",
    "UsesVariable": "edpristart",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRENRG",
    "UsesVariable": "edprilen",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRENRG",
    "UsesVariable": "edseclowrlen",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRADS",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRADS",
    "UsesVariable": "edseclowrlen",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRADS",
    "UsesVariable": "edsecupprlen",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRADS",
    "UsesVariable": "EDSECUPPRGRATE",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRADS",
    "UsesVariable": "edpristart",
    "Distance": 1137,
    "Code": "\r'mti 2019/12/09 End\r\r\rNext\r\r'First Year : Initiaize Intake and Survival Impact Values to 1\r'-------------------------------------------------------------\rFor lvl% = 1 To 5\rFor gndr = 1 To 2\rsIntakeImpact(R%, gndr, lvl%) = 1\rsSurvImpact(R%, gndr, lvl%) = 1\rNext\rsCostPerDelta(R%, lvl%) = 1\rNext\r\r'Cycle Length etc\r'----------------\rsecStart(R%) = edpristart(R%) + edprilen(R%)\r'seccohort(R%) = 1 + (edpristart(R%) + edprilen(R%)) \\ 5\r\rDim edseclenR = edseclowrlen(R%) + edsecupprlen(R%)\r\r'secendcohort(R%) = 1 + (edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r'upper secondary ends at this cohort\rusec(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r\rterendcohort(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR + 5) \\ 5\rterstart(R%) = edpristart(R%) + edprilen(R%) + edseclenR\rterlen(R%) = 5\r\rNext R%\r"
  },
  {
    "Variable": "EDSECUPPRGRADS",
    "UsesVariable": "edprilen",
    "Distance": 1137,
    "Code": "\r'mti 2019/12/09 End\r\r\rNext\r\r'First Year : Initiaize Intake and Survival Impact Values to 1\r'-------------------------------------------------------------\rFor lvl% = 1 To 5\rFor gndr = 1 To 2\rsIntakeImpact(R%, gndr, lvl%) = 1\rsSurvImpact(R%, gndr, lvl%) = 1\rNext\rsCostPerDelta(R%, lvl%) = 1\rNext\r\r'Cycle Length etc\r'----------------\rsecStart(R%) = edpristart(R%) + edprilen(R%)\r'seccohort(R%) = 1 + (edpristart(R%) + edprilen(R%)) \\ 5\r\rDim edseclenR = edseclowrlen(R%) + edsecupprlen(R%)\r\r'secendcohort(R%) = 1 + (edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r'upper secondary ends at this cohort\rusec(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r\rterendcohort(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR + 5) \\ 5\rterstart(R%) = edpristart(R%) + edprilen(R%) + edseclenR\rterlen(R%) = 5\r\rNext R%\r"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "edsecupprlen",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "edqtqltrm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "edsecupprgram",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "gdsm",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "edseclowrenrgrdm",
    "Distance": 1948,
    "Code": "\rseclowrstudents(GCount%, R%, gndr) = seclowrstudents(GCount%, R%, gndr) * Amin(3, AMAX(0.05, If(edseclowrenrm(R%, NGender) <> 1, edseclowrenrm(R%, NGender), edseclowrenrm(R%, gndr))))\r"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "edprienrgrdm",
    "Distance": 1752,
    "Code": "\r'mti 2022/04/12 start\r'* Amin(2, AMAX(1, IIf(edpriintnm(R%, NGender) <> 1, edpriintnm(R%, NGender), edpriintnm(R%, gndr))))\rpristudents(GCount%, R%, gndr) = pristudents(GCount%, R%, gndr) * Amin(3, AMAX(0.05, If(edprienrm(R%, NGender) <> 1, edprienrm(R%, NGender), edprienrm(R%, gndr))))\r"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "edseclowrenrm",
    "Distance": 1949,
    "Code": "\rseclowrstudents(GCount%, R%, gndr) = seclowrstudents(GCount%, R%, gndr) + SaveStudentCohorts(R%, GCount%, gndr, SecLowr) * RptGr(GCount%)\r\r'change less han 1%\rspendcostRI(R%) = CSng(AMAX(spendcostRI(R%) * 0.99, Amin(spendcostRI(R%) * 1.01, cspendcostRI)))\r"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "edprienrm",
    "Distance": 1755,
    "Code": "\rpristudents(GCount%, R%, gndr) = pristudents(GCount%, R%, gndr) + SaveStudentCohorts(R%, GCount%, gndr, 1) * RptGr(GCount%)\r"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "GDS",
    "Distance": 801,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "edseclowrdrpgrdm",
    "Distance": 1957,
    "Code": "\r'mti 2023/12/01 end\r\r\r'mti 2024/01/24 start - need to take the save for next year code after its use below\r'save for next year\r'sEdSecLowrSur(R%, gndr%) = EDSECLOWRSUR(R%, gndr%)      'note, survival is a computed variable now;\r'it needs to get budget and scenario driver impacts though (same as grate?)\r'mti 2024/01/24 end\r\r\rFor GCount% = 1 To CInt(edseclowrlen(R%)) '\rIf ilEdSecLowrSur(R%, gndr%) < 90 Then\rEdSecLowrDropoutByGrade(GCount%, R%, gndr%) = CSng(AMAX(0, Amin(0.9, i1EdSecLowrDropoutByGrade(GCount%, R%, gndr%) + SurvTrgtCovd * (0 - i1EdSecLowrDropoutByGrade(GCount%, R%, gndr%))))) 'AMAX(0, (can be in both direction)\rElse\rEdSecLowrDropoutByGrade(GCount%, R%, gndr%) = ConvergeOverTime1(i1EdSecLowrDropoutByGrade(GCount%, R%, gndr%), 0, 15)\rEnd If\r'mti 2022/04/12 start\rEdSecLowrDropoutByGrade(GCount%, R%, gndr%) = CSng(AMAX(0, Amin(0.9, EdSecLowrDropoutByGrade(GCount%, R%, gndr%) * If(edseclowrdrpgrdm(R%, NGender) <> 1, edseclowrdrpgrdm(R%, NGender), edseclowrdrpgrdm(R%, gndr)))))\r'mti 2022/04/12 end 'grate impact?\r\rEDSECLOWRDRPGRD(R%, GCount%, gndr%) = EdSecLowrDropoutByGrade(GCount%, R%, gndr%)\rNext GCount%\rCOMPLETE STRUCTURE:End If:8461|\r\r' If GRPS(1,R%) = \"Thailand\" Then Stop\r\r'---------- Grade-specific enrollment and dropout -------\r'Grade-specific gross enrollment rate\rIf EDSECLOWRENRGGRD(R%, 1, gndr%) > 0 And EDSECLOWRENRGGRD(R%, 1, gndr%) < 999 Then\r'already initialized with historical in pre-processor\rFor GCount% = 1 To CInt(edseclowrlen(R%))\rseclowrstudents(GCount%, R%, gndr%) = EDSECLOWRENRGGRD(R%, GCount%, gndr%)  'Load intermediate variables (not needed; ultimately)\r\r\r'                EdSecLowrTot_From_GradeEnr = 0\r'                PopTot = 0\r'                For GCount% = 1 To edseclowrlen(R%)\r'\r'                    Gr_Students = fagedst(edpristart(R%) + edprilen(R%) + GCount% - 1, R%, gndr%) * seclowrstudents(GCount%, R%, gndr%) / 100\r'                    EdSecLowrTot_From_GradeEnr = EdSecLowrTot_From_GradeEnr + Gr_Students\r'                    PopTot = PopTot + fagedst(edpristart(R%) + edprilen(R%) + GCount% - 1, R%, gndr%)\r'                Next\r'\r'                EDSECLOWRTOT(R%, gndr) = EDSECLOWRENRG(R%, gndr) * PopTot / 100    'mti 2021/04/27\r'\r'                Rat_Gr_Lvl = EDSECLOWRTOT(R%, gndr) * (1 - EDSECLOWRVOC(R%, gndr%) / 100) / AMAX(0.000001, EdSecLowrTot_From_GradeEnr)\r'\r'          'If RegName(R%) = \"Angola\" Then Stop\r''          If RegName(R%) = \"Cambodia\" Then Stop\r'\r'                If Round(Rat_Gr_Lvl, 4) <> 1 Then\r'                    For GCount% = 1 To edseclowrlen(R%)\r'                        seclowrstudents(GCount%, R%, gndr%) = seclowrstudents(GCount%, R%, gndr%) * Rat_Gr_Lvl\r'\r'                        EDSECLOWRENRGGRD(R%, GCount%, gndr%) = seclowrstudents(GCount%, R%, gndr%)\r'\r'                        'SaveStudentCohorts(R%, GCount%, gndr, SecLowr) = seclowrstudents(GCount%, R%, gndr)\r'                    Next\r'                End If\r\r'mti 2022/04/12 - End\r\r\r'Unused Grade Variables set to 0\rFor GCount% = CInt(edseclowrlen(R%) + 1) To NPriGr\rseclowrstudents(GCount%, R%, gndr%) = 0\rCOMPLETE STRUCTURE:End Sub:9875|\r\rPrivate Sub BudgetInitialize(R%, ByRef spendcostRI As Single, ByRef edexpperPriShift As Single,\r                                     ByRef edexpperSecLowrShift As Single, ByRef edexpperSecUpprShift As Single,\r                                     ByRef edexpperTerShift As Single, ByRef YrsAheadUSec As Single,\r                                     ByRef YrsAheadTer As Single, context As IForecastContext)\r'--- Education Module ----------------------------------------------------------------------------------------\r'mti 2016/03/30 - take whole proc\rDim convtoexchange1, calctotspend, priperstdntDollar, seclowrperstdntDollar, secupprperstdntDollar As Single\rDim GDPPCP_Ahead As Single\rconvtoexchange1 = 1 'GDPPC(R%) / AMAX(0.001, GDPPCP(R%))\r\r\r\rDim calctotcost As Single\rcalctotcost = expendpri + expendsec + expendter\rCOMPLETE STRUCTURE:End Sub:9875|\r\rPrivate Sub BudgetInitialize(R%, ByRef spendcostRI As Single, ByRef edexpperPriShift As Single,\r                                     ByRef edexpperSecLowrShift As Single, ByRef edexpperSecUpprShift As Single,\r                                     ByRef edexpperTerShift As Single, ByRef YrsAheadUSec As Single,\r                                     ByRef YrsAheadTer As Single, context As IForecastContext)\r'--- Education Module ----------------------------------------------------------------------------------------\r'mti 2016/03/30 - take whole proc\rDim convtoexchange1, calctotspend, priperstdntDollar, seclowrperstdntDollar, secupprperstdntDollar As Single\rDim GDPPCP_Ahead As Single\rconvtoexchange1 = 1 'GDPPC(R%) / AMAX(0.001, GDPPCP(R%))\r"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "EDSECLOWRENRGGRD",
    "Distance": 2191,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "EDSECLOWRDRPGRD",
    "Distance": 2155,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "edpridrpgrdm",
    "Distance": 1761,
    "Code": "\rNext\r\r'Dropouts by grade\r'mti 2022/04/12 start\rFor GCount% = 1 To CInt(edprilen(R%))     '- 1\rEdPriDropoutByGrade(GCount%, R%, gndr%) = EDPRIDRPGRD(R%, GCount%, gndr%) 'initialized in pre-processor\r\r\r' If GRPS(1, R%) = \"Burundi\" And gndr = 1 Then\r'    'Stop\r'    Debug.Print IY; \",\"; GRPS(1, R%); \",\"; EDPRIINT(R%, gndr%); \",\"; EDPRISUR(R%, gndr%); \",\"; EDPRIINT(R%, gndr%) * EDPRISUR(R%, gndr%) / 100; \",\";\r' End If\r\r\rIf i1EdPriSur(R%, gndr%) > 90 Then\rFor GCount% = 1 To CInt(edprilen(R%)) '\rEdPriDropoutByGrade(GCount%, R%, gndr%) = ConvergeOverTime1(i1EdPriDropoutByGrade(GCount%, R%, gndr%), 0, 15)\rNext GCount%\r'what if survival goes down through scenario - add branch\rElse\r'SurvTrgtCovd = (sEDPRISUR(R%, gndr%) - i1EdPriSur(R%, gndr%)) / (100 - i1EdPriSur(R%, gndr%))\rSurvTrgtCovd = AMAX(-0.2, Amin(1, (EDPRISUR(R%, gndr%) - i1EdPriSur(R%, gndr%)) / (100 - i1EdPriSur(R%, gndr%))))\rFor GCount% = 1 To CInt(edprilen(R%)) '\rEdPriDropoutByGrade(GCount%, R%, gndr%) = CSng(AMAX(0, Amin(0.9, i1EdPriDropoutByGrade(GCount%, R%, gndr%) + SurvTrgtCovd * (0 - i1EdPriDropoutByGrade(GCount%, R%, gndr%))))) 'AMAX(0, (can be in both direction)\rNext GCount%\rEnd If\r\r\r' If GRPS(1, R%) = \"Burundi\" And gndr = 1 Then\r'    'Stop\r'    Debug.Print IY; \",\"; GRPS(1, R%); \",\"; EDPRIINT(R%, gndr%); \",\"; EDPRISUR(R%, gndr%); \",\"; EDPRIINT(R%, gndr%) * EDPRISUR(R%, gndr%) / 100; \",\";\r' End If\r\r\rIf i1EdPriSur(R%, gndr%) > 90 Then\rFor GCount% = 1 To CInt(edprilen(R%)) '\rEdPriDropoutByGrade(GCount%, R%, gndr%) = ConvergeOverTime1(i1EdPriDropoutByGrade(GCount%, R%, gndr%), 0, 15)\rNext GCount%\r'what if survival goes down through scenario - add branch\rElse\r'SurvTrgtCovd = (sEDPRISUR(R%, gndr%) - i1EdPriSur(R%, gndr%)) / (100 - i1EdPriSur(R%, gndr%))\rSurvTrgtCovd = AMAX(-0.2, Amin(1, (EDPRISUR(R%, gndr%) - i1EdPriSur(R%, gndr%)) / (100 - i1EdPriSur(R%, gndr%))))\rFor GCount% = 1 To CInt(edprilen(R%)) '\rEdPriDropoutByGrade(GCount%, R%, gndr%) = CSng(AMAX(0, Amin(0.9, i1EdPriDropoutByGrade(GCount%, R%, gndr%) + SurvTrgtCovd * (0 - i1EdPriDropoutByGrade(GCount%, R%, gndr%))))) 'AMAX(0, (can be in both direction)\rNext GCount%\rEnd If\rCOMPLETE STRUCTURE:End If:8461|\r\r' If GRPS(1,R%) = \"Thailand\" Then Stop\r\r'---------- Grade-specific enrollment and dropout -------\r'Grade-specific gross enrollment rate\rIf EDSECLOWRENRGGRD(R%, 1, gndr%) > 0 And EDSECLOWRENRGGRD(R%, 1, gndr%) < 999 Then\r'already initialized with historical in pre-processor\rFor GCount% = 1 To CInt(edseclowrlen(R%))\rseclowrstudents(GCount%, R%, gndr%) = EDSECLOWRENRGGRD(R%, GCount%, gndr%)  'Load intermediate variables (not needed; ultimately)\r\r\r'                EdSecLowrTot_From_GradeEnr = 0\r'                PopTot = 0\r'                For GCount% = 1 To edseclowrlen(R%)\r'\r'                    Gr_Students = fagedst(edpristart(R%) + edprilen(R%) + GCount% - 1, R%, gndr%) * seclowrstudents(GCount%, R%, gndr%) / 100\r'                    EdSecLowrTot_From_GradeEnr = EdSecLowrTot_From_GradeEnr + Gr_Students\r'                    PopTot = PopTot + fagedst(edpristart(R%) + edprilen(R%) + GCount% - 1, R%, gndr%)\r'                Next\r'\r'                EDSECLOWRTOT(R%, gndr) = EDSECLOWRENRG(R%, gndr) * PopTot / 100    'mti 2021/04/27\r'\r'                Rat_Gr_Lvl = EDSECLOWRTOT(R%, gndr) * (1 - EDSECLOWRVOC(R%, gndr%) / 100) / AMAX(0.000001, EdSecLowrTot_From_GradeEnr)\r'\r'          'If RegName(R%) = \"Angola\" Then Stop\r''          If RegName(R%) = \"Cambodia\" Then Stop\r'\r'                If Round(Rat_Gr_Lvl, 4) <> 1 Then\r'                    For GCount% = 1 To edseclowrlen(R%)\r'                        seclowrstudents(GCount%, R%, gndr%) = seclowrstudents(GCount%, R%, gndr%) * Rat_Gr_Lvl\r'\r'                        EDSECLOWRENRGGRD(R%, GCount%, gndr%) = seclowrstudents(GCount%, R%, gndr%)\r'\r'                        'SaveStudentCohorts(R%, GCount%, gndr, SecLowr) = seclowrstudents(GCount%, R%, gndr)\r'                    Next\r'                End If\r\r'mti 2022/04/12 - End\r\r\r'Unused Grade Variables set to 0\rFor GCount% = CInt(edseclowrlen(R%) + 1) To NPriGr\rseclowrstudents(GCount%, R%, gndr%) = 0\rCOMPLETE STRUCTURE:Next R%:8518|\rFor GCount% = 1 To CInt(edseclowrlen(R%)) - 1\rEDSECLOWRSUR(R%, gndr%) = EDSECLOWRSUR(R%, gndr%) * (1 - EdSecLowrDropoutByGrade(GCount%, R%, gndr%))\rCOMPLETE STRUCTURE:End If:8461|\r\r' If GRPS(1,R%) = \"Thailand\" Then Stop\r\r'---------- Grade-specific enrollment and dropout -------\r'Grade-specific gross enrollment rate\rIf EDSECLOWRENRGGRD(R%, 1, gndr%) > 0 And EDSECLOWRENRGGRD(R%, 1, gndr%) < 999 Then\r'already initialized with historical in pre-processor\rFor GCount% = 1 To CInt(edseclowrlen(R%))\rseclowrstudents(GCount%, R%, gndr%) = EDSECLOWRENRGGRD(R%, GCount%, gndr%)  'Load intermediate variables (not needed; ultimately)\r\r\r'                EdSecLowrTot_From_GradeEnr = 0\r'                PopTot = 0\r'                For GCount% = 1 To edseclowrlen(R%)\r'\r'                    Gr_Students = fagedst(edpristart(R%) + edprilen(R%) + GCount% - 1, R%, gndr%) * seclowrstudents(GCount%, R%, gndr%) / 100\r'                    EdSecLowrTot_From_GradeEnr = EdSecLowrTot_From_GradeEnr + Gr_Students\r'                    PopTot = PopTot + fagedst(edpristart(R%) + edprilen(R%) + GCount% - 1, R%, gndr%)\r'                Next\r'\r'                EDSECLOWRTOT(R%, gndr) = EDSECLOWRENRG(R%, gndr) * PopTot / 100    'mti 2021/04/27\r'\r'                Rat_Gr_Lvl = EDSECLOWRTOT(R%, gndr) * (1 - EDSECLOWRVOC(R%, gndr%) / 100) / AMAX(0.000001, EdSecLowrTot_From_GradeEnr)\r'\r'          'If RegName(R%) = \"Angola\" Then Stop\r''          If RegName(R%) = \"Cambodia\" Then Stop\r'\r'                If Round(Rat_Gr_Lvl, 4) <> 1 Then\r'                    For GCount% = 1 To edseclowrlen(R%)\r'                        seclowrstudents(GCount%, R%, gndr%) = seclowrstudents(GCount%, R%, gndr%) * Rat_Gr_Lvl\r'\r'                        EDSECLOWRENRGGRD(R%, GCount%, gndr%) = seclowrstudents(GCount%, R%, gndr%)\r'\r'                        'SaveStudentCohorts(R%, GCount%, gndr, SecLowr) = seclowrstudents(GCount%, R%, gndr)\r'                    Next\r'                End If\r\r'mti 2022/04/12 - End\r\r\r'Unused Grade Variables set to 0\rFor GCount% = CInt(edseclowrlen(R%) + 1) To NPriGr\rseclowrstudents(GCount%, R%, gndr%) = 0\rCOMPLETE STRUCTURE:Next gndr:8499|\r'mti 2024/01/24 End\r\r'mti 2023/12/01 start\r'If GRPS(1, R) = \"India\" And gndr = 2 Then Stop\rFor GCount% = 2 To CInt(edseclowrlen(R%))  'mti 2021/05/06\r'If GRPS(1, R%) = \"China\" And gndr = 1 And GCount% = CInt(edseclowrlen(R%)) Then Stop\rIf seclowrstudents(GCount%, R%, gndr%) = 0 Then\rEdSecLowrRptrGr(GCount%, R%, gndr) = 0\rElse\rEdSecLowrRptrGr(GCount%, R%, gndr) = CSng(Amin(0.9, AMAX(0, (EDSECLOWRENRGGRD(R%, GCount%, gndr%) -\r                                                    (EDSECLOWRENRGGRD(R%, GCount% - 1, gndr%) *\r                                                    AMAX(0.001, (1 - EDSECLOWRDRPGRD(R%, GCount% - 1, gndr%) -\r                                                    EdSecLowrRptrGr(GCount% - 1, R%, gndr))))) / EDSECLOWRENRGGRD(R%, GCount%, gndr%))))\rEnd If\r"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "EDPRIENRGGRD",
    "Distance": 1863,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "EDPRIDRPGRD",
    "Distance": 1863,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "EDPRISUR",
    "Distance": 1870,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "EDPRITOT",
    "Distance": 796,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "EDTERTOT",
    "Distance": 793,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "EDEXPERPRI",
    "Distance": 800,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "GDPPC",
    "Distance": 800,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "EDSECLOWRTOT",
    "Distance": 795,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "EDSECUPPRTOT",
    "Distance": 794,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "EDEXPERTER",
    "Distance": 797,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "EDEXPERSECLOWR",
    "Distance": 799,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "EDEXPERSECUPPR",
    "Distance": 798,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "EDSECLOWRGRATE",
    "Distance": 31,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "EDTERGRATE",
    "Distance": 115,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "edtergradm",
    "Distance": 115,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "edprisurm",
    "Distance": 1680,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "marriageedsecuppr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "MARRIEDFEMSHR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "marriedfemshrm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "GOVINDSECUR",
    "Distance": 366,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "GDPPCP",
    "Distance": 369,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "EDSECUPPRENRG",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "POP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "edpristart",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "edprilen",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "edseclowrlen",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRGRATE",
    "UsesVariable": "edsecupprenrm",
    "Distance": 0,
    "Code": "\r\r\r'mti 2016/07/16 Start Artificial fix for now:  (Done to Fix Germany and Netherland issue; Voc transfer across lower sec(last grade) and upper sec; Pre-processor fix not yet figured out\r'mti 2019/11/22 Start\r'EDSECUPPRGRATE(R%, gndr) = AMAX(sEDTERGRATE(R%, gndr%) + 1, EDSECUPPRGRATE(R%, gndr))\r'mti 2022/03/16 start\r'EDSECUPPRGRATE(R%, gndr) = AMAX(1, Amin(sEdSecUpprEnrG(R%, gndr%) - 1, AMAX(sEDTERGRATE(R%, gndr%) + 1, EDSECUPPRGRATE(R%, gndr))))\r'mti 2022/04/12 start\r'EDSECUPPRGRATE(R%, gndr) = AMAX(1, Amin(sEdSecUpprEnrG(R%, gndr%) * AMAX(1, IIf(edsecupprgram(R%, NGender) <> 1, edsecupprgram(R%, NGender), edsecupprgram(R%, gndr))) - 1, AMAX(sEDTERGRATE(R%, gndr%) + 1, EDSECUPPRGRATE(R%, gndr))))\rEDSECUPPRGRATE(R%, gndr) = AMAX(1, Amin(sEdSecUpprEnrG(R%, gndr%) * AMAX(1, If(edsecupprenrm(R%, NGender) <> 1, edsecupprenrm(R%, NGender), edsecupprenrm(R%, gndr))) - 1, AMAX(sEDTERGRATE(R%, gndr%) + 1, EDSECUPPRGRATE(R%, gndr))))\r"
  },
  {
    "Variable": "EDSECUPPRTOT",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTOT",
    "UsesVariable": "EDSECUPPRENRG",
    "Distance": 2051,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTOT",
    "UsesVariable": "EDSECUPPRGRATE",
    "Distance": 465,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "edqtqltrm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "edsecupprtranm",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "gdsm",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "GDS",
    "Distance": 792,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "EDPRITOT",
    "Distance": 787,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "EDTERTOT",
    "Distance": 784,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "EDEXPERPRI",
    "Distance": 791,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "GDPPC",
    "Distance": 791,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "EDSECLOWRTOT",
    "Distance": 786,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "EDSECUPPRTOT",
    "Distance": 785,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "EDEXPERTER",
    "Distance": 788,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "EDEXPERSECLOWR",
    "Distance": 790,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "EDEXPERSECUPPR",
    "Distance": 789,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "edsecupprtrangr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "edsecupprtrantrgtyr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "EDSECLOWRTRAN",
    "Distance": 30,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "EDTERINT",
    "Distance": 122,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "edterintm",
    "Distance": 122,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "EDPRIINTN",
    "Distance": 1531,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "edpriintnm",
    "Distance": 1692,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "GDPPCP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "edpristart",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "edprilen",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRTRAN",
    "UsesVariable": "edseclowrlen",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRVOC",
    "UsesVariable": "edsecupprvocadd",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRVOC",
    "UsesVariable": "edsecupprlen",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRVOC",
    "UsesVariable": "edpristart",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRVOC",
    "UsesVariable": "edprilen",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "EDSECUPPRVOC",
    "UsesVariable": "edseclowrlen",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "EDTERENRG",
    "UsesVariable": "EDTERTOT",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDTERENRG",
    "UsesVariable": "POP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRADS",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRADS",
    "UsesVariable": "EDTERGRATE",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRADS",
    "UsesVariable": "edpristart",
    "Distance": 1189,
    "Code": "\r'mti 2019/12/09 End\r\r\rNext\r\r'First Year : Initiaize Intake and Survival Impact Values to 1\r'-------------------------------------------------------------\rFor lvl% = 1 To 5\rFor gndr = 1 To 2\rsIntakeImpact(R%, gndr, lvl%) = 1\rsSurvImpact(R%, gndr, lvl%) = 1\rNext\rsCostPerDelta(R%, lvl%) = 1\rNext\r\r'Cycle Length etc\r'----------------\rsecStart(R%) = edpristart(R%) + edprilen(R%)\r'seccohort(R%) = 1 + (edpristart(R%) + edprilen(R%)) \\ 5\r\rDim edseclenR = edseclowrlen(R%) + edsecupprlen(R%)\r\r'secendcohort(R%) = 1 + (edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r'upper secondary ends at this cohort\rusec(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r\rterendcohort(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR + 5) \\ 5\rterstart(R%) = edpristart(R%) + edprilen(R%) + edseclenR\rterlen(R%) = 5\r\rNext R%\r\r"
  },
  {
    "Variable": "EDTERGRADS",
    "UsesVariable": "edprilen",
    "Distance": 1189,
    "Code": "\r'mti 2019/12/09 End\r\r\rNext\r\r'First Year : Initiaize Intake and Survival Impact Values to 1\r'-------------------------------------------------------------\rFor lvl% = 1 To 5\rFor gndr = 1 To 2\rsIntakeImpact(R%, gndr, lvl%) = 1\rsSurvImpact(R%, gndr, lvl%) = 1\rNext\rsCostPerDelta(R%, lvl%) = 1\rNext\r\r'Cycle Length etc\r'----------------\rsecStart(R%) = edpristart(R%) + edprilen(R%)\r'seccohort(R%) = 1 + (edpristart(R%) + edprilen(R%)) \\ 5\r\rDim edseclenR = edseclowrlen(R%) + edsecupprlen(R%)\r\r'secendcohort(R%) = 1 + (edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r'upper secondary ends at this cohort\rusec(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r\rterendcohort(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR + 5) \\ 5\rterstart(R%) = edpristart(R%) + edprilen(R%) + edseclenR\rterlen(R%) = 5\r\rNext R%\r\r"
  },
  {
    "Variable": "EDTERGRADS",
    "UsesVariable": "edseclowrlen",
    "Distance": 1192,
    "Code": "\r'mti 2019/12/09 End\r\r\rNext\r\r'First Year : Initiaize Intake and Survival Impact Values to 1\r'-------------------------------------------------------------\rFor lvl% = 1 To 5\rFor gndr = 1 To 2\rsIntakeImpact(R%, gndr, lvl%) = 1\rsSurvImpact(R%, gndr, lvl%) = 1\rNext\rsCostPerDelta(R%, lvl%) = 1\rNext\r\r'Cycle Length etc\r'----------------\rsecStart(R%) = edpristart(R%) + edprilen(R%)\r'seccohort(R%) = 1 + (edpristart(R%) + edprilen(R%)) \\ 5\r\rDim edseclenR = edseclowrlen(R%) + edsecupprlen(R%)\r\r'secendcohort(R%) = 1 + (edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r'upper secondary ends at this cohort\rusec(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r\rterendcohort(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR + 5) \\ 5\rterstart(R%) = edpristart(R%) + edprilen(R%) + edseclenR\rterlen(R%) = 5\r\rNext R%\r"
  },
  {
    "Variable": "EDTERGRADS",
    "UsesVariable": "edsecupprlen",
    "Distance": 1192,
    "Code": "\r'mti 2019/12/09 End\r\r\rNext\r\r'First Year : Initiaize Intake and Survival Impact Values to 1\r'-------------------------------------------------------------\rFor lvl% = 1 To 5\rFor gndr = 1 To 2\rsIntakeImpact(R%, gndr, lvl%) = 1\rsSurvImpact(R%, gndr, lvl%) = 1\rNext\rsCostPerDelta(R%, lvl%) = 1\rNext\r\r'Cycle Length etc\r'----------------\rsecStart(R%) = edpristart(R%) + edprilen(R%)\r'seccohort(R%) = 1 + (edpristart(R%) + edprilen(R%)) \\ 5\r\rDim edseclenR = edseclowrlen(R%) + edsecupprlen(R%)\r\r'secendcohort(R%) = 1 + (edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r'upper secondary ends at this cohort\rusec(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r\rterendcohort(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR + 5) \\ 5\rterstart(R%) = edpristart(R%) + edprilen(R%) + edseclenR\rterlen(R%) = 5\r\rNext R%\r"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "edterpushon",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "EDTERENRG",
    "Distance": 2433,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "edtergradm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "edtergradgr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "edtergradtrgtyr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "EDSECUPPRGRATE",
    "Distance": 33,
    "Code": "\r\r'sSurvImpact(R%, gndr, Tertiary) = 0.8 * sSurvImpact(R%, gndr, Tertiary) + 0.2 * EDTERGRATE(R%, gndr) / iEdSurv(R%,gndr, Tertiary)\r'sSurvImpact(R%, gndr, Tertiary) = 0.8 * sSurvImpact(R%, gndr, Tertiary) + 0.2 * sSurvImpact(R%, gndr, Tertiary) * EDTERGRATE(R%, gndr) / iEdSurv(R%,gndr, Tertiary)\rsSurvImpact(R%, gndr, Tertiary) = CSng(0.8 * sSurvImpact(R%, gndr, Tertiary) + 0.2 * sSurvImpact(R%, gndr, Tertiary) * fEdSurv(R%, gndr, Tertiary) / iEdSurv(R%, gndr, Tertiary))\r\r\r\riEdSurv(R%, gndr, SecUppr) = EDSECUPPRGRATE(R%, gndr) ' EDSECUPPRSUR(R%, gndr)\r\rFor gndr = 1 To NGender - 1\r'            'In case normative goals are being chased\r'            edtergradgr(R%, gndr) = AMAX(edtergradgr(R%, gndr), edtergradgr(R%, NGender))\r'            FlowGoals gEdTerGrate(R%, gndr), edtergradgr(R%, gndr), 50, 120\r\r'If edtergradgr(R%, gndr) = 0 And edtergradgr(R%, NGender) = 0 Then\r\r'mti 2016/03/19 - start\r'mti November 28, 2011 - start\r'            If gndr = 1 Then\r'                TbName1$ = \"GDP/Capita (PPP) Versus Tertiary Gross Graduation Rate 5A Male Log (MostRecent)\" 'log works better at lower income\r'                TbName$ = \"GDP/Capita (PPP) Versus Tertiary Gross Graduation Rate 5A Male Logistic (MostRecent)\" 'logistic works better at higher income\r'            Else\r'                TbName1$ = \"GDP/Capita (PPP) Versus Tertiary Gross Graduation Rate 5A Female Log (MostRecent)\" 'log works better at lower income\r'                TbName$ = \"GDP/Capita (PPP) Versus Tertiary Gross Graduation Rate 5A Female Logistic (MostRecent)\" 'logistic works better at higher income\r'            End If\r\r'mti 2016/04/04 - start\r'EstimateFromMultiFunction TbName1$, TbName$, 15, 40, GDPPCP(R%), CalEDTerGRate, 0.1\r'EstimateFromMultiFunctionTer gndr%, 15, 40, GDPPCP(R%), CalEDTerGRate, 0.1\r\r'If GRPS(1,R%) = \"Germany\" Then Stop\r\r'mti 2017/07/13 start\r'New tertiary grad. rate model affected by tertiary enrollment and adult ter attainment (male is used)\r'            If gndr = 1 Then\r'                Call AnalFunc(\"Education, Tertiary Grad Rate Male (Logit) versus Enrlmnt, Attnmnt (M RECENT)\", _\r'                    Array(sEDTERENRATEG(R%, gndr%), sEdTerPer(R%, Male)), CalEDTerGRate, _\r'                    Array(\"EdTerEnrollment (Male)\", \"EdTerAttainmentAdult (Male)\"))\r'            Else\r'                Call AnalFunc(\"Education, Tertiary Grad Rate Fml (Logit) versus Enrlmnt, Attnmnt (M RECENT)\", _\r'                    Array(sEDTERENRATEG(R%, gndr%), sEdTerPer(R%, Male)), CalEDTerGRate, _\r'                     Array(\"EdTerEnrollment (Female)\", \"EdTerAttainmentAdult (Male)\"))\r'            End If\r\r'mti 2018/09/19 start\r'            If gndr = 1 Then\r'                Call AnalFunc(\"Education, Tertiary Grad Rate Male (Logit) versus Enrlmnt, Attnmnt (M RECENT)\", _\r'                    Array(sEdTerEnrG(R%, gndr%), sEdTerPer(R%, Male)), CalEDTerGRate, _\r'                    Array(\"EdTerEnrollment (Male)\", \"EdTerAttainmentAdult (Male)\"))\r'            Else\r'                Call AnalFunc(\"Education, Tertiary Grad Rate Fml (Logit) versus Enrlmnt, Attnmnt (M RECENT)\", _\r'                    Array(sEdTerEnrG(R%, gndr%), sEdTerPer(R%, Male)), CalEDTerGRate, _\r'                     Array(\"EdTerEnrollment (Female)\", \"EdTerAttainmentAdult (Male)\"))\r'            End If\r\rIf gndr = 1 Then\rCall XYTABL(\"GDP/Capita (PPP) Versus Tertiary Graduation Rate 1st Degree Male Log (MostRecent)\",\r                    GDPPCP(R%), CalEDTerGRate, context)\rElse\rCall XYTABL(\"GDP/Capita (PPP) Versus Tertiary Graduation Rate 1st Degree Female Log (MostRecent)\",\r                    GDPPCP(R%), CalEDTerGRate, context)\rEnd If\r'mti 2018/09/19 End\r\r'mti 2016/04/04 - end\r'mti 2017/07/13 End\r\r\r'mti July 25, 2012 - end\r'mti 2016/03/19 -end\r\r\r\r'            If GDPPCP(R%) <= 15 Then\r'                CalEDTerGRate = CalEDTerGRateLT10\r'            ElseIf GDPPCP(R%) >= 40 Then\r'                CalEDTerGRate = CalEDTerGRateGT20\r'            Else\r'                'CalEDTerGRate = (20 - GDPPCP(R%)) / 10 * CalEDTerGRateLT10 + (GDPPCP(R%) - 10) / 10 * CalEDTerGRateGT20\r'                CalEDTerGRate = (40 - GDPPCP(R%)) / 25 * CalEDTerGRateLT10 + (GDPPCP(R%) - 15) / 25 * CalEDTerGRateGT20\r'            End If\r\r'mti October 20, 2011 - end\r'mti November 28, 2011 - end\r'     If GRPS(1,R%) = \"United States of America\" Then Stop\r\r\r'     If GRPS(1,R%) = \"Barbados\" And IY > 45 Then Stop\r'     If GRPS(1,R%) = \"Belgium\" And IY > 45 Then Stop\r\r'mti 2016/12/09 start\r'Sur_Shift_Time = IIf(EdTerGRateShift(R%, gndr) > 0, 500, 70)\r'mti 2018/09/19 Start\r'Sur_Shift_Time = IIf(EdTerGRateShift(R%, gndr) > 0, 500, 30)\rSur_Shift_Time = If(EdTerGRateShift(R%, gndr) > 0, 500, 60)\r'mti 2018/09/19 End\r'mti 2016/12/09 End\r'converge to function - 70 years\r\r'EDTERGRATE(R%, gndr) = AMAX(0.1, Amin(120, CalEDTerGRate + ConvergeOverTime1(EdTerGRateShift(R%, gndr), 0, Sur_Shift_Time))) '50 '150 edexppconv\r\r\r'mti August 14, 2012 -start\r'EDTERGRATE(R%, gndr) = AMAX(0.1, CalEDTerGRate + ConvergeOverTime1(EdTerGRateShift(R%, gndr), 0, Sur_Shift_Time)) '50 '150 edexppcon\r'mti 2016/04/04 - start\r\r\r'mti 2018/09/19 Start\r\r\r\r'mti 2016/04/04a - start\r'mti 2016/12/09 start\r'EDTERGRATE(R%, gndr) = AMAX(0.1, Amin(EDTERINT(R%, gndr) - 1, CalEDTerGRate + ConvergeOverTime1(EdTerGRateShift(R%, gndr), 0, Sur_Shift_Time))) '50 '150 edexppcon\r\r'EDTERGRATE(R%, gndr) = AMAX(0.1, Amin(EDTERINT(R%, gndr) - 1, CalEDTerGRate + ConvergeOverTimeSmooth(EdTerGRateShift(R%, gndr), 0, Sur_Shift_Time))) '50 '150 edexppcon\rEDTERGRATE(R%, gndr) = AMAX(0.1, Amin(EDTERINT(R%, gndr) - 1, CalEDTerGRate + ConvergeOverTime(EdTerGRateShift(R%, gndr), 0, Sur_Shift_Time))) '50 '150 edexppcon\r\r'EDTERGRATE(R%, gndr) = AMAX(0.1, Amin(EDTERENRATEG(R%, gndr) - 3, CalEDTerGRate + ConvergeOverTime1(EdTerGRateShift(R%, gndr), 0, Sur_Shift_Time))) '50 '150 edexppcon\r'mti 2016/04/04a - end\r'mti 2016/12/09 End\r\r\r'mti 2018/06/18 Start\rEDTERGRATE(R%, gndr) = EDTERGRATE(R%, gndr) + AMAX(-5, Amin(5, EdEnrSecurImpact(R%, 3)))\r'mti 2018/06/18 End\r\r\r\r'mti 2016/04/04 -end\r\r'mti August 14, 2012 -end\r\r\r\r'        If GRPS(1,R%) = \"Equa Guinea\" And gndr = 1 Then Stop 'Debug.Print IY%; EDTERGRATE(R%, 1)\r\r'     If Mid(GRPS(1,R%), 1, 5) = \"Congo\" Then Stop\r'End If 'skip if normative goal\r\r\r'    If Mid(GRPS(1,R%), 1, 7) = \"China\" And gndr = 1 Then Debug.Print IY%; \",\"; sEdTerSurv; \",\"; sSurvImpact(R%, gndr, Tertiary); \",\"; EDTERGRATE(R%, gndr); \",\";\r\r'         Next gndr\r'\r'         'gender parity goal in tertiary intake\r'\r'\r''         If edtergndreqgrad(R%) <> 0 Then\r'            GenderParityCalc edtergndreqgrad(R%), edtergndreqgradI(R%), EDTERGRATE(R%, Male), EDTERGRATE(R%, Female)\r''         End If\r'\r'         For gndr = 1 To NGender - 1\r\r'mti 2018/09/19 Start\rEDTERGRATE(R%, gndr) = AMAX(0.1, Amin(85, EDTERGRATE(R%, gndr))) '70\r\r\r'demand determined graduation rate without multiplier and unbound- saved for multiplier application and bounding later (before budget)\riEdSurv(R%, gndr, Tertiary) = EDTERGRATE(R%, gndr)\r\r'demand determined graduation rate with bounds- used for unconstrained enrollment demand calculation\r\r'mti October 20, 2011 -start\r\r'mti November 28, 2011 - start\r\r'EDTERGRATE(R%, gndr) = AMAX(0.1, Amin(EDTERINT(R%, gndr), EDTERGRATE(R%, gndr)))\r\r'mti January 17, 2012 - start\r'EDTERGRATE(R%, gndr) = AMAX(0.1, Amin(85, EDTERGRATE(R%, gndr)))\r\r\r'mti 2016/04/04 - start\r\r'EDTERGRATE(R%, gndr) = AMAX(0.1, Amin(80, EDTERGRATE(R%, gndr))) '70\r'mti 2018/09/19 End\r\r'mti 2016/04/04 - end\r\r\r\r'mti January 17, 2012 - end\r\r'mti November 28, 2011 - end\r\r'mti October 20, 2011 -end\r\r'In case normative goals are being chased\r'            edtergradgr(R%, gndr) = AMAX(edtergradgr(R%, gndr), edtergradgr(R%, NGender))\r'            If edtergradgr(R%, gndr) <> 0 Then\r'mti 2014/05/28 - start\r'FlowGoals gEdTerGrate(R%, gndr), EDTERGRATE(R%, gndr), edtergradgr(R%, gndr), edtergradgr(R%, NGender), 50, 120\rFlowGoals(gEdTerGrate(R%, gndr), EDTERGRATE(R%, gndr), edtergradgr(R%, gndr), edtergradgr(R%, NGender), 50, 120, , edtergradtrgtyr(R%), iEdTerGrate(R%, gndr%))\r'mti 2014/05/28 - end\r'                EDTERGRATE(R%, gndr) = AMAX(EDTERGRATE(R%, gndr), gEdTerGrate(R%, gndr))\r'            End If\r\r'tertiary graduation multiplier\r'mti July 05, 2011 - start\r'          If gndr = 1 Then\r'            EXTRASTDRATIO(R%, Tertiary) = sSurvImpact(R%, gndr, Tertiary)\r'          End If\r'mti July 05, 2011 -end\r\rNext gndr\r\r'  If GRPS(1,R%) = \"India\" And IY = 31 Then Stop 'Debug.Print IY; EDTERINT(R%, 1), EDTERGRATE(R%, 1)\rGenderParityCalc(edtergndreqgrad(R%), EDTERGRATE(R%, Male), EDTERGRATE(R%, Female), \"Ter\")\r\rFor gndr = 1 To NGender - 1\r\r\r\r'            terpop(R%, gndr) = CalcPopFrom1Year(terStart, terlen, R%, gndr)\r\r'-- All years but First: Before Budget: Demand determined (unconstrained) gross enrollment ----------------\r\r'All years but first: Tertiary Initial: Droput rate using intake and graduation rates\r'mti 2022/03/16 Start\r'Dropoutrate = AMAX(0, 1 - (EDTERGRATE(R%, gndr) / EDTERINT(R%, gndr)) ^ (1 / terlen(R%)))\rDropoutrate = CSng(AMAX(0, 1 - (EDTERGRATE(R%, gndr) / terstudents(1, R%, gndr%)) ^ (1 / terlen(R%))))\r'mti 2022/03/16 End\r\r'All years but first: Tertiary Initial: Total Students\r'            Call GradeWiseEnrollmentCalc(R%, gndr, terStart, terlen, EDTERINT(R%, gndr), 0, _\r'terstudents(), SaveStudentCohorts(), 3, ud_EdEnrGCt(gndr, Tertiary), Dropoutrate, True)\r'       If GRPS(1,R%) = \"United States of America\" Then Stop\r'            If EDTERINT(R%, gndr) = 0 Then Stop\r'mti Jan 10, 2009\rud_EdEnrGCt(R%, gndr, Tertiary) = terpop(R%, gndr) * CalcEnrfromIntakeNSurv(5, EDTERINT(R%, gndr), 100 * EDTERGRATE(R%, gndr) / EDTERINT(R%, gndr), Dropoutrate) / 100\r\r'       If GRPS(1,R%) = \"Peru\" Then Stop\r'mti October 2008 adjust for shift, or total students for budget'll be less\rud_EdEnrGCt(R%, gndr, Tertiary) = ud_EdEnrGCt(R%, gndr, Tertiary) + terpop(R%, gndr) * (ConvergeOverTime1(edterenrgshift(R%, gndr), 0, CInt(edterenrgshiftCTime(R%, gndr))) / 100) '10 '100\r\r'-- All years but First: Before Budget: Demand determined (unconstrained) gross enrollment END ----------------\r\r'-- Demand determined (constrained with multiplier) intake, graduation and gross enrollment ----------------\r'intake with multiplier applied on saved unconstrained transition and then bounded\rEDTERINT(R%, gndr) = AMAX(0.5, Amin(120, iEdIntk(R%, gndr, Tertiary) * sIntakeImpact(R%, gndr, Tertiary)))\r\r\r'mti 2014/10/06 - start\r'take the higher between normative and demand side, if normative\r'EDTERINT(R%, gndr) = IIf(edterintgr(R%, gndr) <> 0, AMAX(gEdTerInt(R%, gndr), EDTERINT(R%, gndr)), EDTERINT(R%, gndr))\rIf edterintgr(R%, gndr) > 0 Or edterintgr(R%, NGender) > 0 Or edterinttrgtyr(R%) > 0 Then\rEDTERINT(R%, gndr) = AMAX(gEdTerInt(R%, gndr), EDTERINT(R%, gndr))\rEnd If\r'mti 2014/10/06 - end\r\r'intake transition with multiplier and bound for multiplier calculation later\r'             iEdIntk(R%,gndr, Tertiary) = EDTERINT(R%, gndr)\r\r'graduation rate with multiplier applied applied on saved unconstrained survival and then bounded\r\r\r'mti October 20, 2011 -start\r'EDTERGRATE(R%, gndr) = AMAX(0.1, Amin(120, iEdSurv(R%,gndr, Tertiary) * sSurvImpact(R%, gndr, Tertiary)))\r\r'mti November 28, 2011 - start\r'EDTERGRATE(R%, gndr) = AMAX(0.1, Amin(EDTERINT(R%, gndr), iEdSurv(R%,gndr, Tertiary) * sSurvImpact(R%, gndr, Tertiary)))\r\r'mti January 17, 2012 - start\r'EDTERGRATE(R%, gndr) = AMAX(0.1, Amin(85, iEdSurv(R%,gndr, Tertiary) * sSurvImpact(R%, gndr, Tertiary)))\r'mti 2018/09/19 Start\r'EDTERGRATE(R%, gndr) = AMAX(0.1, Amin(70, iEdSurv(R%, gndr, Tertiary) * sSurvImpact(R%, gndr, Tertiary)))\rEDTERGRATE(R%, gndr) = AMAX(0.1, Amin(85, iEdSurv(R%, gndr, Tertiary) * sSurvImpact(R%, gndr, Tertiary)))\r'mti 2018/09/19 End\r'mti January 17, 2012 - start\r\r'mti October 20, 2011 -end\r'mti November 28, 2011 - end\r\r'mti 2014/10/06 - start\r'take the higher between normative and demand side, if normative\r'EDTERGRATE(R%, gndr) = IIf(edtergradgr(R%, gndr) <> 0, AMAX(gEdTerGrate(R%, gndr), EDTERGRATE(R%, gndr)), EDTERGRATE(R%, gndr))\rIf edtergradgr(R%, gndr) > 0 Or edtergradgr(R%, NGender) > 0 Or edtergradtrgtyr(R%) > 0 Then\rEDTERGRATE(R%, gndr) = AMAX(gEdTerGrate(R%, gndr), EDTERGRATE(R%, gndr))\rEnd If\r'mti 2014/10/06 - end\r\r\r'save graduation rate with multiplier and bound for multiplier calculation later\r'             iEdSurv(R%,gndr, Tertiary) = EDTERGRATE(R%, gndr)\rNext gndr\r"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "gdsm",
    "Distance": 154,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "EDPRISUR",
    "Distance": 1571,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "edprisurm",
    "Distance": 1719,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "GDS",
    "Distance": 740,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "EDPRITOT",
    "Distance": 735,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "EDTERTOT",
    "Distance": 732,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "EDEXPERPRI",
    "Distance": 739,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "GDPPC",
    "Distance": 739,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "EDSECLOWRTOT",
    "Distance": 734,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "EDSECUPPRTOT",
    "Distance": 733,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "EDEXPERTER",
    "Distance": 736,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "EDEXPERSECLOWR",
    "Distance": 738,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "EDEXPERSECUPPR",
    "Distance": 737,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "GOVINDSECUR",
    "Distance": 409,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "GDPPCP",
    "Distance": 412,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "EDTERINT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "edqtqltrm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r\rPrivate Sub TertiaryTotals(R%, ByRef AdultMales As Single, ByRef AdultFemales As Single)\r'mti 2014/10/06 - take whole\r' Education Module\r\rEDTERINT(R%, Total) = CSng((EDTERINT(R%, Male) * fagedst(CInt(terstart(R%)), R%, Male) +\r                    EDTERINT(R%, Female) * fagedst(CInt(terstart(R%)), R%, Female)) /\r                AMAX(0.0000001, (fagedst(CInt(terstart(R%)), R%, Male) + fagedst(CInt(terstart(R%)), R%, Female))))\r\rEDTERGRATE(R%, Total) = CSng((EDTERGRATE(R%, Male) * fagedst(CInt(terstart(R%) + terlen(R%)), R%, Male) +\r                    EDTERGRATE(R%, Female) * fagedst(CInt(terstart(R%) + terlen(R%)), R%, Female)) /\r                AMAX(0.0000001, (fagedst(CInt(terstart(R%) + terlen(R%)), R%, Male) + fagedst(CInt(terstart(R%) + terlen(R%)), R%, Female))))\r\rDim TerMale, TerFemale As Single\r'ttt 2019/10/08\rTerMale = CalcPopFrom1YearDics(\"ter\")(R%, Male)\rTerFemale = CalcPopFrom1YearDics(\"ter\")(R%, Female)\r'TerMale = CalcPopFrom1Year(CInt(terstart(R%)), terlen(R%), R%, Male)\r'TerFemale = CalcPopFrom1Year(CInt(terstart(R%)), terlen(R%), R%, Female)\r\r\rEDTERENRG(R%, Total) = (EDTERENRG(R%, Male) * TerMale +\r                    EDTERENRG(R%, Female) * TerFemale) /\r                AMAX(0.0000001, TerMale + TerFemale)\r\r'mti 2016/01/07 -start\r\r'mti 2017/07/13  - Delete edterenrateg start\r'     EDTERENRATEG(R%, Total) = (EDTERENRATEG(R%, Male) * TerMale + _\r'EDTERENRATEG(R%, Female) * TerFemale) / _\r'AMAX(0.0000001, TerMale + TerFemale)\r'mti 2017/07/13  - Delete edterenrateg End\r\r'mti 2016/01/07 -end\r\r\rEDTERPER(R%, Total) = (EDTERPER(R%, 1) * AdultMales + EDTERPER(R%, 2) * AdultFemales) /\r                AMAX(0.0000001, (AdultMales + AdultFemales))\r\rEnd Sub\r"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "edpristart",
    "Distance": 583,
    "Code": "\r'mti 2019/12/09 End\r\r\rNext\r\r'First Year : Initiaize Intake and Survival Impact Values to 1\r'-------------------------------------------------------------\rFor lvl% = 1 To 5\rFor gndr = 1 To 2\rsIntakeImpact(R%, gndr, lvl%) = 1\rsSurvImpact(R%, gndr, lvl%) = 1\rNext\rsCostPerDelta(R%, lvl%) = 1\rNext\r\r'Cycle Length etc\r'----------------\rsecStart(R%) = edpristart(R%) + edprilen(R%)\r'seccohort(R%) = 1 + (edpristart(R%) + edprilen(R%)) \\ 5\r\rDim edseclenR = edseclowrlen(R%) + edsecupprlen(R%)\r\r'secendcohort(R%) = 1 + (edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r'upper secondary ends at this cohort\rusec(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r\rterendcohort(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR + 5) \\ 5\rterstart(R%) = edpristart(R%) + edprilen(R%) + edseclenR\rterlen(R%) = 5\r\rNext R%\r\r\r'mti 2019/12/09 End\r\r\rNext\r\r'First Year : Initiaize Intake and Survival Impact Values to 1\r'-------------------------------------------------------------\rFor lvl% = 1 To 5\rFor gndr = 1 To 2\rsIntakeImpact(R%, gndr, lvl%) = 1\rsSurvImpact(R%, gndr, lvl%) = 1\rNext\rsCostPerDelta(R%, lvl%) = 1\rNext\r\r'Cycle Length etc\r'----------------\rsecStart(R%) = edpristart(R%) + edprilen(R%)\r'seccohort(R%) = 1 + (edpristart(R%) + edprilen(R%)) \\ 5\r\rDim edseclenR = edseclowrlen(R%) + edsecupprlen(R%)\r\r'secendcohort(R%) = 1 + (edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r'upper secondary ends at this cohort\rusec(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r\rterendcohort(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR + 5) \\ 5\rterstart(R%) = edpristart(R%) + edprilen(R%) + edseclenR\rterlen(R%) = 5\r\rNext R%\r"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "edprilen",
    "Distance": 583,
    "Code": "\r'mti 2019/12/09 End\r\r\rNext\r\r'First Year : Initiaize Intake and Survival Impact Values to 1\r'-------------------------------------------------------------\rFor lvl% = 1 To 5\rFor gndr = 1 To 2\rsIntakeImpact(R%, gndr, lvl%) = 1\rsSurvImpact(R%, gndr, lvl%) = 1\rNext\rsCostPerDelta(R%, lvl%) = 1\rNext\r\r'Cycle Length etc\r'----------------\rsecStart(R%) = edpristart(R%) + edprilen(R%)\r'seccohort(R%) = 1 + (edpristart(R%) + edprilen(R%)) \\ 5\r\rDim edseclenR = edseclowrlen(R%) + edsecupprlen(R%)\r\r'secendcohort(R%) = 1 + (edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r'upper secondary ends at this cohort\rusec(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r\rterendcohort(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR + 5) \\ 5\rterstart(R%) = edpristart(R%) + edprilen(R%) + edseclenR\rterlen(R%) = 5\r\rNext R%\r\r"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "edseclowrlen",
    "Distance": 586,
    "Code": "\r'mti 2019/12/09 End\r\r\rNext\r\r'First Year : Initiaize Intake and Survival Impact Values to 1\r'-------------------------------------------------------------\rFor lvl% = 1 To 5\rFor gndr = 1 To 2\rsIntakeImpact(R%, gndr, lvl%) = 1\rsSurvImpact(R%, gndr, lvl%) = 1\rNext\rsCostPerDelta(R%, lvl%) = 1\rNext\r\r'Cycle Length etc\r'----------------\rsecStart(R%) = edpristart(R%) + edprilen(R%)\r'seccohort(R%) = 1 + (edpristart(R%) + edprilen(R%)) \\ 5\r\rDim edseclenR = edseclowrlen(R%) + edsecupprlen(R%)\r\r'secendcohort(R%) = 1 + (edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r'upper secondary ends at this cohort\rusec(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r\rterendcohort(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR + 5) \\ 5\rterstart(R%) = edpristart(R%) + edprilen(R%) + edseclenR\rterlen(R%) = 5\r\rNext R%\r"
  },
  {
    "Variable": "EDTERGRATE",
    "UsesVariable": "edsecupprlen",
    "Distance": 586,
    "Code": "\r'mti 2019/12/09 End\r\r\rNext\r\r'First Year : Initiaize Intake and Survival Impact Values to 1\r'-------------------------------------------------------------\rFor lvl% = 1 To 5\rFor gndr = 1 To 2\rsIntakeImpact(R%, gndr, lvl%) = 1\rsSurvImpact(R%, gndr, lvl%) = 1\rNext\rsCostPerDelta(R%, lvl%) = 1\rNext\r\r'Cycle Length etc\r'----------------\rsecStart(R%) = edpristart(R%) + edprilen(R%)\r'seccohort(R%) = 1 + (edpristart(R%) + edprilen(R%)) \\ 5\r\rDim edseclenR = edseclowrlen(R%) + edsecupprlen(R%)\r\r'secendcohort(R%) = 1 + (edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r'upper secondary ends at this cohort\rusec(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r\rterendcohort(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR + 5) \\ 5\rterstart(R%) = edpristart(R%) + edprilen(R%) + edseclenR\rterlen(R%) = 5\r\rNext R%\r"
  },
  {
    "Variable": "EDTERGRSCIEN",
    "UsesVariable": "edterscienshradd",
    "Distance": 0,
    "Code": "\rPrivate Sub CalEdTerSciEn(R%, ShiftVal!, context As IForecastContext)\r'mti November 20, 2011 -new proc\r'If GRPS(1,R%) = \"Bangladesh\" Then Stop\rDim CalEDTerGRSciEn = 0!\rCall XYTABL(\"GDP/Capita (PPP) Versus Tertiary SciEngg Graduation Share (MostRecent)\",\r                Amin(50, GDPPCP(R%)), CalEDTerGRSciEn, context)\r\rCalEDTerGRSciEn = AMAX(1, Amin(70, CalEDTerGRSciEn))\r\rIf ShiftVal < 0 Then\rEDTERGRSCIEN(R%) = AMAX(0.1, CalEDTerGRSciEn + ConvergeOverTime1(ShiftVal, 0, 30))\rElse\rEDTERGRSCIEN(R%) = AMAX(0.1, CalEDTerGRSciEn + ConvergeOverTime1(ShiftVal, 0, 100))\rEnd If\r\r'mti 2017/07/13 Start\rEDTERGRSCIEN(R%) = AMAX(0.1, Amin(70, EDTERGRSCIEN(R%) + edterscienshradd(R%)))\r'mti 2017/07/13 End\r\rEnd Sub\r"
  },
  {
    "Variable": "EDTERGRSCIEN",
    "UsesVariable": "GDPPCP",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "EDTERGRSCIEN",
    "UsesVariable": "EDTERGRATE",
    "Distance": 0,
    "Code": "\rsEdTerGrSciEn(R%) = EDTERGRSCIEN(R%) * EDTERGRATE(R%, 3) / 100\r"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "edterintm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "edterintgr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "edterinttrgtyr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "EDSECUPPRTRAN",
    "Distance": 32,
    "Code": "COMPLETE STRUCTURE:Next gndr 'mti Education Gender end gender loop:10453|\r\rFor gndr = 1 To NGender - 1\r'new budget code- moving average\r'sIntakeImpact(R%, gndr, Tertiary) = 0.8 * sIntakeImpact(R%, gndr, Tertiary) + 0.2 * EDTERINT(R%, gndr) / iEdIntk(R%,gndr, Tertiary)\r'sIntakeImpact(R%, gndr, Tertiary) = 0.8 * sIntakeImpact(R%, gndr, Tertiary) + 0.2 * sIntakeImpact(R%, gndr, Tertiary) * EDTERINT(R%, gndr) / iEdIntk(R%,gndr, Tertiary)\rsIntakeImpact(R%, gndr, Tertiary) = CSng(0.8 * sIntakeImpact(R%, gndr, Tertiary) + 0.2 * sIntakeImpact(R%, gndr, Tertiary) * fEdIntk(R%, gndr, Tertiary) / iEdIntk(R%, gndr, Tertiary))\rCOMPLETE STRUCTURE:Next R%:10594|\r\rGenderParityCalc(edsecupprgndreqtran(R%), EDSECUPPRTRAN(R%, Male), EDSECUPPRTRAN(R%, Female), \"SecUppr\")\rGenderParityCalc(edsecupprgndreqgrad(R%), EDSECUPPRGRATE(R%, Male), EDSECUPPRGRATE(R%, Female), \"SecUppr\")\r\rFor gndr = 1 To NGender - 1\r'mti 2023/11/28 end\r'save flow rates for multiplier calculation later\riEdIntk(R%, gndr, SecUppr) = EDSECUPPRTRAN(R%, gndr)\r\rFor gndr = 1 To NGender - 1\r'  If GRPS(1,R%) = \"Nepal\" Then Stop\r'Skip if normative goals are being chased\r'            'In case normative goals are being chased\r'            edterintgr(R%, gndr) = AMAX(edterintgr(R%, gndr), edterintgr(R%, NGender))\r'            FlowGoals gEdTerInt(R%, gndr), edterintgr(R%, gndr), 50, 120\r\r'All years but first: Tertiary Initial: Intake Rate\r'mti 2017/07/13  - start\rIf context.HistoricMode Then\rIf gndr = 1 Then\rTbName$ = \"GDP/Capita (PPP) Versus Tertiary Gross Intake Rate Male (2000)\"\rElse\rTbName$ = \"GDP/Capita (PPP) Versus Tertiary Gross Intake Rate Female (2000)\"\rEnd If\rElse\r\r\rIf gndr = 1 Then\r'TbName$ = \"GDP/Capita (PPP) Versus Tertiary Gross Intake Rate Male (MostRecent)\"\rCall AnalFunc(\"Ter Intake Male versus Sec Grads 20 to 24 Male, GDPPCP(Log) (Most Recent)\",\r                       New Single() {sEDSECPER20to24(R%, gndr%), GDPPCP(R%)}, CalEDTerInt,\r                      New String() {\"EDSECPER20TO24 (Male)\", \"GDPPCP (Log)\"}, context)\rElse\r'TbName$ = \"GDP/Capita (PPP) Versus Tertiary Gross Intake Rate Female (MostRecent)\"\rCall AnalFunc(\"Ter Intake Female versus Sec Grads 20 to 24 Female, GDPPCP(Log) (Most Recent)\",\r                       New Single() {sEDSECPER20to24(R%, gndr%), GDPPCP(R%)}, CalEDTerInt,\r                      New String() {\"EDSECPER20TO24 (Female)\", \"GDPPCP (Log)\"}, context)\rEnd If\r\rEnd If\r'   If GRPS(1,R%) = \"Yemen\" And IY > 5 Then Stop\r\r'Call XYTABL(TbName$, GDPPCP(R%), CalEDTerInt)\r'mti 2017/07/13  - End\r'CalEDTerInt = AMAX(0.5, Amin(120, CalEDTerInt))\rCalEDTerInt = AMAX(0.5, CalEDTerInt)\r'converge to function - 70 years\r'TerIntShiftTime = 70\r\r'mti 2016/12/09 start\r'TerIntShiftTime = IIf(EdTerIntRateShift(R%, gndr) > 0, 500, 70)\rTerIntShiftTime = If(EdTerIntRateShift(R%, gndr) > 0, 500, 50) '30\r'mti 2017/07/13  - End\r\r\r'EDTERINT(R%, gndr) = AMAX(0.5, Amin(120, CalEDTerInt + ConvergeOverTime1(EdTerIntRateShift(R%, gndr), 0, TerIntShiftTime)))\r'mti 2019/03/01 start\r'EDTERINT(R%, gndr) = AMAX(0.5, CalEDTerInt + ConvergeOverTimeSmooth(EdTerIntRateShift(R%, gndr), 0, TerIntShiftTime))\r'mti 2019/12/22 start - this needs a pre-processor fix to implement the bound\rEDTERINT(R%, gndr) = AMAX(0.5, CalEDTerInt + ConvergeOverTimeSmooth(EdTerIntRateShift(R%, gndr), 0, TerIntShiftTime))\r'EDTERINT(R%, gndr) = CSng(Amin(sEDSECPER20to24(R%, gndr%) * 1.1, AMAX(0.5, CalEDTerInt + ConvergeOverTimeSmooth(EdTerIntRateShift(R%, gndr), 0, TerIntShiftTime))))\r'mti 2019/12/22 End\r\r'mti 2019/03/01 End\r'mti 2016/12/09 End ConvergeOverTimeSmooth\r\r\r'End If 'Skip if normative goals are being chased\r\r'         Next gndr\r'\r''         'gender parity goal in tertiary intake\r'\r'\r''         If edtergndreqint(R%) <> 0 Then\r'            GenderParityCalc edtergndreqint(R%), edtergndreqintI(R%), EDTERINT(R%, Male), EDTERINT(R%, Female)\r''         End If\r'\r'         For gndr = 1 To NGender - 1\r\r\r'            'mti November 29, 2008 - added this\r'            'moving average on tertiary intake rate\r''            iEdIntk(R%,gndr, Tertiary) = EDTERINT(R%, gndr)\r'            EDTERINT(R%, gndr) = AMAX(0.5, Amin(120, EDTERINT(R%, gndr) * sIntakeImpact(R%, gndr, Tertiary)))\r'            iEdIntk(R%,gndr, Tertiary) = EDTERINT(R%, gndr)\r\r'demand determined intake without multiplier and unbound- saved for multiplier application and bounding later (before budget)\riEdIntk(R%, gndr, Tertiary) = EDTERINT(R%, gndr)\r\r'demand determined intake with bounds- used for unconstrained enrollment demand calculation\rEDTERINT(R%, gndr) = AMAX(0.5, Amin(120, EDTERINT(R%, gndr)))\r\r'mti October 20, 2011 - start\rIf EDTERINT(R%, gndr) > 105 Then\rEDTERINT(R%, gndr) = ConvergeOverTime(EDTERINT(R%, gndr), 100, 40)\rEnd If\r'mti October 20, 2011 -end\r\r'In case normative goals are being chased\r'            edterintgr(R%, gndr) = AMAX(edterintgr(R%, gndr), edterintgr(R%, NGender))\r'            If edterintgr(R%, gndr) <> 0 Then\r'mti 2014/05/28 - start\r'FlowGoals gEdTerInt(R%, gndr), EDTERINT(R%, gndr), edterintgr(R%, gndr), edterintgr(R%, NGender), 50, 120\rFlowGoals(gEdTerInt(R%, gndr), EDTERINT(R%, gndr), edterintgr(R%, gndr), edterintgr(R%, NGender), 50, 120, , edterinttrgtyr(R%), iEdTerInt(R%, gndr%))\r'mti 2014/05/28 - end\r'                EDTERINT(R%, gndr) = AMAX(EDTERINT(R%, gndr), gEdTerInt(R%, gndr))\r'            End If\r\r\rNext gndr\r\r'  If GRPS(1,R%) = \"India\" And IY = 31 Then Stop 'Debug.Print IY; EDTERINT(R%, 1), EDTERGRATE(R%, 1)\rGenderParityCalc(edtergndreqgrad(R%), EDTERGRATE(R%, Male), EDTERGRATE(R%, Female), \"Ter\")\r\rFor gndr = 1 To NGender - 1\r\r\r\r'            terpop(R%, gndr) = CalcPopFrom1Year(terStart, terlen, R%, gndr)\r\r'-- All years but First: Before Budget: Demand determined (unconstrained) gross enrollment ----------------\r\r'All years but first: Tertiary Initial: Droput rate using intake and graduation rates\r'mti 2022/03/16 Start\r'Dropoutrate = AMAX(0, 1 - (EDTERGRATE(R%, gndr) / EDTERINT(R%, gndr)) ^ (1 / terlen(R%)))\rDropoutrate = CSng(AMAX(0, 1 - (EDTERGRATE(R%, gndr) / terstudents(1, R%, gndr%)) ^ (1 / terlen(R%))))\r'mti 2022/03/16 End\r\r'All years but first: Tertiary Initial: Total Students\r'            Call GradeWiseEnrollmentCalc(R%, gndr, terStart, terlen, EDTERINT(R%, gndr), 0, _\r'terstudents(), SaveStudentCohorts(), 3, ud_EdEnrGCt(gndr, Tertiary), Dropoutrate, True)\r'       If GRPS(1,R%) = \"United States of America\" Then Stop\r'            If EDTERINT(R%, gndr) = 0 Then Stop\r'mti Jan 10, 2009\rud_EdEnrGCt(R%, gndr, Tertiary) = terpop(R%, gndr) * CalcEnrfromIntakeNSurv(5, EDTERINT(R%, gndr), 100 * EDTERGRATE(R%, gndr) / EDTERINT(R%, gndr), Dropoutrate) / 100\r\r'       If GRPS(1,R%) = \"Peru\" Then Stop\r'mti October 2008 adjust for shift, or total students for budget'll be less\rud_EdEnrGCt(R%, gndr, Tertiary) = ud_EdEnrGCt(R%, gndr, Tertiary) + terpop(R%, gndr) * (ConvergeOverTime1(edterenrgshift(R%, gndr), 0, CInt(edterenrgshiftCTime(R%, gndr))) / 100) '10 '100\r\r'-- All years but First: Before Budget: Demand determined (unconstrained) gross enrollment END ----------------\r\r'-- Demand determined (constrained with multiplier) intake, graduation and gross enrollment ----------------\r'intake with multiplier applied on saved unconstrained transition and then bounded\rEDTERINT(R%, gndr) = AMAX(0.5, Amin(120, iEdIntk(R%, gndr, Tertiary) * sIntakeImpact(R%, gndr, Tertiary)))\r\r\r'mti 2014/10/06 - start\r'take the higher between normative and demand side, if normative\r'EDTERINT(R%, gndr) = IIf(edterintgr(R%, gndr) <> 0, AMAX(gEdTerInt(R%, gndr), EDTERINT(R%, gndr)), EDTERINT(R%, gndr))\rIf edterintgr(R%, gndr) > 0 Or edterintgr(R%, NGender) > 0 Or edterinttrgtyr(R%) > 0 Then\rEDTERINT(R%, gndr) = AMAX(gEdTerInt(R%, gndr), EDTERINT(R%, gndr))\rEnd If\r'mti 2014/10/06 - end\r\r'intake transition with multiplier and bound for multiplier calculation later\r'             iEdIntk(R%,gndr, Tertiary) = EDTERINT(R%, gndr)\r\r'graduation rate with multiplier applied applied on saved unconstrained survival and then bounded\r\r\r'mti October 20, 2011 -start\r'EDTERGRATE(R%, gndr) = AMAX(0.1, Amin(120, iEdSurv(R%,gndr, Tertiary) * sSurvImpact(R%, gndr, Tertiary)))\r\r'mti November 28, 2011 - start\r'EDTERGRATE(R%, gndr) = AMAX(0.1, Amin(EDTERINT(R%, gndr), iEdSurv(R%,gndr, Tertiary) * sSurvImpact(R%, gndr, Tertiary)))\r\r'mti January 17, 2012 - start\r'EDTERGRATE(R%, gndr) = AMAX(0.1, Amin(85, iEdSurv(R%,gndr, Tertiary) * sSurvImpact(R%, gndr, Tertiary)))\r'mti 2018/09/19 Start\r'EDTERGRATE(R%, gndr) = AMAX(0.1, Amin(70, iEdSurv(R%, gndr, Tertiary) * sSurvImpact(R%, gndr, Tertiary)))\rEDTERGRATE(R%, gndr) = AMAX(0.1, Amin(85, iEdSurv(R%, gndr, Tertiary) * sSurvImpact(R%, gndr, Tertiary)))\r'mti 2018/09/19 End\r'mti January 17, 2012 - start\r\r'mti October 20, 2011 -end\r'mti November 28, 2011 - end\r\r'mti 2014/10/06 - start\r'take the higher between normative and demand side, if normative\r'EDTERGRATE(R%, gndr) = IIf(edtergradgr(R%, gndr) <> 0, AMAX(gEdTerGrate(R%, gndr), EDTERGRATE(R%, gndr)), EDTERGRATE(R%, gndr))\rIf edtergradgr(R%, gndr) > 0 Or edtergradgr(R%, NGender) > 0 Or edtergradtrgtyr(R%) > 0 Then\rEDTERGRATE(R%, gndr) = AMAX(gEdTerGrate(R%, gndr), EDTERGRATE(R%, gndr))\rEnd If\r'mti 2014/10/06 - end\r\r\r'save graduation rate with multiplier and bound for multiplier calculation later\r'             iEdSurv(R%,gndr, Tertiary) = EDTERGRATE(R%, gndr)\rNext gndr\r"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "gdsm",
    "Distance": 161,
    "Code": "0"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "EDPRIINTN",
    "Distance": 1570,
    "Code": "0"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "edpriintnm",
    "Distance": 1731,
    "Code": "0"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "GDS",
    "Distance": 738,
    "Code": "0"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "EDPRITOT",
    "Distance": 733,
    "Code": "0"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "EDTERTOT",
    "Distance": 730,
    "Code": "0"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "EDEXPERPRI",
    "Distance": 737,
    "Code": "0"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "GDPPC",
    "Distance": 737,
    "Code": "0"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "EDSECLOWRTOT",
    "Distance": 732,
    "Code": "0"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "EDSECUPPRTOT",
    "Distance": 731,
    "Code": "0"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "EDEXPERTER",
    "Distance": 734,
    "Code": "0"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "EDEXPERSECLOWR",
    "Distance": 736,
    "Code": "0"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "EDEXPERSECUPPR",
    "Distance": 735,
    "Code": "0"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "EDSECPER20TO24",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "GDPPCP",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "edqtqltrm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r\rPrivate Sub TertiaryTotals(R%, ByRef AdultMales As Single, ByRef AdultFemales As Single)\r'mti 2014/10/06 - take whole\r' Education Module\r\rEDTERINT(R%, Total) = CSng((EDTERINT(R%, Male) * fagedst(CInt(terstart(R%)), R%, Male) +\r                    EDTERINT(R%, Female) * fagedst(CInt(terstart(R%)), R%, Female)) /\r                AMAX(0.0000001, (fagedst(CInt(terstart(R%)), R%, Male) + fagedst(CInt(terstart(R%)), R%, Female))))\r\rEDTERGRATE(R%, Total) = CSng((EDTERGRATE(R%, Male) * fagedst(CInt(terstart(R%) + terlen(R%)), R%, Male) +\r                    EDTERGRATE(R%, Female) * fagedst(CInt(terstart(R%) + terlen(R%)), R%, Female)) /\r                AMAX(0.0000001, (fagedst(CInt(terstart(R%) + terlen(R%)), R%, Male) + fagedst(CInt(terstart(R%) + terlen(R%)), R%, Female))))\r\rDim TerMale, TerFemale As Single\r'ttt 2019/10/08\rTerMale = CalcPopFrom1YearDics(\"ter\")(R%, Male)\rTerFemale = CalcPopFrom1YearDics(\"ter\")(R%, Female)\r'TerMale = CalcPopFrom1Year(CInt(terstart(R%)), terlen(R%), R%, Male)\r'TerFemale = CalcPopFrom1Year(CInt(terstart(R%)), terlen(R%), R%, Female)\r\r\rEDTERENRG(R%, Total) = (EDTERENRG(R%, Male) * TerMale +\r                    EDTERENRG(R%, Female) * TerFemale) /\r                AMAX(0.0000001, TerMale + TerFemale)\r\r'mti 2016/01/07 -start\r\r'mti 2017/07/13  - Delete edterenrateg start\r'     EDTERENRATEG(R%, Total) = (EDTERENRATEG(R%, Male) * TerMale + _\r'EDTERENRATEG(R%, Female) * TerFemale) / _\r'AMAX(0.0000001, TerMale + TerFemale)\r'mti 2017/07/13  - Delete edterenrateg End\r\r'mti 2016/01/07 -end\r\r\rEDTERPER(R%, Total) = (EDTERPER(R%, 1) * AdultMales + EDTERPER(R%, 2) * AdultFemales) /\r                AMAX(0.0000001, (AdultMales + AdultFemales))\r\rEnd Sub\r"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "edpristart",
    "Distance": 582,
    "Code": "\r'mti 2019/12/09 End\r\r\rNext\r\r'First Year : Initiaize Intake and Survival Impact Values to 1\r'-------------------------------------------------------------\rFor lvl% = 1 To 5\rFor gndr = 1 To 2\rsIntakeImpact(R%, gndr, lvl%) = 1\rsSurvImpact(R%, gndr, lvl%) = 1\rNext\rsCostPerDelta(R%, lvl%) = 1\rNext\r\r'Cycle Length etc\r'----------------\rsecStart(R%) = edpristart(R%) + edprilen(R%)\r'seccohort(R%) = 1 + (edpristart(R%) + edprilen(R%)) \\ 5\r\rDim edseclenR = edseclowrlen(R%) + edsecupprlen(R%)\r\r'secendcohort(R%) = 1 + (edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r'upper secondary ends at this cohort\rusec(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r\rterendcohort(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR + 5) \\ 5\rterstart(R%) = edpristart(R%) + edprilen(R%) + edseclenR\rterlen(R%) = 5\r\rNext R%\r"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "edprilen",
    "Distance": 582,
    "Code": "\r'mti 2019/12/09 End\r\r\rNext\r\r'First Year : Initiaize Intake and Survival Impact Values to 1\r'-------------------------------------------------------------\rFor lvl% = 1 To 5\rFor gndr = 1 To 2\rsIntakeImpact(R%, gndr, lvl%) = 1\rsSurvImpact(R%, gndr, lvl%) = 1\rNext\rsCostPerDelta(R%, lvl%) = 1\rNext\r\r'Cycle Length etc\r'----------------\rsecStart(R%) = edpristart(R%) + edprilen(R%)\r'seccohort(R%) = 1 + (edpristart(R%) + edprilen(R%)) \\ 5\r\rDim edseclenR = edseclowrlen(R%) + edsecupprlen(R%)\r\r'secendcohort(R%) = 1 + (edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r'upper secondary ends at this cohort\rusec(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r\rterendcohort(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR + 5) \\ 5\rterstart(R%) = edpristart(R%) + edprilen(R%) + edseclenR\rterlen(R%) = 5\r\rNext R%\r"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "edseclowrlen",
    "Distance": 585,
    "Code": "\r'mti 2019/12/09 End\r\r\rNext\r\r'First Year : Initiaize Intake and Survival Impact Values to 1\r'-------------------------------------------------------------\rFor lvl% = 1 To 5\rFor gndr = 1 To 2\rsIntakeImpact(R%, gndr, lvl%) = 1\rsSurvImpact(R%, gndr, lvl%) = 1\rNext\rsCostPerDelta(R%, lvl%) = 1\rNext\r\r'Cycle Length etc\r'----------------\rsecStart(R%) = edpristart(R%) + edprilen(R%)\r'seccohort(R%) = 1 + (edpristart(R%) + edprilen(R%)) \\ 5\r\rDim edseclenR = edseclowrlen(R%) + edsecupprlen(R%)\r\r'secendcohort(R%) = 1 + (edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r'upper secondary ends at this cohort\rusec(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r\rterendcohort(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR + 5) \\ 5\rterstart(R%) = edpristart(R%) + edprilen(R%) + edseclenR\rterlen(R%) = 5\r\rNext R%\r"
  },
  {
    "Variable": "EDTERINT",
    "UsesVariable": "edsecupprlen",
    "Distance": 585,
    "Code": "\r'mti 2019/12/09 End\r\r\rNext\r\r'First Year : Initiaize Intake and Survival Impact Values to 1\r'-------------------------------------------------------------\rFor lvl% = 1 To 5\rFor gndr = 1 To 2\rsIntakeImpact(R%, gndr, lvl%) = 1\rsSurvImpact(R%, gndr, lvl%) = 1\rNext\rsCostPerDelta(R%, lvl%) = 1\rNext\r\r'Cycle Length etc\r'----------------\rsecStart(R%) = edpristart(R%) + edprilen(R%)\r'seccohort(R%) = 1 + (edpristart(R%) + edprilen(R%)) \\ 5\r\rDim edseclenR = edseclowrlen(R%) + edsecupprlen(R%)\r\r'secendcohort(R%) = 1 + (edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r'upper secondary ends at this cohort\rusec(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR) \\ 5\r\rterendcohort(R%) = 1 + CInt(edpristart(R%) + edprilen(R%) + edseclenR + 5) \\ 5\rterstart(R%) = edpristart(R%) + edprilen(R%) + edseclenR\rterlen(R%) = 5\r\rNext R%\r"
  },
  {
    "Variable": "EDTERPER",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDTERTOT",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "EDTERTOT",
    "UsesVariable": "EDTERENRG",
    "Distance": 2439,
    "Code": "0"
  },
  {
    "Variable": "EDYRSAG15",
    "UsesVariable": "EDPRIPER",
    "Distance": 225,
    "Code": "0"
  },
  {
    "Variable": "EDYRSAG15",
    "UsesVariable": "edpristart",
    "Distance": 1166,
    "Code": "\r\r'rate of upper secondary graduation (current school graduation rate)\rDim Grate As Single = AMAX(1, Amin(100, EDPRICR(R%, gndr%)))\r"
  },
  {
    "Variable": "EDYRSAG15",
    "UsesVariable": "edprilen",
    "Distance": 1166,
    "Code": "\r\r'rate of upper secondary graduation (current school graduation rate)\rDim Grate As Single = AMAX(1, Amin(100, EDPRICR(R%, gndr%)))\r"
  },
  {
    "Variable": "EDYRSAG15",
    "UsesVariable": "edseclowrlen",
    "Distance": 1166,
    "Code": "\r\r'rate of upper secondary graduation (current school graduation rate)\rDim Grate As Single = AMAX(1, Amin(100, EDPRICR(R%, gndr%)))\r"
  },
  {
    "Variable": "EDYRSAG15",
    "UsesVariable": "edsecupprlen",
    "Distance": 1166,
    "Code": "\r\r'rate of upper secondary graduation (current school graduation rate)\rDim Grate As Single = AMAX(1, Amin(100, EDPRICR(R%, gndr%)))\r"
  },
  {
    "Variable": "EDYRSAG15",
    "UsesVariable": "EDTERGRATE",
    "Distance": 63,
    "Code": "\r\r\r'mti 2024/03/25 changed start\rIf SEPPRI(R%, gndr) > 1 Then\r'Nigeria DRC etc where current graduation rate is less than 15+ completion share\rsecgrate = AMAX(1, Amin(100, secgrate * ConvergeOverTime(SEPPRI(R%, gndr), 1, 150)))\rElse\rsecgrate = AMAX(1, Amin(100, secgrate * ConvergeOverTime(SEPPRI(R%, gndr), 1, 15)))\rEnd If\r\r\r'        caledsecupprgradsgen = fagedst(secStart(R%) + edseclowrlen(R%) + edsecupprlen(R%), R%, gndr) * (caledsecupprgrategen / 100)\r\r'All Years but First: Upper Secondary Final:  add genders\r'mti Oct 24, 2012 - start\r'        EDSECUPPRTOT(R%, Total) = EDSECUPPRTOT(R%, Total) + EDSECUPPRTOT(R%, gndr)\r'        EDSECUPPRGRADS(R%, Total) = EDSECUPPRGRADS(R%, Total) + EDSECUPPRGRADS(R%, gndr)\r'mti Oct 24, 2012 - end\r\r'All Years but First: Upper Secondary Final: Percentage with completed (upper) secondary education\r'If GRPS(1,R%) = \"Equa Guinea\" Then Stop\r'mti September 04, 2009 -brought it up for code documentation purpose\r'empty out cohorts below secondary age\rFor j% = 4 To CInt(usec(R%) - 1) Step 1\rEdUpprSecPopPer(j%, R%, gndr) = 0\rNext j%\r\r\r\r'mti 2024/03/25 changed start\rIf SEPPRI(R%, gndr) > 1 Then\r'Nigeria DRC etc where current graduation rate is less than 15+ completion share\rsecgrate = AMAX(1, Amin(100, secgrate * ConvergeOverTime(SEPPRI(R%, gndr), 1, 150)))\rElse\rsecgrate = AMAX(1, Amin(100, secgrate * ConvergeOverTime(SEPPRI(R%, gndr), 1, 15)))\rEnd If\r"
  },
  {
    "Variable": "EDYRSAG15",
    "UsesVariable": "EDPRICR",
    "Distance": 226,
    "Code": "\r\r\r'mti 2024/03/25 changed start\rIf SEPPRI(R%, gndr) > 1 Then\r'Nigeria DRC etc where current graduation rate is less than 15+ completion share\rsecgrate = AMAX(1, Amin(100, secgrate * ConvergeOverTime(SEPPRI(R%, gndr), 1, 150)))\rElse\rsecgrate = AMAX(1, Amin(100, secgrate * ConvergeOverTime(SEPPRI(R%, gndr), 1, 15)))\rEnd If\r"
  },
  {
    "Variable": "EDYRSAG15",
    "UsesVariable": "EDSECUPPRGRATE",
    "Distance": 1165,
    "Code": "0"
  },
  {
    "Variable": "EDYRSAG15TO24",
    "UsesVariable": "EDPRIPER",
    "Distance": 226,
    "Code": "0"
  },
  {
    "Variable": "EDYRSAG15TO24",
    "UsesVariable": "edpristart",
    "Distance": 1167,
    "Code": "\r\r'rate of upper secondary graduation (current school graduation rate)\rDim Grate As Single = AMAX(1, Amin(100, EDPRICR(R%, gndr%)))\r"
  },
  {
    "Variable": "EDYRSAG15TO24",
    "UsesVariable": "edprilen",
    "Distance": 1167,
    "Code": "\r\r'rate of upper secondary graduation (current school graduation rate)\rDim Grate As Single = AMAX(1, Amin(100, EDPRICR(R%, gndr%)))\r"
  },
  {
    "Variable": "EDYRSAG15TO24",
    "UsesVariable": "edseclowrlen",
    "Distance": 1167,
    "Code": "\r\r'rate of upper secondary graduation (current school graduation rate)\rDim Grate As Single = AMAX(1, Amin(100, EDPRICR(R%, gndr%)))\r"
  },
  {
    "Variable": "EDYRSAG15TO24",
    "UsesVariable": "edsecupprlen",
    "Distance": 1167,
    "Code": "\r\r'rate of upper secondary graduation (current school graduation rate)\rDim Grate As Single = AMAX(1, Amin(100, EDPRICR(R%, gndr%)))\r"
  },
  {
    "Variable": "EDYRSAG15TO24",
    "UsesVariable": "EDTERGRATE",
    "Distance": 64,
    "Code": "\r\r\r'mti 2024/03/25 changed start\rIf SEPPRI(R%, gndr) > 1 Then\r'Nigeria DRC etc where current graduation rate is less than 15+ completion share\rsecgrate = AMAX(1, Amin(100, secgrate * ConvergeOverTime(SEPPRI(R%, gndr), 1, 150)))\rElse\rsecgrate = AMAX(1, Amin(100, secgrate * ConvergeOverTime(SEPPRI(R%, gndr), 1, 15)))\rEnd If\r\r\r'        caledsecupprgradsgen = fagedst(secStart(R%) + edseclowrlen(R%) + edsecupprlen(R%), R%, gndr) * (caledsecupprgrategen / 100)\r\r'All Years but First: Upper Secondary Final:  add genders\r'mti Oct 24, 2012 - start\r'        EDSECUPPRTOT(R%, Total) = EDSECUPPRTOT(R%, Total) + EDSECUPPRTOT(R%, gndr)\r'        EDSECUPPRGRADS(R%, Total) = EDSECUPPRGRADS(R%, Total) + EDSECUPPRGRADS(R%, gndr)\r'mti Oct 24, 2012 - end\r\r'All Years but First: Upper Secondary Final: Percentage with completed (upper) secondary education\r'If GRPS(1,R%) = \"Equa Guinea\" Then Stop\r'mti September 04, 2009 -brought it up for code documentation purpose\r'empty out cohorts below secondary age\rFor j% = 4 To CInt(usec(R%) - 1) Step 1\rEdUpprSecPopPer(j%, R%, gndr) = 0\rNext j%\r\r\r\r'mti 2024/03/25 changed start\rIf SEPPRI(R%, gndr) > 1 Then\r'Nigeria DRC etc where current graduation rate is less than 15+ completion share\rsecgrate = AMAX(1, Amin(100, secgrate * ConvergeOverTime(SEPPRI(R%, gndr), 1, 150)))\rElse\rsecgrate = AMAX(1, Amin(100, secgrate * ConvergeOverTime(SEPPRI(R%, gndr), 1, 15)))\rEnd If\r"
  },
  {
    "Variable": "EDYRSAG15TO24",
    "UsesVariable": "EDPRICR",
    "Distance": 227,
    "Code": "\r\r\r'mti 2024/03/25 changed start\rIf SEPPRI(R%, gndr) > 1 Then\r'Nigeria DRC etc where current graduation rate is less than 15+ completion share\rsecgrate = AMAX(1, Amin(100, secgrate * ConvergeOverTime(SEPPRI(R%, gndr), 1, 150)))\rElse\rsecgrate = AMAX(1, Amin(100, secgrate * ConvergeOverTime(SEPPRI(R%, gndr), 1, 15)))\rEnd If\r"
  },
  {
    "Variable": "EDYRSAG15TO24",
    "UsesVariable": "EDSECUPPRGRATE",
    "Distance": 1166,
    "Code": "0"
  },
  {
    "Variable": "EDYRSAG25",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "\rEdTerPopPer(TerEndCohortNo + 1, R%, gndr%) = Amin(100, AMAX(0.01, Grate))\r\r'secgrate = AMAX(1, Amin(100, secgrate * ConvergeOverTime(SEPPRI(R%, gndr), 1, 15))) 'mti 2024/03/25 changed 15 to 150\r'mti 2024/03/25 end\r\r\rEdUpprSecPopPer(CInt(usec(R%) + 1), R%, gndr) = AMAX(0.001, Amin(100, (EdUpprSecPopPer(CInt(usec(R%) + 1), R%, gndr) * 4 + secgrate) / 5))\r\r\r'mti Nov 25, 2011 - end\r'      If GRPS(1,R%) = \"China\" Then Stop\rIf sec1stcohortpart = 0 Then\rEdUpprSecPopPer(CInt(usec(R%)), R%, gndr) = 0\rElse\r'EdUpprSecPopPer(CInt(usec(R%)), R%, gndr) = Amin(100, AMAX(0.001, sec1stcohortpart * EDSECUPPRGRATE(R%, gndr) * ConvergeOverTime(SEPPRI(R%, gndr), 1, 15)))\rEdUpprSecPopPer(CInt(usec(R%)), R%, gndr) = Amin(100, AMAX(0.001, sec1stcohortpart * secgrate))\rEnd If\r\r\r'mti Nov 25, 2011 - end\r'      If GRPS(1,R%) = \"China\" Then Stop\rIf sec1stcohortpart = 0 Then\rEdUpprSecPopPer(CInt(usec(R%)), R%, gndr) = 0\rElse\r'EdUpprSecPopPer(CInt(usec(R%)), R%, gndr) = Amin(100, AMAX(0.001, sec1stcohortpart * EDSECUPPRGRATE(R%, gndr) * ConvergeOverTime(SEPPRI(R%, gndr), 1, 15)))\rEdUpprSecPopPer(CInt(usec(R%)), R%, gndr) = Amin(100, AMAX(0.001, sec1stcohortpart * secgrate))\rEnd If\r\rIf EdPriPopPer(4, R%, gndr%) < AdultCompletionRate Then EdPriPopPer(4, R%, gndr%) = AdultCompletionRate\r\r'Doc EDYRSAG25(R%, Total) = EdPriPopPer() + EdUpprSecPopPer() + EdTerPopPer()\r"
  },
  {
    "Variable": "EDYRSAG25",
    "UsesVariable": "EDPRIPER",
    "Distance": 227,
    "Code": "0"
  },
  {
    "Variable": "EDYRSAG25",
    "UsesVariable": "edpristart",
    "Distance": 1168,
    "Code": "\r\r'rate of upper secondary graduation (current school graduation rate)\rDim Grate As Single = AMAX(1, Amin(100, EDPRICR(R%, gndr%)))\r"
  },
  {
    "Variable": "EDYRSAG25",
    "UsesVariable": "edprilen",
    "Distance": 1168,
    "Code": "\r\r'rate of upper secondary graduation (current school graduation rate)\rDim Grate As Single = AMAX(1, Amin(100, EDPRICR(R%, gndr%)))\r"
  },
  {
    "Variable": "EDYRSAG25",
    "UsesVariable": "edseclowrlen",
    "Distance": 1168,
    "Code": "\r\r'rate of upper secondary graduation (current school graduation rate)\rDim Grate As Single = AMAX(1, Amin(100, EDPRICR(R%, gndr%)))\r"
  },
  {
    "Variable": "EDYRSAG25",
    "UsesVariable": "edsecupprlen",
    "Distance": 1168,
    "Code": "\r\r'rate of upper secondary graduation (current school graduation rate)\rDim Grate As Single = AMAX(1, Amin(100, EDPRICR(R%, gndr%)))\r"
  },
  {
    "Variable": "EDYRSAG25",
    "UsesVariable": "EDTERGRATE",
    "Distance": 65,
    "Code": "\r\r\r'mti 2024/03/25 changed start\rIf SEPPRI(R%, gndr) > 1 Then\r'Nigeria DRC etc where current graduation rate is less than 15+ completion share\rsecgrate = AMAX(1, Amin(100, secgrate * ConvergeOverTime(SEPPRI(R%, gndr), 1, 150)))\rElse\rsecgrate = AMAX(1, Amin(100, secgrate * ConvergeOverTime(SEPPRI(R%, gndr), 1, 15)))\rEnd If\r\r\r'        caledsecupprgradsgen = fagedst(secStart(R%) + edseclowrlen(R%) + edsecupprlen(R%), R%, gndr) * (caledsecupprgrategen / 100)\r\r'All Years but First: Upper Secondary Final:  add genders\r'mti Oct 24, 2012 - start\r'        EDSECUPPRTOT(R%, Total) = EDSECUPPRTOT(R%, Total) + EDSECUPPRTOT(R%, gndr)\r'        EDSECUPPRGRADS(R%, Total) = EDSECUPPRGRADS(R%, Total) + EDSECUPPRGRADS(R%, gndr)\r'mti Oct 24, 2012 - end\r\r'All Years but First: Upper Secondary Final: Percentage with completed (upper) secondary education\r'If GRPS(1,R%) = \"Equa Guinea\" Then Stop\r'mti September 04, 2009 -brought it up for code documentation purpose\r'empty out cohorts below secondary age\rFor j% = 4 To CInt(usec(R%) - 1) Step 1\rEdUpprSecPopPer(j%, R%, gndr) = 0\rNext j%\r\r\r\r'mti 2024/03/25 changed start\rIf SEPPRI(R%, gndr) > 1 Then\r'Nigeria DRC etc where current graduation rate is less than 15+ completion share\rsecgrate = AMAX(1, Amin(100, secgrate * ConvergeOverTime(SEPPRI(R%, gndr), 1, 150)))\rElse\rsecgrate = AMAX(1, Amin(100, secgrate * ConvergeOverTime(SEPPRI(R%, gndr), 1, 15)))\rEnd If\r"
  },
  {
    "Variable": "EDYRSAG25",
    "UsesVariable": "EDPRICR",
    "Distance": 228,
    "Code": "\r\r\r'mti 2024/03/25 changed start\rIf SEPPRI(R%, gndr) > 1 Then\r'Nigeria DRC etc where current graduation rate is less than 15+ completion share\rsecgrate = AMAX(1, Amin(100, secgrate * ConvergeOverTime(SEPPRI(R%, gndr), 1, 150)))\rElse\rsecgrate = AMAX(1, Amin(100, secgrate * ConvergeOverTime(SEPPRI(R%, gndr), 1, 15)))\rEnd If\r"
  },
  {
    "Variable": "EDYRSAG25",
    "UsesVariable": "EDSECUPPRGRATE",
    "Distance": 1167,
    "Code": "0"
  },
  {
    "Variable": "EDYRSSLE",
    "UsesVariable": "EDPRIENRG",
    "Distance": 578,
    "Code": "\r\rPrivate Function CalcSLE(R%, gndr%) As Single\r'mti August 2017 Take entire procedure\r'If GRPS(1,R%) = \"Albania\" Then Stop\r\r'mti April 2011 - take whole procedure\r'mti March 2011 - new function\r'CalcSLE = (Amin(100, EDPRIENRG(R%, Total)) * edprilen(R%) + Amin(100, EDSECLOWRENRG(R%, Total)) * edseclowrlen(R%) + Amin(100, EDSECUPPRENRG(R%, Total)) * edsecupprlen(R%) + Amin(100, EDTERENRG(R%, Total)) * 5) / 100\rCalcSLE = (EDPRIENRG(R%, gndr%) * edprilen(R%) + EDSECLOWRENRG(R%, gndr%) * edseclowrlen(R%) + EDSECUPPRENRG(R%, gndr%) * edsecupprlen(R%) + EDTERENRG(R%, gndr%) * 5) / 100\rEnd Function\r\r'mti 2017/07/13 Start - it is for both sexes; taking out of gender loop\rCall CalEdTerSciEn(R%, EDTerGRSciEnShift(R%), context)\r'mti 2017/07/13 End\r\r'All Years but First: Tertiary Final: Total for both genders\r'   ------------------------------------------------------------------------------------------------\rTertiaryTotals(R%, AdultPop(R%, 1), AdultPop(R%, 2))\r\r'mti March 2011 - start\r'All Years but First: School Life Expectancy\r'   -----------------------------------------\r\r'mti August 2017 start\rFor gndr = 1 To NGender\rEDYRSSLE(R%, gndr%) = CalcSLE(R%, gndr%) '(EDPRIENRG(R%, Total) * edprilen(R%) + EDSECLOWRENRG(R%, Total) * edseclowrlen(R%) + EDSECUPPRENRG(R%, Total) * edsecupprlen(R%) + EDTERENRG(R%, Total) * 5) / 100\rNext\r'mti August 2017 End\r'mti March 2011 - end\r'Next R%\r'->AllYears:\r"
  },
  {
    "Variable": "EDYRSSLE",
    "UsesVariable": "edprilen",
    "Distance": 578,
    "Code": "\r\rPrivate Function CalcSLE(R%, gndr%) As Single\r'mti August 2017 Take entire procedure\r'If GRPS(1,R%) = \"Albania\" Then Stop\r\r'mti April 2011 - take whole procedure\r'mti March 2011 - new function\r'CalcSLE = (Amin(100, EDPRIENRG(R%, Total)) * edprilen(R%) + Amin(100, EDSECLOWRENRG(R%, Total)) * edseclowrlen(R%) + Amin(100, EDSECUPPRENRG(R%, Total)) * edsecupprlen(R%) + Amin(100, EDTERENRG(R%, Total)) * 5) / 100\rCalcSLE = (EDPRIENRG(R%, gndr%) * edprilen(R%) + EDSECLOWRENRG(R%, gndr%) * edseclowrlen(R%) + EDSECUPPRENRG(R%, gndr%) * edsecupprlen(R%) + EDTERENRG(R%, gndr%) * 5) / 100\rEnd Function\r"
  },
  {
    "Variable": "EDYRSSLE",
    "UsesVariable": "EDSECLOWRENRG",
    "Distance": 578,
    "Code": "\r\rPrivate Function CalcSLE(R%, gndr%) As Single\r'mti August 2017 Take entire procedure\r'If GRPS(1,R%) = \"Albania\" Then Stop\r\r'mti April 2011 - take whole procedure\r'mti March 2011 - new function\r'CalcSLE = (Amin(100, EDPRIENRG(R%, Total)) * edprilen(R%) + Amin(100, EDSECLOWRENRG(R%, Total)) * edseclowrlen(R%) + Amin(100, EDSECUPPRENRG(R%, Total)) * edsecupprlen(R%) + Amin(100, EDTERENRG(R%, Total)) * 5) / 100\rCalcSLE = (EDPRIENRG(R%, gndr%) * edprilen(R%) + EDSECLOWRENRG(R%, gndr%) * edseclowrlen(R%) + EDSECUPPRENRG(R%, gndr%) * edsecupprlen(R%) + EDTERENRG(R%, gndr%) * 5) / 100\rEnd Function\r"
  },
  {
    "Variable": "EDYRSSLE",
    "UsesVariable": "edseclowrlen",
    "Distance": 578,
    "Code": "\r\rPrivate Function CalcSLE(R%, gndr%) As Single\r'mti August 2017 Take entire procedure\r'If GRPS(1,R%) = \"Albania\" Then Stop\r\r'mti April 2011 - take whole procedure\r'mti March 2011 - new function\r'CalcSLE = (Amin(100, EDPRIENRG(R%, Total)) * edprilen(R%) + Amin(100, EDSECLOWRENRG(R%, Total)) * edseclowrlen(R%) + Amin(100, EDSECUPPRENRG(R%, Total)) * edsecupprlen(R%) + Amin(100, EDTERENRG(R%, Total)) * 5) / 100\rCalcSLE = (EDPRIENRG(R%, gndr%) * edprilen(R%) + EDSECLOWRENRG(R%, gndr%) * edseclowrlen(R%) + EDSECUPPRENRG(R%, gndr%) * edsecupprlen(R%) + EDTERENRG(R%, gndr%) * 5) / 100\rEnd Function\r"
  },
  {
    "Variable": "EDYRSSLE",
    "UsesVariable": "EDSECUPPRENRG",
    "Distance": 578,
    "Code": "\r\rPrivate Function CalcSLE(R%, gndr%) As Single\r'mti August 2017 Take entire procedure\r'If GRPS(1,R%) = \"Albania\" Then Stop\r\r'mti April 2011 - take whole procedure\r'mti March 2011 - new function\r'CalcSLE = (Amin(100, EDPRIENRG(R%, Total)) * edprilen(R%) + Amin(100, EDSECLOWRENRG(R%, Total)) * edseclowrlen(R%) + Amin(100, EDSECUPPRENRG(R%, Total)) * edsecupprlen(R%) + Amin(100, EDTERENRG(R%, Total)) * 5) / 100\rCalcSLE = (EDPRIENRG(R%, gndr%) * edprilen(R%) + EDSECLOWRENRG(R%, gndr%) * edseclowrlen(R%) + EDSECUPPRENRG(R%, gndr%) * edsecupprlen(R%) + EDTERENRG(R%, gndr%) * 5) / 100\rEnd Function\r"
  },
  {
    "Variable": "EDYRSSLE",
    "UsesVariable": "edsecupprlen",
    "Distance": 578,
    "Code": "\r\rPrivate Function CalcSLE(R%, gndr%) As Single\r'mti August 2017 Take entire procedure\r'If GRPS(1,R%) = \"Albania\" Then Stop\r\r'mti April 2011 - take whole procedure\r'mti March 2011 - new function\r'CalcSLE = (Amin(100, EDPRIENRG(R%, Total)) * edprilen(R%) + Amin(100, EDSECLOWRENRG(R%, Total)) * edseclowrlen(R%) + Amin(100, EDSECUPPRENRG(R%, Total)) * edsecupprlen(R%) + Amin(100, EDTERENRG(R%, Total)) * 5) / 100\rCalcSLE = (EDPRIENRG(R%, gndr%) * edprilen(R%) + EDSECLOWRENRG(R%, gndr%) * edseclowrlen(R%) + EDSECUPPRENRG(R%, gndr%) * edsecupprlen(R%) + EDTERENRG(R%, gndr%) * 5) / 100\rEnd Function\r"
  },
  {
    "Variable": "EDYRSSLE",
    "UsesVariable": "EDTERENRG",
    "Distance": 578,
    "Code": "\r\rPrivate Function CalcSLE(R%, gndr%) As Single\r'mti August 2017 Take entire procedure\r'If GRPS(1,R%) = \"Albania\" Then Stop\r\r'mti April 2011 - take whole procedure\r'mti March 2011 - new function\r'CalcSLE = (Amin(100, EDPRIENRG(R%, Total)) * edprilen(R%) + Amin(100, EDSECLOWRENRG(R%, Total)) * edseclowrlen(R%) + Amin(100, EDSECUPPRENRG(R%, Total)) * edsecupprlen(R%) + Amin(100, EDTERENRG(R%, Total)) * 5) / 100\rCalcSLE = (EDPRIENRG(R%, gndr%) * edprilen(R%) + EDSECLOWRENRG(R%, gndr%) * edseclowrlen(R%) + EDSECUPPRENRG(R%, gndr%) * edsecupprlen(R%) + EDTERENRG(R%, gndr%) * 5) / 100\rEnd Function\r"
  },
  {
    "Variable": "ENDEM",
    "UsesVariable": "ICTBROAD",
    "Distance": 2,
    "Code": "\rFor e% = 1 To NET%\r'jrs 2009/08/04\rIf e% = Renew Then\r'bbh 2009/09/17 bound broadband cost change\rBroadbandTerm = CSng(AMAX(-0.1, Amin(0.1, (SBroad(R, 2) - ICTBroadExp(R)) * elenrenict)))\r\r'                'mti Sep 12, 2011 - start\r'                'take it off after testing\rBroadbandTerm = 0\r'                'mti Sep 12, 2011 - end\r\r'bbh 2019/04/02 regionalized etechadv\rBQE(R%, e%) = BQE(R%, e%) * (1 - etechadv(R%, e%) - BroadbandTerm)\rElse\r'bbh 2019/04/02 regionalized etechadv\rBQE(R%, e%) = BQE(R%, e%) * (1 - etechadv(R%, e%))\rEnd If\rQE(R%, e%) = AMAX(0.01, Amin(sqe(R%, e%) * qem(R%, e%), 1000))\r'If RegName$(R%) = \"Turkmenistan\" And e% = Hydro Then Stop\rNext e%\r\r'jrs 2009/05/13\rPrivate Sub adjENDEM_ICT()\r'jrs 2009/06/05\r'    'Adjusting Energy Demand with ICT drivers\r'    Dim ICTBroadExp As Single\r'    Dim rVal As Single, incCS As Single, incTec As Single\r'    Dim ICTSpendExp As Single\r'    'jrs 2009/05/26\r'    Dim EffectAdd As Single\r'    Dim GOVREGQUALExp As Single\r'\r'    If IY = 1 Then\r'        ReDim SICTBroadExp(NR, 2) As Single\r'        'jrs 2009/05/25 ReDim FirstYearAdj(NR) As Single\r'        ReDim ICTBroadExpShift(NR) As Single\r'        ReDim ICTSpendExpShift(NR) As Single\r'        ReDim GovRegQualShift(NR) As Single\r'    End If\r'\r'    Dim R As Integer\r'    For R = 1 To NR\r'\r'        'Expected ICT Spending\r'        '---------------------\r'        TbName$ = \"GDP/Capita (PPP 2000) Versus ICT Expenditures % GDP (2005) Linear\"\r'        Call XYTABL(TbName$, GDPPCP(R), rVal)\r'\r'        If IY = 1 Then\r'            If ictspendm(R) > 0 Then\r'                ICTSpendExpShift(R%) = ICTSPEND(R) / ictspendm(R) - rVal\r'                ICTSpendExp = ICTSPEND(R) / ictspendm(R)\r'            Else\r'                ICTSpendExpShift(R%) = -1 * rVal\r'                ICTSpendExp = ICTSPEND(R)\r'            End If\r'        Else\r'            ICTSpendExp = rVal + ICTSpendExpShift(R)\r'            ICTSpendExp = AMAX(Amin(ICTSpendExp, 100), 0)\r'        End If\r'\r'        'Expected Government Reg. Quality\r'        '--------------------------------\r'        Call AnalFunc(\"Governance Regulatory Quality (2006)\", _\r'            Array(GDPPCP(R%), EDYRSAG15(R%, 3)), rVal)\r'        rVal = AMAX(0, Amin(5, rVal + 2.5))\r'        If IY = 1 Then\r'            If govregqualm(R) > 0 Then\r'                GovRegQualShift(R%) = GOVREGQUAL(R%) / govregqualm(R) - rVal\r'                GOVREGQUALExp = GOVREGQUAL(R) / govregqualm(R)\r'            Else\r'                GovRegQualShift(R%) = -1 * rVal\r'                GOVREGQUALExp = GOVREGQUAL(R)\r'            End If\r'        Else\r'            EffectAdd = ConvergeOverTime(GovRegQualShift(R%), 0, goveffconv) 'Base, Target, Years\r'            GOVREGQUALExp = AMAX(0, Amin(5, (rVal + EffectAdd)))\r'        End If\r'\r'\r'        'jrs 2009/05/21 changing to multivariate\r''        TbName$ = \"GDP/Capita (PPP 2000) Versus ICT Broadband Subs per 100 ITU (\" & CStr(BaseYear) & \") Linear\"\r''        TbName$ = getFunctionNameYrOrMstRct(TbName$, BaseYear)\r''        Call XYTABL(TbName$, GDPPCP(R), rVal)\r'        Call AnalFunc(\"ICT Broadband Access % of Population\", _\r'        Array(GDPPCP(R), GOVREGQUALExp, ICTSpendExp), rVal)\r'\r'        ICTBroadExp = rVal\r'        If IY > 1 Then\r'            rVal = rVal + ConvergeOverTime(ICTBroadExpShift(R), 0, 100)\r'            incCS = rVal - SICTBroadExp(R, 1)\r'            If SICTBroadExp(R, 2) < ictbroadtecinflection Then\r'                incTec = (ictbroadtechighrt - ictbroadteclowrt) * SICTBroadExp(R, 2) / ictbroadtecinflection + ictbroadteclowrt\r'            Else\r'                incTec = (ictbroadteclowrt - ictbroadtechighrt) * (SICTBroadExp(R, 2) - ictbroadtecinflection) / (100 - ictbroadtecinflection) + ictbroadtechighrt\r'            End If\r'\r'            'Add Increase/Decrease to final value, this is the tec factor\r'            'Total increment can't be more than 25% of the remaining gap to reach target of 100\r'            ICTBroadExp = SICTBroadExp(R, 2) + Amin(incTec + incCS, (100 - SICTBroadExp(R, 2)) / 4)\r'\r'            'jrs 2009/05/25 ENDEM(R) = ENDEM(R) * (1 + (ICTBROAD(R) - ICTBroadExp) * elendemict + FirstYearAdj(R))\r'            ENDEM(R) = ENDEM(R) * (1 + (ICTBROAD(R) - ICTBroadExp) * elendemict)\r'        Else\r'            'jrs 2009/05/25 FirstYearAdj(R) = (ICTBroadExp - ICTBROAD(R)) * elendemict\r'            ICTBroadExpShift(R) = ICTBROAD(R) - ICTBroadExp\r'            rVal = ICTBROAD(R)\r'            ICTBroadExp = rVal\r'        End If\r'\r'        SICTBroadExp(R, 1) = rVal\r'        SICTBroadExp(R, 2) = ICTBroadExp\r'\r'    Next R\r\rDim R As Integer\r\rFor R = 1 To NR\r'bbh 2009/09/17 bound broadband energy demand change\rDim BroadbandTerm = AMAX(-0.5, Amin(0.2, (ICTBROAD(R) - ICTBroadExp(R)) * elendemict))\r\r'                'mti Sep 12, 2011 - start\r'                'take it off after testing\rBroadbandTerm = 0\r'                'mti Sep 12, 2011 - end\r\rENDEM(R) = CSng(ENDEM(R) * (1 + BroadbandTerm))\rNext R\rEnd Sub\r\r'jrs 2009/05/13\rPrivate Sub adjENDEM_ICT()\r'jrs 2009/06/05\r'    'Adjusting Energy Demand with ICT drivers\r'    Dim ICTBroadExp As Single\r'    Dim rVal As Single, incCS As Single, incTec As Single\r'    Dim ICTSpendExp As Single\r'    'jrs 2009/05/26\r'    Dim EffectAdd As Single\r'    Dim GOVREGQUALExp As Single\r'\r'    If IY = 1 Then\r'        ReDim SICTBroadExp(NR, 2) As Single\r'        'jrs 2009/05/25 ReDim FirstYearAdj(NR) As Single\r'        ReDim ICTBroadExpShift(NR) As Single\r'        ReDim ICTSpendExpShift(NR) As Single\r'        ReDim GovRegQualShift(NR) As Single\r'    End If\r'\r'    Dim R As Integer\r'    For R = 1 To NR\r'\r'        'Expected ICT Spending\r'        '---------------------\r'        TbName$ = \"GDP/Capita (PPP 2000) Versus ICT Expenditures % GDP (2005) Linear\"\r'        Call XYTABL(TbName$, GDPPCP(R), rVal)\r'\r'        If IY = 1 Then\r'            If ictspendm(R) > 0 Then\r'                ICTSpendExpShift(R%) = ICTSPEND(R) / ictspendm(R) - rVal\r'                ICTSpendExp = ICTSPEND(R) / ictspendm(R)\r'            Else\r'                ICTSpendExpShift(R%) = -1 * rVal\r'                ICTSpendExp = ICTSPEND(R)\r'            End If\r'        Else\r'            ICTSpendExp = rVal + ICTSpendExpShift(R)\r'            ICTSpendExp = AMAX(Amin(ICTSpendExp, 100), 0)\r'        End If\r'\r'        'Expected Government Reg. Quality\r'        '--------------------------------\r'        Call AnalFunc(\"Governance Regulatory Quality (2006)\", _\r'            Array(GDPPCP(R%), EDYRSAG15(R%, 3)), rVal)\r'        rVal = AMAX(0, Amin(5, rVal + 2.5))\r'        If IY = 1 Then\r'            If govregqualm(R) > 0 Then\r'                GovRegQualShift(R%) = GOVREGQUAL(R%) / govregqualm(R) - rVal\r'                GOVREGQUALExp = GOVREGQUAL(R) / govregqualm(R)\r'            Else\r'                GovRegQualShift(R%) = -1 * rVal\r'                GOVREGQUALExp = GOVREGQUAL(R)\r'            End If\r'        Else\r'            EffectAdd = ConvergeOverTime(GovRegQualShift(R%), 0, goveffconv) 'Base, Target, Years\r'            GOVREGQUALExp = AMAX(0, Amin(5, (rVal + EffectAdd)))\r'        End If\r'\r'\r'        'jrs 2009/05/21 changing to multivariate\r''        TbName$ = \"GDP/Capita (PPP 2000) Versus ICT Broadband Subs per 100 ITU (\" & CStr(BaseYear) & \") Linear\"\r''        TbName$ = getFunctionNameYrOrMstRct(TbName$, BaseYear)\r''        Call XYTABL(TbName$, GDPPCP(R), rVal)\r'        Call AnalFunc(\"ICT Broadband Access % of Population\", _\r'        Array(GDPPCP(R), GOVREGQUALExp, ICTSpendExp), rVal)\r'\r'        ICTBroadExp = rVal\r'        If IY > 1 Then\r'            rVal = rVal + ConvergeOverTime(ICTBroadExpShift(R), 0, 100)\r'            incCS = rVal - SICTBroadExp(R, 1)\r'            If SICTBroadExp(R, 2) < ictbroadtecinflection Then\r'                incTec = (ictbroadtechighrt - ictbroadteclowrt) * SICTBroadExp(R, 2) / ictbroadtecinflection + ictbroadteclowrt\r'            Else\r'                incTec = (ictbroadteclowrt - ictbroadtechighrt) * (SICTBroadExp(R, 2) - ictbroadtecinflection) / (100 - ictbroadtecinflection) + ictbroadtechighrt\r'            End If\r'\r'            'Add Increase/Decrease to final value, this is the tec factor\r'            'Total increment can't be more than 25% of the remaining gap to reach target of 100\r'            ICTBroadExp = SICTBroadExp(R, 2) + Amin(incTec + incCS, (100 - SICTBroadExp(R, 2)) / 4)\r'\r'            'jrs 2009/05/25 ENDEM(R) = ENDEM(R) * (1 + (ICTBROAD(R) - ICTBroadExp) * elendemict + FirstYearAdj(R))\r'            ENDEM(R) = ENDEM(R) * (1 + (ICTBROAD(R) - ICTBroadExp) * elendemict)\r'        Else\r'            'jrs 2009/05/25 FirstYearAdj(R) = (ICTBroadExp - ICTBROAD(R)) * elendemict\r'            ICTBroadExpShift(R) = ICTBROAD(R) - ICTBroadExp\r'            rVal = ICTBROAD(R)\r'            ICTBroadExp = rVal\r'        End If\r'\r'        SICTBroadExp(R, 1) = rVal\r'        SICTBroadExp(R, 2) = ICTBroadExp\r'\r'    Next R\r\rDim R As Integer\r\rFor R = 1 To NR\r'bbh 2009/09/17 bound broadband energy demand change\rDim BroadbandTerm = AMAX(-0.5, Amin(0.2, (ICTBROAD(R) - ICTBroadExp(R)) * elendemict))\r\r'                'mti Sep 12, 2011 - start\r'                'take it off after testing\rBroadbandTerm = 0\r'                'mti Sep 12, 2011 - end\r\rENDEM(R) = CSng(ENDEM(R) * (1 + BroadbandTerm))\rNext R\rEnd Sub\r\r'jrs 2009/05/13\rPrivate Sub adjENDEM_ICT()\r'jrs 2009/06/05\r'    'Adjusting Energy Demand with ICT drivers\r'    Dim ICTBroadExp As Single\r'    Dim rVal As Single, incCS As Single, incTec As Single\r'    Dim ICTSpendExp As Single\r'    'jrs 2009/05/26\r'    Dim EffectAdd As Single\r'    Dim GOVREGQUALExp As Single\r'\r'    If IY = 1 Then\r'        ReDim SICTBroadExp(NR, 2) As Single\r'        'jrs 2009/05/25 ReDim FirstYearAdj(NR) As Single\r'        ReDim ICTBroadExpShift(NR) As Single\r'        ReDim ICTSpendExpShift(NR) As Single\r'        ReDim GovRegQualShift(NR) As Single\r'    End If\r'\r'    Dim R As Integer\r'    For R = 1 To NR\r'\r'        'Expected ICT Spending\r'        '---------------------\r'        TbName$ = \"GDP/Capita (PPP 2000) Versus ICT Expenditures % GDP (2005) Linear\"\r'        Call XYTABL(TbName$, GDPPCP(R), rVal)\r'\r'        If IY = 1 Then\r'            If ictspendm(R) > 0 Then\r'                ICTSpendExpShift(R%) = ICTSPEND(R) / ictspendm(R) - rVal\r'                ICTSpendExp = ICTSPEND(R) / ictspendm(R)\r'            Else\r'                ICTSpendExpShift(R%) = -1 * rVal\r'                ICTSpendExp = ICTSPEND(R)\r'            End If\r'        Else\r'            ICTSpendExp = rVal + ICTSpendExpShift(R)\r'            ICTSpendExp = AMAX(Amin(ICTSpendExp, 100), 0)\r'        End If\r'\r'        'Expected Government Reg. Quality\r'        '--------------------------------\r'        Call AnalFunc(\"Governance Regulatory Quality (2006)\", _\r'            Array(GDPPCP(R%), EDYRSAG15(R%, 3)), rVal)\r'        rVal = AMAX(0, Amin(5, rVal + 2.5))\r'        If IY = 1 Then\r'            If govregqualm(R) > 0 Then\r'                GovRegQualShift(R%) = GOVREGQUAL(R%) / govregqualm(R) - rVal\r'                GOVREGQUALExp = GOVREGQUAL(R) / govregqualm(R)\r'            Else\r'                GovRegQualShift(R%) = -1 * rVal\r'                GOVREGQUALExp = GOVREGQUAL(R)\r'            End If\r'        Else\r'            EffectAdd = ConvergeOverTime(GovRegQualShift(R%), 0, goveffconv) 'Base, Target, Years\r'            GOVREGQUALExp = AMAX(0, Amin(5, (rVal + EffectAdd)))\r'        End If\r'\r'\r'        'jrs 2009/05/21 changing to multivariate\r''        TbName$ = \"GDP/Capita (PPP 2000) Versus ICT Broadband Subs per 100 ITU (\" & CStr(BaseYear) & \") Linear\"\r''        TbName$ = getFunctionNameYrOrMstRct(TbName$, BaseYear)\r''        Call XYTABL(TbName$, GDPPCP(R), rVal)\r'        Call AnalFunc(\"ICT Broadband Access % of Population\", _\r'        Array(GDPPCP(R), GOVREGQUALExp, ICTSpendExp), rVal)\r'\r'        ICTBroadExp = rVal\r'        If IY > 1 Then\r'            rVal = rVal + ConvergeOverTime(ICTBroadExpShift(R), 0, 100)\r'            incCS = rVal - SICTBroadExp(R, 1)\r'            If SICTBroadExp(R, 2) < ictbroadtecinflection Then\r'                incTec = (ictbroadtechighrt - ictbroadteclowrt) * SICTBroadExp(R, 2) / ictbroadtecinflection + ictbroadteclowrt\r'            Else\r'                incTec = (ictbroadteclowrt - ictbroadtechighrt) * (SICTBroadExp(R, 2) - ictbroadtecinflection) / (100 - ictbroadtecinflection) + ictbroadtechighrt\r'            End If\r'\r'            'Add Increase/Decrease to final value, this is the tec factor\r'            'Total increment can't be more than 25% of the remaining gap to reach target of 100\r'            ICTBroadExp = SICTBroadExp(R, 2) + Amin(incTec + incCS, (100 - SICTBroadExp(R, 2)) / 4)\r'\r'            'jrs 2009/05/25 ENDEM(R) = ENDEM(R) * (1 + (ICTBROAD(R) - ICTBroadExp) * elendemict + FirstYearAdj(R))\r'            ENDEM(R) = ENDEM(R) * (1 + (ICTBROAD(R) - ICTBroadExp) * elendemict)\r'        Else\r'            'jrs 2009/05/25 FirstYearAdj(R) = (ICTBroadExp - ICTBROAD(R)) * elendemict\r'            ICTBroadExpShift(R) = ICTBROAD(R) - ICTBroadExp\r'            rVal = ICTBROAD(R)\r'            ICTBroadExp = rVal\r'        End If\r'\r'        SICTBroadExp(R, 1) = rVal\r'        SICTBroadExp(R, 2) = ICTBroadExp\r'\r'    Next R\r\rDim R As Integer\r\rFor R = 1 To NR\r'bbh 2009/09/17 bound broadband energy demand change\rDim BroadbandTerm = AMAX(-0.5, Amin(0.2, (ICTBROAD(R) - ICTBroadExp(R)) * elendemict))\r\r'                'mti Sep 12, 2011 - start\r'                'take it off after testing\rBroadbandTerm = 0\r'                'mti Sep 12, 2011 - end\r\rENDEM(R) = CSng(ENDEM(R) * (1 + BroadbandTerm))\rNext R\rEnd Sub\r"
  },
  {
    "Variable": "ENDEM",
    "UsesVariable": "elendemict",
    "Distance": 2,
    "Code": "\rFor e% = 1 To NET%\r'jrs 2009/08/04\rIf e% = Renew Then\r'bbh 2009/09/17 bound broadband cost change\rBroadbandTerm = CSng(AMAX(-0.1, Amin(0.1, (SBroad(R, 2) - ICTBroadExp(R)) * elenrenict)))\r\r'                'mti Sep 12, 2011 - start\r'                'take it off after testing\rBroadbandTerm = 0\r'                'mti Sep 12, 2011 - end\r\r'bbh 2019/04/02 regionalized etechadv\rBQE(R%, e%) = BQE(R%, e%) * (1 - etechadv(R%, e%) - BroadbandTerm)\rElse\r'bbh 2019/04/02 regionalized etechadv\rBQE(R%, e%) = BQE(R%, e%) * (1 - etechadv(R%, e%))\rEnd If\rQE(R%, e%) = AMAX(0.01, Amin(sqe(R%, e%) * qem(R%, e%), 1000))\r'If RegName$(R%) = \"Turkmenistan\" And e% = Hydro Then Stop\rNext e%\r"
  },
  {
    "Variable": "ENDEM",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ENDEM",
    "UsesVariable": "endemm",
    "Distance": -5,
    "Code": "0"
  },
  {
    "Variable": "ENDEM",
    "UsesVariable": "enrgdpgr",
    "Distance": -5,
    "Code": "\rDim elasterm = 1.0! + (PEnPRI - ENPRII(R%)) / ENPRII(R%) * elasadjusted\r"
  },
  {
    "Variable": "ENDEM",
    "UsesVariable": "GDPP",
    "Distance": 23,
    "Code": "0"
  },
  {
    "Variable": "ENDEM",
    "UsesVariable": "POPR",
    "Distance": 110,
    "Code": "0"
  },
  {
    "Variable": "ENDEM",
    "UsesVariable": "enconv",
    "Distance": 16,
    "Code": "0"
  },
  {
    "Variable": "ENDEM",
    "UsesVariable": "WEP",
    "Distance": -2,
    "Code": "0"
  },
  {
    "Variable": "ENDEM",
    "UsesVariable": "ENPRI",
    "Distance": 61,
    "Code": "0"
  },
  {
    "Variable": "ENDEM",
    "UsesVariable": "elasde",
    "Distance": -3,
    "Code": "0"
  },
  {
    "Variable": "ENDEM",
    "UsesVariable": "GDPPC",
    "Distance": 111,
    "Code": "0"
  },
  {
    "Variable": "ENDEM",
    "UsesVariable": "igdpr",
    "Distance": 111,
    "Code": "0"
  },
  {
    "Variable": "ENDEM",
    "UsesVariable": "WEPBYEAR",
    "Distance": 47,
    "Code": "0"
  },
  {
    "Variable": "ENDEM",
    "UsesVariable": "ENP",
    "Distance": -349,
    "Code": "0"
  },
  {
    "Variable": "ENDEM",
    "UsesVariable": "carfuel1",
    "Distance": -349,
    "Code": "0"
  },
  {
    "Variable": "ENDEM",
    "UsesVariable": "carfuel2",
    "Distance": -349,
    "Code": "0"
  },
  {
    "Variable": "ENDEM",
    "UsesVariable": "carfuel3",
    "Distance": -349,
    "Code": "0"
  },
  {
    "Variable": "ENDEM",
    "UsesVariable": "carbtax",
    "Distance": -349,
    "Code": "0"
  },
  {
    "Variable": "ENDEM",
    "UsesVariable": "ENX",
    "Distance": 0,
    "Code": "\r'dkb 2014/08/06 - END\rFor e% = 1 To Renew  'Oil, gas, coal, hydro, nuclear, renewable\rENST(R%) = ENST(R%) + ENP(R%, e%) * dstlen\rENDEM(R%) = ENDEM(R%) + ENP(R%, e%)\rsump = sump + ENP(R%, e%)\rSUMPR = SUMPR + ENP(R%, e%) * ENPRR(R%, e%)\rSmoothENP(R%, e%) = ENP(R%, e%)\r'jrs 2023/10/25\rSENPTOT(R%) = SENPTOT(R%) + ENP(R%, e%)\rNext e%\r\rENDEM(R%) = CSng(sump - ENX(R%) + ENM(R%) - ENST(R%) * AVEPR)\r"
  },
  {
    "Variable": "ENDEM",
    "UsesVariable": "ENM",
    "Distance": 0,
    "Code": "\r'dkb 2014/08/06 - END\rFor e% = 1 To Renew  'Oil, gas, coal, hydro, nuclear, renewable\rENST(R%) = ENST(R%) + ENP(R%, e%) * dstlen\rENDEM(R%) = ENDEM(R%) + ENP(R%, e%)\rsump = sump + ENP(R%, e%)\rSUMPR = SUMPR + ENP(R%, e%) * ENPRR(R%, e%)\rSmoothENP(R%, e%) = ENP(R%, e%)\r'jrs 2023/10/25\rSENPTOT(R%) = SENPTOT(R%) + ENP(R%, e%)\rNext e%\r"
  },
  {
    "Variable": "ENDEM",
    "UsesVariable": "ENST",
    "Distance": 0,
    "Code": "\r'dkb 2014/08/06 - END\rFor e% = 1 To Renew  'Oil, gas, coal, hydro, nuclear, renewable\rENST(R%) = ENST(R%) + ENP(R%, e%) * dstlen\rENDEM(R%) = ENDEM(R%) + ENP(R%, e%)\rsump = sump + ENP(R%, e%)\rSUMPR = SUMPR + ENP(R%, e%) * ENPRR(R%, e%)\rSmoothENP(R%, e%) = ENP(R%, e%)\r'jrs 2023/10/25\rSENPTOT(R%) = SENPTOT(R%) + ENP(R%, e%)\rNext e%\r"
  },
  {
    "Variable": "ENDEM",
    "UsesVariable": "ENPRR",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "ENDEMSH",
    "UsesVariable": "ENDEM",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ENDEMSH",
    "UsesVariable": "enconv",
    "Distance": 1,
    "Code": "\r'Initial ratio of ENDEM - data and forecast\rEnDemDFRI(R%) = ENDEMSH(R%) / ENDEM(R%)\r\r\r'Energy demand data and forecast do not match in first year (see energy/economic modules)\r'Infrastructure module maintains a data and forecast ratio that converges to 1\rDim EnDemDFRIVal = ConvergeOverTime(EnDemDFRI(R%), 1, enconv)\r"
  },
  {
    "Variable": "ENELECSHRENDEM",
    "UsesVariable": "enelecshrendemm",
    "Distance": 0,
    "Code": "\r\rENELECSHRENDEM(R%) = ENELECSHRENDEM(R%) * enelecshrendemm(R%)\r\r\r'Note MTI: no cap here? Electricity cannot be all of energy by 2100: Discuss\rENELECSHRENDEM(R%) = AMAX(0.001, Amin(100, ENELECSHRENDEM(R%)))\r"
  },
  {
    "Variable": "ENELECSHRENDEM",
    "UsesVariable": "extmaposnenelecshr",
    "Distance": 1,
    "Code": "\r'jrs 2020/08/31 this is false in vb6 and true in .NET, looks like rounding problem\r'If GRPS(1, R) = \"Maldives\" Then Stop\rIf Prediction >= ENELECSHRENDEM(R%) Then\r'iextmaposnconvtimeenelecshr(R%) = AMAX(8, Int(Baseextmaposnconvtimeenelecshr / (Prediction / ENELECSHRENDEM(R%))))\riextmaposnconvtimeenelecshr(R%) = CSng(AMAX(30, Baseextmaposnconvtimeenelecshr + 10 * Math.Floor(CSng(Prediction / ENELECSHRENDEM(R%)))))\riextmafuncenelecshr(R%) = Baseextmafuncenelecshr\rElse\riextmaposnconvtimeenelecshr(R%) = Baseextmaposnconvtimeenelecshr\r'iextmafuncenelecshr(R%) = Amin(0.1, AMAX(0.02, Baseextmafuncenelecshr / (ENELECSHRENDEM(R%) / Prediction)))\riextmafuncenelecshr(R%) = Amin(0.1F, AMAX(0.09F, Baseextmafuncenelecshr / (ENELECSHRENDEM(R%) / Prediction)))\rEnd If\r\r\r\r'First Year Call 2: Growth Rate for electricity share of energy\r'----------------------------------------------------------------\r\rIf Not EnElecShrEnDemGR(R%).HasValue Then\rIf GDPPCP(R%) > 12000 Then\rEnElecShrEnDemGR(R%) = 0.01\rEnd If\rEnElecShrEnDemGRBF(R%) = EnElecShrEnDemGR(R%)\r\rEnd If\r\r\r'extrapolative approach: growth rate\r'If GRPS(1, R) = \"Maldives\" Then Stop\rEnElecShrEnDemGR(R%) = CSng(CalcExtrapolativeGR(EnElecShrEnDemGR(R%), iextmafuncenelecshr(R%), extmaposnenelecshr, CDbl(PreMultEnElecShrEnDem(R%)), CDbl(Prediction), CDbl(Prediction1), iextmaposnconvtimeenelecshr(R%)))\r\rENELECSHRENDEM(R%) = If(PreMultEnElecShrEnDem(R%) * (1 + EnElecShrEnDemGR(R%)), 0)\r"
  },
  {
    "Variable": "ENELECSHRENDEM",
    "UsesVariable": "GDPPCP",
    "Distance": 236,
    "Code": "0"
  },
  {
    "Variable": "ENELECSHRENDEM",
    "UsesVariable": "INFRAELECACC",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "ENELECSHRENDEM",
    "UsesVariable": "ENP",
    "Distance": 255,
    "Code": "0"
  },
  {
    "Variable": "ENELECSHRENDEM",
    "UsesVariable": "ENDEMSH",
    "Distance": 255,
    "Code": "0"
  },
  {
    "Variable": "ENELECSHRENDEM",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "\r\rsENELECSHRENDEM(R%) = ENELECSHRENDEM(R%)\r\r\rFor loccnt% = 1 To NLocation%\rssINFRAELECACC(R%, loccnt%) = sINFRAELECACC(R%, loccnt%)\rsINFRAELECACC(R%, loccnt%) = INFRAELECACC(R%, loccnt%)\rNext\r\rsENELECSHRENDEM(R%) = ENELECSHRENDEM(R%)\rsINFRAROADRAI(R%) = INFRAROADRAI(R%)\r\r'Save GDP per capita for next year -\rsGDPPCP(R%) = GDPPCP(R%)\r\r'save gdp and landarea for use next year\rsgdpp(R%) = GDPP(R%)\rsLANDAREA(R%) = LANDAREA(R%)\rNext 'R%\r"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "ENX",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "enmm",
    "Distance": 0,
    "Code": "\r'jrs 2020/06/23 *** end ***\r\r'bbh 2020/05/07 start Am nervous that done after all restraints\rENM(R%) = ENM(R%) * enmm(R%)\r\rDim wmd = 0!\r"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "gdprext",
    "Distance": 2,
    "Code": "\r\r'jrs 2020/06/23 *** begin ***\rIf gdprext(R%) > -99 Then\rDim factorm As Single\rDim factorx As Single\r'jrs 2020/07/06 changed parameter name\rfactorm = AMAX(1 + (gdprext(R%) / 100 - SmoothGDPR(R%)) * elasmincshock(R%, 2), 0.00001F) 'jrs 2020/07/01 added AMAX(,0)\rfactorx = AMAX(1 + (gdprext(R%) / 100 - SmoothGDPR(R%)) * elasxincshock(R%, 2), 0.00001F) 'jrs 2020/07/01 added AMAX(,0)\rENM(R%) = ENM(R%) * factorm\rENX(R%) = ENX(R%) * factorx\rEnd If\r\r\r'jrs 2020/06/23 *** begin ***\rIf gdprext(R%) > -99 Then\rDim factorm As Single\rDim factorx As Single\r'jrs 2020/07/06 changed parameter name\rfactorm = AMAX(1 + (gdprext(R%) / 100 - SmoothGDPR(R%)) * elasmincshock(R%, 2), 0.00001F) 'jrs 2020/07/01 added AMAX(,0)\rfactorx = AMAX(1 + (gdprext(R%) / 100 - SmoothGDPR(R%)) * elasxincshock(R%, 2), 0.00001F) 'jrs 2020/07/01 added AMAX(,0)\rENM(R%) = ENM(R%) * factorm\rENX(R%) = ENX(R%) * factorx\rEnd If\r"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "elasmincshock",
    "Distance": 2,
    "Code": "\r\r'jrs 2020/06/23 *** begin ***\rIf gdprext(R%) > -99 Then\rDim factorm As Single\rDim factorx As Single\r'jrs 2020/07/06 changed parameter name\rfactorm = AMAX(1 + (gdprext(R%) / 100 - SmoothGDPR(R%)) * elasmincshock(R%, 2), 0.00001F) 'jrs 2020/07/01 added AMAX(,0)\rfactorx = AMAX(1 + (gdprext(R%) / 100 - SmoothGDPR(R%)) * elasxincshock(R%, 2), 0.00001F) 'jrs 2020/07/01 added AMAX(,0)\rENM(R%) = ENM(R%) * factorm\rENX(R%) = ENX(R%) * factorx\rEnd If\r"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "enml",
    "Distance": 0,
    "Code": "\rIf enml(R%) > 0.001 Then 'Import Restraint\rTradeRestraint = TradeRestraint + AMAX(0, ENM(R%) - enml(R%))\rENM(R%) = Amin(ENM(R%), enml(R%))\rEnd If\r"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "ENDEM",
    "Distance": 21,
    "Code": "0"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "ENST",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "ENSHO",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "ENP",
    "Distance": 33,
    "Code": "0"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "endemm",
    "Distance": 74,
    "Code": "0"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "enrgdpgr",
    "Distance": 74,
    "Code": "0"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "GDPP",
    "Distance": 102,
    "Code": "0"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "POPR",
    "Distance": 189,
    "Code": "0"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "enconv",
    "Distance": 95,
    "Code": "0"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "WEP",
    "Distance": 77,
    "Code": "0"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "ENPRI",
    "Distance": 140,
    "Code": "0"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "elasde",
    "Distance": 76,
    "Code": "0"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "GDPPC",
    "Distance": 190,
    "Code": "0"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "igdpr",
    "Distance": 190,
    "Code": "0"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "WEPBYEAR",
    "Distance": 126,
    "Code": "0"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "POP",
    "Distance": 101,
    "Code": "0"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "trademax",
    "Distance": 167,
    "Code": "0"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "MTARIFFTAXR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ENM",
    "UsesVariable": "MS",
    "Distance": 0,
    "Code": "\r'ENDEM(R%) = 0!\r'already redim\r'ReducedOilProd(R%) = 0\r'SReducedOilProd(R%) = 0\r'ReducedGasProd(R%) = 0\r'SReducedGasProd(R%) = 0\r'         swfor = swfor + LD(R%, Fors)\r'dkb 2014/08/06 - Adding save variables for Energy Trade componenets of POWER, first year - START\r'         SENX(R%) = 0\r'         SENM(R%) = 0\r'dkb 2014/08/06 - END\r\r' BBH 6/22/04 Begin V5_0 Begin  - use physical energy prices\rENM(R%) = MS(R%, Ener) / WEPBYEAR 'assure consistency with economic model\r"
  },
  {
    "Variable": "ENP",
    "UsesVariable": "enxl",
    "Distance": -2,
    "Code": "\r\rIf enxl(R%) > 0.001 AndAlso Diff1 > 0 Then 'In case of export constraint\rDim OilGasProd = AMAX(0.001, ENP(R%, Oil) + ENP(R%, Gas))\rDim ReducedEnProd = Amin(OilGasProd - 0.001, Diff1)\r'            ReducedOilProd(r%) = Amin(ENP(r%, Oil) - 0.001, Diff1)\rReducedOilProd(R%) = CSng(ReducedEnProd * ENP(R%, Oil) / OilGasProd)\rReducedGasProd(R%) = CSng(ReducedEnProd * ENP(R%, Gas) / OilGasProd)\rENP(R%, Oil) = ENP(R%, Oil) - ReducedOilProd(R%)\rENP(R%, Gas) = ENP(R%, Gas) - ReducedGasProd(R%)\rENST(R%) = ENST(R%) - ReducedOilProd(R%) - ReducedGasProd(R%)\rReducedGasProd(R%) = 0\rEnd If\r\r\rIf enxl(R%) > 0.001 AndAlso Diff1 > 0 Then 'In case of export constraint\rDim OilGasProd = AMAX(0.001, ENP(R%, Oil) + ENP(R%, Gas))\rDim ReducedEnProd = Amin(OilGasProd - 0.001, Diff1)\r'            ReducedOilProd(r%) = Amin(ENP(r%, Oil) - 0.001, Diff1)\rReducedOilProd(R%) = CSng(ReducedEnProd * ENP(R%, Oil) / OilGasProd)\rReducedGasProd(R%) = CSng(ReducedEnProd * ENP(R%, Gas) / OilGasProd)\rENP(R%, Oil) = ENP(R%, Oil) - ReducedOilProd(R%)\rENP(R%, Gas) = ENP(R%, Gas) - ReducedGasProd(R%)\rENST(R%) = ENST(R%) - ReducedOilProd(R%) - ReducedGasProd(R%)\rReducedGasProd(R%) = 0\rEnd If\r"
  },
  {
    "Variable": "ENP",
    "UsesVariable": "ifsexomodelid",
    "Distance": -2,
    "Code": "\rDiff1 = mkave(R%) - ImportTarget\r"
  },
  {
    "Variable": "ENP",
    "UsesVariable": "trademax",
    "Distance": 236,
    "Code": "0"
  },
  {
    "Variable": "ENP",
    "UsesVariable": "ENPCAPUT",
    "Distance": 0,
    "Code": "\rFor e% = 1 To Renew 'Oil, gas, coal, hydro, nuclear, renewable\r'WorldEnp = WorldEnp + ENP(R%, e%)\r'            SENP(R%) = SENP(R%) + ENP(R%, E%)\r'Stock base for Price Change Not Affected by Capacity\rENP(R%, e%) = ENP(R%, e%) * sENPCAPUT(R%)  'jrs 2021/11/15 changed to sENPCAPUT(R%)\rENST(R%) = ENST(R%) + ENP(R%, e%)\rNext e%\r\rmkave(R%) = AMAX(0.001, Amin(mkave(R%), MKAVMax(R%)))\r\rmkave(R%) = AMAX(0.001, Amin(mkave(R%), MKAVMax(R%)))\r"
  },
  {
    "Variable": "ENP",
    "UsesVariable": "RESER",
    "Distance": -4,
    "Code": "0"
  },
  {
    "Variable": "ENP",
    "UsesVariable": "enpcoalmax",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "ENP",
    "UsesVariable": "enpadd",
    "Distance": 0,
    "Code": "\rFor R% = 1 To NR%\rFor e% = 1 To Renew  'Oil, gas, coal, hydro, nuclear, renewable\rENP(R%, e%) = (sken(R%, e%) / QE(R%, e%)) * enpm(R%, e%)  'jrs 2021/11/15 changed to sken\r'jrs 2022/04/05\rENP(R%, e%) = ENP(R%, e%) + enpadd(R%, e%)\rIf e% = 2 And enpgasmax(R%) > 0.001 Then 'bbh 2021/09/30 added If block to smooth production at top of max production\r'If ENP(R%, e%) > 0.95 * enpgasmax(R%) Then\rENP(R%, e%) = CSng(ENP(R%, e%) * 0.2 + SmoothENP(R%, e%) * 0.8)\rSmoothENP(R%, e%) = ENP(R%, e%)\r'End If\rEnd If\r\r'sgh 2013/11/2 Tax gas production in South Africa to fund renewables Start\r'This block of code was written for the South African policy brief concerning shale gas production\r'\"Fracking for Shale Gas in South Africa: Blessing or Curse?\"\r'When activated this will allow the user to place an excise tax on gas production (for South Africa only)\r'and reinvest that revenue into renewable energy capital. GasProd is natural gas production for South Africa.\r'GasRev is the revenue that is generated given the tax on gas production. The tax is in terms of dollars\r'per million cubic feet. RenewIncrease is then calculated using the revenue generated from gas and the\r'capital-output ratio for renewables in South Africa ($1837/barrel oil equivalent). The capital-output\r'ratio decreases by 1.5 percent each year. CumRenewProd is the cumulative increase in renewable energy generated from\r'the tax. Since these are investments in capital the energy generated from these investments is a cumulative output\r'CumRenewProd is used to calculate the total energy production from renewables (ENP(R%,6)) + CumRenewProd and\r'then to calculate the enpm(R%,6) necessary to shift production to that level.\r'If e% = 2 And RegName$(R%) = \"South Africa\" Then\r'GasProd = ENP(R%, 2)\r'GasRev = GasProd * 1000 * 5.35 * GastoRenewTax(R%) * 1000\r'RenewIncrease = (GasRev / 1000 / (1837 * (0.985 ^ IY%)))\r'CumRenewProd = CumRenewProd + RenewIncrease\r'enpm(R%, 6) = (ENP(R%, 6) + CumRenewProd) / ENP(R%, 6)\r'If RegName$(R%) = \"South Africa\" Then Stop\r'End If\r'sgh 2013/11/2 Tax gas production in South Africa to fund renewables End\renppot(R%, e%) = (sken(R%, e%) / QE(R%, e%))  'jrs 2021/11/15 changed to sken\r'If RegName$(R%) = \"El Salvador\" And e% = 1 Then Stop\rNext e%\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rElseIf e% = Hydro OrElse e% = Renew Then\rSmoothENP(R%, e%) = CSng(0.8 * SmoothENP(R%, e%) + 0.2 * ENP(R%, e%))\r\rFor R% = 1 To NR%\rFor e% = 1 To Renew  'Oil, gas, coal, hydro, nuclear, renewable\rENP(R%, e%) = (sken(R%, e%) / QE(R%, e%)) * enpm(R%, e%)  'jrs 2021/11/15 changed to sken\r'jrs 2022/04/05\rENP(R%, e%) = ENP(R%, e%) + enpadd(R%, e%)\rIf e% = 2 And enpgasmax(R%) > 0.001 Then 'bbh 2021/09/30 added If block to smooth production at top of max production\r'If ENP(R%, e%) > 0.95 * enpgasmax(R%) Then\rENP(R%, e%) = CSng(ENP(R%, e%) * 0.2 + SmoothENP(R%, e%) * 0.8)\rSmoothENP(R%, e%) = ENP(R%, e%)\r'End If\rEnd If\r\r'sgh 2013/11/2 Tax gas production in South Africa to fund renewables Start\r'This block of code was written for the South African policy brief concerning shale gas production\r'\"Fracking for Shale Gas in South Africa: Blessing or Curse?\"\r'When activated this will allow the user to place an excise tax on gas production (for South Africa only)\r'and reinvest that revenue into renewable energy capital. GasProd is natural gas production for South Africa.\r'GasRev is the revenue that is generated given the tax on gas production. The tax is in terms of dollars\r'per million cubic feet. RenewIncrease is then calculated using the revenue generated from gas and the\r'capital-output ratio for renewables in South Africa ($1837/barrel oil equivalent). The capital-output\r'ratio decreases by 1.5 percent each year. CumRenewProd is the cumulative increase in renewable energy generated from\r'the tax. Since these are investments in capital the energy generated from these investments is a cumulative output\r'CumRenewProd is used to calculate the total energy production from renewables (ENP(R%,6)) + CumRenewProd and\r'then to calculate the enpm(R%,6) necessary to shift production to that level.\r'If e% = 2 And RegName$(R%) = \"South Africa\" Then\r'GasProd = ENP(R%, 2)\r'GasRev = GasProd * 1000 * 5.35 * GastoRenewTax(R%) * 1000\r'RenewIncrease = (GasRev / 1000 / (1837 * (0.985 ^ IY%)))\r'CumRenewProd = CumRenewProd + RenewIncrease\r'enpm(R%, 6) = (ENP(R%, 6) + CumRenewProd) / ENP(R%, 6)\r'If RegName$(R%) = \"South Africa\" Then Stop\r'End If\r'sgh 2013/11/2 Tax gas production in South Africa to fund renewables End\renppot(R%, e%) = (sken(R%, e%) / QE(R%, e%))  'jrs 2021/11/15 changed to sken\r'If RegName$(R%) = \"El Salvador\" And e% = 1 Then Stop\rNext e%\r\rIf enpcoalmax(R%) > 0.001 And e% = Coal Then\rENP_UpBnd = Amin(ENP_UpBnd, enpcoalmax(R%))\rEnd If\r"
  },
  {
    "Variable": "ENP",
    "UsesVariable": "ken",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:Next R%:2483|\rFor R% = 1 To NR%\rFor e% = 1 To Renew  'Oil, gas, coal, hydro, nuclear, renewable\rENP(R%, e%) = (sken(R%, e%) / QE(R%, e%)) * enpm(R%, e%)  'jrs 2021/11/15 changed to sken\r'jrs 2022/04/05\rENP(R%, e%) = ENP(R%, e%) + enpadd(R%, e%)\rIf e% = 2 And enpgasmax(R%) > 0.001 Then 'bbh 2021/09/30 added If block to smooth production at top of max production\r'If ENP(R%, e%) > 0.95 * enpgasmax(R%) Then\rENP(R%, e%) = CSng(ENP(R%, e%) * 0.2 + SmoothENP(R%, e%) * 0.8)\rSmoothENP(R%, e%) = ENP(R%, e%)\r'End If\rEnd If\r\r'sgh 2013/11/2 Tax gas production in South Africa to fund renewables Start\r'This block of code was written for the South African policy brief concerning shale gas production\r'\"Fracking for Shale Gas in South Africa: Blessing or Curse?\"\r'When activated this will allow the user to place an excise tax on gas production (for South Africa only)\r'and reinvest that revenue into renewable energy capital. GasProd is natural gas production for South Africa.\r'GasRev is the revenue that is generated given the tax on gas production. The tax is in terms of dollars\r'per million cubic feet. RenewIncrease is then calculated using the revenue generated from gas and the\r'capital-output ratio for renewables in South Africa ($1837/barrel oil equivalent). The capital-output\r'ratio decreases by 1.5 percent each year. CumRenewProd is the cumulative increase in renewable energy generated from\r'the tax. Since these are investments in capital the energy generated from these investments is a cumulative output\r'CumRenewProd is used to calculate the total energy production from renewables (ENP(R%,6)) + CumRenewProd and\r'then to calculate the enpm(R%,6) necessary to shift production to that level.\r'If e% = 2 And RegName$(R%) = \"South Africa\" Then\r'GasProd = ENP(R%, 2)\r'GasRev = GasProd * 1000 * 5.35 * GastoRenewTax(R%) * 1000\r'RenewIncrease = (GasRev / 1000 / (1837 * (0.985 ^ IY%)))\r'CumRenewProd = CumRenewProd + RenewIncrease\r'enpm(R%, 6) = (ENP(R%, 6) + CumRenewProd) / ENP(R%, 6)\r'If RegName$(R%) = \"South Africa\" Then Stop\r'End If\r'sgh 2013/11/2 Tax gas production in South Africa to fund renewables End\renppot(R%, e%) = (sken(R%, e%) / QE(R%, e%))  'jrs 2021/11/15 changed to sken\r'If RegName$(R%) = \"El Salvador\" And e% = 1 Then Stop\rNext e%\r"
  },
  {
    "Variable": "ENP",
    "UsesVariable": "QE",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:Next R%:2483|\rFor R% = 1 To NR%\rFor e% = 1 To Renew  'Oil, gas, coal, hydro, nuclear, renewable\rENP(R%, e%) = (sken(R%, e%) / QE(R%, e%)) * enpm(R%, e%)  'jrs 2021/11/15 changed to sken\r'jrs 2022/04/05\rENP(R%, e%) = ENP(R%, e%) + enpadd(R%, e%)\rIf e% = 2 And enpgasmax(R%) > 0.001 Then 'bbh 2021/09/30 added If block to smooth production at top of max production\r'If ENP(R%, e%) > 0.95 * enpgasmax(R%) Then\rENP(R%, e%) = CSng(ENP(R%, e%) * 0.2 + SmoothENP(R%, e%) * 0.8)\rSmoothENP(R%, e%) = ENP(R%, e%)\r'End If\rEnd If\r\r'sgh 2013/11/2 Tax gas production in South Africa to fund renewables Start\r'This block of code was written for the South African policy brief concerning shale gas production\r'\"Fracking for Shale Gas in South Africa: Blessing or Curse?\"\r'When activated this will allow the user to place an excise tax on gas production (for South Africa only)\r'and reinvest that revenue into renewable energy capital. GasProd is natural gas production for South Africa.\r'GasRev is the revenue that is generated given the tax on gas production. The tax is in terms of dollars\r'per million cubic feet. RenewIncrease is then calculated using the revenue generated from gas and the\r'capital-output ratio for renewables in South Africa ($1837/barrel oil equivalent). The capital-output\r'ratio decreases by 1.5 percent each year. CumRenewProd is the cumulative increase in renewable energy generated from\r'the tax. Since these are investments in capital the energy generated from these investments is a cumulative output\r'CumRenewProd is used to calculate the total energy production from renewables (ENP(R%,6)) + CumRenewProd and\r'then to calculate the enpm(R%,6) necessary to shift production to that level.\r'If e% = 2 And RegName$(R%) = \"South Africa\" Then\r'GasProd = ENP(R%, 2)\r'GasRev = GasProd * 1000 * 5.35 * GastoRenewTax(R%) * 1000\r'RenewIncrease = (GasRev / 1000 / (1837 * (0.985 ^ IY%)))\r'CumRenewProd = CumRenewProd + RenewIncrease\r'enpm(R%, 6) = (ENP(R%, 6) + CumRenewProd) / ENP(R%, 6)\r'If RegName$(R%) = \"South Africa\" Then Stop\r'End If\r'sgh 2013/11/2 Tax gas production in South Africa to fund renewables End\renppot(R%, e%) = (sken(R%, e%) / QE(R%, e%))  'jrs 2021/11/15 changed to sken\r'If RegName$(R%) = \"El Salvador\" And e% = 1 Then Stop\rNext e%\r"
  },
  {
    "Variable": "ENP",
    "UsesVariable": "enpm",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:Next R%:2483|\rFor R% = 1 To NR%\rFor e% = 1 To Renew  'Oil, gas, coal, hydro, nuclear, renewable\rENP(R%, e%) = (sken(R%, e%) / QE(R%, e%)) * enpm(R%, e%)  'jrs 2021/11/15 changed to sken\r'jrs 2022/04/05\rENP(R%, e%) = ENP(R%, e%) + enpadd(R%, e%)\rIf e% = 2 And enpgasmax(R%) > 0.001 Then 'bbh 2021/09/30 added If block to smooth production at top of max production\r'If ENP(R%, e%) > 0.95 * enpgasmax(R%) Then\rENP(R%, e%) = CSng(ENP(R%, e%) * 0.2 + SmoothENP(R%, e%) * 0.8)\rSmoothENP(R%, e%) = ENP(R%, e%)\r'End If\rEnd If\r\r'sgh 2013/11/2 Tax gas production in South Africa to fund renewables Start\r'This block of code was written for the South African policy brief concerning shale gas production\r'\"Fracking for Shale Gas in South Africa: Blessing or Curse?\"\r'When activated this will allow the user to place an excise tax on gas production (for South Africa only)\r'and reinvest that revenue into renewable energy capital. GasProd is natural gas production for South Africa.\r'GasRev is the revenue that is generated given the tax on gas production. The tax is in terms of dollars\r'per million cubic feet. RenewIncrease is then calculated using the revenue generated from gas and the\r'capital-output ratio for renewables in South Africa ($1837/barrel oil equivalent). The capital-output\r'ratio decreases by 1.5 percent each year. CumRenewProd is the cumulative increase in renewable energy generated from\r'the tax. Since these are investments in capital the energy generated from these investments is a cumulative output\r'CumRenewProd is used to calculate the total energy production from renewables (ENP(R%,6)) + CumRenewProd and\r'then to calculate the enpm(R%,6) necessary to shift production to that level.\r'If e% = 2 And RegName$(R%) = \"South Africa\" Then\r'GasProd = ENP(R%, 2)\r'GasRev = GasProd * 1000 * 5.35 * GastoRenewTax(R%) * 1000\r'RenewIncrease = (GasRev / 1000 / (1837 * (0.985 ^ IY%)))\r'CumRenewProd = CumRenewProd + RenewIncrease\r'enpm(R%, 6) = (ENP(R%, 6) + CumRenewProd) / ENP(R%, 6)\r'If RegName$(R%) = \"South Africa\" Then Stop\r'End If\r'sgh 2013/11/2 Tax gas production in South Africa to fund renewables End\renppot(R%, e%) = (sken(R%, e%) / QE(R%, e%))  'jrs 2021/11/15 changed to sken\r'If RegName$(R%) = \"El Salvador\" And e% = 1 Then Stop\rNext e%\r"
  },
  {
    "Variable": "ENPCAPUT",
    "UsesVariable": "elenpst",
    "Distance": 1,
    "Code": "\rDiff2 = ENST(R%) - sensho(R%) - senst(R%)\r\rDiff1 = ENST(R%) - sensho(R%) - dstlen * StBase 'Needed also in capacity utilization\rCOMPLETE STRUCTURE:Next R%:2642|\r\r\rFor R% = 1 To NR%\r'If RegName$(R%) = \"Egypt\" And IY% >= 50 Then Stop\r\r'StBase = SENP(R%) + PENDEM(R%) 'Use projected energy demand\rStBase = smoothentot(R%) + smoothpendem(R%) 'Use projected energy demand\r\r'\r'        All but First:  Capacity Utilization\r'        ------------------------------------\r'elenpst = -0.4 'bbh 2021/09/30  Jose, please put these two lines of parameter change in Global Parameters rather than here\r'elenpst2 = -0.8 'bbh 2021/09/30\r\rCall ADJSTR(StBase, Diff1, Diff2, elenpst, elenpst2, Mul)\r\r'         Call ADJSTR(StBase, Diff1, Diff2, -0.2, -0.4, Mul)\r'cputf(R%) = 0.5 * cputf(R%) + 0.5 * Mul\r'cputf(R%) = CSng(0.5 * cputf(R%) + 0.5 * Mul * cputf(R%)) 'bbh 2021/09/30 added cputf, was major omission\rENPCAPUT(R%) = CSng(0.5 * sENPCAPUT(R%) + 0.5 * Mul * sENPCAPUT(R%))  'jrs 2021/11/15 changed to sENPCAPUT(R%)\r\rENPCAPUT(R%) = ConvergeOverTime(ENPCAPUT(R%), 1, 100) 'Base, Target, Years\r\r'ENPCAPUT(R%) = Mul\rENPCAPUT(R%) = AMAX(0.2, Amin(ENPCAPUT(R%), 2))\r"
  },
  {
    "Variable": "ENPCAPUT",
    "UsesVariable": "elenpst2",
    "Distance": 1,
    "Code": "\rDiff2 = ENST(R%) - sensho(R%) - senst(R%)\r"
  },
  {
    "Variable": "ENPCAPUT",
    "UsesVariable": "ENST",
    "Distance": 20,
    "Code": "0"
  },
  {
    "Variable": "ENPCAPUT",
    "UsesVariable": "ENSHO",
    "Distance": 20,
    "Code": "0"
  },
  {
    "Variable": "ENPCAPUT",
    "UsesVariable": "dstlen",
    "Distance": 20,
    "Code": "\rsmoothpendem(R%) = CSng(0.8 * smoothpendem(R%) + 0.2 * pendem(R%))\r"
  },
  {
    "Variable": "ENPCAPUT",
    "UsesVariable": "ENP",
    "Distance": 140,
    "Code": "0"
  },
  {
    "Variable": "ENPCAPUT",
    "UsesVariable": "ENDEM",
    "Distance": 321,
    "Code": "0"
  },
  {
    "Variable": "ENPCAPUT",
    "UsesVariable": "endemm",
    "Distance": 181,
    "Code": "0"
  },
  {
    "Variable": "ENPCAPUT",
    "UsesVariable": "enrgdpgr",
    "Distance": 181,
    "Code": "0"
  },
  {
    "Variable": "ENPCAPUT",
    "UsesVariable": "GDPP",
    "Distance": 209,
    "Code": "0"
  },
  {
    "Variable": "ENPCAPUT",
    "UsesVariable": "POPR",
    "Distance": 296,
    "Code": "0"
  },
  {
    "Variable": "ENPCAPUT",
    "UsesVariable": "enconv",
    "Distance": 202,
    "Code": "0"
  },
  {
    "Variable": "ENPCAPUT",
    "UsesVariable": "WEP",
    "Distance": 184,
    "Code": "0"
  },
  {
    "Variable": "ENPCAPUT",
    "UsesVariable": "ENPRI",
    "Distance": 247,
    "Code": "0"
  },
  {
    "Variable": "ENPCAPUT",
    "UsesVariable": "elasde",
    "Distance": 183,
    "Code": "0"
  },
  {
    "Variable": "ENPCAPUT",
    "UsesVariable": "GDPPC",
    "Distance": 297,
    "Code": "0"
  },
  {
    "Variable": "ENPCAPUT",
    "UsesVariable": "igdpr",
    "Distance": 297,
    "Code": "0"
  },
  {
    "Variable": "ENPCAPUT",
    "UsesVariable": "WEPBYEAR",
    "Distance": 233,
    "Code": "0"
  },
  {
    "Variable": "ENPCAPUT",
    "UsesVariable": "POP",
    "Distance": 208,
    "Code": "0"
  },
  {
    "Variable": "ENPRI",
    "UsesVariable": "encartpp",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ENPRI",
    "UsesVariable": "enpm",
    "Distance": 47,
    "Code": "0"
  },
  {
    "Variable": "ENPRI",
    "UsesVariable": "enprixi",
    "Distance": 0,
    "Code": "\rIf (enprix(R%) > 0.1) Then\rENPRI(R%) = enprix(R%)\rElse\r'epra = -0.3 'bbh 2021/09/30  Jose: better to put this parameter change in GlobalParameters table; please do\rCall ADJSTR(StBase, Diff1, Diff2, epra, eprafs, Mul)\rMarkUpEn(R%) = MarkUpEn(R%) * Mul\r'ENPRI(R%) = SWEP * wkenenpr / wkenenpri * Mul * cumwmul + encartpp\rIf enprixi < 1 Then\rENPRI(R%) = iwep * wkenenpr / wkenenpri * Mul * cumwmul + encartpp\rElse\rENPRI(R%) = enprixi * wkenenpr / wkenenpri * Mul * cumwmul + encartpp\rEnd If\r'BBH 6/15/04  V5_0  Need to increase range when go from dollars/barrel to index\rIf wenpm > 0.5 Then 'Restriction on, allow prices to rise\rENPRI(R%) = AMAX(SENPRI(R%) - 10,\r                            Amin(ENPRI(R%), SENPRI(R%) + encartpp - SEnCartPP + 100))\rElse\rENPRI(R%) = AMAX(SENPRI(R%) - 10,\r                            Amin(ENPRI(R%), SENPRI(R%) + encartpp - SEnCartPP + 20))\rEnd If\r'ENPRI(R%) = AMAX(SENPRI(R%) - 2.5, _\r'Amin(ENPRI(R%), SENPRI(R%) + encartpp - SEnCartPP + 5))\rEnd If\r"
  },
  {
    "Variable": "ENPRI",
    "UsesVariable": "eprohw",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "ENPRI",
    "UsesVariable": "ken",
    "Distance": 25,
    "Code": "0"
  },
  {
    "Variable": "ENPRI",
    "UsesVariable": "ENPCAPUT",
    "Distance": 25,
    "Code": "0"
  },
  {
    "Variable": "ENPRI",
    "UsesVariable": "lke",
    "Distance": 25,
    "Code": "0"
  },
  {
    "Variable": "ENPRI",
    "UsesVariable": "ZS",
    "Distance": -188,
    "Code": "0"
  },
  {
    "Variable": "ENPRI",
    "UsesVariable": "ENP",
    "Distance": -183,
    "Code": "0"
  },
  {
    "Variable": "ENPRI",
    "UsesVariable": "WEPBYEAR",
    "Distance": 219,
    "Code": "0"
  },
  {
    "Variable": "ENPRI",
    "UsesVariable": "dstlen",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "ENPRI",
    "UsesVariable": "ENST",
    "Distance": 28,
    "Code": "0"
  },
  {
    "Variable": "ENPRI",
    "UsesVariable": "ENSHO",
    "Distance": 28,
    "Code": "0"
  },
  {
    "Variable": "ENPRI",
    "UsesVariable": "WENP",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "ENPRI",
    "UsesVariable": "WEP",
    "Distance": 219,
    "Code": "\r'cumwmul = cumwmul * wmul\r'bbh 2011/10/17\rcumwmul = cumwmul * (1 - eprohw) + cumwmul * wmul * eprohw\r"
  },
  {
    "Variable": "ENPRI",
    "UsesVariable": "enprix",
    "Distance": 0,
    "Code": "\rIf (enprix(R%) > 0.1) Then\rENPRI(R%) = enprix(R%)\rElse\r'epra = -0.3 'bbh 2021/09/30  Jose: better to put this parameter change in GlobalParameters table; please do\rCall ADJSTR(StBase, Diff1, Diff2, epra, eprafs, Mul)\rMarkUpEn(R%) = MarkUpEn(R%) * Mul\r'ENPRI(R%) = SWEP * wkenenpr / wkenenpri * Mul * cumwmul + encartpp\rIf enprixi < 1 Then\rENPRI(R%) = iwep * wkenenpr / wkenenpri * Mul * cumwmul + encartpp\rElse\rENPRI(R%) = enprixi * wkenenpr / wkenenpri * Mul * cumwmul + encartpp\rEnd If\r'BBH 6/15/04  V5_0  Need to increase range when go from dollars/barrel to index\rIf wenpm > 0.5 Then 'Restriction on, allow prices to rise\rENPRI(R%) = AMAX(SENPRI(R%) - 10,\r                            Amin(ENPRI(R%), SENPRI(R%) + encartpp - SEnCartPP + 100))\rElse\rENPRI(R%) = AMAX(SENPRI(R%) - 10,\r                            Amin(ENPRI(R%), SENPRI(R%) + encartpp - SEnCartPP + 20))\rEnd If\r'ENPRI(R%) = AMAX(SENPRI(R%) - 2.5, _\r'Amin(ENPRI(R%), SENPRI(R%) + encartpp - SEnCartPP + 5))\rEnd If\r\rwstbase = wstbase + StBase\r"
  },
  {
    "Variable": "ENPRR",
    "UsesVariable": "ken",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ENPRR",
    "UsesVariable": "lke",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ENPRR",
    "UsesVariable": "eninvtm",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "ENPRR",
    "UsesVariable": "IDS",
    "Distance": 8,
    "Code": "\rineed(R%, e%) = CSng(AMAX(mininv, Amin(maxinv, ineed(R%, e%))))\r\r\r\r'If RegName$(R%) = \"China\" Then Stop\r\rmaxinv = CSng((enppot(R%, Nucl) * 0.01 +\r                    ENP(R%, Nucl) / lke(Nucl)) * QE(R%, Nucl))\r\rmininv = CSng(ENP(R%, Nucl) * 0.5 * 1 / lke(Nucl) * QE(R%, Nucl))\r\rFor e% = 1 To Renew  'Oil, gas, coal, hydro, nuclear, renewable\rtineed(R%) = tineed(R%) + ineed(R%, e%) * eninvtm(R%, e%)\rNext e%\r"
  },
  {
    "Variable": "ENPRR",
    "UsesVariable": "enon",
    "Distance": 8,
    "Code": "\rineed(R%, e%) = CSng(AMAX(mininv, Amin(maxinv, ineed(R%, e%))))\r\r"
  },
  {
    "Variable": "ENPRR",
    "UsesVariable": "ENP",
    "Distance": 20,
    "Code": "0"
  },
  {
    "Variable": "ENPRR",
    "UsesVariable": "QE",
    "Distance": 20,
    "Code": "0"
  },
  {
    "Variable": "ENPRR",
    "UsesVariable": "ennoprodsw",
    "Distance": 39,
    "Code": "0"
  },
  {
    "Variable": "ENPRR",
    "UsesVariable": "eprodr",
    "Distance": 40,
    "Code": "0"
  },
  {
    "Variable": "ENPRR",
    "UsesVariable": "elass",
    "Distance": 42,
    "Code": "0"
  },
  {
    "Variable": "ENPRR",
    "UsesVariable": "enpcoalmax",
    "Distance": 31,
    "Code": "0"
  },
  {
    "Variable": "ENPRR",
    "UsesVariable": "ENDEM",
    "Distance": 27,
    "Code": "0"
  },
  {
    "Variable": "ENRGDP",
    "UsesVariable": "ENDEM",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ENRGDP",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ENRGDP",
    "UsesVariable": "igdpr",
    "Distance": 0,
    "Code": "\r\rENRGDP(R%) = ENDEM(R%) / AMAX(0.0001, (SGDP(R%) * (1 + igdpr(R%)))) * 1000\r'ENRGDP(R%) = ENDEM(R%) / AMAX(0.0001, (sgdpp(R%) * (1 + igdpr(R%)))) * 1000\r'For economic model which needs estimate in IO rev before final calculation\r'Do not need relative to GDPP because have in display options\r"
  },
  {
    "Variable": "ENSHO",
    "UsesVariable": "WENP",
    "Distance": 28,
    "Code": "0"
  },
  {
    "Variable": "ENSHO",
    "UsesVariable": "ENDEM",
    "Distance": 316,
    "Code": "0"
  },
  {
    "Variable": "ENSHO",
    "UsesVariable": "xhw",
    "Distance": 77,
    "Code": "0"
  },
  {
    "Variable": "ENSHO",
    "UsesVariable": "ENX",
    "Distance": 77,
    "Code": "0"
  },
  {
    "Variable": "ENSHO",
    "UsesVariable": "trademax",
    "Distance": 280,
    "Code": "0"
  },
  {
    "Variable": "ENSHO",
    "UsesVariable": "endemm",
    "Distance": 176,
    "Code": "0"
  },
  {
    "Variable": "ENSHO",
    "UsesVariable": "enrgdpgr",
    "Distance": 176,
    "Code": "0"
  },
  {
    "Variable": "ENSHO",
    "UsesVariable": "ENP",
    "Distance": 285,
    "Code": "0"
  },
  {
    "Variable": "ENSHO",
    "UsesVariable": "GDPP",
    "Distance": 204,
    "Code": "0"
  },
  {
    "Variable": "ENSHO",
    "UsesVariable": "POPR",
    "Distance": 291,
    "Code": "0"
  },
  {
    "Variable": "ENSHO",
    "UsesVariable": "enconv",
    "Distance": 197,
    "Code": "0"
  },
  {
    "Variable": "ENSHO",
    "UsesVariable": "WEP",
    "Distance": 179,
    "Code": "0"
  },
  {
    "Variable": "ENSHO",
    "UsesVariable": "ENPRI",
    "Distance": 242,
    "Code": "0"
  },
  {
    "Variable": "ENSHO",
    "UsesVariable": "elasde",
    "Distance": 178,
    "Code": "0"
  },
  {
    "Variable": "ENSHO",
    "UsesVariable": "GDPPC",
    "Distance": 292,
    "Code": "0"
  },
  {
    "Variable": "ENSHO",
    "UsesVariable": "igdpr",
    "Distance": 292,
    "Code": "0"
  },
  {
    "Variable": "ENSHO",
    "UsesVariable": "WEPBYEAR",
    "Distance": 228,
    "Code": "0"
  },
  {
    "Variable": "ENSHO",
    "UsesVariable": "POP",
    "Distance": 203,
    "Code": "0"
  },
  {
    "Variable": "ENSHO",
    "UsesVariable": "ENST",
    "Distance": 0,
    "Code": "\r'If RegName$(R%) = \"United States of America\" And IY% >= 20 Then Stop\r\rIf (ENST(R%) < 0) Then\rENSHO(R%) = -ENST(R%)\rsensho(R%) = ENSHO(R%)\rENST(R%) = 0!\rEnd If\r"
  },
  {
    "Variable": "ENSOLFUEL",
    "UsesVariable": "ensolfuelm",
    "Distance": 0,
    "Code": "\r'DSR 20 Sep 2013 - End\r\r\rENSOLFUEL(R%) = ENSOLFUEL(R%) * ensolfuelm(R%)\r\rENSOLFUEL(R%) = Amin(AMAX(ENSOLFUEL(R%), 0), 100)\r\rElse 'if Solid Fueld Hold switch is On\rENSOLFUEL(R%) = ENSOLFUELI(R%)\r"
  },
  {
    "Variable": "ENSOLFUEL",
    "UsesVariable": "ensolfueltrgtyr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ENSOLFUEL",
    "UsesVariable": "ensolfuelsetar",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ENSOLFUEL",
    "UsesVariable": "ensolfueltrgtval",
    "Distance": 2,
    "Code": "\r\r'SE approach - multiplicative\r\r'                'Universal Target - taking solid fuel use to 0\r'                If ensolfueltrgtyr(R%) > 0 And ensolfuelsetar(R%) = 0 Then\r'\r'                    ENSOLFUELTrgt = ENSOLFUELI(R%) - Amin(ensolfueltrgtyr(R%), IY - 1) * ENSOLFUELI(R%) / ensolfueltrgtyr(R%)\r'                    ENSOLFUEL(R%) = Amin(ENSOLFUELTrgt, ENSOLFUEL(R%))\r'                End If\r\r'DSR 20 Sep 2013 - Start\r'Universal Target - taking solid fuel use to 0\r'                If ensolfueltrgtyr(R%) > 0 And ensolfuelsetar = 0 Then\r'\r'                    ENSOLFUELTrgt = ENSOLFUELI(R%) - Amin(ensolfueltrgtyr(R%), IY - 1) * ENSOLFUELI(R%) / ensolfueltrgtyr(R%)\r'                    ENSOLFUEL(R%) = Amin(ENSOLFUELTrgt, ENSOLFUEL(R%))\r'                End If\rIf ensolfueltrgtyr(R%) > 0 And ensolfuelsetar(R%) = 0 Then\rDim ensolfueltrgtvalTmp = Amin(ensolfueltrgtval(R%), ENSOLFUELI(R%))\rDim ENSOLFUELTrgt = ENSOLFUELI(R%) - Amin(ensolfueltrgtyr(R%), IY - 1) * (ENSOLFUELI(R%) - ensolfueltrgtvalTmp) / ensolfueltrgtyr(R%)\rENSOLFUEL(R%) = Amin(ENSOLFUELTrgt, ENSOLFUEL(R%))\rEnd If\r"
  },
  {
    "Variable": "ENSOLFUEL",
    "UsesVariable": "ensolfuelseyrtar",
    "Distance": 1,
    "Code": "\r'jrs 2015/05/22 *** end ***\r\r'jrs 2013/12/18 ENSOLFUELShift(R%) = ENSOLFUEL(R%) / (100 / (Exp(cVal) + 1))\rENSOLFUELShift(R%) = ENSOLFUEL(R%) / (100 / (CSng(Math.Exp(-1 * cVal)) + 1))\r"
  },
  {
    "Variable": "ENSOLFUEL",
    "UsesVariable": "INFRAELECACC",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "ENSOLFUEL",
    "UsesVariable": "POPURBAN",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "ENSOLFUEL",
    "UsesVariable": "POP",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "ENSOLFUEL",
    "UsesVariable": "GDPPCP",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "ENSOLFUEL",
    "UsesVariable": "EDYRSAG25",
    "Distance": 1127,
    "Code": "\r\r'Distal Driver Formulation for Water and Sanitation - new 5 categories\r'mti 2022/10/20 start\r'If watsafenewsw = 1 And hlwatsansw > 0 Then\rIf watsafenewsw = 1 And watsafefwdsw = 1 And hlwatsansw > 0 Then 'new 5 cat model\r'mti 2022/10/20 end\r\rIf IY = 1 Then\rIncome = GDPPCP(R%)\rEducation = EDYRSAG25(R%, Total)    'gdpvar, edvar, Poverty\rElse\rIncome = sGDPPCP(R%)\rEducation = SEDYRSAG25(R%, Total)\rEnd If\r"
  },
  {
    "Variable": "ENST",
    "UsesVariable": "ENP",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "ENST",
    "UsesVariable": "dstlen",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "ENST",
    "UsesVariable": "ENDEM",
    "Distance": 277,
    "Code": "0"
  },
  {
    "Variable": "ENST",
    "UsesVariable": "endemm",
    "Distance": 137,
    "Code": "0"
  },
  {
    "Variable": "ENST",
    "UsesVariable": "enrgdpgr",
    "Distance": 137,
    "Code": "0"
  },
  {
    "Variable": "ENST",
    "UsesVariable": "GDPP",
    "Distance": 165,
    "Code": "0"
  },
  {
    "Variable": "ENST",
    "UsesVariable": "POPR",
    "Distance": 252,
    "Code": "0"
  },
  {
    "Variable": "ENST",
    "UsesVariable": "enconv",
    "Distance": 158,
    "Code": "0"
  },
  {
    "Variable": "ENST",
    "UsesVariable": "WEP",
    "Distance": 140,
    "Code": "0"
  },
  {
    "Variable": "ENST",
    "UsesVariable": "ENPRI",
    "Distance": 203,
    "Code": "0"
  },
  {
    "Variable": "ENST",
    "UsesVariable": "elasde",
    "Distance": 139,
    "Code": "0"
  },
  {
    "Variable": "ENST",
    "UsesVariable": "GDPPC",
    "Distance": 253,
    "Code": "0"
  },
  {
    "Variable": "ENST",
    "UsesVariable": "igdpr",
    "Distance": 253,
    "Code": "0"
  },
  {
    "Variable": "ENST",
    "UsesVariable": "WEPBYEAR",
    "Distance": 189,
    "Code": "0"
  },
  {
    "Variable": "ENST",
    "UsesVariable": "POP",
    "Distance": 164,
    "Code": "0"
  },
  {
    "Variable": "ENST",
    "UsesVariable": "ENX",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ENST",
    "UsesVariable": "ENM",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ENST",
    "UsesVariable": "ENPRR",
    "Distance": 6,
    "Code": "\rDim SUMPR As Single = 0!\r"
  },
  {
    "Variable": "ENVPM2PT5",
    "UsesVariable": "envpm2pt5m",
    "Distance": 0,
    "Code": "\rFor R = 1 To NR\r'jrs 2010/01/08\rIf envpm25hldsw = 0 Then\rForVal = CSng(Math.Exp(5.1238 + 0.2533 * Math.Log(GDPPCP(R%)) - 0.056957 * (Math.Log(GDPPCP(R%))) ^ 2 -\r                    0.4758 * Math.Log(EDYRSAG25(R%, 3)) - 0.0137 * (BaseYear - 1989 + IY - 1) - 0.14 * GDS(R, Health) / GDP(R) * 100))\r\rENVPM2PT5(R%) = ENVPM2PT5Shift(R%) * ForVal\rENVPM2PT5(R%) = ENVPM2PT5(R%) * ENVPM2PT5ConvFct(R%)\rENVPM2PT5(R%) = ENVPM2PT5(R%) * envpm2pt5m(R%)\r'jrs 2009/11/20\rENVPM2PT5(R%) = AMAX(ENVPM2PT5(R%), Pm25Min)\r\r'jrs 2010/01/06\rSENVPM2PT5(R%) = ENVPM2PT5(R%)\rElse 'if Outdoor air polution hold switch is On\rENVPM2PT5(R%) = SENVPM2PT5(R%)\rEnd If\r\rIf hlpm2pt5sw > 0 Then\r'Distal Driver Formulation for Outdoor air polution (PM10)\rForVal = CSng(Math.Exp(4.8929 + 0.2145 * Math.Log(GDPPCP(R%)) - 0.0995 * (Math.Log(GDPPCP(R%)) ^ 2) -\r                    0.451 * Math.Log(EDYRSAG25(R%, 3)) - 0.0181 * (BaseYear - 1989 + IY - 1)))\r'Convert from pm10 to pm2.5\rSENVPM2PT5DDF(R%) = ForVal * ENVPM2PT5ConvFct(R%) * ENVPM2PT5DDFShift(R%)\rEnd If\rNext R\rCOMPLETE STRUCTURE:End Sub:490|\r\rPublic Sub IFsEnviron1AllbutFirstYear(context As IForecastContext)\r'AllButFirst:\r\r\r'jrs 2009/10/28\r'     All but First:  Forecast population weighted PM2.5 levels\r'-----------------------------------------------------------\r'jrs 2009/11/25\r'jrs 2019/08/18 Dim Pm25idx As Integer = 0\r'jrs 2019/08/18 FindVarNumb(Pm25idx, ENVPM2PT5)\rDim Pm25Min As Single\rPm25Min = CSng(context.GetVariable(\"ENVPM2PT5\").Min)\r\rFor R = 1 To NR\r'jrs 2010/01/08\rIf envpm25hldsw = 0 Then\rForVal = CSng(Math.Exp(5.1238 + 0.2533 * Math.Log(GDPPCP(R%)) - 0.056957 * (Math.Log(GDPPCP(R%))) ^ 2 -\r                    0.4758 * Math.Log(EDYRSAG25(R%, 3)) - 0.0137 * (BaseYear - 1989 + IY - 1) - 0.14 * GDS(R, Health) / GDP(R) * 100))\r\rENVPM2PT5(R%) = ENVPM2PT5Shift(R%) * ForVal\rENVPM2PT5(R%) = ENVPM2PT5(R%) * ENVPM2PT5ConvFct(R%)\rENVPM2PT5(R%) = ENVPM2PT5(R%) * envpm2pt5m(R%)\r'jrs 2009/11/20\rENVPM2PT5(R%) = AMAX(ENVPM2PT5(R%), Pm25Min)\r\r'jrs 2010/01/06\rSENVPM2PT5(R%) = ENVPM2PT5(R%)\rElse 'if Outdoor air polution hold switch is On\rENVPM2PT5(R%) = SENVPM2PT5(R%)\rEnd If\r\rIf hlpm2pt5sw > 0 Then\r'Distal Driver Formulation for Outdoor air polution (PM10)\rForVal = CSng(Math.Exp(4.8929 + 0.2145 * Math.Log(GDPPCP(R%)) - 0.0995 * (Math.Log(GDPPCP(R%)) ^ 2) -\r                    0.451 * Math.Log(EDYRSAG25(R%, 3)) - 0.0181 * (BaseYear - 1989 + IY - 1)))\r'Convert from pm10 to pm2.5\rSENVPM2PT5DDF(R%) = ForVal * ENVPM2PT5ConvFct(R%) * ENVPM2PT5DDFShift(R%)\rEnd If\rNext R\r\rFor R = 1 To NR\r'jrs 2010/01/08\rIf envpm25hldsw = 0 Then\rForVal = CSng(Math.Exp(5.1238 + 0.2533 * Math.Log(GDPPCP(R%)) - 0.056957 * (Math.Log(GDPPCP(R%))) ^ 2 -\r                    0.4758 * Math.Log(EDYRSAG25(R%, 3)) - 0.0137 * (BaseYear - 1989 + IY - 1) - 0.14 * GDS(R, Health) / GDP(R) * 100))\r\rENVPM2PT5(R%) = ENVPM2PT5Shift(R%) * ForVal\rENVPM2PT5(R%) = ENVPM2PT5(R%) * ENVPM2PT5ConvFct(R%)\rENVPM2PT5(R%) = ENVPM2PT5(R%) * envpm2pt5m(R%)\r'jrs 2009/11/20\rENVPM2PT5(R%) = AMAX(ENVPM2PT5(R%), Pm25Min)\r\r'jrs 2010/01/06\rSENVPM2PT5(R%) = ENVPM2PT5(R%)\rElse 'if Outdoor air polution hold switch is On\rENVPM2PT5(R%) = SENVPM2PT5(R%)\rEnd If\r\rIf hlpm2pt5sw > 0 Then\r'Distal Driver Formulation for Outdoor air polution (PM10)\rForVal = CSng(Math.Exp(4.8929 + 0.2145 * Math.Log(GDPPCP(R%)) - 0.0995 * (Math.Log(GDPPCP(R%)) ^ 2) -\r                    0.451 * Math.Log(EDYRSAG25(R%, 3)) - 0.0181 * (BaseYear - 1989 + IY - 1)))\r'Convert from pm10 to pm2.5\rSENVPM2PT5DDF(R%) = ForVal * ENVPM2PT5ConvFct(R%) * ENVPM2PT5DDFShift(R%)\rEnd If\rNext R\r"
  },
  {
    "Variable": "ENVPM2PT5",
    "UsesVariable": "GDPPCP",
    "Distance": 1,
    "Code": "\rFor R = 1 To NR\r'jrs 2010/01/08\rIf envpm25hldsw = 0 Then\rForVal = CSng(Math.Exp(5.1238 + 0.2533 * Math.Log(GDPPCP(R%)) - 0.056957 * (Math.Log(GDPPCP(R%))) ^ 2 -\r                    0.4758 * Math.Log(EDYRSAG25(R%, 3)) - 0.0137 * (BaseYear - 1989 + IY - 1) - 0.14 * GDS(R, Health) / GDP(R) * 100))\r\rENVPM2PT5(R%) = ENVPM2PT5Shift(R%) * ForVal\rENVPM2PT5(R%) = ENVPM2PT5(R%) * ENVPM2PT5ConvFct(R%)\rENVPM2PT5(R%) = ENVPM2PT5(R%) * envpm2pt5m(R%)\r'jrs 2009/11/20\rENVPM2PT5(R%) = AMAX(ENVPM2PT5(R%), Pm25Min)\r\r'jrs 2010/01/06\rSENVPM2PT5(R%) = ENVPM2PT5(R%)\rElse 'if Outdoor air polution hold switch is On\rENVPM2PT5(R%) = SENVPM2PT5(R%)\rEnd If\r\rIf hlpm2pt5sw > 0 Then\r'Distal Driver Formulation for Outdoor air polution (PM10)\rForVal = CSng(Math.Exp(4.8929 + 0.2145 * Math.Log(GDPPCP(R%)) - 0.0995 * (Math.Log(GDPPCP(R%)) ^ 2) -\r                    0.451 * Math.Log(EDYRSAG25(R%, 3)) - 0.0181 * (BaseYear - 1989 + IY - 1)))\r'Convert from pm10 to pm2.5\rSENVPM2PT5DDF(R%) = ForVal * ENVPM2PT5ConvFct(R%) * ENVPM2PT5DDFShift(R%)\rEnd If\rNext R\r\rFor R = 1 To NR\r'jrs 2010/01/08\rIf envpm25hldsw = 0 Then\rForVal = CSng(Math.Exp(5.1238 + 0.2533 * Math.Log(GDPPCP(R%)) - 0.056957 * (Math.Log(GDPPCP(R%))) ^ 2 -\r                    0.4758 * Math.Log(EDYRSAG25(R%, 3)) - 0.0137 * (BaseYear - 1989 + IY - 1) - 0.14 * GDS(R, Health) / GDP(R) * 100))\r\rENVPM2PT5(R%) = ENVPM2PT5Shift(R%) * ForVal\rENVPM2PT5(R%) = ENVPM2PT5(R%) * ENVPM2PT5ConvFct(R%)\rENVPM2PT5(R%) = ENVPM2PT5(R%) * envpm2pt5m(R%)\r'jrs 2009/11/20\rENVPM2PT5(R%) = AMAX(ENVPM2PT5(R%), Pm25Min)\r\r'jrs 2010/01/06\rSENVPM2PT5(R%) = ENVPM2PT5(R%)\rElse 'if Outdoor air polution hold switch is On\rENVPM2PT5(R%) = SENVPM2PT5(R%)\rEnd If\r\rIf hlpm2pt5sw > 0 Then\r'Distal Driver Formulation for Outdoor air polution (PM10)\rForVal = CSng(Math.Exp(4.8929 + 0.2145 * Math.Log(GDPPCP(R%)) - 0.0995 * (Math.Log(GDPPCP(R%)) ^ 2) -\r                    0.451 * Math.Log(EDYRSAG25(R%, 3)) - 0.0181 * (BaseYear - 1989 + IY - 1)))\r'Convert from pm10 to pm2.5\rSENVPM2PT5DDF(R%) = ForVal * ENVPM2PT5ConvFct(R%) * ENVPM2PT5DDFShift(R%)\rEnd If\rNext R\r\rFor R = 1 To NR\r'jrs 2010/01/08\rIf envpm25hldsw = 0 Then\rForVal = CSng(Math.Exp(5.1238 + 0.2533 * Math.Log(GDPPCP(R%)) - 0.056957 * (Math.Log(GDPPCP(R%))) ^ 2 -\r                    0.4758 * Math.Log(EDYRSAG25(R%, 3)) - 0.0137 * (BaseYear - 1989 + IY - 1) - 0.14 * GDS(R, Health) / GDP(R) * 100))\r\rENVPM2PT5(R%) = ENVPM2PT5Shift(R%) * ForVal\rENVPM2PT5(R%) = ENVPM2PT5(R%) * ENVPM2PT5ConvFct(R%)\rENVPM2PT5(R%) = ENVPM2PT5(R%) * envpm2pt5m(R%)\r'jrs 2009/11/20\rENVPM2PT5(R%) = AMAX(ENVPM2PT5(R%), Pm25Min)\r\r'jrs 2010/01/06\rSENVPM2PT5(R%) = ENVPM2PT5(R%)\rElse 'if Outdoor air polution hold switch is On\rENVPM2PT5(R%) = SENVPM2PT5(R%)\rEnd If\r\rIf hlpm2pt5sw > 0 Then\r'Distal Driver Formulation for Outdoor air polution (PM10)\rForVal = CSng(Math.Exp(4.8929 + 0.2145 * Math.Log(GDPPCP(R%)) - 0.0995 * (Math.Log(GDPPCP(R%)) ^ 2) -\r                    0.451 * Math.Log(EDYRSAG25(R%, 3)) - 0.0181 * (BaseYear - 1989 + IY - 1)))\r'Convert from pm10 to pm2.5\rSENVPM2PT5DDF(R%) = ForVal * ENVPM2PT5ConvFct(R%) * ENVPM2PT5DDFShift(R%)\rEnd If\rNext R\r"
  },
  {
    "Variable": "ENVPM2PT5",
    "UsesVariable": "EDYRSAG25",
    "Distance": 1,
    "Code": "\rFor R = 1 To NR\r'jrs 2010/01/08\rIf envpm25hldsw = 0 Then\rForVal = CSng(Math.Exp(5.1238 + 0.2533 * Math.Log(GDPPCP(R%)) - 0.056957 * (Math.Log(GDPPCP(R%))) ^ 2 -\r                    0.4758 * Math.Log(EDYRSAG25(R%, 3)) - 0.0137 * (BaseYear - 1989 + IY - 1) - 0.14 * GDS(R, Health) / GDP(R) * 100))\r\rENVPM2PT5(R%) = ENVPM2PT5Shift(R%) * ForVal\rENVPM2PT5(R%) = ENVPM2PT5(R%) * ENVPM2PT5ConvFct(R%)\rENVPM2PT5(R%) = ENVPM2PT5(R%) * envpm2pt5m(R%)\r'jrs 2009/11/20\rENVPM2PT5(R%) = AMAX(ENVPM2PT5(R%), Pm25Min)\r\r'jrs 2010/01/06\rSENVPM2PT5(R%) = ENVPM2PT5(R%)\rElse 'if Outdoor air polution hold switch is On\rENVPM2PT5(R%) = SENVPM2PT5(R%)\rEnd If\r\rIf hlpm2pt5sw > 0 Then\r'Distal Driver Formulation for Outdoor air polution (PM10)\rForVal = CSng(Math.Exp(4.8929 + 0.2145 * Math.Log(GDPPCP(R%)) - 0.0995 * (Math.Log(GDPPCP(R%)) ^ 2) -\r                    0.451 * Math.Log(EDYRSAG25(R%, 3)) - 0.0181 * (BaseYear - 1989 + IY - 1)))\r'Convert from pm10 to pm2.5\rSENVPM2PT5DDF(R%) = ForVal * ENVPM2PT5ConvFct(R%) * ENVPM2PT5DDFShift(R%)\rEnd If\rNext R\r"
  },
  {
    "Variable": "ENVPM2PT5",
    "UsesVariable": "GDS",
    "Distance": 1,
    "Code": "\rFor R = 1 To NR\r'jrs 2010/01/08\rIf envpm25hldsw = 0 Then\rForVal = CSng(Math.Exp(5.1238 + 0.2533 * Math.Log(GDPPCP(R%)) - 0.056957 * (Math.Log(GDPPCP(R%))) ^ 2 -\r                    0.4758 * Math.Log(EDYRSAG25(R%, 3)) - 0.0137 * (BaseYear - 1989 + IY - 1) - 0.14 * GDS(R, Health) / GDP(R) * 100))\r\rENVPM2PT5(R%) = ENVPM2PT5Shift(R%) * ForVal\rENVPM2PT5(R%) = ENVPM2PT5(R%) * ENVPM2PT5ConvFct(R%)\rENVPM2PT5(R%) = ENVPM2PT5(R%) * envpm2pt5m(R%)\r'jrs 2009/11/20\rENVPM2PT5(R%) = AMAX(ENVPM2PT5(R%), Pm25Min)\r\r'jrs 2010/01/06\rSENVPM2PT5(R%) = ENVPM2PT5(R%)\rElse 'if Outdoor air polution hold switch is On\rENVPM2PT5(R%) = SENVPM2PT5(R%)\rEnd If\r\rIf hlpm2pt5sw > 0 Then\r'Distal Driver Formulation for Outdoor air polution (PM10)\rForVal = CSng(Math.Exp(4.8929 + 0.2145 * Math.Log(GDPPCP(R%)) - 0.0995 * (Math.Log(GDPPCP(R%)) ^ 2) -\r                    0.451 * Math.Log(EDYRSAG25(R%, 3)) - 0.0181 * (BaseYear - 1989 + IY - 1)))\r'Convert from pm10 to pm2.5\rSENVPM2PT5DDF(R%) = ForVal * ENVPM2PT5ConvFct(R%) * ENVPM2PT5DDFShift(R%)\rEnd If\rNext R\r"
  },
  {
    "Variable": "ENVPM2PT5",
    "UsesVariable": "GDP",
    "Distance": 1,
    "Code": "\rFor R = 1 To NR\r'jrs 2010/01/08\rIf envpm25hldsw = 0 Then\rForVal = CSng(Math.Exp(5.1238 + 0.2533 * Math.Log(GDPPCP(R%)) - 0.056957 * (Math.Log(GDPPCP(R%))) ^ 2 -\r                    0.4758 * Math.Log(EDYRSAG25(R%, 3)) - 0.0137 * (BaseYear - 1989 + IY - 1) - 0.14 * GDS(R, Health) / GDP(R) * 100))\r\rENVPM2PT5(R%) = ENVPM2PT5Shift(R%) * ForVal\rENVPM2PT5(R%) = ENVPM2PT5(R%) * ENVPM2PT5ConvFct(R%)\rENVPM2PT5(R%) = ENVPM2PT5(R%) * envpm2pt5m(R%)\r'jrs 2009/11/20\rENVPM2PT5(R%) = AMAX(ENVPM2PT5(R%), Pm25Min)\r\r'jrs 2010/01/06\rSENVPM2PT5(R%) = ENVPM2PT5(R%)\rElse 'if Outdoor air polution hold switch is On\rENVPM2PT5(R%) = SENVPM2PT5(R%)\rEnd If\r\rIf hlpm2pt5sw > 0 Then\r'Distal Driver Formulation for Outdoor air polution (PM10)\rForVal = CSng(Math.Exp(4.8929 + 0.2145 * Math.Log(GDPPCP(R%)) - 0.0995 * (Math.Log(GDPPCP(R%)) ^ 2) -\r                    0.451 * Math.Log(EDYRSAG25(R%, 3)) - 0.0181 * (BaseYear - 1989 + IY - 1)))\r'Convert from pm10 to pm2.5\rSENVPM2PT5DDF(R%) = ForVal * ENVPM2PT5ConvFct(R%) * ENVPM2PT5DDFShift(R%)\rEnd If\rNext R\r"
  },
  {
    "Variable": "ENVPM2PT5",
    "UsesVariable": "envpm25hldsw",
    "Distance": 0,
    "Code": "\rFor R = 1 To NR\r'jrs 2010/01/08\rIf envpm25hldsw = 0 Then\rForVal = CSng(Math.Exp(5.1238 + 0.2533 * Math.Log(GDPPCP(R%)) - 0.056957 * (Math.Log(GDPPCP(R%))) ^ 2 -\r                    0.4758 * Math.Log(EDYRSAG25(R%, 3)) - 0.0137 * (BaseYear - 1989 + IY - 1) - 0.14 * GDS(R, Health) / GDP(R) * 100))\r\rENVPM2PT5(R%) = ENVPM2PT5Shift(R%) * ForVal\rENVPM2PT5(R%) = ENVPM2PT5(R%) * ENVPM2PT5ConvFct(R%)\rENVPM2PT5(R%) = ENVPM2PT5(R%) * envpm2pt5m(R%)\r'jrs 2009/11/20\rENVPM2PT5(R%) = AMAX(ENVPM2PT5(R%), Pm25Min)\r\r'jrs 2010/01/06\rSENVPM2PT5(R%) = ENVPM2PT5(R%)\rElse 'if Outdoor air polution hold switch is On\rENVPM2PT5(R%) = SENVPM2PT5(R%)\rEnd If\r\rIf hlpm2pt5sw > 0 Then\r'Distal Driver Formulation for Outdoor air polution (PM10)\rForVal = CSng(Math.Exp(4.8929 + 0.2145 * Math.Log(GDPPCP(R%)) - 0.0995 * (Math.Log(GDPPCP(R%)) ^ 2) -\r                    0.451 * Math.Log(EDYRSAG25(R%, 3)) - 0.0181 * (BaseYear - 1989 + IY - 1)))\r'Convert from pm10 to pm2.5\rSENVPM2PT5DDF(R%) = ForVal * ENVPM2PT5ConvFct(R%) * ENVPM2PT5DDFShift(R%)\rEnd If\rNext R\r"
  },
  {
    "Variable": "ENVPRCHG",
    "UsesVariable": "envclimsens",
    "Distance": 80,
    "Code": "\rNext\r\r'      'jrs 2009/12/07\r'      RegAvgOneDimInMem CENVPRCHG, CLandArea, PRECChg, \"CENVPRCHG\"\rFor Each item In (From s In CENVPRCHG\rJoin r In context.Regionalization On s.Key Equals r.Key\rJoin w In CLANDAREA On s.Key Equals w.Key\rGroup Value = s.Value, Weight = w.Value By RegionId = r.Value Into Data = Group, TotalWeight = Sum(Weight)\r\r\r'bbh 2022/04/26 start Move DeltaWT and WTEMP from late and bottom of procedure to here to replace old function use\rDim DeltaWT As Single, CO2PPM1990 As Single\rIf context.HistoricMode = False Then\r'source:\r'http://cdiac.ornl.gov/ftp/trends/co2/maunaloa.co2\rCO2PPM1990 = 354.19\rDeltaWT = CSng(envclimsens / Math.Log(2) * Math.Log(CO2PPM / CO2PPM1990))\rIf IY = 1 Then\r'finding WTEMP for 1990, based on CO2 levels of 350\r'Call XYTABL(\"CO2 PPM Versus Global Temperature\", CO2PPM1990, SWTEMP)\r'using data from Historic Table temperatures (Dale)\r'Source: http://www.ncdc.noaa.gov/oa/climate/research/anomalies/index.html#mean\rSWTEMP = 14.2861  'In 2020 Dale Rothman suggested could be 14.43C in Climate change and impact.docx p6 comment\rEnd If\r\r'bbh 2019/04/06\r'WTEMP = SWTEMP + DeltaWT\rWTEMP = SWTEMP + DeltaWT + wtempadd\r'SWTEMP is actually an intial value not an accrued stock (DelatWT is from 1990)\rElse\rCall XYTABL(\"CO2 PPM Versus Global Temperature\", CO2PPM, WTEMP, context)\rWTEMP = WTEMP + wtempadd\rEnd If\r\r).ToDictionary(\rFunction(grp) grp.RegionId,\r                     Function(grp) grp.Data.Sum(Function(v) v.Value * v.Weight) / grp.TotalWeight\r)\rPRECChg(item.Key) = CSng(item.Value)\r\rDeltaP = CSng(100 * ((1 + PRECChg(R%) / 100) ^ DeltaWT - 1))\r\r'ENVPRCHG(R%) = SENVPRCHG(R%) * (1 + DeltaP / 100)\rENVPRCHG(R%) = DeltaP\r"
  },
  {
    "Variable": "ENVPRCHG",
    "UsesVariable": "CO2PPM",
    "Distance": 80,
    "Code": "\rNext\r\r'      'jrs 2009/12/07\r'      RegAvgOneDimInMem CENVPRCHG, CLandArea, PRECChg, \"CENVPRCHG\"\rFor Each item In (From s In CENVPRCHG\rJoin r In context.Regionalization On s.Key Equals r.Key\rJoin w In CLANDAREA On s.Key Equals w.Key\rGroup Value = s.Value, Weight = w.Value By RegionId = r.Value Into Data = Group, TotalWeight = Sum(Weight)\r"
  },
  {
    "Variable": "ENVTEMP",
    "UsesVariable": "ENVTPCHG",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ENVTPCHG",
    "UsesVariable": "envclimsens",
    "Distance": 81,
    "Code": "\r).ToDictionary(\rFunction(grp) grp.RegionId,\r                     Function(grp) grp.Data.Sum(Function(v) v.Value * v.Weight) / grp.TotalWeight\r)\rTEMPChg(item.Key) = CSng(item.Value)\r\r\r'bbh 2022/04/26 start Move DeltaWT and WTEMP from late and bottom of procedure to here to replace old function use\rDim DeltaWT As Single, CO2PPM1990 As Single\rIf context.HistoricMode = False Then\r'source:\r'http://cdiac.ornl.gov/ftp/trends/co2/maunaloa.co2\rCO2PPM1990 = 354.19\rDeltaWT = CSng(envclimsens / Math.Log(2) * Math.Log(CO2PPM / CO2PPM1990))\rIf IY = 1 Then\r'finding WTEMP for 1990, based on CO2 levels of 350\r'Call XYTABL(\"CO2 PPM Versus Global Temperature\", CO2PPM1990, SWTEMP)\r'using data from Historic Table temperatures (Dale)\r'Source: http://www.ncdc.noaa.gov/oa/climate/research/anomalies/index.html#mean\rSWTEMP = 14.2861  'In 2020 Dale Rothman suggested could be 14.43C in Climate change and impact.docx p6 comment\rEnd If\r\r'bbh 2019/04/06\r'WTEMP = SWTEMP + DeltaWT\rWTEMP = SWTEMP + DeltaWT + wtempadd\r'SWTEMP is actually an intial value not an accrued stock (DelatWT is from 1990)\rElse\rCall XYTABL(\"CO2 PPM Versus Global Temperature\", CO2PPM, WTEMP, context)\rWTEMP = WTEMP + wtempadd\rEnd If\r\r\r'jrs 2009/12/07\rDeltaT = DeltaWT * TEMPChg(R%)\r\r'ENVTEMP(R%) = SENVTPCHG(R%) + DeltaT\rENVTPCHG(R%) = DeltaT\r"
  },
  {
    "Variable": "ENVTPCHG",
    "UsesVariable": "CO2PPM",
    "Distance": 81,
    "Code": "\r).ToDictionary(\rFunction(grp) grp.RegionId,\r                     Function(grp) grp.Data.Sum(Function(v) v.Value * v.Weight) / grp.TotalWeight\r)\rTEMPChg(item.Key) = CSng(item.Value)\r"
  },
  {
    "Variable": "ENVYLCHG",
    "UsesVariable": "envylchgadd",
    "Distance": 0,
    "Code": "\r\rIf IY > 1 Then\r'jrs 2014/03/19 ENVYLCHG(R%) = 100 * ((1 + ENVYLCHG(R%) / 100) / (1 + SENVYLCHG(R%) / 100) - 1)\rENVYLCHG(R%) = 100 * ((1 + ENVYLCHG(R%) / 100) / (1 + IENVYLCHG(R%) / 100) - 1)\rENVYLCHG(R%) = ENVYLCHG(R%) * envylchgm(R%)\rENVYLCHG(R%) = ENVYLCHG(R%) + envylchgadd\r'jrs 2014/03/19\rSENVYLCHG(R%) = ENVYLCHG(R%)\rElse\r'jrs 2014/03/19\rIENVYLCHG(R%) = ENVYLCHG(R%)\rSENVYLCHG(R%) = 0\rENVYLCHG(R%) = 0\r'jrs 2022/04/04\rIENVTPCHG(R%) = ENVTPCHG(R%)\rEnd If\r\r\rIf IY > 1 Then\r'jrs 2014/03/19 ENVYLCHG(R%) = 100 * ((1 + ENVYLCHG(R%) / 100) / (1 + SENVYLCHG(R%) / 100) - 1)\rENVYLCHG(R%) = 100 * ((1 + ENVYLCHG(R%) / 100) / (1 + IENVYLCHG(R%) / 100) - 1)\rENVYLCHG(R%) = ENVYLCHG(R%) * envylchgm(R%)\rENVYLCHG(R%) = ENVYLCHG(R%) + envylchgadd\r'jrs 2014/03/19\rSENVYLCHG(R%) = ENVYLCHG(R%)\rElse\r'jrs 2014/03/19\rIENVYLCHG(R%) = ENVYLCHG(R%)\rSENVYLCHG(R%) = 0\rENVYLCHG(R%) = 0\r'jrs 2022/04/04\rIENVTPCHG(R%) = ENVTPCHG(R%)\rEnd If\r"
  },
  {
    "Variable": "ENVYLCHG",
    "UsesVariable": "envylchgm",
    "Distance": 0,
    "Code": "\r\rIf IY > 1 Then\r'jrs 2014/03/19 ENVYLCHG(R%) = 100 * ((1 + ENVYLCHG(R%) / 100) / (1 + SENVYLCHG(R%) / 100) - 1)\rENVYLCHG(R%) = 100 * ((1 + ENVYLCHG(R%) / 100) / (1 + IENVYLCHG(R%) / 100) - 1)\rENVYLCHG(R%) = ENVYLCHG(R%) * envylchgm(R%)\rENVYLCHG(R%) = ENVYLCHG(R%) + envylchgadd\r'jrs 2014/03/19\rSENVYLCHG(R%) = ENVYLCHG(R%)\rElse\r'jrs 2014/03/19\rIENVYLCHG(R%) = ENVYLCHG(R%)\rSENVYLCHG(R%) = 0\rENVYLCHG(R%) = 0\r'jrs 2022/04/04\rIENVTPCHG(R%) = ENVTPCHG(R%)\rEnd If\r"
  },
  {
    "Variable": "ENVYLCHG",
    "UsesVariable": "envco2fert",
    "Distance": 27,
    "Code": "COMPLETE STRUCTURE:End If:611|\r\r'jrs 2009/07/10\r'All Years: Climate Sensibility to Yield Crop\r'------------------------------------------------\rIf Not context.HistoricMode Then\r'bbh 2022/04/26 start\rDim DeltaP As Single, DeltaT As Single\rDim CO2Fert As Single\r'source:\r'http://cdiac.ornl.gov/ftp/trends/co2/maunaloa.co2\r'CO2PPM1990 = 354.19\r'DeltaWT = envclimsens / Log(2) * Log(CO2PPM / CO2PPM1990)\r'bbh 2022/04/26 end\rCO2Fert = envco2fert * (CO2PPM / CO2PPM1990 - 1) * 100\r\rENVYLCHG(R%) = ((CO2Fert / 100 + 1) * (ENVYLCHG(R%) / 100 + 1) - 1) * 100\r\r\rIf IY > 1 Then\r'jrs 2014/03/19 ENVYLCHG(R%) = 100 * ((1 + ENVYLCHG(R%) / 100) / (1 + SENVYLCHG(R%) / 100) - 1)\rENVYLCHG(R%) = 100 * ((1 + ENVYLCHG(R%) / 100) / (1 + IENVYLCHG(R%) / 100) - 1)\rENVYLCHG(R%) = ENVYLCHG(R%) * envylchgm(R%)\rENVYLCHG(R%) = ENVYLCHG(R%) + envylchgadd\r'jrs 2014/03/19\rSENVYLCHG(R%) = ENVYLCHG(R%)\rElse\r'jrs 2014/03/19\rIENVYLCHG(R%) = ENVYLCHG(R%)\rSENVYLCHG(R%) = 0\rENVYLCHG(R%) = 0\r'jrs 2022/04/04\rIENVTPCHG(R%) = ENVTPCHG(R%)\rEnd If\r"
  },
  {
    "Variable": "ENVYLCHG",
    "UsesVariable": "CO2PPM",
    "Distance": 27,
    "Code": "COMPLETE STRUCTURE:End If:611|\r\r'jrs 2009/07/10\r'All Years: Climate Sensibility to Yield Crop\r'------------------------------------------------\rIf Not context.HistoricMode Then\r'bbh 2022/04/26 start\rDim DeltaP As Single, DeltaT As Single\rDim CO2Fert As Single\r'source:\r'http://cdiac.ornl.gov/ftp/trends/co2/maunaloa.co2\r'CO2PPM1990 = 354.19\r'DeltaWT = envclimsens / Log(2) * Log(CO2PPM / CO2PPM1990)\r'bbh 2022/04/26 end\rCO2Fert = envco2fert * (CO2PPM / CO2PPM1990 - 1) * 100\r"
  },
  {
    "Variable": "ENVYLCHG",
    "UsesVariable": "ENVTEMP",
    "Distance": 22,
    "Code": "0"
  },
  {
    "Variable": "ENVYLCHG",
    "UsesVariable": "ENVTPCHG",
    "Distance": 15,
    "Code": "\r\r'jrs 2022/10/17 Exogenous Models\rIf ifsexomodelid > 0 Then\rReplaceVarWithExogenousForecastxReg(\"ENVPRCHG\", \"\", \"\", CStr(FirstYear + IY - 1), R%, context)\rDeltaP = ENVPRCHG(R%)\rEnd If\r"
  },
  {
    "Variable": "ENVYLCHG",
    "UsesVariable": "ifsexomodelid",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "ENVYLCHG",
    "UsesVariable": "ENVPRCHG",
    "Distance": 14,
    "Code": "\r).ToDictionary(\rFunction(grp) grp.RegionId,\r                     Function(grp) grp.Data.Sum(Function(v) v.Value * v.Weight) / grp.TotalWeight\r)\rSENVPREC(item.Key) = CSng(item.Value)\rNext\r\r"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "ENM",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "enxm",
    "Distance": 0,
    "Code": "\rENX(R%) = ENX(R%) * enxm(R%)\r"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "gdprext",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "elasxincshock",
    "Distance": 2,
    "Code": "\r\r'jrs 2020/06/23 *** begin ***\rIf gdprext(R%) > -99 Then\rDim factorm As Single\rDim factorx As Single\r'jrs 2020/07/06 changed parameter name\rfactorm = AMAX(1 + (gdprext(R%) / 100 - SmoothGDPR(R%)) * elasmincshock(R%, 2), 0.00001F) 'jrs 2020/07/01 added AMAX(,0)\rfactorx = AMAX(1 + (gdprext(R%) / 100 - SmoothGDPR(R%)) * elasxincshock(R%, 2), 0.00001F) 'jrs 2020/07/01 added AMAX(,0)\rENM(R%) = ENM(R%) * factorm\rENX(R%) = ENX(R%) * factorx\rEnd If\r"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "enxl",
    "Distance": 0,
    "Code": "\r\rIf enxl(R%) > 0.001 Then 'Export Restraint\rTradeRestraint = TradeRestraint + AMAX(0, ENX(R%) - enxl(R%))\rENX(R%) = Amin(ENX(R%), enxl(R%))\rEnd If\r"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "ENDEM",
    "Distance": 20,
    "Code": "0"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "ENST",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "ENSHO",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "trademax",
    "Distance": 177,
    "Code": "0"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "ENP",
    "Distance": 182,
    "Code": "0"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "endemm",
    "Distance": 73,
    "Code": "0"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "enrgdpgr",
    "Distance": 73,
    "Code": "0"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "GDPP",
    "Distance": 101,
    "Code": "0"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "POPR",
    "Distance": 188,
    "Code": "0"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "enconv",
    "Distance": 94,
    "Code": "0"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "WEP",
    "Distance": 76,
    "Code": "0"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "ENPRI",
    "Distance": 139,
    "Code": "0"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "elasde",
    "Distance": 75,
    "Code": "0"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "GDPPC",
    "Distance": 189,
    "Code": "0"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "igdpr",
    "Distance": 189,
    "Code": "0"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "WEPBYEAR",
    "Distance": 125,
    "Code": "0"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "POP",
    "Distance": 100,
    "Code": "0"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "EXRATE",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "ENX",
    "UsesVariable": "XS",
    "Distance": 0,
    "Code": "\rENX(R%) = XS(R%, Ener) / WEPBYEAR 'keep this before any use of enm, enx or\r"
  },
  {
    "Variable": "EPROFITR",
    "UsesVariable": "eprohw",
    "Distance": 0,
    "Code": "\r'\r'     All but First:  Energy Returns - Total Energy Sector\r'     ----------------------------------------------------\rFor R% = 1 To NR%\rDim ProdCost = 0!\rDim EnReturn = 0!\rFor e% = 1 To Renew  'Oil, gas, coal, hydro, nuclear, renewable\rProdCost = ProdCost + sken(R%, e%) / AMAX(5, lke(e%))  'jrs 2021/11/15 changed to sken\r'BBH 7/15/04 V5_01\r'EnReturn = EnReturn + ENP(R%, e%) * WEP\rEnReturn = CSng(EnReturn + ENP(R%, e%) * WEPNoTax) '(tax does not increase return)\r'World price provides stability; use without capacity factor\r'to obtain true capital costs\rNext e%\rEnReturn = EnReturn / ProdCost\rIf IY% = 2 Then EnReturnI(R%) = EnReturn\rEPROFITR(R%) = SEProfitR(R%) * eprohw + EnReturn / EnReturnI(R%) * (1 - eprohw)\rNext R%\r"
  },
  {
    "Variable": "EPROFITR",
    "UsesVariable": "ENP",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "EPROFITR",
    "UsesVariable": "ken",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "EPROFITR",
    "UsesVariable": "lke",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "EPROFITR",
    "UsesVariable": "ENPRI",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "EPROFITR",
    "UsesVariable": "enprix",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "EXRATE",
    "UsesVariable": "XDEBTRPA",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "EXRATE",
    "UsesVariable": "GDPPOT",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "EXRATE",
    "UsesVariable": "elerca1",
    "Distance": 13,
    "Code": "\r'Diff2 = (XDEBTRPA(R%) / GDPPOT(R%) - ssxdebtrpa(R%) / GDPPOT(R%)) * 100\rDiff2 = (XDEBTRPA(R%) / GDPPOT(R%) * 100) - ssxdebtrpapercent(R%)\r"
  },
  {
    "Variable": "EXRATE",
    "UsesVariable": "elerca2",
    "Distance": 12,
    "Code": "\r\r'   All but First:  Exchange Rates\r'   --------------------------------\r\r'If RegName$(R%) = \"Britain\" Then Stop\r'bbh 2014/04/02 Start Reworked exchange rate logic\r'bbh 2019/01/21 4 lines\r'bbh 2022/06/23 start reworking of exchange rates to prevent debt overshoot and also to keep\r'   change in trade from being so fast as to mess up C and therefore poverty\r'        Par1 = elerca1\r'        Par2 = elerca2\r'Par1 = elerca1 * 0.2\r'Par2 = elerca2 * 0.2\r\r'bbh 2021/09/09 Start: Cut these substantially and dampened exchange rates and current account, also C and Poverty swings\r'Via scenario tried globally and had lesser but positive effect; so am requesting global parameter change instead of this code\r'If RegName$(R%) = \"Guinea Bissau\" Then\r'    Par1 = -0.1\r'    Par2 = -0.2\r'End If\r'bbh 2021/09/09 end\r\r'If (SX(R%) + SM(R%)) > GDPPOT(R%) Then\r'    Mul = CSng(AMAX(0.5, (GDPPOT(R%) / (SX(R%) + SM(R%))) ^ 3))\r'    'Scale back entrepot economies or they over-react\r'    Par1 = CSng(elerca1 * Mul * 0.5)\r'    Par2 = CSng(elerca2 * Mul * 0.7 * 0.5)\r'    '        Else\r'    '            Mul = 1\r'End If\r'bbh 2022/06/23 testing to get exchange rate to change with debt; helps considerably\r'   Probably reactivate something like it and generalize across high trade economies but\r'   after rework treatment of XDEBT, XNFA, and XNIIP logic in preprocresor and model\r'If RegName$(R%) = \"Brunei Darussalam\" Then\r\rIf XDEBTRPA(R%) / GDPPOT(R%) > 1 Then 'run up multiplier from 1 to as much as 3 with positive debt levels/GDP\r'Mul = Amin(3, XDEBTRPA(R%) / GDPPOT(R%) - 1)\rMul = Amin(3, XDEBTRPA(R%) / GDPPOT(R%)) 'bbh 2022/10/27 replaced above because was transient\rEnd If\r"
  },
  {
    "Variable": "EXTRASTDRATIO",
    "UsesVariable": "GDS",
    "Distance": 807,
    "Code": "0"
  },
  {
    "Variable": "EXTRASTDRATIO",
    "UsesVariable": "EDPRITOT",
    "Distance": 802,
    "Code": "0"
  },
  {
    "Variable": "EXTRASTDRATIO",
    "UsesVariable": "EDTERTOT",
    "Distance": 799,
    "Code": "0"
  },
  {
    "Variable": "EXTRASTDRATIO",
    "UsesVariable": "EDEXPERPRI",
    "Distance": 806,
    "Code": "0"
  },
  {
    "Variable": "EXTRASTDRATIO",
    "UsesVariable": "GDPPC",
    "Distance": 806,
    "Code": "0"
  },
  {
    "Variable": "EXTRASTDRATIO",
    "UsesVariable": "EDSECLOWRTOT",
    "Distance": 801,
    "Code": "0"
  },
  {
    "Variable": "EXTRASTDRATIO",
    "UsesVariable": "EDSECUPPRTOT",
    "Distance": 800,
    "Code": "0"
  },
  {
    "Variable": "EXTRASTDRATIO",
    "UsesVariable": "EDEXPERTER",
    "Distance": 803,
    "Code": "0"
  },
  {
    "Variable": "EXTRASTDRATIO",
    "UsesVariable": "EDEXPERSECLOWR",
    "Distance": 805,
    "Code": "0"
  },
  {
    "Variable": "EXTRASTDRATIO",
    "UsesVariable": "EDEXPERSECUPPR",
    "Distance": 804,
    "Code": "0"
  },
  {
    "Variable": "FDEM",
    "UsesVariable": "AGDEM",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "FDEM",
    "UsesVariable": "FSTOCK",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "FDEM",
    "UsesVariable": "AGP",
    "Distance": 29,
    "Code": "0"
  },
  {
    "Variable": "FDEM",
    "UsesVariable": "AGX",
    "Distance": 28,
    "Code": "\r\r'   First Year:  Profits and Prices\r'   -------------------------------\r\rFor f% = 1 To 3\rFPROFITR(R%, f%) = 1\rsfprofitr(R%, f%) = 1\rSSFProfitR(R%, f%) = 1\rsbalance(R%, f%) = 0\rSBalanceForYl(R%) = 0 'bbh 2022/11/28\rcumstk(R%, f%) = FSTOCK(R%, f%)\rscumstk(R%, f%) = cumstk(R%, f%)\rCumStkNegOK(R%, f%) = FSTOCK(R%, f%) 'bbh 2022/10/27 Added 2 lines allowing Negative Stocks\rSCumStkNegOK(R%, f%) = CumStkNegOK(R%, f%)\rscountryextrasurdef(R%, f%) = 0  'For trade adjustment\rNext f%\r"
  },
  {
    "Variable": "FDEM",
    "UsesVariable": "AGM",
    "Distance": 28,
    "Code": "\r\r'   First Year:  Profits and Prices\r'   -------------------------------\r\rFor f% = 1 To 3\rFPROFITR(R%, f%) = 1\rsfprofitr(R%, f%) = 1\rSSFProfitR(R%, f%) = 1\rsbalance(R%, f%) = 0\rSBalanceForYl(R%) = 0 'bbh 2022/11/28\rcumstk(R%, f%) = FSTOCK(R%, f%)\rscumstk(R%, f%) = cumstk(R%, f%)\rCumStkNegOK(R%, f%) = FSTOCK(R%, f%) 'bbh 2022/10/27 Added 2 lines allowing Negative Stocks\rSCumStkNegOK(R%, f%) = CumStkNegOK(R%, f%)\rscountryextrasurdef(R%, f%) = 0  'For trade adjustment\rNext f%\r"
  },
  {
    "Variable": "FDEM",
    "UsesVariable": "WAP",
    "Distance": 238,
    "Code": "0"
  },
  {
    "Variable": "FDEM",
    "UsesVariable": "C",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "FDEM",
    "UsesVariable": "GRAMSPC",
    "Distance": 0,
    "Code": "\r'jrs 2019/05/03 *** END ***\r'dsr 2015/03/18 Convert Daily per Capita Calorie Demand to Initial Estimate of Annual Total Food Demand **** start\rFor f% = 1 To 3\r'dsr 2015/06/15 Decreases in waste from first year lead to fewer grams needed per calorie. Since\r'    data used to calculate initial ratio of grams to calories accounted for initial waste rate\r'    adjust with changes from first year.\r'kbn 2017/08/28 Recompute consumption losses here\rDim aglossconspercpred = 0!\rCall XYTABL(\"GDP/Capita (PPP 2011) Versus Consumption Losses (Log)\", GDPPCP(R%), aglossconspercpred, context)\r'kbn 2017/08/28 end\r'bbh 2017/09/11 start; fixed bug in comp of GRAMSPC\r'kbn 2017/09/13 add multipliers below\rDim aglossconsperc = Amin(AMAX(aglossconspercpred * aglossconsm(R%, f%), 5), 18)\r'         GRAMSPC(R%, f%) = GramsToCalRatI(R%, f%) * CLPC(R%, f%) * (aglossconsperc / aglossconsperci(R%, f%))\rGRAMSPC(R%, f%) = GramsToCalRatI(R%, f%) * CLPC(R%, f%) *\r            (1 - aglossconsperci(R%, f%) / 100) / (1 - aglossconsperc / 100)\r'bbh 2017/09/11 end\rFDEM(R%, f%) = GRAMSPC(R%, f%) * POP(R%) * 365 / 1000000\rNext f%\r"
  },
  {
    "Variable": "FDEM",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r'jrs 2019/05/03 *** END ***\r'dsr 2015/03/18 Convert Daily per Capita Calorie Demand to Initial Estimate of Annual Total Food Demand **** start\rFor f% = 1 To 3\r'dsr 2015/06/15 Decreases in waste from first year lead to fewer grams needed per calorie. Since\r'    data used to calculate initial ratio of grams to calories accounted for initial waste rate\r'    adjust with changes from first year.\r'kbn 2017/08/28 Recompute consumption losses here\rDim aglossconspercpred = 0!\rCall XYTABL(\"GDP/Capita (PPP 2011) Versus Consumption Losses (Log)\", GDPPCP(R%), aglossconspercpred, context)\r'kbn 2017/08/28 end\r'bbh 2017/09/11 start; fixed bug in comp of GRAMSPC\r'kbn 2017/09/13 add multipliers below\rDim aglossconsperc = Amin(AMAX(aglossconspercpred * aglossconsm(R%, f%), 5), 18)\r'         GRAMSPC(R%, f%) = GramsToCalRatI(R%, f%) * CLPC(R%, f%) * (aglossconsperc / aglossconsperci(R%, f%))\rGRAMSPC(R%, f%) = GramsToCalRatI(R%, f%) * CLPC(R%, f%) *\r            (1 - aglossconsperci(R%, f%) / 100) / (1 - aglossconsperc / 100)\r'bbh 2017/09/11 end\rFDEM(R%, f%) = GRAMSPC(R%, f%) * POP(R%) * 365 / 1000000\rNext f%\r"
  },
  {
    "Variable": "FDEM",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "\r'jrs 2019/05/03 *** END ***\r'dsr 2015/03/18 Convert Daily per Capita Calorie Demand to Initial Estimate of Annual Total Food Demand **** start\rFor f% = 1 To 3\r'dsr 2015/06/15 Decreases in waste from first year lead to fewer grams needed per calorie. Since\r'    data used to calculate initial ratio of grams to calories accounted for initial waste rate\r'    adjust with changes from first year.\r'kbn 2017/08/28 Recompute consumption losses here\rDim aglossconspercpred = 0!\rCall XYTABL(\"GDP/Capita (PPP 2011) Versus Consumption Losses (Log)\", GDPPCP(R%), aglossconspercpred, context)\r'kbn 2017/08/28 end\r'bbh 2017/09/11 start; fixed bug in comp of GRAMSPC\r'kbn 2017/09/13 add multipliers below\rDim aglossconsperc = Amin(AMAX(aglossconspercpred * aglossconsm(R%, f%), 5), 18)\r'         GRAMSPC(R%, f%) = GramsToCalRatI(R%, f%) * CLPC(R%, f%) * (aglossconsperc / aglossconsperci(R%, f%))\rGRAMSPC(R%, f%) = GramsToCalRatI(R%, f%) * CLPC(R%, f%) *\r            (1 - aglossconsperci(R%, f%) / 100) / (1 - aglossconsperc / 100)\r'bbh 2017/09/11 end\rFDEM(R%, f%) = GRAMSPC(R%, f%) * POP(R%) * 365 / 1000000\rNext f%\r"
  },
  {
    "Variable": "FEDDEM",
    "UsesVariable": "AGDEM",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "FEDDEM",
    "UsesVariable": "FSTOCK",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "FEDDEM",
    "UsesVariable": "AGP",
    "Distance": 30,
    "Code": "0"
  },
  {
    "Variable": "FEDDEM",
    "UsesVariable": "AGX",
    "Distance": 29,
    "Code": "\r\r'   First Year:  Profits and Prices\r'   -------------------------------\r\rFor f% = 1 To 3\rFPROFITR(R%, f%) = 1\rsfprofitr(R%, f%) = 1\rSSFProfitR(R%, f%) = 1\rsbalance(R%, f%) = 0\rSBalanceForYl(R%) = 0 'bbh 2022/11/28\rcumstk(R%, f%) = FSTOCK(R%, f%)\rscumstk(R%, f%) = cumstk(R%, f%)\rCumStkNegOK(R%, f%) = FSTOCK(R%, f%) 'bbh 2022/10/27 Added 2 lines allowing Negative Stocks\rSCumStkNegOK(R%, f%) = CumStkNegOK(R%, f%)\rscountryextrasurdef(R%, f%) = 0  'For trade adjustment\rNext f%\r"
  },
  {
    "Variable": "FEDDEM",
    "UsesVariable": "AGM",
    "Distance": 29,
    "Code": "\r\r'   First Year:  Profits and Prices\r'   -------------------------------\r\rFor f% = 1 To 3\rFPROFITR(R%, f%) = 1\rsfprofitr(R%, f%) = 1\rSSFProfitR(R%, f%) = 1\rsbalance(R%, f%) = 0\rSBalanceForYl(R%) = 0 'bbh 2022/11/28\rcumstk(R%, f%) = FSTOCK(R%, f%)\rscumstk(R%, f%) = cumstk(R%, f%)\rCumStkNegOK(R%, f%) = FSTOCK(R%, f%) 'bbh 2022/10/27 Added 2 lines allowing Negative Stocks\rSCumStkNegOK(R%, f%) = CumStkNegOK(R%, f%)\rscountryextrasurdef(R%, f%) = 0  'For trade adjustment\rNext f%\r"
  },
  {
    "Variable": "FEDDEM",
    "UsesVariable": "FDEM",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "FEDDEM",
    "UsesVariable": "LVHERD",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "FEDDEM",
    "UsesVariable": "livhdpro",
    "Distance": 0,
    "Code": "\rIf GLDCAP(R%) <= MinLDProd Then 'Put in multiplier that basically increases land productivity\rDim FeedEquiv = LD(R%, 2) * MinLDProd\rfedreqm(R%) = (FeedEquiv + FEDDEM(R%, 1)) / AMAX(0.001, LVHERD(R%) * fedreq(R%))\rGLDCAP(R%) = (LVHERD(R%) * fedreq(R%) * fedreqm(R%) - FEDDEM(R%, 1)) / LD(R%, 2)\rGLDCAP(R%) = AMAX(GLDCAP(R%), MinLDProd)\rEnd If\r\rCall XYTABL(\"GDP/Capita (PPP) Versus Feed Requirements\", GDPPCP(R%), fedreq(R%), context)\r"
  },
  {
    "Variable": "FEDDEM",
    "UsesVariable": "feddemm",
    "Distance": 0,
    "Code": "\rGLFeedEq = AMAX(GLFeedEq, LD(R%, 2) * GLDCAP(R%))\r"
  },
  {
    "Variable": "FEDDEM",
    "UsesVariable": "GDPPCP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "FEDDEM",
    "UsesVariable": "LD",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "FEDDEM",
    "UsesVariable": "GLDCAP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "FEDDEM",
    "UsesVariable": "WAP",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "FEDDEM",
    "UsesVariable": "elglinpr",
    "Distance": 3,
    "Code": "\r\rFor f% = 1 To 3\rswapi(f%) = WAP(f%)\rswxc(f%) = 1\rswmd(f%) = 1\rGlobalSurDefRate(f%) = 0 'bbh 2022/10/27\rSGlobalSurDefRate(f%) = 0 'bbh 2022/11/28\rWTFoodType(f%) = 0 'bbh 2022/10/27 Initialize global trade by food type\rFor R% = 1 To NR%\rWTFoodType(f%) = WTFoodType(f%) + AGX(R%, f%)\rNext R%\rNext f%\r"
  },
  {
    "Variable": "FEMSHRLAB",
    "UsesVariable": "femshrgr",
    "Distance": 0,
    "Code": "\rFEMSHRLAB(R%) = FEMSHRLAB(R%) + femshrgr * FemShrLabMul\r"
  },
  {
    "Variable": "FEMSHRLAB",
    "UsesVariable": "labfemshrm",
    "Distance": 3,
    "Code": "\r'mti 2018/07/02 End\r\rfemshrlabi(R%) = FEMSHRLAB(R%)\r\r'mti 2018/07/02 End\r\rfemshrlabi(R%) = FEMSHRLAB(R%)\r\r'        'bbh 2021/09/30 end full block changes\r\r'   All but First 1:  Labor Supply\r'   ------------------------------\r\rFemShrTar = Amin(60, Amin(50, femshrlabi(R%) + 20) * labfemshrm(R%))\r\rIf femshrlabi(R%) > 0.97 * FemShrTar Then\rFemShrLabMul = 0\rElse\r\rFemShrLabMul = AMAX(0, (FemShrTar - FEMSHRLAB(R%)) / (FemShrTar - femshrlabi(R%)))\rEnd If\r"
  },
  {
    "Variable": "FIRMEARN",
    "UsesVariable": "VADDF",
    "Distance": 0,
    "Code": "\rFor S% = 1 To NSec%\rVADDHHU(R%, S%) = VADDHHU(R%, S%) * (1 - CDALF(R%))\rHHINCEARN(R%, Unskilled) = HHINCEARN(R%, Unskilled) + VADDHHU(R%, S%)\rVADDHHS(R%, S%) = VADDHHS(R%, S%) * (1 - CDALF(R%))\rHHINCEARN(R%, Skilled) = HHINCEARN(R%, Skilled) + VADDHHS(R%, S%)\r'bbh 2020/08/05 Start\r'VADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'bbh 2020/08/20 start\r\r'bbh 2021/08/04 start  Total VADD finalized in IFsEco; household adjusts with CAPUT to help on stocks, above; change firm but leave VADD total alone\r'If CAPUT(R%, S%) > caputtar And gdprext(R%) < -70 Then\r'If CAPUT(R%, S%) > caputtar And gdprext(R%) > -70 Then 'bbh 2021/07/07 start 'bbh 2021/08/04\r'            If gdprext(R%) > -70 Then 'bbh 2021/08/04 Growth exogenous\r'                'VADDF(R%, S%) = (VADD(R%, S%) / ((CAPUT(R%, S%) / caputtar) ^ 0.5)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                VADDF(R%, S%) = (VADD(R%, S%) / (CAPUT(R%, S%) / caputtar)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                'VADDF(R%, S%) = (VaddPreCaput(R%, S%) / (CAPUT(R%, S%) / caputtar)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'            Else 'growth is endogenous\r'                VADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                'VADDF(R%, S%) = VaddPreCaput(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'            End If\rVADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'bbh 2021/08/04 end\r\r'bbh 2021/07/07 end\r'bbh 2020/08/20 end\r'bbh 2020/08/05 end\rFIRMEARN(R%) = FIRMEARN(R%) + VADDF(R%, S%)\rNext S%\r"
  },
  {
    "Variable": "FIRMGOVSS",
    "UsesVariable": "FIRMTAX",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "FIRMGOVSS",
    "UsesVariable": "INDIRECTTAX",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "FIRMGOVSS",
    "UsesVariable": "FIRMEARN",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "FIRMGOVSS",
    "UsesVariable": "govrevtrgtval",
    "Distance": 3,
    "Code": "\r\r'        TAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOT(R%))\rPreTAXRA = AMAX(1, PreGOVREV / AMAX(0.0001, GDPPOTRPA(R%)) * 100)\r\r\r'        TAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOT(R%))\rPreTAXRA = AMAX(1, PreGOVREV / AMAX(0.0001, GDPPOTRPA(R%)) * 100)\rCOMPLETE STRUCTURE:End If:6255|\r'If IY% = 2 Then PreTAXRAi(R%) = PreTAXRA\r\rIf govrevtrgtyr > 1 AndAlso govrevtrgtval(R%) > 1 AndAlso PreTAXRA < govrevtrgtval(R%) Then\rTaxTar = PreTAXRA + (govrevtrgtval(R%) - PreTAXRA) / govrevtrgtyr * Amin(IY%, govrevtrgtyr)\rCOMPLETE STRUCTURE:End If:6255|\r'If RegName$(R%) = \"Chad\" And IY% >= 15 Then Stop\rIf PreTAXRA < TaxTar Then\rTaxTarMul = TaxTar / PreTAXRA\r\rFIRMGOVSS(R%) = FIRMGOVSS(R%) * TaxTarMul\r"
  },
  {
    "Variable": "FIRMGOVSS",
    "UsesVariable": "govrevtrgtyr",
    "Distance": 3,
    "Code": "\r\r'        TAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOT(R%))\rPreTAXRA = AMAX(1, PreGOVREV / AMAX(0.0001, GDPPOTRPA(R%)) * 100)\r"
  },
  {
    "Variable": "FIRMGOVSS",
    "UsesVariable": "HHTAX",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "FIRMGOVSS",
    "UsesVariable": "VADD",
    "Distance": 525,
    "Code": "0"
  },
  {
    "Variable": "FIRMGOVSS",
    "UsesVariable": "WP",
    "Distance": 525,
    "Code": "0"
  },
  {
    "Variable": "FIRMGOVSS",
    "UsesVariable": "HHGOVSS",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "FIRMGOVSS",
    "UsesVariable": "SSWELTAXR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "FIRMGOVSS",
    "UsesVariable": "ssweltaxrm",
    "Distance": 0,
    "Code": "\r\r'FIRMTAX(R%) = FIRMINC(R%) * FIRMTAXR(R%) / 100 * mulrev(R%)  'bbh 2015/03/26\r' FIRMTAX(R%) = FIRMINC(R%) * FIRMTAXR(R%) / 100 * firmtaxrm(R%) * mulrev(R%)\r'bbh 2021/05/15 FIRMGOVSS(R%) = SSWELTAXR(R%) / 100 * FIRMINC(R%) * ssweltaxrm(R%) _\r'* govrevm(R%) * mulrev(R%)\rFIRMGOVSS(R%) = SSWELTAXR(R%) / 100 * FIRMEARN(R%) * ssweltaxrm(R%) _\r            * govrevm(R%) * mulrev(R%)\r"
  },
  {
    "Variable": "FIRMGOVSS",
    "UsesVariable": "govrevm",
    "Distance": 0,
    "Code": "\r\r'FIRMTAX(R%) = FIRMINC(R%) * FIRMTAXR(R%) / 100 * mulrev(R%)  'bbh 2015/03/26\r' FIRMTAX(R%) = FIRMINC(R%) * FIRMTAXR(R%) / 100 * firmtaxrm(R%) * mulrev(R%)\r'bbh 2021/05/15 FIRMGOVSS(R%) = SSWELTAXR(R%) / 100 * FIRMINC(R%) * ssweltaxrm(R%) _\r'* govrevm(R%) * mulrev(R%)\rFIRMGOVSS(R%) = SSWELTAXR(R%) / 100 * FIRMEARN(R%) * ssweltaxrm(R%) _\r            * govrevm(R%) * mulrev(R%)\r"
  },
  {
    "Variable": "FIRMINCDIS",
    "UsesVariable": "FIRMEARN",
    "Distance": 0,
    "Code": "\r\rPrivate Sub ComputeDispInc(R%, ShrUnskilledPop As Single)\r'mti 2019/03/08 - take whole procedure\r'mti 2016/10/20 - New Procedure\r\r'Disposable Income: Household and Firm\r'--------------------------------------\r'\r'        'I have rewritten the code for adding transfers and dividents below, it's not needed, but it improves code clarity (we'll go one way or other later)\r'        'transfers and dividends added up above; now subtracting taxes, to get the disposable households income\r'If RegName(R%) = \"United States of America\" Then Stop\r'If IY = 2 Then Stop\r\r'Dim ShrUnskilledPop As Single\r'bbh 2021/06/01 start\rHHINCDIS(R%, Unskilled) = HHINCEARN(R%, Unskilled) _\r            + GOVHHTRNPEN(R%, Unskilled) + GOVHHTRNWEL(R%, Unskilled) + HHDIVINT(R%, Unskilled) _\r            - HHTAX(R%, Unskilled) - HHGOVSS(R%, Unskilled) _\r            - INDIRECTTAX(R%) * (HHINCEARN(R%, Unskilled) / (FIRMEARN(R%) + HHINCEARN(R%, Unskilled) + HHINCEARN(R%, Skilled)))\r\rHHINCDIS(R%, Skilled) = HHINCEARN(R%, Skilled) _\r            + GOVHHTRNPEN(R%, Skilled) + GOVHHTRNWEL(R%, Skilled) + HHDIVINT(R%, Skilled) _\r            - HHTAX(R%, Skilled) - HHGOVSS(R%, Skilled) _\r            - INDIRECTTAX(R%) * (HHINCEARN(R%, Skilled) / (FIRMEARN(R%) + HHINCEARN(R%, Unskilled) + HHINCEARN(R%, Skilled)))\r'bbh 2021/06/01 end\r\r'If GRPS(1, R) = \"Sudan South\" Then Stop\r\r'bbh 2020/07/02 start\r'        If XWORKREMIT(R%) > 0 Then\r'            HHINCDIS(R%, Unskilled) = HHINCDIS(R%, Unskilled) + XWORKREMIT(R%) * ShrUnskilledPop\r'            HHINCDIS(R%, Skilled) = HHINCDIS(R%, Skilled) + XWORKREMIT(R%) * (1 - ShrUnskilledPop)\r'bbh 2022/12/13 Replaced 2 lines below to remove AMAX logic that was failing to reduce HHINCDIS in Oman (and others) by outward remittance flow\r'        HHINCDIS(R%, Unskilled) = AMAX(0.8 * HHINCDIS(R%, Unskilled), HHINCDIS(R%, Unskilled) + XWORKREMIT(R%) * ShrUnskilledPop)\r'        HHINCDIS(R%, Skilled) = AMAX(0.8 * HHINCDIS(R%, Skilled), HHINCDIS(R%, Skilled) + XWORKREMIT(R%) * (1 - ShrUnskilledPop))\rHHINCDIS(R%, Unskilled) = HHINCDIS(R%, Unskilled) + XWORKREMIT(R%) * ShrUnskilledPop\rHHINCDIS(R%, Skilled) = HHINCDIS(R%, Skilled) + XWORKREMIT(R%) * (1 - ShrUnskilledPop)\r'if RegName(R%) = \"Oman\" Then Stop\r'        End If\r'bbh 2020/07/02 end\r'mti 2019/03/08 End\r\r\r\r\r'        HHINCDISPC(R%, Unskilled) = HHINCDIS(R%, Unskilled) / HHPOP(R%, Unskilled)\r'        HHINCDISPC(R%, Skilled) = HHINCDIS(R%, Skilled) / HHPOP(R%, Skilled)\r\r\r'bbh 2021/06/01\rFIRMINCDIS(R%) = FIRMEARN(R%) - FIRMTAX(R%) - FIRMGOVSS(R%) - HHDIVINT(R%, Unskilled) - HHDIVINT(R%, Skilled) _\r            - INDIRECTTAX(R%) * (FIRMEARN(R%) / (FIRMEARN(R%) + HHINCEARN(R%, Unskilled) + HHINCEARN(R%, Skilled)))\r\r'jrs 2024/01/29 removing HHINC\r''bbh 2021/05/15  Keep these new two lines until have totally removed HHINC; difficulty is that some other\r''   IFs areas, including malnutrtion in pop, use HHINC; so may be too much to remove\r'HHINC(R%, Unskilled) = HHINCDIS(R%, Unskilled)\r'HHINC(R%, Skilled) = HHINCDIS(R%, Skilled)\r\rEnd Sub\r"
  },
  {
    "Variable": "FIRMINCDIS",
    "UsesVariable": "FIRMTAX",
    "Distance": 0,
    "Code": "\r\rPrivate Sub ComputeDispInc(R%, ShrUnskilledPop As Single)\r'mti 2019/03/08 - take whole procedure\r'mti 2016/10/20 - New Procedure\r\r'Disposable Income: Household and Firm\r'--------------------------------------\r'\r'        'I have rewritten the code for adding transfers and dividents below, it's not needed, but it improves code clarity (we'll go one way or other later)\r'        'transfers and dividends added up above; now subtracting taxes, to get the disposable households income\r'If RegName(R%) = \"United States of America\" Then Stop\r'If IY = 2 Then Stop\r\r'Dim ShrUnskilledPop As Single\r'bbh 2021/06/01 start\rHHINCDIS(R%, Unskilled) = HHINCEARN(R%, Unskilled) _\r            + GOVHHTRNPEN(R%, Unskilled) + GOVHHTRNWEL(R%, Unskilled) + HHDIVINT(R%, Unskilled) _\r            - HHTAX(R%, Unskilled) - HHGOVSS(R%, Unskilled) _\r            - INDIRECTTAX(R%) * (HHINCEARN(R%, Unskilled) / (FIRMEARN(R%) + HHINCEARN(R%, Unskilled) + HHINCEARN(R%, Skilled)))\r\rHHINCDIS(R%, Skilled) = HHINCEARN(R%, Skilled) _\r            + GOVHHTRNPEN(R%, Skilled) + GOVHHTRNWEL(R%, Skilled) + HHDIVINT(R%, Skilled) _\r            - HHTAX(R%, Skilled) - HHGOVSS(R%, Skilled) _\r            - INDIRECTTAX(R%) * (HHINCEARN(R%, Skilled) / (FIRMEARN(R%) + HHINCEARN(R%, Unskilled) + HHINCEARN(R%, Skilled)))\r'bbh 2021/06/01 end\r\r'If GRPS(1, R) = \"Sudan South\" Then Stop\r\r'bbh 2020/07/02 start\r'        If XWORKREMIT(R%) > 0 Then\r'            HHINCDIS(R%, Unskilled) = HHINCDIS(R%, Unskilled) + XWORKREMIT(R%) * ShrUnskilledPop\r'            HHINCDIS(R%, Skilled) = HHINCDIS(R%, Skilled) + XWORKREMIT(R%) * (1 - ShrUnskilledPop)\r'bbh 2022/12/13 Replaced 2 lines below to remove AMAX logic that was failing to reduce HHINCDIS in Oman (and others) by outward remittance flow\r'        HHINCDIS(R%, Unskilled) = AMAX(0.8 * HHINCDIS(R%, Unskilled), HHINCDIS(R%, Unskilled) + XWORKREMIT(R%) * ShrUnskilledPop)\r'        HHINCDIS(R%, Skilled) = AMAX(0.8 * HHINCDIS(R%, Skilled), HHINCDIS(R%, Skilled) + XWORKREMIT(R%) * (1 - ShrUnskilledPop))\rHHINCDIS(R%, Unskilled) = HHINCDIS(R%, Unskilled) + XWORKREMIT(R%) * ShrUnskilledPop\rHHINCDIS(R%, Skilled) = HHINCDIS(R%, Skilled) + XWORKREMIT(R%) * (1 - ShrUnskilledPop)\r'if RegName(R%) = \"Oman\" Then Stop\r'        End If\r'bbh 2020/07/02 end\r'mti 2019/03/08 End\r\r\r\r\r'        HHINCDISPC(R%, Unskilled) = HHINCDIS(R%, Unskilled) / HHPOP(R%, Unskilled)\r'        HHINCDISPC(R%, Skilled) = HHINCDIS(R%, Skilled) / HHPOP(R%, Skilled)\r\r\r'bbh 2021/06/01\rFIRMINCDIS(R%) = FIRMEARN(R%) - FIRMTAX(R%) - FIRMGOVSS(R%) - HHDIVINT(R%, Unskilled) - HHDIVINT(R%, Skilled) _\r            - INDIRECTTAX(R%) * (FIRMEARN(R%) / (FIRMEARN(R%) + HHINCEARN(R%, Unskilled) + HHINCEARN(R%, Skilled)))\r\r'jrs 2024/01/29 removing HHINC\r''bbh 2021/05/15  Keep these new two lines until have totally removed HHINC; difficulty is that some other\r''   IFs areas, including malnutrtion in pop, use HHINC; so may be too much to remove\r'HHINC(R%, Unskilled) = HHINCDIS(R%, Unskilled)\r'HHINC(R%, Skilled) = HHINCDIS(R%, Skilled)\r\rEnd Sub\r"
  },
  {
    "Variable": "FIRMINCDIS",
    "UsesVariable": "FIRMGOVSS",
    "Distance": 0,
    "Code": "\r\rPrivate Sub ComputeDispInc(R%, ShrUnskilledPop As Single)\r'mti 2019/03/08 - take whole procedure\r'mti 2016/10/20 - New Procedure\r\r'Disposable Income: Household and Firm\r'--------------------------------------\r'\r'        'I have rewritten the code for adding transfers and dividents below, it's not needed, but it improves code clarity (we'll go one way or other later)\r'        'transfers and dividends added up above; now subtracting taxes, to get the disposable households income\r'If RegName(R%) = \"United States of America\" Then Stop\r'If IY = 2 Then Stop\r\r'Dim ShrUnskilledPop As Single\r'bbh 2021/06/01 start\rHHINCDIS(R%, Unskilled) = HHINCEARN(R%, Unskilled) _\r            + GOVHHTRNPEN(R%, Unskilled) + GOVHHTRNWEL(R%, Unskilled) + HHDIVINT(R%, Unskilled) _\r            - HHTAX(R%, Unskilled) - HHGOVSS(R%, Unskilled) _\r            - INDIRECTTAX(R%) * (HHINCEARN(R%, Unskilled) / (FIRMEARN(R%) + HHINCEARN(R%, Unskilled) + HHINCEARN(R%, Skilled)))\r\rHHINCDIS(R%, Skilled) = HHINCEARN(R%, Skilled) _\r            + GOVHHTRNPEN(R%, Skilled) + GOVHHTRNWEL(R%, Skilled) + HHDIVINT(R%, Skilled) _\r            - HHTAX(R%, Skilled) - HHGOVSS(R%, Skilled) _\r            - INDIRECTTAX(R%) * (HHINCEARN(R%, Skilled) / (FIRMEARN(R%) + HHINCEARN(R%, Unskilled) + HHINCEARN(R%, Skilled)))\r'bbh 2021/06/01 end\r\r'If GRPS(1, R) = \"Sudan South\" Then Stop\r\r'bbh 2020/07/02 start\r'        If XWORKREMIT(R%) > 0 Then\r'            HHINCDIS(R%, Unskilled) = HHINCDIS(R%, Unskilled) + XWORKREMIT(R%) * ShrUnskilledPop\r'            HHINCDIS(R%, Skilled) = HHINCDIS(R%, Skilled) + XWORKREMIT(R%) * (1 - ShrUnskilledPop)\r'bbh 2022/12/13 Replaced 2 lines below to remove AMAX logic that was failing to reduce HHINCDIS in Oman (and others) by outward remittance flow\r'        HHINCDIS(R%, Unskilled) = AMAX(0.8 * HHINCDIS(R%, Unskilled), HHINCDIS(R%, Unskilled) + XWORKREMIT(R%) * ShrUnskilledPop)\r'        HHINCDIS(R%, Skilled) = AMAX(0.8 * HHINCDIS(R%, Skilled), HHINCDIS(R%, Skilled) + XWORKREMIT(R%) * (1 - ShrUnskilledPop))\rHHINCDIS(R%, Unskilled) = HHINCDIS(R%, Unskilled) + XWORKREMIT(R%) * ShrUnskilledPop\rHHINCDIS(R%, Skilled) = HHINCDIS(R%, Skilled) + XWORKREMIT(R%) * (1 - ShrUnskilledPop)\r'if RegName(R%) = \"Oman\" Then Stop\r'        End If\r'bbh 2020/07/02 end\r'mti 2019/03/08 End\r\r\r\r\r'        HHINCDISPC(R%, Unskilled) = HHINCDIS(R%, Unskilled) / HHPOP(R%, Unskilled)\r'        HHINCDISPC(R%, Skilled) = HHINCDIS(R%, Skilled) / HHPOP(R%, Skilled)\r\r\r'bbh 2021/06/01\rFIRMINCDIS(R%) = FIRMEARN(R%) - FIRMTAX(R%) - FIRMGOVSS(R%) - HHDIVINT(R%, Unskilled) - HHDIVINT(R%, Skilled) _\r            - INDIRECTTAX(R%) * (FIRMEARN(R%) / (FIRMEARN(R%) + HHINCEARN(R%, Unskilled) + HHINCEARN(R%, Skilled)))\r\r'jrs 2024/01/29 removing HHINC\r''bbh 2021/05/15  Keep these new two lines until have totally removed HHINC; difficulty is that some other\r''   IFs areas, including malnutrtion in pop, use HHINC; so may be too much to remove\r'HHINC(R%, Unskilled) = HHINCDIS(R%, Unskilled)\r'HHINC(R%, Skilled) = HHINCDIS(R%, Skilled)\r\rEnd Sub\r"
  },
  {
    "Variable": "FIRMINCDIS",
    "UsesVariable": "HHDIVINT",
    "Distance": 0,
    "Code": "\r\rPrivate Sub ComputeDispInc(R%, ShrUnskilledPop As Single)\r'mti 2019/03/08 - take whole procedure\r'mti 2016/10/20 - New Procedure\r\r'Disposable Income: Household and Firm\r'--------------------------------------\r'\r'        'I have rewritten the code for adding transfers and dividents below, it's not needed, but it improves code clarity (we'll go one way or other later)\r'        'transfers and dividends added up above; now subtracting taxes, to get the disposable households income\r'If RegName(R%) = \"United States of America\" Then Stop\r'If IY = 2 Then Stop\r\r'Dim ShrUnskilledPop As Single\r'bbh 2021/06/01 start\rHHINCDIS(R%, Unskilled) = HHINCEARN(R%, Unskilled) _\r            + GOVHHTRNPEN(R%, Unskilled) + GOVHHTRNWEL(R%, Unskilled) + HHDIVINT(R%, Unskilled) _\r            - HHTAX(R%, Unskilled) - HHGOVSS(R%, Unskilled) _\r            - INDIRECTTAX(R%) * (HHINCEARN(R%, Unskilled) / (FIRMEARN(R%) + HHINCEARN(R%, Unskilled) + HHINCEARN(R%, Skilled)))\r\rHHINCDIS(R%, Skilled) = HHINCEARN(R%, Skilled) _\r            + GOVHHTRNPEN(R%, Skilled) + GOVHHTRNWEL(R%, Skilled) + HHDIVINT(R%, Skilled) _\r            - HHTAX(R%, Skilled) - HHGOVSS(R%, Skilled) _\r            - INDIRECTTAX(R%) * (HHINCEARN(R%, Skilled) / (FIRMEARN(R%) + HHINCEARN(R%, Unskilled) + HHINCEARN(R%, Skilled)))\r'bbh 2021/06/01 end\r\r'If GRPS(1, R) = \"Sudan South\" Then Stop\r\r'bbh 2020/07/02 start\r'        If XWORKREMIT(R%) > 0 Then\r'            HHINCDIS(R%, Unskilled) = HHINCDIS(R%, Unskilled) + XWORKREMIT(R%) * ShrUnskilledPop\r'            HHINCDIS(R%, Skilled) = HHINCDIS(R%, Skilled) + XWORKREMIT(R%) * (1 - ShrUnskilledPop)\r'bbh 2022/12/13 Replaced 2 lines below to remove AMAX logic that was failing to reduce HHINCDIS in Oman (and others) by outward remittance flow\r'        HHINCDIS(R%, Unskilled) = AMAX(0.8 * HHINCDIS(R%, Unskilled), HHINCDIS(R%, Unskilled) + XWORKREMIT(R%) * ShrUnskilledPop)\r'        HHINCDIS(R%, Skilled) = AMAX(0.8 * HHINCDIS(R%, Skilled), HHINCDIS(R%, Skilled) + XWORKREMIT(R%) * (1 - ShrUnskilledPop))\rHHINCDIS(R%, Unskilled) = HHINCDIS(R%, Unskilled) + XWORKREMIT(R%) * ShrUnskilledPop\rHHINCDIS(R%, Skilled) = HHINCDIS(R%, Skilled) + XWORKREMIT(R%) * (1 - ShrUnskilledPop)\r'if RegName(R%) = \"Oman\" Then Stop\r'        End If\r'bbh 2020/07/02 end\r'mti 2019/03/08 End\r\r\r\r\r'        HHINCDISPC(R%, Unskilled) = HHINCDIS(R%, Unskilled) / HHPOP(R%, Unskilled)\r'        HHINCDISPC(R%, Skilled) = HHINCDIS(R%, Skilled) / HHPOP(R%, Skilled)\r\r\r'bbh 2021/06/01\rFIRMINCDIS(R%) = FIRMEARN(R%) - FIRMTAX(R%) - FIRMGOVSS(R%) - HHDIVINT(R%, Unskilled) - HHDIVINT(R%, Skilled) _\r            - INDIRECTTAX(R%) * (FIRMEARN(R%) / (FIRMEARN(R%) + HHINCEARN(R%, Unskilled) + HHINCEARN(R%, Skilled)))\r\r'jrs 2024/01/29 removing HHINC\r''bbh 2021/05/15  Keep these new two lines until have totally removed HHINC; difficulty is that some other\r''   IFs areas, including malnutrtion in pop, use HHINC; so may be too much to remove\r'HHINC(R%, Unskilled) = HHINCDIS(R%, Unskilled)\r'HHINC(R%, Skilled) = HHINCDIS(R%, Skilled)\r\rEnd Sub\r"
  },
  {
    "Variable": "FIRMINCDIS",
    "UsesVariable": "INDIRECTTAX",
    "Distance": 0,
    "Code": "\r\rPrivate Sub ComputeDispInc(R%, ShrUnskilledPop As Single)\r'mti 2019/03/08 - take whole procedure\r'mti 2016/10/20 - New Procedure\r\r'Disposable Income: Household and Firm\r'--------------------------------------\r'\r'        'I have rewritten the code for adding transfers and dividents below, it's not needed, but it improves code clarity (we'll go one way or other later)\r'        'transfers and dividends added up above; now subtracting taxes, to get the disposable households income\r'If RegName(R%) = \"United States of America\" Then Stop\r'If IY = 2 Then Stop\r\r'Dim ShrUnskilledPop As Single\r'bbh 2021/06/01 start\rHHINCDIS(R%, Unskilled) = HHINCEARN(R%, Unskilled) _\r            + GOVHHTRNPEN(R%, Unskilled) + GOVHHTRNWEL(R%, Unskilled) + HHDIVINT(R%, Unskilled) _\r            - HHTAX(R%, Unskilled) - HHGOVSS(R%, Unskilled) _\r            - INDIRECTTAX(R%) * (HHINCEARN(R%, Unskilled) / (FIRMEARN(R%) + HHINCEARN(R%, Unskilled) + HHINCEARN(R%, Skilled)))\r\rHHINCDIS(R%, Skilled) = HHINCEARN(R%, Skilled) _\r            + GOVHHTRNPEN(R%, Skilled) + GOVHHTRNWEL(R%, Skilled) + HHDIVINT(R%, Skilled) _\r            - HHTAX(R%, Skilled) - HHGOVSS(R%, Skilled) _\r            - INDIRECTTAX(R%) * (HHINCEARN(R%, Skilled) / (FIRMEARN(R%) + HHINCEARN(R%, Unskilled) + HHINCEARN(R%, Skilled)))\r'bbh 2021/06/01 end\r\r'If GRPS(1, R) = \"Sudan South\" Then Stop\r\r'bbh 2020/07/02 start\r'        If XWORKREMIT(R%) > 0 Then\r'            HHINCDIS(R%, Unskilled) = HHINCDIS(R%, Unskilled) + XWORKREMIT(R%) * ShrUnskilledPop\r'            HHINCDIS(R%, Skilled) = HHINCDIS(R%, Skilled) + XWORKREMIT(R%) * (1 - ShrUnskilledPop)\r'bbh 2022/12/13 Replaced 2 lines below to remove AMAX logic that was failing to reduce HHINCDIS in Oman (and others) by outward remittance flow\r'        HHINCDIS(R%, Unskilled) = AMAX(0.8 * HHINCDIS(R%, Unskilled), HHINCDIS(R%, Unskilled) + XWORKREMIT(R%) * ShrUnskilledPop)\r'        HHINCDIS(R%, Skilled) = AMAX(0.8 * HHINCDIS(R%, Skilled), HHINCDIS(R%, Skilled) + XWORKREMIT(R%) * (1 - ShrUnskilledPop))\rHHINCDIS(R%, Unskilled) = HHINCDIS(R%, Unskilled) + XWORKREMIT(R%) * ShrUnskilledPop\rHHINCDIS(R%, Skilled) = HHINCDIS(R%, Skilled) + XWORKREMIT(R%) * (1 - ShrUnskilledPop)\r'if RegName(R%) = \"Oman\" Then Stop\r'        End If\r'bbh 2020/07/02 end\r'mti 2019/03/08 End\r\r\r\r\r'        HHINCDISPC(R%, Unskilled) = HHINCDIS(R%, Unskilled) / HHPOP(R%, Unskilled)\r'        HHINCDISPC(R%, Skilled) = HHINCDIS(R%, Skilled) / HHPOP(R%, Skilled)\r\r\r'bbh 2021/06/01\rFIRMINCDIS(R%) = FIRMEARN(R%) - FIRMTAX(R%) - FIRMGOVSS(R%) - HHDIVINT(R%, Unskilled) - HHDIVINT(R%, Skilled) _\r            - INDIRECTTAX(R%) * (FIRMEARN(R%) / (FIRMEARN(R%) + HHINCEARN(R%, Unskilled) + HHINCEARN(R%, Skilled)))\r\r'jrs 2024/01/29 removing HHINC\r''bbh 2021/05/15  Keep these new two lines until have totally removed HHINC; difficulty is that some other\r''   IFs areas, including malnutrtion in pop, use HHINC; so may be too much to remove\r'HHINC(R%, Unskilled) = HHINCDIS(R%, Unskilled)\r'HHINC(R%, Skilled) = HHINCDIS(R%, Skilled)\r\rEnd Sub\r"
  },
  {
    "Variable": "FIRMINCDIS",
    "UsesVariable": "HHINCEARN",
    "Distance": 0,
    "Code": "\r\rPrivate Sub ComputeDispInc(R%, ShrUnskilledPop As Single)\r'mti 2019/03/08 - take whole procedure\r'mti 2016/10/20 - New Procedure\r\r'Disposable Income: Household and Firm\r'--------------------------------------\r'\r'        'I have rewritten the code for adding transfers and dividents below, it's not needed, but it improves code clarity (we'll go one way or other later)\r'        'transfers and dividends added up above; now subtracting taxes, to get the disposable households income\r'If RegName(R%) = \"United States of America\" Then Stop\r'If IY = 2 Then Stop\r\r'Dim ShrUnskilledPop As Single\r'bbh 2021/06/01 start\rHHINCDIS(R%, Unskilled) = HHINCEARN(R%, Unskilled) _\r            + GOVHHTRNPEN(R%, Unskilled) + GOVHHTRNWEL(R%, Unskilled) + HHDIVINT(R%, Unskilled) _\r            - HHTAX(R%, Unskilled) - HHGOVSS(R%, Unskilled) _\r            - INDIRECTTAX(R%) * (HHINCEARN(R%, Unskilled) / (FIRMEARN(R%) + HHINCEARN(R%, Unskilled) + HHINCEARN(R%, Skilled)))\r\rHHINCDIS(R%, Skilled) = HHINCEARN(R%, Skilled) _\r            + GOVHHTRNPEN(R%, Skilled) + GOVHHTRNWEL(R%, Skilled) + HHDIVINT(R%, Skilled) _\r            - HHTAX(R%, Skilled) - HHGOVSS(R%, Skilled) _\r            - INDIRECTTAX(R%) * (HHINCEARN(R%, Skilled) / (FIRMEARN(R%) + HHINCEARN(R%, Unskilled) + HHINCEARN(R%, Skilled)))\r'bbh 2021/06/01 end\r\r'If GRPS(1, R) = \"Sudan South\" Then Stop\r\r'bbh 2020/07/02 start\r'        If XWORKREMIT(R%) > 0 Then\r'            HHINCDIS(R%, Unskilled) = HHINCDIS(R%, Unskilled) + XWORKREMIT(R%) * ShrUnskilledPop\r'            HHINCDIS(R%, Skilled) = HHINCDIS(R%, Skilled) + XWORKREMIT(R%) * (1 - ShrUnskilledPop)\r'bbh 2022/12/13 Replaced 2 lines below to remove AMAX logic that was failing to reduce HHINCDIS in Oman (and others) by outward remittance flow\r'        HHINCDIS(R%, Unskilled) = AMAX(0.8 * HHINCDIS(R%, Unskilled), HHINCDIS(R%, Unskilled) + XWORKREMIT(R%) * ShrUnskilledPop)\r'        HHINCDIS(R%, Skilled) = AMAX(0.8 * HHINCDIS(R%, Skilled), HHINCDIS(R%, Skilled) + XWORKREMIT(R%) * (1 - ShrUnskilledPop))\rHHINCDIS(R%, Unskilled) = HHINCDIS(R%, Unskilled) + XWORKREMIT(R%) * ShrUnskilledPop\rHHINCDIS(R%, Skilled) = HHINCDIS(R%, Skilled) + XWORKREMIT(R%) * (1 - ShrUnskilledPop)\r'if RegName(R%) = \"Oman\" Then Stop\r'        End If\r'bbh 2020/07/02 end\r'mti 2019/03/08 End\r\r\r\r\r'        HHINCDISPC(R%, Unskilled) = HHINCDIS(R%, Unskilled) / HHPOP(R%, Unskilled)\r'        HHINCDISPC(R%, Skilled) = HHINCDIS(R%, Skilled) / HHPOP(R%, Skilled)\r\r\r'bbh 2021/06/01\rFIRMINCDIS(R%) = FIRMEARN(R%) - FIRMTAX(R%) - FIRMGOVSS(R%) - HHDIVINT(R%, Unskilled) - HHDIVINT(R%, Skilled) _\r            - INDIRECTTAX(R%) * (FIRMEARN(R%) / (FIRMEARN(R%) + HHINCEARN(R%, Unskilled) + HHINCEARN(R%, Skilled)))\r\r'jrs 2024/01/29 removing HHINC\r''bbh 2021/05/15  Keep these new two lines until have totally removed HHINC; difficulty is that some other\r''   IFs areas, including malnutrtion in pop, use HHINC; so may be too much to remove\r'HHINC(R%, Unskilled) = HHINCDIS(R%, Unskilled)\r'HHINC(R%, Skilled) = HHINCDIS(R%, Skilled)\r\rEnd Sub\r"
  },
  {
    "Variable": "FIRMSAV",
    "UsesVariable": "FIRMINCDIS",
    "Distance": 0,
    "Code": "\r'Cannot sum with R%, Total, must use R%, NSkill%\r'bbh 2020/07/01 end\r\r'bbh 2020/07/01 start\r'        rpaadj = GDPRPA(R%) - GDP(R%)\r'        FIRMSAV(R%) = FIRMINC(R%) - FIRMTAX(R%) - INDIRECTTAX(R%) _\r'            - HHDIVINT(R%, Unskilled) - HHDIVINT(R%, Skilled) - FIRMGOVSS(R%) _\r'            - XFDIFOUT(R%) - XPORTFOUT(R%) + XFDIFIN(R%) + XPORTFIN(R%) _\r'            - XWBSUBF(R%) - rpaadj\r'            'FDI and Portfolio inflows are put earlier into firm income\r'            'GDPRPA-GDP flows into firms after households removed; need to remove,\r'            '   to revert to non-RPA FORSAV, SAVINGS\r'\r'        If XWORKREMIT(R%) < 0 Then FIRMSAV(R%) = FIRMSAV(R%) + XWORKREMIT(R%)\r'        firmsavadj = XFDIFIN(R%) - XFDIFOUT(R%) + XPORTFIN(R%) - XPORTFOUT(R%) _\r'            - XWBSUBF(R%) + XWORKREMIT(R%)  'XWORKREMIT household term?\r'        govbaladj = XWBLNFIN(R%) - XWBLNFOUT(R%) + XIMFCRFIN(R%) - XIMFCRFOUT(R%)\r'\r'        'Capital Account = - Current Account\r'        'Capital Account = FDI, portfolio, IMF, WB, other flows in - flows out +\r'        '       Balancing Debt/Reserve Change Term\r'        '   = Basic Capital Account + Balancing Debt/Reserve Change Term\r'        'Therefore Net Foreign savings (balancing term) = -Basic Capital Account - Curact\r'        FORSAV(R%) = -firmsavadj - govbaladj - (X(R%) - M(R%) + AID(R%))\r'        SAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'            FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%) 'Should equal I(nvestment),\r'                'which is not price adjusted\r'        SavingsR(R%) = SAVINGS(R%) / GDPPOTRPA(R%)\r'\r'        SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'            FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r\r\r' Current account includes X-M, foreign aid, net remittances, WB and IMF flows\r' Capital account includes net FDI and portfolio investment (delta assets offsetting current account balance)\r'     and the change of other assets such as govt purchases/sales of bonds, foreign currency abroad\r\r'FIRMSAV(R%) = FIRMINC(R%) - FIRMTAX(R%) - INDIRECTTAX(R%) _\r'    - HHDIVINT(R%, Unskilled) - HHDIVINT(R%, Skilled) - FIRMGOVSS(R%) _\r'    - XFDIFOUT(R%) - XPORTFOUT(R%) + XFDIFIN(R%) + XPORTFIN(R%) _\r'    - XWBSUBF(R%)\r'bbh 2021/06/01 FIRMSAV is all of FIRMINCDIS\r'FIRMSAV(R%) = FIRMINCDIS(R%) - FIRMTAX(R%) - INDIRECTTAX(R%) _\r'- HHDIVINT(R%, Unskilled) - HHDIVINT(R%, Skilled) - FIRMGOVSS(R%) 'bbh 2021/05/15\rFIRMSAV(R%) = FIRMINCDIS(R%)\r"
  },
  {
    "Variable": "FIRMTAX",
    "UsesVariable": "FIRMGOVSS",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "FIRMTAX",
    "UsesVariable": "INDIRECTTAX",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "FIRMTAX",
    "UsesVariable": "FIRMEARN",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "FIRMTAX",
    "UsesVariable": "govrevtrgtval",
    "Distance": 2,
    "Code": "\r\r'        TAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOT(R%))\rPreTAXRA = AMAX(1, PreGOVREV / AMAX(0.0001, GDPPOTRPA(R%)) * 100)\r\r\r'        TAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOT(R%))\rPreTAXRA = AMAX(1, PreGOVREV / AMAX(0.0001, GDPPOTRPA(R%)) * 100)\rCOMPLETE STRUCTURE:End If:6255|\r'If IY% = 2 Then PreTAXRAi(R%) = PreTAXRA\r\rIf govrevtrgtyr > 1 AndAlso govrevtrgtval(R%) > 1 AndAlso PreTAXRA < govrevtrgtval(R%) Then\rTaxTar = PreTAXRA + (govrevtrgtval(R%) - PreTAXRA) / govrevtrgtyr * Amin(IY%, govrevtrgtyr)\rCOMPLETE STRUCTURE:End If:6255|\r'If RegName$(R%) = \"Chad\" And IY% >= 15 Then Stop\rIf PreTAXRA < TaxTar Then\rTaxTarMul = TaxTar / PreTAXRA\r\rFIRMTAX(R%) = FIRMTAX(R%) * TaxTarMul\r"
  },
  {
    "Variable": "FIRMTAX",
    "UsesVariable": "govrevtrgtyr",
    "Distance": 2,
    "Code": "\r\r'        TAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOT(R%))\rPreTAXRA = AMAX(1, PreGOVREV / AMAX(0.0001, GDPPOTRPA(R%)) * 100)\r"
  },
  {
    "Variable": "FIRMTAX",
    "UsesVariable": "HHTAX",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "FIRMTAX",
    "UsesVariable": "VADD",
    "Distance": 524,
    "Code": "0"
  },
  {
    "Variable": "FIRMTAX",
    "UsesVariable": "WP",
    "Distance": 524,
    "Code": "0"
  },
  {
    "Variable": "FIRMTAX",
    "UsesVariable": "HHGOVSS",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "FIRMTAX",
    "UsesVariable": "FIRMTAXR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "FIRMTAX",
    "UsesVariable": "govrevm",
    "Distance": 0,
    "Code": "\rmulrev(R%) = 1\r"
  },
  {
    "Variable": "FIRMTAXR",
    "UsesVariable": "GDPPCP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "FIRMTAXR",
    "UsesVariable": "govrevtrgtval",
    "Distance": 10,
    "Code": "\r\r'        TAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOT(R%))\rPreTAXRA = AMAX(1, PreGOVREV / AMAX(0.0001, GDPPOTRPA(R%)) * 100)\r\r\r'        TAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOT(R%))\rPreTAXRA = AMAX(1, PreGOVREV / AMAX(0.0001, GDPPOTRPA(R%)) * 100)\rCOMPLETE STRUCTURE:End If:6255|\r'If IY% = 2 Then PreTAXRAi(R%) = PreTAXRA\r\rIf govrevtrgtyr > 1 AndAlso govrevtrgtval(R%) > 1 AndAlso PreTAXRA < govrevtrgtval(R%) Then\rTaxTar = PreTAXRA + (govrevtrgtval(R%) - PreTAXRA) / govrevtrgtyr * Amin(IY%, govrevtrgtyr)\rCOMPLETE STRUCTURE:End If:6255|\r'If RegName$(R%) = \"Chad\" And IY% >= 15 Then Stop\rIf PreTAXRA < TaxTar Then\rTaxTarMul = TaxTar / PreTAXRA\r\rFIRMTAXR(R%) = FIRMTAXR(R%) * TaxTarMul\r"
  },
  {
    "Variable": "FIRMTAXR",
    "UsesVariable": "govrevtrgtyr",
    "Distance": 10,
    "Code": "\r\r'        TAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOT(R%))\rPreTAXRA = AMAX(1, PreGOVREV / AMAX(0.0001, GDPPOTRPA(R%)) * 100)\r"
  },
  {
    "Variable": "FIRMTAXR",
    "UsesVariable": "HHTAX",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "FIRMTAXR",
    "UsesVariable": "FIRMTAX",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "FIRMTAXR",
    "UsesVariable": "INDIRECTTAX",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "FIRMTAXR",
    "UsesVariable": "VADD",
    "Distance": 532,
    "Code": "0"
  },
  {
    "Variable": "FIRMTAXR",
    "UsesVariable": "WP",
    "Distance": 532,
    "Code": "0"
  },
  {
    "Variable": "FIRMTAXR",
    "UsesVariable": "HHGOVSS",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "FIRMTAXR",
    "UsesVariable": "FIRMGOVSS",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "FIRMTAXR",
    "UsesVariable": "firmtaxrm",
    "Distance": 0,
    "Code": "\r'mti 2015/06/09 - end\r'If RegName$(R%) = \"Peru\" And IY% >= 6 Then Stop\r\r'mti 2016/11/02 Start\rTaxInfAdjustmentFac(R%) = CSng(1 + taxinfadjm(R%) * AMAX(-0.5, Amin(0.5, (ExDefInfGDPi(R%) - ExDefInfGDP))))\r\rFIRMTAXR(R%) = FIRMTAXR(R%) * TaxInfAdjustmentFac(R%) * firmtaxrm(R%)  'bbh 2015/03/26\r"
  },
  {
    "Variable": "FIRMTAXR",
    "UsesVariable": "taxinfadjm",
    "Distance": 2,
    "Code": "\r'mti 2015/06/09 - end\r'If RegName$(R%) = \"Peru\" And IY% >= 6 Then Stop\r\r'mti 2016/11/02 Start\rTaxInfAdjustmentFac(R%) = CSng(1 + taxinfadjm(R%) * AMAX(-0.5, Amin(0.5, (ExDefInfGDPi(R%) - ExDefInfGDP))))\r"
  },
  {
    "Variable": "FIRMTAXR",
    "UsesVariable": "GDPSHADOWSHR",
    "Distance": 1945,
    "Code": "0"
  },
  {
    "Variable": "FIRMTAXR",
    "UsesVariable": "gdpshadowon",
    "Distance": 1945,
    "Code": "0"
  },
  {
    "Variable": "FMDEM",
    "UsesVariable": "AGDEM",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "FMDEM",
    "UsesVariable": "FSTOCK",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "FMDEM",
    "UsesVariable": "AGP",
    "Distance": 31,
    "Code": "0"
  },
  {
    "Variable": "FMDEM",
    "UsesVariable": "AGX",
    "Distance": 30,
    "Code": "\r\r'   First Year:  Profits and Prices\r'   -------------------------------\r\rFor f% = 1 To 3\rFPROFITR(R%, f%) = 1\rsfprofitr(R%, f%) = 1\rSSFProfitR(R%, f%) = 1\rsbalance(R%, f%) = 0\rSBalanceForYl(R%) = 0 'bbh 2022/11/28\rcumstk(R%, f%) = FSTOCK(R%, f%)\rscumstk(R%, f%) = cumstk(R%, f%)\rCumStkNegOK(R%, f%) = FSTOCK(R%, f%) 'bbh 2022/10/27 Added 2 lines allowing Negative Stocks\rSCumStkNegOK(R%, f%) = CumStkNegOK(R%, f%)\rscountryextrasurdef(R%, f%) = 0  'For trade adjustment\rNext f%\r"
  },
  {
    "Variable": "FMDEM",
    "UsesVariable": "AGM",
    "Distance": 30,
    "Code": "\r\r'   First Year:  Profits and Prices\r'   -------------------------------\r\rFor f% = 1 To 3\rFPROFITR(R%, f%) = 1\rsfprofitr(R%, f%) = 1\rSSFProfitR(R%, f%) = 1\rsbalance(R%, f%) = 0\rSBalanceForYl(R%) = 0 'bbh 2022/11/28\rcumstk(R%, f%) = FSTOCK(R%, f%)\rscumstk(R%, f%) = cumstk(R%, f%)\rCumStkNegOK(R%, f%) = FSTOCK(R%, f%) 'bbh 2022/10/27 Added 2 lines allowing Negative Stocks\rSCumStkNegOK(R%, f%) = CumStkNegOK(R%, f%)\rscountryextrasurdef(R%, f%) = 0  'For trade adjustment\rNext f%\r"
  },
  {
    "Variable": "FMDEM",
    "UsesVariable": "FDEM",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "FORSAV",
    "UsesVariable": "MTARIFFREV",
    "Distance": 0,
    "Code": "\r\r'bbh 2021/07/07 start  Moved these here from locations where FORSAV and FORSAVRPA not calculated yet;\r'   Also useful to have all savings logic in one place\r'     All Steps:  Foreign and Total Savings\r'     -------------------------\r\rFor R% = 1 To NR%\r'bbh 2022/09/05 Subtracted XWORKREMIT from FORSAVRPA and FORSAV; had been commented out but should be in computation\rFORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) - XWORKREMIT(R%)   'Price adjusted compatible with XDEBTRPA\r'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'FORSAV(R%) = M(R%) - X(R%) - AID(R%) '- XWORKEMIT(R%)\rFORSAV(R%) = M(R%) - X(R%) - AID(R%) - XWORKREMIT(R%) 'bbh 2022/12/13 remittances belong here, had been changed in 7.91 but change was not commented\rFor S% = 1 To NSec% 'bbh 2022/12/13 For-Next added as also with CURACT logic given SMTariffRev inclusion in GOVREV\rFORSAV(R%) = FORSAV(R%) - SMTariffRev(R%, S%)\rFORSAVRPA(R%) = FORSAVRPA(R%) - SMTariffRev(R%, S%)\rNext S%\rSAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\rSAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'            If RegName$(R%) = \"Ethiopia\" Then Stop\rNext R%\r"
  },
  {
    "Variable": "FORSAV",
    "UsesVariable": "M",
    "Distance": 0,
    "Code": "\r\r'bbh 2021/07/07 start  Moved these here from locations where FORSAV and FORSAVRPA not calculated yet;\r'   Also useful to have all savings logic in one place\r'     All Steps:  Foreign and Total Savings\r'     -------------------------\r\rFor R% = 1 To NR%\r'bbh 2022/09/05 Subtracted XWORKREMIT from FORSAVRPA and FORSAV; had been commented out but should be in computation\rFORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) - XWORKREMIT(R%)   'Price adjusted compatible with XDEBTRPA\r'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'FORSAV(R%) = M(R%) - X(R%) - AID(R%) '- XWORKEMIT(R%)\rFORSAV(R%) = M(R%) - X(R%) - AID(R%) - XWORKREMIT(R%) 'bbh 2022/12/13 remittances belong here, had been changed in 7.91 but change was not commented\rFor S% = 1 To NSec% 'bbh 2022/12/13 For-Next added as also with CURACT logic given SMTariffRev inclusion in GOVREV\rFORSAV(R%) = FORSAV(R%) - SMTariffRev(R%, S%)\rFORSAVRPA(R%) = FORSAVRPA(R%) - SMTariffRev(R%, S%)\rNext S%\rSAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\rSAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'            If RegName$(R%) = \"Ethiopia\" Then Stop\rNext R%\r"
  },
  {
    "Variable": "FORSAV",
    "UsesVariable": "X",
    "Distance": 0,
    "Code": "\r\r'bbh 2021/07/07 start  Moved these here from locations where FORSAV and FORSAVRPA not calculated yet;\r'   Also useful to have all savings logic in one place\r'     All Steps:  Foreign and Total Savings\r'     -------------------------\r\rFor R% = 1 To NR%\r'bbh 2022/09/05 Subtracted XWORKREMIT from FORSAVRPA and FORSAV; had been commented out but should be in computation\rFORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) - XWORKREMIT(R%)   'Price adjusted compatible with XDEBTRPA\r'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'FORSAV(R%) = M(R%) - X(R%) - AID(R%) '- XWORKEMIT(R%)\rFORSAV(R%) = M(R%) - X(R%) - AID(R%) - XWORKREMIT(R%) 'bbh 2022/12/13 remittances belong here, had been changed in 7.91 but change was not commented\rFor S% = 1 To NSec% 'bbh 2022/12/13 For-Next added as also with CURACT logic given SMTariffRev inclusion in GOVREV\rFORSAV(R%) = FORSAV(R%) - SMTariffRev(R%, S%)\rFORSAVRPA(R%) = FORSAVRPA(R%) - SMTariffRev(R%, S%)\rNext S%\rSAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\rSAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'            If RegName$(R%) = \"Ethiopia\" Then Stop\rNext R%\r"
  },
  {
    "Variable": "FORSAV",
    "UsesVariable": "AID",
    "Distance": 0,
    "Code": "\r\r'bbh 2021/07/07 start  Moved these here from locations where FORSAV and FORSAVRPA not calculated yet;\r'   Also useful to have all savings logic in one place\r'     All Steps:  Foreign and Total Savings\r'     -------------------------\r\rFor R% = 1 To NR%\r'bbh 2022/09/05 Subtracted XWORKREMIT from FORSAVRPA and FORSAV; had been commented out but should be in computation\rFORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) - XWORKREMIT(R%)   'Price adjusted compatible with XDEBTRPA\r'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'FORSAV(R%) = M(R%) - X(R%) - AID(R%) '- XWORKEMIT(R%)\rFORSAV(R%) = M(R%) - X(R%) - AID(R%) - XWORKREMIT(R%) 'bbh 2022/12/13 remittances belong here, had been changed in 7.91 but change was not commented\rFor S% = 1 To NSec% 'bbh 2022/12/13 For-Next added as also with CURACT logic given SMTariffRev inclusion in GOVREV\rFORSAV(R%) = FORSAV(R%) - SMTariffRev(R%, S%)\rFORSAVRPA(R%) = FORSAVRPA(R%) - SMTariffRev(R%, S%)\rNext S%\rSAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\rSAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'            If RegName$(R%) = \"Ethiopia\" Then Stop\rNext R%\r"
  },
  {
    "Variable": "FORSAV",
    "UsesVariable": "XWORKREMIT",
    "Distance": 0,
    "Code": "\r\r'bbh 2021/07/07 start  Moved these here from locations where FORSAV and FORSAVRPA not calculated yet;\r'   Also useful to have all savings logic in one place\r'     All Steps:  Foreign and Total Savings\r'     -------------------------\r\rFor R% = 1 To NR%\r'bbh 2022/09/05 Subtracted XWORKREMIT from FORSAVRPA and FORSAV; had been commented out but should be in computation\rFORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) - XWORKREMIT(R%)   'Price adjusted compatible with XDEBTRPA\r'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'FORSAV(R%) = M(R%) - X(R%) - AID(R%) '- XWORKEMIT(R%)\rFORSAV(R%) = M(R%) - X(R%) - AID(R%) - XWORKREMIT(R%) 'bbh 2022/12/13 remittances belong here, had been changed in 7.91 but change was not commented\rFor S% = 1 To NSec% 'bbh 2022/12/13 For-Next added as also with CURACT logic given SMTariffRev inclusion in GOVREV\rFORSAV(R%) = FORSAV(R%) - SMTariffRev(R%, S%)\rFORSAVRPA(R%) = FORSAVRPA(R%) - SMTariffRev(R%, S%)\rNext S%\rSAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\rSAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'            If RegName$(R%) = \"Ethiopia\" Then Stop\rNext R%\r"
  },
  {
    "Variable": "FORSAVRPA",
    "UsesVariable": "MTARIFFREV",
    "Distance": 0,
    "Code": "\r\r'bbh 2021/07/07 start  Moved these here from locations where FORSAV and FORSAVRPA not calculated yet;\r'   Also useful to have all savings logic in one place\r'     All Steps:  Foreign and Total Savings\r'     -------------------------\r\rFor R% = 1 To NR%\r'bbh 2022/09/05 Subtracted XWORKREMIT from FORSAVRPA and FORSAV; had been commented out but should be in computation\rFORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) - XWORKREMIT(R%)   'Price adjusted compatible with XDEBTRPA\r'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'FORSAV(R%) = M(R%) - X(R%) - AID(R%) '- XWORKEMIT(R%)\rFORSAV(R%) = M(R%) - X(R%) - AID(R%) - XWORKREMIT(R%) 'bbh 2022/12/13 remittances belong here, had been changed in 7.91 but change was not commented\rFor S% = 1 To NSec% 'bbh 2022/12/13 For-Next added as also with CURACT logic given SMTariffRev inclusion in GOVREV\rFORSAV(R%) = FORSAV(R%) - SMTariffRev(R%, S%)\rFORSAVRPA(R%) = FORSAVRPA(R%) - SMTariffRev(R%, S%)\rNext S%\rSAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\rSAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'            If RegName$(R%) = \"Ethiopia\" Then Stop\rNext R%\r"
  },
  {
    "Variable": "FORSAVRPA",
    "UsesVariable": "MRPA",
    "Distance": 0,
    "Code": "\r\r'bbh 2021/07/07 start  Moved these here from locations where FORSAV and FORSAVRPA not calculated yet;\r'   Also useful to have all savings logic in one place\r'     All Steps:  Foreign and Total Savings\r'     -------------------------\r\rFor R% = 1 To NR%\r'bbh 2022/09/05 Subtracted XWORKREMIT from FORSAVRPA and FORSAV; had been commented out but should be in computation\rFORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) - XWORKREMIT(R%)   'Price adjusted compatible with XDEBTRPA\r'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'FORSAV(R%) = M(R%) - X(R%) - AID(R%) '- XWORKEMIT(R%)\rFORSAV(R%) = M(R%) - X(R%) - AID(R%) - XWORKREMIT(R%) 'bbh 2022/12/13 remittances belong here, had been changed in 7.91 but change was not commented\rFor S% = 1 To NSec% 'bbh 2022/12/13 For-Next added as also with CURACT logic given SMTariffRev inclusion in GOVREV\rFORSAV(R%) = FORSAV(R%) - SMTariffRev(R%, S%)\rFORSAVRPA(R%) = FORSAVRPA(R%) - SMTariffRev(R%, S%)\rNext S%\rSAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\rSAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'            If RegName$(R%) = \"Ethiopia\" Then Stop\rNext R%\r"
  },
  {
    "Variable": "FORSAVRPA",
    "UsesVariable": "XRPA",
    "Distance": 0,
    "Code": "\r\r'bbh 2021/07/07 start  Moved these here from locations where FORSAV and FORSAVRPA not calculated yet;\r'   Also useful to have all savings logic in one place\r'     All Steps:  Foreign and Total Savings\r'     -------------------------\r\rFor R% = 1 To NR%\r'bbh 2022/09/05 Subtracted XWORKREMIT from FORSAVRPA and FORSAV; had been commented out but should be in computation\rFORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) - XWORKREMIT(R%)   'Price adjusted compatible with XDEBTRPA\r'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'FORSAV(R%) = M(R%) - X(R%) - AID(R%) '- XWORKEMIT(R%)\rFORSAV(R%) = M(R%) - X(R%) - AID(R%) - XWORKREMIT(R%) 'bbh 2022/12/13 remittances belong here, had been changed in 7.91 but change was not commented\rFor S% = 1 To NSec% 'bbh 2022/12/13 For-Next added as also with CURACT logic given SMTariffRev inclusion in GOVREV\rFORSAV(R%) = FORSAV(R%) - SMTariffRev(R%, S%)\rFORSAVRPA(R%) = FORSAVRPA(R%) - SMTariffRev(R%, S%)\rNext S%\rSAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\rSAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'            If RegName$(R%) = \"Ethiopia\" Then Stop\rNext R%\r"
  },
  {
    "Variable": "FORSAVRPA",
    "UsesVariable": "AID",
    "Distance": 0,
    "Code": "\r\r'bbh 2021/07/07 start  Moved these here from locations where FORSAV and FORSAVRPA not calculated yet;\r'   Also useful to have all savings logic in one place\r'     All Steps:  Foreign and Total Savings\r'     -------------------------\r\rFor R% = 1 To NR%\r'bbh 2022/09/05 Subtracted XWORKREMIT from FORSAVRPA and FORSAV; had been commented out but should be in computation\rFORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) - XWORKREMIT(R%)   'Price adjusted compatible with XDEBTRPA\r'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'FORSAV(R%) = M(R%) - X(R%) - AID(R%) '- XWORKEMIT(R%)\rFORSAV(R%) = M(R%) - X(R%) - AID(R%) - XWORKREMIT(R%) 'bbh 2022/12/13 remittances belong here, had been changed in 7.91 but change was not commented\rFor S% = 1 To NSec% 'bbh 2022/12/13 For-Next added as also with CURACT logic given SMTariffRev inclusion in GOVREV\rFORSAV(R%) = FORSAV(R%) - SMTariffRev(R%, S%)\rFORSAVRPA(R%) = FORSAVRPA(R%) - SMTariffRev(R%, S%)\rNext S%\rSAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\rSAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'            If RegName$(R%) = \"Ethiopia\" Then Stop\rNext R%\r"
  },
  {
    "Variable": "FORSAVRPA",
    "UsesVariable": "XWORKREMIT",
    "Distance": 0,
    "Code": "\r\r'bbh 2021/07/07 start  Moved these here from locations where FORSAV and FORSAVRPA not calculated yet;\r'   Also useful to have all savings logic in one place\r'     All Steps:  Foreign and Total Savings\r'     -------------------------\r\rFor R% = 1 To NR%\r'bbh 2022/09/05 Subtracted XWORKREMIT from FORSAVRPA and FORSAV; had been commented out but should be in computation\rFORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) - XWORKREMIT(R%)   'Price adjusted compatible with XDEBTRPA\r'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'FORSAV(R%) = M(R%) - X(R%) - AID(R%) '- XWORKEMIT(R%)\rFORSAV(R%) = M(R%) - X(R%) - AID(R%) - XWORKREMIT(R%) 'bbh 2022/12/13 remittances belong here, had been changed in 7.91 but change was not commented\rFor S% = 1 To NSec% 'bbh 2022/12/13 For-Next added as also with CURACT logic given SMTariffRev inclusion in GOVREV\rFORSAV(R%) = FORSAV(R%) - SMTariffRev(R%, S%)\rFORSAVRPA(R%) = FORSAVRPA(R%) - SMTariffRev(R%, S%)\rNext S%\rSAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\rSAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'            If RegName$(R%) = \"Ethiopia\" Then Stop\rNext R%\r"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "WAP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "fprihw",
    "Distance": 1,
    "Code": "\rElseIf f% = 2 Then 'meat prices follow from world crop prices\r'        MAFPRI(r%) = fprihw * MAFPRI(r%) + (1 - fprihw) * FPRI(r%, 1)\rMAFPRI(R%) = fprihw * MAFPRI(R%) + (1 - fprihw) * WAP(1)\r"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "fpricr1",
    "Distance": 1,
    "Code": "\r\r'   First Year:  Profits and Prices\r'   -------------------------------\r\rFor f% = 1 To 3\rFPROFITR(R%, f%) = 1\rsfprofitr(R%, f%) = 1\rSSFProfitR(R%, f%) = 1\rsbalance(R%, f%) = 0\rSBalanceForYl(R%) = 0 'bbh 2022/11/28\rcumstk(R%, f%) = FSTOCK(R%, f%)\rscumstk(R%, f%) = cumstk(R%, f%)\rCumStkNegOK(R%, f%) = FSTOCK(R%, f%) 'bbh 2022/10/27 Added 2 lines allowing Negative Stocks\rSCumStkNegOK(R%, f%) = CumStkNegOK(R%, f%)\rscountryextrasurdef(R%, f%) = 0  'For trade adjustment\rNext f%\r\r'balance = CumStk(R%, 1) - dmbase * agdstl 'bbh 2022/11/28 replace with below in case CumStk carries positive when FSTOCK is negative\rbalance = Amin(SFSTOCK(R%, 1), CumStkNegOK(R%, 1)) - dmbase * agdstl\r\r'dsr 2015/06/29 Use post-loss production for demand base\rdmbase = AGDEM(R%, 1) + AGP(R%, 1)\r\r'jrs 2007/01/12 no double counting\rIf RegiontoSum(R%) Then\rwkag = wkag + LD(R%, 1) * CLD(R%) + KAG(R%)\r'dsr 2015/06/19 Since the following is used to calculate capital output ratio, use\r'               pre-production loss production\rwagp = wagp + AGPppl(R%, 1)\rwld = wld + LD(R%, 1)\rwldyl = wldyl + LD(R%, 1) * YL(R%)\rWAGDEM = WAGDEM + AGDEM(R%, 1)\rWGDP = WGDP + GDP(R%)\rEnd If\r\r'jrs 2007/01/12 no double counting\rIf RegiontoSum(R%) Then\rwkag = wkag + LD(R%, 1) * CLD(R%) + KAG(R%)\r'dsr 2015/06/19 Since the following is used to calculate capital output ratio, use\r'               pre-production loss production\rwagp = wagp + AGPppl(R%, 1)\rwld = wld + LD(R%, 1)\rwldyl = wldyl + LD(R%, 1) * YL(R%)\rWAGDEM = WAGDEM + AGDEM(R%, 1)\rWGDP = WGDP + GDP(R%)\rEnd If\r\rDim wagp = 0!\r\r\r'dsr 2015/07/01 This block computes some intermediate values at the global level, which are used\r'    below to calculate an adjustment factor based on global crop stocks, which affects investment later.\r'jrs 2007/01/12 no double counting If f% = 1 Then\r'dsr 2015/06/15 Compute current world crop stocks, including shortages, capital in agriculture\r'    and crop production\rIf f% = 1 AndAlso RegiontoSum(R%) Then\rwfstk = wfstk + cumstk(R%, f%)\r'dsr 2015/06/15 Use post loss production to compute stock base\rwstbase = wstbase + AGDEM(R%, f%) + AGP(R%, f%)\rwkag = wkag + LD(R%, 1) * CLD(R%) + KAG(R%)\rwagp = wagp + byl(R%) * LD(R%, 1)\rEnd If\r\rDim wkag = 0!\r\r\r'dsr 2015/07/01 This block computes some intermediate values at the global level, which are used\r'    below to calculate an adjustment factor based on global crop stocks, which affects investment later.\r'jrs 2007/01/12 no double counting If f% = 1 Then\r'dsr 2015/06/15 Compute current world crop stocks, including shortages, capital in agriculture\r'    and crop production\rIf f% = 1 AndAlso RegiontoSum(R%) Then\rwfstk = wfstk + cumstk(R%, f%)\r'dsr 2015/06/15 Use post loss production to compute stock base\rwstbase = wstbase + AGDEM(R%, f%) + AGP(R%, f%)\rwkag = wkag + LD(R%, 1) * CLD(R%) + KAG(R%)\rwagp = wagp + byl(R%) * LD(R%, 1)\rEnd If\r"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "fpricr2",
    "Distance": 1,
    "Code": "\r\r'   First Year:  Profits and Prices\r'   -------------------------------\r\rFor f% = 1 To 3\rFPROFITR(R%, f%) = 1\rsfprofitr(R%, f%) = 1\rSSFProfitR(R%, f%) = 1\rsbalance(R%, f%) = 0\rSBalanceForYl(R%) = 0 'bbh 2022/11/28\rcumstk(R%, f%) = FSTOCK(R%, f%)\rscumstk(R%, f%) = cumstk(R%, f%)\rCumStkNegOK(R%, f%) = FSTOCK(R%, f%) 'bbh 2022/10/27 Added 2 lines allowing Negative Stocks\rSCumStkNegOK(R%, f%) = CumStkNegOK(R%, f%)\rscountryextrasurdef(R%, f%) = 0  'For trade adjustment\rNext f%\r"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "LD",
    "Distance": 50,
    "Code": "0"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "CLD",
    "Distance": 50,
    "Code": "0"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "KAG",
    "Distance": 50,
    "Code": "0"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "AGDEM",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "AGP",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "FSTOCK",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "dstl",
    "Distance": 601,
    "Code": "\rCumStkNegOK(R%, f%) = SCumStkNegOK(R%, f%) + StkAdj 'bbh 2022/10/27\r"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "ifsexomodelid",
    "Distance": 601,
    "Code": "\rCumStkNegOK(R%, f%) = SCumStkNegOK(R%, f%) + StkAdj 'bbh 2022/10/27\r"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "YL",
    "Distance": 653,
    "Code": "0"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "AGFISHCATCH",
    "Distance": 611,
    "Code": "\r'wv 2020/12/17 agpy update the calculation of satk based on the initial yield intensity, initial year always be equal to 1\rsatk(R%) = CSng(AMAX(0.1, Amin((YLLim(R%) - syl(R%)) / (YLLim(R%) - iyl(R%)), 1)) ^ ylexp)\r"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "AQUACUL",
    "Distance": 612,
    "Code": "\rDim aglossfish = Amin(AMAX(aglossfishfunc, 2) * aglossprodm(R%, 4), 20) 'Losses capped here\r"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "AGTEC",
    "Distance": 361,
    "Code": "\rDim StkAdj = prodterm - AGDEM(R%, f%) + TradeTerm\r"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "ylexp",
    "Distance": 456,
    "Code": "\r\r' wv 2020/12/17 agpy *** start updating the maximum yield***\r'based on data, and make it country specific, also added the YLLim, and SYLLim already in the first year\r\riyl(R%) = YL(R%)\r"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "aglossprodm",
    "Distance": 613,
    "Code": "0"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "LABS",
    "Distance": 492,
    "Code": "0"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "GDPPCP",
    "Distance": 614,
    "Code": "0"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "AGX",
    "Distance": 66,
    "Code": "\r' add an initial variable on yield intensity, and limit the range (0-0.99)\riyieldint(R%) = CSng(Amin(0.99, YIELDINT(R%)))\r"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "AGM",
    "Distance": 66,
    "Code": "\r' add an initial variable on yield intensity, and limit the range (0-0.99)\riyieldint(R%) = CSng(Amin(0.99, YIELDINT(R%)))\r"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "YIELDINT",
    "Distance": 652,
    "Code": "\ralpha(R%) = CDALF(R%) * salphas(R%, 1)\r"
  },
  {
    "Variable": "FPRI",
    "UsesVariable": "CDALF",
    "Distance": 494,
    "Code": "0"
  },
  {
    "Variable": "FPROFITR",
    "UsesVariable": "AGP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "FPROFITR",
    "UsesVariable": "FPRI",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "FPROFITR",
    "UsesVariable": "fprihw",
    "Distance": 30,
    "Code": "0"
  },
  {
    "Variable": "FPROFITR",
    "UsesVariable": "WAP",
    "Distance": 30,
    "Code": "0"
  },
  {
    "Variable": "FREEDOM",
    "UsesVariable": "freedomm",
    "Distance": 0,
    "Code": "\rFreeMul = FreeComp / AMAX(0.01, FreeComp2)\rCOMPLETE STRUCTURE:Next R%:1126|\r\r'jrs 2023/10/13\rDim PolyarchyVal As Single\r\rFor R% = 1 To NR%\rFREEDOMI(R%) = FREEDOM(R%)\r\rFREEDOM(R%) = FREEDOMI(R%) * FreeMul * freedomm(R%)\r\rFREEDOM(R%) = AMAX(2, Amin(FREEDOM(R%), 14))\r"
  },
  {
    "Variable": "FREEDOM",
    "UsesVariable": "GDPPCP",
    "Distance": 3,
    "Code": "\r\r\r'\r'   BBH 2011/04/12\r'   All but First 1:  Freedom, Government Effectiveness, Empowerment Calculations\r'   -----------------------------------------------------------------------------\r\rFor R% = 1 To NR%\rIf context.HistoricMode = True Then\r'Call XYTABL(\"GDP/Capita (PPP) Versus Freedom -Logged and Inverted (Earliest)\",\r'    GDPPCP(R%), FreeComp)\r\rCall XYTABL(\"GDP/Capita (PPP) Versus Freedom -Logged and Inverted (Earliest)\",\r                        GDPPCP(R%), FreeComp, context)\r'Call XYTABL(\"GDP/Capita (PPP) Versus Freedom -Logged and Inverted (Earliest)\",\r'    GDPPCIP(R%), FreeComp2)\r\rCall XYTABL(\"GDP/Capita (PPP) Versus Freedom -Logged and Inverted (Earliest)\",\r                        GDPPCIP(R%), FreeComp2, context)\r\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Economic Freedom (1970)\", _\r'                GDPPCP(R%), econfreecomp)\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Economic Freedom (1970)\", _\r'                GDPPCIP(R%), econfreecomp2)\rElse\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Freedom -Logged and Inverted (2005)\", _\r'                GDPPCP(R%), FreeComp)\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Freedom -Logged and Inverted (2005)\", _\r'                GDPPCIP(R%), FreeComp2)\reduc15term = sedyrsag15(R%)\r'bbh 2011/08/19\reduc15termfem = sedyrsag15fem(R%)\reduc15termi = EDYRSAG15I(R%)\reduc15termfemi = EDYRSAG15FemI(R%)\r'jrs 2013/11/28\r'            Call AnalFunc(\"Feeedom (Inverted) with GDPPCP and EdYears 15 (2005)\", _\r'                Array(GDPPCP(R%), educ15term), FreeComp)\r'Call AnalFunc(\"Freedom (Inverted) with GDPPCP and EdYears 15 (2012)\",\r'    Array(GDPPCP(R%), educ15term), FreeComp,\r'    Array(\"GDP2005PCPPP(MOSTRECENT)/ 1000 (Log)\", \"EdYearsAge15Total(MOSTRECENT) (Linear)\")) 'jrs 2014/10/09 added DepVar Names to check order\r\rCall AnalFunc(\"Freedom (Inverted) with GDPPCP and EdYears 15 (2012)\",\r                    New Single() {GDPPCP(R%), educ15term}, FreeComp,\r                    New String() {\"GDP2005PCPPP(MOSTRECENT)/ 1000 (Log)\", \"EdYearsAge15Total(MOSTRECENT) (Linear)\"}, context)\r\r'Note Preprocessor uses GDPPCP only\r'            educ15termi = EDYRSAG15I(R%)\r'jrs 2013/11/28\r'            Call AnalFunc(\"Feeedom (Inverted) with GDPPCP and EdYears 15 (2005)\", _\r'                Array(GDPPCIP(R%), educ15termi), FreeComp2)\r'Call AnalFunc(\"Freedom (Inverted) with GDPPCP and EdYears 15 (2012)\",\r'    Array(GDPPCIP(R%), educ15termi), FreeComp2,\r'    Array(\"GDP2005PCPPP(MOSTRECENT)/ 1000 (Log)\", \"EdYearsAge15Total(MOSTRECENT) (Linear)\")) 'jrs 2014/10/09 added DepVar Names to check order\r\r\rCall AnalFunc(\"Freedom (Inverted) with GDPPCP and EdYears 15 (2012)\",\r                    New Single() {GDPPCIP(R%), educ15termi}, FreeComp2,\r                    New String() {\"GDP2005PCPPP(MOSTRECENT)/ 1000 (Log)\", \"EdYearsAge15Total(MOSTRECENT) (Linear)\"}, context)\r\r\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Economic Freedom (2000) Log\", _\r'                GDPPCP(R%), econfreecomp)\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Economic Freedom (2000) Log\", _\r'                GDPPCIP(R%), econfreecomp2)\r\r'mti June 2010 - bug found by mti and fix confirmed by BBH -start\r'            TbName$ = \"GDP/Capita (PPP) Versus Economic Freedom (\" & CStr(BaseYear) & \") Log\"\r'            TbName$ = \"GDP/Capita (PPP) Versus Economic Freedom (\" & CStr(BaseYear) & \") Log\"\r'mti June 2010 - bug found by mti and fix confirmed by BBH - end\r\r'            TbName$ = getFunctionNameYrOrMstRct(TbName$, BaseYear)\r'            Call XYTABL(TbName$, GDPPCP(R%), econfreecomp)\r'            Call XYTABL(TbName$, GDPPCIP(R%), econfreecomp2)\r'To be compatible with DataEcon and SocioPol\r\r'            educ15term = sedyrsag15(R%)\rEnd If\r\r\r\r'\r'   BBH 2011/04/12\r'   All but First 1:  Freedom, Government Effectiveness, Empowerment Calculations\r'   -----------------------------------------------------------------------------\r\rFor R% = 1 To NR%\rIf context.HistoricMode = True Then\r'Call XYTABL(\"GDP/Capita (PPP) Versus Freedom -Logged and Inverted (Earliest)\",\r'    GDPPCP(R%), FreeComp)\r\rCall XYTABL(\"GDP/Capita (PPP) Versus Freedom -Logged and Inverted (Earliest)\",\r                        GDPPCP(R%), FreeComp, context)\r'Call XYTABL(\"GDP/Capita (PPP) Versus Freedom -Logged and Inverted (Earliest)\",\r'    GDPPCIP(R%), FreeComp2)\r\rCall XYTABL(\"GDP/Capita (PPP) Versus Freedom -Logged and Inverted (Earliest)\",\r                        GDPPCIP(R%), FreeComp2, context)\r\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Economic Freedom (1970)\", _\r'                GDPPCP(R%), econfreecomp)\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Economic Freedom (1970)\", _\r'                GDPPCIP(R%), econfreecomp2)\rElse\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Freedom -Logged and Inverted (2005)\", _\r'                GDPPCP(R%), FreeComp)\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Freedom -Logged and Inverted (2005)\", _\r'                GDPPCIP(R%), FreeComp2)\reduc15term = sedyrsag15(R%)\r'bbh 2011/08/19\reduc15termfem = sedyrsag15fem(R%)\reduc15termi = EDYRSAG15I(R%)\reduc15termfemi = EDYRSAG15FemI(R%)\r'jrs 2013/11/28\r'            Call AnalFunc(\"Feeedom (Inverted) with GDPPCP and EdYears 15 (2005)\", _\r'                Array(GDPPCP(R%), educ15term), FreeComp)\r'Call AnalFunc(\"Freedom (Inverted) with GDPPCP and EdYears 15 (2012)\",\r'    Array(GDPPCP(R%), educ15term), FreeComp,\r'    Array(\"GDP2005PCPPP(MOSTRECENT)/ 1000 (Log)\", \"EdYearsAge15Total(MOSTRECENT) (Linear)\")) 'jrs 2014/10/09 added DepVar Names to check order\r\rCall AnalFunc(\"Freedom (Inverted) with GDPPCP and EdYears 15 (2012)\",\r                    New Single() {GDPPCP(R%), educ15term}, FreeComp,\r                    New String() {\"GDP2005PCPPP(MOSTRECENT)/ 1000 (Log)\", \"EdYearsAge15Total(MOSTRECENT) (Linear)\"}, context)\r\r'Note Preprocessor uses GDPPCP only\r'            educ15termi = EDYRSAG15I(R%)\r'jrs 2013/11/28\r'            Call AnalFunc(\"Feeedom (Inverted) with GDPPCP and EdYears 15 (2005)\", _\r'                Array(GDPPCIP(R%), educ15termi), FreeComp2)\r'Call AnalFunc(\"Freedom (Inverted) with GDPPCP and EdYears 15 (2012)\",\r'    Array(GDPPCIP(R%), educ15termi), FreeComp2,\r'    Array(\"GDP2005PCPPP(MOSTRECENT)/ 1000 (Log)\", \"EdYearsAge15Total(MOSTRECENT) (Linear)\")) 'jrs 2014/10/09 added DepVar Names to check order\r\r\rCall AnalFunc(\"Freedom (Inverted) with GDPPCP and EdYears 15 (2012)\",\r                    New Single() {GDPPCIP(R%), educ15termi}, FreeComp2,\r                    New String() {\"GDP2005PCPPP(MOSTRECENT)/ 1000 (Log)\", \"EdYearsAge15Total(MOSTRECENT) (Linear)\"}, context)\r\r\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Economic Freedom (2000) Log\", _\r'                GDPPCP(R%), econfreecomp)\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Economic Freedom (2000) Log\", _\r'                GDPPCIP(R%), econfreecomp2)\r\r'mti June 2010 - bug found by mti and fix confirmed by BBH -start\r'            TbName$ = \"GDP/Capita (PPP) Versus Economic Freedom (\" & CStr(BaseYear) & \") Log\"\r'            TbName$ = \"GDP/Capita (PPP) Versus Economic Freedom (\" & CStr(BaseYear) & \") Log\"\r'mti June 2010 - bug found by mti and fix confirmed by BBH - end\r\r'            TbName$ = getFunctionNameYrOrMstRct(TbName$, BaseYear)\r'            Call XYTABL(TbName$, GDPPCP(R%), econfreecomp)\r'            Call XYTABL(TbName$, GDPPCIP(R%), econfreecomp2)\r'To be compatible with DataEcon and SocioPol\r\r'            educ15term = sedyrsag15(R%)\rEnd If\r"
  },
  {
    "Variable": "FREEDOM",
    "UsesVariable": "EDYRSAG15",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "FSTOCK",
    "UsesVariable": "AGDEM",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "FSTOCK",
    "UsesVariable": "AGP",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "FSTOCK",
    "UsesVariable": "dstl",
    "Distance": 557,
    "Code": "0"
  },
  {
    "Variable": "FSTOCK",
    "UsesVariable": "ifsexomodelid",
    "Distance": 557,
    "Code": "0"
  },
  {
    "Variable": "FSTOCK",
    "UsesVariable": "AGX",
    "Distance": 19,
    "Code": "\r\r'   First Year:  Profits and Prices\r'   -------------------------------\r\rFor f% = 1 To 3\rFPROFITR(R%, f%) = 1\rsfprofitr(R%, f%) = 1\rSSFProfitR(R%, f%) = 1\rsbalance(R%, f%) = 0\rSBalanceForYl(R%) = 0 'bbh 2022/11/28\rcumstk(R%, f%) = FSTOCK(R%, f%)\rscumstk(R%, f%) = cumstk(R%, f%)\rCumStkNegOK(R%, f%) = FSTOCK(R%, f%) 'bbh 2022/10/27 Added 2 lines allowing Negative Stocks\rSCumStkNegOK(R%, f%) = CumStkNegOK(R%, f%)\rscountryextrasurdef(R%, f%) = 0  'For trade adjustment\rNext f%\r"
  },
  {
    "Variable": "FSTOCK",
    "UsesVariable": "AGM",
    "Distance": 19,
    "Code": "\r\r'   First Year:  Profits and Prices\r'   -------------------------------\r\rFor f% = 1 To 3\rFPROFITR(R%, f%) = 1\rsfprofitr(R%, f%) = 1\rSSFProfitR(R%, f%) = 1\rsbalance(R%, f%) = 0\rSBalanceForYl(R%) = 0 'bbh 2022/11/28\rcumstk(R%, f%) = FSTOCK(R%, f%)\rscumstk(R%, f%) = cumstk(R%, f%)\rCumStkNegOK(R%, f%) = FSTOCK(R%, f%) 'bbh 2022/10/27 Added 2 lines allowing Negative Stocks\rSCumStkNegOK(R%, f%) = CumStkNegOK(R%, f%)\rscountryextrasurdef(R%, f%) = 0  'For trade adjustment\rNext f%\r"
  },
  {
    "Variable": "GDI",
    "UsesVariable": "HDIMF",
    "Distance": 0,
    "Code": "\r\r'GDI(R%) = HDINEWFemale / HDINEWMale\rGDI(R%) = HDIMF(R%, Female) / HDIMF(R%, Male)\r"
  },
  {
    "Variable": "GDP",
    "UsesVariable": "VADD",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GDP",
    "UsesVariable": "PFD",
    "Distance": 0,
    "Code": "\r\r'   First Year: Gross Domestic Product\r'   ----------------------------------\r\rFor S% = 1 To NSec%\r'            PFD(R%, S%) = CS(R%, S%) + GS(R%, S%) _\r' + INVS(R%, S%) + XS(R%, S%) - MS(R%, S%)\rGDP(R%) = GDP(R%) + PFD(R%, S%)\rNext S%\r\r'If RegName$(R%) = \"China\" Then Stop\r\rIf GDP(R%) < 0.01 Then GDP(R%) = 0.01\r"
  },
  {
    "Variable": "GDPADJ",
    "UsesVariable": "VADD",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "GDPADJ",
    "UsesVariable": "gdprext",
    "Distance": 3,
    "Code": "\rsumvadds = TotalSVadd + TotalSVaddPhy\r"
  },
  {
    "Variable": "GDPADJ",
    "UsesVariable": "agon",
    "Distance": 7,
    "Code": "\rTotalVaddPhy = 0\r"
  },
  {
    "Variable": "GDPADJ",
    "UsesVariable": "enon",
    "Distance": 7,
    "Code": "\rTotalVaddPhy = 0\r"
  },
  {
    "Variable": "GDPINFORMSHR",
    "UsesVariable": "gdpinformshrm",
    "Distance": 0,
    "Code": "\r\rGDPINFORMSHR(R%) = Amin(85, AMAX(1, GDPINFORMSHR(R%) * gdpinformshrm(R%)))\r"
  },
  {
    "Variable": "GDPINFORMSHR",
    "UsesVariable": "LABINFORMSHR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GDPINFORMSHR",
    "UsesVariable": "gdpinformcoeffintercept",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "GDPINFORMSHR",
    "UsesVariable": "gdpinformcoefflabinf",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "GDPINFORMSHR",
    "UsesVariable": "gdpinformcoeffcorrupt",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "GDPINFORMSHR",
    "UsesVariable": "GOVCORRUPT",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "GDPINFORMSHR",
    "UsesVariable": "gdpinformcoeffrand",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "GDPINFORMSHR",
    "UsesVariable": "RANDDEXP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "GDPINFORMSHR",
    "UsesVariable": "gdpshadowcoeffintercept",
    "Distance": 1609,
    "Code": "\r\rIf informallabgdpshadowratRI(R%) < 1 Then\r\r'gdpinformalcalc = 36.28139 + 0.1019374 * LABINFORMSHR(R%) _\r'- 1.884887 * GOVCORRUPT(R%) - 2.957171 * RANDDEXP(R%) 'Sqr(100 * GDS(R%, RandD) / GDP(R%))\r\rgdpinformalcalc = gdpshadowcoeffintercept + gdpshadowcoefflabinf * LABINFORMSHR(R%) _\r                                + gdpshadowcoeffcorrupt * GOVCORRUPT(R%) + gdpshadowcoeffrand * RANDDEXP(R%) 'Sqr(100 * GDS(R%, RandD) / GDP(R%))\r\r\rGDPShadowShrShift(R%) = GDPSHADOWSHR(R%) - Amin(85, AMAX(1, gdpinformalcalc))\rEnd If\r"
  },
  {
    "Variable": "GDPINFORMSHR",
    "UsesVariable": "gdpshadowcoefflabinf",
    "Distance": 1609,
    "Code": "\r\rIf informallabgdpshadowratRI(R%) < 1 Then\r\r'gdpinformalcalc = 36.28139 + 0.1019374 * LABINFORMSHR(R%) _\r'- 1.884887 * GOVCORRUPT(R%) - 2.957171 * RANDDEXP(R%) 'Sqr(100 * GDS(R%, RandD) / GDP(R%))\r\rgdpinformalcalc = gdpshadowcoeffintercept + gdpshadowcoefflabinf * LABINFORMSHR(R%) _\r                                + gdpshadowcoeffcorrupt * GOVCORRUPT(R%) + gdpshadowcoeffrand * RANDDEXP(R%) 'Sqr(100 * GDS(R%, RandD) / GDP(R%))\r\r\rGDPShadowShrShift(R%) = GDPSHADOWSHR(R%) - Amin(85, AMAX(1, gdpinformalcalc))\rEnd If\r"
  },
  {
    "Variable": "GDPINFORMSHR",
    "UsesVariable": "gdpshadowcoeffcorrupt",
    "Distance": 1609,
    "Code": "\r\rIf informallabgdpshadowratRI(R%) < 1 Then\r\r'gdpinformalcalc = 36.28139 + 0.1019374 * LABINFORMSHR(R%) _\r'- 1.884887 * GOVCORRUPT(R%) - 2.957171 * RANDDEXP(R%) 'Sqr(100 * GDS(R%, RandD) / GDP(R%))\r\rgdpinformalcalc = gdpshadowcoeffintercept + gdpshadowcoefflabinf * LABINFORMSHR(R%) _\r                                + gdpshadowcoeffcorrupt * GOVCORRUPT(R%) + gdpshadowcoeffrand * RANDDEXP(R%) 'Sqr(100 * GDS(R%, RandD) / GDP(R%))\r\r\rGDPShadowShrShift(R%) = GDPSHADOWSHR(R%) - Amin(85, AMAX(1, gdpinformalcalc))\rEnd If\r"
  },
  {
    "Variable": "GDPINFORMSHR",
    "UsesVariable": "gdpshadowcoeffrand",
    "Distance": 1609,
    "Code": "\r\rIf informallabgdpshadowratRI(R%) < 1 Then\r\r'gdpinformalcalc = 36.28139 + 0.1019374 * LABINFORMSHR(R%) _\r'- 1.884887 * GOVCORRUPT(R%) - 2.957171 * RANDDEXP(R%) 'Sqr(100 * GDS(R%, RandD) / GDP(R%))\r\rgdpinformalcalc = gdpshadowcoeffintercept + gdpshadowcoefflabinf * LABINFORMSHR(R%) _\r                                + gdpshadowcoeffcorrupt * GOVCORRUPT(R%) + gdpshadowcoeffrand * RANDDEXP(R%) 'Sqr(100 * GDS(R%, RandD) / GDP(R%))\r\r\rGDPShadowShrShift(R%) = GDPSHADOWSHR(R%) - Amin(85, AMAX(1, gdpinformalcalc))\rEnd If\r"
  },
  {
    "Variable": "GDPP",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GDPP",
    "UsesVariable": "PPPCONV",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GDPP",
    "UsesVariable": "POPR",
    "Distance": 397,
    "Code": "0"
  },
  {
    "Variable": "GDPP",
    "UsesVariable": "hwf",
    "Distance": 1,
    "Code": "\r\r'If RegName$(R%) = \"China\" Then Stop\rDim pppcomp As Single = 0\r"
  },
  {
    "Variable": "GDPP",
    "UsesVariable": "GDPPC",
    "Distance": 398,
    "Code": "0"
  },
  {
    "Variable": "GDPP",
    "UsesVariable": "igdpr",
    "Distance": 398,
    "Code": "0"
  },
  {
    "Variable": "GDPPC",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GDPPC",
    "UsesVariable": "igdpr",
    "Distance": 0,
    "Code": "\r'mti October 20, 2011 - end\r\r'   All but First 1:  Productivity Growth:  Adjust Base Rate from Technology\r'   ------------------------------------------------------------------------\r\r'GDPPC(R%) = sgdp(R%) * (1 + igdpr(R%)) / POP(R%)\rGDPPC(R%) = SGDP(R%) * (1 + IGDPRCor(R%)) / POP(R%)\r"
  },
  {
    "Variable": "GDPPC",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GDPPCP",
    "UsesVariable": "GDPPC",
    "Distance": 0,
    "Code": "\r'sGDPPC(R%) = GDPPC(R%) 'bbh 2017/10/17\r\r' If RegName$(R%) = \"China\" Then Stop\r\r\r'If RegName$(R%) = \"Afghanistan\" Then Stop\r'jrs 2014/10/24 Moving to a Function\r'mti 2023/10/27 start\r'If Not bGDPPCPExogenous OrElse gdprext(R%) < -65 Then\rIf Not bGDPPCPExogenous OrElse gdprext(R%) < -65 OrElse ExgnYr < 1 Then\rifsEcoPPP(R%, FunctionRatioPPP, context)        'mti base branch\rGDPPCP(R%) = GDPPC(R%) * PPPCONV(R%)\rElse\rPPPCONV(R%) = GDPPCP(R%) / GDPPC(R%)\rEnd If\r"
  },
  {
    "Variable": "GDPPCP",
    "UsesVariable": "PPPCONV",
    "Distance": 0,
    "Code": "\r'sGDPPC(R%) = GDPPC(R%) 'bbh 2017/10/17\r\r' If RegName$(R%) = \"China\" Then Stop\r\r\r'If RegName$(R%) = \"Afghanistan\" Then Stop\r'jrs 2014/10/24 Moving to a Function\r'mti 2023/10/27 start\r'If Not bGDPPCPExogenous OrElse gdprext(R%) < -65 Then\rIf Not bGDPPCPExogenous OrElse gdprext(R%) < -65 OrElse ExgnYr < 1 Then\rifsEcoPPP(R%, FunctionRatioPPP, context)        'mti base branch\rGDPPCP(R%) = GDPPC(R%) * PPPCONV(R%)\rElse\rPPPCONV(R%) = GDPPCP(R%) / GDPPC(R%)\rEnd If\r"
  },
  {
    "Variable": "GDPPCP",
    "UsesVariable": "GDPP",
    "Distance": 0,
    "Code": "\r'        GDPPCP(R%) = egdppcp 'Temp Calculation for function\r'GDPPCP(R%) = SGDPP(R%) * (1 + igdpr(R%)) / POP(R%)\rGDPPCP(R%) = sgdpp(R%) * (1 + IGDPRCor(R%)) / POP(R%)\r"
  },
  {
    "Variable": "GDPPCP",
    "UsesVariable": "igdpr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GDPPCP",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r'        GDPPCP(R%) = egdppcp 'Temp Calculation for function\r'GDPPCP(R%) = SGDPP(R%) * (1 + igdpr(R%)) / POP(R%)\rGDPPCP(R%) = sgdpp(R%) * (1 + IGDPRCor(R%)) / POP(R%)\r"
  },
  {
    "Variable": "GDPPCP",
    "UsesVariable": "POPR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GDPPCP",
    "UsesVariable": "watsafenewsw",
    "Distance": 0,
    "Code": "\r\r'            If sanitationtrgtyr(R%) > 0 Or sanitnoconsetar > 0 Or watwastetreatsetar > 0 Then 'there is an upward RAI target\r'                WATWASTETREATAddedBF = WatWasteTreatBF(R%) * POP(R%) / 100 - SWATWASTETREAT(R%) * CDbl(sPOPTotal(R%)) / 100 'million people added\r'\r'                INFRAINVESTNEWBF(R%, WasteWater) = AMAX(WATWASTETREATAddedBF, 0) * WATWASTETREATCOST(R%)  'million people * 1000 $ = billion $\r'                INFRAINVESTMAINTBF(R%, WasteWater) = SWATWASTETREAT(R%) * CDbl(sPOPTotal(R%)) * DeppcntWS(WasteWater) * WATWASTETREATCOST(R%) / 100 'million people * 1000 $ = billion $\r'\r'            End If\r\r'mti July 25, 2012 -move this - moved back to avoid run to run\r'            'save GDP per capita for next year\rsGDPPCP(R%) = GDPPCP(R%)\r\r\r\rFor loccnt% = 1 To NLocation%\rssINFRAELECACC(R%, loccnt%) = sINFRAELECACC(R%, loccnt%)\rsINFRAELECACC(R%, loccnt%) = INFRAELECACC(R%, loccnt%)\rNext\r\rsENELECSHRENDEM(R%) = ENELECSHRENDEM(R%)\rsINFRAROADRAI(R%) = INFRAROADRAI(R%)\r\r'Save GDP per capita for next year -\rsGDPPCP(R%) = GDPPCP(R%)\r\r'save gdp and landarea for use next year\rsgdpp(R%) = GDPP(R%)\rsLANDAREA(R%) = LANDAREA(R%)\rNext 'R%\r"
  },
  {
    "Variable": "GDPPCP",
    "UsesVariable": "watsafefwdsw",
    "Distance": 0,
    "Code": "\r\r'            If sanitationtrgtyr(R%) > 0 Or sanitnoconsetar > 0 Or watwastetreatsetar > 0 Then 'there is an upward RAI target\r'                WATWASTETREATAddedBF = WatWasteTreatBF(R%) * POP(R%) / 100 - SWATWASTETREAT(R%) * CDbl(sPOPTotal(R%)) / 100 'million people added\r'\r'                INFRAINVESTNEWBF(R%, WasteWater) = AMAX(WATWASTETREATAddedBF, 0) * WATWASTETREATCOST(R%)  'million people * 1000 $ = billion $\r'                INFRAINVESTMAINTBF(R%, WasteWater) = SWATWASTETREAT(R%) * CDbl(sPOPTotal(R%)) * DeppcntWS(WasteWater) * WATWASTETREATCOST(R%) / 100 'million people * 1000 $ = billion $\r'\r'            End If\r\r'mti July 25, 2012 -move this - moved back to avoid run to run\r'            'save GDP per capita for next year\rsGDPPCP(R%) = GDPPCP(R%)\r\r"
  },
  {
    "Variable": "GDPPCP2005",
    "UsesVariable": "GDPPCP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GDPPCPMF",
    "UsesVariable": "GDPPCP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GDPPCPMF",
    "UsesVariable": "LABWAGESEXRAT",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "GDPPCPMF",
    "UsesVariable": "FEMSHRLAB",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "GDPPCPMF",
    "UsesVariable": "POP",
    "Distance": 348,
    "Code": "0"
  },
  {
    "Variable": "GDPPOT",
    "UsesVariable": "VADD",
    "Distance": 0,
    "Code": "\r'If RegName$(R%) = \"Unitd Kingdm\" Then Stop\r\r\r'   All but First 2:  Adjustments to Intersectoral Flows with Ag Model Computations and Recomputation of ZS, VADD\r'       (for Stock Base and Capacity Utilization)\r'   ------------------------------------------------------\r\rFor column% = 1 To NSec%\rints(R%, column%) = 0!\rintsp = 0!\rFor row = 1 To NSec%\r'If IY% + 2016 = 2018 And RegName$(R%) = \"United States of America\" And row = 2 And column% = 5 Then Stop    'AgINTSFlows\r'If IY% + 2016 = 2020 And RegName$(R%) = \"United States of America\" And row = 2 And column% = 5 Then Stop\rintsp = intsp + AMat(R%, row, column%)\rNext row\rcond = (column% > Ener) Or\r                                (column% = Agri And agon < 0.9) Or (column% = Ener And enon < 0.9)\rintsp = CSng(Amin(0.95, intsp))\rIf cond Then\rZS(R%, column%) = VADD(R%, column%) / (1 - intsp)\rElse\rVADD(R%, column%) = ZS(R%, column%) * (1 - intsp) 'ZS from sectoral models\rEnd If\rFor row = 1 To NSec%\rints(row, column%) = ZS(R%, column%) * AMat(R%, row, column%)\r'If IY% + 2016 = 2018 And RegName$(R%) = \"United States of America\" And row = 2 And column% = 5 Then Stop\r'If IY% + 2016 = 2040 And RegName$(R%) = \"United States of America\" And row = 2 And column% = 5 Then Stop\rNext row\r\rzsp(R%, column%) = ZS(R%, column%)\rGDPPOT(R%) = GDPPOT(R%) + VADD(R%, column%)\rGDPPOTRPA(R%) = GDPPOTRPA(R%) + VADD(R%, column%) * SWP(column%)\rNext column%\r\r\rGDPPOT(R%) = AMAX(0.001, GDPPOT(R%))\r"
  },
  {
    "Variable": "GDPPOT",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "\rGDPPOT(R%) = GDP(R%)\r\rGDPPOT(R%) = 0!\r"
  },
  {
    "Variable": "GDPR",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GDPR",
    "UsesVariable": "igdpr",
    "Distance": 0,
    "Code": "\r'bbh 2014/09/18  Begin based on work from JRS\r'GDPR(R%) = igdpr(R%)\r'GDPR(R%) = IGDPRCor(R%)\rIf IRGDPR(R%) <> 0 AndAlso IRGDPR(R%) < 20 AndAlso IRGDPR(R%) > -10 Then\rGDPR(R%) = IRGDPR(R%)\rElse\rGDPR(R%) = igdpr(R%)\rEnd If\r\r\r'jrs 2017/02/10\r'with dyadic logic this was multiplying by 100 twice\rIf IFUN <> 5 Then\rGDPR(R%) = GDPR(R%) * 100.0!\r'jrs 2024/05/20\rSGDPR(R%) = GDPR(R%)\rEnd If\r\r\rPublic Sub ifsECO3AllbutFirstYear(context As IForecastContext)\r'     All but First 3\r'     ******\r\r'call3:\r'   All but First 3: GDP Derivative Calculation\r'   -------------------------------------------------\r'jrs 2014/09/15\rDim GDPRPAR As Single\rDim LabRate As Single 'bbh 2017/10/04\r\rFor R% = 1 To NR%\r'If RegName$(R%) = \"United States of America\" Then Stop\rGDPR(R%) = 0!\rIf (SGDP(R%) > 0.001) Then GDPR(R%) = (GDP(R%) - SGDP(R%)) / SGDP(R%)\rSmoothGDPR(R%) = SmoothGDPR(R%) * 0.95! + GDPR(R%) * 0.05!\r'bbh 2017/10/04 begin\rLabRate = (LAB(R%) - SLab(R%)) / SLab(R%)\rSmoothLabR(R%) = SmoothLabR(R%) * 0.9! + LabRate * 0.1!\rSLab(R%) = LAB(R%)\r'bbh 2017/10/04 end\r'mti 2014/11/27 -start\rssGDP(R%) = SGDP(R%)\r'mti 2014/11/27 -end\r'SGDP(R%) = GDP(R%) 'bbh 2022/06/23 moved to after use in IFsEcoSAM(3)\r\rGDPRPAR = 0!\rIf (sgdprpa(R%) > 0.001) Then GDPRPAR = (GDPRPA(R%) - sgdprpa(R%)) / sgdprpa(R%)\rSmoothGDPRPAR(R%) = SmoothGDPRPAR(R%) * 0.95! + GDPRPAR * 0.05!\rsgdprpa(R%) = GDPRPA(R%)\r'If RegName$(R%) = \"China\" Then Stop\rNext R%\rEnd Sub\r"
  },
  {
    "Variable": "GDPRPA",
    "UsesVariable": "VADD",
    "Distance": 1,
    "Code": "\r'            ZS(R%, S%) = AMAX(0.0001, ZS(R%, S%)) 'Keep minimum at same value set as minimim in\r'preprocessor or will cause run to run problem.\rVADDRPA(R%, S) = VADDRPA(R%, S%)\r'If RegName$(R%) = \"Ukraine\" And S% = 2 Then Stop\r\r'If RegName$(R%) = \"United States of America\" Or RegName$(R%) = \"United States of America\" Then Stop\r' If RegName$(R%) = \"China\" And IY% >= 40 Then Stop\r\rFor S% = 1 To NSec%\rGDP(R%) = GDP(R%) + VADD(R%, S%)\rVADDRPA(R%, S%) = VADD(R%, S%) * SWP(S%)\rGDPRPA(R%) = GDPRPA(R%) + VADDRPA(R%, S%)\r'If RegName$(R%) = \"Ukraine\" And S% = 2 Then Stop\r'If RegName$(R%) = \"United States of America\" And S% = 5 Then Stop\rNext S%\r\r'If RegName$(R%) = \"United States of America\" Or RegName$(R%) = \"United States of America\" Then Stop\r' If RegName$(R%) = \"China\" And IY% >= 40 Then Stop\r\rFor S% = 1 To NSec%\rGDP(R%) = GDP(R%) + VADD(R%, S%)\rVADDRPA(R%, S%) = VADD(R%, S%) * SWP(S%)\rGDPRPA(R%) = GDPRPA(R%) + VADDRPA(R%, S%)\r'If RegName$(R%) = \"Ukraine\" And S% = 2 Then Stop\r'If RegName$(R%) = \"United States of America\" And S% = 5 Then Stop\rNext S%\r\rGDPRPA(R%) = AMAX(0.001, GDPRPA(R%))\r\r\r'mti 2016/07/16 End (balance after GOVCON adjustment, if any\r\r'\r''   All but First 3: GDP Derivative Calculation\r''   -------------------------------------------------\r'\r'        If GDP(R%) < 0.01 Then GDP(R%) = 0.01\r'        GDPPOT(R%) = GDPPOT(R%) - (GDPPOT(R%) - GDP(R%)) * elasit\r'        If GDPPOT(R%) < 0.001 Then GDPPOT(R%) = 0.001\rIf GDPRPA(R%) < 0.01 Then GDPRPA(R%) = 0.01\r\r\r'   All But First 5: GDP Derivative Calculation\r'   -------------------------------------------------\r\r'        If GDP(R%) < 0.01 Then GDP(R%) = 0.01\r'        GDPPOT(R%) = GDPPOT(R%) - (GDPPOT(R%) - GDP(R%)) * elasit\r'        If GDPPOT(R%) < 0.001 Then GDPPOT(R%) = 0.001\rIf GDPRPA(R%) < 0.01 Then GDPRPA(R%) = 0.01\r"
  },
  {
    "Variable": "GDPRPA",
    "UsesVariable": "WP",
    "Distance": 1,
    "Code": "\r'            ZS(R%, S%) = AMAX(0.0001, ZS(R%, S%)) 'Keep minimum at same value set as minimim in\r'preprocessor or will cause run to run problem.\rVADDRPA(R%, S) = VADDRPA(R%, S%)\r'If RegName$(R%) = \"Ukraine\" And S% = 2 Then Stop\r"
  },
  {
    "Variable": "GDPRPA",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GDPSHADOWSHR",
    "UsesVariable": "gdpshadowshrm",
    "Distance": 0,
    "Code": "\r\rGDPSHADOWSHR(R%) = Amin(85, AMAX(1, GDPSHADOWSHR(R%) * gdpshadowshrm(R%)))\r"
  },
  {
    "Variable": "GDPSHADOWSHR",
    "UsesVariable": "LABINFORMSHR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GDPSHADOWSHR",
    "UsesVariable": "gdpshadowcoeffintercept",
    "Distance": 1,
    "Code": "\r\r'mti 2015/06/09 - start\r\r'------------------ Shadow Econommy --------------\rIf informallabgdpshadowratRI(R%) > 1 Then\r'GDP share higher than labor share; bring co convergence in 25 years\rGDPSHADOWSHR(R%) = Amin(85, AMAX(1, ConvergeOverTime(informallabgdpshadowratRI(R%), 1, 25) * LABINFORMSHR(R%)))\r\r'gdpinformalcalc = 36.28139 + 0.1019374 * LABINFORMSHR(R%) _\r'- 1.884887 * sgovcorrupt(R%) - 2.957171 * SRANDDEXP(R%) 'Sqr(100 * GDS(R%, RandD) / GDP(R%))\r\rgdpinformalcalc = gdpshadowcoeffintercept + gdpshadowcoefflabinf * LABINFORMSHR(R%) _\r                                + gdpshadowcoeffcorrupt * sgovcorrupt(R%) _\r                                + gdpshadowcoeffrand * SRANDDEXP(R%) 'Sqr(100 * sgds(R%, RandD) / gdplastyr)\r\rGDPSHADOWSHR(R%) = Amin(85, AMAX(1, gdpinformalcalc _\r                    + ConvergeOverTime(GDPShadowShrShift(R%), 0, gdpinfconvyr)))  '3\rGDPSHADOWSHR(R%) = Amin(LABINFORMSHR(R%), GDPSHADOWSHR(R%))\r\r'bbh 2015/03/24 Same factor of 8 maximum added to preprocessor\r'mti: this was added by BBH; need to check if the ratio needs to be revised for shadow economy\r'GDPSHADOWSHR(R%) = AMAX(LABINFORMSHR(R%) / 8, GDPSHADOWSHR(R%))\rEnd If\r\r\r'mti 2015/06/09 - start\r\r'------------------ Shadow Econommy --------------\rIf informallabgdpshadowratRI(R%) > 1 Then\r'GDP share higher than labor share; bring co convergence in 25 years\rGDPSHADOWSHR(R%) = Amin(85, AMAX(1, ConvergeOverTime(informallabgdpshadowratRI(R%), 1, 25) * LABINFORMSHR(R%)))\r\r'gdpinformalcalc = 36.28139 + 0.1019374 * LABINFORMSHR(R%) _\r'- 1.884887 * sgovcorrupt(R%) - 2.957171 * SRANDDEXP(R%) 'Sqr(100 * GDS(R%, RandD) / GDP(R%))\r\rgdpinformalcalc = gdpshadowcoeffintercept + gdpshadowcoefflabinf * LABINFORMSHR(R%) _\r                                + gdpshadowcoeffcorrupt * sgovcorrupt(R%) _\r                                + gdpshadowcoeffrand * SRANDDEXP(R%) 'Sqr(100 * sgds(R%, RandD) / gdplastyr)\r\rGDPSHADOWSHR(R%) = Amin(85, AMAX(1, gdpinformalcalc _\r                    + ConvergeOverTime(GDPShadowShrShift(R%), 0, gdpinfconvyr)))  '3\rGDPSHADOWSHR(R%) = Amin(LABINFORMSHR(R%), GDPSHADOWSHR(R%))\r\r'bbh 2015/03/24 Same factor of 8 maximum added to preprocessor\r'mti: this was added by BBH; need to check if the ratio needs to be revised for shadow economy\r'GDPSHADOWSHR(R%) = AMAX(LABINFORMSHR(R%) / 8, GDPSHADOWSHR(R%))\rEnd If\r"
  },
  {
    "Variable": "GDPSHADOWSHR",
    "UsesVariable": "gdpshadowcoefflabinf",
    "Distance": 1,
    "Code": "\r\r'mti 2015/06/09 - start\r\r'------------------ Shadow Econommy --------------\rIf informallabgdpshadowratRI(R%) > 1 Then\r'GDP share higher than labor share; bring co convergence in 25 years\rGDPSHADOWSHR(R%) = Amin(85, AMAX(1, ConvergeOverTime(informallabgdpshadowratRI(R%), 1, 25) * LABINFORMSHR(R%)))\r\r'gdpinformalcalc = 36.28139 + 0.1019374 * LABINFORMSHR(R%) _\r'- 1.884887 * sgovcorrupt(R%) - 2.957171 * SRANDDEXP(R%) 'Sqr(100 * GDS(R%, RandD) / GDP(R%))\r\rgdpinformalcalc = gdpshadowcoeffintercept + gdpshadowcoefflabinf * LABINFORMSHR(R%) _\r                                + gdpshadowcoeffcorrupt * sgovcorrupt(R%) _\r                                + gdpshadowcoeffrand * SRANDDEXP(R%) 'Sqr(100 * sgds(R%, RandD) / gdplastyr)\r\rGDPSHADOWSHR(R%) = Amin(85, AMAX(1, gdpinformalcalc _\r                    + ConvergeOverTime(GDPShadowShrShift(R%), 0, gdpinfconvyr)))  '3\rGDPSHADOWSHR(R%) = Amin(LABINFORMSHR(R%), GDPSHADOWSHR(R%))\r\r'bbh 2015/03/24 Same factor of 8 maximum added to preprocessor\r'mti: this was added by BBH; need to check if the ratio needs to be revised for shadow economy\r'GDPSHADOWSHR(R%) = AMAX(LABINFORMSHR(R%) / 8, GDPSHADOWSHR(R%))\rEnd If\r"
  },
  {
    "Variable": "GDPSHADOWSHR",
    "UsesVariable": "gdpshadowcoeffcorrupt",
    "Distance": 1,
    "Code": "\r\r'mti 2015/06/09 - start\r\r'------------------ Shadow Econommy --------------\rIf informallabgdpshadowratRI(R%) > 1 Then\r'GDP share higher than labor share; bring co convergence in 25 years\rGDPSHADOWSHR(R%) = Amin(85, AMAX(1, ConvergeOverTime(informallabgdpshadowratRI(R%), 1, 25) * LABINFORMSHR(R%)))\r\r'gdpinformalcalc = 36.28139 + 0.1019374 * LABINFORMSHR(R%) _\r'- 1.884887 * sgovcorrupt(R%) - 2.957171 * SRANDDEXP(R%) 'Sqr(100 * GDS(R%, RandD) / GDP(R%))\r\rgdpinformalcalc = gdpshadowcoeffintercept + gdpshadowcoefflabinf * LABINFORMSHR(R%) _\r                                + gdpshadowcoeffcorrupt * sgovcorrupt(R%) _\r                                + gdpshadowcoeffrand * SRANDDEXP(R%) 'Sqr(100 * sgds(R%, RandD) / gdplastyr)\r\rGDPSHADOWSHR(R%) = Amin(85, AMAX(1, gdpinformalcalc _\r                    + ConvergeOverTime(GDPShadowShrShift(R%), 0, gdpinfconvyr)))  '3\rGDPSHADOWSHR(R%) = Amin(LABINFORMSHR(R%), GDPSHADOWSHR(R%))\r\r'bbh 2015/03/24 Same factor of 8 maximum added to preprocessor\r'mti: this was added by BBH; need to check if the ratio needs to be revised for shadow economy\r'GDPSHADOWSHR(R%) = AMAX(LABINFORMSHR(R%) / 8, GDPSHADOWSHR(R%))\rEnd If\r"
  },
  {
    "Variable": "GDPSHADOWSHR",
    "UsesVariable": "GOVCORRUPT",
    "Distance": 1,
    "Code": "\r\r'mti 2015/06/09 - start\r\r'------------------ Shadow Econommy --------------\rIf informallabgdpshadowratRI(R%) > 1 Then\r'GDP share higher than labor share; bring co convergence in 25 years\rGDPSHADOWSHR(R%) = Amin(85, AMAX(1, ConvergeOverTime(informallabgdpshadowratRI(R%), 1, 25) * LABINFORMSHR(R%)))\r\r'gdpinformalcalc = 36.28139 + 0.1019374 * LABINFORMSHR(R%) _\r'- 1.884887 * sgovcorrupt(R%) - 2.957171 * SRANDDEXP(R%) 'Sqr(100 * GDS(R%, RandD) / GDP(R%))\r\rgdpinformalcalc = gdpshadowcoeffintercept + gdpshadowcoefflabinf * LABINFORMSHR(R%) _\r                                + gdpshadowcoeffcorrupt * sgovcorrupt(R%) _\r                                + gdpshadowcoeffrand * SRANDDEXP(R%) 'Sqr(100 * sgds(R%, RandD) / gdplastyr)\r\rGDPSHADOWSHR(R%) = Amin(85, AMAX(1, gdpinformalcalc _\r                    + ConvergeOverTime(GDPShadowShrShift(R%), 0, gdpinfconvyr)))  '3\rGDPSHADOWSHR(R%) = Amin(LABINFORMSHR(R%), GDPSHADOWSHR(R%))\r\r'bbh 2015/03/24 Same factor of 8 maximum added to preprocessor\r'mti: this was added by BBH; need to check if the ratio needs to be revised for shadow economy\r'GDPSHADOWSHR(R%) = AMAX(LABINFORMSHR(R%) / 8, GDPSHADOWSHR(R%))\rEnd If\r"
  },
  {
    "Variable": "GDPSHADOWSHR",
    "UsesVariable": "gdpshadowcoeffrand",
    "Distance": 1,
    "Code": "\r\r'mti 2015/06/09 - start\r\r'------------------ Shadow Econommy --------------\rIf informallabgdpshadowratRI(R%) > 1 Then\r'GDP share higher than labor share; bring co convergence in 25 years\rGDPSHADOWSHR(R%) = Amin(85, AMAX(1, ConvergeOverTime(informallabgdpshadowratRI(R%), 1, 25) * LABINFORMSHR(R%)))\r\r'gdpinformalcalc = 36.28139 + 0.1019374 * LABINFORMSHR(R%) _\r'- 1.884887 * sgovcorrupt(R%) - 2.957171 * SRANDDEXP(R%) 'Sqr(100 * GDS(R%, RandD) / GDP(R%))\r\rgdpinformalcalc = gdpshadowcoeffintercept + gdpshadowcoefflabinf * LABINFORMSHR(R%) _\r                                + gdpshadowcoeffcorrupt * sgovcorrupt(R%) _\r                                + gdpshadowcoeffrand * SRANDDEXP(R%) 'Sqr(100 * sgds(R%, RandD) / gdplastyr)\r\rGDPSHADOWSHR(R%) = Amin(85, AMAX(1, gdpinformalcalc _\r                    + ConvergeOverTime(GDPShadowShrShift(R%), 0, gdpinfconvyr)))  '3\rGDPSHADOWSHR(R%) = Amin(LABINFORMSHR(R%), GDPSHADOWSHR(R%))\r\r'bbh 2015/03/24 Same factor of 8 maximum added to preprocessor\r'mti: this was added by BBH; need to check if the ratio needs to be revised for shadow economy\r'GDPSHADOWSHR(R%) = AMAX(LABINFORMSHR(R%) / 8, GDPSHADOWSHR(R%))\rEnd If\r"
  },
  {
    "Variable": "GDPSHADOWSHR",
    "UsesVariable": "RANDDEXP",
    "Distance": 1,
    "Code": "\r\r'mti 2015/06/09 - start\r\r'------------------ Shadow Econommy --------------\rIf informallabgdpshadowratRI(R%) > 1 Then\r'GDP share higher than labor share; bring co convergence in 25 years\rGDPSHADOWSHR(R%) = Amin(85, AMAX(1, ConvergeOverTime(informallabgdpshadowratRI(R%), 1, 25) * LABINFORMSHR(R%)))\r\r'gdpinformalcalc = 36.28139 + 0.1019374 * LABINFORMSHR(R%) _\r'- 1.884887 * sgovcorrupt(R%) - 2.957171 * SRANDDEXP(R%) 'Sqr(100 * GDS(R%, RandD) / GDP(R%))\r\rgdpinformalcalc = gdpshadowcoeffintercept + gdpshadowcoefflabinf * LABINFORMSHR(R%) _\r                                + gdpshadowcoeffcorrupt * sgovcorrupt(R%) _\r                                + gdpshadowcoeffrand * SRANDDEXP(R%) 'Sqr(100 * sgds(R%, RandD) / gdplastyr)\r\rGDPSHADOWSHR(R%) = Amin(85, AMAX(1, gdpinformalcalc _\r                    + ConvergeOverTime(GDPShadowShrShift(R%), 0, gdpinfconvyr)))  '3\rGDPSHADOWSHR(R%) = Amin(LABINFORMSHR(R%), GDPSHADOWSHR(R%))\r\r'bbh 2015/03/24 Same factor of 8 maximum added to preprocessor\r'mti: this was added by BBH; need to check if the ratio needs to be revised for shadow economy\r'GDPSHADOWSHR(R%) = AMAX(LABINFORMSHR(R%) / 8, GDPSHADOWSHR(R%))\rEnd If\r"
  },
  {
    "Variable": "GDS",
    "UsesVariable": "GOVCON",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GDS",
    "UsesVariable": "gdstrgtval",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "GDS",
    "UsesVariable": "gdscnstsw",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "GDS",
    "UsesVariable": "GDP",
    "Distance": 51,
    "Code": "0"
  },
  {
    "Variable": "GDS",
    "UsesVariable": "gdstrgtyr",
    "Distance": 55,
    "Code": "0"
  },
  {
    "Variable": "GDS",
    "UsesVariable": "XWBFLOWS",
    "Distance": 397,
    "Code": "0"
  },
  {
    "Variable": "GDS",
    "UsesVariable": "gdsm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GDS",
    "UsesVariable": "gdsbudgetprotec",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GDS",
    "UsesVariable": "HLCOST",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "GDS",
    "UsesVariable": "igdpr",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "GDS",
    "UsesVariable": "EDTOTCOST",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "GDS",
    "UsesVariable": "GDPPCP",
    "Distance": 354,
    "Code": "0"
  },
  {
    "Variable": "GDS",
    "UsesVariable": "INFRABUDDEMNEW",
    "Distance": 1326,
    "Code": "\rImports System\rImports System.Collections.Generic\rImports System.IO\rImports System.Linq\rImports IFs.Data\rImports IFs.Data.ProducerScope\rImports System.Math\r\rNamespace Models\r\rPartial Public Module SocioPol\r'-------------------------------------------------------------------------------------------------------------------\r'International Futures System (IFs) - General Public License (GPL) Declaration\r'-------------------------------------------------------------------------------------------------------------------\r'\r'\r'    Copyright 1988-2012 Barry B. Hughes\r'\r'\r'    This file is part of International Futures (IFs) developed by Barry B. Hughes, bhughes@du.edu\r'\r'    IFs is free software: you can redistribute it and/or modify\r'    it under the terms of the GNU General Public License as published by\r'    the Free Software Foundation, either version 3 of the License, or\r'    (at your option) any later version.\r'\r'    IFs is distributed in the hope that it will be useful,\r'    but WITHOUT ANY WARRANTY; without even the implied warranty of\r'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r'    GNU General Public License for more details.\r'\r'    You should have received a copy of the GNU General Public License\r'    along with International Futures System Development Version. If not, please see http://www.gnu.org/licenses/\r'\r'    Developers of International Futures System are required to send the modified code to the IFs core team\r'    Developers should send such code updates, if any, twice every year, on April 1st and on October 1st\r'    Code updates should be sent to Frederick S. Pardee Center for International Futures (contact: pardee@du.edu)\r'-------------------------------------------------------------------------------------------------------------------\r'------------------------------------------------------------------------------------------\r'\r\r'\"Live as if you were to die tommorrow.\"  Popular\r'\"Learn as if you were to live forever.\"  Gandhi\r'\r'\"The future is alwlays present, as a promise, a lure, and a temptation.\"\r'   Karl Popper\r'\r'   Copyright by Barry B. Hughes 1988-2012\r'   Model code available for review and education only\r'   Reproduction or incorporation in other software by permission only\r'\r\r'   Government expenditure categories:\r'       1.  Military\r'       2.  Health\r'       3.  Education\r'       4.  Research and development\r'       5.  Other (including administrative)\r'       6.  Foreign Aid\r\r'Public SSFINTLWARMAG() As Single\r\rDim SCPOW() As Single, SNPOW() As Single, SGDSMil() As Single\r\rDim swatres() As Single 'jrs 2019/10/22\r'clp 2016/08/26 - Adding GDS R&D\rDim SGDSRandD() As Single\rDim SWCPOW As Single, SWNPOW As Single, WGDSMIL As Single, WGDSRandD As Single, WGOV As Single, WGDPPPP As Single, WTECHP As Single, WTECH As Single\r'jrs 2020/11/19\rDim WTECHmix As Single\r\r'dkb 2013/09/09 creating components for world DPI\rDim WDPIBN As Single, WDPIMN As Single, WDPIILN As Single, WDPI As Single\r\r'dkb 2014/07/07 adding world Effective Human Capital component for POWER\rDim WEHC As Single\r\r'jrs 2011/10/11 GPI\rDim WGOVNUCWP As Single, WConvMilSpend As Single, WENX As Single, WENM As Single, WTradeTotal As Single, WXFDIFIN As Single\rDim WAID As Single, WHumCapWkPopHDI As Single, WGOVREV As Single, WInnovationRD As Single, WConnectivityICTProd As Single\r\r'dkb 2014/10/23 - new EnergyNetExport specification - START\rDim WENXM As Single\r'clp 2016/08/25 - Adding world energy production variable\rDim WENProd As Single\r'dkb 2014/10/23 - new EnergyNetExport specification - END\r\r'dkb 2014/08/06 - adding save variables for Diplometrics POWER component calculation - START\rPublic SDIPLOEMBASSY() As Single, SDIPLOIGO() As Single, SDIPLOTREATY() As Single 'jrs 2017/05/22 changed to public\r'Dim SDIPLOEMBASSYMAX, SDIPLOIGOMAX, SDIPLOTREATYMAX\r'dkb 2014/08/06 - END\r\r'jrs 2022/04/20\rPublic SDIPLOEMBASSY2() As Single\r\r\r'mti April 2010 - Infrastructure Consolidation -start\r'jrs 2009/02/25\r'Dim MOBILshift(), BROADshift() As Double\r'jrs 2009/02/26\r'Dim ICTIndexShift()\r'jrs 2009/02/27\r'Dim SMobil()\r'jrs 2009/06/08\r'Public SBroad() As Double\r'jrs 2009/05/18\r'Dim SPENDshift()\r\r'jrs 2009/05/28\r'Dim SGOVREGQUAL()\rPublic SGOVREGQUAL() As Single\r\r\r\r'mti February 2011 Infarstructure - start\r'The following adjustment factor is needed in Infrastr Module\rPublic InfraCostGDSInfraRI() As Single\rPublic sHlthExpPcntGDP() As Single\r'mti February 2011 Infarstructure - end\r\r'dkb 2018/05/09 'Declarations for drug model\rDim drugtotalest() As Single\rDim sdrugtotalest() As Single\rDim DrugAmphetamineEst() As Single, DrugCocaineEst() As Single, DrugOpiateEst() As Single, DrugPrescriptionOpioidEst() As Single, DrugEstTot() As Single\rDim sDrugAmphetamineEst() As Single, sDrugCocaineEst() As Single, sDrugOpiateEst() As Single, sDrugPrescriptionOpioidEst() As Single, sDrugEstTot() As Single\rDim SDRUGUSEAMPHETAMINE() As Single, SDRUGUSECOCAINE() As Single, SDRUGUSEOPIATES() As Single, SDRUGUSEPRESCRIPTOPIOID() As Single\rDim iDrugUseAmphetamine() As Single, iDrugUseCocaine() As Single, iDrugUseOpiates() As Single, iDrugUsePrescriptOpioid() As Single, iDrugUseTot() As Single\rDim iDrugAmphetamineEst() As Single, iDrugCocaineEst() As Single, iDrugOpiateEst(), iDrugPrescriptionOpioidEst() As Single, iDrugEstTot() As Single\rDim hhconpc() As Single, shhconpc() As Single\r'kbn 2018/09/25- Start-\rDim MaxHomicides As Single\r'kbn 2018/09/25- END-\r\r\r'jrs 2009/06/05\r'Dim SICTBroadExp() As Double\r'Dim ICTBroadExpShift() As Double\r'Dim ICTSpendExpShift() As Double\r'Dim GovRegQualShift() As Double\rPublic GovRegQualShift() As Single\r\r'Public ICTBroadExp() As Double\r\r'Dim GOVREGQUALExp() As Double\rPublic GOVREGQUALExp() As Single\r'mti April 2010 - Infrastructure Consolidation -end\r\r'jrs 2011/01/11\rDim GOVRISKMAX() As Single, GOVRISKMIN() As Single, GOVRISKNAME() As String, GOVRISKSIGN() As Single\r'jrs 2011/02/14 *** begin Embeddedness ***\rDim GOVEMBEDShift() As Single, SGOVEMBED() As Single\r'jrs 2011/02/14 *** end Embeddedness ***\r\r\r\r'JAM 2019-08-09\r' Dim dbD As Database, tblK As Recordset, tblR As Recordset, tblC As Recordset\r\r'jrs 2011/10/11\rDim SRANDDEXP() As Single, SGOVNUCWP() As Single\r\r\r'JAM 2019-08-09\r'Dim IFsCtrys As New Collection\r\r\r'jrs 2012/11/05\rDim DIPLOEMBASSYShift() As Single, DIPLOEMBASSYMAXShift As Single\rDim DIPLOIGOShift() As Single, DIPLOIGOMAXShift As Single\rDim DIPLOTREATYShift() As Single, DIPLOTREATYMAXShift As Single\r'jrs 2014/05/26\rPublic PrivExpToCost() As Single\r'jrs 2014/05/30 Dim HLEXPENDPRIVShift() As Single\rDim PrivHLExpPctGDPFxName As String\rDim HlGrTerm() As Single\r'jrs 2016/01/13\rPublic SSFINTLWARMAG() As Single\r'JRS 2016/08/02\rDim HTCGRIShift() As Single, HTCTPIShift() As Single\r'jrs 2017/07/07\rPublic SPOWERGPI() As Single\r'jrs 2022/04/20\rPublic SPOWER() As Single\r'jrs 2017/08/08\rPublic SDEMOCPOLITY() As Single\r'jrs 2018/02/26\rPublic SGOVRISK() As Single\r'dkb 2018/06/01\rPublic SGOVINDSECUR() As Single\rDim svindexmax As Double\r'JAM 2019-08-09 New DEclarations\r\rDim DEMOCPOLITYI() As Single, smdemocpolity() As Single\r'jrs 2023/10/13\rDim DEMOCPOLYARCHYShift() As Single\rPublic SDEMOCPOLYARCHY() As Single\r'Dim SDEMOCPOLYARCHYFX() As Single\r'Dim PolyarchyGR() As Single?\r\rDim swingeffects() As Single, demglobaleffects() As Single\rDim FREEDOMI() As Single, econfreei() As Single, GovEffectAdd() As Single, GovCorruptAdd() As Single\rDim GEMI() As Single, GEMPI() As Single, democcomp() As Single\rDim YTHBULGEI() As Single, gdprmovavg() As Single, ssfintlwarallLoc() As Single, econfreeri() As Single\r'BBH 2011/06/18\rDim energydepend() As Single, ContiguityIntlWarAddI() As Single\rDim democpolityri() As Single\rDim snumnwp() As Single, INUMNWP() As Single, inumnwpgr() As Single, numnwpmin() As Single\rDim SFINSTABALLRI() As Single, SFINSTABMAGRI() As Single, SFINSTABY1RI() As Single\r'BBH 2011/06/18\rDim SFINTLWARALLADD() As Single, SFINTLWARMAGRI() As Single, SFINTLWARY1RI() As Single\r'jrs 2024/05/17\rDim ssfcivilwarUCDPLoc() As Single, SFCIVILWARUCDPADD() As Single, SFCIVILWARUCDPI() As Single\r'bbh 2011/09/21\rDim SFINTLWARALLI() As Single, SFINTLWARMAGI() As Single\rDim SFPredictionI() As Single\rDim SSURVSEI(,) As Single\rDim SwingStsDemoc(9) As Single, SwingStsNumb(9) As Single, sedyrsag15() As Single, EDYRSAG15I() As Single\r'bbh 2011/08/19\rDim sedyrsag15fem() As Single, EDYRSAG15FemI() As Single\rDim RandDExpScale() As Single, RAndDExpI() As Single, EdTerGRateScale() As Single, EdTerGRateI() As Single\r'jrs 2009/04/22\rDim GovRegQualAdd() As Single\r\r'mti 2014/11/14 -start\rDim GovBusCostShift() As Single\r'mti 2014/11/14 - end\r\r'mti 2015/03/04 - start\rDim GovBusRegIndShift() As Single\rDim PoliceShift() As Single, ConflictShift() As Single, SelfHarmShift() As Single, HomicideShift() As Single, WomenandChilshift() As Single, SSVDTHSSELFHARM() As Single, SSVDTHSPOLICS() As Single, Womenshift() As Single, ChilShift() As Single, SelfHarmEstimate() As Single, sSelfHarmEstimate() As Single\rDim SSVDTHSCONFLICT() As Single, SSVDTHSOTHERINTERPERSON() As Single, SSVDTHSWOMENCHILDREN() As Single, SSOCIETALVIOLENCEDEATHS() As Single, SHOMICIDEINDEX() As Single, SSVDTHSWOMEN() As Single, SSVDTHSCHIL() As Single\rDim PoliceEstimate() As Single, ConflictEstimate() As Single, HomicideEstimate() As Single, WomenandChilEstimate() As Single\rDim sPoliceEstimate() As Single, sConflictEstimate() As Single, sWomenandChilEstimate() As Single, sHomicideEstimate() As Single\rDim GIIShift() As Single, GIII() As Single 'jrs 2020/03/23\rDim DemocWaveI As Single\rDim SDEMOCWAVE As Single\rDim SDEMOCWVCOUNT As Single\rDim SDEMOCWVDIR As Single\rDim educ15term As Single\rDim AdultMaleTerm As Double\rDim WomenTerm As Double\rDim ChildrenTerm As Double\rDim poptotalterm As Double\rDim MatPostRAdj() As Double, TradSRatAdj() As Double, SurvSEAdj() As Double\rDim SMATPOSTR(,) As Single, MatPostRI(,) As Single\rDim SSURVSE(,) As Single, SURVSEI(,) As Single\rDim STradSRat(,) As Single, TRADSRATI(,) As Single\rDim POWERI() As Single\rDim gkmul() As Single, milspendrati() As Single, LenWar(,) As Single, PowerTranTermI(,) As Single\rDim AllyI(,) As Single\rDim nowarper(,) As Single, gpowertermI(,) As Single, TerDisputeI(,) As Single\rDim ThreatIData(,) As Single, ThreatIPred(,) As Single\rDim WarGDPOwn() As Single, WarGDPOpp() As Single, WarCPOWOwn() As Single, WarCPOWOpp() As Single\rDim WarNPOWOwn() As Single, WarNPOWOpp() As Single, CPOWDM() As Single, NPOWDM() As Single\rDim gk(,) As Single, gkri(,) As Single, gkcomp() As Single, healthgdpri() As Single, RandDI() As Single\r'jrs 2021/09/09\rDim educgdpri() As Single\r\rDim sumthreatI() As Single ', SGDSMil() As Single\rDim govconwb() As Single, gdswb(,) As Single, RandDExpSh() As Single\r'BBH 4/16/04  V5.0\rDim SMORTMG() As Single\r'mti January 06, 2009\rDim EdCostGDSEdRI() As Single, SEdTotCost() As Single, EdCostGDSEdRIShift() As Single\r'mti January 06, 2009\r'Dim InfraCostGDSInfraRI() As Single, ,\rDim sInfraTotCost() As Single, InfraCostGDSInfraRIShift() As Single\rDim DIPLOINGOPROGRAMShift() As Single, DIPLOINGOADVOCACYShift() As Single\rDim UKcol() As Single, FRAcol() As Single, GERcol() As Single, PORcol() As Single\rDim SPAcol() As Single, NETcol() As Single, RUScol() As Single\r'mti 2016/07/16 Target value in GDS%GDP start\r'Declare array variable for saving initial values and target GDS values (when targeting is set as a parameter)\rDim igk(,) As Single, GDSTrgt(,) As Single\rDim gdssetaside() As Single\rDim GOVEMBEDGR() As Single?\rDim SWGDP As Single\rDim GLOCOMI As Single\rDim PConGreatI As Single\r' Dim CalcInfraBudgetDemand() As Single\rDim InfrabudallocNew() As Single\rDim InfrabudallocMnt() As Single\r'Public sedyrsag15(,) As Single 'JAM 2019-08-21\rPublic SGEM() As Single\r\rPrivate Function CalcInfraBudgetDemand(R As Int32) As Single\r'mti April 2011 - change whole proc\r\r'Estimate public portion of the infrastructure investment and sum to a total budget demand\rDim InfCt%\r\rINFRABUDDEMMNT(R%, InfraTot) = 0\rINFRABUDDEMNEW(R%, InfraTot) = 0\r\rCalcInfraBudgetDemand = 0\r\rFor InfCt% = 1 To NInfraType%\rINFRABUDDEMNEW(R%, InfCt%) = infrainvnewpubshrm(R%, InfCt%) * INFRAINVESTNEW(R%, InfCt%)\rINFRABUDDEMMNT(R%, InfCt%) = infrainvmaintpubshrm(R%, InfCt%) * INFRAINVESTMAINT(R%, InfCt%)\rCalcInfraBudgetDemand = CalcInfraBudgetDemand + INFRABUDDEMNEW(R%, InfCt%) + INFRABUDDEMMNT(R%, InfCt%)  'billion dollars\rINFRABUDDEMNEW(R%, InfraTot) = INFRABUDDEMNEW(R%, InfraTot) + INFRABUDDEMNEW(R%, InfCt%)\rINFRABUDDEMMNT(R%, InfraTot) = INFRABUDDEMMNT(R%, InfraTot) + INFRABUDDEMMNT(R%, InfCt%)\rNext InfCt%\r'mti April 2011 - end\rEnd Function\r\r'bbh 2015/03/25 end\r\r'   All but First 1:  Infrastructure Expenditures (Public)\r'------------------------------------------------------------------------------------------\r\r'adjustment ratio from initial value (first year budget demand and supply ratio) converging to 1 (muted for now: see first year code)\rcInfraCostGDSInfraRI = 1 + ConvergeOverTime1(InfraCostGDSInfraRIShift(R%), 0, 70)\r\rImports System\rImports System.Collections.Generic\rImports System.IO\rImports System.Linq\rImports IFs.Data\rImports IFs.Data.ProducerScope\rImports System.Math\r\rNamespace Models\r\rPartial Public Module SocioPol\r'-------------------------------------------------------------------------------------------------------------------\r'International Futures System (IFs) - General Public License (GPL) Declaration\r'-------------------------------------------------------------------------------------------------------------------\r'\r'\r'    Copyright 1988-2012 Barry B. Hughes\r'\r'\r'    This file is part of International Futures (IFs) developed by Barry B. Hughes, bhughes@du.edu\r'\r'    IFs is free software: you can redistribute it and/or modify\r'    it under the terms of the GNU General Public License as published by\r'    the Free Software Foundation, either version 3 of the License, or\r'    (at your option) any later version.\r'\r'    IFs is distributed in the hope that it will be useful,\r'    but WITHOUT ANY WARRANTY; without even the implied warranty of\r'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r'    GNU General Public License for more details.\r'\r'    You should have received a copy of the GNU General Public License\r'    along with International Futures System Development Version. If not, please see http://www.gnu.org/licenses/\r'\r'    Developers of International Futures System are required to send the modified code to the IFs core team\r'    Developers should send such code updates, if any, twice every year, on April 1st and on October 1st\r'    Code updates should be sent to Frederick S. Pardee Center for International Futures (contact: pardee@du.edu)\r'-------------------------------------------------------------------------------------------------------------------\r'------------------------------------------------------------------------------------------\r'\r\r'\"Live as if you were to die tommorrow.\"  Popular\r'\"Learn as if you were to live forever.\"  Gandhi\r'\r'\"The future is alwlays present, as a promise, a lure, and a temptation.\"\r'   Karl Popper\r'\r'   Copyright by Barry B. Hughes 1988-2012\r'   Model code available for review and education only\r'   Reproduction or incorporation in other software by permission only\r'\r\r'   Government expenditure categories:\r'       1.  Military\r'       2.  Health\r'       3.  Education\r'       4.  Research and development\r'       5.  Other (including administrative)\r'       6.  Foreign Aid\r\r'Public SSFINTLWARMAG() As Single\r\rDim SCPOW() As Single, SNPOW() As Single, SGDSMil() As Single\r\rDim swatres() As Single 'jrs 2019/10/22\r'clp 2016/08/26 - Adding GDS R&D\rDim SGDSRandD() As Single\rDim SWCPOW As Single, SWNPOW As Single, WGDSMIL As Single, WGDSRandD As Single, WGOV As Single, WGDPPPP As Single, WTECHP As Single, WTECH As Single\r'jrs 2020/11/19\rDim WTECHmix As Single\r\r'dkb 2013/09/09 creating components for world DPI\rDim WDPIBN As Single, WDPIMN As Single, WDPIILN As Single, WDPI As Single\r\r'dkb 2014/07/07 adding world Effective Human Capital component for POWER\rDim WEHC As Single\r\r'jrs 2011/10/11 GPI\rDim WGOVNUCWP As Single, WConvMilSpend As Single, WENX As Single, WENM As Single, WTradeTotal As Single, WXFDIFIN As Single\rDim WAID As Single, WHumCapWkPopHDI As Single, WGOVREV As Single, WInnovationRD As Single, WConnectivityICTProd As Single\r\r'dkb 2014/10/23 - new EnergyNetExport specification - START\rDim WENXM As Single\r'clp 2016/08/25 - Adding world energy production variable\rDim WENProd As Single\r'dkb 2014/10/23 - new EnergyNetExport specification - END\r\r'dkb 2014/08/06 - adding save variables for Diplometrics POWER component calculation - START\rPublic SDIPLOEMBASSY() As Single, SDIPLOIGO() As Single, SDIPLOTREATY() As Single 'jrs 2017/05/22 changed to public\r'Dim SDIPLOEMBASSYMAX, SDIPLOIGOMAX, SDIPLOTREATYMAX\r'dkb 2014/08/06 - END\r\r'jrs 2022/04/20\rPublic SDIPLOEMBASSY2() As Single\r\r\r'mti April 2010 - Infrastructure Consolidation -start\r'jrs 2009/02/25\r'Dim MOBILshift(), BROADshift() As Double\r'jrs 2009/02/26\r'Dim ICTIndexShift()\r'jrs 2009/02/27\r'Dim SMobil()\r'jrs 2009/06/08\r'Public SBroad() As Double\r'jrs 2009/05/18\r'Dim SPENDshift()\r\r'jrs 2009/05/28\r'Dim SGOVREGQUAL()\rPublic SGOVREGQUAL() As Single\r\r\r\r'mti February 2011 Infarstructure - start\r'The following adjustment factor is needed in Infrastr Module\rPublic InfraCostGDSInfraRI() As Single\rPublic sHlthExpPcntGDP() As Single\r'mti February 2011 Infarstructure - end\r\r'dkb 2018/05/09 'Declarations for drug model\rDim drugtotalest() As Single\rDim sdrugtotalest() As Single\rDim DrugAmphetamineEst() As Single, DrugCocaineEst() As Single, DrugOpiateEst() As Single, DrugPrescriptionOpioidEst() As Single, DrugEstTot() As Single\rDim sDrugAmphetamineEst() As Single, sDrugCocaineEst() As Single, sDrugOpiateEst() As Single, sDrugPrescriptionOpioidEst() As Single, sDrugEstTot() As Single\rDim SDRUGUSEAMPHETAMINE() As Single, SDRUGUSECOCAINE() As Single, SDRUGUSEOPIATES() As Single, SDRUGUSEPRESCRIPTOPIOID() As Single\rDim iDrugUseAmphetamine() As Single, iDrugUseCocaine() As Single, iDrugUseOpiates() As Single, iDrugUsePrescriptOpioid() As Single, iDrugUseTot() As Single\rDim iDrugAmphetamineEst() As Single, iDrugCocaineEst() As Single, iDrugOpiateEst(), iDrugPrescriptionOpioidEst() As Single, iDrugEstTot() As Single\rDim hhconpc() As Single, shhconpc() As Single\r'kbn 2018/09/25- Start-\rDim MaxHomicides As Single\r'kbn 2018/09/25- END-\r\r\r'jrs 2009/06/05\r'Dim SICTBroadExp() As Double\r'Dim ICTBroadExpShift() As Double\r'Dim ICTSpendExpShift() As Double\r'Dim GovRegQualShift() As Double\rPublic GovRegQualShift() As Single\r\r'Public ICTBroadExp() As Double\r\r'Dim GOVREGQUALExp() As Double\rPublic GOVREGQUALExp() As Single\r'mti April 2010 - Infrastructure Consolidation -end\r\r'jrs 2011/01/11\rDim GOVRISKMAX() As Single, GOVRISKMIN() As Single, GOVRISKNAME() As String, GOVRISKSIGN() As Single\r'jrs 2011/02/14 *** begin Embeddedness ***\rDim GOVEMBEDShift() As Single, SGOVEMBED() As Single\r'jrs 2011/02/14 *** end Embeddedness ***\r\r\r\r'JAM 2019-08-09\r' Dim dbD As Database, tblK As Recordset, tblR As Recordset, tblC As Recordset\r\r'jrs 2011/10/11\rDim SRANDDEXP() As Single, SGOVNUCWP() As Single\r\r\r'JAM 2019-08-09\r'Dim IFsCtrys As New Collection\r\r\r'jrs 2012/11/05\rDim DIPLOEMBASSYShift() As Single, DIPLOEMBASSYMAXShift As Single\rDim DIPLOIGOShift() As Single, DIPLOIGOMAXShift As Single\rDim DIPLOTREATYShift() As Single, DIPLOTREATYMAXShift As Single\r'jrs 2014/05/26\rPublic PrivExpToCost() As Single\r'jrs 2014/05/30 Dim HLEXPENDPRIVShift() As Single\rDim PrivHLExpPctGDPFxName As String\rDim HlGrTerm() As Single\r'jrs 2016/01/13\rPublic SSFINTLWARMAG() As Single\r'JRS 2016/08/02\rDim HTCGRIShift() As Single, HTCTPIShift() As Single\r'jrs 2017/07/07\rPublic SPOWERGPI() As Single\r'jrs 2022/04/20\rPublic SPOWER() As Single\r'jrs 2017/08/08\rPublic SDEMOCPOLITY() As Single\r'jrs 2018/02/26\rPublic SGOVRISK() As Single\r'dkb 2018/06/01\rPublic SGOVINDSECUR() As Single\rDim svindexmax As Double\r'JAM 2019-08-09 New DEclarations\r\rDim DEMOCPOLITYI() As Single, smdemocpolity() As Single\r'jrs 2023/10/13\rDim DEMOCPOLYARCHYShift() As Single\rPublic SDEMOCPOLYARCHY() As Single\r'Dim SDEMOCPOLYARCHYFX() As Single\r'Dim PolyarchyGR() As Single?\r\rDim swingeffects() As Single, demglobaleffects() As Single\rDim FREEDOMI() As Single, econfreei() As Single, GovEffectAdd() As Single, GovCorruptAdd() As Single\rDim GEMI() As Single, GEMPI() As Single, democcomp() As Single\rDim YTHBULGEI() As Single, gdprmovavg() As Single, ssfintlwarallLoc() As Single, econfreeri() As Single\r'BBH 2011/06/18\rDim energydepend() As Single, ContiguityIntlWarAddI() As Single\rDim democpolityri() As Single\rDim snumnwp() As Single, INUMNWP() As Single, inumnwpgr() As Single, numnwpmin() As Single\rDim SFINSTABALLRI() As Single, SFINSTABMAGRI() As Single, SFINSTABY1RI() As Single\r'BBH 2011/06/18\rDim SFINTLWARALLADD() As Single, SFINTLWARMAGRI() As Single, SFINTLWARY1RI() As Single\r'jrs 2024/05/17\rDim ssfcivilwarUCDPLoc() As Single, SFCIVILWARUCDPADD() As Single, SFCIVILWARUCDPI() As Single\r'bbh 2011/09/21\rDim SFINTLWARALLI() As Single, SFINTLWARMAGI() As Single\rDim SFPredictionI() As Single\rDim SSURVSEI(,) As Single\rDim SwingStsDemoc(9) As Single, SwingStsNumb(9) As Single, sedyrsag15() As Single, EDYRSAG15I() As Single\r'bbh 2011/08/19\rDim sedyrsag15fem() As Single, EDYRSAG15FemI() As Single\rDim RandDExpScale() As Single, RAndDExpI() As Single, EdTerGRateScale() As Single, EdTerGRateI() As Single\r'jrs 2009/04/22\rDim GovRegQualAdd() As Single\r\r'mti 2014/11/14 -start\rDim GovBusCostShift() As Single\r'mti 2014/11/14 - end\r\r'mti 2015/03/04 - start\rDim GovBusRegIndShift() As Single\rDim PoliceShift() As Single, ConflictShift() As Single, SelfHarmShift() As Single, HomicideShift() As Single, WomenandChilshift() As Single, SSVDTHSSELFHARM() As Single, SSVDTHSPOLICS() As Single, Womenshift() As Single, ChilShift() As Single, SelfHarmEstimate() As Single, sSelfHarmEstimate() As Single\rDim SSVDTHSCONFLICT() As Single, SSVDTHSOTHERINTERPERSON() As Single, SSVDTHSWOMENCHILDREN() As Single, SSOCIETALVIOLENCEDEATHS() As Single, SHOMICIDEINDEX() As Single, SSVDTHSWOMEN() As Single, SSVDTHSCHIL() As Single\rDim PoliceEstimate() As Single, ConflictEstimate() As Single, HomicideEstimate() As Single, WomenandChilEstimate() As Single\rDim sPoliceEstimate() As Single, sConflictEstimate() As Single, sWomenandChilEstimate() As Single, sHomicideEstimate() As Single\rDim GIIShift() As Single, GIII() As Single 'jrs 2020/03/23\rDim DemocWaveI As Single\rDim SDEMOCWAVE As Single\rDim SDEMOCWVCOUNT As Single\rDim SDEMOCWVDIR As Single\rDim educ15term As Single\rDim AdultMaleTerm As Double\rDim WomenTerm As Double\rDim ChildrenTerm As Double\rDim poptotalterm As Double\rDim MatPostRAdj() As Double, TradSRatAdj() As Double, SurvSEAdj() As Double\rDim SMATPOSTR(,) As Single, MatPostRI(,) As Single\rDim SSURVSE(,) As Single, SURVSEI(,) As Single\rDim STradSRat(,) As Single, TRADSRATI(,) As Single\rDim POWERI() As Single\rDim gkmul() As Single, milspendrati() As Single, LenWar(,) As Single, PowerTranTermI(,) As Single\rDim AllyI(,) As Single\rDim nowarper(,) As Single, gpowertermI(,) As Single, TerDisputeI(,) As Single\rDim ThreatIData(,) As Single, ThreatIPred(,) As Single\rDim WarGDPOwn() As Single, WarGDPOpp() As Single, WarCPOWOwn() As Single, WarCPOWOpp() As Single\rDim WarNPOWOwn() As Single, WarNPOWOpp() As Single, CPOWDM() As Single, NPOWDM() As Single\rDim gk(,) As Single, gkri(,) As Single, gkcomp() As Single, healthgdpri() As Single, RandDI() As Single\r'jrs 2021/09/09\rDim educgdpri() As Single\r\rDim sumthreatI() As Single ', SGDSMil() As Single\rDim govconwb() As Single, gdswb(,) As Single, RandDExpSh() As Single\r'BBH 4/16/04  V5.0\rDim SMORTMG() As Single\r'mti January 06, 2009\rDim EdCostGDSEdRI() As Single, SEdTotCost() As Single, EdCostGDSEdRIShift() As Single\r'mti January 06, 2009\r'Dim InfraCostGDSInfraRI() As Single, ,\rDim sInfraTotCost() As Single, InfraCostGDSInfraRIShift() As Single\rDim DIPLOINGOPROGRAMShift() As Single, DIPLOINGOADVOCACYShift() As Single\rDim UKcol() As Single, FRAcol() As Single, GERcol() As Single, PORcol() As Single\rDim SPAcol() As Single, NETcol() As Single, RUScol() As Single\r'mti 2016/07/16 Target value in GDS%GDP start\r'Declare array variable for saving initial values and target GDS values (when targeting is set as a parameter)\rDim igk(,) As Single, GDSTrgt(,) As Single\rDim gdssetaside() As Single\rDim GOVEMBEDGR() As Single?\rDim SWGDP As Single\rDim GLOCOMI As Single\rDim PConGreatI As Single\r' Dim CalcInfraBudgetDemand() As Single\rDim InfrabudallocNew() As Single\rDim InfrabudallocMnt() As Single\r'Public sedyrsag15(,) As Single 'JAM 2019-08-21\rPublic SGEM() As Single\r\rPrivate Function CalcInfraBudgetDemand(R As Int32) As Single\r'mti April 2011 - change whole proc\r\r'Estimate public portion of the infrastructure investment and sum to a total budget demand\rDim InfCt%\r\rINFRABUDDEMMNT(R%, InfraTot) = 0\rINFRABUDDEMNEW(R%, InfraTot) = 0\r\rCalcInfraBudgetDemand = 0\r\rFor InfCt% = 1 To NInfraType%\rINFRABUDDEMNEW(R%, InfCt%) = infrainvnewpubshrm(R%, InfCt%) * INFRAINVESTNEW(R%, InfCt%)\rINFRABUDDEMMNT(R%, InfCt%) = infrainvmaintpubshrm(R%, InfCt%) * INFRAINVESTMAINT(R%, InfCt%)\rCalcInfraBudgetDemand = CalcInfraBudgetDemand + INFRABUDDEMNEW(R%, InfCt%) + INFRABUDDEMMNT(R%, InfCt%)  'billion dollars\rINFRABUDDEMNEW(R%, InfraTot) = INFRABUDDEMNEW(R%, InfraTot) + INFRABUDDEMNEW(R%, InfCt%)\rINFRABUDDEMMNT(R%, InfraTot) = INFRABUDDEMMNT(R%, InfraTot) + INFRABUDDEMMNT(R%, InfCt%)\rNext InfCt%\r'mti April 2011 - end\rEnd Function\r\rImports System\rImports System.Collections.Generic\rImports System.IO\rImports System.Linq\rImports IFs.Data\rImports IFs.Data.ProducerScope\rImports System.Math\r\rNamespace Models\r\rPartial Public Module SocioPol\r'-------------------------------------------------------------------------------------------------------------------\r'International Futures System (IFs) - General Public License (GPL) Declaration\r'-------------------------------------------------------------------------------------------------------------------\r'\r'\r'    Copyright 1988-2012 Barry B. Hughes\r'\r'\r'    This file is part of International Futures (IFs) developed by Barry B. Hughes, bhughes@du.edu\r'\r'    IFs is free software: you can redistribute it and/or modify\r'    it under the terms of the GNU General Public License as published by\r'    the Free Software Foundation, either version 3 of the License, or\r'    (at your option) any later version.\r'\r'    IFs is distributed in the hope that it will be useful,\r'    but WITHOUT ANY WARRANTY; without even the implied warranty of\r'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r'    GNU General Public License for more details.\r'\r'    You should have received a copy of the GNU General Public License\r'    along with International Futures System Development Version. If not, please see http://www.gnu.org/licenses/\r'\r'    Developers of International Futures System are required to send the modified code to the IFs core team\r'    Developers should send such code updates, if any, twice every year, on April 1st and on October 1st\r'    Code updates should be sent to Frederick S. Pardee Center for International Futures (contact: pardee@du.edu)\r'-------------------------------------------------------------------------------------------------------------------\r'------------------------------------------------------------------------------------------\r'\r\r'\"Live as if you were to die tommorrow.\"  Popular\r'\"Learn as if you were to live forever.\"  Gandhi\r'\r'\"The future is alwlays present, as a promise, a lure, and a temptation.\"\r'   Karl Popper\r'\r'   Copyright by Barry B. Hughes 1988-2012\r'   Model code available for review and education only\r'   Reproduction or incorporation in other software by permission only\r'\r\r'   Government expenditure categories:\r'       1.  Military\r'       2.  Health\r'       3.  Education\r'       4.  Research and development\r'       5.  Other (including administrative)\r'       6.  Foreign Aid\r\r'Public SSFINTLWARMAG() As Single\r\rDim SCPOW() As Single, SNPOW() As Single, SGDSMil() As Single\r\rDim swatres() As Single 'jrs 2019/10/22\r'clp 2016/08/26 - Adding GDS R&D\rDim SGDSRandD() As Single\rDim SWCPOW As Single, SWNPOW As Single, WGDSMIL As Single, WGDSRandD As Single, WGOV As Single, WGDPPPP As Single, WTECHP As Single, WTECH As Single\r'jrs 2020/11/19\rDim WTECHmix As Single\r\r'dkb 2013/09/09 creating components for world DPI\rDim WDPIBN As Single, WDPIMN As Single, WDPIILN As Single, WDPI As Single\r\r'dkb 2014/07/07 adding world Effective Human Capital component for POWER\rDim WEHC As Single\r\r'jrs 2011/10/11 GPI\rDim WGOVNUCWP As Single, WConvMilSpend As Single, WENX As Single, WENM As Single, WTradeTotal As Single, WXFDIFIN As Single\rDim WAID As Single, WHumCapWkPopHDI As Single, WGOVREV As Single, WInnovationRD As Single, WConnectivityICTProd As Single\r\r'dkb 2014/10/23 - new EnergyNetExport specification - START\rDim WENXM As Single\r'clp 2016/08/25 - Adding world energy production variable\rDim WENProd As Single\r'dkb 2014/10/23 - new EnergyNetExport specification - END\r\r'dkb 2014/08/06 - adding save variables for Diplometrics POWER component calculation - START\rPublic SDIPLOEMBASSY() As Single, SDIPLOIGO() As Single, SDIPLOTREATY() As Single 'jrs 2017/05/22 changed to public\r'Dim SDIPLOEMBASSYMAX, SDIPLOIGOMAX, SDIPLOTREATYMAX\r'dkb 2014/08/06 - END\r\r'jrs 2022/04/20\rPublic SDIPLOEMBASSY2() As Single\r\r\r'mti April 2010 - Infrastructure Consolidation -start\r'jrs 2009/02/25\r'Dim MOBILshift(), BROADshift() As Double\r'jrs 2009/02/26\r'Dim ICTIndexShift()\r'jrs 2009/02/27\r'Dim SMobil()\r'jrs 2009/06/08\r'Public SBroad() As Double\r'jrs 2009/05/18\r'Dim SPENDshift()\r\r'jrs 2009/05/28\r'Dim SGOVREGQUAL()\rPublic SGOVREGQUAL() As Single\r\r\r\r'mti February 2011 Infarstructure - start\r'The following adjustment factor is needed in Infrastr Module\rPublic InfraCostGDSInfraRI() As Single\rPublic sHlthExpPcntGDP() As Single\r'mti February 2011 Infarstructure - end\r\r'dkb 2018/05/09 'Declarations for drug model\rDim drugtotalest() As Single\rDim sdrugtotalest() As Single\rDim DrugAmphetamineEst() As Single, DrugCocaineEst() As Single, DrugOpiateEst() As Single, DrugPrescriptionOpioidEst() As Single, DrugEstTot() As Single\rDim sDrugAmphetamineEst() As Single, sDrugCocaineEst() As Single, sDrugOpiateEst() As Single, sDrugPrescriptionOpioidEst() As Single, sDrugEstTot() As Single\rDim SDRUGUSEAMPHETAMINE() As Single, SDRUGUSECOCAINE() As Single, SDRUGUSEOPIATES() As Single, SDRUGUSEPRESCRIPTOPIOID() As Single\rDim iDrugUseAmphetamine() As Single, iDrugUseCocaine() As Single, iDrugUseOpiates() As Single, iDrugUsePrescriptOpioid() As Single, iDrugUseTot() As Single\rDim iDrugAmphetamineEst() As Single, iDrugCocaineEst() As Single, iDrugOpiateEst(), iDrugPrescriptionOpioidEst() As Single, iDrugEstTot() As Single\rDim hhconpc() As Single, shhconpc() As Single\r'kbn 2018/09/25- Start-\rDim MaxHomicides As Single\r'kbn 2018/09/25- END-\r\r\r'jrs 2009/06/05\r'Dim SICTBroadExp() As Double\r'Dim ICTBroadExpShift() As Double\r'Dim ICTSpendExpShift() As Double\r'Dim GovRegQualShift() As Double\rPublic GovRegQualShift() As Single\r\r'Public ICTBroadExp() As Double\r\r'Dim GOVREGQUALExp() As Double\rPublic GOVREGQUALExp() As Single\r'mti April 2010 - Infrastructure Consolidation -end\r\r'jrs 2011/01/11\rDim GOVRISKMAX() As Single, GOVRISKMIN() As Single, GOVRISKNAME() As String, GOVRISKSIGN() As Single\r'jrs 2011/02/14 *** begin Embeddedness ***\rDim GOVEMBEDShift() As Single, SGOVEMBED() As Single\r'jrs 2011/02/14 *** end Embeddedness ***\r\r\r\r'JAM 2019-08-09\r' Dim dbD As Database, tblK As Recordset, tblR As Recordset, tblC As Recordset\r\r'jrs 2011/10/11\rDim SRANDDEXP() As Single, SGOVNUCWP() As Single\r\r\r'JAM 2019-08-09\r'Dim IFsCtrys As New Collection\r\r\r'jrs 2012/11/05\rDim DIPLOEMBASSYShift() As Single, DIPLOEMBASSYMAXShift As Single\rDim DIPLOIGOShift() As Single, DIPLOIGOMAXShift As Single\rDim DIPLOTREATYShift() As Single, DIPLOTREATYMAXShift As Single\r'jrs 2014/05/26\rPublic PrivExpToCost() As Single\r'jrs 2014/05/30 Dim HLEXPENDPRIVShift() As Single\rDim PrivHLExpPctGDPFxName As String\rDim HlGrTerm() As Single\r'jrs 2016/01/13\rPublic SSFINTLWARMAG() As Single\r'JRS 2016/08/02\rDim HTCGRIShift() As Single, HTCTPIShift() As Single\r'jrs 2017/07/07\rPublic SPOWERGPI() As Single\r'jrs 2022/04/20\rPublic SPOWER() As Single\r'jrs 2017/08/08\rPublic SDEMOCPOLITY() As Single\r'jrs 2018/02/26\rPublic SGOVRISK() As Single\r'dkb 2018/06/01\rPublic SGOVINDSECUR() As Single\rDim svindexmax As Double\r'JAM 2019-08-09 New DEclarations\r\rDim DEMOCPOLITYI() As Single, smdemocpolity() As Single\r'jrs 2023/10/13\rDim DEMOCPOLYARCHYShift() As Single\rPublic SDEMOCPOLYARCHY() As Single\r'Dim SDEMOCPOLYARCHYFX() As Single\r'Dim PolyarchyGR() As Single?\r\rDim swingeffects() As Single, demglobaleffects() As Single\rDim FREEDOMI() As Single, econfreei() As Single, GovEffectAdd() As Single, GovCorruptAdd() As Single\rDim GEMI() As Single, GEMPI() As Single, democcomp() As Single\rDim YTHBULGEI() As Single, gdprmovavg() As Single, ssfintlwarallLoc() As Single, econfreeri() As Single\r'BBH 2011/06/18\rDim energydepend() As Single, ContiguityIntlWarAddI() As Single\rDim democpolityri() As Single\rDim snumnwp() As Single, INUMNWP() As Single, inumnwpgr() As Single, numnwpmin() As Single\rDim SFINSTABALLRI() As Single, SFINSTABMAGRI() As Single, SFINSTABY1RI() As Single\r'BBH 2011/06/18\rDim SFINTLWARALLADD() As Single, SFINTLWARMAGRI() As Single, SFINTLWARY1RI() As Single\r'jrs 2024/05/17\rDim ssfcivilwarUCDPLoc() As Single, SFCIVILWARUCDPADD() As Single, SFCIVILWARUCDPI() As Single\r'bbh 2011/09/21\rDim SFINTLWARALLI() As Single, SFINTLWARMAGI() As Single\rDim SFPredictionI() As Single\rDim SSURVSEI(,) As Single\rDim SwingStsDemoc(9) As Single, SwingStsNumb(9) As Single, sedyrsag15() As Single, EDYRSAG15I() As Single\r'bbh 2011/08/19\rDim sedyrsag15fem() As Single, EDYRSAG15FemI() As Single\rDim RandDExpScale() As Single, RAndDExpI() As Single, EdTerGRateScale() As Single, EdTerGRateI() As Single\r'jrs 2009/04/22\rDim GovRegQualAdd() As Single\r\r'mti 2014/11/14 -start\rDim GovBusCostShift() As Single\r'mti 2014/11/14 - end\r\r'mti 2015/03/04 - start\rDim GovBusRegIndShift() As Single\rDim PoliceShift() As Single, ConflictShift() As Single, SelfHarmShift() As Single, HomicideShift() As Single, WomenandChilshift() As Single, SSVDTHSSELFHARM() As Single, SSVDTHSPOLICS() As Single, Womenshift() As Single, ChilShift() As Single, SelfHarmEstimate() As Single, sSelfHarmEstimate() As Single\rDim SSVDTHSCONFLICT() As Single, SSVDTHSOTHERINTERPERSON() As Single, SSVDTHSWOMENCHILDREN() As Single, SSOCIETALVIOLENCEDEATHS() As Single, SHOMICIDEINDEX() As Single, SSVDTHSWOMEN() As Single, SSVDTHSCHIL() As Single\rDim PoliceEstimate() As Single, ConflictEstimate() As Single, HomicideEstimate() As Single, WomenandChilEstimate() As Single\rDim sPoliceEstimate() As Single, sConflictEstimate() As Single, sWomenandChilEstimate() As Single, sHomicideEstimate() As Single\rDim GIIShift() As Single, GIII() As Single 'jrs 2020/03/23\rDim DemocWaveI As Single\rDim SDEMOCWAVE As Single\rDim SDEMOCWVCOUNT As Single\rDim SDEMOCWVDIR As Single\rDim educ15term As Single\rDim AdultMaleTerm As Double\rDim WomenTerm As Double\rDim ChildrenTerm As Double\rDim poptotalterm As Double\rDim MatPostRAdj() As Double, TradSRatAdj() As Double, SurvSEAdj() As Double\rDim SMATPOSTR(,) As Single, MatPostRI(,) As Single\rDim SSURVSE(,) As Single, SURVSEI(,) As Single\rDim STradSRat(,) As Single, TRADSRATI(,) As Single\rDim POWERI() As Single\rDim gkmul() As Single, milspendrati() As Single, LenWar(,) As Single, PowerTranTermI(,) As Single\rDim AllyI(,) As Single\rDim nowarper(,) As Single, gpowertermI(,) As Single, TerDisputeI(,) As Single\rDim ThreatIData(,) As Single, ThreatIPred(,) As Single\rDim WarGDPOwn() As Single, WarGDPOpp() As Single, WarCPOWOwn() As Single, WarCPOWOpp() As Single\rDim WarNPOWOwn() As Single, WarNPOWOpp() As Single, CPOWDM() As Single, NPOWDM() As Single\rDim gk(,) As Single, gkri(,) As Single, gkcomp() As Single, healthgdpri() As Single, RandDI() As Single\r'jrs 2021/09/09\rDim educgdpri() As Single\r\rDim sumthreatI() As Single ', SGDSMil() As Single\rDim govconwb() As Single, gdswb(,) As Single, RandDExpSh() As Single\r'BBH 4/16/04  V5.0\rDim SMORTMG() As Single\r'mti January 06, 2009\rDim EdCostGDSEdRI() As Single, SEdTotCost() As Single, EdCostGDSEdRIShift() As Single\r'mti January 06, 2009\r'Dim InfraCostGDSInfraRI() As Single, ,\rDim sInfraTotCost() As Single, InfraCostGDSInfraRIShift() As Single\rDim DIPLOINGOPROGRAMShift() As Single, DIPLOINGOADVOCACYShift() As Single\rDim UKcol() As Single, FRAcol() As Single, GERcol() As Single, PORcol() As Single\rDim SPAcol() As Single, NETcol() As Single, RUScol() As Single\r'mti 2016/07/16 Target value in GDS%GDP start\r'Declare array variable for saving initial values and target GDS values (when targeting is set as a parameter)\rDim igk(,) As Single, GDSTrgt(,) As Single\rDim gdssetaside() As Single\rDim GOVEMBEDGR() As Single?\rDim SWGDP As Single\rDim GLOCOMI As Single\rDim PConGreatI As Single\r' Dim CalcInfraBudgetDemand() As Single\rDim InfrabudallocNew() As Single\rDim InfrabudallocMnt() As Single\r'Public sedyrsag15(,) As Single 'JAM 2019-08-21\rPublic SGEM() As Single\r\rPrivate Function CalcInfraBudgetDemand(R As Int32) As Single\r'mti April 2011 - change whole proc\r\r'Estimate public portion of the infrastructure investment and sum to a total budget demand\rDim InfCt%\r\rINFRABUDDEMMNT(R%, InfraTot) = 0\rINFRABUDDEMNEW(R%, InfraTot) = 0\r\rCalcInfraBudgetDemand = 0\r\rFor InfCt% = 1 To NInfraType%\rINFRABUDDEMNEW(R%, InfCt%) = infrainvnewpubshrm(R%, InfCt%) * INFRAINVESTNEW(R%, InfCt%)\rINFRABUDDEMMNT(R%, InfCt%) = infrainvmaintpubshrm(R%, InfCt%) * INFRAINVESTMAINT(R%, InfCt%)\rCalcInfraBudgetDemand = CalcInfraBudgetDemand + INFRABUDDEMNEW(R%, InfCt%) + INFRABUDDEMMNT(R%, InfCt%)  'billion dollars\rINFRABUDDEMNEW(R%, InfraTot) = INFRABUDDEMNEW(R%, InfraTot) + INFRABUDDEMNEW(R%, InfCt%)\rINFRABUDDEMMNT(R%, InfraTot) = INFRABUDDEMMNT(R%, InfraTot) + INFRABUDDEMMNT(R%, InfCt%)\rNext InfCt%\r'mti April 2011 - end\rEnd Function\r\rInfraCostGDSInfraRI(R%) = cInfraCostGDSInfraRI\r\rInfraTotDemand = CalcInfraBudgetDemand(R%)\r\r\rDemandCalcInfra = InfraTotDemand * InfraCostGDSInfraRI(R%)\r\r'If IY = 29 And R = 95 Then Stop\r'infrabudsdrat is the set aside/protect parameter\r'mti 2016/01/07 - start\r'BudBalInfra = AMAX(0, Amin(infrabudsdrat, 1))\r\r'mti 2016/07/16 start\r'BudBalInfra = AMAX(0, Amin(infrabudsdrat(R%), 1))\r'mti 2016/07/16 end\r\r'mti 2016/01/07 - end\r\r'switch to turn infrastructure finance on and off\rIf infrafinon = 1 Then\r'jrs 2021/09/09\rIf gdscnstsw(R%, Infra) = 0 Then\rGDS(R%, Infra) = DemandCalcInfra  'billion dollars\rElse\rGDS(R%, Infra) = GDP(R%) * igk(R%, Infra) / 100\rEnd If\r\r'InfraOther\r'jrs 2021/09/09\rIf gdscnstsw(R%, InfraOther) = 0 Then\r'As % of GDP: using function from DSR (function should go to Tablfunc)\rGDS(R%, InfraOther) = CSng(1.8162 + 0.061 * Log(GDPPCP(R%)))\r'initial shift\rGKShift = ConvergeOverTime(gkri(R%, InfraOther), 1, 200)\rGDS(R%, InfraOther) = GDS(R%, InfraOther) * GKShift\r'Convert to billion dollars\rGDS(R%, InfraOther) = (GDS(R%, InfraOther) / 100) * GDP(R%)\rElse\rGDS(R%, InfraOther) = GDP(R%) * igk(R%, InfraOther) / 100\rEnd If\rDemandCalcInfraOther = GDS(R%, InfraOther)\rDemandCalcInfra = 0\rGDS(R%, InfraOther) = 0\rEnd If\r"
  },
  {
    "Variable": "GDS",
    "UsesVariable": "INFRABUDDEMMNT",
    "Distance": 1326,
    "Code": "\rImports System\rImports System.Collections.Generic\rImports System.IO\rImports System.Linq\rImports IFs.Data\rImports IFs.Data.ProducerScope\rImports System.Math\r\rNamespace Models\r\rPartial Public Module SocioPol\r'-------------------------------------------------------------------------------------------------------------------\r'International Futures System (IFs) - General Public License (GPL) Declaration\r'-------------------------------------------------------------------------------------------------------------------\r'\r'\r'    Copyright 1988-2012 Barry B. Hughes\r'\r'\r'    This file is part of International Futures (IFs) developed by Barry B. Hughes, bhughes@du.edu\r'\r'    IFs is free software: you can redistribute it and/or modify\r'    it under the terms of the GNU General Public License as published by\r'    the Free Software Foundation, either version 3 of the License, or\r'    (at your option) any later version.\r'\r'    IFs is distributed in the hope that it will be useful,\r'    but WITHOUT ANY WARRANTY; without even the implied warranty of\r'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r'    GNU General Public License for more details.\r'\r'    You should have received a copy of the GNU General Public License\r'    along with International Futures System Development Version. If not, please see http://www.gnu.org/licenses/\r'\r'    Developers of International Futures System are required to send the modified code to the IFs core team\r'    Developers should send such code updates, if any, twice every year, on April 1st and on October 1st\r'    Code updates should be sent to Frederick S. Pardee Center for International Futures (contact: pardee@du.edu)\r'-------------------------------------------------------------------------------------------------------------------\r'------------------------------------------------------------------------------------------\r'\r\r'\"Live as if you were to die tommorrow.\"  Popular\r'\"Learn as if you were to live forever.\"  Gandhi\r'\r'\"The future is alwlays present, as a promise, a lure, and a temptation.\"\r'   Karl Popper\r'\r'   Copyright by Barry B. Hughes 1988-2012\r'   Model code available for review and education only\r'   Reproduction or incorporation in other software by permission only\r'\r\r'   Government expenditure categories:\r'       1.  Military\r'       2.  Health\r'       3.  Education\r'       4.  Research and development\r'       5.  Other (including administrative)\r'       6.  Foreign Aid\r\r'Public SSFINTLWARMAG() As Single\r\rDim SCPOW() As Single, SNPOW() As Single, SGDSMil() As Single\r\rDim swatres() As Single 'jrs 2019/10/22\r'clp 2016/08/26 - Adding GDS R&D\rDim SGDSRandD() As Single\rDim SWCPOW As Single, SWNPOW As Single, WGDSMIL As Single, WGDSRandD As Single, WGOV As Single, WGDPPPP As Single, WTECHP As Single, WTECH As Single\r'jrs 2020/11/19\rDim WTECHmix As Single\r\r'dkb 2013/09/09 creating components for world DPI\rDim WDPIBN As Single, WDPIMN As Single, WDPIILN As Single, WDPI As Single\r\r'dkb 2014/07/07 adding world Effective Human Capital component for POWER\rDim WEHC As Single\r\r'jrs 2011/10/11 GPI\rDim WGOVNUCWP As Single, WConvMilSpend As Single, WENX As Single, WENM As Single, WTradeTotal As Single, WXFDIFIN As Single\rDim WAID As Single, WHumCapWkPopHDI As Single, WGOVREV As Single, WInnovationRD As Single, WConnectivityICTProd As Single\r\r'dkb 2014/10/23 - new EnergyNetExport specification - START\rDim WENXM As Single\r'clp 2016/08/25 - Adding world energy production variable\rDim WENProd As Single\r'dkb 2014/10/23 - new EnergyNetExport specification - END\r\r'dkb 2014/08/06 - adding save variables for Diplometrics POWER component calculation - START\rPublic SDIPLOEMBASSY() As Single, SDIPLOIGO() As Single, SDIPLOTREATY() As Single 'jrs 2017/05/22 changed to public\r'Dim SDIPLOEMBASSYMAX, SDIPLOIGOMAX, SDIPLOTREATYMAX\r'dkb 2014/08/06 - END\r\r'jrs 2022/04/20\rPublic SDIPLOEMBASSY2() As Single\r\r\r'mti April 2010 - Infrastructure Consolidation -start\r'jrs 2009/02/25\r'Dim MOBILshift(), BROADshift() As Double\r'jrs 2009/02/26\r'Dim ICTIndexShift()\r'jrs 2009/02/27\r'Dim SMobil()\r'jrs 2009/06/08\r'Public SBroad() As Double\r'jrs 2009/05/18\r'Dim SPENDshift()\r\r'jrs 2009/05/28\r'Dim SGOVREGQUAL()\rPublic SGOVREGQUAL() As Single\r\r\r\r'mti February 2011 Infarstructure - start\r'The following adjustment factor is needed in Infrastr Module\rPublic InfraCostGDSInfraRI() As Single\rPublic sHlthExpPcntGDP() As Single\r'mti February 2011 Infarstructure - end\r\r'dkb 2018/05/09 'Declarations for drug model\rDim drugtotalest() As Single\rDim sdrugtotalest() As Single\rDim DrugAmphetamineEst() As Single, DrugCocaineEst() As Single, DrugOpiateEst() As Single, DrugPrescriptionOpioidEst() As Single, DrugEstTot() As Single\rDim sDrugAmphetamineEst() As Single, sDrugCocaineEst() As Single, sDrugOpiateEst() As Single, sDrugPrescriptionOpioidEst() As Single, sDrugEstTot() As Single\rDim SDRUGUSEAMPHETAMINE() As Single, SDRUGUSECOCAINE() As Single, SDRUGUSEOPIATES() As Single, SDRUGUSEPRESCRIPTOPIOID() As Single\rDim iDrugUseAmphetamine() As Single, iDrugUseCocaine() As Single, iDrugUseOpiates() As Single, iDrugUsePrescriptOpioid() As Single, iDrugUseTot() As Single\rDim iDrugAmphetamineEst() As Single, iDrugCocaineEst() As Single, iDrugOpiateEst(), iDrugPrescriptionOpioidEst() As Single, iDrugEstTot() As Single\rDim hhconpc() As Single, shhconpc() As Single\r'kbn 2018/09/25- Start-\rDim MaxHomicides As Single\r'kbn 2018/09/25- END-\r\r\r'jrs 2009/06/05\r'Dim SICTBroadExp() As Double\r'Dim ICTBroadExpShift() As Double\r'Dim ICTSpendExpShift() As Double\r'Dim GovRegQualShift() As Double\rPublic GovRegQualShift() As Single\r\r'Public ICTBroadExp() As Double\r\r'Dim GOVREGQUALExp() As Double\rPublic GOVREGQUALExp() As Single\r'mti April 2010 - Infrastructure Consolidation -end\r\r'jrs 2011/01/11\rDim GOVRISKMAX() As Single, GOVRISKMIN() As Single, GOVRISKNAME() As String, GOVRISKSIGN() As Single\r'jrs 2011/02/14 *** begin Embeddedness ***\rDim GOVEMBEDShift() As Single, SGOVEMBED() As Single\r'jrs 2011/02/14 *** end Embeddedness ***\r\r\r\r'JAM 2019-08-09\r' Dim dbD As Database, tblK As Recordset, tblR As Recordset, tblC As Recordset\r\r'jrs 2011/10/11\rDim SRANDDEXP() As Single, SGOVNUCWP() As Single\r\r\r'JAM 2019-08-09\r'Dim IFsCtrys As New Collection\r\r\r'jrs 2012/11/05\rDim DIPLOEMBASSYShift() As Single, DIPLOEMBASSYMAXShift As Single\rDim DIPLOIGOShift() As Single, DIPLOIGOMAXShift As Single\rDim DIPLOTREATYShift() As Single, DIPLOTREATYMAXShift As Single\r'jrs 2014/05/26\rPublic PrivExpToCost() As Single\r'jrs 2014/05/30 Dim HLEXPENDPRIVShift() As Single\rDim PrivHLExpPctGDPFxName As String\rDim HlGrTerm() As Single\r'jrs 2016/01/13\rPublic SSFINTLWARMAG() As Single\r'JRS 2016/08/02\rDim HTCGRIShift() As Single, HTCTPIShift() As Single\r'jrs 2017/07/07\rPublic SPOWERGPI() As Single\r'jrs 2022/04/20\rPublic SPOWER() As Single\r'jrs 2017/08/08\rPublic SDEMOCPOLITY() As Single\r'jrs 2018/02/26\rPublic SGOVRISK() As Single\r'dkb 2018/06/01\rPublic SGOVINDSECUR() As Single\rDim svindexmax As Double\r'JAM 2019-08-09 New DEclarations\r\rDim DEMOCPOLITYI() As Single, smdemocpolity() As Single\r'jrs 2023/10/13\rDim DEMOCPOLYARCHYShift() As Single\rPublic SDEMOCPOLYARCHY() As Single\r'Dim SDEMOCPOLYARCHYFX() As Single\r'Dim PolyarchyGR() As Single?\r\rDim swingeffects() As Single, demglobaleffects() As Single\rDim FREEDOMI() As Single, econfreei() As Single, GovEffectAdd() As Single, GovCorruptAdd() As Single\rDim GEMI() As Single, GEMPI() As Single, democcomp() As Single\rDim YTHBULGEI() As Single, gdprmovavg() As Single, ssfintlwarallLoc() As Single, econfreeri() As Single\r'BBH 2011/06/18\rDim energydepend() As Single, ContiguityIntlWarAddI() As Single\rDim democpolityri() As Single\rDim snumnwp() As Single, INUMNWP() As Single, inumnwpgr() As Single, numnwpmin() As Single\rDim SFINSTABALLRI() As Single, SFINSTABMAGRI() As Single, SFINSTABY1RI() As Single\r'BBH 2011/06/18\rDim SFINTLWARALLADD() As Single, SFINTLWARMAGRI() As Single, SFINTLWARY1RI() As Single\r'jrs 2024/05/17\rDim ssfcivilwarUCDPLoc() As Single, SFCIVILWARUCDPADD() As Single, SFCIVILWARUCDPI() As Single\r'bbh 2011/09/21\rDim SFINTLWARALLI() As Single, SFINTLWARMAGI() As Single\rDim SFPredictionI() As Single\rDim SSURVSEI(,) As Single\rDim SwingStsDemoc(9) As Single, SwingStsNumb(9) As Single, sedyrsag15() As Single, EDYRSAG15I() As Single\r'bbh 2011/08/19\rDim sedyrsag15fem() As Single, EDYRSAG15FemI() As Single\rDim RandDExpScale() As Single, RAndDExpI() As Single, EdTerGRateScale() As Single, EdTerGRateI() As Single\r'jrs 2009/04/22\rDim GovRegQualAdd() As Single\r\r'mti 2014/11/14 -start\rDim GovBusCostShift() As Single\r'mti 2014/11/14 - end\r\r'mti 2015/03/04 - start\rDim GovBusRegIndShift() As Single\rDim PoliceShift() As Single, ConflictShift() As Single, SelfHarmShift() As Single, HomicideShift() As Single, WomenandChilshift() As Single, SSVDTHSSELFHARM() As Single, SSVDTHSPOLICS() As Single, Womenshift() As Single, ChilShift() As Single, SelfHarmEstimate() As Single, sSelfHarmEstimate() As Single\rDim SSVDTHSCONFLICT() As Single, SSVDTHSOTHERINTERPERSON() As Single, SSVDTHSWOMENCHILDREN() As Single, SSOCIETALVIOLENCEDEATHS() As Single, SHOMICIDEINDEX() As Single, SSVDTHSWOMEN() As Single, SSVDTHSCHIL() As Single\rDim PoliceEstimate() As Single, ConflictEstimate() As Single, HomicideEstimate() As Single, WomenandChilEstimate() As Single\rDim sPoliceEstimate() As Single, sConflictEstimate() As Single, sWomenandChilEstimate() As Single, sHomicideEstimate() As Single\rDim GIIShift() As Single, GIII() As Single 'jrs 2020/03/23\rDim DemocWaveI As Single\rDim SDEMOCWAVE As Single\rDim SDEMOCWVCOUNT As Single\rDim SDEMOCWVDIR As Single\rDim educ15term As Single\rDim AdultMaleTerm As Double\rDim WomenTerm As Double\rDim ChildrenTerm As Double\rDim poptotalterm As Double\rDim MatPostRAdj() As Double, TradSRatAdj() As Double, SurvSEAdj() As Double\rDim SMATPOSTR(,) As Single, MatPostRI(,) As Single\rDim SSURVSE(,) As Single, SURVSEI(,) As Single\rDim STradSRat(,) As Single, TRADSRATI(,) As Single\rDim POWERI() As Single\rDim gkmul() As Single, milspendrati() As Single, LenWar(,) As Single, PowerTranTermI(,) As Single\rDim AllyI(,) As Single\rDim nowarper(,) As Single, gpowertermI(,) As Single, TerDisputeI(,) As Single\rDim ThreatIData(,) As Single, ThreatIPred(,) As Single\rDim WarGDPOwn() As Single, WarGDPOpp() As Single, WarCPOWOwn() As Single, WarCPOWOpp() As Single\rDim WarNPOWOwn() As Single, WarNPOWOpp() As Single, CPOWDM() As Single, NPOWDM() As Single\rDim gk(,) As Single, gkri(,) As Single, gkcomp() As Single, healthgdpri() As Single, RandDI() As Single\r'jrs 2021/09/09\rDim educgdpri() As Single\r\rDim sumthreatI() As Single ', SGDSMil() As Single\rDim govconwb() As Single, gdswb(,) As Single, RandDExpSh() As Single\r'BBH 4/16/04  V5.0\rDim SMORTMG() As Single\r'mti January 06, 2009\rDim EdCostGDSEdRI() As Single, SEdTotCost() As Single, EdCostGDSEdRIShift() As Single\r'mti January 06, 2009\r'Dim InfraCostGDSInfraRI() As Single, ,\rDim sInfraTotCost() As Single, InfraCostGDSInfraRIShift() As Single\rDim DIPLOINGOPROGRAMShift() As Single, DIPLOINGOADVOCACYShift() As Single\rDim UKcol() As Single, FRAcol() As Single, GERcol() As Single, PORcol() As Single\rDim SPAcol() As Single, NETcol() As Single, RUScol() As Single\r'mti 2016/07/16 Target value in GDS%GDP start\r'Declare array variable for saving initial values and target GDS values (when targeting is set as a parameter)\rDim igk(,) As Single, GDSTrgt(,) As Single\rDim gdssetaside() As Single\rDim GOVEMBEDGR() As Single?\rDim SWGDP As Single\rDim GLOCOMI As Single\rDim PConGreatI As Single\r' Dim CalcInfraBudgetDemand() As Single\rDim InfrabudallocNew() As Single\rDim InfrabudallocMnt() As Single\r'Public sedyrsag15(,) As Single 'JAM 2019-08-21\rPublic SGEM() As Single\r\rPrivate Function CalcInfraBudgetDemand(R As Int32) As Single\r'mti April 2011 - change whole proc\r\r'Estimate public portion of the infrastructure investment and sum to a total budget demand\rDim InfCt%\r\rINFRABUDDEMMNT(R%, InfraTot) = 0\rINFRABUDDEMNEW(R%, InfraTot) = 0\r\rCalcInfraBudgetDemand = 0\r\rFor InfCt% = 1 To NInfraType%\rINFRABUDDEMNEW(R%, InfCt%) = infrainvnewpubshrm(R%, InfCt%) * INFRAINVESTNEW(R%, InfCt%)\rINFRABUDDEMMNT(R%, InfCt%) = infrainvmaintpubshrm(R%, InfCt%) * INFRAINVESTMAINT(R%, InfCt%)\rCalcInfraBudgetDemand = CalcInfraBudgetDemand + INFRABUDDEMNEW(R%, InfCt%) + INFRABUDDEMMNT(R%, InfCt%)  'billion dollars\rINFRABUDDEMNEW(R%, InfraTot) = INFRABUDDEMNEW(R%, InfraTot) + INFRABUDDEMNEW(R%, InfCt%)\rINFRABUDDEMMNT(R%, InfraTot) = INFRABUDDEMMNT(R%, InfraTot) + INFRABUDDEMMNT(R%, InfCt%)\rNext InfCt%\r'mti April 2011 - end\rEnd Function\r"
  },
  {
    "Variable": "GDS",
    "UsesVariable": "wpmilthr",
    "Distance": 25,
    "Code": "\rsumthreatI(tar%) = AMAX(0.01, sumthreatI(tar%))\r\r\r'   GOVT EXPENDITURES IN TRADITIONAL DESTINATION CATEGORIES\r'   1=DEFENSE; 2=HEALTH; 3=EDUCATION; 4=R&D; 5=OTHER; 6=FOREIGN AID\r'\r'   All but First 1:  Compute Defense Multiplier Via Action-Reaction\r'   --------------------------------------------------------------\rIf actreaon > 0.5 Then\rFor tar% = 1 To NR%\r\rsumthreat = 0\r'            SumReact = 0\rFor act% = 1 To NR%\rsumthreat = sumthreat + THREAT(act%, tar%) * reac(act%, tar%)\r'                If tar% <> act% Then SumReact = SumReact + reac(act%, tar%)\rNext act%\rIf sumthreatI(tar%) > 0.01 Then\rgkmul(tar%) = CSng(AMAX(0.5, Amin(2, ((sumthreat + 10) / (sumthreatI(tar%) + 10)) ^ wpmilthr)))\rEnd If\rNext tar%\rEnd If\r\r\r'   GOVT EXPENDITURES IN TRADITIONAL DESTINATION CATEGORIES\r'   1=DEFENSE; 2=HEALTH; 3=EDUCATION; 4=R&D; 5=OTHER; 6=FOREIGN AID\r'\r'   All but First 1:  Compute Defense Multiplier Via Action-Reaction\r'   --------------------------------------------------------------\rIf actreaon > 0.5 Then\rFor tar% = 1 To NR%\r\rsumthreat = 0\r'            SumReact = 0\rFor act% = 1 To NR%\rsumthreat = sumthreat + THREAT(act%, tar%) * reac(act%, tar%)\r'                If tar% <> act% Then SumReact = SumReact + reac(act%, tar%)\rNext act%\rIf sumthreatI(tar%) > 0.01 Then\rgkmul(tar%) = CSng(AMAX(0.5, Amin(2, ((sumthreat + 10) / (sumthreatI(tar%) + 10)) ^ wpmilthr)))\rEnd If\rNext tar%\rEnd If\r\r'If RegName(R%) = \"Bangladesh\" Then Stop 'Debug.Print IY; gkri(R%, Other); gk(R%, Other)\r\rFor S% = 1 To NGovExp% '(up through other)\r'mti 2017/05/21 start\r'GKShift = ConvergeOverTime(gkri(R%, S%), 1, 200)\rGKShift = ConvergeOverTime(gkri(R%, S%), 1, 75)\r'mti 2017/05/21 End\r'GKShift = ConvergeOverTime(gkri(R%, S%), 1, mfpconv)\rgk(R%, S%) = gkcomp(S%) * GKShift\r'GKShift = ConvergeOverTime(gkri(R%, S%), 0, mfpconv)\r'gk(R%, S%) = AMAX(0.001, gkcomp(S%) + GKShift)\rNext S%\r\rgkcomp(Other) = gk(R%, Other)\r\r\r'   GOVT EXPENDITURES IN TRADITIONAL DESTINATION CATEGORIES\r'   1=DEFENSE; 2=HEALTH; 3=EDUCATION; 4=R&D; 5=OTHER; 6=FOREIGN AID\r'\r'   All but First 1:  Compute Defense Multiplier Via Action-Reaction\r'   --------------------------------------------------------------\rIf actreaon > 0.5 Then\rFor tar% = 1 To NR%\r\rsumthreat = 0\r'            SumReact = 0\rFor act% = 1 To NR%\rsumthreat = sumthreat + THREAT(act%, tar%) * reac(act%, tar%)\r'                If tar% <> act% Then SumReact = SumReact + reac(act%, tar%)\rNext act%\rIf sumthreatI(tar%) > 0.01 Then\rgkmul(tar%) = CSng(AMAX(0.5, Amin(2, ((sumthreat + 10) / (sumthreatI(tar%) + 10)) ^ wpmilthr)))\rEnd If\rNext tar%\rEnd If\r"
  },
  {
    "Variable": "GDS",
    "UsesVariable": "THREAT",
    "Distance": 26,
    "Code": "0"
  },
  {
    "Variable": "GDS",
    "UsesVariable": "reac",
    "Distance": 26,
    "Code": "0"
  },
  {
    "Variable": "GDSED",
    "UsesVariable": "EDEXPERSECUPPR",
    "Distance": 45,
    "Code": "0"
  },
  {
    "Variable": "GDSED",
    "UsesVariable": "GDPPC",
    "Distance": 45,
    "Code": "0"
  },
  {
    "Variable": "GDSED",
    "UsesVariable": "EDSECUPPRTOT",
    "Distance": 45,
    "Code": "0"
  },
  {
    "Variable": "GDSED",
    "UsesVariable": "GDS",
    "Distance": 65,
    "Code": "0"
  },
  {
    "Variable": "GDSED",
    "UsesVariable": "EDPRITOT",
    "Distance": 469,
    "Code": "0"
  },
  {
    "Variable": "GDSED",
    "UsesVariable": "EDTERTOT",
    "Distance": 466,
    "Code": "0"
  },
  {
    "Variable": "GDSED",
    "UsesVariable": "EDEXPERPRI",
    "Distance": 473,
    "Code": "0"
  },
  {
    "Variable": "GDSED",
    "UsesVariable": "EDSECLOWRTOT",
    "Distance": 468,
    "Code": "0"
  },
  {
    "Variable": "GDSED",
    "UsesVariable": "EDEXPERTER",
    "Distance": 470,
    "Code": "0"
  },
  {
    "Variable": "GDSED",
    "UsesVariable": "EDEXPERSECLOWR",
    "Distance": 472,
    "Code": "0"
  },
  {
    "Variable": "GDSED",
    "UsesVariable": "gdsedm",
    "Distance": 17,
    "Code": "0"
  },
  {
    "Variable": "GEM",
    "UsesVariable": "gemm",
    "Distance": 0,
    "Code": "\r\r\r'bbh 2011/10/08 start\r'dkb 2013/09/18 added dimension 1 to gemsetar and gemseyrtar\rIf gemsetar(R%) <> 0 Then\rMulterm = 1\rEffectSE = StdErrorMultShift(SE, CSng(GEMComp), CSng(Multerm), CSng(Multerm),\r                    CSng(gemsetar(R%)), CInt(FirstYear + gemseyrtar(R%)), FirstYear + IY - 1, CSng(GEMComp2), FirstYear)\rEnd If\r\rGEMMul = GEMComp / AMAX(0.01, GEMComp2)\r\rGEMI(R%) = GEM(R%)\r\r'bbh 2011/08/18\rGEM(R%) = GEMI(R%) * GEMMul * EffectSE * gemm(R%)\r\r'GEM(R%) = GEMI(R%) * GEMMul * gemm(R%)\r'bbh 2011/10/08 end\r'GEMBase = ConvergeOverTime(GEM(R%), GEMComp, gemconv) 'Base, Target, Years\r'bbh 2011/08/18 end\rGEM(R%) = CSng(AMAX(0, Amin(GEM(R%), 1.0#)))\r"
  },
  {
    "Variable": "GEM",
    "UsesVariable": "gemsetar",
    "Distance": 2,
    "Code": "\r\r\r'bbh 2011/10/08 start\r'dkb 2013/09/18 added dimension 1 to gemsetar and gemseyrtar\rIf gemsetar(R%) <> 0 Then\rMulterm = 1\rEffectSE = StdErrorMultShift(SE, CSng(GEMComp), CSng(Multerm), CSng(Multerm),\r                    CSng(gemsetar(R%)), CInt(FirstYear + gemseyrtar(R%)), FirstYear + IY - 1, CSng(GEMComp2), FirstYear)\rEnd If\r\r\r'Call AnalFuncSE(TableName$, Array(GDPPCP(R%), educ15termfemi, YTHBULGE(R%)), GEMComp, SE,\r'Array(\"GDPPCP[0](0) (Linear)\", \"EDYRSAG15[0],Female(0) (Linear)\", \"YTHBULGE[0](0) (Linear)\")) 'jrs 2014/10/09 added DepVar Names to check order\r\r'jrs 2022/06/07 we were using educ15termfemi which is first year value\rCall AnalFuncSE(TableName$,\r                     New Single() {GDPPCP(R%), educ15termfem, YTHBULGE(R%)}, GEMComp, SE,\r                     New String() {\"GDPPCP[0](0) (Linear)\", \"EDYRSAG15[0],Female(0) (Linear)\", \"YTHBULGE[0](0) (Linear)\"}, context)\r\r'Call AnalFuncSE(TableName$, Array(GDPPCIP(R%), educ15termfemi, YTHBULGEI(R%)), GEMComp2, SE,\r'Array(\"GDPPCP[0](0) (Linear)\", \"EDYRSAG15[0],Female(0) (Linear)\", \"YTHBULGE[0](0) (Linear)\")) 'jrs 2014/10/09 added DepVar Names to check order\r\r\rCall AnalFuncSE(TableName$,\r                     New Single() {GDPPCIP(R%), educ15termfemi, YTHBULGEI(R%)}, GEMComp2, SE,\r                     New String() {\"GDPPCP[0](0) (Linear)\", \"EDYRSAG15[0],Female(0) (Linear)\", \"YTHBULGE[0](0) (Linear)\"}, context)\r\r\r'Call AnalFuncSE(TableName$, Array(GDPPCP(R%), educ15termfemi, YTHBULGE(R%)), GEMComp, SE,\r'Array(\"GDPPCP[0](0) (Linear)\", \"EDYRSAG15[0],Female(0) (Linear)\", \"YTHBULGE[0](0) (Linear)\")) 'jrs 2014/10/09 added DepVar Names to check order\r\r'jrs 2022/06/07 we were using educ15termfemi which is first year value\rCall AnalFuncSE(TableName$,\r                     New Single() {GDPPCP(R%), educ15termfem, YTHBULGE(R%)}, GEMComp, SE,\r                     New String() {\"GDPPCP[0](0) (Linear)\", \"EDYRSAG15[0],Female(0) (Linear)\", \"YTHBULGE[0](0) (Linear)\"}, context)\r"
  },
  {
    "Variable": "GEM",
    "UsesVariable": "gemseyrtar",
    "Distance": 2,
    "Code": "\r\r\r'bbh 2011/10/08 start\r'dkb 2013/09/18 added dimension 1 to gemsetar and gemseyrtar\rIf gemsetar(R%) <> 0 Then\rMulterm = 1\rEffectSE = StdErrorMultShift(SE, CSng(GEMComp), CSng(Multerm), CSng(Multerm),\r                    CSng(gemsetar(R%)), CInt(FirstYear + gemseyrtar(R%)), FirstYear + IY - 1, CSng(GEMComp2), FirstYear)\rEnd If\r"
  },
  {
    "Variable": "GEM",
    "UsesVariable": "GDPPCP",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "GEM",
    "UsesVariable": "YTHBULGE",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "GEM",
    "UsesVariable": "EDYRSAG15",
    "Distance": 297,
    "Code": "0"
  },
  {
    "Variable": "GII",
    "UsesVariable": "EDSECPER",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "GII",
    "UsesVariable": "LABPARR",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "GII",
    "UsesVariable": "MATMORTRATIO",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "GII",
    "UsesVariable": "CBR",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "GINIDOM",
    "UsesVariable": "ginidomm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GINIDOM",
    "UsesVariable": "envtemptoginidomsw",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GINIDOM",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "\r\r'jrs 2022/08/15\rIf envtemptoginidomsw > 0 Then\rGINIDOM(R%) = CSng(AMAX(0.21, Amin(0.99, GINIDOM(R%))))\rEnd If\r"
  },
  {
    "Variable": "GINIDOM",
    "UsesVariable": "envtemptoginidomel",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GINIDOM",
    "UsesVariable": "sfintlwaralltoginidom",
    "Distance": 1,
    "Code": "\r'jrs 2021/09/29 end adding ginidomcnstsw\r\r'jrs 2022/05/23\r'Conflict to Gini relationship, Bircan says is 2% increase in inequality per conflict\rIf sfintlwaralltoginidom(R%) <> 1 Then\rDim Factor As Single\r'jrs 2024/05/20\rIf sfcivilwarucdpsw = 0 Then\rFactor = (sfintlwaralltoginidom(R%) - 1) * SFINTLWARALL(R%)\rElse\rFactor = (sfintlwaralltoginidom(R%) - 1) * SFCIVILWARUCDP(R%)\rEnd If\rGINIDOM(R%) = GINIDOM(R%) * (1 + Factor)\rEnd If\r\r'jrs 2021/09/29 end adding ginidomcnstsw\r\r'jrs 2022/05/23\r'Conflict to Gini relationship, Bircan says is 2% increase in inequality per conflict\rIf sfintlwaralltoginidom(R%) <> 1 Then\rDim Factor As Single\r'jrs 2024/05/20\rIf sfcivilwarucdpsw = 0 Then\rFactor = (sfintlwaralltoginidom(R%) - 1) * SFINTLWARALL(R%)\rElse\rFactor = (sfintlwaralltoginidom(R%) - 1) * SFCIVILWARUCDP(R%)\rEnd If\rGINIDOM(R%) = GINIDOM(R%) * (1 + Factor)\rEnd If\r\r\r'jrs 2022/08/03\rSelect Case envtemptoginidomsw '0 is off\rCase 1 'U shape (in reality inverted U shape)\rDim Delta As Single\r'jrs 2022/08/05 Call XYTABL(\"Temperature Versus Change in Log of 1 - Domestic Gini\", SENVTEMP1(R%), Delta, context)\r'Delta (LN(1-GINI)) = LN(1-GINI_new) - LN(1-GINI)\r'Delta = LN ((1-GINI_NEW)/(1-GINI))\r'EXP(Delta) = (1-GINI_NEW)/(1-GINI)\r'1 - GINI_NEW = EXP(Delta) * (1 - GINI)\r'GINI_NEW = 1 - EXP(Delta) * (1 - GINI)\r'GINIDOM(R%) = CSng(1 - Exp(Delta) * (1 - GINIDOM(R%)))\rCall XYTABL(\"Temperature Versus Change in Domestic Gini\", SENVTEMP1(R%), Delta, context)\r'Delta = GINI_new - GINI\r'GINI_new = GINI + Delta\rGINIDOM(R%) = GINIDOM(R%) + Delta\rCase 2 'Elasticity\r'jrs 2022/08/15\rIf IY > 2 And 9 / 5 * SENVTEMP2(R%) + 32 > 0 Then\r'jrs 202/08/15 Using Farenheit to avoid impact of 0 (or close to 0) temperature\r'GINIDOM(R%) = GINIDOM(R%) * SENVTEMP1(R%) / SENVTEMP2(R%) * envtemptoginidomel\r'jrs 2022/10/11 GINIDOM(R%) = CSng(GINIDOM(R%) * (9 / 5 * SENVTEMP1(R%) + 32) / (9 / 5 * SENVTEMP2(R%) + 32) * envtemptoginidomel)\r'jrs 2022/11/02 GINIDOM(R%) = CSng(GINIDOM(R%) * (1 + ((9 / 5 * SENVTEMP1(R%) + 32) / (9 / 5 * SENVTEMP2(R%) + 32) - 1) * envtemptoginidomel))\rGINIDOM(R%) = CSng(GINIDOM(R%) * (1 + (SENVTEMP1(R%) / If(IENVTEMP(R%) = 0, 0.01, IENVTEMP(R%)) - 1) * envtemptoginidomel))\rEnd If\rCase 3 'U shape (in reality inverted U shape) jrs 2022/09/30\rDim Delta, Delta2 As Single\r'jrs 2022/08/05 Call XYTABL(\"Temperature Versus Change in Log of 1 - Domestic Gini\", SENVTEMP1(R%), Delta, context)\r'Delta (LN(1-GINI)) = LN(1-GINI_new) - LN(1-GINI)\r'Delta = LN ((1-GINI_NEW)/(1-GINI))\r'EXP(Delta) = (1-GINI_NEW)/(1-GINI)\r'1 - GINI_NEW = EXP(Delta) * (1 - GINI)\r'GINI_NEW = 1 - EXP(Delta) * (1 - GINI)\r'GINIDOM(R%) = CSng(1 - Exp(Delta) * (1 - GINIDOM(R%)))\rIf IY > 2 Then\rCall XYTABL(\"Temperature Versus Change in Domestic Gini\", SENVTEMP1(R%), Delta, context)\rCall XYTABL(\"Temperature Versus Change in Domestic Gini\", SENVTEMP2(R%), Delta2, context)\r'Delta = GINI_new - GINI\r'GINI_new = GINI + Delta\rGINIDOM(R%) = GINIDOM(R%) + (Delta - Delta2)\rEnd If\rCase 4 'Absolute Elasticity, Halligate\r'jrs 2023/03/13\rIf IY > 2 Then\r'jrs 2023/05/11 GINIDOM(R%) = GINIDOM(R%) + (SENVTEMP1(R%) - IENVTEMP(R%)) * envtemptoginidomel\rIf XGINIDOMLOAD(R%) Then\rGINIDOM(R%) = XGINIDOM(R%) + (SENVTEMP1(R%) - XENVTEMP(R%)) * envtemptoginidomel\rEnd If\rEnd If\rCase 5 'jrs 2023/05/02 Paglialunga\rIf XGINIDOMLOAD(R%) Then\rGINIDOM(R%) = CSng(XGINIDOM(R%) + (SENVTEMP1(R%) / If(XENVTEMP(R%) = 0, 0.01, XENVTEMP(R%)) - 1) * envtemptoginidomel)\rEnd If\rCase 6 'jrs 2023/05/09\rIf XGINIDOMLOAD(R%) Then\rGINIDOM(R%) = CSng(XGINIDOM(R%) + (STSCALED(R%) / If(XTSCALED(R%) = 0, 0.01, XTSCALED(R%)) - 1) * envtemptoginidomel)\rEnd If\rEnd Select\r\r\r'jrs 2022/08/03\rSelect Case envtemptoginidomsw '0 is off\rCase 1 'U shape (in reality inverted U shape)\rDim Delta As Single\r'jrs 2022/08/05 Call XYTABL(\"Temperature Versus Change in Log of 1 - Domestic Gini\", SENVTEMP1(R%), Delta, context)\r'Delta (LN(1-GINI)) = LN(1-GINI_new) - LN(1-GINI)\r'Delta = LN ((1-GINI_NEW)/(1-GINI))\r'EXP(Delta) = (1-GINI_NEW)/(1-GINI)\r'1 - GINI_NEW = EXP(Delta) * (1 - GINI)\r'GINI_NEW = 1 - EXP(Delta) * (1 - GINI)\r'GINIDOM(R%) = CSng(1 - Exp(Delta) * (1 - GINIDOM(R%)))\rCall XYTABL(\"Temperature Versus Change in Domestic Gini\", SENVTEMP1(R%), Delta, context)\r'Delta = GINI_new - GINI\r'GINI_new = GINI + Delta\rGINIDOM(R%) = GINIDOM(R%) + Delta\rCase 2 'Elasticity\r'jrs 2022/08/15\rIf IY > 2 And 9 / 5 * SENVTEMP2(R%) + 32 > 0 Then\r'jrs 202/08/15 Using Farenheit to avoid impact of 0 (or close to 0) temperature\r'GINIDOM(R%) = GINIDOM(R%) * SENVTEMP1(R%) / SENVTEMP2(R%) * envtemptoginidomel\r'jrs 2022/10/11 GINIDOM(R%) = CSng(GINIDOM(R%) * (9 / 5 * SENVTEMP1(R%) + 32) / (9 / 5 * SENVTEMP2(R%) + 32) * envtemptoginidomel)\r'jrs 2022/11/02 GINIDOM(R%) = CSng(GINIDOM(R%) * (1 + ((9 / 5 * SENVTEMP1(R%) + 32) / (9 / 5 * SENVTEMP2(R%) + 32) - 1) * envtemptoginidomel))\rGINIDOM(R%) = CSng(GINIDOM(R%) * (1 + (SENVTEMP1(R%) / If(IENVTEMP(R%) = 0, 0.01, IENVTEMP(R%)) - 1) * envtemptoginidomel))\rEnd If\rCase 3 'U shape (in reality inverted U shape) jrs 2022/09/30\rDim Delta, Delta2 As Single\r'jrs 2022/08/05 Call XYTABL(\"Temperature Versus Change in Log of 1 - Domestic Gini\", SENVTEMP1(R%), Delta, context)\r'Delta (LN(1-GINI)) = LN(1-GINI_new) - LN(1-GINI)\r'Delta = LN ((1-GINI_NEW)/(1-GINI))\r'EXP(Delta) = (1-GINI_NEW)/(1-GINI)\r'1 - GINI_NEW = EXP(Delta) * (1 - GINI)\r'GINI_NEW = 1 - EXP(Delta) * (1 - GINI)\r'GINIDOM(R%) = CSng(1 - Exp(Delta) * (1 - GINIDOM(R%)))\rIf IY > 2 Then\rCall XYTABL(\"Temperature Versus Change in Domestic Gini\", SENVTEMP1(R%), Delta, context)\rCall XYTABL(\"Temperature Versus Change in Domestic Gini\", SENVTEMP2(R%), Delta2, context)\r'Delta = GINI_new - GINI\r'GINI_new = GINI + Delta\rGINIDOM(R%) = GINIDOM(R%) + (Delta - Delta2)\rEnd If\rCase 4 'Absolute Elasticity, Halligate\r'jrs 2023/03/13\rIf IY > 2 Then\r'jrs 2023/05/11 GINIDOM(R%) = GINIDOM(R%) + (SENVTEMP1(R%) - IENVTEMP(R%)) * envtemptoginidomel\rIf XGINIDOMLOAD(R%) Then\rGINIDOM(R%) = XGINIDOM(R%) + (SENVTEMP1(R%) - XENVTEMP(R%)) * envtemptoginidomel\rEnd If\rEnd If\rCase 5 'jrs 2023/05/02 Paglialunga\rIf XGINIDOMLOAD(R%) Then\rGINIDOM(R%) = CSng(XGINIDOM(R%) + (SENVTEMP1(R%) / If(XENVTEMP(R%) = 0, 0.01, XENVTEMP(R%)) - 1) * envtemptoginidomel)\rEnd If\rCase 6 'jrs 2023/05/09\rIf XGINIDOMLOAD(R%) Then\rGINIDOM(R%) = CSng(XGINIDOM(R%) + (STSCALED(R%) / If(XTSCALED(R%) = 0, 0.01, XTSCALED(R%)) - 1) * envtemptoginidomel)\rEnd If\rEnd Select\r"
  },
  {
    "Variable": "GINIDOM",
    "UsesVariable": "SFCIVILWARUCDP",
    "Distance": 1,
    "Code": "\r'jrs 2021/09/29 end adding ginidomcnstsw\r\r'jrs 2022/05/23\r'Conflict to Gini relationship, Bircan says is 2% increase in inequality per conflict\rIf sfintlwaralltoginidom(R%) <> 1 Then\rDim Factor As Single\r'jrs 2024/05/20\rIf sfcivilwarucdpsw = 0 Then\rFactor = (sfintlwaralltoginidom(R%) - 1) * SFINTLWARALL(R%)\rElse\rFactor = (sfintlwaralltoginidom(R%) - 1) * SFCIVILWARUCDP(R%)\rEnd If\rGINIDOM(R%) = GINIDOM(R%) * (1 + Factor)\rEnd If\r"
  },
  {
    "Variable": "GINIDOM",
    "UsesVariable": "sfcivilwarucdpsw",
    "Distance": 1,
    "Code": "\r'jrs 2021/09/29 end adding ginidomcnstsw\r\r'jrs 2022/05/23\r'Conflict to Gini relationship, Bircan says is 2% increase in inequality per conflict\rIf sfintlwaralltoginidom(R%) <> 1 Then\rDim Factor As Single\r'jrs 2024/05/20\rIf sfcivilwarucdpsw = 0 Then\rFactor = (sfintlwaralltoginidom(R%) - 1) * SFINTLWARALL(R%)\rElse\rFactor = (sfintlwaralltoginidom(R%) - 1) * SFCIVILWARUCDP(R%)\rEnd If\rGINIDOM(R%) = GINIDOM(R%) * (1 + Factor)\rEnd If\r"
  },
  {
    "Variable": "GINIDOM",
    "UsesVariable": "ginidomr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GINIDOM",
    "UsesVariable": "HHINC",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "GINIDOM",
    "UsesVariable": "HHPOP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "GINIFULL",
    "UsesVariable": "GDPPCP",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "GINIFULL",
    "UsesVariable": "POP",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "GINIFULL",
    "UsesVariable": "GINIDOM",
    "Distance": 19,
    "Code": "0"
  },
  {
    "Variable": "GLDCAP",
    "UsesVariable": "LVHERD",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GLDCAP",
    "UsesVariable": "FEDDEM",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GLDCAP",
    "UsesVariable": "LD",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GLDCAP",
    "UsesVariable": "GDPPCP",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "GLOBALIZ",
    "UsesVariable": "ECONINTEG",
    "Distance": 0,
    "Code": "\r'Call ScaleMe(ECONINTEG)\rCall ScaleMeOrig(PERSCON, PersConI)\r\r'     All Steps:  Political Engagement\r'     --------------------------------\r'jrs 2014/04/11 moved to first year *** begin ***\r'          SumODA = 0\r'          For R% = 1 To NR%\r'            SumODA = SumODA + Abs(AID(R%))\r'          Next R%\r'          If IY% = 1 Then AidBenchI = SumODA / WGDP\r'jrs 2014/04/11 moved to first year *** end ***\r'ttt 2019/10/08 TakeOut\rArray.Copy(INFRANET, ScaleInfranet, NR + 1)\rFor R% = 1 To NR%\rPolEngage(R%) = (Abs(AID(R%) / GDPPOT(R%))) / AidBenchI * 100\rPolEngage(R%) = Amin(200, PolEngage(R%))\r'ttt 2019/10/08 TakeOut ScaleInfranet(R%) = INFRANET(R%)\rNext R%\r\r'Call ScaleMe(ECONINTEG)\rCall ScaleMeOrig(PERSCON, PersConI)\r\r'     All Steps:  Political Engagement\r'     --------------------------------\r'jrs 2014/04/11 moved to first year *** begin ***\r'          SumODA = 0\r'          For R% = 1 To NR%\r'            SumODA = SumODA + Abs(AID(R%))\r'          Next R%\r'          If IY% = 1 Then AidBenchI = SumODA / WGDP\r'jrs 2014/04/11 moved to first year *** end ***\r'ttt 2019/10/08 TakeOut\rArray.Copy(INFRANET, ScaleInfranet, NR + 1)\rFor R% = 1 To NR%\rPolEngage(R%) = (Abs(AID(R%) / GDPPOT(R%))) / AidBenchI * 100\rPolEngage(R%) = Amin(200, PolEngage(R%))\r'ttt 2019/10/08 TakeOut ScaleInfranet(R%) = INFRANET(R%)\rNext R%\r\rFor R% = 1 To NR%\r'GLOBALIZ(R%) = (PolEngage(R%) + INFRAIMOD(R%) + ECONINTEG(R%) + PERSCON(R%)) / 4\rGLOBALIZ(R%) = (PolEngage(R%) + ScaleInfranet(R%) + ECONINTEG(R%) + PERSCON(R%)) / 4\r'If RegName$(R%) = \"Austria\" Then Stop\r\rSumGlobal = SumGlobal + GLOBALIZ(R%) * POP(R%)\rNext R%\r"
  },
  {
    "Variable": "GLOBALIZ",
    "UsesVariable": "PERSCON",
    "Distance": 0,
    "Code": "\r'Call ScaleMe(ECONINTEG)\rCall ScaleMeOrig(PERSCON, PersConI)\r\r'     All Steps:  Political Engagement\r'     --------------------------------\r'jrs 2014/04/11 moved to first year *** begin ***\r'          SumODA = 0\r'          For R% = 1 To NR%\r'            SumODA = SumODA + Abs(AID(R%))\r'          Next R%\r'          If IY% = 1 Then AidBenchI = SumODA / WGDP\r'jrs 2014/04/11 moved to first year *** end ***\r'ttt 2019/10/08 TakeOut\rArray.Copy(INFRANET, ScaleInfranet, NR + 1)\rFor R% = 1 To NR%\rPolEngage(R%) = (Abs(AID(R%) / GDPPOT(R%))) / AidBenchI * 100\rPolEngage(R%) = Amin(200, PolEngage(R%))\r'ttt 2019/10/08 TakeOut ScaleInfranet(R%) = INFRANET(R%)\rNext R%\r"
  },
  {
    "Variable": "GLOBALIZ",
    "UsesVariable": "AID",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "GLOBALIZ",
    "UsesVariable": "GDPPOT",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "GLOBALIZ",
    "UsesVariable": "WGDP",
    "Distance": 154,
    "Code": "0"
  },
  {
    "Variable": "GOVBAL",
    "UsesVariable": "GOVREV",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GOVBAL",
    "UsesVariable": "GOVEXP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GOVBUSCOST",
    "UsesVariable": "govbuscostm",
    "Distance": 0,
    "Code": "\rGOVBUSCOST(R%) = AMAX(1, Amin(300, GOVBUSCOST(R%) * govbuscostm(R%)))\r"
  },
  {
    "Variable": "GOVBUSCOST",
    "UsesVariable": "GDPPCP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "GOVBUSREGIND",
    "UsesVariable": "govbusregindm",
    "Distance": 0,
    "Code": "\rGOVBUSREGIND(R%) = AMAX(0.01, Amin(10, GOVBUSREGIND(R%) * govbusregindm(R%)))\r"
  },
  {
    "Variable": "GOVBUSREGIND",
    "UsesVariable": "GDPPCP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "IGCF",
    "Distance": 1,
    "Code": "\rIf GDPPOTRPA(R%) < 0.001 Then GDPPOTRPA(R%) = 0.001\r\rIf IGCF(R%) < 0.05 * GDPPOTRPA(R%) Then\rDecreaseG = CSng(Amin(0.05 * GDPPOTRPA(R%) - IGCF(R%), 0.3 * GOVCON(R%)))\rGOVCON(R%) = GOVCON(R%) - DecreaseG\rIGCF(R%) = IGCF(R%) + DecreaseG\rEnd If\r\rIf IGCF(R%) < 0.05 * GDPPOTRPA(R%) Then\rDecreaseG = CSng(Amin(0.05 * GDPPOTRPA(R%) - IGCF(R%), 0.3 * GOVCON(R%)))\rGOVCON(R%) = GOVCON(R%) - DecreaseG\rIGCF(R%) = IGCF(R%) + DecreaseG\rEnd If\r"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "GDPRPA",
    "Distance": 162,
    "Code": "0"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "elasit",
    "Distance": 162,
    "Code": "\r'If RegName$(R%) = \"Unitd Kingdm\" Then Stop\r\r\r'   All but First 2:  Adjustments to Intersectoral Flows with Ag Model Computations and Recomputation of ZS, VADD\r'       (for Stock Base and Capacity Utilization)\r'   ------------------------------------------------------\r\rFor column% = 1 To NSec%\rints(R%, column%) = 0!\rintsp = 0!\rFor row = 1 To NSec%\r'If IY% + 2016 = 2018 And RegName$(R%) = \"United States of America\" And row = 2 And column% = 5 Then Stop    'AgINTSFlows\r'If IY% + 2016 = 2020 And RegName$(R%) = \"United States of America\" And row = 2 And column% = 5 Then Stop\rintsp = intsp + AMat(R%, row, column%)\rNext row\rcond = (column% > Ener) Or\r                                (column% = Agri And agon < 0.9) Or (column% = Ener And enon < 0.9)\rintsp = CSng(Amin(0.95, intsp))\rIf cond Then\rZS(R%, column%) = VADD(R%, column%) / (1 - intsp)\rElse\rVADD(R%, column%) = ZS(R%, column%) * (1 - intsp) 'ZS from sectoral models\rEnd If\rFor row = 1 To NSec%\rints(row, column%) = ZS(R%, column%) * AMat(R%, row, column%)\r'If IY% + 2016 = 2018 And RegName$(R%) = \"United States of America\" And row = 2 And column% = 5 Then Stop\r'If IY% + 2016 = 2040 And RegName$(R%) = \"United States of America\" And row = 2 And column% = 5 Then Stop\rNext row\r\rzsp(R%, column%) = ZS(R%, column%)\rGDPPOT(R%) = GDPPOT(R%) + VADD(R%, column%)\rGDPPOTRPA(R%) = GDPPOTRPA(R%) + VADD(R%, column%) * SWP(column%)\rNext column%\r"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "VADD",
    "Distance": 821,
    "Code": "0"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "WP",
    "Distance": 821,
    "Code": "0"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "aidrecgovconp",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "AID",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "XWBFLOWS",
    "Distance": 0,
    "Code": "\r\r'bbh 2019/10/15 end\r\r'   First Year 2:  Saves from other routines\r'   ----------------------------------------\r\rgovconwbi(R%) = xwbflowsI(R%, 1) + xwbflowsI(R%, 2) 'Save WB increment to Educ and Health\r\r\r'If RegName$(R%) = \"Ethiopia\" And IY% >= 11 Then Stop\r'I switched to the formulation immediately above in order to get some responsiveness to\r'   govt debt on the consumtion side, not just the revenue side.  I learned: (1) it makes little difference\r'   because govrevm is much more responsive to gdebt/gdp than is govexpm (as it should be, we don't want\r'   to throw around govcon too much; for South Africa the impacts were about 5 to 1 govrev\r'   But govbal becomes somewhat unstable near 2100 in the old formulation and even a bit more in the new\r'       so need to watch and probably fix that.\r\rGOVCON(R%) = GOVCON(R%) - govconwbi(R%) + XWBFLOWS(R%, 1) + XWBFLOWS(R%, 2)\r"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "govconm",
    "Distance": 0,
    "Code": "\r\r'If RegName$(R%) = \"Bangladesh\" And IY% + 2016 >= 2025 Then Stop\rGOVCON(R%) = GOVCON(R%) * govconm(R%) 'BBH 2017/05/23\r"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "govexpm",
    "Distance": 0,
    "Code": "\rGOVCON(R%) = GOVCON(R%) * govexpm(R%) * mulexp(R%)\r"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "gdprext",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "GDPR",
    "Distance": 0,
    "Code": "\r'bbh 2022/08/22 put next line inside if-then\rIf gdprext(R%) < -50 Then 'when outside of exogenous growth period, bound relative to GDP growth\r'Note: at this point GDPR is decimal rate, not %; gdprext is %\rGOVCON(R%) = Amin(GOVCON(R%), SGOVCON(R%) * (1 + GDPR(R%) * 2))  'also to prevent too much pass through of\r'oil revenues, too quickly, to government spending; pass faster to transfers\rElse 'inside gdprext period put max rise on top of gdprext; recognizes Libya has 177% GDP bump 1 year\rGOVCON(R%) = Amin(GOVCON(R%), SGOVCON(R%) * (1 + gdprext(R%) / 100 + 0.06!))\rEnd If\r"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "GDP",
    "Distance": 1980,
    "Code": "0"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "wagnerc",
    "Distance": 0,
    "Code": "\r'GOVCON(R%) = GOVCON(R%) + immadj\r\r'mti test\r'wagnerc = 0.1\r\rGOVCON(R%) = AMAX(3, Amin(90, GOVCON(R%) * (1 + IY% * wagnerc / 100)))\r"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "ST",
    "Distance": 313,
    "Code": "\rExcessSt(R%) = 0\r"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "dstl",
    "Distance": 313,
    "Code": "\r\r'   First Year: Compute Initial Stocks and Recompute Stock Ratio\r'       Based on Computed VADD\r'   ------------------------------------------------------------\rFor S% = 1 To NSec%\rims(R%, S%) = MS(R%, S%)\r'bbh 2020/08/03 Start; need to switch stock base from ZS to VADD because over time\r'   the ratio of ZS/VADD changes (in China manufacturing almost doubles); VADD/PFD more stable\r'   Perhaps should even be PFD given the close link of PFD to stock accummulation\r'   Problem with ZS is that over time the swings of ST and CAPUT become reinforcing and very large\rStBase(R%, S%) = ZS(R%, S%) + ims(R%, S%)\r'StBase(R%, S%) = PFD(R%, S%) + ims(R%, S%) 'bbh 2022/10/27\rMovAvgMS(R%, S%) = ims(R%, S%) 'bbh 2022/10/27\r'StBase(R%, S%) = VADD(R%, S%) + ims(R%, S%)\r'bbh 2020/08/03 end\rSMS(R%, S%) = MS(R%, S%) 'bbh 2019/09/13\r\r'mti 2018/10/01 Start\r'            sms(R%, S%) = MS(R%, S%)\r'            StBase(R%, S%) = ZS(R%, S%) + sms(R%, S%)\r'mti 2018/10/01 End\r\rST(R%, S%) = StBase(R%, S%) * dstl\rNext S%\r\rFor S% = 1 To NSec%\r'If RegName$(R%) = \"China\" And S% = 2 Then Stop\r\r'bbh 2020/08/03 Start\rStBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%) 'bbh 2021/09/30 ims DOES NOT grow and fixed causes problems, e.g. Vietnam materials\r'StBase(R%, S%) = PFD(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%) 'bbh 2022/10/27\r'StBase(R%, S%) = PFD(R%, S%) + MovAvgMS(R%, S%) 'bbh 2022/10/27 Replaced line above for more control over import contribution to stock need\r'StBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) 'bbh 2021/09/21 ims itself grows; GTPPOT/GDPI was causing problems\r'for countries like China with large stock demands\r'StBase(R%, S%) = VADD(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%)\r'bbh 2020/08/03 end\r\r'mti 2018/10/01 Start\r'            StBase(R%, S%) = zsp(R%, S%) + sms(R%, S%)\r'mti 2018/10/01 End\rIf ((S% > Ener) OrElse (S% = Agri AndAlso agon < 0.9) OrElse (S% = Ener AndAlso enon < 0.9)) Then\rDiff1 = SST(R%, S%) - dstl * StBase(R%, S%)\r'Diff2 = sst(R%, S%) - SSTS(R%, S%) * (1! + igdpr(R%))\rDiff2 = SST(R%, S%) - SSTS(R%, S%) * (1.0! + igdprcor(R%))\rCall ADJSTR(StBase(R%, S%), Diff1, Diff2, elinst1, elinst2, Mul)\r'mti 2018/07/02 Start\rIDS(R%, S%) = IGCF(R%) * IDK(R%, S%) * idsm(R%, S%) * Mul\r'mti 2018/07/02 End\rEnd If\rMinIDS = IDK(R%, S%) * IGCF(R%) * 0.5!\r'If GRPS(1, R%) = \"Guinea Bissau\" And S% = 2 And IY >= 7 Then Stop\rIDS(R%, S%) = AMAX(MinIDS, Amin(IDS(R%, S%), IGCF(R%)))\r\r\r\rIf S% = 1 Then\rIDS(R%, S%) = CSng(Amin(IGCF(R%) * 0.3, Amin(IGCF(R%) * sidk(R%, S%) * 2.5, IDS(R%, S%))))\r'If RegName$(R%) = \"Congo, Democratic Republic Of\" And IY% >= 50 Then Stop\rEnd If\rIf S% = 2 Then\r'jrs 2022/04/18\r'if IGCF(R%) * sidk(R%, S%) > 0.1 then\r'jrs 2022/05/02 If GRPS(1, R%) <> \"Guinea Bissau\" Or context.HistoricMode = True Then\rIf ennoprodsw(R%) = 0 Or context.HistoricMode = True Then\rIDS(R%, S%) = CSng(Amin(IGCF(R%) * 0.5, Amin(IGCF(R%) * sidk(R%, S%) * 3, IDS(R%, S%))))\rEnd If\rEnd If\r\rtids = tids + IDS(R%, S%)\rNext S%\r"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "GDPPOT",
    "Distance": 466,
    "Code": "\rims(R%, S%) = MS(R%, S%)\r\r'If RegName$(R%) = \"Unitd Kingdm\" Then Stop\r\r\r'   All but First 2:  Adjustments to Intersectoral Flows with Ag Model Computations and Recomputation of ZS, VADD\r'       (for Stock Base and Capacity Utilization)\r'   ------------------------------------------------------\r\rFor column% = 1 To NSec%\rints(R%, column%) = 0!\rintsp = 0!\rFor row = 1 To NSec%\r'If IY% + 2016 = 2018 And RegName$(R%) = \"United States of America\" And row = 2 And column% = 5 Then Stop    'AgINTSFlows\r'If IY% + 2016 = 2020 And RegName$(R%) = \"United States of America\" And row = 2 And column% = 5 Then Stop\rintsp = intsp + AMat(R%, row, column%)\rNext row\rcond = (column% > Ener) Or\r                                (column% = Agri And agon < 0.9) Or (column% = Ener And enon < 0.9)\rintsp = CSng(Amin(0.95, intsp))\rIf cond Then\rZS(R%, column%) = VADD(R%, column%) / (1 - intsp)\rElse\rVADD(R%, column%) = ZS(R%, column%) * (1 - intsp) 'ZS from sectoral models\rEnd If\rFor row = 1 To NSec%\rints(row, column%) = ZS(R%, column%) * AMat(R%, row, column%)\r'If IY% + 2016 = 2018 And RegName$(R%) = \"United States of America\" And row = 2 And column% = 5 Then Stop\r'If IY% + 2016 = 2040 And RegName$(R%) = \"United States of America\" And row = 2 And column% = 5 Then Stop\rNext row\r\rzsp(R%, column%) = ZS(R%, column%)\rGDPPOT(R%) = GDPPOT(R%) + VADD(R%, column%)\rGDPPOTRPA(R%) = GDPPOTRPA(R%) + VADD(R%, column%) * SWP(column%)\rNext column%\r"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "ZS",
    "Distance": 2303,
    "Code": "0"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "MS",
    "Distance": 2144,
    "Code": "0"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "govfinconv",
    "Distance": 0,
    "Code": "\rgovconr(R%) = AMAX(0.2, Amin(5, govconr(R%)))\r\rIf context.HistoricMode Then\r'bbh 2014/05/11 Start\rTbName$ = \"GDP/Capita (PPP) Versus Govt Consumption (1960)\"\rCall XYTABL(TbName$, GDPPCP(R%), GovtConsum, context)\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Govt Exp Educ as % of GDP (1960) - log\", _\r'               Amin(40, GDPPCP(R%)), edexpcomp)\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Govt Exp Hlth as % of GDP (1990) - log\", _\r'               Amin(40, GDPPCP(R%)), HlExpComp)\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Govt Exp R&D as % of GNP (2000) - linear\", _\r'               Amin(40, GDPPCP(R%)), rdexpcomp)\r'            'Call XYTABL(\"GDP/Capita (PPP) Versus R&D Total  as % of GNI (1980) - linear\", _\r'               Amin(40, GDPPCP(R%)), rdexpcomp)\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Govt Exp Mil as % of GDP (1965) - linear\", _\r'                Amin(40, GDPPCP(R%)), MlExpComp)\r'            GovtConsum = edexpcomp + HlExpComp + rdexpcomp + MlExpComp + OtExpComp(R%)\r'bbh 2014/05/11 end\rElse\r'If RegName(R%) = \"Benin\" Then Stop\r\r'            TBName$ = \"GDP/Capita (PPP) Versus Govt Consumption (1995)\"\r'bbh 2014/05/11 Start   Switching over from bottom up GDS to top down GOVCON\r'       In part becuase never had added infrastructure anyway\r\r'\rTbName$ = \"GDP/Capita (PPP) Versus Govt Consumption (2010) Forecast\"\r\rCall XYTABL(TbName$, GDPPCP(R%), GovtConsum, context)\r'\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Govt Exp Educ as % of GDP (2002) - log\", _\r'               Amin(40, GDPPCP(R%)), edexpcomp)\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Govt Exp Hlth as % of GDP (2000) - log\", _\r'               Amin(40, GDPPCP(R%)), HlExpComp)\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Govt Exp R&D as % of GNP (2000) - linear\", _\r'               Amin(40, GDPPCP(R%)), rdexpcomp)\r'            'Call XYTABL(\"GDP/Capita (PPP) Versus R&D Total  as % of GNI (2000) - linear\", _\r'               Amin(40, GDPPCP(R%)), rdexpcomp)\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Govt Exp Mil as % of GDP (2000) - linear\", _\r'                Amin(40, GDPPCP(R%)), MlExpComp)\r'            GovtConsum = edexpcomp + HlExpComp + rdexpcomp + MlExpComp + OtExpComp(R%)\r'bbh 2014/05/11 End\rEnd If\r\rGOVCON(R%) = ConvergeOverTimeRate(GovtConsum * govconr(R%), GovtConsum, CInt(govfinconv))\r"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "GDPPCP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "GOVEXP",
    "Distance": 0,
    "Code": "\r'mti June 16 2013 -start\r'If GOVHHTRN(R%) < 0 Then\rIf GOVHHTRN(R%) < -0.000001 Then\r'mti June 16 2013 -end\rDim msg As String\rmsg$ = \"GOVCON is greater than GOVEXP for \" + GRPS(1, R%)\rmsg$ = msg$ +\r                \" This should be fixed in preprocessor; GOVCON set at 90% of GOVEXP\"\rDebug.Print(msg$)\rGOVCON(R%) = CSng(GOVEXP(R%) * 0.9)\rGOVHHTRN(R%) = GOVEXP(R%) - GOVCON(R%)\r' sgovhhtrn(R%) = GOVHHTRN(R%) 'bbh 2015/03/28\rEnd If\r"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "GS",
    "Distance": 0,
    "Code": "\r'If GRPS(1, R) = \"Sudan South\" Then Stop\rFor S% = 1 To NSec%\rtef(R%, S%) = 1\r\r'mti October 03, 2011 -start\rTEFF(R%, S%) = tef(R%, S%)\r'mti October 03, 2011 - end\r\r'   First Year:  Expenditure Sums\r'   -----------------------------\rC(R%) = C(R%) + CS(R%, S%)\rGOVCON(R%) = GOVCON(R%) + GS(R%, S%)\r'If RegName$(R%) = \"China\" Then Stop\rI(R%) = I(R%) + INVS(R%, S%)\rCAPUT(R%, S%) = caputtar\r'SCAPUT(r%, s%) = caputtar 'bbh 2020/07/15\rNext S%\r\rGOVCON(R%) = AMAX(0.001, GOVCON(R%))\r"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "govconswing",
    "Distance": 0,
    "Code": "\r'If IY = 29 And R = 95 Then Stop\r'If RegName(R%) = \"Brazil\" Then Stop\r\r'mti 2016/07/16 start\r'Adjust govcon only when there is shortage\rIf GTOT > GOVCON(R%) Then GOVCON(R%) = GOVCON(R%) * (1 - govconswing) + GTOT * govconswing\r\rGOVCON(R%) = 0!\r"
  },
  {
    "Variable": "GOVCON",
    "UsesVariable": "GDS",
    "Distance": 1,
    "Code": "\r'mti 2016/07/16 end\r\r'Normalization of all GDS to GOVCON\r\r'Total Fund Needs\rGTOT = 0\r\rFor S% = 1 To NGovExp%\r'jrs 2021/09/09\rIf gdscnstsw(R%, S%) = 0 Then\rGDS(R%, S%) = AMAX(0, Amin(GOVCON(R%), GDS(R%, S%)))\rEnd If\rGTOT = GTOT + GDS(R%, S%)\rNext S%\r"
  },
  {
    "Variable": "GOVCORRUPT",
    "UsesVariable": "govcorruptm",
    "Distance": 0,
    "Code": "\r'bbh 2011/10/08 start\r'dkb 2013/09/18 added dimension 1 to goveffectsetar and goveffectseyrtar\rIf govcorruptsetar(R%) <> 0 Then\rEffectSE = StdErrorAdditiveShift(SE, CSng(Prediction), CSng(CorruptAdd), CSng(GovCorruptAdd(R%)),\r                    CSng(govcorruptsetar(R%)), CInt(FirstYear + govcorruptseyrtar(R%)), FirstYear + IY - 1, FirstYear)\rEnd If\r\r'To be compatible Economy; have used simpler function for DataEcon hole filling\rCorruptAdd = ConvergeOverTime(GovCorruptAdd(R%), 0, goveffconv)\r\r\r\r'bbh 2011/04/30 end\rIf confforsw = 1 Then\rPrediction = CSng(Prediction - 0.5 * ssfintlwarallLoc(R%))\rEnd If\r\rGOVCORRUPT(R%) = AMAX(1, Amin(10, (Prediction + CorruptAdd + EffectSE) * govcorruptm(R%)))\r"
  },
  {
    "Variable": "GOVCORRUPT",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GOVCORRUPT",
    "UsesVariable": "confforsw",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "GOVCORRUPT",
    "UsesVariable": "goveffconv",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "GOVCORRUPT",
    "UsesVariable": "govcorruptsetar",
    "Distance": 1,
    "Code": "\r\r'To be compatible Economy; have used simpler function for DataEcon hole filling\rGovCorruptAdd(R%) = GOVCORRUPT(R%) - Prediction\r\r'To be compatible Economy; have used simpler function for DataEcon hole filling\rCorruptAdd = ConvergeOverTime(GovCorruptAdd(R%), 0, goveffconv)\r\r\r\r'bbh 2011/04/30 end\rIf confforsw = 1 Then\rPrediction = CSng(Prediction - 0.5 * ssfintlwarallLoc(R%))\rEnd If\r"
  },
  {
    "Variable": "GOVCORRUPT",
    "UsesVariable": "govcorruptseyrtar",
    "Distance": 1,
    "Code": "\r\r'To be compatible Economy; have used simpler function for DataEcon hole filling\rGovCorruptAdd(R%) = GOVCORRUPT(R%) - Prediction\r"
  },
  {
    "Variable": "GOVCORRUPT",
    "UsesVariable": "GDPPCP",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "GOVCORRUPT",
    "UsesVariable": "DEMOCPOLITY",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "GOVCORRUPT",
    "UsesVariable": "GEM",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "GOVCORRUPT",
    "UsesVariable": "ENX",
    "Distance": 42,
    "Code": "0"
  },
  {
    "Variable": "GOVCORRUPT",
    "UsesVariable": "ENPRI",
    "Distance": 42,
    "Code": "0"
  },
  {
    "Variable": "GOVCORRUPT",
    "UsesVariable": "GDP",
    "Distance": 42,
    "Code": "0"
  },
  {
    "Variable": "GOVDEBT",
    "UsesVariable": "GDPRPA",
    "Distance": 0,
    "Code": "\r\r'mti 2016/09/19 test n'bbh2017/05/23 Set loan portion of aid to 15%\r\r'bbh 2020/08/18 start revert the logic here from fixed 0.15 share in code to aidlp, allowing multipliers to work\r'removed old comments\rIf AID(R%) > 0 Then sgovdebtabs(R%) = sgovdebtabs(R%) + aidlp(R%) * AID(R%)\r\r'If AID(R%) > 0 Then sgovdebtabs(R%) = sgovdebtabs(R%) + 0.15 * AID(R%)\r''bbh 2020/08/18 end\r\r\r'Govt Debt is positive, assets are negative\r'If AID(R%) > 0 Then 'Recipient\r'    sgovdebtabs(R%) = sgovdebtabs(R%) - GrantPortion\r'GrantPortion to recipients does not create a liability\r'Since was added to GovBal(-) and subtraced from debt,\r'back out; subtracting positive from debt, reduces liabilities\r'Else 'Donor\r'    sgovdebtabs(R%) = sgovdebtabs(R%) - GrantPortion\r'GrantPortion from donors does not create an asset\r'Since all was added to GovRev and then GovBal, back out\r'Subtracting grant portion (a negative, resulting in addition,\r'   increases net debt\r'End If\r'Note on treatment of grant portion:  since aidlp applies to\r'total aid flows and to the equal value of aid receipts, this\r'treatment balance global balance of debt and liabilities; but\r'if loan/grant portions become specific to country, will need\r'more complicated allocation\r'Also, should put loan portions of aid into subcategory of govt\r'debt for intl payment\r'Have moved all of this GrantPortion logic to IFsIntlEco where it\r'explicitly affects govt intl debt and total intl debt/assets\r'Ultimately will want external govt debt to come back to total govt debt, but\r'as set up now such debt affects govt Rev and Exp, but not GOVCON; this\r'can result in reduction of govt debt raising GovExp and actually crowding\r'out GOVCON as well as IGCF, both negatively affecting economic growth\r\r'bbh 2020/07/23 start including removal of comment and extra term below\rGOVDEBT(R%) = sgovdebtabs(R%) / AMAX(0.001, GDPRPA(R%)) * 100 '+ govdebtchg(R%) / 100 * GDP(R%)\r"
  },
  {
    "Variable": "GOVDEBT",
    "UsesVariable": "aidlp",
    "Distance": 1,
    "Code": "\r'If RegName$(R%) = \"Liberia\" Then Stop\r'If AID(R%) < 0 Then GOVBAL(R%) = GOVBAL(R%) + AID(R%) 'Donations\r'GOVBAL(R%) = GOVBAL(R%) + AID(R%) + XIMFCRFIN(R%) - XWBLNFIN(R%) - XIMFCRFOUT(R%) - XWBLNFOUT(R%)\r'bbh 2022/12/20 Change sign on XWBLNFIN, which was wrong above; but then comment out because net was moved to AggRev Calc\r'GOVBAL(R%) = GOVBAL(R%) + XIMFCRFIN(R%) + XWBLNFIN(R%) - XIMFCRFOUT(R%) - XWBLNFOUT(R%)\r'bbh 2020/07/01 end\rsgovdebtabs(R%) = GOVDEBT(R%) * GDP(R%) / 100\r\r\r'bbh 2017/05/23  AID donation is already port of GOVEXP\r'If AID(R%) < 0 Then GOVBAL(R%) = GOVBAL(R%) + AID(R%) 'Donations\r\r'GrantPortion = AID(R%) * (1 - aidlp)\r'bbh 2017/05/23 AID is aleady part of revenues from IGOs and transfers to them\r'GOVBAL(R%) = GOVBAL(R%) - XIMFCRFOUT(R%) - XWBLNFOUT(R%)\r\r'    If RegName(R%) = \"United States of America\" Then Stop\r'bbh 2020/07/23 addition of exogenous term; strange to mix GDPRPA and GDP here and perhaps should\r' reconsider GDPRPA; but if users set govdebtchg at some level of GDP, will want to see that change in it\rsgovdebtabs(R%) = sgovdebtabs(R%) - GOVBAL(R%) + govdebtchg(R%) / 100 * GDP(R%)\r"
  },
  {
    "Variable": "GOVDEBT",
    "UsesVariable": "AID",
    "Distance": 1,
    "Code": "\r'If RegName$(R%) = \"Liberia\" Then Stop\r'If AID(R%) < 0 Then GOVBAL(R%) = GOVBAL(R%) + AID(R%) 'Donations\r'GOVBAL(R%) = GOVBAL(R%) + AID(R%) + XIMFCRFIN(R%) - XWBLNFIN(R%) - XIMFCRFOUT(R%) - XWBLNFOUT(R%)\r'bbh 2022/12/20 Change sign on XWBLNFIN, which was wrong above; but then comment out because net was moved to AggRev Calc\r'GOVBAL(R%) = GOVBAL(R%) + XIMFCRFIN(R%) + XWBLNFIN(R%) - XIMFCRFOUT(R%) - XWBLNFOUT(R%)\r'bbh 2020/07/01 end\rsgovdebtabs(R%) = GOVDEBT(R%) * GDP(R%) / 100\r"
  },
  {
    "Variable": "GOVDEBT",
    "UsesVariable": "GOVBAL",
    "Distance": 2,
    "Code": "\r'If RegName$(R%) = \"Liberia\" Then Stop\r'If AID(R%) < 0 Then GOVBAL(R%) = GOVBAL(R%) + AID(R%) 'Donations\r'GOVBAL(R%) = GOVBAL(R%) + AID(R%) + XIMFCRFIN(R%) - XWBLNFIN(R%) - XIMFCRFOUT(R%) - XWBLNFOUT(R%)\r'bbh 2022/12/20 Change sign on XWBLNFIN, which was wrong above; but then comment out because net was moved to AggRev Calc\r'GOVBAL(R%) = GOVBAL(R%) + XIMFCRFIN(R%) + XWBLNFIN(R%) - XIMFCRFOUT(R%) - XWBLNFOUT(R%)\r'bbh 2020/07/01 end\rsgovdebtabs(R%) = GOVDEBT(R%) * GDP(R%) / 100\r"
  },
  {
    "Variable": "GOVDEBT",
    "UsesVariable": "govdebtchg",
    "Distance": 2,
    "Code": "\r'If RegName$(R%) = \"Liberia\" Then Stop\r'If AID(R%) < 0 Then GOVBAL(R%) = GOVBAL(R%) + AID(R%) 'Donations\r'GOVBAL(R%) = GOVBAL(R%) + AID(R%) + XIMFCRFIN(R%) - XWBLNFIN(R%) - XIMFCRFOUT(R%) - XWBLNFOUT(R%)\r'bbh 2022/12/20 Change sign on XWBLNFIN, which was wrong above; but then comment out because net was moved to AggRev Calc\r'GOVBAL(R%) = GOVBAL(R%) + XIMFCRFIN(R%) + XWBLNFIN(R%) - XIMFCRFOUT(R%) - XWBLNFOUT(R%)\r'bbh 2020/07/01 end\rsgovdebtabs(R%) = GOVDEBT(R%) * GDP(R%) / 100\r"
  },
  {
    "Variable": "GOVDEBT",
    "UsesVariable": "GDP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "GOVEFFECT",
    "UsesVariable": "goveffectm",
    "Distance": 0,
    "Code": "\r'bbh 2011/10/08 start\rIf goveffectsetar(R%) <> 0 Then\rEffectSE = StdErrorAdditiveShift(SE, CSng(Prediction), CSng(EffectAdd), CSng(GovEffectAdd(R%)),\r                    CSng(goveffectsetar(R%)), CInt(FirstYear + goveffectseyrtar(R%)), FirstYear + IY - 1, FirstYear)\rEnd If\r\rEffectAdd = ConvergeOverTime(GovEffectAdd(R%), 0, goveffconv) 'Base, Target, Years\r\rIf confforsw = 1 Then\rPrediction = CSng(Prediction - 0.08 * ssfintlwarallLoc(R%))\rEnd If\r\r'GOVEFFECT(R%) = AMAX(0, Amin(5, (Prediction + EffectAdd) * goveffectm(R%)))\rGOVEFFECT(R%) = AMAX(0, Amin(5, (Prediction + EffectAdd + EffectSE) * goveffectm(R%)))\r"
  },
  {
    "Variable": "GOVEFFECT",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GOVEFFECT",
    "UsesVariable": "confforsw",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "GOVEFFECT",
    "UsesVariable": "goveffconv",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "GOVEFFECT",
    "UsesVariable": "goveffectsetar",
    "Distance": 1,
    "Code": "\r\rGovEffectAdd(R%) = GOVEFFECT(R%) - Prediction\r\rEffectAdd = ConvergeOverTime(GovEffectAdd(R%), 0, goveffconv) 'Base, Target, Years\r\rIf confforsw = 1 Then\rPrediction = CSng(Prediction - 0.08 * ssfintlwarallLoc(R%))\rEnd If\r"
  },
  {
    "Variable": "GOVEFFECT",
    "UsesVariable": "goveffectseyrtar",
    "Distance": 1,
    "Code": "\r\rGovEffectAdd(R%) = GOVEFFECT(R%) - Prediction\r"
  },
  {
    "Variable": "GOVEFFECT",
    "UsesVariable": "GDPPCP",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "GOVEFFECT",
    "UsesVariable": "DEMOCPOLITY",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "GOVEFFECT",
    "UsesVariable": "ENX",
    "Distance": 48,
    "Code": "0"
  },
  {
    "Variable": "GOVEFFECT",
    "UsesVariable": "ENPRI",
    "Distance": 48,
    "Code": "0"
  },
  {
    "Variable": "GOVEFFECT",
    "UsesVariable": "GDP",
    "Distance": 48,
    "Code": "0"
  },
  {
    "Variable": "GOVEMBED",
    "UsesVariable": "GDPPCP",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "GOVEMBED",
    "UsesVariable": "GOVEXP",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "GOVEMBED",
    "UsesVariable": "GDP",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "GOVEMBED",
    "UsesVariable": "POWERHH",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "GOVEMBED",
    "UsesVariable": "wppowhhsw",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "GOVEXP",
    "UsesVariable": "GOVCON",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GOVEXP",
    "UsesVariable": "GOVHHTRN",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GOVHHPENT",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "\rIf GOVHHPENT(R%) > 0.2 * GDP(R%) Then\rGOVHHPENT(R%) = 0.2! * GDP(R%)\rSumPen = GOVHHTRNPEN(R%, Unskilled) + GOVHHTRNPEN(R%, Skilled)\rGOVHHTRNPEN(R%, Unskilled) = GOVHHTRNPEN(R%, Unskilled) * GOVHHPENT(R%) / SumPen\rGOVHHTRNPEN(R%, Skilled) = GOVHHTRNPEN(R%, Skilled) * GOVHHPENT(R%) / SumPen\rEnd If\r"
  },
  {
    "Variable": "GOVHHPENT",
    "UsesVariable": "GOVHHTRNPEN",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GOVHHPENT",
    "UsesVariable": "GOVHHTRN",
    "Distance": 0,
    "Code": "\r'jrs 2013/05/03\r'        GOVHHPENTND(R%) = GDPPC(R%) * POPRETIRED(R%)\r'jrs 2013/04/15 *** end ***\r\rGOVHHPENT(R%) = CSng(Amin(0.99 * GOVHHTRN(R%), GOVHHPENT(R%)))\r"
  },
  {
    "Variable": "GOVHHPENT",
    "UsesVariable": "GDPPC",
    "Distance": 0,
    "Code": "\r\r'   First Year:  Government Transfer Payments, Share of Pensions\r'   ------------------------------------------------------------\r'jrs 2013/04/15 *** begin ***\r'        If GOVHHPENT(R%) / POPGT65(R%) > GDPPC(R%) Then\r'            GOVHHPENT(R%) = GDPPC(R%) * POPGT65(R%)\r'        End If\r'jrs 2013/04/30\rIf POPRETIRED(R%) = 0 Then\rGOVHHPENT(R%) = 0\rElseIf GOVHHPENT(R%) / POPRETIRED(R%) > GDPPC(R%) Then\rGOVHHPENT(R%) = GDPPC(R%) * POPRETIRED(R%)\rEnd If\r"
  },
  {
    "Variable": "GOVHHPENT",
    "UsesVariable": "POPRETIRED",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRN",
    "UsesVariable": "GOVHHPENT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRN",
    "UsesVariable": "GOVHHTRNWEL",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRN",
    "UsesVariable": "VADD",
    "Distance": 605,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRN",
    "UsesVariable": "WP",
    "Distance": 605,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRN",
    "UsesVariable": "POP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRN",
    "UsesVariable": "GDP",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRN",
    "UsesVariable": "POPRETIRED",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRN",
    "UsesVariable": "GOVHHTRNPEN",
    "Distance": 1988,
    "Code": "\r'jrs 2013/04/12 RetirementPopAdd = POP15TO65(R%) * (1 - labretagem(R%))\rRetirementPopAdd = POPWORKING(R%) * (1 - labretagem(R%))\r"
  },
  {
    "Variable": "GOVHHTRN",
    "UsesVariable": "GDPPC",
    "Distance": 1818,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRN",
    "UsesVariable": "GDPPCP",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRN",
    "UsesVariable": "POPWORKING",
    "Distance": 10,
    "Code": "\rGDPPOTRPA(R%) = 0\r"
  },
  {
    "Variable": "GOVHHTRN",
    "UsesVariable": "labretagem",
    "Distance": 10,
    "Code": "\rGDPPOTRPA(R%) = 0\r"
  },
  {
    "Variable": "GOVHHTRN",
    "UsesVariable": "AID",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRN",
    "UsesVariable": "GOVCON",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRN",
    "UsesVariable": "aidrecgovconp",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRN",
    "UsesVariable": "govexpm",
    "Distance": 0,
    "Code": "\rGDPBASE = GDP(R%) + 0.5! * (GDPRPA(R%) - GDP(R%))\r\r\r\r'GOVHHTRN(R%) = GOVHHTRN(R%) / 100 * EGovExp * govexpm(R%) * mulexp(R%) 'From % to dollars\rGOVHHTRN(R%) = GOVHHTRN(R%) / 100 * GDPBASE * govexpm(R%) * mulexp(R%) 'From % to dollars\r"
  },
  {
    "Variable": "GOVHHTRN",
    "UsesVariable": "GDPRPA",
    "Distance": 15,
    "Code": "\rmulexp(R%) = 1\r"
  },
  {
    "Variable": "GOVHHTRN",
    "UsesVariable": "wagnerc",
    "Distance": 0,
    "Code": "\r\r'Base, Target, Years\rGOVHHTRN(R%) = AMAX(0, Amin(40, GOVHHTRN(R%) * (1 + IY% * wagnerc / 100)))\r"
  },
  {
    "Variable": "GOVHHTRN",
    "UsesVariable": "govfinconv",
    "Distance": 0,
    "Code": "\r'mti 2016/09/09 End\r\r\r'mti test\r'govhhtrnr(R%) = AMAX(0.2, Amin(5, govhhtrnr(R%)))\rgovhhtrnr(R%) = AMAX(0.01, Amin(5, govhhtrnr(R%)))\r\r'Call XYTABL(TbName$, GDPPCP(R%) * 1000, govttrans)\r'mti 2016/09/09 End\r'If RegName$(R%) = \"Zimbabwe\" Then Stop\r\r'mti 2018/12/06 start\r'govttrans = AMAX(0, govttrans)\rgovttrans = AMAX(0.25, govttrans)\r\r'mti 2018/12/06 End\r'    If RegName(R%) = \"Zimbabwe\" Then Stop\r\r'EGovExp = SGOVEXP(R%) * (1 + IGDPRCor(R%))\r\r'mti test\r'GOVHHTRN(R%) = ConvergeOverTime(govttrans * govhhtrnr(R%), govttrans, govfinconv)\rGOVHHTRN(R%) = ConvergeOverTime(govttrans * govhhtrnr(R%), govttrans, govfinconv)\r"
  },
  {
    "Variable": "GOVHHTRN",
    "UsesVariable": "GOVEXP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNPEN",
    "UsesVariable": "GOVHHPENT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNPEN",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNPEN",
    "UsesVariable": "HHRETIRENEED",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNPEN",
    "UsesVariable": "CRETIRE",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNPEN",
    "UsesVariable": "govhhpentndpctuse",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNPEN",
    "UsesVariable": "savingsdiscountrt",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNPEN",
    "UsesVariable": "workageentry",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNPEN",
    "UsesVariable": "workageretire",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNPEN",
    "UsesVariable": "WORKAGERETIREND",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNPEN",
    "UsesVariable": "govhhtrnpenm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNPEN",
    "UsesVariable": "GOVHHTRN",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNPEN",
    "UsesVariable": "HHINCEARN",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNPEN",
    "UsesVariable": "POP",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNPEN",
    "UsesVariable": "POPRETIRED",
    "Distance": 17,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNPEN",
    "UsesVariable": "GOVHHTRNWEL",
    "Distance": 1995,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNPEN",
    "UsesVariable": "GDPPCP",
    "Distance": 21,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNPEN",
    "UsesVariable": "VADD",
    "Distance": 612,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNPEN",
    "UsesVariable": "WP",
    "Distance": 612,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNPEN",
    "UsesVariable": "POPWORKING",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNPEN",
    "UsesVariable": "labretagem",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNPEN",
    "UsesVariable": "GDPPC",
    "Distance": 1826,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNWEL",
    "UsesVariable": "globalfundsrecipients",
    "Distance": 0,
    "Code": "\r'First Year: Save Tariff Values on Agriculture Exports\r'-----------------------------------------------\rdb.BulkInsertDYADTARIFFREVAGR(DYADTARIFFREV, CShort(FirstYear + IY - 1), NR)\r'First Year: Save Tariff Values on Energy Exports\r'--------------------------------\rdb.BulkInsertDYADTARIFFREVENE(DYADTARIFFREV, CShort(FirstYear + IY - 1), NR)\r'First Year: Save Tariff Values on Materials Exports\r'---------------------------------------------------\rdb.BulkInsertDYADTARIFFREVMAT(DYADTARIFFREV, CShort(FirstYear + IY - 1), NR)\r'First Year: Save Tariff VAlues on Manufacture Exports\r'-------------------------------------------------------\rdb.BulkInsertDYADTARIFFREVMAN(DYADTARIFFREV, CShort(FirstYear + IY - 1), NR)\r'First Year: Save Tariff Values on Services Exports\r'-----------------------------------\rdb.BulkInsertDYADTARIFFREVSER(DYADTARIFFREV, CShort(FirstYear + IY - 1), NR)\r'First Year: Save Tariff Values on ICT Exports\r'----------------------------\rdb.BulkInsertDYADTARIFFREVICT(DYADTARIFFREV, CShort(FirstYear + IY - 1), NR)\r'jrs 2022/04/20\r'First Year: Save Polity Affinity Values\r'-----------------------------------------\rdb.BulkInsertPOLITYAFFINITY(DYADPOLITYAFFINITY, CShort(FirstYear + IY - 1), NR)\rEnd Using\r\r'jrs 2021/04/26\rGLOBALFUND = 0\r\r'bbh 2013/08/03 end\r\r'jrs 2021/04/21\rIf GLOBALFUND > 0 And globalfundsrecipients(R%) > 0 Then\rGOVHHTRNWEL(R%, Unskilled) = GOVHHTRNWEL(R%, Unskilled) + GLOBALFUND * POVSHORTShare(R%) * globalfundsrecipients(R%)\rIf globalfundsrecipients(R%) < 1 Then\rGLOBALFUNDCUM = GLOBALFUNDCUM + GLOBALFUND * POVSHORTShare(R%) * (1 - globalfundsrecipients(R%))\rEnd If\rEnd If\r"
  },
  {
    "Variable": "GOVHHTRNWEL",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNWEL",
    "UsesVariable": "govhhtrnwelm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNWEL",
    "UsesVariable": "XWBFLOWS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNWEL",
    "UsesVariable": "GOVHHTRN",
    "Distance": 20,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNWEL",
    "UsesVariable": "HHPOP",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNWEL",
    "UsesVariable": "POP",
    "Distance": 25,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNWEL",
    "UsesVariable": "POPRETIRED",
    "Distance": 32,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNWEL",
    "UsesVariable": "GOVHHTRNPEN",
    "Distance": 2011,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNWEL",
    "UsesVariable": "GDPPCP",
    "Distance": 36,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNWEL",
    "UsesVariable": "GOVHHPENT",
    "Distance": 2025,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNWEL",
    "UsesVariable": "VADD",
    "Distance": 627,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNWEL",
    "UsesVariable": "WP",
    "Distance": 627,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNWEL",
    "UsesVariable": "POPWORKING",
    "Distance": 33,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNWEL",
    "UsesVariable": "labretagem",
    "Distance": 33,
    "Code": "0"
  },
  {
    "Variable": "GOVHHTRNWEL",
    "UsesVariable": "GDPPC",
    "Distance": 1841,
    "Code": "0"
  },
  {
    "Variable": "GOVINDCAPAC",
    "UsesVariable": "GOVCORRUPT",
    "Distance": 0,
    "Code": "\r'dkb 2018/06/01 - END\r'        GOVINDSECUR(R) = AMAX(0, Amin(1, 1 - (SFINTLWARALL(R) + 0.1) ^ 0.5 * (GOVRISK(R) / AMAX(0.1, govsecrskdiv)) ^ govsecrskexp))\r'        GOVINDCAPAC(R) = Amin((GOVREV(R) - AID(R)) / GDP(R), 0.4) / 0.4 * GOVCORRUPT(R) / 10\r'        GOVINDINCLUS(R) = DEMOCPOLITY(R) / 20 * Amin(1#, GEM(R))\r\r\r'GOVINDSECUR(R) = AMAX(0, Amin(1, 1 - (SFINTLWARALL(R) + (GOVRISK(R) - 0.15) * 2) / 2))\rgovrevterm = CSng(Amin((GOVREV(R) - AID(R)) / GDP(R), 0.45) / 0.45)\r\rGOVINDCAPAC(R) = AMAX(0, Amin(1, (govrevterm + GOVCORRUPT(R) / 10) / 2))\r"
  },
  {
    "Variable": "GOVINDCAPAC",
    "UsesVariable": "GOVREV",
    "Distance": 1,
    "Code": "\r'dkb 2018/06/01 - END\r'        GOVINDSECUR(R) = AMAX(0, Amin(1, 1 - (SFINTLWARALL(R) + 0.1) ^ 0.5 * (GOVRISK(R) / AMAX(0.1, govsecrskdiv)) ^ govsecrskexp))\r'        GOVINDCAPAC(R) = Amin((GOVREV(R) - AID(R)) / GDP(R), 0.4) / 0.4 * GOVCORRUPT(R) / 10\r'        GOVINDINCLUS(R) = DEMOCPOLITY(R) / 20 * Amin(1#, GEM(R))\r\r\r'GOVINDSECUR(R) = AMAX(0, Amin(1, 1 - (SFINTLWARALL(R) + (GOVRISK(R) - 0.15) * 2) / 2))\rgovrevterm = CSng(Amin((GOVREV(R) - AID(R)) / GDP(R), 0.45) / 0.45)\r"
  },
  {
    "Variable": "GOVINDCAPAC",
    "UsesVariable": "AID",
    "Distance": 1,
    "Code": "\r'dkb 2018/06/01 - END\r'        GOVINDSECUR(R) = AMAX(0, Amin(1, 1 - (SFINTLWARALL(R) + 0.1) ^ 0.5 * (GOVRISK(R) / AMAX(0.1, govsecrskdiv)) ^ govsecrskexp))\r'        GOVINDCAPAC(R) = Amin((GOVREV(R) - AID(R)) / GDP(R), 0.4) / 0.4 * GOVCORRUPT(R) / 10\r'        GOVINDINCLUS(R) = DEMOCPOLITY(R) / 20 * Amin(1#, GEM(R))\r\r\r'GOVINDSECUR(R) = AMAX(0, Amin(1, 1 - (SFINTLWARALL(R) + (GOVRISK(R) - 0.15) * 2) / 2))\rgovrevterm = CSng(Amin((GOVREV(R) - AID(R)) / GDP(R), 0.45) / 0.45)\r"
  },
  {
    "Variable": "GOVINDCAPAC",
    "UsesVariable": "GDP",
    "Distance": 1,
    "Code": "\r'dkb 2018/06/01 - END\r'        GOVINDSECUR(R) = AMAX(0, Amin(1, 1 - (SFINTLWARALL(R) + 0.1) ^ 0.5 * (GOVRISK(R) / AMAX(0.1, govsecrskdiv)) ^ govsecrskexp))\r'        GOVINDCAPAC(R) = Amin((GOVREV(R) - AID(R)) / GDP(R), 0.4) / 0.4 * GOVCORRUPT(R) / 10\r'        GOVINDINCLUS(R) = DEMOCPOLITY(R) / 20 * Amin(1#, GEM(R))\r\r\r'GOVINDSECUR(R) = AMAX(0, Amin(1, 1 - (SFINTLWARALL(R) + (GOVRISK(R) - 0.15) * 2) / 2))\rgovrevterm = CSng(Amin((GOVREV(R) - AID(R)) / GDP(R), 0.45) / 0.45)\r"
  },
  {
    "Variable": "GOVINDINCLUS",
    "UsesVariable": "DEMOCPOLITY",
    "Distance": 0,
    "Code": "\r'If RegName(R%) = \"Qatar\" And IY% >= 19 Then Stop\rGOVINDINCLUS(R) = CSng(AMAX(0, Amin(1, (DEMOCPOLITY(R) / 20 + Amin(1.0#, GEM(R))) / 2)))\r"
  },
  {
    "Variable": "GOVINDINCLUS",
    "UsesVariable": "GEM",
    "Distance": 0,
    "Code": "\r'If RegName(R%) = \"Qatar\" And IY% >= 19 Then Stop\rGOVINDINCLUS(R) = CSng(AMAX(0, Amin(1, (DEMOCPOLITY(R) / 20 + Amin(1.0#, GEM(R))) / 2)))\r"
  },
  {
    "Variable": "GOVINDSECUR",
    "UsesVariable": "govindsecurm",
    "Distance": 0,
    "Code": "\r'kbn 2018/06/12-End-\r'kbn 2018/06/01-End-\r'mti 2018/06/18 Start\rGOVINDSECUR(R%) = AMAX(0, Amin(1, GOVINDSECUR(R%) * govindsecurm(R%)))\r"
  },
  {
    "Variable": "GOVINDSECUR",
    "UsesVariable": "govindsecurconflict",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "GOVINDSECUR",
    "UsesVariable": "SFCIVILWARUCDP",
    "Distance": 4,
    "Code": "\rscaleterm = govindsecurconflict + govindsecurgovrisk + govindsecurviolence\r"
  },
  {
    "Variable": "GOVINDSECUR",
    "UsesVariable": "sfcivilwarucdpsw",
    "Distance": 4,
    "Code": "\rscaleterm = govindsecurconflict + govindsecurgovrisk + govindsecurviolence\r"
  },
  {
    "Variable": "GOVINDSECUR",
    "UsesVariable": "govindsecurgovrisk",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "GOVINDSECUR",
    "UsesVariable": "GOVRISK",
    "Distance": 3,
    "Code": "\rscaleterm = govindsecurconflict + govindsecurgovrisk + govindsecurviolence\r"
  },
  {
    "Variable": "GOVINDSECUR",
    "UsesVariable": "govindsecurviolence",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "GOVINDSECUR",
    "UsesVariable": "HOMICIDEINDEX",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "GOVINDTOTAL",
    "UsesVariable": "GOVINDSECUR",
    "Distance": 0,
    "Code": "\r\rGOVINDTOTAL(R) = (GOVINDSECUR(R) + GOVINDCAPAC(R) + GOVINDINCLUS(R)) / 3\r\r\r"
  },
  {
    "Variable": "GOVINDTOTAL",
    "UsesVariable": "GOVINDCAPAC",
    "Distance": 0,
    "Code": "\r\rGOVINDTOTAL(R) = (GOVINDSECUR(R) + GOVINDCAPAC(R) + GOVINDINCLUS(R)) / 3\r\r\r"
  },
  {
    "Variable": "GOVINDTOTAL",
    "UsesVariable": "GOVINDINCLUS",
    "Distance": 0,
    "Code": "\r\rGOVINDTOTAL(R) = (GOVINDSECUR(R) + GOVINDCAPAC(R) + GOVINDINCLUS(R)) / 3\r\r\r"
  },
  {
    "Variable": "GOVNUCWP",
    "UsesVariable": "govnucwpadd",
    "Distance": 0,
    "Code": "\r\r'kbn 2018/02/16 Start Drug model below\rCall ComputeDrugs(context)\r'kbn 2018/02/16 end\r\r\r'   All but First 1:  Power:  Conventional and Nuclear\r'   ------------------------------------------------\r\rFor R% = 1 To NR%\rNPOW(R%) = SNPOW(R%) * (1 - drnpow) + GDS(R%, Mil) * nmilf(R%) * npowf\r'Note:  This is inconsistent with specification in preprocessor\r' (.002 billion/warhead)\r'and results in sharp decline in arsenals; result right, but wrong reasons\rcpowf(R%) = cpowldcf - (cpowldcf - 1) * Amin(10, GDPPC(R%)) / 10 'as in preprocessor\rCPOW(R%) = SCPOW(R%) * (1 - drcpow) + GDS(R%, Mil) * (1 - nmilf(R%)) * cpowf(R%)\rNPOW(R%) = AMAX(0, Amin(NPOW(R%), 100000))\rCPOW(R%) = AMAX(0, Amin(CPOW(R%), 100000))\r'bbh 2011/08/18\rGOVNUCWP(R%) = GOVNUCWP(R%) + govnucwpadd(R%)\rGOVNUCWP(R%) = AMAX(0, Amin(GOVNUCWP(R%), 900000))\r'bbh 2011/08/18 end\r'jrs 2011/10/11\rSGOVNUCWP(R%) = GOVNUCWP(R%)\rNext R%\r\r\r'kbn 2018/02/16 Start Drug model below\rCall ComputeDrugs(context)\r'kbn 2018/02/16 end\r\r\r'   All but First 1:  Power:  Conventional and Nuclear\r'   ------------------------------------------------\r\rFor R% = 1 To NR%\rNPOW(R%) = SNPOW(R%) * (1 - drnpow) + GDS(R%, Mil) * nmilf(R%) * npowf\r'Note:  This is inconsistent with specification in preprocessor\r' (.002 billion/warhead)\r'and results in sharp decline in arsenals; result right, but wrong reasons\rcpowf(R%) = cpowldcf - (cpowldcf - 1) * Amin(10, GDPPC(R%)) / 10 'as in preprocessor\rCPOW(R%) = SCPOW(R%) * (1 - drcpow) + GDS(R%, Mil) * (1 - nmilf(R%)) * cpowf(R%)\rNPOW(R%) = AMAX(0, Amin(NPOW(R%), 100000))\rCPOW(R%) = AMAX(0, Amin(CPOW(R%), 100000))\r'bbh 2011/08/18\rGOVNUCWP(R%) = GOVNUCWP(R%) + govnucwpadd(R%)\rGOVNUCWP(R%) = AMAX(0, Amin(GOVNUCWP(R%), 900000))\r'bbh 2011/08/18 end\r'jrs 2011/10/11\rSGOVNUCWP(R%) = GOVNUCWP(R%)\rNext R%\r"
  },
  {
    "Variable": "GOVREGQUAL",
    "UsesVariable": "govregqualm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GOVREGQUAL",
    "UsesVariable": "goveffconv",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "GOVREGQUAL",
    "UsesVariable": "govregqualsetar",
    "Distance": 1,
    "Code": "\rGovRegQualAdd(R%) = GOVREGQUAL(R%) - Prediction\r\rEffectAdd = ConvergeOverTime(GovRegQualAdd(R%), 0, goveffconv) 'Base, Target, Years\r\r'bbh 2011/09/21 Function now estimated with forecasts (0-5)/not data (-2.5 to 2/5)\r'Prediction = AMAX(0, Amin(5, Prediction + 2.5))\rPrediction = AMAX(0, Amin(5, Prediction))\r"
  },
  {
    "Variable": "GOVREGQUAL",
    "UsesVariable": "govregqualseyrtar",
    "Distance": 1,
    "Code": "\rGovRegQualAdd(R%) = GOVREGQUAL(R%) - Prediction\r"
  },
  {
    "Variable": "GOVREGQUAL",
    "UsesVariable": "confforsw",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "GOVREGQUAL",
    "UsesVariable": "GDPPCP",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "GOVREGQUAL",
    "UsesVariable": "DEMOCPOLITY",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "GOVREGQUAL",
    "UsesVariable": "ENX",
    "Distance": 54,
    "Code": "0"
  },
  {
    "Variable": "GOVREGQUAL",
    "UsesVariable": "ENPRI",
    "Distance": 54,
    "Code": "0"
  },
  {
    "Variable": "GOVREGQUAL",
    "UsesVariable": "GDP",
    "Distance": 54,
    "Code": "0"
  },
  {
    "Variable": "GOVREV",
    "UsesVariable": "XWBLNFIN",
    "Distance": 0,
    "Code": "\r\rPrivate Sub AggrRev(R As Integer)\r'mti 2017/03/16 New Proc\r\rSSWELTAX(R%) = HHGOVSS(R%, Unskilled) + HHGOVSS(R%, Skilled) + FIRMGOVSS(R%)\rGOVREV(R%) = HHTAX(R%, Unskilled) + HHTAX(R%, Skilled) + FIRMTAX(R%) +\r            INDIRECTTAX(R%) + SSWELTAX(R%)\r'bbh 2019/09/13 start\rFor S% = 1 To NSec%\r'GOVREV(R%) = GOVREV(R%) + MTARIFFREV(R%, S%)\rGOVREV(R%) = GOVREV(R%) + SMTariffRev(R%, S%) 'dkb 2019/10/22\rNext S%\r'bbh 2019/09/13 end\rTAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOTRPA(R%))\rGOVREVDOM(R%) = GOVREV(R%)\rIf AID(R%) > 0 Then GOVREV(R%) = GOVREV(R%) + AID(R%) 'Receipts\r\r'GrantPortion = AID(R%) * (1 - aidlp)\r'GOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%)\r'bbh 2022/12/20 Register net flows on revenue side; not done on either side in preprocessor\rGOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%) - XWBLNFOUT(R%) - XIMFCRFOUT(R%)\r\r\rEnd Sub\r"
  },
  {
    "Variable": "GOVREV",
    "UsesVariable": "XIMFCRFIN",
    "Distance": 0,
    "Code": "\r\rPrivate Sub AggrRev(R As Integer)\r'mti 2017/03/16 New Proc\r\rSSWELTAX(R%) = HHGOVSS(R%, Unskilled) + HHGOVSS(R%, Skilled) + FIRMGOVSS(R%)\rGOVREV(R%) = HHTAX(R%, Unskilled) + HHTAX(R%, Skilled) + FIRMTAX(R%) +\r            INDIRECTTAX(R%) + SSWELTAX(R%)\r'bbh 2019/09/13 start\rFor S% = 1 To NSec%\r'GOVREV(R%) = GOVREV(R%) + MTARIFFREV(R%, S%)\rGOVREV(R%) = GOVREV(R%) + SMTariffRev(R%, S%) 'dkb 2019/10/22\rNext S%\r'bbh 2019/09/13 end\rTAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOTRPA(R%))\rGOVREVDOM(R%) = GOVREV(R%)\rIf AID(R%) > 0 Then GOVREV(R%) = GOVREV(R%) + AID(R%) 'Receipts\r\r'GrantPortion = AID(R%) * (1 - aidlp)\r'GOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%)\r'bbh 2022/12/20 Register net flows on revenue side; not done on either side in preprocessor\rGOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%) - XWBLNFOUT(R%) - XIMFCRFOUT(R%)\r\r\rEnd Sub\r"
  },
  {
    "Variable": "GOVREV",
    "UsesVariable": "XWBLNFOUT",
    "Distance": 0,
    "Code": "\r\rPrivate Sub AggrRev(R As Integer)\r'mti 2017/03/16 New Proc\r\rSSWELTAX(R%) = HHGOVSS(R%, Unskilled) + HHGOVSS(R%, Skilled) + FIRMGOVSS(R%)\rGOVREV(R%) = HHTAX(R%, Unskilled) + HHTAX(R%, Skilled) + FIRMTAX(R%) +\r            INDIRECTTAX(R%) + SSWELTAX(R%)\r'bbh 2019/09/13 start\rFor S% = 1 To NSec%\r'GOVREV(R%) = GOVREV(R%) + MTARIFFREV(R%, S%)\rGOVREV(R%) = GOVREV(R%) + SMTariffRev(R%, S%) 'dkb 2019/10/22\rNext S%\r'bbh 2019/09/13 end\rTAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOTRPA(R%))\rGOVREVDOM(R%) = GOVREV(R%)\rIf AID(R%) > 0 Then GOVREV(R%) = GOVREV(R%) + AID(R%) 'Receipts\r\r'GrantPortion = AID(R%) * (1 - aidlp)\r'GOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%)\r'bbh 2022/12/20 Register net flows on revenue side; not done on either side in preprocessor\rGOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%) - XWBLNFOUT(R%) - XIMFCRFOUT(R%)\r\r\rEnd Sub\r"
  },
  {
    "Variable": "GOVREV",
    "UsesVariable": "XIMFCRFOUT",
    "Distance": 0,
    "Code": "\r\rPrivate Sub AggrRev(R As Integer)\r'mti 2017/03/16 New Proc\r\rSSWELTAX(R%) = HHGOVSS(R%, Unskilled) + HHGOVSS(R%, Skilled) + FIRMGOVSS(R%)\rGOVREV(R%) = HHTAX(R%, Unskilled) + HHTAX(R%, Skilled) + FIRMTAX(R%) +\r            INDIRECTTAX(R%) + SSWELTAX(R%)\r'bbh 2019/09/13 start\rFor S% = 1 To NSec%\r'GOVREV(R%) = GOVREV(R%) + MTARIFFREV(R%, S%)\rGOVREV(R%) = GOVREV(R%) + SMTariffRev(R%, S%) 'dkb 2019/10/22\rNext S%\r'bbh 2019/09/13 end\rTAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOTRPA(R%))\rGOVREVDOM(R%) = GOVREV(R%)\rIf AID(R%) > 0 Then GOVREV(R%) = GOVREV(R%) + AID(R%) 'Receipts\r\r'GrantPortion = AID(R%) * (1 - aidlp)\r'GOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%)\r'bbh 2022/12/20 Register net flows on revenue side; not done on either side in preprocessor\rGOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%) - XWBLNFOUT(R%) - XIMFCRFOUT(R%)\r\r\rEnd Sub\r"
  },
  {
    "Variable": "GOVREV",
    "UsesVariable": "AID",
    "Distance": 0,
    "Code": "\r\rPrivate Sub AggrRev(R As Integer)\r'mti 2017/03/16 New Proc\r\rSSWELTAX(R%) = HHGOVSS(R%, Unskilled) + HHGOVSS(R%, Skilled) + FIRMGOVSS(R%)\rGOVREV(R%) = HHTAX(R%, Unskilled) + HHTAX(R%, Skilled) + FIRMTAX(R%) +\r            INDIRECTTAX(R%) + SSWELTAX(R%)\r'bbh 2019/09/13 start\rFor S% = 1 To NSec%\r'GOVREV(R%) = GOVREV(R%) + MTARIFFREV(R%, S%)\rGOVREV(R%) = GOVREV(R%) + SMTariffRev(R%, S%) 'dkb 2019/10/22\rNext S%\r'bbh 2019/09/13 end\rTAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOTRPA(R%))\rGOVREVDOM(R%) = GOVREV(R%)\rIf AID(R%) > 0 Then GOVREV(R%) = GOVREV(R%) + AID(R%) 'Receipts\r\r'GrantPortion = AID(R%) * (1 - aidlp)\r'GOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%)\r'bbh 2022/12/20 Register net flows on revenue side; not done on either side in preprocessor\rGOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%) - XWBLNFOUT(R%) - XIMFCRFOUT(R%)\r\r\rEnd Sub\r"
  },
  {
    "Variable": "GOVREV",
    "UsesVariable": "MTARIFFREV",
    "Distance": 0,
    "Code": "\r\rPrivate Sub AggrRev(R As Integer)\r'mti 2017/03/16 New Proc\r\rSSWELTAX(R%) = HHGOVSS(R%, Unskilled) + HHGOVSS(R%, Skilled) + FIRMGOVSS(R%)\rGOVREV(R%) = HHTAX(R%, Unskilled) + HHTAX(R%, Skilled) + FIRMTAX(R%) +\r            INDIRECTTAX(R%) + SSWELTAX(R%)\r'bbh 2019/09/13 start\rFor S% = 1 To NSec%\r'GOVREV(R%) = GOVREV(R%) + MTARIFFREV(R%, S%)\rGOVREV(R%) = GOVREV(R%) + SMTariffRev(R%, S%) 'dkb 2019/10/22\rNext S%\r'bbh 2019/09/13 end\rTAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOTRPA(R%))\rGOVREVDOM(R%) = GOVREV(R%)\rIf AID(R%) > 0 Then GOVREV(R%) = GOVREV(R%) + AID(R%) 'Receipts\r\r'GrantPortion = AID(R%) * (1 - aidlp)\r'GOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%)\r'bbh 2022/12/20 Register net flows on revenue side; not done on either side in preprocessor\rGOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%) - XWBLNFOUT(R%) - XIMFCRFOUT(R%)\r\r\rEnd Sub\r"
  },
  {
    "Variable": "GOVREV",
    "UsesVariable": "HHTAX",
    "Distance": 0,
    "Code": "\r\rPrivate Sub AggrRev(R As Integer)\r'mti 2017/03/16 New Proc\r\rSSWELTAX(R%) = HHGOVSS(R%, Unskilled) + HHGOVSS(R%, Skilled) + FIRMGOVSS(R%)\rGOVREV(R%) = HHTAX(R%, Unskilled) + HHTAX(R%, Skilled) + FIRMTAX(R%) +\r            INDIRECTTAX(R%) + SSWELTAX(R%)\r'bbh 2019/09/13 start\rFor S% = 1 To NSec%\r'GOVREV(R%) = GOVREV(R%) + MTARIFFREV(R%, S%)\rGOVREV(R%) = GOVREV(R%) + SMTariffRev(R%, S%) 'dkb 2019/10/22\rNext S%\r'bbh 2019/09/13 end\rTAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOTRPA(R%))\rGOVREVDOM(R%) = GOVREV(R%)\rIf AID(R%) > 0 Then GOVREV(R%) = GOVREV(R%) + AID(R%) 'Receipts\r\r'GrantPortion = AID(R%) * (1 - aidlp)\r'GOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%)\r'bbh 2022/12/20 Register net flows on revenue side; not done on either side in preprocessor\rGOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%) - XWBLNFOUT(R%) - XIMFCRFOUT(R%)\r\r\rEnd Sub\r"
  },
  {
    "Variable": "GOVREV",
    "UsesVariable": "FIRMTAX",
    "Distance": 0,
    "Code": "\r\rPrivate Sub AggrRev(R As Integer)\r'mti 2017/03/16 New Proc\r\rSSWELTAX(R%) = HHGOVSS(R%, Unskilled) + HHGOVSS(R%, Skilled) + FIRMGOVSS(R%)\rGOVREV(R%) = HHTAX(R%, Unskilled) + HHTAX(R%, Skilled) + FIRMTAX(R%) +\r            INDIRECTTAX(R%) + SSWELTAX(R%)\r'bbh 2019/09/13 start\rFor S% = 1 To NSec%\r'GOVREV(R%) = GOVREV(R%) + MTARIFFREV(R%, S%)\rGOVREV(R%) = GOVREV(R%) + SMTariffRev(R%, S%) 'dkb 2019/10/22\rNext S%\r'bbh 2019/09/13 end\rTAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOTRPA(R%))\rGOVREVDOM(R%) = GOVREV(R%)\rIf AID(R%) > 0 Then GOVREV(R%) = GOVREV(R%) + AID(R%) 'Receipts\r\r'GrantPortion = AID(R%) * (1 - aidlp)\r'GOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%)\r'bbh 2022/12/20 Register net flows on revenue side; not done on either side in preprocessor\rGOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%) - XWBLNFOUT(R%) - XIMFCRFOUT(R%)\r\r\rEnd Sub\r"
  },
  {
    "Variable": "GOVREV",
    "UsesVariable": "INDIRECTTAX",
    "Distance": 0,
    "Code": "\r\rPrivate Sub AggrRev(R As Integer)\r'mti 2017/03/16 New Proc\r\rSSWELTAX(R%) = HHGOVSS(R%, Unskilled) + HHGOVSS(R%, Skilled) + FIRMGOVSS(R%)\rGOVREV(R%) = HHTAX(R%, Unskilled) + HHTAX(R%, Skilled) + FIRMTAX(R%) +\r            INDIRECTTAX(R%) + SSWELTAX(R%)\r'bbh 2019/09/13 start\rFor S% = 1 To NSec%\r'GOVREV(R%) = GOVREV(R%) + MTARIFFREV(R%, S%)\rGOVREV(R%) = GOVREV(R%) + SMTariffRev(R%, S%) 'dkb 2019/10/22\rNext S%\r'bbh 2019/09/13 end\rTAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOTRPA(R%))\rGOVREVDOM(R%) = GOVREV(R%)\rIf AID(R%) > 0 Then GOVREV(R%) = GOVREV(R%) + AID(R%) 'Receipts\r\r'GrantPortion = AID(R%) * (1 - aidlp)\r'GOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%)\r'bbh 2022/12/20 Register net flows on revenue side; not done on either side in preprocessor\rGOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%) - XWBLNFOUT(R%) - XIMFCRFOUT(R%)\r\r\rEnd Sub\r"
  },
  {
    "Variable": "GOVREV",
    "UsesVariable": "SSWELTAX",
    "Distance": 0,
    "Code": "\r\rPrivate Sub AggrRev(R As Integer)\r'mti 2017/03/16 New Proc\r\rSSWELTAX(R%) = HHGOVSS(R%, Unskilled) + HHGOVSS(R%, Skilled) + FIRMGOVSS(R%)\rGOVREV(R%) = HHTAX(R%, Unskilled) + HHTAX(R%, Skilled) + FIRMTAX(R%) +\r            INDIRECTTAX(R%) + SSWELTAX(R%)\r'bbh 2019/09/13 start\rFor S% = 1 To NSec%\r'GOVREV(R%) = GOVREV(R%) + MTARIFFREV(R%, S%)\rGOVREV(R%) = GOVREV(R%) + SMTariffRev(R%, S%) 'dkb 2019/10/22\rNext S%\r'bbh 2019/09/13 end\rTAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOTRPA(R%))\rGOVREVDOM(R%) = GOVREV(R%)\rIf AID(R%) > 0 Then GOVREV(R%) = GOVREV(R%) + AID(R%) 'Receipts\r\r'GrantPortion = AID(R%) * (1 - aidlp)\r'GOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%)\r'bbh 2022/12/20 Register net flows on revenue side; not done on either side in preprocessor\rGOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%) - XWBLNFOUT(R%) - XIMFCRFOUT(R%)\r\r\rEnd Sub\r"
  },
  {
    "Variable": "GOVREVDOM",
    "UsesVariable": "GOVREV",
    "Distance": 0,
    "Code": "\r\rPrivate Sub AggrRev(R As Integer)\r'mti 2017/03/16 New Proc\r\rSSWELTAX(R%) = HHGOVSS(R%, Unskilled) + HHGOVSS(R%, Skilled) + FIRMGOVSS(R%)\rGOVREV(R%) = HHTAX(R%, Unskilled) + HHTAX(R%, Skilled) + FIRMTAX(R%) +\r            INDIRECTTAX(R%) + SSWELTAX(R%)\r'bbh 2019/09/13 start\rFor S% = 1 To NSec%\r'GOVREV(R%) = GOVREV(R%) + MTARIFFREV(R%, S%)\rGOVREV(R%) = GOVREV(R%) + SMTariffRev(R%, S%) 'dkb 2019/10/22\rNext S%\r'bbh 2019/09/13 end\rTAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOTRPA(R%))\rGOVREVDOM(R%) = GOVREV(R%)\rIf AID(R%) > 0 Then GOVREV(R%) = GOVREV(R%) + AID(R%) 'Receipts\r\r'GrantPortion = AID(R%) * (1 - aidlp)\r'GOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%)\r'bbh 2022/12/20 Register net flows on revenue side; not done on either side in preprocessor\rGOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%) - XWBLNFOUT(R%) - XIMFCRFOUT(R%)\r\r\rEnd Sub\r"
  },
  {
    "Variable": "GOVRISK",
    "UsesVariable": "govriskm",
    "Distance": 0,
    "Code": "\rIf IY% > 1 Then GOVRISK(R) = GOVRISK(R) * govriskm(R) 'amb 2014/01/03 added multiplier on govrisk\r"
  },
  {
    "Variable": "GOVRISK",
    "UsesVariable": "govriskweight",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "GOVRISK",
    "UsesVariable": "GEM",
    "Distance": 3,
    "Code": "\rGOVRISKMAX(currRow) = 1\r\rGOVRISKMIN(currRow) = 0\r\rCase \"GEM\" 'jrs 2012/01/09\rVarVal = GEM(R)\r\rGOVRISKSIGN(currRow) = -1\rElse 'jrs 2019/10/22\rArray.Copy(swatres, watres, NR% + 1) 'jrs 2019/10/22\r\rGOVRISKMIN(currRow) = 0\r\rGOVRISKMAX(currRow) = 1\r\rIf GOVRISKSIGN(i) > 0 Then\rVarVal = (VarVal - GOVRISKMIN(i)) / (GOVRISKMAX(i) - GOVRISKMIN(i))\rElse\rVarVal = (VarVal - GOVRISKMAX(i)) / (GOVRISKMIN(i) - GOVRISKMAX(i))\rEnd If\r"
  },
  {
    "Variable": "GRAMSPC",
    "UsesVariable": "FDEM",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GRAMSPC",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GRAMSPC",
    "UsesVariable": "CLPC",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "GRAMSPC",
    "UsesVariable": "aglossconsm",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "GRAMSPC",
    "UsesVariable": "GDPPCP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "GS",
    "UsesVariable": "GOVCON",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HDI",
    "UsesVariable": "LIT",
    "Distance": 22,
    "Code": "\r\rLifeExpInd = (LIFEXP(R%, 3) - lifexpmin) / (hdilifemax - lifexpmin)\r\r\rGDPInd = CSng((Log(GDPPCP(R%) * 1000) - Log100) / (Log40000 - Log100))\r\r'        LifeExpInd = (LIFEXP(R%) - lifexpmin) / (hdilifemax - lifexpmin)\rLitInd = LIT(R%) / 100\r\r'jrs 2011/12/02\rLifeExpInd = AMAX(LifeExpInd, 0)\r\r\rHDI(R%) = CSng((LifeExpInd + LitInd + GDPInd) / 3) 'Traditional Index\r\rHDI(R%) = CSng(Amin(1.0#, HDI(R%)))\r"
  },
  {
    "Variable": "HDI",
    "UsesVariable": "GDPPCP",
    "Distance": 21,
    "Code": "\r\rLifeExpInd = (LIFEXP(R%, 3) - lifexpmin) / (hdilifemax - lifexpmin)\r"
  },
  {
    "Variable": "HDI",
    "UsesVariable": "LIFEXP",
    "Distance": 24,
    "Code": "\rLog40000 = CSng(Log(40000))\r\r\r'   All Years 3:  Human Development Index\r'   -------------------------------------\rDim Log100, Log40000, LogGDPPCPMax As Single\rLog100 = CSng(Log(100))\r"
  },
  {
    "Variable": "HDI",
    "UsesVariable": "lifexpmin",
    "Distance": 24,
    "Code": "\rLog40000 = CSng(Log(40000))\r"
  },
  {
    "Variable": "HDI",
    "UsesVariable": "hdilifemax",
    "Distance": 24,
    "Code": "\rLog40000 = CSng(Log(40000))\r"
  },
  {
    "Variable": "HDI21STFIX",
    "UsesVariable": "LIFEXP",
    "Distance": 3,
    "Code": "\rGDPInd = CSng((Log(GDPPCP(R%) * 1000) - Log100) / (LogGDPPCP21 - Log100))\r\r'Rescaled 21st century index\rLitInd = LIT(R%) / 100\r\rLifeExpInd = (LIFEXP(R%, Total) - lifexpmin) / (HDILIFEMAX21 - lifexpmin)\r\rHDI21STFIX(R%) = CSng(Amin(100, (LifeExpInd + LitInd + GDPInd) / 3))\r"
  },
  {
    "Variable": "HDI21STFIX",
    "UsesVariable": "lifexpmin",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "HDI21STFIX",
    "UsesVariable": "LIT",
    "Distance": 2,
    "Code": "\r\r'LifeExpInd = (LIFEXP(R%) - lifexpmin) / (HDILIFEMAX21 - lifexpmin)\rHDILIFEMAX21 = AMAX(HDILIFEMAX21, lifexpmin + 1)\r"
  },
  {
    "Variable": "HDI21STFIX",
    "UsesVariable": "GDPPCP",
    "Distance": 1,
    "Code": "\r\r'LifeExpInd = (LIFEXP(R%) - lifexpmin) / (HDILIFEMAX21 - lifexpmin)\rHDILIFEMAX21 = AMAX(HDILIFEMAX21, lifexpmin + 1)\r"
  },
  {
    "Variable": "HDI21STFIX",
    "UsesVariable": "hdigdppcmax",
    "Distance": 38,
    "Code": "\r'    LogGDPPCP21 = ConvergeOverTime(Log40000, LogGDPPCP21, 100) '21st - phased in\r'Base, Target, Years\r'    HDILIFEMAX21 = ConvergeOverTime(85, hdilifemaxf, 100) '21st - phased in\rHDILIFEMAX21 = hdilifemaxf '21st - no phase in\r"
  },
  {
    "Variable": "HDI21STFIX",
    "UsesVariable": "hdilifemaxf",
    "Distance": 37,
    "Code": "\r'    LogGDPPCP21 = ConvergeOverTime(Log40000, LogGDPPCP21, 100) '21st - phased in\r'Base, Target, Years\r'    HDILIFEMAX21 = ConvergeOverTime(85, hdilifemaxf, 100) '21st - phased in\rHDILIFEMAX21 = hdilifemaxf '21st - no phase in\r"
  },
  {
    "Variable": "HDIFLOAT",
    "UsesVariable": "LIFEXP",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "HDIFLOAT",
    "UsesVariable": "lifexpmin",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "HDIFLOAT",
    "UsesVariable": "LIT",
    "Distance": 2,
    "Code": "\r'Note:  UNDP combines LitInd (2/3) with Gross enrollment Ind (1/3)\r'   to create an Educational Attainment Index used for HDI\r'   The minimum and maximum on gross enrollment are 0 and 100\r'   Gross enrollment is combined primary, seconary, tertiary (1/3 weight)\r\r'LifeExpInd = (LIFEXP(R%) - lifexpmin) / (HDILIFEMAXFloat - lifexpmin)\rHDILIFEMAXFloat = AMAX(HDILIFEMAXFloat, lifexpmin + 1)\r"
  },
  {
    "Variable": "HDIFLOAT",
    "UsesVariable": "GDPPCP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "hdilifemax",
    "UsesVariable": "lifexpmin",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:Next R%:14262|\r\rDim LifeExpInd, LitInd, GDPInd, GDPPCIndHDINew, POPMale, POPFemale As Double\rDim FemshrPop, FemShRWage, GDPPCIndHDINewFem, GDPPCIndHDINewMale As Double\rFor R% = 1 To NR%\r\r'Debug.Print IY; RegName(R%)\r'If RegName(R%) = \"Iceland\" Then Stop\r'mti LifeExp/ gender May 2006\rhdilifemax = AMAX(hdilifemax, lifexpmin + 1)\r"
  },
  {
    "Variable": "HDIMF",
    "UsesVariable": "HDINEW",
    "Distance": 0,
    "Code": "\rHDIMF(R%, Total) = HDINEW(R%)\r"
  },
  {
    "Variable": "HDIMF",
    "UsesVariable": "GDPPCPMF",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "HDIMF",
    "UsesVariable": "LIFEXP",
    "Distance": 60,
    "Code": "0"
  },
  {
    "Variable": "HDIMF",
    "UsesVariable": "hdilifeminun",
    "Distance": 60,
    "Code": "0"
  },
  {
    "Variable": "HDIMF",
    "UsesVariable": "hdilifemaxun",
    "Distance": 60,
    "Code": "0"
  },
  {
    "Variable": "HDIMF",
    "UsesVariable": "EDYRSAG25",
    "Distance": 63,
    "Code": "0"
  },
  {
    "Variable": "HDIMF",
    "UsesVariable": "hdiedyrsminun",
    "Distance": 63,
    "Code": "0"
  },
  {
    "Variable": "HDIMF",
    "UsesVariable": "hdiedyrsmaxun",
    "Distance": 63,
    "Code": "0"
  },
  {
    "Variable": "HDIMF",
    "UsesVariable": "EDYRSSLE",
    "Distance": 62,
    "Code": "0"
  },
  {
    "Variable": "HDIMF",
    "UsesVariable": "hdiedsleminun",
    "Distance": 62,
    "Code": "0"
  },
  {
    "Variable": "HDIMF",
    "UsesVariable": "hdiedslemaxun",
    "Distance": 62,
    "Code": "0"
  },
  {
    "Variable": "HDIMF",
    "UsesVariable": "hdigdppcminun",
    "Distance": 68,
    "Code": "0"
  },
  {
    "Variable": "HDIMF",
    "UsesVariable": "hdigdppcmaxun",
    "Distance": 67,
    "Code": "0"
  },
  {
    "Variable": "HDINEW",
    "UsesVariable": "LIFEXP",
    "Distance": 47,
    "Code": "\r\r'mti April 2011 - start\r'-----HDI as per UN HDR 2010 -----------\r'mti Note: New HDI uses 73.5 and 20 years for lifeexp max and min; and $108,211 (PPP 2008) and $163  GNIPC (as opposed to GDPPC) for max and min\r\r'mti August 2017 Start\r'LifeExpIndHDINew = (LIFEXP(R%, 3) - LifExpMinHDINew) / (LifExpMaxHDINew - LifExpMinHDINew)\r'mti 2017/12/27 Start\rGDPPCIndHDINew = CSng((Log(CDbl(AMAX(GDPPCP(R%), 0.10001) * 1000)) - GDPPCPHDINewMinLog(3)) / GDPPCPHDINewDenom(3))\r\r\r\r'    EdIndHDINewMax = 0.0001\r\r'mti August 2017 Start\rDim EdYrs25Ind, EdYrsSLEInd As Single\rFor R% = 1 To NR%  'Targets on these indicators may increase\rFor gndr% = 1 To NGender%\r'mti 2017/12/27 start\r'            EdYrs25Ind = EDYRSAG25(R%, gndr%) / EdYrs25Max\r'            EdYrsSLEInd = EDYRSSLE(R%, gndr%) / EdYrsSLEMax\r'            EdIndHDINew(R%, gndr%) = (EdYrs25Ind + EdYrsSLEInd) / 2\r'            'Talk to BBH about bounds - AMAX(GDPPCP(R%), 0.10001) * 1000)\r'            LifeExpIndHDINew(R%, gndr%) = AMAX(0.0001, (LIFEXP(R%, gndr%) - LifExpMinHDINew)) / (LifExpMaxHDINew - LifExpMinHDINew)\rEdYrs25Ind = (EDYRSAG25(R%, gndr%) - hdiedyrsminun(gndr%)) / (hdiedyrsmaxun(gndr%) - hdiedyrsminun(gndr%))\rEdYrsSLEInd = (EDYRSSLE(R%, gndr%) - hdiedsleminun(gndr%)) / (hdiedslemaxun(gndr%) - hdiedsleminun(gndr%))\rEdIndHDINew(R%, gndr%) = (EdYrs25Ind + EdYrsSLEInd) / 2\r'Talk to BBH about bounds - AMAX(GDPPCP(R%), 0.10001) * 1000)\rLifeExpIndHDINew(R%, gndr%) = AMAX(0.0001, (LIFEXP(R%, gndr%) - hdilifeminun(gndr%))) / (hdilifemaxun(gndr%) - hdilifeminun(gndr%))\r\r'mti 2017/12/27 End\rNext gndr%\rNext R%\r\r\r\r'    EdIndHDINewMax = 0.0001\r\r'mti August 2017 Start\rDim EdYrs25Ind, EdYrsSLEInd As Single\rFor R% = 1 To NR%  'Targets on these indicators may increase\rFor gndr% = 1 To NGender%\r'mti 2017/12/27 start\r'            EdYrs25Ind = EDYRSAG25(R%, gndr%) / EdYrs25Max\r'            EdYrsSLEInd = EDYRSSLE(R%, gndr%) / EdYrsSLEMax\r'            EdIndHDINew(R%, gndr%) = (EdYrs25Ind + EdYrsSLEInd) / 2\r'            'Talk to BBH about bounds - AMAX(GDPPCP(R%), 0.10001) * 1000)\r'            LifeExpIndHDINew(R%, gndr%) = AMAX(0.0001, (LIFEXP(R%, gndr%) - LifExpMinHDINew)) / (LifExpMaxHDINew - LifExpMinHDINew)\rEdYrs25Ind = (EDYRSAG25(R%, gndr%) - hdiedyrsminun(gndr%)) / (hdiedyrsmaxun(gndr%) - hdiedyrsminun(gndr%))\rEdYrsSLEInd = (EDYRSSLE(R%, gndr%) - hdiedsleminun(gndr%)) / (hdiedslemaxun(gndr%) - hdiedsleminun(gndr%))\rEdIndHDINew(R%, gndr%) = (EdYrs25Ind + EdYrsSLEInd) / 2\r'Talk to BBH about bounds - AMAX(GDPPCP(R%), 0.10001) * 1000)\rLifeExpIndHDINew(R%, gndr%) = AMAX(0.0001, (LIFEXP(R%, gndr%) - hdilifeminun(gndr%))) / (hdilifemaxun(gndr%) - hdilifeminun(gndr%))\r\r'mti 2017/12/27 End\rNext gndr%\rNext R%\r\r\r\r'    EdIndHDINewMax = 0.0001\r\r'mti August 2017 Start\rDim EdYrs25Ind, EdYrsSLEInd As Single\rFor R% = 1 To NR%  'Targets on these indicators may increase\rFor gndr% = 1 To NGender%\r'mti 2017/12/27 start\r'            EdYrs25Ind = EDYRSAG25(R%, gndr%) / EdYrs25Max\r'            EdYrsSLEInd = EDYRSSLE(R%, gndr%) / EdYrsSLEMax\r'            EdIndHDINew(R%, gndr%) = (EdYrs25Ind + EdYrsSLEInd) / 2\r'            'Talk to BBH about bounds - AMAX(GDPPCP(R%), 0.10001) * 1000)\r'            LifeExpIndHDINew(R%, gndr%) = AMAX(0.0001, (LIFEXP(R%, gndr%) - LifExpMinHDINew)) / (LifExpMaxHDINew - LifExpMinHDINew)\rEdYrs25Ind = (EDYRSAG25(R%, gndr%) - hdiedyrsminun(gndr%)) / (hdiedyrsmaxun(gndr%) - hdiedyrsminun(gndr%))\rEdYrsSLEInd = (EDYRSSLE(R%, gndr%) - hdiedsleminun(gndr%)) / (hdiedslemaxun(gndr%) - hdiedsleminun(gndr%))\rEdIndHDINew(R%, gndr%) = (EdYrs25Ind + EdYrsSLEInd) / 2\r'Talk to BBH about bounds - AMAX(GDPPCP(R%), 0.10001) * 1000)\rLifeExpIndHDINew(R%, gndr%) = AMAX(0.0001, (LIFEXP(R%, gndr%) - hdilifeminun(gndr%))) / (hdilifemaxun(gndr%) - hdilifeminun(gndr%))\r\r'mti 2017/12/27 End\rNext gndr%\rNext R%\r\r'mti 2017/12/27 End\rGDPPCIndHDINew = AMAX(0, GDPPCIndHDINew)\r\r\r\r'    EdIndHDINewMax = 0.0001\r\r'mti August 2017 Start\rDim EdYrs25Ind, EdYrsSLEInd As Single\rFor R% = 1 To NR%  'Targets on these indicators may increase\rFor gndr% = 1 To NGender%\r'mti 2017/12/27 start\r'            EdYrs25Ind = EDYRSAG25(R%, gndr%) / EdYrs25Max\r'            EdYrsSLEInd = EDYRSSLE(R%, gndr%) / EdYrsSLEMax\r'            EdIndHDINew(R%, gndr%) = (EdYrs25Ind + EdYrsSLEInd) / 2\r'            'Talk to BBH about bounds - AMAX(GDPPCP(R%), 0.10001) * 1000)\r'            LifeExpIndHDINew(R%, gndr%) = AMAX(0.0001, (LIFEXP(R%, gndr%) - LifExpMinHDINew)) / (LifExpMaxHDINew - LifExpMinHDINew)\rEdYrs25Ind = (EDYRSAG25(R%, gndr%) - hdiedyrsminun(gndr%)) / (hdiedyrsmaxun(gndr%) - hdiedyrsminun(gndr%))\rEdYrsSLEInd = (EDYRSSLE(R%, gndr%) - hdiedsleminun(gndr%)) / (hdiedslemaxun(gndr%) - hdiedsleminun(gndr%))\rEdIndHDINew(R%, gndr%) = (EdYrs25Ind + EdYrsSLEInd) / 2\r'Talk to BBH about bounds - AMAX(GDPPCP(R%), 0.10001) * 1000)\rLifeExpIndHDINew(R%, gndr%) = AMAX(0.0001, (LIFEXP(R%, gndr%) - hdilifeminun(gndr%))) / (hdilifemaxun(gndr%) - hdilifeminun(gndr%))\r\r'mti 2017/12/27 End\rNext gndr%\rNext R%\r\r'EdIndHDINewFinal = EdIndHDINew(R%) / EdIndHDINewMax\r'mti using HDR 2010 Lifeexp bounds give transient? - using existing (85; 25)\r'HDINEW(R%) = EdIndHDINewFinal ^ (1 / 3) * GDPIndHDINew ^ (1 / 3) * LifeExpInd ^ (1 / 3)\rHDINEW(R%) = CSng(EdIndHDINew(R%, 3) ^ (1 / 3) * GDPPCIndHDINew ^ (1 / 3) * LifeExpIndHDINew(R%, 3) ^ (1 / 3))\r"
  },
  {
    "Variable": "HDINEW",
    "UsesVariable": "hdilifeminun",
    "Distance": 47,
    "Code": "\r\r'mti April 2011 - start\r'-----HDI as per UN HDR 2010 -----------\r'mti Note: New HDI uses 73.5 and 20 years for lifeexp max and min; and $108,211 (PPP 2008) and $163  GNIPC (as opposed to GDPPC) for max and min\r\r'mti August 2017 Start\r'LifeExpIndHDINew = (LIFEXP(R%, 3) - LifExpMinHDINew) / (LifExpMaxHDINew - LifExpMinHDINew)\r'mti 2017/12/27 Start\rGDPPCIndHDINew = CSng((Log(CDbl(AMAX(GDPPCP(R%), 0.10001) * 1000)) - GDPPCPHDINewMinLog(3)) / GDPPCPHDINewDenom(3))\r"
  },
  {
    "Variable": "HDINEW",
    "UsesVariable": "hdilifemaxun",
    "Distance": 47,
    "Code": "\r\r'mti April 2011 - start\r'-----HDI as per UN HDR 2010 -----------\r'mti Note: New HDI uses 73.5 and 20 years for lifeexp max and min; and $108,211 (PPP 2008) and $163  GNIPC (as opposed to GDPPC) for max and min\r\r'mti August 2017 Start\r'LifeExpIndHDINew = (LIFEXP(R%, 3) - LifExpMinHDINew) / (LifExpMaxHDINew - LifExpMinHDINew)\r'mti 2017/12/27 Start\rGDPPCIndHDINew = CSng((Log(CDbl(AMAX(GDPPCP(R%), 0.10001) * 1000)) - GDPPCPHDINewMinLog(3)) / GDPPCPHDINewDenom(3))\r"
  },
  {
    "Variable": "HDINEW",
    "UsesVariable": "EDYRSAG25",
    "Distance": 50,
    "Code": "\r\r'mti April 2011 - start\r'-----HDI as per UN HDR 2010 -----------\r'mti Note: New HDI uses 73.5 and 20 years for lifeexp max and min; and $108,211 (PPP 2008) and $163  GNIPC (as opposed to GDPPC) for max and min\r\r'mti August 2017 Start\r'LifeExpIndHDINew = (LIFEXP(R%, 3) - LifExpMinHDINew) / (LifExpMaxHDINew - LifExpMinHDINew)\r'mti 2017/12/27 Start\rGDPPCIndHDINew = CSng((Log(CDbl(AMAX(GDPPCP(R%), 0.10001) * 1000)) - GDPPCPHDINewMinLog(3)) / GDPPCPHDINewDenom(3))\r"
  },
  {
    "Variable": "HDINEW",
    "UsesVariable": "hdiedyrsminun",
    "Distance": 50,
    "Code": "\r\r'mti April 2011 - start\r'-----HDI as per UN HDR 2010 -----------\r'mti Note: New HDI uses 73.5 and 20 years for lifeexp max and min; and $108,211 (PPP 2008) and $163  GNIPC (as opposed to GDPPC) for max and min\r\r'mti August 2017 Start\r'LifeExpIndHDINew = (LIFEXP(R%, 3) - LifExpMinHDINew) / (LifExpMaxHDINew - LifExpMinHDINew)\r'mti 2017/12/27 Start\rGDPPCIndHDINew = CSng((Log(CDbl(AMAX(GDPPCP(R%), 0.10001) * 1000)) - GDPPCPHDINewMinLog(3)) / GDPPCPHDINewDenom(3))\r"
  },
  {
    "Variable": "HDINEW",
    "UsesVariable": "hdiedyrsmaxun",
    "Distance": 50,
    "Code": "\r\r'mti April 2011 - start\r'-----HDI as per UN HDR 2010 -----------\r'mti Note: New HDI uses 73.5 and 20 years for lifeexp max and min; and $108,211 (PPP 2008) and $163  GNIPC (as opposed to GDPPC) for max and min\r\r'mti August 2017 Start\r'LifeExpIndHDINew = (LIFEXP(R%, 3) - LifExpMinHDINew) / (LifExpMaxHDINew - LifExpMinHDINew)\r'mti 2017/12/27 Start\rGDPPCIndHDINew = CSng((Log(CDbl(AMAX(GDPPCP(R%), 0.10001) * 1000)) - GDPPCPHDINewMinLog(3)) / GDPPCPHDINewDenom(3))\r"
  },
  {
    "Variable": "HDINEW",
    "UsesVariable": "EDYRSSLE",
    "Distance": 49,
    "Code": "\r\r'mti April 2011 - start\r'-----HDI as per UN HDR 2010 -----------\r'mti Note: New HDI uses 73.5 and 20 years for lifeexp max and min; and $108,211 (PPP 2008) and $163  GNIPC (as opposed to GDPPC) for max and min\r\r'mti August 2017 Start\r'LifeExpIndHDINew = (LIFEXP(R%, 3) - LifExpMinHDINew) / (LifExpMaxHDINew - LifExpMinHDINew)\r'mti 2017/12/27 Start\rGDPPCIndHDINew = CSng((Log(CDbl(AMAX(GDPPCP(R%), 0.10001) * 1000)) - GDPPCPHDINewMinLog(3)) / GDPPCPHDINewDenom(3))\r"
  },
  {
    "Variable": "HDINEW",
    "UsesVariable": "hdiedsleminun",
    "Distance": 49,
    "Code": "\r\r'mti April 2011 - start\r'-----HDI as per UN HDR 2010 -----------\r'mti Note: New HDI uses 73.5 and 20 years for lifeexp max and min; and $108,211 (PPP 2008) and $163  GNIPC (as opposed to GDPPC) for max and min\r\r'mti August 2017 Start\r'LifeExpIndHDINew = (LIFEXP(R%, 3) - LifExpMinHDINew) / (LifExpMaxHDINew - LifExpMinHDINew)\r'mti 2017/12/27 Start\rGDPPCIndHDINew = CSng((Log(CDbl(AMAX(GDPPCP(R%), 0.10001) * 1000)) - GDPPCPHDINewMinLog(3)) / GDPPCPHDINewDenom(3))\r"
  },
  {
    "Variable": "HDINEW",
    "UsesVariable": "hdiedslemaxun",
    "Distance": 49,
    "Code": "\r\r'mti April 2011 - start\r'-----HDI as per UN HDR 2010 -----------\r'mti Note: New HDI uses 73.5 and 20 years for lifeexp max and min; and $108,211 (PPP 2008) and $163  GNIPC (as opposed to GDPPC) for max and min\r\r'mti August 2017 Start\r'LifeExpIndHDINew = (LIFEXP(R%, 3) - LifExpMinHDINew) / (LifExpMaxHDINew - LifExpMinHDINew)\r'mti 2017/12/27 Start\rGDPPCIndHDINew = CSng((Log(CDbl(AMAX(GDPPCP(R%), 0.10001) * 1000)) - GDPPCPHDINewMinLog(3)) / GDPPCPHDINewDenom(3))\r"
  },
  {
    "Variable": "HDINEW",
    "UsesVariable": "GDPPCP",
    "Distance": 2,
    "Code": "\r\r'mti April 2011 - start\r'-----HDI as per UN HDR 2010 -----------\r'mti Note: New HDI uses 73.5 and 20 years for lifeexp max and min; and $108,211 (PPP 2008) and $163  GNIPC (as opposed to GDPPC) for max and min\r\r'mti August 2017 Start\r'LifeExpIndHDINew = (LIFEXP(R%, 3) - LifExpMinHDINew) / (LifExpMaxHDINew - LifExpMinHDINew)\r'mti 2017/12/27 Start\rGDPPCIndHDINew = CSng((Log(CDbl(AMAX(GDPPCP(R%), 0.10001) * 1000)) - GDPPCPHDINewMinLog(3)) / GDPPCPHDINewDenom(3))\r"
  },
  {
    "Variable": "HDINEW",
    "UsesVariable": "hdigdppcminun",
    "Distance": 55,
    "Code": "0"
  },
  {
    "Variable": "HDINEW",
    "UsesVariable": "hdigdppcmaxun",
    "Distance": 54,
    "Code": "\r\r'mti March 2011 -start\r'mti April 2011 -start\r'New HDI (UN HDR 2010) - Education sub-component maxima determined by UN HDR technical Notes\r'mti August 2017 start\r'New HDR 2016\r'    EdYrs25Max = 13.2 '5 'set at low values that will change in the loop below\r'    EdYrsSLEMax = 20.6 '5 'set at low values that will change in the loop below\r'    LifExpMaxHDINew = 73.5\r'\r'    'mti July 18, 2011 - start\r'    'LifExpMinHDINew = 20\r'    LifExpMinHDINew = Amin(20, lifexpmin)\r'    'mti July 18, 2011 - end\r'\r'mti 2017/12/27 start\r'     Log70000 = Log(70000)\r''    'mti April 2011 - end\r'\r'\r'    'New HDI min/max and formulation per UNDP HDR 2016\r'    EdYrs25Max = 15         'years of mean\r'    EdYrsSLEMax = 18        'years of expected years of schooling\r'    LifExpMaxHDINew = 85    'years\r'    LifExpMinHDINew = 20    'years\r'    GDPPCPHDINewMinLog1 = Log(100)\r'    GDPPCPHDINewDenom1 = (Log(75000) - Log(100))  'new max and min are 75,000 and 100 dollars 2011 PPP\r\rFor gndr% = 1 To NGender%\rGDPPCPHDINewMinLog(gndr%) = CSng(Log(hdigdppcminun(gndr%) * 1000))\rGDPPCPHDINewDenom(gndr%) = CSng(Log(hdigdppcmaxun(gndr%) * 1000) - Log(hdigdppcminun(gndr%) * 1000))\rNext gndr%\r"
  },
  {
    "Variable": "HHDIVINT",
    "UsesVariable": "FIRMEARN",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "HHDIVINT",
    "UsesVariable": "FIRMTAX",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "HHDIVINT",
    "UsesVariable": "FIRMGOVSS",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "HHDIVINT",
    "UsesVariable": "INDIRECTTAX",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "HHDIVINT",
    "UsesVariable": "HHINCEARN",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "HHDIVINT",
    "UsesVariable": "IGCF",
    "Distance": 1995,
    "Code": "0"
  },
  {
    "Variable": "HHGOVSS",
    "UsesVariable": "HHPOP",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "HHGOVSS",
    "UsesVariable": "HHINCDIS",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "HHGOVSS",
    "UsesVariable": "HHTAX",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "HHGOVSS",
    "UsesVariable": "HHINCEARN",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "HHGOVSS",
    "UsesVariable": "govrevtrgtval",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "HHGOVSS",
    "UsesVariable": "govrevtrgtyr",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "HHGOVSS",
    "UsesVariable": "FIRMTAX",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "HHGOVSS",
    "UsesVariable": "INDIRECTTAX",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "HHGOVSS",
    "UsesVariable": "VADD",
    "Distance": 530,
    "Code": "0"
  },
  {
    "Variable": "HHGOVSS",
    "UsesVariable": "WP",
    "Distance": 530,
    "Code": "0"
  },
  {
    "Variable": "HHGOVSS",
    "UsesVariable": "FIRMGOVSS",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "HHGOVSS",
    "UsesVariable": "SSWELTAXR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHGOVSS",
    "UsesVariable": "ssweltaxrm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHGOVSS",
    "UsesVariable": "govrevm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHINCDIS",
    "UsesVariable": "HHPOP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHINCDIS",
    "UsesVariable": "XWORKREMIT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHINCDIS",
    "UsesVariable": "HHINCEARN",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHINCDIS",
    "UsesVariable": "GOVHHTRNPEN",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHINCDIS",
    "UsesVariable": "GOVHHTRNWEL",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHINCDIS",
    "UsesVariable": "HHDIVINT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHINCDIS",
    "UsesVariable": "HHTAX",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHINCDIS",
    "UsesVariable": "HHGOVSS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHINCDIS",
    "UsesVariable": "INDIRECTTAX",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHINCDIS",
    "UsesVariable": "FIRMEARN",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHINCDISPC",
    "UsesVariable": "HHINCDIS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHINCDISPC",
    "UsesVariable": "HHPOP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHINCDISPERM",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHINCDISPERM",
    "UsesVariable": "HHINCDIS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHINCEARN",
    "UsesVariable": "VADDHHS",
    "Distance": 0,
    "Code": "\rFor S% = 1 To NSec%\rVADDHHU(R%, S%) = VADDHHU(R%, S%) * (1 - CDALF(R%))\rHHINCEARN(R%, Unskilled) = HHINCEARN(R%, Unskilled) + VADDHHU(R%, S%)\rVADDHHS(R%, S%) = VADDHHS(R%, S%) * (1 - CDALF(R%))\rHHINCEARN(R%, Skilled) = HHINCEARN(R%, Skilled) + VADDHHS(R%, S%)\r'bbh 2020/08/05 Start\r'VADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'bbh 2020/08/20 start\r\r'bbh 2021/08/04 start  Total VADD finalized in IFsEco; household adjusts with CAPUT to help on stocks, above; change firm but leave VADD total alone\r'If CAPUT(R%, S%) > caputtar And gdprext(R%) < -70 Then\r'If CAPUT(R%, S%) > caputtar And gdprext(R%) > -70 Then 'bbh 2021/07/07 start 'bbh 2021/08/04\r'            If gdprext(R%) > -70 Then 'bbh 2021/08/04 Growth exogenous\r'                'VADDF(R%, S%) = (VADD(R%, S%) / ((CAPUT(R%, S%) / caputtar) ^ 0.5)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                VADDF(R%, S%) = (VADD(R%, S%) / (CAPUT(R%, S%) / caputtar)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                'VADDF(R%, S%) = (VaddPreCaput(R%, S%) / (CAPUT(R%, S%) / caputtar)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'            Else 'growth is endogenous\r'                VADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                'VADDF(R%, S%) = VaddPreCaput(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'            End If\rVADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'bbh 2021/08/04 end\r\r'bbh 2021/07/07 end\r'bbh 2020/08/20 end\r'bbh 2020/08/05 end\rFIRMEARN(R%) = FIRMEARN(R%) + VADDF(R%, S%)\rNext S%\r\r\rPrivate Sub ComputeHHTypeTot(R%)\r'- - - - - - - - - -  Economy  - - - - - - - - - - - - - - - - - - - - -\r'mti 2018/05/22 New proc\rHHDIVINT(R%, NSkill%) = HHDIVINT(R%, Skilled) + HHDIVINT(R%, Unskilled)\rHHTAX(R%, NSkill%) = HHTAX(R%, Skilled) + HHTAX(R%, Unskilled)\rHHGOVSS(R%, NSkill%) = HHGOVSS(R%, Skilled) + HHGOVSS(R%, Unskilled)\rGOVHHTRNPEN(R%, NSkill%) = GOVHHTRNPEN(R%, Skilled) + GOVHHTRNPEN(R%, Unskilled)\rGOVHHTRNWEL(R%, NSkill%) = GOVHHTRNWEL(R%, Skilled) + GOVHHTRNWEL(R%, Unskilled)\r'bbh 2021/05/15 HHINC(R%, NSkill%) = HHINC(R%, Skilled) + HHINC(R%, Unskilled)\rHHINCEARN(R%, NSkill%) = HHINCEARN(R%, Skilled) + HHINCEARN(R%, Unskilled)\rHHINCDIS(R%, NSkill%) = HHINCDIS(R%, Skilled) + HHINCDIS(R%, Unskilled)\rHHPOP(R%, NSkill%) = HHPOP(R%, Skilled) + HHPOP(R%, Unskilled)\r\r'bbh 2021/05/15 HHINCPC(R%, NSkill%) = HHINC(R%, NSkill%) / AMAX(0.001, HHPOP(R%, NSkill%))\rHHINCPC(R%, NSkill%) = HHINCEARN(R%, NSkill%) / AMAX(0.001, HHPOP(R%, NSkill%))\rHHINCDISPC(R%, NSkill%) = HHINCDIS(R%, NSkill%) / AMAX(0.001, HHPOP(R%, NSkill%))\r\r'bbh 2021/05/15 HHTAXR(R%, NSkill%) = 100 * (HHTAX(R%, NSkill%) / HHINC(R%, NSkill%))\rHHTAXR(R%, NSkill%) = 100 * (HHTAX(R%, NSkill%) / HHINCEARN(R%, NSkill%))\rEnd Sub\r"
  },
  {
    "Variable": "HHINCEARN",
    "UsesVariable": "VADDHHU",
    "Distance": 0,
    "Code": "\rFor S% = 1 To NSec%\rVADDHHU(R%, S%) = VADDHHU(R%, S%) * (1 - CDALF(R%))\rHHINCEARN(R%, Unskilled) = HHINCEARN(R%, Unskilled) + VADDHHU(R%, S%)\rVADDHHS(R%, S%) = VADDHHS(R%, S%) * (1 - CDALF(R%))\rHHINCEARN(R%, Skilled) = HHINCEARN(R%, Skilled) + VADDHHS(R%, S%)\r'bbh 2020/08/05 Start\r'VADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'bbh 2020/08/20 start\r\r'bbh 2021/08/04 start  Total VADD finalized in IFsEco; household adjusts with CAPUT to help on stocks, above; change firm but leave VADD total alone\r'If CAPUT(R%, S%) > caputtar And gdprext(R%) < -70 Then\r'If CAPUT(R%, S%) > caputtar And gdprext(R%) > -70 Then 'bbh 2021/07/07 start 'bbh 2021/08/04\r'            If gdprext(R%) > -70 Then 'bbh 2021/08/04 Growth exogenous\r'                'VADDF(R%, S%) = (VADD(R%, S%) / ((CAPUT(R%, S%) / caputtar) ^ 0.5)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                VADDF(R%, S%) = (VADD(R%, S%) / (CAPUT(R%, S%) / caputtar)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                'VADDF(R%, S%) = (VaddPreCaput(R%, S%) / (CAPUT(R%, S%) / caputtar)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'            Else 'growth is endogenous\r'                VADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                'VADDF(R%, S%) = VaddPreCaput(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'            End If\rVADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'bbh 2021/08/04 end\r\r'bbh 2021/07/07 end\r'bbh 2020/08/20 end\r'bbh 2020/08/05 end\rFIRMEARN(R%) = FIRMEARN(R%) + VADDF(R%, S%)\rNext S%\r"
  },
  {
    "Variable": "HHINCPC",
    "UsesVariable": "HHINCEARN",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHINCPC",
    "UsesVariable": "HHPOP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHPOP",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHPOP",
    "UsesVariable": "LABSUP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHPOP",
    "UsesVariable": "LAB",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHRETIRENEED",
    "UsesVariable": "CRETIRE",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHRETIRENEED",
    "UsesVariable": "retireconsumrat",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHSAV",
    "UsesVariable": "HHINCDIS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHSAV",
    "UsesVariable": "C",
    "Distance": 768,
    "Code": "0"
  },
  {
    "Variable": "HHSAV",
    "UsesVariable": "GDPPCP",
    "Distance": 771,
    "Code": "0"
  },
  {
    "Variable": "HHSAVNEEDSTOCK",
    "UsesVariable": "savingsdiscountrt",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHSAVNEEDSTOCK",
    "UsesVariable": "HHRETIRENEED",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "HHSAVNEEDSTOCK",
    "UsesVariable": "GOVHHPENT",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "HHSAVSTOCK",
    "UsesVariable": "savingsdiscountrt",
    "Distance": 0,
    "Code": "\r\r'All but First: Set accumulated savings to accumulated needs in absence of any other info about it\r'-----------------------------------------------------------------------------------------------\rHHSAVSTOCK(R%) = SHHSAVSTOCK(R%) * (1 + savingsdiscountrt(R%) / 100) + HHSAV(R%, 1) + HHSAV(R%, 2) - HHSAVUSE(R%)\r"
  },
  {
    "Variable": "HHSAVSTOCK",
    "UsesVariable": "HHSAV",
    "Distance": 0,
    "Code": "\r\r'All but First: Set accumulated savings to accumulated needs in absence of any other info about it\r'-----------------------------------------------------------------------------------------------\rHHSAVSTOCK(R%) = SHHSAVSTOCK(R%) * (1 + savingsdiscountrt(R%) / 100) + HHSAV(R%, 1) + HHSAV(R%, 2) - HHSAVUSE(R%)\r"
  },
  {
    "Variable": "HHSAVSTOCK",
    "UsesVariable": "CRETIRE",
    "Distance": 4,
    "Code": "\r\r'All but First: Compute annual retirement expenditure need for entire society\r'--------------------------------------------------------------------------\r'bbh 2013/08/11 ' computed what they need (fair share) earlier\r'            HHRETIRENEED(R%) = POPRETIRED(R%) * C(R%) / POP(R%) * retireconsumrat\r\r'All but First 3: Compute implied annual draw down of household savings stocks\r'------------------------------------------------------------------------\r'HHSAVUSE(R%) = AMAX(HHRETIRENEED(R%) - GOVHHPENT(R%), 0)\rHHSAVUSE(R%) = AMAX(CRETIRE(R%) - GOVHHPENT(R%), 0) 'actual use of savings based on actual consumption\r"
  },
  {
    "Variable": "HHSAVSTOCK",
    "UsesVariable": "GOVHHPENT",
    "Distance": 4,
    "Code": "\r\r'All but First: Compute annual retirement expenditure need for entire society\r'--------------------------------------------------------------------------\r'bbh 2013/08/11 ' computed what they need (fair share) earlier\r'            HHRETIRENEED(R%) = POPRETIRED(R%) * C(R%) / POP(R%) * retireconsumrat\r\r'All but First 3: Compute implied annual draw down of household savings stocks\r'------------------------------------------------------------------------\r'HHSAVUSE(R%) = AMAX(HHRETIRENEED(R%) - GOVHHPENT(R%), 0)\rHHSAVUSE(R%) = AMAX(CRETIRE(R%) - GOVHHPENT(R%), 0) 'actual use of savings based on actual consumption\r"
  },
  {
    "Variable": "HHSAVSTOCK",
    "UsesVariable": "hhsaveneedrat",
    "Distance": 0,
    "Code": "\r'If RegName$(R%) = \"United States of America\" Then Stop\r\r'First Year: Set accumulated savings to accumulated needs in absence of any other info about it\r'-----------------------------------------------------------------------------------------------\rHHSAVSTOCK(R%) = hhsaveneedrat(R%) * HHSAVNEEDSTOCK(R%)\r"
  },
  {
    "Variable": "HHSAVSTOCK",
    "UsesVariable": "HHSAVNEEDSTOCK",
    "Distance": 0,
    "Code": "\r'If RegName$(R%) = \"United States of America\" Then Stop\r\r'First Year: Set accumulated savings to accumulated needs in absence of any other info about it\r'-----------------------------------------------------------------------------------------------\rHHSAVSTOCK(R%) = hhsaveneedrat(R%) * HHSAVNEEDSTOCK(R%)\r"
  },
  {
    "Variable": "HHSAVSURSTOCK",
    "UsesVariable": "HHSAVSTOCK",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHSAVSURSTOCK",
    "UsesVariable": "HHSAVNEEDSTOCK",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHSIZE",
    "UsesVariable": "hhsizem",
    "Distance": 0,
    "Code": "\r\r'bbh 2022/06/23 Moved block below into MigrationGross\r''   All Years 1: Foreign Population\r''   -------------------------------\r''        If IY% = 1 Then\r''            If Abs(POPFOREIGN(R%)) < Abs(10 * MIGRANTS(R%)) Then\r''                POPFOREIGN(R%) = 10 * MIGRANTS(R%)\r''            End If\r''            SPopForeign(R%) = POPFOREIGN(R%)\r''        End If\r'POPFOREIGN(R%) = SPopForeign(R%)\r''SPopForeign(R%) = SPopForeign(R%) * (1 - SCDR(R%) / 1000) + MIGRANTS(R%)\r'SPopForeign(R%) = CSng(SPopForeign(R%) * (1 - 15 / 1000) + MIGRANTS(R%))\r''If use variable death rates, world sum will not be 0\r''bbh 2020/03/09 start\r'POPFOREIGNIN(R%) = SPopForeignIn(R%)\r'POPFOREIGNOUT(R%) = SPopForeignOut(R%)\r'SPopForeignIn(R%) = CSng(SPopForeignIn(R%) * (1 - 15 / 1000) + MIGRANTSIN(R%))\r'SPopForeignOut(R%) = CSng(SPopForeignOut(R%) * (1 - 15 / 1000) + MIGRANTSOUT(R%))\r''bbh 2020/03/09 end\r\r'mti HH Size for Infrastructure August 2010 start\r'   Household Size: Needs POP and POPLE15\r'   ----------------------------------------------------------------------\rIf IY% > 1 Then\r'jrs 2013/04/12 *** begin ***\r'            If frm_MainMenu.IFsGUIctrl1.cHistoricBase = True Then\r'                 Call XYTABL(\"Population Age Ratio Versus Households Intensity (1960)\", _\r'                            100 * POPLE15(R%) / AMAX(0.000001, POP(R%)), HHIntensity)\r'            Else\r'                 Call XYTABL(\"Population Age Ratio Versus Households Intensity (MOSTRECENT)\", _\r'                            100 * POPLE15(R%) / AMAX(0.000001, POP(R%)), HHIntensity)\r'                 'HHSizeShift(R%) = HHSIZE(R%) - HHSizeCalc\r'            End If\rIf context.HistoricMode = True Then\rCall XYTABL(\"Population Age Ratio Versus Households Intensity (1960)\",\r                            100 * POPPREWORK(R%) / AMAX(0.000001, POP(R%)), HHIntensity, context)\rElse\rCall XYTABL(\"Population Age Ratio Versus Households Intensity (MOSTRECENT)\",\r                            100 * POPPREWORK(R%) / AMAX(0.000001, POP(R%)), HHIntensity, context)\rEnd If\r'jrs 2013/04/12 *** end ***\rHHSizeCalc = 1 / AMAX(0.000001, HHIntensity)\r'mti August 17, 2011 -start\r'HHSIZE(R%) = Amin(10, AMAX(1, HHSizeCalc + ConvergeOverTime(HHSizeShift(R%), 0, 50)))\rHHSIZE(R%) = Amin(10, AMAX(1, HHSizeCalc + ConvergeOverTime(CSng(HHSizeShift(R%)), 0, 100)))\r'mti August 17, 2011 -end\r\r'mti April 05, 2012 - start\r'extrapolative approach\rHHSizeGR(R%) = AMAX(-0.05F, Amin(0.05F, 0.2F * (HHSIZE(R%) / sHHSIZE(R%) - 1.0F) + 0.8F * HHSizeGR(R%)))\rHHSIZE(R%) = CSng(Amin(10, AMAX(1, sHHSIZE(R%) * (1 + HHSizeGR(R%)))))\rsHHSIZE(R%) = HHSIZE(R%)\r'mti April 05, 2012 - end\r\rHHSIZE(R%) = Amin(10, AMAX(1, HHSIZE(R%) * hhsizem(R%)))\r\r'mti April 05, 2012 - start\rHHTOTAL(R%) = POP(R%) / HHSIZE(R%)\r'mti April 05, 2012 - end\rEnd If\r"
  },
  {
    "Variable": "HHSIZE",
    "UsesVariable": "POPPREWORK",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "HHTAX",
    "UsesVariable": "HHPOP",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "HHTAX",
    "UsesVariable": "HHINCDIS",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "HHTAX",
    "UsesVariable": "HHGOVSS",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "HHTAX",
    "UsesVariable": "HHINCEARN",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "HHTAX",
    "UsesVariable": "govrevtrgtval",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "HHTAX",
    "UsesVariable": "govrevtrgtyr",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "HHTAX",
    "UsesVariable": "FIRMTAX",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "HHTAX",
    "UsesVariable": "INDIRECTTAX",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "HHTAX",
    "UsesVariable": "VADD",
    "Distance": 528,
    "Code": "0"
  },
  {
    "Variable": "HHTAX",
    "UsesVariable": "WP",
    "Distance": 528,
    "Code": "0"
  },
  {
    "Variable": "HHTAX",
    "UsesVariable": "FIRMGOVSS",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "HHTAX",
    "UsesVariable": "HHTAXR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHTAX",
    "UsesVariable": "hhtaxrm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHTAX",
    "UsesVariable": "govrevm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHTAXR",
    "UsesVariable": "GDPPCP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "HHTAXR",
    "UsesVariable": "govrevtrgtval",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "HHTAXR",
    "UsesVariable": "govrevtrgtyr",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "HHTAXR",
    "UsesVariable": "HHTAX",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "HHTAXR",
    "UsesVariable": "FIRMTAX",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "HHTAXR",
    "UsesVariable": "INDIRECTTAX",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "HHTAXR",
    "UsesVariable": "VADD",
    "Distance": 535,
    "Code": "0"
  },
  {
    "Variable": "HHTAXR",
    "UsesVariable": "WP",
    "Distance": 535,
    "Code": "0"
  },
  {
    "Variable": "HHTAXR",
    "UsesVariable": "HHGOVSS",
    "Distance": 16,
    "Code": "0"
  },
  {
    "Variable": "HHTAXR",
    "UsesVariable": "FIRMGOVSS",
    "Distance": 16,
    "Code": "0"
  },
  {
    "Variable": "HHTAXR",
    "UsesVariable": "taxinfadjm",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "HHTAXR",
    "UsesVariable": "GDPSHADOWSHR",
    "Distance": 1948,
    "Code": "0"
  },
  {
    "Variable": "HHTAXR",
    "UsesVariable": "gdpshadowon",
    "Distance": 1948,
    "Code": "0"
  },
  {
    "Variable": "HHTAXR",
    "UsesVariable": "HHINCEARN",
    "Distance": 0,
    "Code": "\r\rPrivate Sub ComputeHHTypeTot(R%)\r'- - - - - - - - - -  Economy  - - - - - - - - - - - - - - - - - - - - -\r'mti 2018/05/22 New proc\rHHDIVINT(R%, NSkill%) = HHDIVINT(R%, Skilled) + HHDIVINT(R%, Unskilled)\rHHTAX(R%, NSkill%) = HHTAX(R%, Skilled) + HHTAX(R%, Unskilled)\rHHGOVSS(R%, NSkill%) = HHGOVSS(R%, Skilled) + HHGOVSS(R%, Unskilled)\rGOVHHTRNPEN(R%, NSkill%) = GOVHHTRNPEN(R%, Skilled) + GOVHHTRNPEN(R%, Unskilled)\rGOVHHTRNWEL(R%, NSkill%) = GOVHHTRNWEL(R%, Skilled) + GOVHHTRNWEL(R%, Unskilled)\r'bbh 2021/05/15 HHINC(R%, NSkill%) = HHINC(R%, Skilled) + HHINC(R%, Unskilled)\rHHINCEARN(R%, NSkill%) = HHINCEARN(R%, Skilled) + HHINCEARN(R%, Unskilled)\rHHINCDIS(R%, NSkill%) = HHINCDIS(R%, Skilled) + HHINCDIS(R%, Unskilled)\rHHPOP(R%, NSkill%) = HHPOP(R%, Skilled) + HHPOP(R%, Unskilled)\r\r'bbh 2021/05/15 HHINCPC(R%, NSkill%) = HHINC(R%, NSkill%) / AMAX(0.001, HHPOP(R%, NSkill%))\rHHINCPC(R%, NSkill%) = HHINCEARN(R%, NSkill%) / AMAX(0.001, HHPOP(R%, NSkill%))\rHHINCDISPC(R%, NSkill%) = HHINCDIS(R%, NSkill%) / AMAX(0.001, HHPOP(R%, NSkill%))\r\r'bbh 2021/05/15 HHTAXR(R%, NSkill%) = 100 * (HHTAX(R%, NSkill%) / HHINC(R%, NSkill%))\rHHTAXR(R%, NSkill%) = 100 * (HHTAX(R%, NSkill%) / HHINCEARN(R%, NSkill%))\rEnd Sub\r"
  },
  {
    "Variable": "HHTOTAL",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HHTOTAL",
    "UsesVariable": "HHSIZE",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HIVCASES",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:Next R%:13434|\r\r'   BBH 1/23/04 end V5_0\r\r\r'   All Years 1:  HIV Cases, AIDs Deaths, and AIDS Deaths not already in Mortality Data\r'   -----------------------------------------------------------------------------------\rFor R% = 1 To NR%\r'HIVCASES(R%) = SPOP15to50(R%) * HIVRATE(R%) / 100\rHIVCASES(R%) = POP(R%) * HIVRATE(R%) / 100\r"
  },
  {
    "Variable": "HIVCASES",
    "UsesVariable": "HIVRATE",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:Next R%:13434|\r\r'   BBH 1/23/04 end V5_0\r\r\r'   All Years 1:  HIV Cases, AIDs Deaths, and AIDS Deaths not already in Mortality Data\r'   -----------------------------------------------------------------------------------\rFor R% = 1 To NR%\r'HIVCASES(R%) = SPOP15to50(R%) * HIVRATE(R%) / 100\rHIVCASES(R%) = POP(R%) * HIVRATE(R%) / 100\r"
  },
  {
    "Variable": "HIVRATE",
    "UsesVariable": "hivtadvr",
    "Distance": 1,
    "Code": "\rElse 'Epidemic moving into control years\r'                PhaseOutInitialDecrement = SHIVTECCNTLRegI(R%) * AMAX(0, (15 - IY%) / 15)\r'                DecrementRate = (hivtadvr / 100) * IY% + PhaseOutInitialDecrement\r'sgh 2016/11/28\r'Make sure that the decrement begins with 1 after peak year is reached\rIf (BaseYear + IY%) > hivpeakyr(R%) Then\rDecrementRate = (hivtadvr / 100) * ((BaseYear + IY%) - hivpeakyr(R%))\rElse\rDecrementRate = (hivtadvr / 100) * IY%\rEnd If\r\rHIVRATE(R%) = SHIVRate(R%) * AMAX(0, 1 - DecrementRate)\r\r'                HIVTECCNTLReg(R%) = SHIVTECCNTLReg(R%) + hivtadvr / 100\r'                SHIVTECCNTLReg(R%) = HIVTECCNTLReg(R%)\r'                HIVRATE(R%) = SHIVRate(R%) * AMAX(0, 1 - HIVTECCNTLReg(R%))\r"
  },
  {
    "Variable": "HIVRATE",
    "UsesVariable": "hivpeakyr",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "HIVRATE",
    "UsesVariable": "hivpeakr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HIVRATE",
    "UsesVariable": "hivm",
    "Distance": 0,
    "Code": "\r'            ElseIf IY% > 4 AndAlso 2005 + 4 + IY% <= hivpeakyr(R%) Then ' Still increasing\r'Use \"BaseYear\" rather than a hard-coded year\rElseIf IY% > 4 AndAlso BaseYear + IY% <= hivpeakyr(R%) Then ' Still increasing\r'                Call XYTABL(\"GDP/Capita (PPP) Versus HIV, Maximum Percent of Pop\", _\r'                    sgdppcp(R%) * (1 + igdpr(R%)), maxhivrate(R%))\r'sgh 2016/11/28\r'Use \"BaseYear\" rather than a hard-coded year\r'                hivratemul = (hivpeakyr(R%) - (2005 + 4 + IY%)) / (hivpeakyr(R%) - (2005 + 4))\rhivratemul = (hivpeakyr(R%) - (BaseYear + IY%)) / (hivpeakyr(R%) - (BaseYear))\r\rIf SHIVRate(R%) < hivpeakr(R%) AndAlso hivincr(R%) < 1 Then\rhivgrrate = 1\rElse\rhivgrrate = hivincr(R%)\rEnd If\r\rHIVRATE(R%) = SHIVRate(R%) * (1 + hivgrrate * hivratemul / 100 * hivm(R%))\r"
  },
  {
    "Variable": "HIVRATE",
    "UsesVariable": "hivincr",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "HLBEDNETS",
    "UsesVariable": "hlbednetsm",
    "Distance": 0,
    "Code": "\r'3 here probably should become a parameter\rHLBEDNETS(R%) = Amin(100, HLBEDNETS(R%) * hlbednetsm(R%))\r"
  },
  {
    "Variable": "HLBEDNETS",
    "UsesVariable": "HLMALARIAPREV",
    "Distance": 1955,
    "Code": "\r\r'JRS 2007/06/29\r'First Year: Set UP Smoking Impact Initial Values\r'-------------------------------------------------\rSmokingImpactInit()\r\r'kbn 2018/03/30 START- FirstYear: Compute Shift factors for Maternal Mortality\r'-----------------------------------------------------------------------\rMaternalMortalityshift(context)\r'kbn 2018/03/30 End\r\r'bbh 2019/04/06 HIV and Malaria Incidence and Mortality Shift Factors\r'First Year:  Call HIV and Malaria Incidence and Mortality Shift Factor routines\r'-------------------------------------------------------------------------------\rHIVPrevIncShift(context)\rHIVMortRPrevShift(context)\rHIVCondomUseShift(context)\rHIVARTShift(context)\r'ttt 2019/10/08 TakeOut\rArray.Copy(HLHIVPREV, SHlHIVPrev, NR + 1)\rArray.Copy(HLHIVINC, SHlHIVInc, NR + 1)\rArray.Copy(HLHIVMORT, SHlHIVMort, NR + 1)\rArray.Copy(HLBEDNETS, SHlBedNets, NR + 1)\r\rFor R% = 1 To NR\r'ttt 2019/10/08 taken out\r'SHlHIVPrev(R%) = HLHIVPREV(R%)\r'SHlHIVInc(R%) = HLHIVINC(R%)\r'SHlHIVMort(R%) = HLHIVMORT(R%)\r'SHlBedNets(R%) = HLBEDNETS(R%)\rSHLMalIncR(R%) = AMAX(0.000001, HLMALARIAINC(R%) / POP(R%))\rSHlMalPrevR(R%) = HLMALARIAPREV(R%) / POP(R%)\rSHlMalMortR(R%) = HLMALARIAMORT(R%) / POP(R%)\r\rNext R%\r\r\r'BedNets Driving Variable - All Years but First\r'-----------------------------------------------\rBNetIncentive = CSng(SHlMalPrevR(R%) / 0.15)\r\r'in 2017 median rate among those fighting it was about .15 or 15% prevalence\rHLBEDNETS(R%) = SHlBedNets(R%) + 3 * (100 - SHlBedNets(R%)) / 100 * BNetIncentive\r"
  },
  {
    "Variable": "HLBEDNETS",
    "UsesVariable": "POP",
    "Distance": 1955,
    "Code": "\r\r'JRS 2007/06/29\r'First Year: Set UP Smoking Impact Initial Values\r'-------------------------------------------------\rSmokingImpactInit()\r\r'kbn 2018/03/30 START- FirstYear: Compute Shift factors for Maternal Mortality\r'-----------------------------------------------------------------------\rMaternalMortalityshift(context)\r'kbn 2018/03/30 End\r\r'bbh 2019/04/06 HIV and Malaria Incidence and Mortality Shift Factors\r'First Year:  Call HIV and Malaria Incidence and Mortality Shift Factor routines\r'-------------------------------------------------------------------------------\rHIVPrevIncShift(context)\rHIVMortRPrevShift(context)\rHIVCondomUseShift(context)\rHIVARTShift(context)\r'ttt 2019/10/08 TakeOut\rArray.Copy(HLHIVPREV, SHlHIVPrev, NR + 1)\rArray.Copy(HLHIVINC, SHlHIVInc, NR + 1)\rArray.Copy(HLHIVMORT, SHlHIVMort, NR + 1)\rArray.Copy(HLBEDNETS, SHlBedNets, NR + 1)\r\rFor R% = 1 To NR\r'ttt 2019/10/08 taken out\r'SHlHIVPrev(R%) = HLHIVPREV(R%)\r'SHlHIVInc(R%) = HLHIVINC(R%)\r'SHlHIVMort(R%) = HLHIVMORT(R%)\r'SHlBedNets(R%) = HLBEDNETS(R%)\rSHLMalIncR(R%) = AMAX(0.000001, HLMALARIAINC(R%) / POP(R%))\rSHlMalPrevR(R%) = HLMALARIAPREV(R%) / POP(R%)\rSHlMalMortR(R%) = HLMALARIAMORT(R%) / POP(R%)\r\rNext R%\r"
  },
  {
    "Variable": "HLBMI",
    "UsesVariable": "POP",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "HLBMI",
    "UsesVariable": "hlbmim",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLBMI",
    "UsesVariable": "CLPC",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "HLCOMADDDTHS",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLCOMADDDTHS",
    "UsesVariable": "hlcomaddprev",
    "Distance": 22,
    "Code": "0"
  },
  {
    "Variable": "HLCOMADDDTHS",
    "UsesVariable": "hlcomaddmort",
    "Distance": 23,
    "Code": "0"
  },
  {
    "Variable": "HLCOMADDDTHS",
    "UsesVariable": "hlmortcdadltm",
    "Distance": 27,
    "Code": "0"
  },
  {
    "Variable": "HLCOMADDDTHS",
    "UsesVariable": "hlmortcdchldm",
    "Distance": 29,
    "Code": "0"
  },
  {
    "Variable": "HLCOMADDDTHS",
    "UsesVariable": "hlmortm",
    "Distance": 31,
    "Code": "0"
  },
  {
    "Variable": "HLCOMADDDTHS",
    "UsesVariable": "mortm",
    "Distance": 31,
    "Code": "0"
  },
  {
    "Variable": "HLCOMADDDTHS",
    "UsesVariable": "hlvehsw",
    "Distance": 40,
    "Code": "0"
  },
  {
    "Variable": "HLCOMADDDTHS",
    "UsesVariable": "svtohlsw",
    "Distance": 0,
    "Code": "\r\r'jrs 2020/03/19\r'Apply Additional Comm Disease Mortality\r'---------------------------------------\rDim jEqIdx As Integer, MortFactor As Single, PrevFactor As Single\rFor R = 1 To NR\rFor j = 1 To 10\rHLCOMADDDTHS(R, j) = 0\rNext j\rFor j = 0 To NCohorts\rIf j = 0 Then\rjEqIdx = 1\rElseIf j < 17 Then\rjEqIdx = CInt(Floor(CDbl((j + 1) / 2)))\rEnd If\rMortFactor = AMAX(hlcomaddmort(R%, jEqIdx), hlcomaddmort(R%, 10))\rPrevFactor = AMAX(hlcomaddprev(R%, jEqIdx), hlcomaddprev(R%, 10))\rmodmordstdet(j, R%, 1) = modmordstdet(j, R%, 1) + PrevFactor * MortFactor * 1000\rmodmordstdet(j, R%, 2) = modmordstdet(j, R%, 2) + PrevFactor * MortFactor * 1000\rHLCOMADDDTHS(R, jEqIdx) = CSng(HLCOMADDDTHS(R, jEqIdx) + PrevFactor * MortFactor * (agedst(j, R%, 1) + agedst(j, R%, 2)))\rNext j\rNext R\r"
  },
  {
    "Variable": "HLCONDOMUSE",
    "UsesVariable": "hlcondomusem",
    "Distance": 0,
    "Code": "\rHLCONDOMUSE(R%) = Amin(100, HLCONDOMUSE(R%) * hlcondomusem(R%))\r"
  },
  {
    "Variable": "HLCONDOMUSE",
    "UsesVariable": "HLHIVPREV",
    "Distance": 0,
    "Code": "\rIf SHlHIVPrev(R%) / AMAX(0.00001, POP(R%)) > 0.02 Then\rHLCONDOMUSE(R%) = CSng(HLCONDOMUSE(R%) * (1 + IY% / 50)) 'assume 2% annual growth regardless\rEnd If\r"
  },
  {
    "Variable": "HLCONDOMUSE",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\rIf SHlHIVPrev(R%) / AMAX(0.00001, POP(R%)) > 0.02 Then\rHLCONDOMUSE(R%) = CSng(HLCONDOMUSE(R%) * (1 + IY% / 50)) 'assume 2% annual growth regardless\rEnd If\r"
  },
  {
    "Variable": "HLCONDOMUSE",
    "UsesVariable": "EDYRSAG15",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "HLCOST",
    "UsesVariable": "HLCOSTOTHER",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLCOST",
    "UsesVariable": "HLCOSTLE",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLCOST",
    "UsesVariable": "HLCOSTMORT",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "HLCOST",
    "UsesVariable": "HLCOSTMORB",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "HLCOST",
    "UsesVariable": "POP",
    "Distance": 1270,
    "Code": "0"
  },
  {
    "Variable": "HLCOSTLE",
    "UsesVariable": "hlcostleyrper",
    "Distance": 0,
    "Code": "\r'for Males and Females\rFor G = 1 To 2\r'Morbidity Cost\r'--------------\r'jrs 2014/05/30\r'                If HLYLL(R, T, G) <> 0 Then\r'                    HLCOSTMORB(R, T) = HLCOSTMORB(R, T) + DEATHCAT(R, T, G) * HLYLD(R, T, G) / HLYLL(R, T, G) * CostMorbRT\r'                Else\r'                    For A = 0 To NCohorts\r'                        HLCOSTMORB(R, T) = HLCOSTMORB(R, T) + modmorbdstdet(A, R, 2 * (T - 1) + G) * agedst(A, R, G) * CostMorbRT / 1000\r'                    Next A\r'                End If\rFor A = 0 To NCohorts\rHLCOSTMORB(R, T) = CSng(HLCOSTMORB(R, T) + modmorbdstdet(A, R, 2 * (T - 1) + G) * agedst(A, R, G) * CostMorbRT / 1000)\rNext A\r\r'Mortality Cost\r'--------------\rHLCOSTMORT(R, T) = HLCOSTMORT(R, T) + DEATHCAT(R, T, G) * CostMortRT\r'Life Extension Cost for Adults 30 or older\r'------------------------------------------\r'jrs 2014/06/03 no need to add up for each type\rIf T = 1 Then\rFor A = hlCostageSt To NCohorts 'jrs 2014/06/05 we were using 7 for Adults 30 or older, but acutally the treatment starts at 15 for CDs and 25 for NCDs and Injuries, so I'm using the max, in the base case 25\r'jrs 2014/06/05 added phase in factor\r'using Cost Adjust Factor to adapt cost of life extension treatment\r'bbh 2014/06/07 start\rCostFactorM = AMAX(0.05, Amin(1, CostAdjFactorMorb(R, T)))\r'                       HLCOSTLE(R) = HLCOSTLE(R) + hlcostleyrper * CostAdjFactorMorb(R, T) * agedst(A, R, G) * phaseInFact 'jrs 2014/06/02 LifeExtensionCostPerCap * agedst(A, R, G)\rHLCOSTLE(R) = CSng(HLCOSTLE(R) + hlcostleyrper * CostFactorM * agedst(A, R, G) * phaseInFact) 'jrs 2014/06/02 LifeExtensionCostPerCap * agedst(A, R, G)\r'jrs 2014/06/09\rHLCOSTLESUB(R) = CSng(HLCOSTLESUB(R) + hlcostleyrper * (1 - CostFactorM) * agedst(A, R, G) * phaseInFact)\r'HLCOSTLE(R) = HLCOSTLE(R) + hlcostleyrper * agedst(A, R, G)\rNext A\rEnd If\rNext G\r"
  },
  {
    "Variable": "HLCOSTLE",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r'for Males and Females\rFor G = 1 To 2\r'Morbidity Cost\r'--------------\r'jrs 2014/05/30\r'                If HLYLL(R, T, G) <> 0 Then\r'                    HLCOSTMORB(R, T) = HLCOSTMORB(R, T) + DEATHCAT(R, T, G) * HLYLD(R, T, G) / HLYLL(R, T, G) * CostMorbRT\r'                Else\r'                    For A = 0 To NCohorts\r'                        HLCOSTMORB(R, T) = HLCOSTMORB(R, T) + modmorbdstdet(A, R, 2 * (T - 1) + G) * agedst(A, R, G) * CostMorbRT / 1000\r'                    Next A\r'                End If\rFor A = 0 To NCohorts\rHLCOSTMORB(R, T) = CSng(HLCOSTMORB(R, T) + modmorbdstdet(A, R, 2 * (T - 1) + G) * agedst(A, R, G) * CostMorbRT / 1000)\rNext A\r\r'Mortality Cost\r'--------------\rHLCOSTMORT(R, T) = HLCOSTMORT(R, T) + DEATHCAT(R, T, G) * CostMortRT\r'Life Extension Cost for Adults 30 or older\r'------------------------------------------\r'jrs 2014/06/03 no need to add up for each type\rIf T = 1 Then\rFor A = hlCostageSt To NCohorts 'jrs 2014/06/05 we were using 7 for Adults 30 or older, but acutally the treatment starts at 15 for CDs and 25 for NCDs and Injuries, so I'm using the max, in the base case 25\r'jrs 2014/06/05 added phase in factor\r'using Cost Adjust Factor to adapt cost of life extension treatment\r'bbh 2014/06/07 start\rCostFactorM = AMAX(0.05, Amin(1, CostAdjFactorMorb(R, T)))\r'                       HLCOSTLE(R) = HLCOSTLE(R) + hlcostleyrper * CostAdjFactorMorb(R, T) * agedst(A, R, G) * phaseInFact 'jrs 2014/06/02 LifeExtensionCostPerCap * agedst(A, R, G)\rHLCOSTLE(R) = CSng(HLCOSTLE(R) + hlcostleyrper * CostFactorM * agedst(A, R, G) * phaseInFact) 'jrs 2014/06/02 LifeExtensionCostPerCap * agedst(A, R, G)\r'jrs 2014/06/09\rHLCOSTLESUB(R) = CSng(HLCOSTLESUB(R) + hlcostleyrper * (1 - CostFactorM) * agedst(A, R, G) * phaseInFact)\r'HLCOSTLE(R) = HLCOSTLE(R) + hlcostleyrper * agedst(A, R, G)\rNext A\rEnd If\rNext G\r"
  },
  {
    "Variable": "HLCOSTLE",
    "UsesVariable": "hlcostletime",
    "Distance": 14,
    "Code": "\r\r'jrs 2007/06/27\r'All Years: Smoking Impact - Compute Averages for All Ages and Accross Gender\r'----------------------------------------------------------------------------\rComputeSmokAvgAllAgesSex()\r\r'All Years: Diabetes Relative Risk - Compute Averages for All Ages and Accross Gender\r'------------------------------------------------------------------------------------\rComputeAvgDiabRRAgeSex(popgdr)\r\r'jrs 2018/04/19\r'All Years: Converge Intentional Injury time coeficient to avoid going too high over long horizons\r'-------------------------------------------------------------------------------------------------\r'jrs 2018/05/25\r'jrs 2020/08/19 Dim IY2030 As Integer move out, I don't know why it wasn't resetting to 0 every year\rDim k As Integer\r\rIf IY% = 1 Then\rReDim IntInjTimeFactors(12, 2)\r'for both genders\rFor k = 17 To 18\r'ages 5 to 59\rFor j = 2 To 12\rIntInjTimeFactors(j, k Mod 2) = mortFactors(j, k, 5, 2)\rNext j\rNext k\r'jrs 2018/05/25\rIY2030 = (2030 - BaseYear + 1)\rEnd If\r\r\r'jrs 2010/02/18\r'if doing mental health\rIf (k = 29 Or k = 30) And modmordstdet(j, R%, k) > 0 Then\r'Remove it from Other NCDs\rIf modmordstdet(j, R%, k - 18) >= modmordstdet(j, R%, k) Then\rmodmordstdet(j, R%, k - 18) = modmordstdet(j, R%, k - 18) - modmordstdet(j, R%, k)\rEnd If\rEnd If\r\r\rElse\rIf Not SMOKINGTRANCOEFF(R, 1, 2).HasValue Then\rSMOKINGTRANCOEFF(R, 4, 2) = Amin(HLSMOKING(R%, 2), hlsmokingceiling(2))\r'jrs 2011/12/12\rHLSMOKING(R%, 2) = Amin(HLSMOKING(R%, 2), hlsmokingceiling(2))\rElse\rA = CSng(SMOKINGTRANCOEFF(R, 1, 2))\rB = CSng(SMOKINGTRANCOEFF(R, 2, 2))\rC = CSng(SMOKINGTRANCOEFF(R, 3, 2))\r\rHLSMOKING(R%, 2) = CSng(A * (FirstYear + IY - 1) ^ 2 + B * (FirstYear + IY - 1) + C)\rEnd If\r\r\r'\r'   ALL YEARS\r'   -------------------------------------------------------------------------\r\r'If IY + FirstYear - 1 = 2100 Then Stop\rLoadCostAdjFactor(USidx, context)\rDim phaseInFact As Single\r'jrs 2014/06/09\rIf hlcostleyrper > 0 Then\rIf hlcostleyrperFirstYear = 0 Then\rhlcostleyrperFirstYear = IY\rEnd If\rIf hlcostletime > 0 Then\rIf IY >= 20 + hlcostleyrperFirstYear Then\rphaseInFact = 1 / hlcostletime\rElse\rphaseInFact = 1 / hlcostletime * (IY - hlcostleyrperFirstYear + 1) / 21\rEnd If\rEnd If\rEnd If\r\r'jrs 2021/08/05 end\r\r'jrs 2008/08/20\r'All Years: apply Obesity Effect to Cardiovascular Diseases\r'-------------------------------------------------------------\rIf IY > 1 And j > 6 Then\r'jrs 2009/09/21\r'                        If k = 5 Then\r'                            modmordstdet(j, R%, k) = modmordstdet(j, R%, k) * (1 + ObDiffM)\r'                        ElseIf k = 6 Then\r'                            modmordstdet(j, R%, k) = modmordstdet(j, R%, k) * (1 + ObDiffF)\r'                        End If\rG = k - 4 '1 for males, 2 for females\rIf k = 5 Or k = 6 Then\rSelect Case j\rCase 7, 8, 9 '30-44\rmodmordstdet(j, R%, k) = modmordstdet(j, R%, k) * (1 + BMIDiff(1, G))\rCase 10, 11, 12 '45-59\rmodmordstdet(j, R%, k) = modmordstdet(j, R%, k) * (1 + BMIDiff(2, G))\rCase 13, 14 '60-69\rmodmordstdet(j, R%, k) = modmordstdet(j, R%, k) * (1 + BMIDiff(3, G))\rCase 15, 16 '70-79\rmodmordstdet(j, R%, k) = modmordstdet(j, R%, k) * (1 + BMIDiff(4, G))\rCase Else '80+\rmodmordstdet(j, R%, k) = modmordstdet(j, R%, k) * (1 + BMIDiff(5, G))\rEnd Select\rEnd If\rEnd If\r\r'jrs 2021/08/05 end\r\r'All Years: apply Obesity Effect to Cardiovascular Diseases\r'-------------------------------------------------------------\rIf j > 6 Then\r'jrs 2009/09/21\r'                                If k = 5 Then\r'                                    modmordstdet2(j, R%, k) = modmordstdet2(j, R%, k) * (1 + ObDiffM)\r'                                ElseIf k = 6 Then\r'                                    modmordstdet2(j, R%, k) = modmordstdet2(j, R%, k) * (1 + ObDiffF)\r'                                End If\rG = k - 4 '1 for males, 2 for females\rIf k = 5 Or k = 6 Then\rSelect Case j\rCase 7, 8, 9 '30-44\rmodmordstdet2(j, R%, k) = modmordstdet2(j, R%, k) * (1 + BMIDiff(1, G))\rCase 10, 11, 12 '45-59\rmodmordstdet2(j, R%, k) = modmordstdet2(j, R%, k) * (1 + BMIDiff(2, G))\rCase 13, 14 '60-69\rmodmordstdet2(j, R%, k) = modmordstdet2(j, R%, k) * (1 + BMIDiff(3, G))\rCase 15, 16 '70-79\rmodmordstdet2(j, R%, k) = modmordstdet2(j, R%, k) * (1 + BMIDiff(4, G))\rCase Else '80+\rmodmordstdet2(j, R%, k) = modmordstdet2(j, R%, k) * (1 + BMIDiff(5, G))\rEnd Select\rEnd If\rEnd If\r\r\rElse\rIf Not SMOKINGTRANCOEFF(R, 1, 2).HasValue Then\rSMOKINGTRANCOEFF(R, 4, 2) = Amin(HLSMOKING(R%, 2), hlsmokingceiling(2))\r'jrs 2011/12/12\rHLSMOKING(R%, 2) = Amin(HLSMOKING(R%, 2), hlsmokingceiling(2))\rElse\rA = CSng(SMOKINGTRANCOEFF(R, 1, 2))\rB = CSng(SMOKINGTRANCOEFF(R, 2, 2))\rC = CSng(SMOKINGTRANCOEFF(R, 3, 2))\r\rHLSMOKING(R%, 2) = CSng(A * (FirstYear + IY - 1) ^ 2 + B * (FirstYear + IY - 1) + C)\rEnd If\r"
  },
  {
    "Variable": "HLCOSTLE",
    "UsesVariable": "HLSMOKING",
    "Distance": 887,
    "Code": "\r\r'\r'   ALL YEARS\r'   -------------------------------------------------------------------------\r\r'If IY + FirstYear - 1 = 2100 Then Stop\rLoadCostAdjFactor(USidx, context)\rDim phaseInFact As Single\r'jrs 2014/06/09\rIf hlcostleyrper > 0 Then\rIf hlcostleyrperFirstYear = 0 Then\rhlcostleyrperFirstYear = IY\rEnd If\rIf hlcostletime > 0 Then\rIf IY >= 20 + hlcostleyrperFirstYear Then\rphaseInFact = 1 / hlcostletime\rElse\rphaseInFact = 1 / hlcostletime * (IY - hlcostleyrperFirstYear + 1) / 21\rEnd If\rEnd If\rEnd If\r"
  },
  {
    "Variable": "HLCOSTLE",
    "UsesVariable": "hlsmokingceiling",
    "Distance": 887,
    "Code": "\r\r'\r'   ALL YEARS\r'   -------------------------------------------------------------------------\r\r'If IY + FirstYear - 1 = 2100 Then Stop\rLoadCostAdjFactor(USidx, context)\rDim phaseInFact As Single\r'jrs 2014/06/09\rIf hlcostleyrper > 0 Then\rIf hlcostleyrperFirstYear = 0 Then\rhlcostleyrperFirstYear = IY\rEnd If\rIf hlcostletime > 0 Then\rIf IY >= 20 + hlcostleyrperFirstYear Then\rphaseInFact = 1 / hlcostletime\rElse\rphaseInFact = 1 / hlcostletime * (IY - hlcostleyrperFirstYear + 1) / 21\rEnd If\rEnd If\rEnd If\r"
  },
  {
    "Variable": "HLCOSTLESUB",
    "UsesVariable": "hlcostleyrper",
    "Distance": 0,
    "Code": "\r'for Males and Females\rFor G = 1 To 2\r'Morbidity Cost\r'--------------\r'jrs 2014/05/30\r'                If HLYLL(R, T, G) <> 0 Then\r'                    HLCOSTMORB(R, T) = HLCOSTMORB(R, T) + DEATHCAT(R, T, G) * HLYLD(R, T, G) / HLYLL(R, T, G) * CostMorbRT\r'                Else\r'                    For A = 0 To NCohorts\r'                        HLCOSTMORB(R, T) = HLCOSTMORB(R, T) + modmorbdstdet(A, R, 2 * (T - 1) + G) * agedst(A, R, G) * CostMorbRT / 1000\r'                    Next A\r'                End If\rFor A = 0 To NCohorts\rHLCOSTMORB(R, T) = CSng(HLCOSTMORB(R, T) + modmorbdstdet(A, R, 2 * (T - 1) + G) * agedst(A, R, G) * CostMorbRT / 1000)\rNext A\r\r'Mortality Cost\r'--------------\rHLCOSTMORT(R, T) = HLCOSTMORT(R, T) + DEATHCAT(R, T, G) * CostMortRT\r'Life Extension Cost for Adults 30 or older\r'------------------------------------------\r'jrs 2014/06/03 no need to add up for each type\rIf T = 1 Then\rFor A = hlCostageSt To NCohorts 'jrs 2014/06/05 we were using 7 for Adults 30 or older, but acutally the treatment starts at 15 for CDs and 25 for NCDs and Injuries, so I'm using the max, in the base case 25\r'jrs 2014/06/05 added phase in factor\r'using Cost Adjust Factor to adapt cost of life extension treatment\r'bbh 2014/06/07 start\rCostFactorM = AMAX(0.05, Amin(1, CostAdjFactorMorb(R, T)))\r'                       HLCOSTLE(R) = HLCOSTLE(R) + hlcostleyrper * CostAdjFactorMorb(R, T) * agedst(A, R, G) * phaseInFact 'jrs 2014/06/02 LifeExtensionCostPerCap * agedst(A, R, G)\rHLCOSTLE(R) = CSng(HLCOSTLE(R) + hlcostleyrper * CostFactorM * agedst(A, R, G) * phaseInFact) 'jrs 2014/06/02 LifeExtensionCostPerCap * agedst(A, R, G)\r'jrs 2014/06/09\rHLCOSTLESUB(R) = CSng(HLCOSTLESUB(R) + hlcostleyrper * (1 - CostFactorM) * agedst(A, R, G) * phaseInFact)\r'HLCOSTLE(R) = HLCOSTLE(R) + hlcostleyrper * agedst(A, R, G)\rNext A\rEnd If\rNext G\r"
  },
  {
    "Variable": "HLCOSTLESUB",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r'for Males and Females\rFor G = 1 To 2\r'Morbidity Cost\r'--------------\r'jrs 2014/05/30\r'                If HLYLL(R, T, G) <> 0 Then\r'                    HLCOSTMORB(R, T) = HLCOSTMORB(R, T) + DEATHCAT(R, T, G) * HLYLD(R, T, G) / HLYLL(R, T, G) * CostMorbRT\r'                Else\r'                    For A = 0 To NCohorts\r'                        HLCOSTMORB(R, T) = HLCOSTMORB(R, T) + modmorbdstdet(A, R, 2 * (T - 1) + G) * agedst(A, R, G) * CostMorbRT / 1000\r'                    Next A\r'                End If\rFor A = 0 To NCohorts\rHLCOSTMORB(R, T) = CSng(HLCOSTMORB(R, T) + modmorbdstdet(A, R, 2 * (T - 1) + G) * agedst(A, R, G) * CostMorbRT / 1000)\rNext A\r\r'Mortality Cost\r'--------------\rHLCOSTMORT(R, T) = HLCOSTMORT(R, T) + DEATHCAT(R, T, G) * CostMortRT\r'Life Extension Cost for Adults 30 or older\r'------------------------------------------\r'jrs 2014/06/03 no need to add up for each type\rIf T = 1 Then\rFor A = hlCostageSt To NCohorts 'jrs 2014/06/05 we were using 7 for Adults 30 or older, but acutally the treatment starts at 15 for CDs and 25 for NCDs and Injuries, so I'm using the max, in the base case 25\r'jrs 2014/06/05 added phase in factor\r'using Cost Adjust Factor to adapt cost of life extension treatment\r'bbh 2014/06/07 start\rCostFactorM = AMAX(0.05, Amin(1, CostAdjFactorMorb(R, T)))\r'                       HLCOSTLE(R) = HLCOSTLE(R) + hlcostleyrper * CostAdjFactorMorb(R, T) * agedst(A, R, G) * phaseInFact 'jrs 2014/06/02 LifeExtensionCostPerCap * agedst(A, R, G)\rHLCOSTLE(R) = CSng(HLCOSTLE(R) + hlcostleyrper * CostFactorM * agedst(A, R, G) * phaseInFact) 'jrs 2014/06/02 LifeExtensionCostPerCap * agedst(A, R, G)\r'jrs 2014/06/09\rHLCOSTLESUB(R) = CSng(HLCOSTLESUB(R) + hlcostleyrper * (1 - CostFactorM) * agedst(A, R, G) * phaseInFact)\r'HLCOSTLE(R) = HLCOSTLE(R) + hlcostleyrper * agedst(A, R, G)\rNext A\rEnd If\rNext G\r"
  },
  {
    "Variable": "HLCOSTLESUB",
    "UsesVariable": "hlcostletime",
    "Distance": 15,
    "Code": "\r\r'jrs 2007/06/27\r'All Years: Smoking Impact - Compute Averages for All Ages and Accross Gender\r'----------------------------------------------------------------------------\rComputeSmokAvgAllAgesSex()\r\r'All Years: Diabetes Relative Risk - Compute Averages for All Ages and Accross Gender\r'------------------------------------------------------------------------------------\rComputeAvgDiabRRAgeSex(popgdr)\r\r'jrs 2018/04/19\r'All Years: Converge Intentional Injury time coeficient to avoid going too high over long horizons\r'-------------------------------------------------------------------------------------------------\r'jrs 2018/05/25\r'jrs 2020/08/19 Dim IY2030 As Integer move out, I don't know why it wasn't resetting to 0 every year\rDim k As Integer\r\rIf IY% = 1 Then\rReDim IntInjTimeFactors(12, 2)\r'for both genders\rFor k = 17 To 18\r'ages 5 to 59\rFor j = 2 To 12\rIntInjTimeFactors(j, k Mod 2) = mortFactors(j, k, 5, 2)\rNext j\rNext k\r'jrs 2018/05/25\rIY2030 = (2030 - BaseYear + 1)\rEnd If\r\r\r'jrs 2010/02/18\r'if doing mental health\rIf (k = 29 Or k = 30) And modmordstdet(j, R%, k) > 0 Then\r'Remove it from Other NCDs\rIf modmordstdet(j, R%, k - 18) >= modmordstdet(j, R%, k) Then\rmodmordstdet(j, R%, k - 18) = modmordstdet(j, R%, k - 18) - modmordstdet(j, R%, k)\rEnd If\rEnd If\r\r\rElse\rIf Not SMOKINGTRANCOEFF(R, 1, 2).HasValue Then\rSMOKINGTRANCOEFF(R, 4, 2) = Amin(HLSMOKING(R%, 2), hlsmokingceiling(2))\r'jrs 2011/12/12\rHLSMOKING(R%, 2) = Amin(HLSMOKING(R%, 2), hlsmokingceiling(2))\rElse\rA = CSng(SMOKINGTRANCOEFF(R, 1, 2))\rB = CSng(SMOKINGTRANCOEFF(R, 2, 2))\rC = CSng(SMOKINGTRANCOEFF(R, 3, 2))\r\rHLSMOKING(R%, 2) = CSng(A * (FirstYear + IY - 1) ^ 2 + B * (FirstYear + IY - 1) + C)\rEnd If\r\r\r'\r'   ALL YEARS\r'   -------------------------------------------------------------------------\r\r'If IY + FirstYear - 1 = 2100 Then Stop\rLoadCostAdjFactor(USidx, context)\rDim phaseInFact As Single\r'jrs 2014/06/09\rIf hlcostleyrper > 0 Then\rIf hlcostleyrperFirstYear = 0 Then\rhlcostleyrperFirstYear = IY\rEnd If\rIf hlcostletime > 0 Then\rIf IY >= 20 + hlcostleyrperFirstYear Then\rphaseInFact = 1 / hlcostletime\rElse\rphaseInFact = 1 / hlcostletime * (IY - hlcostleyrperFirstYear + 1) / 21\rEnd If\rEnd If\rEnd If\r\r'jrs 2021/08/05 end\r\r'jrs 2008/08/20\r'All Years: apply Obesity Effect to Cardiovascular Diseases\r'-------------------------------------------------------------\rIf IY > 1 And j > 6 Then\r'jrs 2009/09/21\r'                        If k = 5 Then\r'                            modmordstdet(j, R%, k) = modmordstdet(j, R%, k) * (1 + ObDiffM)\r'                        ElseIf k = 6 Then\r'                            modmordstdet(j, R%, k) = modmordstdet(j, R%, k) * (1 + ObDiffF)\r'                        End If\rG = k - 4 '1 for males, 2 for females\rIf k = 5 Or k = 6 Then\rSelect Case j\rCase 7, 8, 9 '30-44\rmodmordstdet(j, R%, k) = modmordstdet(j, R%, k) * (1 + BMIDiff(1, G))\rCase 10, 11, 12 '45-59\rmodmordstdet(j, R%, k) = modmordstdet(j, R%, k) * (1 + BMIDiff(2, G))\rCase 13, 14 '60-69\rmodmordstdet(j, R%, k) = modmordstdet(j, R%, k) * (1 + BMIDiff(3, G))\rCase 15, 16 '70-79\rmodmordstdet(j, R%, k) = modmordstdet(j, R%, k) * (1 + BMIDiff(4, G))\rCase Else '80+\rmodmordstdet(j, R%, k) = modmordstdet(j, R%, k) * (1 + BMIDiff(5, G))\rEnd Select\rEnd If\rEnd If\r\r'jrs 2021/08/05 end\r\r'All Years: apply Obesity Effect to Cardiovascular Diseases\r'-------------------------------------------------------------\rIf j > 6 Then\r'jrs 2009/09/21\r'                                If k = 5 Then\r'                                    modmordstdet2(j, R%, k) = modmordstdet2(j, R%, k) * (1 + ObDiffM)\r'                                ElseIf k = 6 Then\r'                                    modmordstdet2(j, R%, k) = modmordstdet2(j, R%, k) * (1 + ObDiffF)\r'                                End If\rG = k - 4 '1 for males, 2 for females\rIf k = 5 Or k = 6 Then\rSelect Case j\rCase 7, 8, 9 '30-44\rmodmordstdet2(j, R%, k) = modmordstdet2(j, R%, k) * (1 + BMIDiff(1, G))\rCase 10, 11, 12 '45-59\rmodmordstdet2(j, R%, k) = modmordstdet2(j, R%, k) * (1 + BMIDiff(2, G))\rCase 13, 14 '60-69\rmodmordstdet2(j, R%, k) = modmordstdet2(j, R%, k) * (1 + BMIDiff(3, G))\rCase 15, 16 '70-79\rmodmordstdet2(j, R%, k) = modmordstdet2(j, R%, k) * (1 + BMIDiff(4, G))\rCase Else '80+\rmodmordstdet2(j, R%, k) = modmordstdet2(j, R%, k) * (1 + BMIDiff(5, G))\rEnd Select\rEnd If\rEnd If\r\r\rElse\rIf Not SMOKINGTRANCOEFF(R, 1, 2).HasValue Then\rSMOKINGTRANCOEFF(R, 4, 2) = Amin(HLSMOKING(R%, 2), hlsmokingceiling(2))\r'jrs 2011/12/12\rHLSMOKING(R%, 2) = Amin(HLSMOKING(R%, 2), hlsmokingceiling(2))\rElse\rA = CSng(SMOKINGTRANCOEFF(R, 1, 2))\rB = CSng(SMOKINGTRANCOEFF(R, 2, 2))\rC = CSng(SMOKINGTRANCOEFF(R, 3, 2))\r\rHLSMOKING(R%, 2) = CSng(A * (FirstYear + IY - 1) ^ 2 + B * (FirstYear + IY - 1) + C)\rEnd If\r"
  },
  {
    "Variable": "HLCOSTLESUB",
    "UsesVariable": "HLSMOKING",
    "Distance": 888,
    "Code": "\r\r'\r'   ALL YEARS\r'   -------------------------------------------------------------------------\r\r'If IY + FirstYear - 1 = 2100 Then Stop\rLoadCostAdjFactor(USidx, context)\rDim phaseInFact As Single\r'jrs 2014/06/09\rIf hlcostleyrper > 0 Then\rIf hlcostleyrperFirstYear = 0 Then\rhlcostleyrperFirstYear = IY\rEnd If\rIf hlcostletime > 0 Then\rIf IY >= 20 + hlcostleyrperFirstYear Then\rphaseInFact = 1 / hlcostletime\rElse\rphaseInFact = 1 / hlcostletime * (IY - hlcostleyrperFirstYear + 1) / 21\rEnd If\rEnd If\rEnd If\r"
  },
  {
    "Variable": "HLCOSTLESUB",
    "UsesVariable": "hlsmokingceiling",
    "Distance": 888,
    "Code": "\r\r'\r'   ALL YEARS\r'   -------------------------------------------------------------------------\r\r'If IY + FirstYear - 1 = 2100 Then Stop\rLoadCostAdjFactor(USidx, context)\rDim phaseInFact As Single\r'jrs 2014/06/09\rIf hlcostleyrper > 0 Then\rIf hlcostleyrperFirstYear = 0 Then\rhlcostleyrperFirstYear = IY\rEnd If\rIf hlcostletime > 0 Then\rIf IY >= 20 + hlcostleyrperFirstYear Then\rphaseInFact = 1 / hlcostletime\rElse\rphaseInFact = 1 / hlcostletime * (IY - hlcostleyrperFirstYear + 1) / 21\rEnd If\rEnd If\rEnd If\r"
  },
  {
    "Variable": "HLCOSTMORB",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r'jrs 2021/08/05 end\r\r'jrs 2008/08/20\r'All Years: apply Obesity Effect to Cardiovascular Diseases\r'-------------------------------------------------------------\rIf IY > 1 And j > 6 Then\r'jrs 2009/09/21\r'                        If k = 5 Then\r'                            modmordstdet(j, R%, k) = modmordstdet(j, R%, k) * (1 + ObDiffM)\r'                        ElseIf k = 6 Then\r'                            modmordstdet(j, R%, k) = modmordstdet(j, R%, k) * (1 + ObDiffF)\r'                        End If\rG = k - 4 '1 for males, 2 for females\rIf k = 5 Or k = 6 Then\rSelect Case j\rCase 7, 8, 9 '30-44\rmodmordstdet(j, R%, k) = modmordstdet(j, R%, k) * (1 + BMIDiff(1, G))\rCase 10, 11, 12 '45-59\rmodmordstdet(j, R%, k) = modmordstdet(j, R%, k) * (1 + BMIDiff(2, G))\rCase 13, 14 '60-69\rmodmordstdet(j, R%, k) = modmordstdet(j, R%, k) * (1 + BMIDiff(3, G))\rCase 15, 16 '70-79\rmodmordstdet(j, R%, k) = modmordstdet(j, R%, k) * (1 + BMIDiff(4, G))\rCase Else '80+\rmodmordstdet(j, R%, k) = modmordstdet(j, R%, k) * (1 + BMIDiff(5, G))\rEnd Select\rEnd If\rEnd If\r\r'jrs 2021/08/05 end\r\r'All Years: apply Obesity Effect to Cardiovascular Diseases\r'-------------------------------------------------------------\rIf j > 6 Then\r'jrs 2009/09/21\r'                                If k = 5 Then\r'                                    modmordstdet2(j, R%, k) = modmordstdet2(j, R%, k) * (1 + ObDiffM)\r'                                ElseIf k = 6 Then\r'                                    modmordstdet2(j, R%, k) = modmordstdet2(j, R%, k) * (1 + ObDiffF)\r'                                End If\rG = k - 4 '1 for males, 2 for females\rIf k = 5 Or k = 6 Then\rSelect Case j\rCase 7, 8, 9 '30-44\rmodmordstdet2(j, R%, k) = modmordstdet2(j, R%, k) * (1 + BMIDiff(1, G))\rCase 10, 11, 12 '45-59\rmodmordstdet2(j, R%, k) = modmordstdet2(j, R%, k) * (1 + BMIDiff(2, G))\rCase 13, 14 '60-69\rmodmordstdet2(j, R%, k) = modmordstdet2(j, R%, k) * (1 + BMIDiff(3, G))\rCase 15, 16 '70-79\rmodmordstdet2(j, R%, k) = modmordstdet2(j, R%, k) * (1 + BMIDiff(4, G))\rCase Else '80+\rmodmordstdet2(j, R%, k) = modmordstdet2(j, R%, k) * (1 + BMIDiff(5, G))\rEnd Select\rEnd If\rEnd If\r\r\rElse\rIf Not SMOKINGTRANCOEFF(R, 1, 2).HasValue Then\rSMOKINGTRANCOEFF(R, 4, 2) = Amin(HLSMOKING(R%, 2), hlsmokingceiling(2))\r'jrs 2011/12/12\rHLSMOKING(R%, 2) = Amin(HLSMOKING(R%, 2), hlsmokingceiling(2))\rElse\rA = CSng(SMOKINGTRANCOEFF(R, 1, 2))\rB = CSng(SMOKINGTRANCOEFF(R, 2, 2))\rC = CSng(SMOKINGTRANCOEFF(R, 3, 2))\r\rHLSMOKING(R%, 2) = CSng(A * (FirstYear + IY - 1) ^ 2 + B * (FirstYear + IY - 1) + C)\rEnd If\r\r\r'jrs 2009/08/18\rPrivate Sub LoadMorbidityDetail(modmorbdstdet(,,) As Double)\r\rDim R, j As Integer\r\rUsing db As IFs2Context = New IFs2Context()\r\rFor Each valtbl In db.HealthYLDComMatPerCohortRegionMale\rR = valtbl.RegionId\rFor Each coh In valtbl.Cohorts\rj = CInt(coh.Key.Replace(\"Cohort\", \"\"))\rmodmorbdstdet(j, R, 1) = coh.Value\rIf j = NCohorts Then Exit For\rNext\rNext\r\rFor Each valtbl In db.HealthYLDComMatPerCohortRegionFemale\rR = valtbl.RegionId\rFor Each coh In valtbl.Cohorts\rj = CInt(coh.Key.Replace(\"Cohort\", \"\"))\rmodmorbdstdet(j, R, 2) = coh.Value\rIf j = NCohorts Then Exit For\rNext\rNext\r\rFor Each valtbl In db.HealthYLDNonComDisCohortRegionMale\rR = valtbl.RegionId\rFor Each coh In valtbl.Cohorts\rj = CInt(coh.Key.Replace(\"Cohort\", \"\"))\rmodmorbdstdet(j, R, 3) = coh.Value\rIf j = NCohorts Then Exit For\rNext\rNext\r\rFor Each valtbl In db.HealthYLDNonComDisCohortRegionFemale\rR = valtbl.RegionId\rFor Each coh In valtbl.Cohorts\rj = CInt(coh.Key.Replace(\"Cohort\", \"\"))\rmodmorbdstdet(j, R, 4) = coh.Value\rIf j = NCohorts Then Exit For\rNext\rNext\r\rFor Each valtbl In db.HealthYLDInjuriesCohortRegionMale\rR = valtbl.RegionId\rFor Each coh In valtbl.Cohorts\rj = CInt(coh.Key.Replace(\"Cohort\", \"\"))\rmodmorbdstdet(j, R, 5) = coh.Value\rIf j = NCohorts Then Exit For\rNext\rNext\r\rFor Each valtbl In db.HealthYLDInjuriesCohortRegionFemale\rR = valtbl.RegionId\rFor Each coh In valtbl.Cohorts\rj = CInt(coh.Key.Replace(\"Cohort\", \"\"))\rmodmorbdstdet(j, R, 6) = coh.Value\rIf j = NCohorts Then Exit For\rNext\rNext\r\rEnd Using\r\rEnd Sub\r\r'for Males and Females\rFor G = 1 To 2\r'Morbidity Cost\r'--------------\r'jrs 2014/05/30\r'                If HLYLL(R, T, G) <> 0 Then\r'                    HLCOSTMORB(R, T) = HLCOSTMORB(R, T) + DEATHCAT(R, T, G) * HLYLD(R, T, G) / HLYLL(R, T, G) * CostMorbRT\r'                Else\r'                    For A = 0 To NCohorts\r'                        HLCOSTMORB(R, T) = HLCOSTMORB(R, T) + modmorbdstdet(A, R, 2 * (T - 1) + G) * agedst(A, R, G) * CostMorbRT / 1000\r'                    Next A\r'                End If\rFor A = 0 To NCohorts\rHLCOSTMORB(R, T) = CSng(HLCOSTMORB(R, T) + modmorbdstdet(A, R, 2 * (T - 1) + G) * agedst(A, R, G) * CostMorbRT / 1000)\rNext A\r\r'Mortality Cost\r'--------------\rHLCOSTMORT(R, T) = HLCOSTMORT(R, T) + DEATHCAT(R, T, G) * CostMortRT\r'Life Extension Cost for Adults 30 or older\r'------------------------------------------\r'jrs 2014/06/03 no need to add up for each type\rIf T = 1 Then\rFor A = hlCostageSt To NCohorts 'jrs 2014/06/05 we were using 7 for Adults 30 or older, but acutally the treatment starts at 15 for CDs and 25 for NCDs and Injuries, so I'm using the max, in the base case 25\r'jrs 2014/06/05 added phase in factor\r'using Cost Adjust Factor to adapt cost of life extension treatment\r'bbh 2014/06/07 start\rCostFactorM = AMAX(0.05, Amin(1, CostAdjFactorMorb(R, T)))\r'                       HLCOSTLE(R) = HLCOSTLE(R) + hlcostleyrper * CostAdjFactorMorb(R, T) * agedst(A, R, G) * phaseInFact 'jrs 2014/06/02 LifeExtensionCostPerCap * agedst(A, R, G)\rHLCOSTLE(R) = CSng(HLCOSTLE(R) + hlcostleyrper * CostFactorM * agedst(A, R, G) * phaseInFact) 'jrs 2014/06/02 LifeExtensionCostPerCap * agedst(A, R, G)\r'jrs 2014/06/09\rHLCOSTLESUB(R) = CSng(HLCOSTLESUB(R) + hlcostleyrper * (1 - CostFactorM) * agedst(A, R, G) * phaseInFact)\r'HLCOSTLE(R) = HLCOSTLE(R) + hlcostleyrper * agedst(A, R, G)\rNext A\rEnd If\rNext G\r\r'jrs 2014/05/07\r'Shift factor to adjust countries where other cost was initially below the minimum\rIf IY > 1 Then\rHLCOSTMORT(R, T) = HLCOSTMORT(R, T) * HLCOSTMORTShift(R, T)\rHLCOSTMORB(R, T) = HLCOSTMORB(R, T) * HLCOSTMORBShift(R, T)\rHLCOSTMORBShift(R, T) = 1\rEnd If\r\r'for each disease type\rFor T = 1 To CInt(Ntypes / 2)\rHLCOSTMORTShift(R, T) = diff / (MortCost + MorbCost)\rHLCOSTMORT(R, T) = HLCOSTMORT(R, T) * HLCOSTMORTShift(R, T)\rHLCOSTMORBShift(R, T) = diff / (MortCost + MorbCost)\rHLCOSTMORB(R, T) = HLCOSTMORB(R, T) * HLCOSTMORBShift(R, T)\r'jts 2014/06/03\rCostMorbT = CostMorbT + HLCOSTMORB(R, T)\rCostMortT = CostMortT + HLCOSTMORT(R, T)\rNext T\r"
  },
  {
    "Variable": "HLCOSTMORB",
    "UsesVariable": "HLSMOKING",
    "Distance": 884,
    "Code": "\r\r'jrs 2007/06/27\r'All Years: Smoking Impact - Compute Averages for All Ages and Accross Gender\r'----------------------------------------------------------------------------\rComputeSmokAvgAllAgesSex()\r\r'All Years: Diabetes Relative Risk - Compute Averages for All Ages and Accross Gender\r'------------------------------------------------------------------------------------\rComputeAvgDiabRRAgeSex(popgdr)\r\r'jrs 2018/04/19\r'All Years: Converge Intentional Injury time coeficient to avoid going too high over long horizons\r'-------------------------------------------------------------------------------------------------\r'jrs 2018/05/25\r'jrs 2020/08/19 Dim IY2030 As Integer move out, I don't know why it wasn't resetting to 0 every year\rDim k As Integer\r\rIf IY% = 1 Then\rReDim IntInjTimeFactors(12, 2)\r'for both genders\rFor k = 17 To 18\r'ages 5 to 59\rFor j = 2 To 12\rIntInjTimeFactors(j, k Mod 2) = mortFactors(j, k, 5, 2)\rNext j\rNext k\r'jrs 2018/05/25\rIY2030 = (2030 - BaseYear + 1)\rEnd If\r\r\r'jrs 2010/02/18\r'if doing mental health\rIf (k = 29 Or k = 30) And modmordstdet(j, R%, k) > 0 Then\r'Remove it from Other NCDs\rIf modmordstdet(j, R%, k - 18) >= modmordstdet(j, R%, k) Then\rmodmordstdet(j, R%, k - 18) = modmordstdet(j, R%, k - 18) - modmordstdet(j, R%, k)\rEnd If\rEnd If\r\r\rElse\rIf Not SMOKINGTRANCOEFF(R, 1, 2).HasValue Then\rSMOKINGTRANCOEFF(R, 4, 2) = Amin(HLSMOKING(R%, 2), hlsmokingceiling(2))\r'jrs 2011/12/12\rHLSMOKING(R%, 2) = Amin(HLSMOKING(R%, 2), hlsmokingceiling(2))\rElse\rA = CSng(SMOKINGTRANCOEFF(R, 1, 2))\rB = CSng(SMOKINGTRANCOEFF(R, 2, 2))\rC = CSng(SMOKINGTRANCOEFF(R, 3, 2))\r\rHLSMOKING(R%, 2) = CSng(A * (FirstYear + IY - 1) ^ 2 + B * (FirstYear + IY - 1) + C)\rEnd If\r\r\r'For each Disease Type\rFor T = 1 To CInt(Ntypes / 2)\r'If R = 12 And T = 3 And IY + FirstYear - 1 = 2100 Then Stop\r'similar to the Netherlands (European for now)\rIf bType2Countrys(R) Then\rCostMorbRT = BaseCostMorb2(T) * CostAdjFactorMorb2(R, T)\rCostMortRT = BaseCostMort2(T) * CostAdjFactorMort2(R, T)\rElse 'similar to the US (rest of the World)\rCostMorbRT = BaseCostMorb(T) * CostAdjFactorMorb(R, T)\rCostMortRT = BaseCostMort(T) * CostAdjFactorMort(R, T)\rEnd If\r"
  },
  {
    "Variable": "HLCOSTMORB",
    "UsesVariable": "hlsmokingceiling",
    "Distance": 884,
    "Code": "\r\r'jrs 2007/06/27\r'All Years: Smoking Impact - Compute Averages for All Ages and Accross Gender\r'----------------------------------------------------------------------------\rComputeSmokAvgAllAgesSex()\r\r'All Years: Diabetes Relative Risk - Compute Averages for All Ages and Accross Gender\r'------------------------------------------------------------------------------------\rComputeAvgDiabRRAgeSex(popgdr)\r\r'jrs 2018/04/19\r'All Years: Converge Intentional Injury time coeficient to avoid going too high over long horizons\r'-------------------------------------------------------------------------------------------------\r'jrs 2018/05/25\r'jrs 2020/08/19 Dim IY2030 As Integer move out, I don't know why it wasn't resetting to 0 every year\rDim k As Integer\r\rIf IY% = 1 Then\rReDim IntInjTimeFactors(12, 2)\r'for both genders\rFor k = 17 To 18\r'ages 5 to 59\rFor j = 2 To 12\rIntInjTimeFactors(j, k Mod 2) = mortFactors(j, k, 5, 2)\rNext j\rNext k\r'jrs 2018/05/25\rIY2030 = (2030 - BaseYear + 1)\rEnd If\r"
  },
  {
    "Variable": "HLCOSTMORT",
    "UsesVariable": "DEATHCAT",
    "Distance": 0,
    "Code": "\r'for Males and Females\rFor G = 1 To 2\r'Morbidity Cost\r'--------------\r'jrs 2014/05/30\r'                If HLYLL(R, T, G) <> 0 Then\r'                    HLCOSTMORB(R, T) = HLCOSTMORB(R, T) + DEATHCAT(R, T, G) * HLYLD(R, T, G) / HLYLL(R, T, G) * CostMorbRT\r'                Else\r'                    For A = 0 To NCohorts\r'                        HLCOSTMORB(R, T) = HLCOSTMORB(R, T) + modmorbdstdet(A, R, 2 * (T - 1) + G) * agedst(A, R, G) * CostMorbRT / 1000\r'                    Next A\r'                End If\rFor A = 0 To NCohorts\rHLCOSTMORB(R, T) = CSng(HLCOSTMORB(R, T) + modmorbdstdet(A, R, 2 * (T - 1) + G) * agedst(A, R, G) * CostMorbRT / 1000)\rNext A\r\r'Mortality Cost\r'--------------\rHLCOSTMORT(R, T) = HLCOSTMORT(R, T) + DEATHCAT(R, T, G) * CostMortRT\r'Life Extension Cost for Adults 30 or older\r'------------------------------------------\r'jrs 2014/06/03 no need to add up for each type\rIf T = 1 Then\rFor A = hlCostageSt To NCohorts 'jrs 2014/06/05 we were using 7 for Adults 30 or older, but acutally the treatment starts at 15 for CDs and 25 for NCDs and Injuries, so I'm using the max, in the base case 25\r'jrs 2014/06/05 added phase in factor\r'using Cost Adjust Factor to adapt cost of life extension treatment\r'bbh 2014/06/07 start\rCostFactorM = AMAX(0.05, Amin(1, CostAdjFactorMorb(R, T)))\r'                       HLCOSTLE(R) = HLCOSTLE(R) + hlcostleyrper * CostAdjFactorMorb(R, T) * agedst(A, R, G) * phaseInFact 'jrs 2014/06/02 LifeExtensionCostPerCap * agedst(A, R, G)\rHLCOSTLE(R) = CSng(HLCOSTLE(R) + hlcostleyrper * CostFactorM * agedst(A, R, G) * phaseInFact) 'jrs 2014/06/02 LifeExtensionCostPerCap * agedst(A, R, G)\r'jrs 2014/06/09\rHLCOSTLESUB(R) = CSng(HLCOSTLESUB(R) + hlcostleyrper * (1 - CostFactorM) * agedst(A, R, G) * phaseInFact)\r'HLCOSTLE(R) = HLCOSTLE(R) + hlcostleyrper * agedst(A, R, G)\rNext A\rEnd If\rNext G\r\r'jrs 2014/05/07\r'Shift factor to adjust countries where other cost was initially below the minimum\rIf IY > 1 Then\rHLCOSTMORT(R, T) = HLCOSTMORT(R, T) * HLCOSTMORTShift(R, T)\rHLCOSTMORB(R, T) = HLCOSTMORB(R, T) * HLCOSTMORBShift(R, T)\rHLCOSTMORBShift(R, T) = 1\rEnd If\r\r'for each disease type\rFor T = 1 To CInt(Ntypes / 2)\rHLCOSTMORTShift(R, T) = diff / (MortCost + MorbCost)\rHLCOSTMORT(R, T) = HLCOSTMORT(R, T) * HLCOSTMORTShift(R, T)\rHLCOSTMORBShift(R, T) = diff / (MortCost + MorbCost)\rHLCOSTMORB(R, T) = HLCOSTMORB(R, T) * HLCOSTMORBShift(R, T)\r'jts 2014/06/03\rCostMorbT = CostMorbT + HLCOSTMORB(R, T)\rCostMortT = CostMortT + HLCOSTMORT(R, T)\rNext T\r"
  },
  {
    "Variable": "HLCOSTOTHER",
    "UsesVariable": "HLCOST",
    "Distance": 0,
    "Code": "\r\r'jrs 2014/03/13\rPublic Sub IFsHealthCost(ByRef modmorbdstdet(,,) As Double, context As IForecastContext)\rIf IY% = 1 Then\r\rReDim BaseCostMorb(CInt(Ntypes / 2))\rReDim BaseCostMort(CInt(Ntypes / 2))\rReDim CostAdjFactorMorb(NR, CInt(Ntypes / 2))  'jrs 2014/05/08 added 2nd dimension\rReDim CostAdjFactorMort(NR, CInt(Ntypes / 2))\r'jrs 2014/04/29 ReDim ResidualCostPerCap(NR) As Single\rReDim BaseCostMorb2(CInt(Ntypes / 2))\rReDim BaseCostMort2(CInt(Ntypes / 2))\rReDim CostAdjFactorMorb2(NR, CInt(Ntypes / 2))\rReDim CostAdjFactorMort2(NR, CInt(Ntypes / 2))\r'jrs 2014/05/26 ReDim HLEXPENDPRIVShift(NR) As Single\rReDim bType2Countrys(NR)\r'jrs 2014/05/26 Dim PrivHLExp As Single\r'jrs 2014/05/06\rReDim IHLCOSTOTHER(NR)\r'jrs 2014/05/07\rReDim HLCOSTMORTShift(NR, CInt(Ntypes / 2))\rReDim HLCOSTMORBShift(NR, CInt(Ntypes / 2))\r'        PrivHLExpPctGDPFxName = \"GDP/Capita (PPP 2005) Versus Private Health Expenditures % of GDP (2012) Log\"\r'        PrivHLExpPctGDPFxName = getFunctionNameYrOrMstRct(PrivHLExpPctGDPFxName, BaseYear)\r\rLoadBaseCosts()\r'jrs 2014/08/05 LoadType2Countries\rUSidx = context.GetDimension(1).Buckets.First(Function(S) S.Value.Equals(\"United States of America\")).Key\r'jrs 2014/11/06\rIf USidx < 0 Then\rUSidx = context.GetDimension(1).Buckets.First(Function(S) S.Value.Equals(\"US-California\")).Key\rEnd If\r\r'jrs 2014/05/26\rReDim PrivExpToCost(NR%)\rReDim SHLCOST(NR%), SHLCOST2(NR%), SHealthExpToCostGap(NR%)\r\r'jrs 2014/06/05\rhlCostageSt = 0\rIf hllongvtystartage(1) > 0 Then\rhlCostageSt = CInt(hllongvtystartage(1) / 5 + 1)\rEnd If\rIf hllongvtystartage(2) > hllongvtystartage(1) Then\rhlCostageSt = CInt(hllongvtystartage(2) / 5 + 1)\rEnd If\rIf hllongvtystartage(3) > hllongvtystartage(2) Then\rhlCostageSt = CInt(hllongvtystartage(3) / 5 + 1)\rEnd If\r'jrs 2014/06/09\rhlcostleyrperFirstYear = 0\r\rEnd If\r\r'HLCOSTOTHER(R) = (HLCOSTOTHER(USidx) / GDP(USidx)) * GDP(R) / 4\rHLCOSTOTHER(R) = (HLCOSTOTHER(USidx) / HLCOST(USidx)) * HLCOST(R) / 4\r"
  },
  {
    "Variable": "HLCOSTOTHER",
    "UsesVariable": "POP",
    "Distance": 1259,
    "Code": "0"
  },
  {
    "Variable": "HLCOSTOTHER",
    "UsesVariable": "hlcostotherrattarget",
    "Distance": 0,
    "Code": "\r'jrs 2014/04/29\r'Initialize Residual Cost\r'        If IY = 1 Then\r'            'Match Health Expenditures\r'            ResidualCostPerCap(R) = HLCOST(R) 'jrs 2014/04/29 we were doing GDS which is public only\r'            'for each disease type\r'            For T = 1 To Ntypes / 2\r'                ResidualCostPerCap(R) = ResidualCostPerCap(R) - HLCOSTMORB(R, T) - HLCOSTMORT(R, T)\r'            Next T\r'            ResidualCostPerCap(R) = ResidualCostPerCap(R) - HLCOSTLE(R)\r'            ResidualCostPerCap(R) = ResidualCostPerCap(R) / POP(R)\r'        End If\r\r'Other Costs\r'-----------\r'jrs 2014/04/29 HLCOSTOTHER(R) = ResidualCostPerCap(R) * POP(R)\rIf IY = 1 Then\r'In year 1, cost = expenditures, HLCOST = GDS + EXPPriv\rHLCOSTOTHER(R) = GDS(R, Health) + HLEXPENDPRIV(R) 'HLCOST(R)\r'For each Disease Type\rFor T = 1 To CInt(Ntypes / 2)\r'Remove the cost of mortality and morbidity\rHLCOSTOTHER(R) = HLCOSTOTHER(R) - HLCOSTMORT(R, T) - HLCOSTMORB(R, T)\rNext T\r'jrs 2014/06/03 IHLCOSTOTHER(R) = HLCOSTOTHER(R)\rIHLCOSTOTHER(R) = HLCOSTOTHER(R) / (CostMortT + CostMorbT + HLCOSTLE(R))\rElse\r'jrs 2014/06/03 HLCOSTOTHER(R) = IHLCOSTOTHER(R) * GDPPC(R) / GDPPCI(R)\rHLCOSTOTHER(R) = IHLCOSTOTHER(R) * (CostMortT + CostMorbT + HLCOSTLE(R))\r'jrs 2014/06/10\rHLCOSTOTHER(R) = ConvergeOverTime(HLCOSTOTHER(R), hlcostotherrattarget * (CostMortT + CostMorbT + HLCOSTLE(R)), hlcostotherrattargetconv)\rEnd If\r\rmodmordstdet(j + 1, R, H1) = modmordstdet(j + 1, R, H1) - Adj * agedst(j, R, gender) / agedst(j + 1, R, gender)\r\r\r'jrs 2009/12/04 added newMort <= 1000\r'if adjustment fits in H1 then continue\rIf GrowthH1 >= ProxyGrowth(j, kkH1) And bPop2Check And newMort <= 750 And bMort2Check Then\rmodmordstdet(j + 1, R, k) = newMort\r'Tilt next segment to keep constant # of deaths\r'if working in last cohort remove excess from infants\rIf j < 20 Then\rmodmordstdet(j + 2, R, k) = modmordstdet(j + 2, R, k) - Adj * agedst(j + 1, R, gender) / agedst(j + 2, R, gender)\rElse\rmodmordstdet(iFstAge, R, k) = modmordstdet(iFstAge, R, k) - Adj * agedst(j + 1, R, gender) / agedst(iFstAge, R, gender)\rbReAdjust = True\rEnd If\r'adjust H1\rmodmordstdet(j + 1, R, H1) = modmordstdet(j + 1, R, H1) - Adj\r'tilt keeping # of deaths constant\r'if last cohort use infants to keep deaths constant\rIf j < 20 Then\rmodmordstdet(j + 2, R, H1) = modmordstdet(j + 2, R, H1) + Adj * agedst(j + 1, R, gender) / agedst(j + 2, R, gender)\rElse\rmodmordstdet(iFstAge, R, H1) = modmordstdet(iFstAge, R, H1) + Adj * agedst(j + 1, R, gender) / agedst(iFstAge, R, gender)\rEnd If\rElse\rbReAdjust = True\rEnd If 'if there's room in H1 (GrowthH1 >= ProxyGrowthH1)\r\r\r'jrs 2009/12/04 added newMort <= 1000\r'if adjustment fits in H1 then continue\rIf GrowthH1 >= ProxyGrowth(j, kkH1) And bPop2Check And newMort <= 750 And bMort2Check Then\rmodmordstdet(j + 1, R, k) = newMort\r'Tilt next segment to keep constant # of deaths\r'if working in last cohort remove excess from infants\rIf j < 20 Then\rmodmordstdet(j + 2, R, k) = modmordstdet(j + 2, R, k) - Adj * agedst(j + 1, R, gender) / agedst(j + 2, R, gender)\rElse\rmodmordstdet(iFstAge, R, k) = modmordstdet(iFstAge, R, k) - Adj * agedst(j + 1, R, gender) / agedst(iFstAge, R, gender)\rbReAdjust = True\rEnd If\r'adjust H1\rmodmordstdet(j + 1, R, H1) = modmordstdet(j + 1, R, H1) - Adj\r'tilt keeping # of deaths constant\r'if last cohort use infants to keep deaths constant\rIf j < 20 Then\rmodmordstdet(j + 2, R, H1) = modmordstdet(j + 2, R, H1) + Adj * agedst(j + 1, R, gender) / agedst(j + 2, R, gender)\rElse\rmodmordstdet(iFstAge, R, H1) = modmordstdet(iFstAge, R, H1) + Adj * agedst(j + 1, R, gender) / agedst(iFstAge, R, gender)\rEnd If\rElse\rbReAdjust = True\rEnd If 'if there's room in H1 (GrowthH1 >= ProxyGrowthH1)\r\r\r'jrs 2009/12/04 added newMort <= 1000\r'if adjustment fits in H1 then continue\rIf GrowthH1 >= ProxyGrowth(j, kkH1) And bPop2Check And newMort <= 750 And bMort2Check Then\rmodmordstdet(j + 1, R, k) = newMort\r'Tilt next segment to keep constant # of deaths\r'if working in last cohort remove excess from infants\rIf j < 20 Then\rmodmordstdet(j + 2, R, k) = modmordstdet(j + 2, R, k) - Adj * agedst(j + 1, R, gender) / agedst(j + 2, R, gender)\rElse\rmodmordstdet(iFstAge, R, k) = modmordstdet(iFstAge, R, k) - Adj * agedst(j + 1, R, gender) / agedst(iFstAge, R, gender)\rbReAdjust = True\rEnd If\r'adjust H1\rmodmordstdet(j + 1, R, H1) = modmordstdet(j + 1, R, H1) - Adj\r'tilt keeping # of deaths constant\r'if last cohort use infants to keep deaths constant\rIf j < 20 Then\rmodmordstdet(j + 2, R, H1) = modmordstdet(j + 2, R, H1) + Adj * agedst(j + 1, R, gender) / agedst(j + 2, R, gender)\rElse\rmodmordstdet(iFstAge, R, H1) = modmordstdet(iFstAge, R, H1) + Adj * agedst(j + 1, R, gender) / agedst(iFstAge, R, gender)\rEnd If\rElse\rbReAdjust = True\rEnd If 'if there's room in H1 (GrowthH1 >= ProxyGrowthH1)\r\r\r'jrs 2009/12/04 added newMort <= 1000\r'if adjustment fits in H1 then continue\rIf GrowthH1 >= ProxyGrowth(j, kkH1) And bPop2Check And newMort <= 750 And bMort2Check Then\rmodmordstdet(j + 1, R, k) = newMort\r'Tilt next segment to keep constant # of deaths\r'if working in last cohort remove excess from infants\rIf j < 20 Then\rmodmordstdet(j + 2, R, k) = modmordstdet(j + 2, R, k) - Adj * agedst(j + 1, R, gender) / agedst(j + 2, R, gender)\rElse\rmodmordstdet(iFstAge, R, k) = modmordstdet(iFstAge, R, k) - Adj * agedst(j + 1, R, gender) / agedst(iFstAge, R, gender)\rbReAdjust = True\rEnd If\r'adjust H1\rmodmordstdet(j + 1, R, H1) = modmordstdet(j + 1, R, H1) - Adj\r'tilt keeping # of deaths constant\r'if last cohort use infants to keep deaths constant\rIf j < 20 Then\rmodmordstdet(j + 2, R, H1) = modmordstdet(j + 2, R, H1) + Adj * agedst(j + 1, R, gender) / agedst(j + 2, R, gender)\rElse\rmodmordstdet(iFstAge, R, H1) = modmordstdet(iFstAge, R, H1) + Adj * agedst(j + 1, R, gender) / agedst(iFstAge, R, gender)\rEnd If\rElse\rbReAdjust = True\rEnd If 'if there's room in H1 (GrowthH1 >= ProxyGrowthH1)\r"
  },
  {
    "Variable": "HLCOSTOTHER",
    "UsesVariable": "HLCOSTLE",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLCOSTOTHER",
    "UsesVariable": "hlcostotherrattargetconv",
    "Distance": 0,
    "Code": "\r'jts 2014/06/03\rCostMorbT = CostMorbT + HLCOSTMORB(R, T)\r"
  },
  {
    "Variable": "HLCOSTOTHER",
    "UsesVariable": "HLCOSTMORT",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "HLCOSTOTHER",
    "UsesVariable": "HLCOSTMORB",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "HLCOSTOTHER",
    "UsesVariable": "GDS",
    "Distance": 0,
    "Code": "\r'jrs 2014/04/29\r'Initialize Residual Cost\r'        If IY = 1 Then\r'            'Match Health Expenditures\r'            ResidualCostPerCap(R) = HLCOST(R) 'jrs 2014/04/29 we were doing GDS which is public only\r'            'for each disease type\r'            For T = 1 To Ntypes / 2\r'                ResidualCostPerCap(R) = ResidualCostPerCap(R) - HLCOSTMORB(R, T) - HLCOSTMORT(R, T)\r'            Next T\r'            ResidualCostPerCap(R) = ResidualCostPerCap(R) - HLCOSTLE(R)\r'            ResidualCostPerCap(R) = ResidualCostPerCap(R) / POP(R)\r'        End If\r\r'Other Costs\r'-----------\r'jrs 2014/04/29 HLCOSTOTHER(R) = ResidualCostPerCap(R) * POP(R)\rIf IY = 1 Then\r'In year 1, cost = expenditures, HLCOST = GDS + EXPPriv\rHLCOSTOTHER(R) = GDS(R, Health) + HLEXPENDPRIV(R) 'HLCOST(R)\r'For each Disease Type\rFor T = 1 To CInt(Ntypes / 2)\r'Remove the cost of mortality and morbidity\rHLCOSTOTHER(R) = HLCOSTOTHER(R) - HLCOSTMORT(R, T) - HLCOSTMORB(R, T)\rNext T\r'jrs 2014/06/03 IHLCOSTOTHER(R) = HLCOSTOTHER(R)\rIHLCOSTOTHER(R) = HLCOSTOTHER(R) / (CostMortT + CostMorbT + HLCOSTLE(R))\rElse\r'jrs 2014/06/03 HLCOSTOTHER(R) = IHLCOSTOTHER(R) * GDPPC(R) / GDPPCI(R)\rHLCOSTOTHER(R) = IHLCOSTOTHER(R) * (CostMortT + CostMorbT + HLCOSTLE(R))\r'jrs 2014/06/10\rHLCOSTOTHER(R) = ConvergeOverTime(HLCOSTOTHER(R), hlcostotherrattarget * (CostMortT + CostMorbT + HLCOSTLE(R)), hlcostotherrattargetconv)\rEnd If\r"
  },
  {
    "Variable": "HLCOSTOTHER",
    "UsesVariable": "HLEXPENDPRIV",
    "Distance": 0,
    "Code": "\r'jrs 2014/04/29\r'Initialize Residual Cost\r'        If IY = 1 Then\r'            'Match Health Expenditures\r'            ResidualCostPerCap(R) = HLCOST(R) 'jrs 2014/04/29 we were doing GDS which is public only\r'            'for each disease type\r'            For T = 1 To Ntypes / 2\r'                ResidualCostPerCap(R) = ResidualCostPerCap(R) - HLCOSTMORB(R, T) - HLCOSTMORT(R, T)\r'            Next T\r'            ResidualCostPerCap(R) = ResidualCostPerCap(R) - HLCOSTLE(R)\r'            ResidualCostPerCap(R) = ResidualCostPerCap(R) / POP(R)\r'        End If\r\r'Other Costs\r'-----------\r'jrs 2014/04/29 HLCOSTOTHER(R) = ResidualCostPerCap(R) * POP(R)\rIf IY = 1 Then\r'In year 1, cost = expenditures, HLCOST = GDS + EXPPriv\rHLCOSTOTHER(R) = GDS(R, Health) + HLEXPENDPRIV(R) 'HLCOST(R)\r'For each Disease Type\rFor T = 1 To CInt(Ntypes / 2)\r'Remove the cost of mortality and morbidity\rHLCOSTOTHER(R) = HLCOSTOTHER(R) - HLCOSTMORT(R, T) - HLCOSTMORB(R, T)\rNext T\r'jrs 2014/06/03 IHLCOSTOTHER(R) = HLCOSTOTHER(R)\rIHLCOSTOTHER(R) = HLCOSTOTHER(R) / (CostMortT + CostMorbT + HLCOSTLE(R))\rElse\r'jrs 2014/06/03 HLCOSTOTHER(R) = IHLCOSTOTHER(R) * GDPPC(R) / GDPPCI(R)\rHLCOSTOTHER(R) = IHLCOSTOTHER(R) * (CostMortT + CostMorbT + HLCOSTLE(R))\r'jrs 2014/06/10\rHLCOSTOTHER(R) = ConvergeOverTime(HLCOSTOTHER(R), hlcostotherrattarget * (CostMortT + CostMorbT + HLCOSTLE(R)), hlcostotherrattargetconv)\rEnd If\r"
  },
  {
    "Variable": "HLDALY",
    "UsesVariable": "HLYLL",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLDALY",
    "UsesVariable": "HLYLD",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLDIABETESRR",
    "UsesVariable": "POP",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "HLDIABETESRR",
    "UsesVariable": "HLBMI",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "HLEXPEND",
    "UsesVariable": "GDS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLEXPEND",
    "UsesVariable": "HLEXPENDPRIV",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLEXPENDPRIV",
    "UsesVariable": "HLCOST",
    "Distance": 0,
    "Code": "\r\r\r\r'mti 2014/03/27 -start\r''GDS(R%, Educ) = DemandCalc * (1 - budbal) + _\r'GDS(R%, Educ) * budbal\r\r'GDS(R%, Educ) = DemandCalc * budbal + _\r'GDS(R%, Educ) * (1 - budbal)\r\r'mti 2014/03/27 -end\r\r'mti 2015/11/15 -end\r\r'jrs 2014/05/26 *** begin ***\r'Expenditures Side\r'=================\r\r'Private Expenditures\r'--------------------\r'jrs 2014/05/07 Call AnalFunc(\"Private Health Expenditures % of GDP (2012)\", Array(GDPPCP(R), EDYRSAG25(R, 3)), PrivHLExp)\r'jrs 2014/05/30 Call XYTABL(PrivHLExpPctGDPFxName, GDPPCP(R), PrivHLExp)\r'jrs 2014/05/30 PrivHLExp = PrivHLExp + HLEXPENDPRIVShift(R)\r'Convert to absolute terms\r'jrs 2014/05/30 HLEXPENDPRIV(R) = PrivHLExp * GDP(R) / 100\rHLEXPENDPRIV(R) = SHLCOST(R) * PrivExpToCost(R%)\r"
  },
  {
    "Variable": "HLHIVART",
    "UsesVariable": "hlhivartm",
    "Distance": 0,
    "Code": "\rHLHIVART(R%) = Amin(100, HLHIVART(R%) * hlhivartm(R%))\r"
  },
  {
    "Variable": "HLHIVART",
    "UsesVariable": "HLHIVPREV",
    "Distance": 0,
    "Code": "\rIf SHlHIVPrev(R%) / AMAX(0.00001, POP(R%)) > 0.02 Then\rHLHIVART(R%) = CSng(HLHIVART(R%) * (1 + IY% / 50)) 'assume 2% annual growth regardless\rEnd If\r"
  },
  {
    "Variable": "HLHIVART",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\rIf SHlHIVPrev(R%) / AMAX(0.00001, POP(R%)) > 0.02 Then\rHLHIVART(R%) = CSng(HLHIVART(R%) * (1 + IY% / 50)) 'assume 2% annual growth regardless\rEnd If\r"
  },
  {
    "Variable": "HLHIVART",
    "UsesVariable": "GDPPCP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "HLHIVINC",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\rHLHIVINC(R%) = CSng(Amin(0.2 * POP(R%), HLHIVINC(R%)))\r"
  },
  {
    "Variable": "HLHIVINC",
    "UsesVariable": "hlhivincm",
    "Distance": 0,
    "Code": "\rHLHIVINC(R%) = CSng(AMAX(HLHIVINC(R%) * hlhivincm(R%), 0.0001 * SHlHIVPrev(R%)))\r"
  },
  {
    "Variable": "HLHIVINC",
    "UsesVariable": "HLHIVPREV",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLHIVINC",
    "UsesVariable": "HLCONDOMUSE",
    "Distance": 1028,
    "Code": "\r\r'bbh 2019/04/06 start\r\rPrivate Sub HIVPrevIncShift(context As IForecastContext)\rDim TbName As String\rDim CurrentRatio, CalcIncRPrev As Single\rTbName$ = \"Condom Use at Risk Sex Versus HIV Incidence/Prevalence (2015) Lin\"\rFor R% = 1 To NR%\rIf HLHIVPREV(R%) = 0 Then\rCurrentRatio = 0.08 'value of ratio at 50% Condom use\rElse\rCurrentRatio = HLHIVINC(R%) / HLHIVPREV(R%)\rEnd If\rCall XYTABL(TbName$, HLCONDOMUSE(R%), CalcIncRPrev, context)\r\r'If HLHIVPREV(R%) = 0 Then CurrentRatio = 0.08 'value of ratio at 50% ART coverage\rHIVIncShift(R%) = CurrentRatio / AMAX(0.0001, CalcIncRPrev)\rHLHIVINCPREVR(R%) = CurrentRatio\rNext R%\rEnd Sub\r"
  },
  {
    "Variable": "HLHIVINCPREVR",
    "UsesVariable": "HLHIVINC",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLHIVINCPREVR",
    "UsesVariable": "HLHIVPREV",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLHIVMORT",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\rHLHIVMORT(R%) = CSng(Amin(0.2 * POP(R%), HLHIVMORT(R%)))\r"
  },
  {
    "Variable": "HLHIVMORT",
    "UsesVariable": "hlhivmortm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLHIVMORT",
    "UsesVariable": "HLHIVPREV",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLHIVMORT",
    "UsesVariable": "HLHIVART",
    "Distance": 1029,
    "Code": "\r\rPrivate Sub HIVMortRPrevShift(context As IForecastContext)\rDim TbName As String\rDim CurrentRatio, CalcMortRPrev As Single\rTbName$ = \"HIV Mortality/Prevalence vs ART Percent (2015) Lin\"\rFor R% = 1 To NR%\rIf HLHIVPREV(R%) = 0 Then\rCurrentRatio = 0.04 'value of ratio at 50% ART coverage\rElse\rCurrentRatio = HLHIVMORT(R%) / HLHIVPREV(R%)\rEnd If\rCall AnalFunc(TbName$, New Single() {HLHIVART(R%)}, CalcMortRPrev,\r            New String() {\"HLHIVART\"}, context)\r'If HLHIVPREV(R%) = 0 Then CurrentRatio = 0.04 'value of ratio at 50% ART coverage\rHIVMortShift(R%) = CurrentRatio / AMAX(0.0001, CalcMortRPrev)\rHLHIVMORTPREVR(R%) = CurrentRatio\r'If RegName$(R%) = \"Argentina\" Then Stop\rNext R%\rEnd Sub\r"
  },
  {
    "Variable": "HLHIVMORTPREVR",
    "UsesVariable": "HLHIVMORT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLHIVMORTPREVR",
    "UsesVariable": "HLHIVPREV",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLHIVPREV",
    "UsesVariable": "hlhivprevm",
    "Distance": 0,
    "Code": "\rHLHIVPREV(R%) = CSng(Amin(HLHIVPREV(R%) * hlhivprevm(R%), 0.8 * POP(R%)))\r"
  },
  {
    "Variable": "HLHIVPREV",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\rHLHIVPREV(R%) = CSng(Amin(HLHIVPREV(R%) * hlhivprevm(R%), 0.8 * POP(R%)))\r"
  },
  {
    "Variable": "HLHIVPREV",
    "UsesVariable": "HLHIVINC",
    "Distance": 0,
    "Code": "\rHLHIVPREV(R%) = AMAX(0, SHlHIVPrev(R%) + HLHIVINC(R%) - TotDeathsPrev)\r"
  },
  {
    "Variable": "HLHIVPREV",
    "UsesVariable": "HLHIVMORT",
    "Distance": 1,
    "Code": "\r\r'HIV Prevalence, as stock - All Years but First\r'----------------------------------------------\r' If RegName$(R%) = \"Albania\" Then Stop\rNormalDeaths = CDR(R%) / 1000 * SHlHIVPrev(R%)\r\rTotDeathsPrev = NormalDeaths + HLHIVMORT(R%)\r"
  },
  {
    "Variable": "HLHIVPREV",
    "UsesVariable": "CDR",
    "Distance": 2,
    "Code": "\r\r'HIV Prevalence, as stock - All Years but First\r'----------------------------------------------\r' If RegName$(R%) = \"Albania\" Then Stop\rNormalDeaths = CDR(R%) / 1000 * SHlHIVPrev(R%)\r"
  },
  {
    "Variable": "HLMALARIAINC",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLMALARIAINC",
    "UsesVariable": "hlmalariaincm",
    "Distance": 2,
    "Code": "\r\r'Malaria Incidence - All Years but First\r'---------------------------------------\rMalIncR = CSng(SHLMalIncR(R%) * (1 - (HLBEDNETS(R%) - SHlBedNets(R%)) / 100 - 0.04))\r"
  },
  {
    "Variable": "HLMALARIAINC",
    "UsesVariable": "HLBEDNETS",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "HLMALARIAMORT",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLMALARIAMORT",
    "UsesVariable": "hlmalariamortm",
    "Distance": 1,
    "Code": "\r\r'Malaria Mortality - All Years but First\r'--------------------------------------\rMalMortR = CSng(SHlMalMortR(R%) * MalIncR / AMAX(0.000001, SHLMalIncR(R%)) - 0.01 * SHlMalMortR(R%))\r"
  },
  {
    "Variable": "HLMALARIAMORT",
    "UsesVariable": "hlmalariaincm",
    "Distance": 8,
    "Code": "\r\r'Malaria Incidence - All Years but First\r'---------------------------------------\rMalIncR = CSng(SHLMalIncR(R%) * (1 - (HLBEDNETS(R%) - SHlBedNets(R%)) / 100 - 0.04))\r"
  },
  {
    "Variable": "HLMALARIAMORT",
    "UsesVariable": "HLMALARIAINC",
    "Distance": 1967,
    "Code": "0"
  },
  {
    "Variable": "HLMALARIAMORT",
    "UsesVariable": "HLBEDNETS",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "HLMALARIAPREV",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLMALARIAPREV",
    "UsesVariable": "hlmalariaprevm",
    "Distance": 1,
    "Code": "\r\r'Malaria Prevalence - All Years but First\r'----------------------------------------\rMalPrevR = CSng(SHlMalPrevR(R%) * MalIncR / AMAX(0.000001, SHLMalIncR(R%)) - 0.01 * SHlMalPrevR(R%))\r"
  },
  {
    "Variable": "HLMALARIAPREV",
    "UsesVariable": "hlmalariaincm",
    "Distance": 5,
    "Code": "\r\r'Malaria Incidence - All Years but First\r'---------------------------------------\rMalIncR = CSng(SHLMalIncR(R%) * (1 - (HLBEDNETS(R%) - SHlBedNets(R%)) / 100 - 0.04))\r"
  },
  {
    "Variable": "HLMALARIAPREV",
    "UsesVariable": "HLMALARIAINC",
    "Distance": 1964,
    "Code": "0"
  },
  {
    "Variable": "HLMALARIAPREV",
    "UsesVariable": "HLBEDNETS",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "HLMALINCPREVR",
    "UsesVariable": "HLMALARIAINC",
    "Distance": 0,
    "Code": "\rIf HLMALARIAPREV(R%) <= 0 Then\rHLMALMORTPREVR(R%) = 0.04\rHLMALINCPREVR(R%) = 0.08\rElse\rHLMALINCPREVR(R%) = HLMALARIAINC(R%) / AMAX(0.000001, HLMALARIAPREV(R%))\rHLMALMORTPREVR(R%) = HLMALARIAMORT(R%) / AMAX(0.000001, HLMALARIAPREV(R%))\rEnd If\r"
  },
  {
    "Variable": "HLMALINCPREVR",
    "UsesVariable": "HLMALARIAPREV",
    "Distance": 0,
    "Code": "\rIf HLMALARIAPREV(R%) <= 0 Then\rHLMALMORTPREVR(R%) = 0.04\rHLMALINCPREVR(R%) = 0.08\rElse\rHLMALINCPREVR(R%) = HLMALARIAINC(R%) / AMAX(0.000001, HLMALARIAPREV(R%))\rHLMALMORTPREVR(R%) = HLMALARIAMORT(R%) / AMAX(0.000001, HLMALARIAPREV(R%))\rEnd If\r"
  },
  {
    "Variable": "HLMALMORTPREVR",
    "UsesVariable": "HLMALARIAMORT",
    "Distance": 0,
    "Code": "\rIf HLMALARIAPREV(R%) <= 0 Then\rHLMALMORTPREVR(R%) = 0.04\rHLMALINCPREVR(R%) = 0.08\rElse\rHLMALINCPREVR(R%) = HLMALARIAINC(R%) / AMAX(0.000001, HLMALARIAPREV(R%))\rHLMALMORTPREVR(R%) = HLMALARIAMORT(R%) / AMAX(0.000001, HLMALARIAPREV(R%))\rEnd If\r"
  },
  {
    "Variable": "HLMALMORTPREVR",
    "UsesVariable": "HLMALARIAPREV",
    "Distance": 0,
    "Code": "\rIf HLMALARIAPREV(R%) <= 0 Then\rHLMALMORTPREVR(R%) = 0.04\rHLMALINCPREVR(R%) = 0.08\rElse\rHLMALINCPREVR(R%) = HLMALARIAINC(R%) / AMAX(0.000001, HLMALARIAPREV(R%))\rHLMALMORTPREVR(R%) = HLMALARIAMORT(R%) / AMAX(0.000001, HLMALARIAPREV(R%))\rEnd If\r"
  },
  {
    "Variable": "HLMALPREVPOPR",
    "UsesVariable": "HLMALARIAPREV",
    "Distance": 0,
    "Code": "\rHLMALPREVPOPR(R%) = HLMALARIAPREV(R%) / AMAX(0.0001, POP(R%))\r"
  },
  {
    "Variable": "HLMALPREVPOPR",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\rHLMALPREVPOPR(R%) = HLMALARIAPREV(R%) / AMAX(0.0001, POP(R%))\r"
  },
  {
    "Variable": "HLOBESITY",
    "UsesVariable": "POP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "HLOBESITY",
    "UsesVariable": "hlobesitym",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLOBESITY",
    "UsesVariable": "HLBMI",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "HLSMOKING",
    "UsesVariable": "POP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "HLSMOKING",
    "UsesVariable": "hlsmokingceiling",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLSMOKING",
    "UsesVariable": "hlsmokingfloor",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLSMOKING",
    "UsesVariable": "hlsmokingm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLSMOKING",
    "UsesVariable": "hlsmokingdecm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLSMOKING",
    "UsesVariable": "hlsmokingincm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLSMOKING",
    "UsesVariable": "GDPPCP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "hlsmokingdecm",
    "UsesVariable": "hlsmokingtcs",
    "Distance": 0,
    "Code": "\r\r'jrs 2011/05/17 *** new procedure for Smoking in Stages ***\rPrivate Sub Health_Forecast_Smoking_InStages(context As IForecastContext)\r\rIf IY = 2 Then\r'If context.HistoricMode = True Then\r'Loads # of countries and region codes\r'--------------------------------------\r'LoadCountries dbIFs\r'End If\r\r'Tobacco Control Score\r'---------------------\rDim CPop As Dictionary(Of String, Single?) = New Dictionary(Of String, Single?)\r\rDim CTCS As Dictionary(Of String, Single?) = New Dictionary(Of String, Single?)\r\r'Call RegAvgOneDimInMem(CTCS, CPop, RTCS, \"TCS\") 'jrs 2012/02/28\rFor Each item In (From s In CTCS\rJoin r In context.Regionalization On s.Key Equals r.Key\rJoin w In CPop On s.Key Equals w.Key\rGroup Value = s.Value, Weight = w.Value By RegionId = r.Value Into Data = Group, TotalWeight = Sum(Weight)\r).ToDictionary(\rFunction(grp) grp.RegionId,\r                     Function(grp) grp.Data.Sum(Function(v) v.Value * v.Weight) / grp.TotalWeight\r)\rRTCS(item.Key) = CSng(item.Value)\rNext\r\rEnd If\r\r'jrs 2011/09/09\r'Tobacco Control Score\rIf Abs(CSng(hlsmokingtcs(R%) - RTCS(R%))) > 0.0001 Then 'jrs 2012/10/19 don't know why but the parameter has lots of un wanted decimals\rhlsmokingincm = CSng((1 + (RTCS(R%) - hlsmokingtcs(R%)) / 100 * hlsmokingtcsel))\rhlsmokingdecm = CSng((1 - (RTCS(R%) - hlsmokingtcs(R%)) / 100 * hlsmokingtcsel))\rEnd If\r"
  },
  {
    "Variable": "hlsmokingdecm",
    "UsesVariable": "hlsmokingtcsel",
    "Distance": 0,
    "Code": "\r\r'jrs 2011/05/17 *** new procedure for Smoking in Stages ***\rPrivate Sub Health_Forecast_Smoking_InStages(context As IForecastContext)\r\rIf IY = 2 Then\r'If context.HistoricMode = True Then\r'Loads # of countries and region codes\r'--------------------------------------\r'LoadCountries dbIFs\r'End If\r\r'Tobacco Control Score\r'---------------------\rDim CPop As Dictionary(Of String, Single?) = New Dictionary(Of String, Single?)\r\rDim CTCS As Dictionary(Of String, Single?) = New Dictionary(Of String, Single?)\r\r'Call RegAvgOneDimInMem(CTCS, CPop, RTCS, \"TCS\") 'jrs 2012/02/28\rFor Each item In (From s In CTCS\rJoin r In context.Regionalization On s.Key Equals r.Key\rJoin w In CPop On s.Key Equals w.Key\rGroup Value = s.Value, Weight = w.Value By RegionId = r.Value Into Data = Group, TotalWeight = Sum(Weight)\r).ToDictionary(\rFunction(grp) grp.RegionId,\r                     Function(grp) grp.Data.Sum(Function(v) v.Value * v.Weight) / grp.TotalWeight\r)\rRTCS(item.Key) = CSng(item.Value)\rNext\r\rEnd If\r"
  },
  {
    "Variable": "hlsmokingdecm",
    "UsesVariable": "POP",
    "Distance": 249,
    "Code": "0"
  },
  {
    "Variable": "HLSMOKINGIMP",
    "UsesVariable": "POP",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "HLSMOKINGIMP",
    "UsesVariable": "hlsmkel",
    "Distance": 0,
    "Code": "\r'jrs 2011/10/25\r'Considering TCS as a multiplier too\r'jrs 2012/01/13 SmkMult = SmkMult * (1 + (SHLSMOKINGTCS(item.RegionId) - hlsmokingtcs(item.RegionId)) / 100 * hlsmokingtcsel)\r'TCS has changed and it's not a simple multiplier anymore\rIf SmkMult <> 0 And SmkMult <> 1 Then\rCurrDelta = HLSMOKING(item.RegionId, item.Sex) * (SmkMult - 1) / SmkMult\rDelta = (CurrDelta + SmokingCumEff(item.RegionId, item.Sex)) * hlsmkimeff\rIf j = 4 Then\rSmokingCumEff(item.RegionId, item.Sex) = (SmokingCumEff(item.RegionId, item.Sex) + CurrDelta) * (1 - hlsmkimeff)\rEnd If\rHLSMOKINGIMP(item.RegionId, j, item.Sex) = HLSMOKINGIMP(item.RegionId, j, item.Sex) * (1 + Delta * hlsmkel)\rHLSMOKINGIMP(item.RegionId, j, item.Sex) = CSng(AMAX(HLSMOKINGIMP(item.RegionId, j, item.Sex), 0.0001))\rHLSMOKINGIMP(item.RegionId, j, item.Sex) = Amin(HLSMOKINGIMP(item.RegionId, j, item.Sex), 100000)\rEnd If\r\r'jrs 2011/10/25\r'Considering TCS as a multiplier too\r'jrs 2012/01/13 SmkMult = SmkMult * (1 + (SHLSMOKINGTCS(item.RegionId) - hlsmokingtcs(item.RegionId)) / 100 * hlsmokingtcsel)\r'TCS has changed and it's not a simple multiplier anymore\rIf SmkMult <> 0 And SmkMult <> 1 Then\rCurrDelta = HLSMOKING(item.RegionId, item.Sex) * (SmkMult - 1) / SmkMult\rDelta = (CurrDelta + SmokingCumEff(item.RegionId, item.Sex)) * hlsmkimeff\rIf j = 4 Then\rSmokingCumEff(item.RegionId, item.Sex) = (SmokingCumEff(item.RegionId, item.Sex) + CurrDelta) * (1 - hlsmkimeff)\rEnd If\rHLSMOKINGIMP(item.RegionId, j, item.Sex) = HLSMOKINGIMP(item.RegionId, j, item.Sex) * (1 + Delta * hlsmkel)\rHLSMOKINGIMP(item.RegionId, j, item.Sex) = CSng(AMAX(HLSMOKINGIMP(item.RegionId, j, item.Sex), 0.0001))\rHLSMOKINGIMP(item.RegionId, j, item.Sex) = Amin(HLSMOKINGIMP(item.RegionId, j, item.Sex), 100000)\rEnd If\r\r'jrs 2011/10/25\r'Considering TCS as a multiplier too\r'jrs 2012/01/13 SmkMult = SmkMult * (1 + (SHLSMOKINGTCS(item.RegionId) - hlsmokingtcs(item.RegionId)) / 100 * hlsmokingtcsel)\r'TCS has changed and it's not a simple multiplier anymore\rIf SmkMult <> 0 And SmkMult <> 1 Then\rCurrDelta = HLSMOKING(item.RegionId, item.Sex) * (SmkMult - 1) / SmkMult\rDelta = (CurrDelta + SmokingCumEff(item.RegionId, item.Sex)) * hlsmkimeff\rIf j = 4 Then\rSmokingCumEff(item.RegionId, item.Sex) = (SmokingCumEff(item.RegionId, item.Sex) + CurrDelta) * (1 - hlsmkimeff)\rEnd If\rHLSMOKINGIMP(item.RegionId, j, item.Sex) = HLSMOKINGIMP(item.RegionId, j, item.Sex) * (1 + Delta * hlsmkel)\rHLSMOKINGIMP(item.RegionId, j, item.Sex) = CSng(AMAX(HLSMOKINGIMP(item.RegionId, j, item.Sex), 0.0001))\rHLSMOKINGIMP(item.RegionId, j, item.Sex) = Amin(HLSMOKINGIMP(item.RegionId, j, item.Sex), 100000)\rEnd If\r\r'jrs 2011/10/25\r'Considering TCS as a multiplier too\r'jrs 2012/01/13 SmkMult = SmkMult * (1 + (SHLSMOKINGTCS(item.RegionId) - hlsmokingtcs(item.RegionId)) / 100 * hlsmokingtcsel)\r'TCS has changed and it's not a simple multiplier anymore\rIf SmkMult <> 0 And SmkMult <> 1 Then\rCurrDelta = HLSMOKING(item.RegionId, item.Sex) * (SmkMult - 1) / SmkMult\rDelta = (CurrDelta + SmokingCumEff(item.RegionId, item.Sex)) * hlsmkimeff\rIf j = 4 Then\rSmokingCumEff(item.RegionId, item.Sex) = (SmokingCumEff(item.RegionId, item.Sex) + CurrDelta) * (1 - hlsmkimeff)\rEnd If\rHLSMOKINGIMP(item.RegionId, j, item.Sex) = HLSMOKINGIMP(item.RegionId, j, item.Sex) * (1 + Delta * hlsmkel)\rHLSMOKINGIMP(item.RegionId, j, item.Sex) = CSng(AMAX(HLSMOKINGIMP(item.RegionId, j, item.Sex), 0.0001))\rHLSMOKINGIMP(item.RegionId, j, item.Sex) = Amin(HLSMOKINGIMP(item.RegionId, j, item.Sex), 100000)\rEnd If\r\rNext\r\rEnd Using\r\rCOMPLETE STRUCTURE:End Sub:12455|COMPLETE STRUCTURE:Next R%:12455|\r\r'jrs 2009/12/04\rPrivate Sub ComputeSmokAvgAllAgesSex()\r'jrs 2008/11/21\r'average should be on Adult population and not all population\rDim PopAd As Single\rDim CohPop As Single\rDim CohPopT As Single\rDim z As Integer\r\r'jrs 2007/06/27\r'All Years: Smoking Impact - Compute Averages for All Ages and Accross Gender\r'----------------------------------------------------------------------------\rFor R% = 1 To NR%\r'Filling Up All Ages dimension\rFor G = 1 To NGender - 1\rHLSMOKINGIMP(R%, 5, G) = 0\r'jrs 2008/11/21\rPopAd = 0\r\rFor j = 1 To 4\rSelect Case j\rCase 1 '30 to 44\rCohPop = CSng(agedst(7, R%, G) + agedst(8, R%, G) + agedst(9, R%, G))\rCase 2 '45 to 59\rCohPop = CSng(agedst(10, R%, G) + agedst(11, R%, G) + agedst(12, R%, G))\rCase 3 '60 to 69\rCohPop = CSng(agedst(13, R%, G) + agedst(14, R%, G))\rCase 4 '70+\rCohPop = 0\rFor z = 15 To NCohorts\rCohPop = CSng(CohPop + agedst(z, R%, G))\rNext z\rEnd Select\rHLSMOKINGIMP(R%, 5, G) = HLSMOKINGIMP(R%, 5, G) + HLSMOKINGIMP(R%, j, G) * CohPop\r'jrs 2008/11/21\rPopAd = PopAd + CohPop\rNext j\r'jrs 2013/01/18\rIf PopAd > 0 Then\rHLSMOKINGIMP(R%, 5, G) = HLSMOKINGIMP(R%, 5, G) / PopAd 'jrs 2008/11/21 popgdr(R%, G)\rEnd If\rNext G\r"
  },
  {
    "Variable": "HLSMOKINGIMP",
    "UsesVariable": "hlsmkimeff",
    "Distance": 2,
    "Code": "\r'jrs 2011/10/25\r'Considering TCS as a multiplier too\r'jrs 2012/01/13 SmkMult = SmkMult * (1 + (SHLSMOKINGTCS(item.RegionId) - hlsmokingtcs(item.RegionId)) / 100 * hlsmokingtcsel)\r'TCS has changed and it's not a simple multiplier anymore\rIf SmkMult <> 0 And SmkMult <> 1 Then\rCurrDelta = HLSMOKING(item.RegionId, item.Sex) * (SmkMult - 1) / SmkMult\rDelta = (CurrDelta + SmokingCumEff(item.RegionId, item.Sex)) * hlsmkimeff\rIf j = 4 Then\rSmokingCumEff(item.RegionId, item.Sex) = (SmokingCumEff(item.RegionId, item.Sex) + CurrDelta) * (1 - hlsmkimeff)\rEnd If\rHLSMOKINGIMP(item.RegionId, j, item.Sex) = HLSMOKINGIMP(item.RegionId, j, item.Sex) * (1 + Delta * hlsmkel)\rHLSMOKINGIMP(item.RegionId, j, item.Sex) = CSng(AMAX(HLSMOKINGIMP(item.RegionId, j, item.Sex), 0.0001))\rHLSMOKINGIMP(item.RegionId, j, item.Sex) = Amin(HLSMOKINGIMP(item.RegionId, j, item.Sex), 100000)\rEnd If\r"
  },
  {
    "Variable": "HLSMOKINGIMP",
    "UsesVariable": "HLSMOKING",
    "Distance": 3,
    "Code": "\r'jrs 2011/10/25\r'Considering TCS as a multiplier too\r'jrs 2012/01/13 SmkMult = SmkMult * (1 + (SHLSMOKINGTCS(item.RegionId) - hlsmokingtcs(item.RegionId)) / 100 * hlsmokingtcsel)\r'TCS has changed and it's not a simple multiplier anymore\rIf SmkMult <> 0 And SmkMult <> 1 Then\rCurrDelta = HLSMOKING(item.RegionId, item.Sex) * (SmkMult - 1) / SmkMult\rDelta = (CurrDelta + SmokingCumEff(item.RegionId, item.Sex)) * hlsmkimeff\rIf j = 4 Then\rSmokingCumEff(item.RegionId, item.Sex) = (SmokingCumEff(item.RegionId, item.Sex) + CurrDelta) * (1 - hlsmkimeff)\rEnd If\rHLSMOKINGIMP(item.RegionId, j, item.Sex) = HLSMOKINGIMP(item.RegionId, j, item.Sex) * (1 + Delta * hlsmkel)\rHLSMOKINGIMP(item.RegionId, j, item.Sex) = CSng(AMAX(HLSMOKINGIMP(item.RegionId, j, item.Sex), 0.0001))\rHLSMOKINGIMP(item.RegionId, j, item.Sex) = Amin(HLSMOKINGIMP(item.RegionId, j, item.Sex), 100000)\rEnd If\r"
  },
  {
    "Variable": "HLSMOKINGIMP",
    "UsesVariable": "hlsmokingm",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "hlsmokingincm",
    "UsesVariable": "hlsmokingtcs",
    "Distance": 0,
    "Code": "\r\r'jrs 2011/05/17 *** new procedure for Smoking in Stages ***\rPrivate Sub Health_Forecast_Smoking_InStages(context As IForecastContext)\r\rIf IY = 2 Then\r'If context.HistoricMode = True Then\r'Loads # of countries and region codes\r'--------------------------------------\r'LoadCountries dbIFs\r'End If\r\r'Tobacco Control Score\r'---------------------\rDim CPop As Dictionary(Of String, Single?) = New Dictionary(Of String, Single?)\r\rDim CTCS As Dictionary(Of String, Single?) = New Dictionary(Of String, Single?)\r\r'Call RegAvgOneDimInMem(CTCS, CPop, RTCS, \"TCS\") 'jrs 2012/02/28\rFor Each item In (From s In CTCS\rJoin r In context.Regionalization On s.Key Equals r.Key\rJoin w In CPop On s.Key Equals w.Key\rGroup Value = s.Value, Weight = w.Value By RegionId = r.Value Into Data = Group, TotalWeight = Sum(Weight)\r).ToDictionary(\rFunction(grp) grp.RegionId,\r                     Function(grp) grp.Data.Sum(Function(v) v.Value * v.Weight) / grp.TotalWeight\r)\rRTCS(item.Key) = CSng(item.Value)\rNext\r\rEnd If\r\r'jrs 2011/09/09\r'Tobacco Control Score\rIf Abs(CSng(hlsmokingtcs(R%) - RTCS(R%))) > 0.0001 Then 'jrs 2012/10/19 don't know why but the parameter has lots of un wanted decimals\rhlsmokingincm = CSng((1 + (RTCS(R%) - hlsmokingtcs(R%)) / 100 * hlsmokingtcsel))\rhlsmokingdecm = CSng((1 - (RTCS(R%) - hlsmokingtcs(R%)) / 100 * hlsmokingtcsel))\rEnd If\r"
  },
  {
    "Variable": "hlsmokingincm",
    "UsesVariable": "hlsmokingtcsel",
    "Distance": 0,
    "Code": "\r\r'jrs 2011/05/17 *** new procedure for Smoking in Stages ***\rPrivate Sub Health_Forecast_Smoking_InStages(context As IForecastContext)\r\rIf IY = 2 Then\r'If context.HistoricMode = True Then\r'Loads # of countries and region codes\r'--------------------------------------\r'LoadCountries dbIFs\r'End If\r\r'Tobacco Control Score\r'---------------------\rDim CPop As Dictionary(Of String, Single?) = New Dictionary(Of String, Single?)\r\rDim CTCS As Dictionary(Of String, Single?) = New Dictionary(Of String, Single?)\r\r'Call RegAvgOneDimInMem(CTCS, CPop, RTCS, \"TCS\") 'jrs 2012/02/28\rFor Each item In (From s In CTCS\rJoin r In context.Regionalization On s.Key Equals r.Key\rJoin w In CPop On s.Key Equals w.Key\rGroup Value = s.Value, Weight = w.Value By RegionId = r.Value Into Data = Group, TotalWeight = Sum(Weight)\r).ToDictionary(\rFunction(grp) grp.RegionId,\r                     Function(grp) grp.Data.Sum(Function(v) v.Value * v.Weight) / grp.TotalWeight\r)\rRTCS(item.Key) = CSng(item.Value)\rNext\r\rEnd If\r"
  },
  {
    "Variable": "hlsmokingincm",
    "UsesVariable": "POP",
    "Distance": 248,
    "Code": "0"
  },
  {
    "Variable": "hlsmokingtcs",
    "UsesVariable": "hlsmokingtcsm",
    "Distance": 0,
    "Code": "\r\r'jrs 2011/10/28\rIf hlsmokingtcsm(R%) <> 1 Then\r'jrs 2011/11/23 added min and max checks\rhlsmokingtcs(R%) = AMAX(Amin(hlsmokingtcs(R%) * hlsmokingtcsm(R%), TCSMax), TCSMin)\rEnd If\r"
  },
  {
    "Variable": "HLSTUNT",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLSTUNT",
    "UsesVariable": "POPLE15",
    "Distance": 0,
    "Code": "\r\r'Convert to % of total population\r'jrs 2016/12/06\r'jrs 2016/12/01\r'HLSTUNT(R) = HLSTUNT(R) / 10 / POP(R)\rHLSTUNT(R) = HLSTUNT(R) / 10 / (POP(R) - POPLE15(R))\r"
  },
  {
    "Variable": "HLSTUNT",
    "UsesVariable": "malnchpsamtostunt",
    "Distance": 8,
    "Code": "\r\r'mti 2021/05/10 start\r'StuntVal = AMAX(StuntVal, 0.000001)\rStuntVal = CSng(AMAX(StuntVal, 0.1)) 'jrs 2021/06/21 changed limit from 0 to 0.1 for Ukraine\r\r\r'mti 2021/05/10 start\r'StuntVal = AMAX(StuntVal, 0.000001)\rStuntVal = CSng(AMAX(StuntVal, 0.1)) 'jrs 2021/06/21 changed limit from 0 to 0.1 for Ukraine\r"
  },
  {
    "Variable": "HLSTUNT",
    "UsesVariable": "MALNCHPSAM",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "HLSTUNT",
    "UsesVariable": "MALNCHP",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "HLSTUNT",
    "UsesVariable": "EDSECPER",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "HLSTUNT",
    "UsesVariable": "HLSTUNTCHL",
    "Distance": 0,
    "Code": "\r'kbn 2019/05/12 -Start-\r'Initialize shift factors for child stunting in the first year\r\r''If stunting is initialized as 0, fill holes with formulation in IFs\rIf HLSTUNTCHL(R) = 0 Then\r'jrs 2020/11/17 HLSTUNTCHL(R) = CSng((((StuntingByAge(0, R, 1) + StuntingByAge(0, R, 2) + StuntingByAge(1, R, 1) + StuntingByAge(1, R, 2))) / POP(R)))\r'jrs 2021/06/17 Stunting0 uses agedst0, Stunting1 uses agedst1, but POP0TO5 is agedst0 + fagedst1-4, so is very close to agedst1\r'HLSTUNTCHL(R) = CSng((((StuntingByAge(0, R, 1) + StuntingByAge(0, R, 2) + StuntingByAge(1, R, 1) + StuntingByAge(1, R, 2))) / 10 / POP0TO5(R)))\rHLSTUNTCHL(R) = CSng((((StuntingByAge(0, R, 1) + StuntingByAge(0, R, 2) + StuntingByAge(1, R, 1) + StuntingByAge(1, R, 2))) / 10 / (agedst(0, R, 1) + agedst(0, R, 2) + agedst(1, R, 1) + agedst(1, R, 2))))\r'jrs 2021/06/23 Bahamas\rHLSTUNT(R) = CSng(HLSTUNTCHL(R) * 1.5)\rEnd If\r\r'mti 2021/05/10 End\r\r'jrs 2021/04/08 Changing Stunting Forecast *** end ***\r\r'jrs 2016/12/01\rHLSTUNT(R) = 0\r"
  },
  {
    "Variable": "HLSTUNTCHL",
    "UsesVariable": "hlstuntchlm",
    "Distance": 0,
    "Code": "\r'jrs 2021/06/29\rHLSTUNTCHL(R%) = HLSTUNTCHL(R%) * hlstuntchlm(R%)\r\rHLSTUNTCHL(R%) = Amin(99, AMAX(0, HLSTUNTCHL(R%))) 'jrs 2021/06/22 changed limit from 80 to 99\r"
  },
  {
    "Variable": "HLSTUNTCHL",
    "UsesVariable": "POP",
    "Distance": 56,
    "Code": "0"
  },
  {
    "Variable": "HLSTUNTCHL",
    "UsesVariable": "malnchpsamtostunt",
    "Distance": 23,
    "Code": "\r\r'mti 2021/05/10 start\r'StuntVal = AMAX(StuntVal, 0.000001)\rStuntVal = CSng(AMAX(StuntVal, 0.1)) 'jrs 2021/06/21 changed limit from 0 to 0.1 for Ukraine\r\r\r'mti 2021/05/10 start\r'StuntVal = AMAX(StuntVal, 0.000001)\rStuntVal = CSng(AMAX(StuntVal, 0.1)) 'jrs 2021/06/21 changed limit from 0 to 0.1 for Ukraine\r"
  },
  {
    "Variable": "HLSTUNTCHL",
    "UsesVariable": "MALNCHPSAM",
    "Distance": 23,
    "Code": "0"
  },
  {
    "Variable": "HLSTUNTCHL",
    "UsesVariable": "MALNCHP",
    "Distance": 30,
    "Code": "0"
  },
  {
    "Variable": "HLSTUNTCHL",
    "UsesVariable": "EDSECPER",
    "Distance": 30,
    "Code": "0"
  },
  {
    "Variable": "HLSTUNTWORK",
    "UsesVariable": "POPWORKING",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLSTUNTWORK",
    "UsesVariable": "POP",
    "Distance": 17,
    "Code": "0"
  },
  {
    "Variable": "HLSTUNTWORK",
    "UsesVariable": "malnchpsamtostunt",
    "Distance": 22,
    "Code": "0"
  },
  {
    "Variable": "HLSTUNTWORK",
    "UsesVariable": "MALNCHPSAM",
    "Distance": 22,
    "Code": "0"
  },
  {
    "Variable": "HLSTUNTWORK",
    "UsesVariable": "MALNCHP",
    "Distance": 29,
    "Code": "0"
  },
  {
    "Variable": "HLSTUNTWORK",
    "UsesVariable": "EDSECPER",
    "Distance": 29,
    "Code": "0"
  },
  {
    "Variable": "hltfrageinit",
    "UsesVariable": "hltfragepeak",
    "Distance": 0,
    "Code": "\rIf hltfrageinit(R%) > hltfragepeak(R%) Then\rhltfrageinit(R%) = hltfragepeak(R%)\rEnd If\r"
  },
  {
    "Variable": "hltfragepeak",
    "UsesVariable": "hltfragestop",
    "Distance": 0,
    "Code": "\r\r'jrs 2012/11/29 *** begin ***\r'   All Years 2: Converge to Target Fertility Distribution\r'   -------------------------------------------------------\rIf hltfragepeak(R%) > hltfragestop(R%) Then\rhltfragepeak(R%) = hltfragestop(R%)\rEnd If\r"
  },
  {
    "Variable": "HLYLD",
    "UsesVariable": "hlmorbm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLYLD",
    "UsesVariable": "hlmorbconv",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLYLD",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r'jrs 2014/08/05 added limit to 1000\r'jrs 2013/01/16\rmodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = Amin(AMAX(modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)), 0), 1000)\rCOMPLETE STRUCTURE:Next k:11408|COMPLETE STRUCTURE:Next G:11408|\r'jrs 2014/03/13 *** end ***\r\r'jrs 2010/03/15\r'            'In last cohort\r'            If tempi% = MaxLifeExpCohort Then\r'                For k = 1 To cint(Ntypes / 2)\r'                    'jrs 2009/08/25\r'                    For G = 1 To 2\r'                        If G = 1 Then\r'                            facLim = facLimM\r'                        Else\r'                            facLim = facLimF\r'                        End If\r'\r'                        HLYLL(tempj, k, G) = HLYLL(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                        'All Years but first\r'                        '--------------------\r'                        If IY > 1 And smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) > 0.000000001 Then\r'                            modmorbdstdetRt = (modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) - _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))) / _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * _\r'                            (modmorbdstdetRt * hlmorbtomortgthport(k) + 1) 'jrs 2009/10/02 replaced YLDtoYLLratioGrowthPortion with hlmorbtomortgthport\r'                        Else\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * YLDtoYLLratio(tempj, k, G)\r'                        End If\r'                        'Save current year values\r'                        '------------------------\r'                        'Mortality\r'                        smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Morbidity\r'                        smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Compute YLD\r'                        '-----------\r'                        HLYLD(tempj, k, G) = HLYLD(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                    Next G\r'                Next k\r'            Else 'all but last cohort\rFor k = 1 To CInt(Ntypes / 2)\r'jrs 2009/08/25 computing Morbidity\r'jrs 2009/08/25\rFor G = 1 To 2\rIf G = 1 Then\rfacLim = facLimM\rYears = yearsM 'jrs 2010/03/15\rElse\rfacLim = facLimF\rYears = yearsF 'jrs 2010/03/15\rEnd If\r\r'jrs 2014/03/13 *** end ***\r\r'jrs 2010/03/15\r'            'In last cohort\r'            If tempi% = MaxLifeExpCohort Then\r'                For k = 1 To cint(Ntypes / 2)\r'                    'jrs 2009/08/25\r'                    For G = 1 To 2\r'                        If G = 1 Then\r'                            facLim = facLimM\r'                        Else\r'                            facLim = facLimF\r'                        End If\r'\r'                        HLYLL(tempj, k, G) = HLYLL(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                        'All Years but first\r'                        '--------------------\r'                        If IY > 1 And smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) > 0.000000001 Then\r'                            modmorbdstdetRt = (modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) - _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))) / _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * _\r'                            (modmorbdstdetRt * hlmorbtomortgthport(k) + 1) 'jrs 2009/10/02 replaced YLDtoYLLratioGrowthPortion with hlmorbtomortgthport\r'                        Else\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * YLDtoYLLratio(tempj, k, G)\r'                        End If\r'                        'Save current year values\r'                        '------------------------\r'                        'Mortality\r'                        smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Morbidity\r'                        smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Compute YLD\r'                        '-----------\r'                        HLYLD(tempj, k, G) = HLYLD(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                    Next G\r'                Next k\r'            Else 'all but last cohort\rFor k = 1 To CInt(Ntypes / 2)\r'jrs 2009/08/25 computing Morbidity\r'jrs 2009/08/25\rFor G = 1 To 2\rIf G = 1 Then\rfacLim = facLimM\rYears = yearsM 'jrs 2010/03/15\rElse\rfacLim = facLimF\rYears = yearsF 'jrs 2010/03/15\rEnd If\r\r'jrs 2014/03/13 *** end ***\r\r'jrs 2010/03/15\r'            'In last cohort\r'            If tempi% = MaxLifeExpCohort Then\r'                For k = 1 To cint(Ntypes / 2)\r'                    'jrs 2009/08/25\r'                    For G = 1 To 2\r'                        If G = 1 Then\r'                            facLim = facLimM\r'                        Else\r'                            facLim = facLimF\r'                        End If\r'\r'                        HLYLL(tempj, k, G) = HLYLL(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                        'All Years but first\r'                        '--------------------\r'                        If IY > 1 And smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) > 0.000000001 Then\r'                            modmorbdstdetRt = (modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) - _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))) / _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * _\r'                            (modmorbdstdetRt * hlmorbtomortgthport(k) + 1) 'jrs 2009/10/02 replaced YLDtoYLLratioGrowthPortion with hlmorbtomortgthport\r'                        Else\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * YLDtoYLLratio(tempj, k, G)\r'                        End If\r'                        'Save current year values\r'                        '------------------------\r'                        'Mortality\r'                        smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Morbidity\r'                        smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Compute YLD\r'                        '-----------\r'                        HLYLD(tempj, k, G) = HLYLD(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                    Next G\r'                Next k\r'            Else 'all but last cohort\rFor k = 1 To CInt(Ntypes / 2)\r'jrs 2009/08/25 computing Morbidity\r'jrs 2009/08/25\rFor G = 1 To 2\rIf G = 1 Then\rfacLim = facLimM\rYears = yearsM 'jrs 2010/03/15\rElse\rfacLim = facLimF\rYears = yearsF 'jrs 2010/03/15\rEnd If\r\r'jrs 2014/03/13 *** end ***\r\r'jrs 2010/03/15\r'            'In last cohort\r'            If tempi% = MaxLifeExpCohort Then\r'                For k = 1 To cint(Ntypes / 2)\r'                    'jrs 2009/08/25\r'                    For G = 1 To 2\r'                        If G = 1 Then\r'                            facLim = facLimM\r'                        Else\r'                            facLim = facLimF\r'                        End If\r'\r'                        HLYLL(tempj, k, G) = HLYLL(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                        'All Years but first\r'                        '--------------------\r'                        If IY > 1 And smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) > 0.000000001 Then\r'                            modmorbdstdetRt = (modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) - _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))) / _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * _\r'                            (modmorbdstdetRt * hlmorbtomortgthport(k) + 1) 'jrs 2009/10/02 replaced YLDtoYLLratioGrowthPortion with hlmorbtomortgthport\r'                        Else\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * YLDtoYLLratio(tempj, k, G)\r'                        End If\r'                        'Save current year values\r'                        '------------------------\r'                        'Mortality\r'                        smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Morbidity\r'                        smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Compute YLD\r'                        '-----------\r'                        HLYLD(tempj, k, G) = HLYLD(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                    Next G\r'                Next k\r'            Else 'all but last cohort\rFor k = 1 To CInt(Ntypes / 2)\r'jrs 2009/08/25 computing Morbidity\r'jrs 2009/08/25\rFor G = 1 To 2\rIf G = 1 Then\rfacLim = facLimM\rYears = yearsM 'jrs 2010/03/15\rElse\rfacLim = facLimF\rYears = yearsF 'jrs 2010/03/15\rEnd If\r\r\r'jrs 2007/06/27\r'All Years: Smoking Impact - Compute Averages for All Ages and Accross Gender\r'----------------------------------------------------------------------------\rComputeSmokAvgAllAgesSex()\r\r'All Years: Diabetes Relative Risk - Compute Averages for All Ages and Accross Gender\r'------------------------------------------------------------------------------------\rComputeAvgDiabRRAgeSex(popgdr)\r\r'jrs 2018/04/19\r'All Years: Converge Intentional Injury time coeficient to avoid going too high over long horizons\r'-------------------------------------------------------------------------------------------------\r'jrs 2018/05/25\r'jrs 2020/08/19 Dim IY2030 As Integer move out, I don't know why it wasn't resetting to 0 every year\rDim k As Integer\r\rIf IY% = 1 Then\rReDim IntInjTimeFactors(12, 2)\r'for both genders\rFor k = 17 To 18\r'ages 5 to 59\rFor j = 2 To 12\rIntInjTimeFactors(j, k Mod 2) = mortFactors(j, k, 5, 2)\rNext j\rNext k\r'jrs 2018/05/25\rIY2030 = (2030 - BaseYear + 1)\rEnd If\r\r'Compute YLD\r'-----------\rHLYLD(tempj, k, G) = CSng(HLYLD(tempj, k, G) +\r                            Years * facLim *\r                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000)\r\r\r'jrs 2009/08/18 move outside the cohort and region loop, since it's no cohort specific\rFor R = 1 To NR\rFor k = 1 To CInt(Ntypes / 2)\rFor G = 1 To 2\r'                'no mental health\r'                If k < 15 Then\r'jrs 2009/08/24\r'All years but first\r'                    If IY > 1 Then\r'                        If SHLYLL(R, k, G) <> 0 Then\r'                            YLLGR = (HLYLL(R, k, G) - SHLYLL(R, k, G)) / SHLYLL(R, k, G)\r'                            HLYLD(R, k, G) = SHLYLD(R, k, G) * (YLLGR * YLDtoYLLratioGrowthPortion(k) + 1)\r'                        Else\r'                            HLYLD(R, k, G) = HLYLL(R, k, G) * YLDtoYLLratio(R, k, G)\r'                        End If\r'                    Else 'First Year only\r'jrs 2009/06/04 HLYLD(tempj, k, 1) = HLYLL(tempj, k, 1) * hldisfac(k)\r'                        HLYLD(R, k, G) = HLYLL(R, k, G) * YLDtoYLLratio(R, k, G)\r'                    End If\r'jrs 2009/08/24\r'Save computed values\r'                    SHLYLL(R, k, G) = HLYLL(R, k, G)\r'                    SHLYLD(R, k, G) = HLYLD(R, k, G)\r'                Else\rIf k = 15 Then\r'Mental Health\r'Compute YLD based on Population\rHLYLD(R, k, G) = CSng(popgdr(R%, G) * YLDtoPOPratio(R, G))\r'jrs 2013/01/18\rIf IY > 1 And hlmorbm > -1 Then\rIf hlmorbconv + 1 > IY Then\rHLYLD(R, k, G) = ConvergeOverTime(HLYLD(R, k, G), ipopgdr(R%, G) * YLDtoPOPratio(R, G) * hlmorbm, hlmorbconv + 1)\rElse\rHLYLD(R, k, G) = ipopgdr(R%, G) * YLDtoPOPratio(R, G) * hlmorbm\rEnd If\rEnd If\r'jrs 2014/04/08\r'Need to compute morbidty for Heatlh Cost display\r'If GRPS(1, R) = \"United States of America\" Then Stop\rIf HLYLL(R, k, G) > 0 Then\rFor tempi = 0 To NCohorts\rmodmorbdstdet(tempi, R, (2 * k) - (G Mod 2)) = HLYLD(R, k, G) * modmordstdet(tempi, R, (2 * k) - (G Mod 2)) / HLYLL(R, k, G)\r'jrs 2014/08/05\rmodmorbdstdet(tempi%, R, (2 * k) - (G Mod 2)) = Amin(AMAX(modmorbdstdet(tempi%, R, (2 * k) - (G Mod 2)), 0), 1000)\rNext tempi\rEnd If\rEnd If\r\r'jrs 2009/04/23\r'Daly\r'-----\rHLDALY(R, k, G) = HLYLL(R, k, G) + HLYLD(R, k, G)\rNext G\rNext k\rNext R\r"
  },
  {
    "Variable": "HLYLDWORK",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLYLDWORK",
    "UsesVariable": "hlmorbm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLYLDWORK",
    "UsesVariable": "hlmorbconv",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HLYLL",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r\r'jrs 2012/10/31\r'cohMort = dtmp(j, gend%) / AMAX(0.00001, agedst(j, R%, gend%))\rIf agedst(j, R%, gend%) > 0 Then\rcohMort = CSng(dtmp(j, gend%) / agedst(j, R%, gend%))\rFor z = 1 To CInt(Ntypes / 2)\rIf gend% = 1 Then\rcohMort = CSng(cohMort + modmordstdet(j, R%, (z * 2) - 1))\r'Adjust mortality to be 0\rmodmordstdet(j, R%, (z * 2) - 1) = 0\rElse\rcohMort = CSng(cohMort + modmordstdet(j, R%, z * 2))\r'Adjust mortality to be 0\rmodmordstdet(j, R%, z * 2) = 0\rEnd If\rNext z\rcohMort = cohMort / 1000\r'jrs 2013/08/27 no Life Expectancy beyond people alive\r'cohMort = 1\rEnd If\rCOMPLETE STRUCTURE:Next k:11408|COMPLETE STRUCTURE:Next G:11408|\r'jrs 2014/03/13 *** end ***\r\r'jrs 2010/03/15\r'            'In last cohort\r'            If tempi% = MaxLifeExpCohort Then\r'                For k = 1 To cint(Ntypes / 2)\r'                    'jrs 2009/08/25\r'                    For G = 1 To 2\r'                        If G = 1 Then\r'                            facLim = facLimM\r'                        Else\r'                            facLim = facLimF\r'                        End If\r'\r'                        HLYLL(tempj, k, G) = HLYLL(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                        'All Years but first\r'                        '--------------------\r'                        If IY > 1 And smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) > 0.000000001 Then\r'                            modmorbdstdetRt = (modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) - _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))) / _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * _\r'                            (modmorbdstdetRt * hlmorbtomortgthport(k) + 1) 'jrs 2009/10/02 replaced YLDtoYLLratioGrowthPortion with hlmorbtomortgthport\r'                        Else\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * YLDtoYLLratio(tempj, k, G)\r'                        End If\r'                        'Save current year values\r'                        '------------------------\r'                        'Mortality\r'                        smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Morbidity\r'                        smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Compute YLD\r'                        '-----------\r'                        HLYLD(tempj, k, G) = HLYLD(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                    Next G\r'                Next k\r'            Else 'all but last cohort\rFor k = 1 To CInt(Ntypes / 2)\r'jrs 2009/08/25 computing Morbidity\r'jrs 2009/08/25\rFor G = 1 To 2\rIf G = 1 Then\rfacLim = facLimM\rYears = yearsM 'jrs 2010/03/15\rElse\rfacLim = facLimF\rYears = yearsF 'jrs 2010/03/15\rEnd If\r\r'jrs 2014/03/13 *** end ***\r\r'jrs 2010/03/15\r'            'In last cohort\r'            If tempi% = MaxLifeExpCohort Then\r'                For k = 1 To cint(Ntypes / 2)\r'                    'jrs 2009/08/25\r'                    For G = 1 To 2\r'                        If G = 1 Then\r'                            facLim = facLimM\r'                        Else\r'                            facLim = facLimF\r'                        End If\r'\r'                        HLYLL(tempj, k, G) = HLYLL(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                        'All Years but first\r'                        '--------------------\r'                        If IY > 1 And smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) > 0.000000001 Then\r'                            modmorbdstdetRt = (modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) - _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))) / _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * _\r'                            (modmorbdstdetRt * hlmorbtomortgthport(k) + 1) 'jrs 2009/10/02 replaced YLDtoYLLratioGrowthPortion with hlmorbtomortgthport\r'                        Else\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * YLDtoYLLratio(tempj, k, G)\r'                        End If\r'                        'Save current year values\r'                        '------------------------\r'                        'Mortality\r'                        smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Morbidity\r'                        smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Compute YLD\r'                        '-----------\r'                        HLYLD(tempj, k, G) = HLYLD(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                    Next G\r'                Next k\r'            Else 'all but last cohort\rFor k = 1 To CInt(Ntypes / 2)\r'jrs 2009/08/25 computing Morbidity\r'jrs 2009/08/25\rFor G = 1 To 2\rIf G = 1 Then\rfacLim = facLimM\rYears = yearsM 'jrs 2010/03/15\rElse\rfacLim = facLimF\rYears = yearsF 'jrs 2010/03/15\rEnd If\r\r'jrs 2014/03/13 *** end ***\r\r'jrs 2010/03/15\r'            'In last cohort\r'            If tempi% = MaxLifeExpCohort Then\r'                For k = 1 To cint(Ntypes / 2)\r'                    'jrs 2009/08/25\r'                    For G = 1 To 2\r'                        If G = 1 Then\r'                            facLim = facLimM\r'                        Else\r'                            facLim = facLimF\r'                        End If\r'\r'                        HLYLL(tempj, k, G) = HLYLL(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                        'All Years but first\r'                        '--------------------\r'                        If IY > 1 And smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) > 0.000000001 Then\r'                            modmorbdstdetRt = (modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) - _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))) / _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * _\r'                            (modmorbdstdetRt * hlmorbtomortgthport(k) + 1) 'jrs 2009/10/02 replaced YLDtoYLLratioGrowthPortion with hlmorbtomortgthport\r'                        Else\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * YLDtoYLLratio(tempj, k, G)\r'                        End If\r'                        'Save current year values\r'                        '------------------------\r'                        'Mortality\r'                        smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Morbidity\r'                        smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Compute YLD\r'                        '-----------\r'                        HLYLD(tempj, k, G) = HLYLD(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                    Next G\r'                Next k\r'            Else 'all but last cohort\rFor k = 1 To CInt(Ntypes / 2)\r'jrs 2009/08/25 computing Morbidity\r'jrs 2009/08/25\rFor G = 1 To 2\rIf G = 1 Then\rfacLim = facLimM\rYears = yearsM 'jrs 2010/03/15\rElse\rfacLim = facLimF\rYears = yearsF 'jrs 2010/03/15\rEnd If\r\r'jrs 2014/03/13 *** end ***\r\r'jrs 2010/03/15\r'            'In last cohort\r'            If tempi% = MaxLifeExpCohort Then\r'                For k = 1 To cint(Ntypes / 2)\r'                    'jrs 2009/08/25\r'                    For G = 1 To 2\r'                        If G = 1 Then\r'                            facLim = facLimM\r'                        Else\r'                            facLim = facLimF\r'                        End If\r'\r'                        HLYLL(tempj, k, G) = HLYLL(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                        'All Years but first\r'                        '--------------------\r'                        If IY > 1 And smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) > 0.000000001 Then\r'                            modmorbdstdetRt = (modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) - _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))) / _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * _\r'                            (modmorbdstdetRt * hlmorbtomortgthport(k) + 1) 'jrs 2009/10/02 replaced YLDtoYLLratioGrowthPortion with hlmorbtomortgthport\r'                        Else\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * YLDtoYLLratio(tempj, k, G)\r'                        End If\r'                        'Save current year values\r'                        '------------------------\r'                        'Mortality\r'                        smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Morbidity\r'                        smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Compute YLD\r'                        '-----------\r'                        HLYLD(tempj, k, G) = HLYLD(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                    Next G\r'                Next k\r'            Else 'all but last cohort\rFor k = 1 To CInt(Ntypes / 2)\r'jrs 2009/08/25 computing Morbidity\r'jrs 2009/08/25\rFor G = 1 To 2\rIf G = 1 Then\rfacLim = facLimM\rYears = yearsM 'jrs 2010/03/15\rElse\rfacLim = facLimF\rYears = yearsF 'jrs 2010/03/15\rEnd If\r\r\r'jrs 2007/06/27\r'All Years: Smoking Impact - Compute Averages for All Ages and Accross Gender\r'----------------------------------------------------------------------------\rComputeSmokAvgAllAgesSex()\r\r'All Years: Diabetes Relative Risk - Compute Averages for All Ages and Accross Gender\r'------------------------------------------------------------------------------------\rComputeAvgDiabRRAgeSex(popgdr)\r\r'jrs 2018/04/19\r'All Years: Converge Intentional Injury time coeficient to avoid going too high over long horizons\r'-------------------------------------------------------------------------------------------------\r'jrs 2018/05/25\r'jrs 2020/08/19 Dim IY2030 As Integer move out, I don't know why it wasn't resetting to 0 every year\rDim k As Integer\r\rIf IY% = 1 Then\rReDim IntInjTimeFactors(12, 2)\r'for both genders\rFor k = 17 To 18\r'ages 5 to 59\rFor j = 2 To 12\rIntInjTimeFactors(j, k Mod 2) = mortFactors(j, k, 5, 2)\rNext j\rNext k\r'jrs 2018/05/25\rIY2030 = (2030 - BaseYear + 1)\rEnd If\r\r\r'YLL\r'---\rHLYLL(tempj, k, G) = CSng(HLYLL(tempj, k, G) +\r                            Years * facLim *\r                            modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000)\r\r\r'jrs 2007/06/27\r'All Years: Smoking Impact - Compute Averages for All Ages and Accross Gender\r'----------------------------------------------------------------------------\rComputeSmokAvgAllAgesSex()\r\r'All Years: Diabetes Relative Risk - Compute Averages for All Ages and Accross Gender\r'------------------------------------------------------------------------------------\rComputeAvgDiabRRAgeSex(popgdr)\r\r'jrs 2018/04/19\r'All Years: Converge Intentional Injury time coeficient to avoid going too high over long horizons\r'-------------------------------------------------------------------------------------------------\r'jrs 2018/05/25\r'jrs 2020/08/19 Dim IY2030 As Integer move out, I don't know why it wasn't resetting to 0 every year\rDim k As Integer\r\rIf IY% = 1 Then\rReDim IntInjTimeFactors(12, 2)\r'for both genders\rFor k = 17 To 18\r'ages 5 to 59\rFor j = 2 To 12\rIntInjTimeFactors(j, k Mod 2) = mortFactors(j, k, 5, 2)\rNext j\rNext k\r'jrs 2018/05/25\rIY2030 = (2030 - BaseYear + 1)\rEnd If\r\r\r'jrs 2008/10/03 Save HLYLL *** BEGIN ***\r'All Years: SUM for Total HLYLL\r'------------------------------\rFor rr = 1 To NR\rFor k = 1 To CInt(Ntypes / 2)\rHLYLL(rr, k, 3) = HLYLL(rr, k, 1) + HLYLL(rr, k, 2)\r'jrs 2009/01/12\rHLYLD(rr, k, 3) = HLYLD(rr, k, 1) + HLYLD(rr, k, 2)\r'jrs 2009/04/23\rHLDALY(rr, k, 3) = HLYLL(rr, k, 3) + HLYLD(rr, k, 3)\r'jrs 2009/08/31\rHLYLLWORK(rr, k, 3) = HLYLLWORK(rr, k, 1) + HLYLLWORK(rr, k, 2)\rHLYLDWORK(rr, k, 3) = HLYLDWORK(rr, k, 1) + HLYLDWORK(rr, k, 2)\rNext k\rNext rr\r"
  },
  {
    "Variable": "HLYLLWORK",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r\r'jrs 2012/10/31\r'cohMort = dtmp(j, gend%) / AMAX(0.00001, agedst(j, R%, gend%))\rIf agedst(j, R%, gend%) > 0 Then\rcohMort = CSng(dtmp(j, gend%) / agedst(j, R%, gend%))\rFor z = 1 To CInt(Ntypes / 2)\rIf gend% = 1 Then\rcohMort = CSng(cohMort + modmordstdet(j, R%, (z * 2) - 1))\r'Adjust mortality to be 0\rmodmordstdet(j, R%, (z * 2) - 1) = 0\rElse\rcohMort = CSng(cohMort + modmordstdet(j, R%, z * 2))\r'Adjust mortality to be 0\rmodmordstdet(j, R%, z * 2) = 0\rEnd If\rNext z\rcohMort = cohMort / 1000\r'jrs 2013/08/27 no Life Expectancy beyond people alive\r'cohMort = 1\rEnd If\rCOMPLETE STRUCTURE:Next k:11408|COMPLETE STRUCTURE:Next G:11408|\r'jrs 2014/03/13 *** end ***\r\r'jrs 2010/03/15\r'            'In last cohort\r'            If tempi% = MaxLifeExpCohort Then\r'                For k = 1 To cint(Ntypes / 2)\r'                    'jrs 2009/08/25\r'                    For G = 1 To 2\r'                        If G = 1 Then\r'                            facLim = facLimM\r'                        Else\r'                            facLim = facLimF\r'                        End If\r'\r'                        HLYLL(tempj, k, G) = HLYLL(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                        'All Years but first\r'                        '--------------------\r'                        If IY > 1 And smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) > 0.000000001 Then\r'                            modmorbdstdetRt = (modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) - _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))) / _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * _\r'                            (modmorbdstdetRt * hlmorbtomortgthport(k) + 1) 'jrs 2009/10/02 replaced YLDtoYLLratioGrowthPortion with hlmorbtomortgthport\r'                        Else\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * YLDtoYLLratio(tempj, k, G)\r'                        End If\r'                        'Save current year values\r'                        '------------------------\r'                        'Mortality\r'                        smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Morbidity\r'                        smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Compute YLD\r'                        '-----------\r'                        HLYLD(tempj, k, G) = HLYLD(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                    Next G\r'                Next k\r'            Else 'all but last cohort\rFor k = 1 To CInt(Ntypes / 2)\r'jrs 2009/08/25 computing Morbidity\r'jrs 2009/08/25\rFor G = 1 To 2\rIf G = 1 Then\rfacLim = facLimM\rYears = yearsM 'jrs 2010/03/15\rElse\rfacLim = facLimF\rYears = yearsF 'jrs 2010/03/15\rEnd If\r\r'jrs 2014/03/13 *** end ***\r\r'jrs 2010/03/15\r'            'In last cohort\r'            If tempi% = MaxLifeExpCohort Then\r'                For k = 1 To cint(Ntypes / 2)\r'                    'jrs 2009/08/25\r'                    For G = 1 To 2\r'                        If G = 1 Then\r'                            facLim = facLimM\r'                        Else\r'                            facLim = facLimF\r'                        End If\r'\r'                        HLYLL(tempj, k, G) = HLYLL(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                        'All Years but first\r'                        '--------------------\r'                        If IY > 1 And smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) > 0.000000001 Then\r'                            modmorbdstdetRt = (modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) - _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))) / _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * _\r'                            (modmorbdstdetRt * hlmorbtomortgthport(k) + 1) 'jrs 2009/10/02 replaced YLDtoYLLratioGrowthPortion with hlmorbtomortgthport\r'                        Else\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * YLDtoYLLratio(tempj, k, G)\r'                        End If\r'                        'Save current year values\r'                        '------------------------\r'                        'Mortality\r'                        smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Morbidity\r'                        smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Compute YLD\r'                        '-----------\r'                        HLYLD(tempj, k, G) = HLYLD(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                    Next G\r'                Next k\r'            Else 'all but last cohort\rFor k = 1 To CInt(Ntypes / 2)\r'jrs 2009/08/25 computing Morbidity\r'jrs 2009/08/25\rFor G = 1 To 2\rIf G = 1 Then\rfacLim = facLimM\rYears = yearsM 'jrs 2010/03/15\rElse\rfacLim = facLimF\rYears = yearsF 'jrs 2010/03/15\rEnd If\r\r'jrs 2014/03/13 *** end ***\r\r'jrs 2010/03/15\r'            'In last cohort\r'            If tempi% = MaxLifeExpCohort Then\r'                For k = 1 To cint(Ntypes / 2)\r'                    'jrs 2009/08/25\r'                    For G = 1 To 2\r'                        If G = 1 Then\r'                            facLim = facLimM\r'                        Else\r'                            facLim = facLimF\r'                        End If\r'\r'                        HLYLL(tempj, k, G) = HLYLL(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                        'All Years but first\r'                        '--------------------\r'                        If IY > 1 And smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) > 0.000000001 Then\r'                            modmorbdstdetRt = (modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) - _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))) / _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * _\r'                            (modmorbdstdetRt * hlmorbtomortgthport(k) + 1) 'jrs 2009/10/02 replaced YLDtoYLLratioGrowthPortion with hlmorbtomortgthport\r'                        Else\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * YLDtoYLLratio(tempj, k, G)\r'                        End If\r'                        'Save current year values\r'                        '------------------------\r'                        'Mortality\r'                        smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Morbidity\r'                        smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Compute YLD\r'                        '-----------\r'                        HLYLD(tempj, k, G) = HLYLD(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                    Next G\r'                Next k\r'            Else 'all but last cohort\rFor k = 1 To CInt(Ntypes / 2)\r'jrs 2009/08/25 computing Morbidity\r'jrs 2009/08/25\rFor G = 1 To 2\rIf G = 1 Then\rfacLim = facLimM\rYears = yearsM 'jrs 2010/03/15\rElse\rfacLim = facLimF\rYears = yearsF 'jrs 2010/03/15\rEnd If\r\r'jrs 2014/03/13 *** end ***\r\r'jrs 2010/03/15\r'            'In last cohort\r'            If tempi% = MaxLifeExpCohort Then\r'                For k = 1 To cint(Ntypes / 2)\r'                    'jrs 2009/08/25\r'                    For G = 1 To 2\r'                        If G = 1 Then\r'                            facLim = facLimM\r'                        Else\r'                            facLim = facLimF\r'                        End If\r'\r'                        HLYLL(tempj, k, G) = HLYLL(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                        'All Years but first\r'                        '--------------------\r'                        If IY > 1 And smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) > 0.000000001 Then\r'                            modmorbdstdetRt = (modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) - _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))) / _\r'                            smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * _\r'                            (modmorbdstdetRt * hlmorbtomortgthport(k) + 1) 'jrs 2009/10/02 replaced YLDtoYLLratioGrowthPortion with hlmorbtomortgthport\r'                        Else\r'                            modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = _\r'                            modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * YLDtoYLLratio(tempj, k, G)\r'                        End If\r'                        'Save current year values\r'                        '------------------------\r'                        'Mortality\r'                        smodmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Morbidity\r'                        smodmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) = modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2))\r'                        'Compute YLD\r'                        '-----------\r'                        HLYLD(tempj, k, G) = HLYLD(tempj, k, G) + _\r'                        years * MaxLifeExpCohortPortion * facLim * _\r'                        modmorbdstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000\r'\r'                    Next G\r'                Next k\r'            Else 'all but last cohort\rFor k = 1 To CInt(Ntypes / 2)\r'jrs 2009/08/25 computing Morbidity\r'jrs 2009/08/25\rFor G = 1 To 2\rIf G = 1 Then\rfacLim = facLimM\rYears = yearsM 'jrs 2010/03/15\rElse\rfacLim = facLimF\rYears = yearsF 'jrs 2010/03/15\rEnd If\r\r\r'jrs 2007/06/27\r'All Years: Smoking Impact - Compute Averages for All Ages and Accross Gender\r'----------------------------------------------------------------------------\rComputeSmokAvgAllAgesSex()\r\r'All Years: Diabetes Relative Risk - Compute Averages for All Ages and Accross Gender\r'------------------------------------------------------------------------------------\rComputeAvgDiabRRAgeSex(popgdr)\r\r'jrs 2018/04/19\r'All Years: Converge Intentional Injury time coeficient to avoid going too high over long horizons\r'-------------------------------------------------------------------------------------------------\r'jrs 2018/05/25\r'jrs 2020/08/19 Dim IY2030 As Integer move out, I don't know why it wasn't resetting to 0 every year\rDim k As Integer\r\rIf IY% = 1 Then\rReDim IntInjTimeFactors(12, 2)\r'for both genders\rFor k = 17 To 18\r'ages 5 to 59\rFor j = 2 To 12\rIntInjTimeFactors(j, k Mod 2) = mortFactors(j, k, 5, 2)\rNext j\rNext k\r'jrs 2018/05/25\rIY2030 = (2030 - BaseYear + 1)\rEnd If\r\r\r'jrs 2009/08/31\r'YLLWORK\r'-------\r'between 20 and 64\rIf tempi% > 4 And tempi% < 14 Then\rHLYLLWORK(tempj, k, G) = CSng(HLYLLWORK(tempj, k, G) +\r                                Years * facLim *\r                                modmordstdet(tempi%, tempj, (2 * k) - (G Mod 2)) * agedst(tempi%, tempj, G) / 1000)\rEnd If\r\r\r'jrs 2007/06/27\r'All Years: Smoking Impact - Compute Averages for All Ages and Accross Gender\r'----------------------------------------------------------------------------\rComputeSmokAvgAllAgesSex()\r\r'All Years: Diabetes Relative Risk - Compute Averages for All Ages and Accross Gender\r'------------------------------------------------------------------------------------\rComputeAvgDiabRRAgeSex(popgdr)\r\r'jrs 2018/04/19\r'All Years: Converge Intentional Injury time coeficient to avoid going too high over long horizons\r'-------------------------------------------------------------------------------------------------\r'jrs 2018/05/25\r'jrs 2020/08/19 Dim IY2030 As Integer move out, I don't know why it wasn't resetting to 0 every year\rDim k As Integer\r\rIf IY% = 1 Then\rReDim IntInjTimeFactors(12, 2)\r'for both genders\rFor k = 17 To 18\r'ages 5 to 59\rFor j = 2 To 12\rIntInjTimeFactors(j, k Mod 2) = mortFactors(j, k, 5, 2)\rNext j\rNext k\r'jrs 2018/05/25\rIY2030 = (2030 - BaseYear + 1)\rEnd If\r\r\r'jrs 2008/10/03 Save HLYLL *** BEGIN ***\r'All Years: SUM for Total HLYLL\r'------------------------------\rFor rr = 1 To NR\rFor k = 1 To CInt(Ntypes / 2)\rHLYLL(rr, k, 3) = HLYLL(rr, k, 1) + HLYLL(rr, k, 2)\r'jrs 2009/01/12\rHLYLD(rr, k, 3) = HLYLD(rr, k, 1) + HLYLD(rr, k, 2)\r'jrs 2009/04/23\rHLDALY(rr, k, 3) = HLYLL(rr, k, 3) + HLYLD(rr, k, 3)\r'jrs 2009/08/31\rHLYLLWORK(rr, k, 3) = HLYLLWORK(rr, k, 1) + HLYLLWORK(rr, k, 2)\rHLYLDWORK(rr, k, 3) = HLYLDWORK(rr, k, 1) + HLYLDWORK(rr, k, 2)\rNext k\rNext rr\r"
  },
  {
    "Variable": "HOMICIDEINDEX",
    "UsesVariable": "SVDTHSCONFLICTTOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HOMICIDEINDEX",
    "UsesVariable": "svindexm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HOMICIDEINDEX",
    "UsesVariable": "SVDTHSOTHERINTERTOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HOMICIDEINDEX",
    "UsesVariable": "SVDTHSWOMENTOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HOMICIDEINDEX",
    "UsesVariable": "SVDTHSCHILTOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HOMICIDEINDEX",
    "UsesVariable": "SVDTHSPOLICSTOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HOMICIDEINDEX",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "HPI1",
    "UsesVariable": "LIT",
    "Distance": 4,
    "Code": "\r'cdv 2022/11/18 ****END****\r'   All Years 3:  Human Poverty Index\r'   -------------------------------------\rDim cumMort, cohMort, IllitRate, NoWatSafe, p3 As Double\rFor R% = 1 To NR%\rFor gend% = 1 To 2\rcumMort = d(0, R%, gend%) /\r                    AMAX(0.00001, agedst(0, R%, gend%))\rFor j% = 1 To 8 'up through age 39\rcohMort = d(j%, R%, gend%) /\r                        AMAX(0.00001, agedst(j%, R%, gend%)) * 5\rcumMort = cumMort + cohMort\rNext j%\rNext gend%\rcumMort = cumMort * 100\rIf IY% = 1 Then\rIllitRate = 100 - LITI(R%)\rElse\rIllitRate = 100 - LIT(R%)\rEnd If\r'jrs 2009/02/18 NoWatSafe = 100 - WATSAFE(R%)\r'Debug.Print IY; RegName(R%)\r'mti 2022/08/17 start\r'mti 2022/10/20 start 'watsafefwdsw\r'If watsafenewsw = 1 Then 'new 5 category model\rIf watsafenewsw = 1 And watsafefwdsw = 1 Then 'new 5 category model\r'mti 2022/10/20 end\rNoWatSafe = WATERHH(R%, Surface, National) + WATERHH(R%, Unimproved, National)\rElse\rNoWatSafe = WATSAFE(R%, 1)\rEnd If\r'mti 2022/08/17 End\rp3 = (MALNCHP(R%) + NoWatSafe) / 2\rHPI1(R%) = CSng((1 / 3 * (cumMort ^ 3 + IllitRate ^ 3 + p3 ^ 3)) ^ (1 / 3))\r\r\r\rNext R%\r\r'cdv 2022/11/18 ****END****\r'   All Years 3:  Human Poverty Index\r'   -------------------------------------\rDim cumMort, cohMort, IllitRate, NoWatSafe, p3 As Double\rFor R% = 1 To NR%\rFor gend% = 1 To 2\rcumMort = d(0, R%, gend%) /\r                    AMAX(0.00001, agedst(0, R%, gend%))\rFor j% = 1 To 8 'up through age 39\rcohMort = d(j%, R%, gend%) /\r                        AMAX(0.00001, agedst(j%, R%, gend%)) * 5\rcumMort = cumMort + cohMort\rNext j%\rNext gend%\rcumMort = cumMort * 100\rIf IY% = 1 Then\rIllitRate = 100 - LITI(R%)\rElse\rIllitRate = 100 - LIT(R%)\rEnd If\r'jrs 2009/02/18 NoWatSafe = 100 - WATSAFE(R%)\r'Debug.Print IY; RegName(R%)\r'mti 2022/08/17 start\r'mti 2022/10/20 start 'watsafefwdsw\r'If watsafenewsw = 1 Then 'new 5 category model\rIf watsafenewsw = 1 And watsafefwdsw = 1 Then 'new 5 category model\r'mti 2022/10/20 end\rNoWatSafe = WATERHH(R%, Surface, National) + WATERHH(R%, Unimproved, National)\rElse\rNoWatSafe = WATSAFE(R%, 1)\rEnd If\r'mti 2022/08/17 End\rp3 = (MALNCHP(R%) + NoWatSafe) / 2\rHPI1(R%) = CSng((1 / 3 * (cumMort ^ 3 + IllitRate ^ 3 + p3 ^ 3)) ^ (1 / 3))\r\r\r\rNext R%\r\r'cdv 2022/11/18 ****END****\r'   All Years 3:  Human Poverty Index\r'   -------------------------------------\rDim cumMort, cohMort, IllitRate, NoWatSafe, p3 As Double\rFor R% = 1 To NR%\rFor gend% = 1 To 2\rcumMort = d(0, R%, gend%) /\r                    AMAX(0.00001, agedst(0, R%, gend%))\rFor j% = 1 To 8 'up through age 39\rcohMort = d(j%, R%, gend%) /\r                        AMAX(0.00001, agedst(j%, R%, gend%)) * 5\rcumMort = cumMort + cohMort\rNext j%\rNext gend%\rcumMort = cumMort * 100\rIf IY% = 1 Then\rIllitRate = 100 - LITI(R%)\rElse\rIllitRate = 100 - LIT(R%)\rEnd If\r'jrs 2009/02/18 NoWatSafe = 100 - WATSAFE(R%)\r'Debug.Print IY; RegName(R%)\r'mti 2022/08/17 start\r'mti 2022/10/20 start 'watsafefwdsw\r'If watsafenewsw = 1 Then 'new 5 category model\rIf watsafenewsw = 1 And watsafefwdsw = 1 Then 'new 5 category model\r'mti 2022/10/20 end\rNoWatSafe = WATERHH(R%, Surface, National) + WATERHH(R%, Unimproved, National)\rElse\rNoWatSafe = WATSAFE(R%, 1)\rEnd If\r'mti 2022/08/17 End\rp3 = (MALNCHP(R%) + NoWatSafe) / 2\rHPI1(R%) = CSng((1 / 3 * (cumMort ^ 3 + IllitRate ^ 3 + p3 ^ 3)) ^ (1 / 3))\r\r\r\rNext R%\r\r'cdv 2022/11/18 ****END****\r'   All Years 3:  Human Poverty Index\r'   -------------------------------------\rDim cumMort, cohMort, IllitRate, NoWatSafe, p3 As Double\rFor R% = 1 To NR%\rFor gend% = 1 To 2\rcumMort = d(0, R%, gend%) /\r                    AMAX(0.00001, agedst(0, R%, gend%))\rFor j% = 1 To 8 'up through age 39\rcohMort = d(j%, R%, gend%) /\r                        AMAX(0.00001, agedst(j%, R%, gend%)) * 5\rcumMort = cumMort + cohMort\rNext j%\rNext gend%\rcumMort = cumMort * 100\rIf IY% = 1 Then\rIllitRate = 100 - LITI(R%)\rElse\rIllitRate = 100 - LIT(R%)\rEnd If\r'jrs 2009/02/18 NoWatSafe = 100 - WATSAFE(R%)\r'Debug.Print IY; RegName(R%)\r'mti 2022/08/17 start\r'mti 2022/10/20 start 'watsafefwdsw\r'If watsafenewsw = 1 Then 'new 5 category model\rIf watsafenewsw = 1 And watsafefwdsw = 1 Then 'new 5 category model\r'mti 2022/10/20 end\rNoWatSafe = WATERHH(R%, Surface, National) + WATERHH(R%, Unimproved, National)\rElse\rNoWatSafe = WATSAFE(R%, 1)\rEnd If\r'mti 2022/08/17 End\rp3 = (MALNCHP(R%) + NoWatSafe) / 2\rHPI1(R%) = CSng((1 / 3 * (cumMort ^ 3 + IllitRate ^ 3 + p3 ^ 3)) ^ (1 / 3))\r\r\r\rNext R%\r\r'cdv 2022/11/18 ****END****\r'   All Years 3:  Human Poverty Index\r'   -------------------------------------\rDim cumMort, cohMort, IllitRate, NoWatSafe, p3 As Double\rFor R% = 1 To NR%\rFor gend% = 1 To 2\rcumMort = d(0, R%, gend%) /\r                    AMAX(0.00001, agedst(0, R%, gend%))\rFor j% = 1 To 8 'up through age 39\rcohMort = d(j%, R%, gend%) /\r                        AMAX(0.00001, agedst(j%, R%, gend%)) * 5\rcumMort = cumMort + cohMort\rNext j%\rNext gend%\rcumMort = cumMort * 100\rIf IY% = 1 Then\rIllitRate = 100 - LITI(R%)\rElse\rIllitRate = 100 - LIT(R%)\rEnd If\r'jrs 2009/02/18 NoWatSafe = 100 - WATSAFE(R%)\r'Debug.Print IY; RegName(R%)\r'mti 2022/08/17 start\r'mti 2022/10/20 start 'watsafefwdsw\r'If watsafenewsw = 1 Then 'new 5 category model\rIf watsafenewsw = 1 And watsafefwdsw = 1 Then 'new 5 category model\r'mti 2022/10/20 end\rNoWatSafe = WATERHH(R%, Surface, National) + WATERHH(R%, Unimproved, National)\rElse\rNoWatSafe = WATSAFE(R%, 1)\rEnd If\r'mti 2022/08/17 End\rp3 = (MALNCHP(R%) + NoWatSafe) / 2\rHPI1(R%) = CSng((1 / 3 * (cumMort ^ 3 + IllitRate ^ 3 + p3 ^ 3)) ^ (1 / 3))\r\r\r\rNext R%\r"
  },
  {
    "Variable": "HPI1",
    "UsesVariable": "MALNCHP",
    "Distance": 1,
    "Code": "\r'cdv 2022/11/18 ****END****\r'   All Years 3:  Human Poverty Index\r'   -------------------------------------\rDim cumMort, cohMort, IllitRate, NoWatSafe, p3 As Double\rFor R% = 1 To NR%\rFor gend% = 1 To 2\rcumMort = d(0, R%, gend%) /\r                    AMAX(0.00001, agedst(0, R%, gend%))\rFor j% = 1 To 8 'up through age 39\rcohMort = d(j%, R%, gend%) /\r                        AMAX(0.00001, agedst(j%, R%, gend%)) * 5\rcumMort = cumMort + cohMort\rNext j%\rNext gend%\rcumMort = cumMort * 100\rIf IY% = 1 Then\rIllitRate = 100 - LITI(R%)\rElse\rIllitRate = 100 - LIT(R%)\rEnd If\r'jrs 2009/02/18 NoWatSafe = 100 - WATSAFE(R%)\r'Debug.Print IY; RegName(R%)\r'mti 2022/08/17 start\r'mti 2022/10/20 start 'watsafefwdsw\r'If watsafenewsw = 1 Then 'new 5 category model\rIf watsafenewsw = 1 And watsafefwdsw = 1 Then 'new 5 category model\r'mti 2022/10/20 end\rNoWatSafe = WATERHH(R%, Surface, National) + WATERHH(R%, Unimproved, National)\rElse\rNoWatSafe = WATSAFE(R%, 1)\rEnd If\r'mti 2022/08/17 End\rp3 = (MALNCHP(R%) + NoWatSafe) / 2\rHPI1(R%) = CSng((1 / 3 * (cumMort ^ 3 + IllitRate ^ 3 + p3 ^ 3)) ^ (1 / 3))\r\r\r\rNext R%\r"
  },
  {
    "Variable": "HPI1",
    "UsesVariable": "WATSAFE",
    "Distance": 2,
    "Code": "\r'cdv 2022/11/18 ****END****\r'   All Years 3:  Human Poverty Index\r'   -------------------------------------\rDim cumMort, cohMort, IllitRate, NoWatSafe, p3 As Double\rFor R% = 1 To NR%\rFor gend% = 1 To 2\rcumMort = d(0, R%, gend%) /\r                    AMAX(0.00001, agedst(0, R%, gend%))\rFor j% = 1 To 8 'up through age 39\rcohMort = d(j%, R%, gend%) /\r                        AMAX(0.00001, agedst(j%, R%, gend%)) * 5\rcumMort = cumMort + cohMort\rNext j%\rNext gend%\rcumMort = cumMort * 100\rIf IY% = 1 Then\rIllitRate = 100 - LITI(R%)\rElse\rIllitRate = 100 - LIT(R%)\rEnd If\r'jrs 2009/02/18 NoWatSafe = 100 - WATSAFE(R%)\r'Debug.Print IY; RegName(R%)\r'mti 2022/08/17 start\r'mti 2022/10/20 start 'watsafefwdsw\r'If watsafenewsw = 1 Then 'new 5 category model\rIf watsafenewsw = 1 And watsafefwdsw = 1 Then 'new 5 category model\r'mti 2022/10/20 end\rNoWatSafe = WATERHH(R%, Surface, National) + WATERHH(R%, Unimproved, National)\rElse\rNoWatSafe = WATSAFE(R%, 1)\rEnd If\r'mti 2022/08/17 End\rp3 = (MALNCHP(R%) + NoWatSafe) / 2\rHPI1(R%) = CSng((1 / 3 * (cumMort ^ 3 + IllitRate ^ 3 + p3 ^ 3)) ^ (1 / 3))\r\r\r\rNext R%\r\r'cdv 2022/11/18 ****END****\r'   All Years 3:  Human Poverty Index\r'   -------------------------------------\rDim cumMort, cohMort, IllitRate, NoWatSafe, p3 As Double\rFor R% = 1 To NR%\rFor gend% = 1 To 2\rcumMort = d(0, R%, gend%) /\r                    AMAX(0.00001, agedst(0, R%, gend%))\rFor j% = 1 To 8 'up through age 39\rcohMort = d(j%, R%, gend%) /\r                        AMAX(0.00001, agedst(j%, R%, gend%)) * 5\rcumMort = cumMort + cohMort\rNext j%\rNext gend%\rcumMort = cumMort * 100\rIf IY% = 1 Then\rIllitRate = 100 - LITI(R%)\rElse\rIllitRate = 100 - LIT(R%)\rEnd If\r'jrs 2009/02/18 NoWatSafe = 100 - WATSAFE(R%)\r'Debug.Print IY; RegName(R%)\r'mti 2022/08/17 start\r'mti 2022/10/20 start 'watsafefwdsw\r'If watsafenewsw = 1 Then 'new 5 category model\rIf watsafenewsw = 1 And watsafefwdsw = 1 Then 'new 5 category model\r'mti 2022/10/20 end\rNoWatSafe = WATERHH(R%, Surface, National) + WATERHH(R%, Unimproved, National)\rElse\rNoWatSafe = WATSAFE(R%, 1)\rEnd If\r'mti 2022/08/17 End\rp3 = (MALNCHP(R%) + NoWatSafe) / 2\rHPI1(R%) = CSng((1 / 3 * (cumMort ^ 3 + IllitRate ^ 3 + p3 ^ 3)) ^ (1 / 3))\r\r\r\rNext R%\r\r'cdv 2022/11/18 ****END****\r'   All Years 3:  Human Poverty Index\r'   -------------------------------------\rDim cumMort, cohMort, IllitRate, NoWatSafe, p3 As Double\rFor R% = 1 To NR%\rFor gend% = 1 To 2\rcumMort = d(0, R%, gend%) /\r                    AMAX(0.00001, agedst(0, R%, gend%))\rFor j% = 1 To 8 'up through age 39\rcohMort = d(j%, R%, gend%) /\r                        AMAX(0.00001, agedst(j%, R%, gend%)) * 5\rcumMort = cumMort + cohMort\rNext j%\rNext gend%\rcumMort = cumMort * 100\rIf IY% = 1 Then\rIllitRate = 100 - LITI(R%)\rElse\rIllitRate = 100 - LIT(R%)\rEnd If\r'jrs 2009/02/18 NoWatSafe = 100 - WATSAFE(R%)\r'Debug.Print IY; RegName(R%)\r'mti 2022/08/17 start\r'mti 2022/10/20 start 'watsafefwdsw\r'If watsafenewsw = 1 Then 'new 5 category model\rIf watsafenewsw = 1 And watsafefwdsw = 1 Then 'new 5 category model\r'mti 2022/10/20 end\rNoWatSafe = WATERHH(R%, Surface, National) + WATERHH(R%, Unimproved, National)\rElse\rNoWatSafe = WATSAFE(R%, 1)\rEnd If\r'mti 2022/08/17 End\rp3 = (MALNCHP(R%) + NoWatSafe) / 2\rHPI1(R%) = CSng((1 / 3 * (cumMort ^ 3 + IllitRate ^ 3 + p3 ^ 3)) ^ (1 / 3))\r\r\r\rNext R%\r"
  },
  {
    "Variable": "HPI1",
    "UsesVariable": "watsafenewsw",
    "Distance": 2,
    "Code": "\r'cdv 2022/11/18 ****END****\r'   All Years 3:  Human Poverty Index\r'   -------------------------------------\rDim cumMort, cohMort, IllitRate, NoWatSafe, p3 As Double\rFor R% = 1 To NR%\rFor gend% = 1 To 2\rcumMort = d(0, R%, gend%) /\r                    AMAX(0.00001, agedst(0, R%, gend%))\rFor j% = 1 To 8 'up through age 39\rcohMort = d(j%, R%, gend%) /\r                        AMAX(0.00001, agedst(j%, R%, gend%)) * 5\rcumMort = cumMort + cohMort\rNext j%\rNext gend%\rcumMort = cumMort * 100\rIf IY% = 1 Then\rIllitRate = 100 - LITI(R%)\rElse\rIllitRate = 100 - LIT(R%)\rEnd If\r'jrs 2009/02/18 NoWatSafe = 100 - WATSAFE(R%)\r'Debug.Print IY; RegName(R%)\r'mti 2022/08/17 start\r'mti 2022/10/20 start 'watsafefwdsw\r'If watsafenewsw = 1 Then 'new 5 category model\rIf watsafenewsw = 1 And watsafefwdsw = 1 Then 'new 5 category model\r'mti 2022/10/20 end\rNoWatSafe = WATERHH(R%, Surface, National) + WATERHH(R%, Unimproved, National)\rElse\rNoWatSafe = WATSAFE(R%, 1)\rEnd If\r'mti 2022/08/17 End\rp3 = (MALNCHP(R%) + NoWatSafe) / 2\rHPI1(R%) = CSng((1 / 3 * (cumMort ^ 3 + IllitRate ^ 3 + p3 ^ 3)) ^ (1 / 3))\r\r\r\rNext R%\r"
  },
  {
    "Variable": "HPI1",
    "UsesVariable": "watsafefwdsw",
    "Distance": 2,
    "Code": "\r'cdv 2022/11/18 ****END****\r'   All Years 3:  Human Poverty Index\r'   -------------------------------------\rDim cumMort, cohMort, IllitRate, NoWatSafe, p3 As Double\rFor R% = 1 To NR%\rFor gend% = 1 To 2\rcumMort = d(0, R%, gend%) /\r                    AMAX(0.00001, agedst(0, R%, gend%))\rFor j% = 1 To 8 'up through age 39\rcohMort = d(j%, R%, gend%) /\r                        AMAX(0.00001, agedst(j%, R%, gend%)) * 5\rcumMort = cumMort + cohMort\rNext j%\rNext gend%\rcumMort = cumMort * 100\rIf IY% = 1 Then\rIllitRate = 100 - LITI(R%)\rElse\rIllitRate = 100 - LIT(R%)\rEnd If\r'jrs 2009/02/18 NoWatSafe = 100 - WATSAFE(R%)\r'Debug.Print IY; RegName(R%)\r'mti 2022/08/17 start\r'mti 2022/10/20 start 'watsafefwdsw\r'If watsafenewsw = 1 Then 'new 5 category model\rIf watsafenewsw = 1 And watsafefwdsw = 1 Then 'new 5 category model\r'mti 2022/10/20 end\rNoWatSafe = WATERHH(R%, Surface, National) + WATERHH(R%, Unimproved, National)\rElse\rNoWatSafe = WATSAFE(R%, 1)\rEnd If\r'mti 2022/08/17 End\rp3 = (MALNCHP(R%) + NoWatSafe) / 2\rHPI1(R%) = CSng((1 / 3 * (cumMort ^ 3 + IllitRate ^ 3 + p3 ^ 3)) ^ (1 / 3))\r\r\r\rNext R%\r"
  },
  {
    "Variable": "HPI1",
    "UsesVariable": "POP",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "HPI1",
    "UsesVariable": "tmortr2",
    "Distance": 484,
    "Code": "0"
  },
  {
    "Variable": "HPI1",
    "UsesVariable": "tmortr",
    "Distance": 485,
    "Code": "0"
  },
  {
    "Variable": "HPI1",
    "UsesVariable": "GDPPCP",
    "Distance": 1033,
    "Code": "0"
  },
  {
    "Variable": "HPI1",
    "UsesVariable": "LIFEXP",
    "Distance": 502,
    "Code": "0"
  },
  {
    "Variable": "HPI1",
    "UsesVariable": "CIVDM",
    "Distance": 486,
    "Code": "0"
  },
  {
    "Variable": "HPI1",
    "UsesVariable": "mortconv",
    "Distance": 891,
    "Code": "0"
  },
  {
    "Variable": "HPI1",
    "UsesVariable": "CLNEED",
    "Distance": 497,
    "Code": "0"
  },
  {
    "Variable": "HPI1",
    "UsesVariable": "clsexp",
    "Distance": 497,
    "Code": "0"
  },
  {
    "Variable": "HPI1",
    "UsesVariable": "mortm",
    "Distance": 487,
    "Code": "0"
  },
  {
    "Variable": "HPI1",
    "UsesVariable": "MORTMG",
    "Distance": 487,
    "Code": "0"
  },
  {
    "Variable": "HPI1",
    "UsesVariable": "AIDSDTHS",
    "Distance": 894,
    "Code": "0"
  },
  {
    "Variable": "HPI1",
    "UsesVariable": "CLAVAL",
    "Distance": 500,
    "Code": "0"
  },
  {
    "Variable": "HPI1",
    "UsesVariable": "agon",
    "Distance": 500,
    "Code": "0"
  },
  {
    "Variable": "HTCGRI",
    "UsesVariable": "POP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "HTCGRI",
    "UsesVariable": "DEMOCPOLITY",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "HTCGRI",
    "UsesVariable": "EDSECENRG",
    "Distance": 2,
    "Code": "\r\r'jrs 2016/08/02\r'First Year: Human Traffic\r'----------------------------------\rDim Est As Single\rFor R = 1 To NR\r'Human Traffic Prevalence\r'Call AnalFunc(\"Human Traffic Prevalence (2015)\", Array(POP(R), GOVEFFECT(R)), Est, Array(\"POP\", \"GOVEFFECT\"))\r\rCall AnalFunc(\"Human Traffic Prevalence (2015)\",\r                New Single() {POP(R), GOVEFFECT(R)}, Est,\r                New String() {\"POP\", \"GOVEFFECT\"}, context)\r\r\rIf HTCTPI(R) <> -1 Then\rHTCTPIShift(R) = HTCTPI(R) - Est\rElse\rHTCTPI(R) = Est\rHTCTPIShift(R) = 0\rEnd If\r'Government Response to Trafficking\r'Call AnalFunc(\"Government response to trafficking (2015)\", Array(POP(R), DEMOCPOLITY(R), EDSECENRG(R, 2)), Est, Array(\"POP\", \"POLITYCOMBINED\", \"EDSECENROLLGROSSFEMALE\"))\r\rCall AnalFunc(\"Government response to trafficking (2015)\",\r                New Single() {POP(R), DEMOCPOLITY(R), EDSECENRG(R, 2)}, Est,\r                New String() {\"POP\", \"POLITYCOMBINED\", \"EDSECENROLLGROSSFEMALE\"}, context)\r\rIf HTCGRI(R) <> -1 Then\rHTCGRIShift(R) = HTCGRI(R) - Est\rElse\rHTCGRI(R) = Est\rHTCGRIShift(R) = 0\rEnd If\rNext R\r"
  },
  {
    "Variable": "HTCTPI",
    "UsesVariable": "POP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "HTCTPI",
    "UsesVariable": "GOVEFFECT",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "I",
    "UsesVariable": "bilateralsw",
    "Distance": 0,
    "Code": "\r'clp 2023/12/20 create new process for adding dyadic aid flows that also increases monadic; Calls in ifsEcoDyadic1AllButFirst\r'and ifsEcoDyadic1FirstYear; dyadaidexoadd also added to ForAid at end\rPublic Sub ifsEcoDyadicExo2MonadicAid(context As IForecastContext)\r'Declare parameter, index, and dimensions\r'ReDim dyadaidexoadd(NR, NR)\rDim i = 1%\r'Saving variables\r'Located here IFF monadic changes are necessary\rEnd Sub\r"
  },
  {
    "Variable": "I",
    "UsesVariable": "IGCF",
    "Distance": 0,
    "Code": "\r'i(R%) = IGCF(R%) + newstocks - oldstocks\rI(R%) = IGCF(R%) + DeltaStocks 'bbh 2021/07/07 end\r\r\rPublic Sub ifsEcoDyadic1AllYears(context As IForecastContext)\r'ReDim MTARIFFREV(NR, NR)\rCall ifsEcoDyadicINF(context)\r'jrs 2019/08/09\r'Initalization\rDim i = 1%\rFor i = 1 To NR\rFor k = 1 To NSec\rMTARIFFREV(i, k) = 0\rXTARIFFREV(i, k) = 0\rNext k\rNext i\rEnd Sub\r"
  },
  {
    "Variable": "I",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "\rDeltaStocks = 0\r\rFor S% = 1 To NSec%\r'If RegName$(R%) = \"Angola\" Then Stop\rsuminvs = suminvs + INVS(R%, S%)\r'            If ((S% > Ener) Or (S% = Agri And agon < 0.9) Or _\r'(S% = Ener And enon < 0.9)) Then 'bbh 2022/12/13  Also tried commenting out the If and End If statements here so that ag and energy stocks also would be PDF based\r'Same problems recognized as when do that around price and Excess Stock logic; Ag stocks for some countries huge and cause bad Excess Stock behavior\r'But:  Using PFD logic for stocks in Econ model rather than taking from Ag model greatly improves behavior of S (foreign and domestic) - I should equal 0.0\r'bbh 2022/12/20 Again using all 6 sectors, but only for computation of I from IGCF - make sure that the IFs stdatement just above is commented out\r'DStocks = CS(R%, S%) + INVS(R%, S%) + GS(R%, S%) + XS(R%, S%)\r'DStocks = PFD(R%, S%) + MS(R%, S%) - DStocks\r'DeltaStocks = DeltaStocks + DStocks\rst_red = CS(R%, S%) + INVS(R%, S%) + GS(R%, S%) + XS(R%, S%)\r'recomputed = sstphys(R%, S%) + PFD(R%, S%) + MS(R%, S%) - st_red\r'oldstocks = oldstocks + sstphys(R%, S%)\r'newstocks = newstocks + recomputed\r'sstphys(R%, S%) = recomputed\r'suminvs = suminvs + INVS(R%, S%)\rDeltaStocks = DeltaStocks + PFD(R%, S%) + MS(R%, S%) - st_red\r'If RegName$(R%) = \"United States of America\" And IY% >= 45 Then Stop  'bbh 2021/07/07\r'Development note:  The stocks computed here for ag and en are very\r'different than those coming from the physcial models; they are\r'residuals only for the purpose of balancing expenditure components;\r'remember that PFD has no counterpart in the ag/en models\r'End If 'bbh 2022/12/13 'bbh 2022/12/20 Again exploring using all 6 sectors, but only for computation of I from IGC\rNext S%\r"
  },
  {
    "Variable": "I",
    "UsesVariable": "PFD",
    "Distance": 1,
    "Code": "\rDeltaStocks = 0\r"
  },
  {
    "Variable": "I",
    "UsesVariable": "MS",
    "Distance": 1,
    "Code": "\rDeltaStocks = 0\r"
  },
  {
    "Variable": "I",
    "UsesVariable": "CS",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "I",
    "UsesVariable": "INVS",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "I",
    "UsesVariable": "GS",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "I",
    "UsesVariable": "XS",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "IALK",
    "UsesVariable": "landarablepot",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "IALK",
    "UsesVariable": "LD",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "IALK",
    "UsesVariable": "dkl",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "IALK",
    "UsesVariable": "CLD",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "IALK",
    "UsesVariable": "INAG",
    "Distance": 24,
    "Code": "0"
  },
  {
    "Variable": "IALK",
    "UsesVariable": "agon",
    "Distance": 24,
    "Code": "0"
  },
  {
    "Variable": "IALK",
    "UsesVariable": "eliasp1",
    "Distance": 1,
    "Code": "\rDiff2 = RETRAT(R%) - SRETR(R%)\r\rDiff1 = RETRAT(R%) - RETRI(R%)\r\rCall ADJSTR(1, Diff1, Diff2, eliasp1, eliasp2, Mul)\r\rIALK(R%) = SIALK(R%) * Mul\r"
  },
  {
    "Variable": "IALK",
    "UsesVariable": "eliasp2",
    "Distance": 1,
    "Code": "\rDiff2 = RETRAT(R%) - SRETR(R%)\r"
  },
  {
    "Variable": "IALK",
    "UsesVariable": "RETRAT",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "IALK",
    "UsesVariable": "ldcropm",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "ICTBROAD",
    "UsesVariable": "ictbroadm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ICTBROAD",
    "UsesVariable": "ictbroadtrgtyr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ICTBROAD",
    "UsesVariable": "ictbroadtrgtval",
    "Distance": 1,
    "Code": "\r\r'mti June 14, 2012 - BBCap - start\rictbroadcap = 50\r"
  },
  {
    "Variable": "ICTBROAD",
    "UsesVariable": "ictbroadfromtelem",
    "Distance": 0,
    "Code": "\r\r'mti June 14, 2012 - BBCap - start\rictbroadcap = 50\r\r\r\r'Add telephone divestment impact\rICTBROAD(R%) = CSng(Amin(ictbroadcap, AMAX(0.0001, ICTBROAD(R%) + ictbroadfromtelem * AMAX(0, SSINFRATELE(R%) - SINFRATELE(R%)))))\r"
  },
  {
    "Variable": "ICTBROAD",
    "UsesVariable": "INFRATELE",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ICTBROAD",
    "UsesVariable": "ictbroadteclowrt",
    "Distance": 6,
    "Code": "\rincCS = incCS * UrbImp\r\rIf SBroad(R, 2) < ictbroadtecinflection Then\rincTec = (ictbroadtechighrt(R%) * ltfac - ictbroadteclowrt * ltfac) * SBroad(R, 2) / ictbroadtecinflection + ictbroadteclowrt * ltfac\rElse\r'incTec = (ictbroadteclowrt * ltfac - ictbroadtechighrt(R%) * ltfac) * (SBroad(R, 2) - ictbroadtecinflection) / (100 - ictbroadtecinflection) + ictbroadtechighrt(R%) * ltfac\rincTec = (ictbroadteclowrt * ltfac - ictbroadtechighrt(R%) * ltfac) * (SBroad(R, 2) - ictbroadtecinflection) / (ictbroadcap - ictbroadtecinflection) + ictbroadtechighrt(R%) * ltfac\rEnd If\r\r\r'jrs 2010/12/06 *** begin: Using Annual Growth Rate ***\r'******************************************************\r'jrs 2010/12/06\rIf Not (ICTBroadGR(R).HasValue) Then\rincTot = incTec + incCS\rElse\r\r\r'                    HistWg = 0\r'                    'incTot = HistWg * ICTBroadGR(R) * SBroad(R, 2) + (1 - HistWg) * (incTec + incCS)\r'                    'Instead of using the compoundig Growth Rate, use just the flat differece between the 2 last years\r'                    'F(y-1) - F(y-2) = F(y-1) * (1 - 1/(1+GR))\r'                    'incTot = HistWg * SBroad(R, 2) * (1 - 1 / (1 + ICTBroadGR(R))) + (1 - HistWg) * (incTec + incCS)\r'                    incTot = ConvergeOverTime(SBroad(R, 2) * (1 - 1 / (1 + ICTBroadGR(R))), incTec + incCS, 10)\r\r'new formulation (growth rate convergence, slower)\r'                    gratem = (incTec + incCS) / AMAX(0.01, SBroad(R, 2)) 'growth rate from model\r'                    gratec = ConvergeOverTime(ICTBroadGR(R), gratem, 25) 'growth rate from previous year converge to that from model\r'                    incTot = gratec * SBroad(R, 2)\r'mti January 17, 2012 -end\r\r'percent point change\rgratem = incTec + incCS '/ AMAX(0.01, SBroad(R, 2)) 'growth rate from model\rgratec = ConvergeOverTime(CSng(ICTBroadGR(R)), gratem, 15) 'growth rate from previous year converge to that from model\rincTot = gratec '* SBroad(R, 2)\r\r\rEnd If\r\r\rPrivate Sub ICTFixedBBForecast(ByRef SGOVREGQUAL() As Single, ByRef sGDPPCP() As Single, ByRef sPOPTotal() As Single,\r                                       ByRef SBroad(,) As Single, ByRef ICTBroadGR() As Single?, ByRef ICTBroadBF() As Single,\r                                       ByRef sICTBroadBF() As Single, ByRef sBroadBF(,) As Single, ByRef ICTBroadGRBF() As Single?,\r                                       ByRef INFRAINVESTNEWBF(,) As Single, ByRef INFRAINVESTMAINTBF(,) As Single, DeppcntBroad As Double,\r                                       ByRef SICTBroad() As Single, ByRef SSINFRATELE() As Double, ByRef SINFRATELE() As Double,\r                                       ByRef iICTBroad() As Single, ByRef ictbroadtrgtyr() As Single, ByRef ictbroadtrgtval() As Single, context As IForecastContext)\r'----------------------------------------------------------------------------------------------------------------------------------\r'mti June 14, 2012 - start\r\r'mti 2013/12/20 start\rIf context.HistoricMode = True AndAlso context.FirstYearHistory < 1990 Then\r'no Fixed BB for pre-1990 hist base\rFor R% = 1 To NR%\rICTBROAD(R) = 0\rICTBroadGR(R) = 0\r\rICTBROADCOST(R%) = 0\rINFRAINVESTNEW(R%, Broadband) = 0\rINFRAINVESTMAINT(R%, Broadband) = 0\r\rICTBroadBF(R%) = 0\rICTBroadGRBF(R%) = 0\rINFRAINVESTNEWBF(R%, Broadband) = 0\rINFRAINVESTMAINTBF(R%, Broadband) = 0\rNext\rExit Sub\rEnd If\r\r\rPrivate Sub ICTFixedBBForecast(ByRef SGOVREGQUAL() As Single, ByRef sGDPPCP() As Single, ByRef sPOPTotal() As Single,\r                                       ByRef SBroad(,) As Single, ByRef ICTBroadGR() As Single?, ByRef ICTBroadBF() As Single,\r                                       ByRef sICTBroadBF() As Single, ByRef sBroadBF(,) As Single, ByRef ICTBroadGRBF() As Single?,\r                                       ByRef INFRAINVESTNEWBF(,) As Single, ByRef INFRAINVESTMAINTBF(,) As Single, DeppcntBroad As Double,\r                                       ByRef SICTBroad() As Single, ByRef SSINFRATELE() As Double, ByRef SINFRATELE() As Double,\r                                       ByRef iICTBroad() As Single, ByRef ictbroadtrgtyr() As Single, ByRef ictbroadtrgtval() As Single, context As IForecastContext)\r'----------------------------------------------------------------------------------------------------------------------------------\r'mti June 14, 2012 - start\r\r'mti 2013/12/20 start\rIf context.HistoricMode = True AndAlso context.FirstYearHistory < 1990 Then\r'no Fixed BB for pre-1990 hist base\rFor R% = 1 To NR%\rICTBROAD(R) = 0\rICTBroadGR(R) = 0\r\rICTBROADCOST(R%) = 0\rINFRAINVESTNEW(R%, Broadband) = 0\rINFRAINVESTMAINT(R%, Broadband) = 0\r\rICTBroadBF(R%) = 0\rICTBroadGRBF(R%) = 0\rINFRAINVESTNEWBF(R%, Broadband) = 0\rINFRAINVESTMAINTBF(R%, Broadband) = 0\rNext\rExit Sub\rEnd If\r\r\r'jrs 2010/12/06 *** begin: Using Annual Growth Rate ***\r'******************************************************\r'jrs 2010/12/06\rIf Not (ICTBroadGR(R).HasValue) Then\rincTot = incTec + incCS\rElse\r\r\r'                    HistWg = 0\r'                    'incTot = HistWg * ICTBroadGR(R) * SBroad(R, 2) + (1 - HistWg) * (incTec + incCS)\r'                    'Instead of using the compoundig Growth Rate, use just the flat differece between the 2 last years\r'                    'F(y-1) - F(y-2) = F(y-1) * (1 - 1/(1+GR))\r'                    'incTot = HistWg * SBroad(R, 2) * (1 - 1 / (1 + ICTBroadGR(R))) + (1 - HistWg) * (incTec + incCS)\r'                    incTot = ConvergeOverTime(SBroad(R, 2) * (1 - 1 / (1 + ICTBroadGR(R))), incTec + incCS, 10)\r\r'new formulation (growth rate convergence, slower)\r'                    gratem = (incTec + incCS) / AMAX(0.01, SBroad(R, 2)) 'growth rate from model\r'                    gratec = ConvergeOverTime(ICTBroadGR(R), gratem, 25) 'growth rate from previous year converge to that from model\r'                    incTot = gratec * SBroad(R, 2)\r'mti January 17, 2012 -end\r\r'percent point change\rgratem = incTec + incCS '/ AMAX(0.01, SBroad(R, 2)) 'growth rate from model\rgratec = ConvergeOverTime(CSng(ICTBroadGR(R)), gratem, 15) 'growth rate from previous year converge to that from model\rincTot = gratec '* SBroad(R, 2)\r\r\rEnd If\r\r\r'mti June 14, 2012 - BBCap - start\rictbroadcap = 50\r\r\r'jrs 2010/12/06 *** begin: Using Annual Growth Rate ***\r'******************************************************\r'jrs 2010/12/06\rIf Not (ICTBroadGR(R).HasValue) Then\rincTot = incTec + incCS\rElse\r\r\r'                    HistWg = 0\r'                    'incTot = HistWg * ICTBroadGR(R) * SBroad(R, 2) + (1 - HistWg) * (incTec + incCS)\r'                    'Instead of using the compoundig Growth Rate, use just the flat differece between the 2 last years\r'                    'F(y-1) - F(y-2) = F(y-1) * (1 - 1/(1+GR))\r'                    'incTot = HistWg * SBroad(R, 2) * (1 - 1 / (1 + ICTBroadGR(R))) + (1 - HistWg) * (incTec + incCS)\r'                    incTot = ConvergeOverTime(SBroad(R, 2) * (1 - 1 / (1 + ICTBroadGR(R))), incTec + incCS, 10)\r\r'new formulation (growth rate convergence, slower)\r'                    gratem = (incTec + incCS) / AMAX(0.01, SBroad(R, 2)) 'growth rate from model\r'                    gratec = ConvergeOverTime(ICTBroadGR(R), gratem, 25) 'growth rate from previous year converge to that from model\r'                    incTot = gratec * SBroad(R, 2)\r'mti January 17, 2012 -end\r\r'percent point change\rgratem = incTec + incCS '/ AMAX(0.01, SBroad(R, 2)) 'growth rate from model\rgratec = ConvergeOverTime(CSng(ICTBroadGR(R)), gratem, 15) 'growth rate from previous year converge to that from model\rincTot = gratec '* SBroad(R, 2)\r\r\rEnd If\r\r\r\r\rSBroad(R, 1) = ICTBROAD(R)\r\r\r'Add Increase/Decrease to final value, this is the tec factor\r'Total increment can't be more than 25% of the remaining gap to reach target of 120\rICTBROAD(R) = SBroad(R, 2) + Amin(incTot, (ictbroadcap - SBroad(R, 2)) / 4)\r\r\r'mti June 14, 2012 - BBCap - start\rictbroadcap = 50\r\r\r\r\rSBroad(R, 1) = ICTBROAD(R)\r\r\r'Apply Absolute Cap; prevent decline of base forecast\rICTBROAD(R) = Amin(AMAX(ICTBROAD(R), SBroad(R, 2)), ictbroadcap)\r"
  },
  {
    "Variable": "ICTBROAD",
    "UsesVariable": "ictbroadtechighrt",
    "Distance": 6,
    "Code": "\r'mti June 14, 2012 - BBCap -end\r\rltfac = 0.5\r"
  },
  {
    "Variable": "ICTBROAD",
    "UsesVariable": "ictbroadtecinflection",
    "Distance": 6,
    "Code": "\r\r'mti 2014/05/28 - start\rSBroad(R, 3) = ICTBROAD(R)\r"
  },
  {
    "Variable": "ICTBROAD",
    "UsesVariable": "ictbroadurimpmin",
    "Distance": 12,
    "Code": "\r\r'mti 2014/05/28 - start\rSBroad(R, 3) = ICTBROAD(R)\r\r\r\rUrbImp = ictbroadurimpmin + AMAX(0, (ictbroadurimpmax - ictbroadurimpmin)) * SPOPURBAN(R%) / sPOPTotal(R%)\r\r\rincCS = ICTBROAD(R) - SBroad(R, 1)\r\r\r'mti June 14, 2012 - BBCap - start\rictbroadcap = 50\r"
  },
  {
    "Variable": "ICTBROAD",
    "UsesVariable": "ictbroadurimpmax",
    "Distance": 12,
    "Code": "\r\r'mti 2014/05/28 - start\rSBroad(R, 3) = ICTBROAD(R)\r"
  },
  {
    "Variable": "ICTBROAD",
    "UsesVariable": "POPURBAN",
    "Distance": 12,
    "Code": "\r\r'mti 2014/05/28 - start\rSBroad(R, 3) = ICTBROAD(R)\r"
  },
  {
    "Variable": "ICTBROAD",
    "UsesVariable": "GDPPCP",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "ICTBROAD",
    "UsesVariable": "GOVREGQUAL",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "ICTBROAD",
    "UsesVariable": "ictbroadsetar",
    "Distance": 1,
    "Code": "\r\rBROADshift(R) = ICTBROAD(R) - BroadVal\r\r\r\r'Tec Factor: S-Curve shaped\r'---------------------------\r'Drawn from World Data from 1980 to 2007       'Saturation of 120\r\r'Shift convergence\rBroadAdd = ConvergeOverTime(BROADshift(R), 0, 100)\r\r\r'sErrorSub = \"ICTFixedBBForecast\" & CStr(IFUN) & \"-\" & RegName(R%)\r\r'All years but first: Access to Fixed Broadband\r'------------------------------------------------------\r'CS (Cross-sectional formulation)\rCall AnalFuncSE(\"ICT Broadband Access % of Population Rev 2010\",\r            New Single() {GDPPCP(R), SGOVREGQUAL(R)}, rVal, SE,\r            New String() {\"GDP2005PCPPP(MOSTRECENT)/ 1000 (Log)\", \"GovernanceRegQual(MOSTRECENT)+ 2.5 (Linear)\"}, context) 'jrs 2014/10/09 added DepVar Names to check order\r\rDim SE As Single = 0\r\r\rBROADshift(R) = ICTBROAD(R) - BroadVal\r"
  },
  {
    "Variable": "ICTBROAD",
    "UsesVariable": "ictbroadseyrtar",
    "Distance": 1,
    "Code": "\r\rBROADshift(R) = ICTBROAD(R) - BroadVal\r"
  },
  {
    "Variable": "ICTBROAD",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ICTBROADCOST",
    "UsesVariable": "ictbroadcostm",
    "Distance": 0,
    "Code": "\r'note to MTI: unlike other infrastructure there is no hard parameter to check against here\r\r'            'mti 2014/05/28 - start\r'            'Save pre-finance value:\r'            SBroad(R, 3) = ICTBROAD(R)\r'            'mti 2014/05/28 - end\r\r'Finance\rCalcInfraUnitCost(R%, 10, 5, ictbroadcostupper, ictbroadcostlower, sGDPPCP(R%), ICTBROADCOST(R%)) ', False\r\r'mti April 2011 -start\rICTBROADCOST(R%) = ICTBROADCOST(R%) * ictbroadcostm(R%)\r"
  },
  {
    "Variable": "ICTBROADMOBIL",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ICTBROADMOBIL",
    "UsesVariable": "ICTMOBIL",
    "Distance": 0,
    "Code": "\r'Note MTI: unlike other infrastructure there is no hard parameter to check against here\r\rICTBROADMOBIL(R%) = Amin(ICTBROADMOBIL(R%), ICTMOBIL(R%))\r\r\r'mti 2013/09/16 - Infra Fix - start\rICTBROADMOBIL(R%) = CSng(AMAX(ICTBROADMOBIL(R%), 0.0001))\r"
  },
  {
    "Variable": "ICTBROADMOBIL",
    "UsesVariable": "ictbroadmobilm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ICTBROADMOBIL",
    "UsesVariable": "ictbroadmobiltrgtyr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ICTBROADMOBIL",
    "UsesVariable": "ictmobilsaturation",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "ICTBROADMOBIL",
    "UsesVariable": "ictbroadmobiltrgtval",
    "Distance": 1,
    "Code": "\r\r\r'Universal target\r'dkb 2013/09/16 added dimension 1 to ictbroadmobilsetar\rIf ictbroadmobiltrgtyr(R%) > 0 And ictbroadmobilsetar(R%) = 0 Then\rDim ICTBROADMOBILTrgt = Amin(ictmobilsaturation, iICTBROADMOBIL(R%) + Amin(ictbroadmobiltrgtyr(R%), IY - 1) * (ictbroadmobiltrgtval(R%) - iICTBROADMOBIL(R%)) / ictbroadmobiltrgtyr(R%))\rICTBROADMOBIL(R%) = AMAX(ICTBROADMOBIL(R%), ICTBROADMOBILTrgt)\r\r'adjust n=mobile to be consistent with mobile BB\rIf ICTMOBIL(R%) < ICTBROADMOBIL(R%) Then\rICTMOBIL(R%) = ICTBROADMOBIL(R%)\rSMobil(R, 2) = ICTMOBIL(R)\rDim ICTMobilDemThousands = ICTMOBIL(R%) * CDbl(POP(R%)) * 10 'Demanded Connections (stock) in Thousands This Year\rDim sICTMobilThousands = SICTMobil(R%) * CDbl(sPOPTotal(R%)) * 10 'Connections (Stock) in Thousands Last Year\r\rCalcInfraInvest(CDbl(ICTMobilDemThousands), CDbl(sICTMobilThousands),\r                                            Deppcnt(Mobile), ICTMOBILCOST(R%), INFRAINVESTNEW(R%, Mobile), INFRAINVESTMAINT(R%, Mobile))\r\r\rEnd If\r\rEnd If\r"
  },
  {
    "Variable": "ICTBROADMOBIL",
    "UsesVariable": "ictbroadmobilteclowrt",
    "Distance": 9,
    "Code": "\r'mti 2013/09/16 - Infra Fix - end\r\r'Growth from cross-sectional function---------\r'-----------------------------------------------------\r'jrs 2010/12/06 *** begin: Using Annual Growth Rate ***\r'******************************************************\r'Scaling CS change depending Data/Function rate\rIf rVal > SBroadMobil(R, 2) Then\rincCS = (ICTBROADMOBIL(R) - SBroadMobil(R, 1)) * SBroadMobil(R, 2) / Math.Abs(rVal)\rElse\rincCS = ICTBROADMOBIL(R) - SBroadMobil(R, 1)\rEnd If\r\r\r\r' Tech Shift Growth\r'-----------------------------------------------------\r\rIf SBroadMobil(R, 2) < ictbroadmobiltecinflection Then\rincTec = (ictbroadmobiltechighrt(R%) - ictbroadmobilteclowrt) * SBroadMobil(R, 2) / ictbroadmobiltecinflection + ictbroadmobilteclowrt\rElse\r'jrs 2010/12/06 incTec = (ictmobilteclowrt - ictmobiltechighrt) * (SMobil(R, 2) - ictmobiltecinflection) / (120 - ictmobiltecinflection) + ictmobiltechighrt\r\r'mti June 08, 2011 - start\r'incTec = (ictbroadmobilteclowrt - ictbroadmobiltechighrt) * (SBroadMobil(R, 2) - ictbroadmobiltecinflection) / (ictbroadmobilsaturation - ictbroadmobiltecinflection) + ictbroadmobiltechighrt\rincTec = (ictbroadmobilteclowrt - ictbroadmobiltechighrt(R%)) * (SBroadMobil(R, 2) - ictbroadmobiltecinflection) / (ictmobilsaturation + 10 - ictbroadmobiltecinflection) + ictbroadmobiltechighrt(R%)\r'mti June 08, 2011 - end\rEnd If\r\r\r'jrs 2010/12/06\rIf Not (ICTBroadMobilGR(R).HasValue) Then\rincTot = incTec + incCS\rElse\rIf IY > 2 Then\r'mti June 08, 2011 - start\r'                    HistWg = 0.5\r'                    'incTot = HistWg * ICTMobilGR(R) * SMobil(R, 2) + (1 - HistWg) * (incTec + incCS)\r'                    'Instead of using the compoundig Growth Rate, use just the flat differece between the 2 last years\r'                    'F(y-1) - F(y-2) = F(y-1) * (1 - 1/(1+GR))\r'                    'incTot = HistWg * SMobil(R, 2) * (1 - 1 / (1 + ICTMobilGR(R))) + (1 - HistWg) * (incTec + incCS)\r'\r'                    incTot = ConvergeOverTime(SBroadMobil(R, 2) * (1 - 1 / (1 + ICTBroadMobilGR(R))), incTec + incCS, 10)\r'new formulation (growth rate convergence, slower)\rgratem = (incTec + incCS) / AMAX(0.01, SBroadMobil(R, 2)) 'growth rate from model\rgratec = ConvergeOverTime(CSng(ICTBroadMobilGR(R)), gratem, 25) 'growth rate from previous year converge to that from model\rincTot = gratec * SBroadMobil(R, 2)\r'this branch needed for year 2 when pre-processor calculates % point or absolute growth; for years >2 ICTBroadMobilGR(R) converts to growth rate (see below)\rElse\r'                    'revert to growth rate as opposed to increment\r'                    incTot = ICTBroadMobilGR(R) * SBroadMobil(R, 2)\rgratem = incTec + incCS\rgratec = ConvergeOverTime(CSng(ICTBroadMobilGR(R)), gratem, 5)\rincTot = gratec\r'\rEnd If\rEnd If\r\rICTBroadMobilGR(R) = 0\r\r\r'jrs 2010/12/06\rIf Not (ICTBroadMobilGR(R).HasValue) Then\rincTot = incTec + incCS\rElse\rIf IY > 2 Then\r'mti June 08, 2011 - start\r'                    HistWg = 0.5\r'                    'incTot = HistWg * ICTMobilGR(R) * SMobil(R, 2) + (1 - HistWg) * (incTec + incCS)\r'                    'Instead of using the compoundig Growth Rate, use just the flat differece between the 2 last years\r'                    'F(y-1) - F(y-2) = F(y-1) * (1 - 1/(1+GR))\r'                    'incTot = HistWg * SMobil(R, 2) * (1 - 1 / (1 + ICTMobilGR(R))) + (1 - HistWg) * (incTec + incCS)\r'\r'                    incTot = ConvergeOverTime(SBroadMobil(R, 2) * (1 - 1 / (1 + ICTBroadMobilGR(R))), incTec + incCS, 10)\r'new formulation (growth rate convergence, slower)\rgratem = (incTec + incCS) / AMAX(0.01, SBroadMobil(R, 2)) 'growth rate from model\rgratec = ConvergeOverTime(CSng(ICTBroadMobilGR(R)), gratem, 25) 'growth rate from previous year converge to that from model\rincTot = gratec * SBroadMobil(R, 2)\r'this branch needed for year 2 when pre-processor calculates % point or absolute growth; for years >2 ICTBroadMobilGR(R) converts to growth rate (see below)\rElse\r'                    'revert to growth rate as opposed to increment\r'                    incTot = ICTBroadMobilGR(R) * SBroadMobil(R, 2)\rgratem = incTec + incCS\rgratec = ConvergeOverTime(CSng(ICTBroadMobilGR(R)), gratem, 5)\rincTot = gratec\r'\rEnd If\rEnd If\r"
  },
  {
    "Variable": "ICTBROADMOBIL",
    "UsesVariable": "ictbroadmobiltechighrt",
    "Distance": 9,
    "Code": "\r'mti 2013/09/16 - Infra Fix - end\r\r'Growth from cross-sectional function---------\r'-----------------------------------------------------\r'jrs 2010/12/06 *** begin: Using Annual Growth Rate ***\r'******************************************************\r'Scaling CS change depending Data/Function rate\rIf rVal > SBroadMobil(R, 2) Then\rincCS = (ICTBROADMOBIL(R) - SBroadMobil(R, 1)) * SBroadMobil(R, 2) / Math.Abs(rVal)\rElse\rincCS = ICTBROADMOBIL(R) - SBroadMobil(R, 1)\rEnd If\r"
  },
  {
    "Variable": "ICTBROADMOBIL",
    "UsesVariable": "ictbroadmobiltecinflection",
    "Distance": 9,
    "Code": "\r\rSBroadMobil(R, 2) = ICTBROADMOBIL(R)\r"
  },
  {
    "Variable": "ICTBROADMOBIL",
    "UsesVariable": "GDPPCP",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "ICTBROADMOBIL",
    "UsesVariable": "GOVREGQUAL",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "ICTBROADMOBIL",
    "UsesVariable": "ictbroadmobilsetar",
    "Distance": 1,
    "Code": "\rBroadMOBILshift(R) = ICTBROADMOBIL(R) - BroadMobilVal\r\r\r'Convergence of Cross-sectional\r'-----------------------------------\r\rIf BroadMOBILshift(R) > 0 Then\rBroadMobilAdd = BroadMOBILshift(R%)\rElse\rBroadMobilAdd = ConvergeOverTime(BroadMOBILshift(R%), 0, 100)\rEnd If\rCOMPLETE STRUCTURE:Next R%:16064|\r'BroadMobilAdd\rFor R% = 1 To NR%\r\r'   All but First Call 1:  Access to Mobile Broadband\r' --------------------------------------------------\r\rCall AnalFuncSE(\"ICT Broadband Mobile Access % of Population Rev 2010\",\r                                New Single() {GDPPCP(R%), SGOVREGQUAL(R%)}, rVal, SE,\r                               New String() {\"GDP2005PCPPP(MOSTRECENT)/ 1000 (Log)\", \"GovernanceRegQual(MOSTRECENT)+ 2.5 (Linear)\"}, context) 'jrs 2014/10/09 added DepVar Names to check order\r\rDim SE As Single = 0\r\rBroadMOBILshift(R) = ICTBROADMOBIL(R) - BroadMobilVal\r"
  },
  {
    "Variable": "ICTBROADMOBIL",
    "UsesVariable": "ictbroadmobilseyrtar",
    "Distance": 1,
    "Code": "\rBroadMOBILshift(R) = ICTBROADMOBIL(R) - BroadMobilVal\r"
  },
  {
    "Variable": "ICTBROADMOBILCOST",
    "UsesVariable": "ictbroadmobilcostm",
    "Distance": 0,
    "Code": "\r'mti 2013/09/16 - Infra Fix - end\r\r'   All but First Call 1:  Mobile Broadband Finance\r' --------------------------------------------------\r\r\rCalcInfraUnitCost(R%, 10, 5, ictbroadmobilcostupper, ictbroadmobilcostlower, sGDPPCP(R%), ICTBROADMOBILCOST(R%))\rICTBROADMOBILCOST(R%) = ICTBROADMOBILCOST(R%) * ictbroadmobilcostm(R%)\r"
  },
  {
    "Variable": "ICTCOMPUTERS",
    "UsesVariable": "ictcomputersm",
    "Distance": 0,
    "Code": "\r\rSComputers(R, 1) = ICTCOMPUTERS(R)\r\r'mti 2015/06/01 - start\r'ICTCOMPUTERS(R) = Amin(AMAX(ICTCOMPUTERS(R), SComputers(R, 2)), 100)\rICTCOMPUTERS(R) = Amin(AMAX(ICTCOMPUTERS(R), SComputers(R, 2)) * ictcomputersm(R%), 100)\r"
  },
  {
    "Variable": "ICTCOMPUTERS",
    "UsesVariable": "ictcomputersteclowrt",
    "Distance": 2,
    "Code": "\r\r'------ Tech Shift\rDim incCS = ICTCOMPUTERS(R) - SComputers(R, 1)\r\rDim incTec As Single\rIf SComputers(R, 2) < ictcomputerstecinflection Then\rincTec = (ictcomputerstechighrt - ictcomputersteclowrt) * SComputers(R, 2) / ictcomputerstecinflection + ictcomputersteclowrt\rElse\rincTec = (ictcomputersteclowrt - ictcomputerstechighrt) * (SComputers(R, 2) - ictcomputerstecinflection) / (100 - ictcomputerstecinflection) + ictcomputerstechighrt\rEnd If\r\r\rSComputers(R, 1) = ICTCOMPUTERS(R)\r\r\r'Add Increase/Decrease to final value, this is the tec factor\r'Total increment can't be more than 25% of the remaining gap to reach target of 120\rICTCOMPUTERS(R) = SComputers(R, 2) + Amin(incTec + incCS, (100 - SComputers(R, 2)) / 4)\r"
  },
  {
    "Variable": "ICTCOMPUTERS",
    "UsesVariable": "ictcomputerstechighrt",
    "Distance": 2,
    "Code": "\r\r'------ Tech Shift\rDim incCS = ICTCOMPUTERS(R) - SComputers(R, 1)\r"
  },
  {
    "Variable": "ICTCOMPUTERS",
    "UsesVariable": "ictcomputerstecinflection",
    "Distance": 2,
    "Code": "\rSComputers(R, 2) = ICTCOMPUTERS(R)\r"
  },
  {
    "Variable": "ICTCOMPUTERS",
    "UsesVariable": "GDPPCP",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "ICTCONSURPLUS",
    "UsesVariable": "ICTINDEX",
    "Distance": 0,
    "Code": "\rICTCONSURPLUS(R%) = ICTCONSURPLUS(R%) * (1 + (ICTINDEX(R%) - ICTINDEXExp) / 10)\r"
  },
  {
    "Variable": "ICTCONSURPLUS",
    "UsesVariable": "GDPPCP",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "ICTCONSURPLUS",
    "UsesVariable": "ictconsurplusm",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:Next R%:5487|\rLogRegRun(GDPPCP, ICTIndexB4Mul, Intrcpt, BCoeFF)\r'LogRegRun GDPPCP(), ICTINDEX(), Intrcpt, BCoeFF\r'bbh 2015/06/06 end\r\r'mti 2015/05/13 -end\r\rFor R% = 1 To NR%\r\rIf IY = 1 Then sgdpr1(R%) = GDPR(R%)\r\rCybConSurShr = CSng(0.1 - 0.05 * Amin(1, (GDPPCP(R%) / 40)))\r\rICTCONSURPLUS(R%) = CybConSurShr * sgdpr1(R%) * ictconsurplusm(R%)\r"
  },
  {
    "Variable": "ICTCONSURPLUS",
    "UsesVariable": "GDPR",
    "Distance": 7,
    "Code": "COMPLETE STRUCTURE:Next R%:5487|\rLogRegRun(GDPPCP, ICTIndexB4Mul, Intrcpt, BCoeFF)\r'LogRegRun GDPPCP(), ICTINDEX(), Intrcpt, BCoeFF\r'bbh 2015/06/06 end\r\r'mti 2015/05/13 -end\r\rFor R% = 1 To NR%\r\rIf IY = 1 Then sgdpr1(R%) = GDPR(R%)\r"
  },
  {
    "Variable": "ICTCYBBENEFIT",
    "UsesVariable": "ICTINDEX",
    "Distance": 0,
    "Code": "\rICTCYBBENEFIT(R%) = ICTCYBBENEFIT(R%) * (1 + (ICTINDEX(R%) - ICTINDEXExp) / 10)\r"
  },
  {
    "Variable": "ICTCYBBENEFIT",
    "UsesVariable": "GDPPCP",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "ICTCYBBENEFIT",
    "UsesVariable": "ictcybbenefitm",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:Next R%:5487|\rLogRegRun(GDPPCP, ICTIndexB4Mul, Intrcpt, BCoeFF)\r'LogRegRun GDPPCP(), ICTINDEX(), Intrcpt, BCoeFF\r'bbh 2015/06/06 end\r\r'mti 2015/05/13 -end\r\rFor R% = 1 To NR%\r\rIf IY = 1 Then sgdpr1(R%) = GDPR(R%)\r\r\r' BBH tried hard to match ICTCYBENEFIT and ICTCONSURPLUS to historical data with ICTINDEX breakpoint code\r'   Focused on avoiding transients for WB income categories and world\r'   Problems included skimpy historical data esp lower income countries and some jumps across ICTIndex\r'      categories that messed up ictindexm scenarios - index rise could push into new category and create\r'      perverse effects such as higher index lowered GDPGR contribution for lower middle income countries\r'   So shifted to more generic formulations immediately below; historical fit is not quite as good\r'      But fit is messy and often simple average very differnet than GDP-weighted ones\rCybGrBenShr = CSng(0.3 - 0.15 * Amin(1, (GDPPCP(R%) / 40)))\r\rICTCYBBENEFIT(R%) = CybGrBenShr * sgdpr1(R%) * ictcybbenefitm(R%)\r"
  },
  {
    "Variable": "ICTCYBBENEFIT",
    "UsesVariable": "GDPR",
    "Distance": 5,
    "Code": "COMPLETE STRUCTURE:Next R%:5487|\rLogRegRun(GDPPCP, ICTIndexB4Mul, Intrcpt, BCoeFF)\r'LogRegRun GDPPCP(), ICTINDEX(), Intrcpt, BCoeFF\r'bbh 2015/06/06 end\r\r'mti 2015/05/13 -end\r\rFor R% = 1 To NR%\r\rIf IY = 1 Then sgdpr1(R%) = GDPR(R%)\r"
  },
  {
    "Variable": "ICTCYBBENEFITCUMNET",
    "UsesVariable": "ICTCYBBENTOTCUM",
    "Distance": 0,
    "Code": "\rICTCYBBENEFITCUMNET(R%) = ICTCYBBENTOTCUM(R%) - ICTCYBRISKTOTCUM(R%)\r"
  },
  {
    "Variable": "ICTCYBBENEFITCUMNET",
    "UsesVariable": "ICTCYBRISKTOTCUM",
    "Distance": 0,
    "Code": "\rICTCYBBENEFITCUMNET(R%) = ICTCYBBENTOTCUM(R%) - ICTCYBRISKTOTCUM(R%)\r"
  },
  {
    "Variable": "ICTCYBBENEFITNET",
    "UsesVariable": "ICTCYBBENTOT",
    "Distance": 0,
    "Code": "\r\r'mti 2015/05/13 - end\r\r'mti 2015/06/01 - start\rICTCYBBENEFITNET(R%) = ICTCYBBENTOT(R%) - ICTCYBRISKTOT(R%)\r"
  },
  {
    "Variable": "ICTCYBBENEFITNET",
    "UsesVariable": "ICTCYBRISKTOT",
    "Distance": 0,
    "Code": "\r\r'mti 2015/05/13 - end\r\r'mti 2015/06/01 - start\rICTCYBBENEFITNET(R%) = ICTCYBBENTOT(R%) - ICTCYBRISKTOT(R%)\r"
  },
  {
    "Variable": "ICTCYBBENTOT",
    "UsesVariable": "ICTCYBBENEFIT",
    "Distance": 0,
    "Code": "\r'bbh 2015/06/07 emd\r\rICTCYBBENTOT(R%) = ICTCYBBENEFIT(R%) + ICTCONSURPLUS(R%)\r"
  },
  {
    "Variable": "ICTCYBBENTOT",
    "UsesVariable": "ICTCONSURPLUS",
    "Distance": 0,
    "Code": "\r'bbh 2015/06/07 emd\r\rICTCYBBENTOT(R%) = ICTCYBBENEFIT(R%) + ICTCONSURPLUS(R%)\r"
  },
  {
    "Variable": "ICTCYBBENTOTCUM",
    "UsesVariable": "ICTCYBBENEFIT",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "ICTCYBBENTOTCUM",
    "UsesVariable": "ICTCONSURPLUS",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "ICTCYBBENTOTCUM",
    "UsesVariable": "GDP",
    "Distance": 5,
    "Code": "\r\r'mti 2015/05/13 - start\r\r'bbh 2015/05/17 begin\r'ICTCYBBENTOTCUM(R%) = sICTCYBBENTOTCUM(R%) + (((1 + ICTCYBBENTOT(R%) / 100) ^ IY - 1) _\r'+ ((1 + ICTCONSURPLUS(R%) / 100) ^ IY - 1)) * GDP(R%)\rIf IY = 1 Then\rsICTCYBBENTOTCUM(R%) = 0\rGDPICyb(R%) = GDP(R%)\rICTGrowthCumCompound(R%) = 1 + ICTCYBBENEFIT(R%) / 100\rICTSurplusCumCompound(R%) = 1 + ICTCONSURPLUS(R%) / 100\rElse\rICTGrowthCumCompound(R%) = ICTGrowthCumCompound(R%) * (1 + ICTCYBBENEFIT(R%) / 100)\rICTSurplusCumCompound(R%) = ICTSurplusCumCompound(R%) * (1 + ICTCONSURPLUS(R%) / 100)\rEnd If\r"
  },
  {
    "Variable": "ICTCYBEVTCOST",
    "UsesVariable": "ICTINDEX",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "ICTCYBEVTCOST",
    "UsesVariable": "ICTCYBSECURITY",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "ICTCYBEVTCOST",
    "UsesVariable": "ictcybevtcostm",
    "Distance": 0,
    "Code": "\r\r'mti 2015/06/09 - start\rFor evt% = 1 To 4  'event type: Hactivism, Cybcrime, Cybespion, Cybterror\rFor cst% = 1 To 3 'attacker/defender\rICTCYBEVTCOST(R%) = ICTCYBEVTCOST(R%) + ictcybevprob(evt, cst) * ictcybevcost(evt, cst)\rNext cst%\rICTCYBEVTCOST(R%) = ICTCYBEVTCOST(R%) * ictcybevtcostm(R%, evt%)\rNext evt%\r"
  },
  {
    "Variable": "ICTCYBEVTCOST",
    "UsesVariable": "ictcybevprob",
    "Distance": 0,
    "Code": "\r\r'mti 2015/06/09 - start\rFor evt% = 1 To 4  'event type: Hactivism, Cybcrime, Cybespion, Cybterror\rFor cst% = 1 To 3 'attacker/defender\rICTCYBEVTCOST(R%) = ICTCYBEVTCOST(R%) + ictcybevprob(evt, cst) * ictcybevcost(evt, cst)\rNext cst%\rICTCYBEVTCOST(R%) = ICTCYBEVTCOST(R%) * ictcybevtcostm(R%, evt%)\rNext evt%\r"
  },
  {
    "Variable": "ICTCYBEVTCOST",
    "UsesVariable": "ictcybevcost",
    "Distance": 0,
    "Code": "\r\r'mti 2015/06/09 - start\rFor evt% = 1 To 4  'event type: Hactivism, Cybcrime, Cybespion, Cybterror\rFor cst% = 1 To 3 'attacker/defender\rICTCYBEVTCOST(R%) = ICTCYBEVTCOST(R%) + ictcybevprob(evt, cst) * ictcybevcost(evt, cst)\rNext cst%\rICTCYBEVTCOST(R%) = ICTCYBEVTCOST(R%) * ictcybevtcostm(R%, evt%)\rNext evt%\r"
  },
  {
    "Variable": "ICTCYBOPCOST",
    "UsesVariable": "ictcybopcostadd",
    "Distance": 0,
    "Code": "\rICTCYBOPCOST(R%) = ICTCYBOPCOST(R%) + ictcybopcostadd(R%)\r"
  },
  {
    "Variable": "ICTCYBOPCOST",
    "UsesVariable": "ICTCONSURPLUS",
    "Distance": 0,
    "Code": "\r\r'ICTCONSURPLUS(R%) = 0.07 * sgdpr1(R%) * ictconsurplusm(R%)\r\r'         If ICTINDEX(R%) < 1 Then 'low-income countries ictindex average=1.4 ; set at .3 * moving average GDPR\r'            ICTCONSURPLUS(R%) = 0.1 * sgdpr1(R%) * ictconsurplusm(R%)\r'\r'         ElseIf ICTINDEX(R%) < 2.5 Then 'lower-middle-income average 2.3 ; leave at .1)\r'            ICTCONSURPLUS(R%) = (0.1 + 0# * (ICTINDEX(R%) - 1)) * sgdpr1(R%) * ictconsurplusm(R%)\r'\r'         ElseIf ICTINDEX(R%) < 4 Then 'upper middle income average 3.7l; leave at .1)\r'            ICTCONSURPLUS(R%) = (0.1 - 0# * (ICTINDEX(R%) - 2.5)) * sgdpr1(R%) * ictconsurplusm(R%)\r'\r'         ElseIf ICTINDEX(R%) < 7 Then 'high income is 6.7; take to .04;( 0.1- .02* 3)\r'            ICTCONSURPLUS(R%) = (0.1 - 0.02 * (ICTINDEX(R%) - 4)) * sgdpr1(R%) * ictconsurplusm(R%)\r'\r'         Else\r'           ICTCONSURPLUS(R%) = 0.04 * sgdpr1(R%) * ictconsurplusm(R%)\r'         End If\r'\r''If RegName(R%) = \"China\" Then Stop\r'\r'        ' ICTCONSURPLUS(R%) = ICTCONSURPLUS(R%) * Amin(2, AMAX(0.5, ICTINDEX(R%) / ICTINDEXExp))\r'         ICTCONSURPLUS(R%) = ICTCONSURPLUS(R%) * (1 + (ICTINDEX(R%) - ICTINDEXExp) / 10)\r\rIf ICTINDEX(R%) < ICTINDEXExp Then\r'ICTCYBOPCOST(R%) = ICTCYBOPCOST(R%) + ICTCONSURPLUS(R%) * AMAX(0.5, (1 - ICTINDEX(R%) / ICTINDEXExp))\rICTCYBOPCOST(R%) = ICTCYBOPCOST(R%) + ICTCONSURPLUS(R%) * (ICTINDEXExp - ICTINDEX(R%)) / 10\rEnd If\r"
  },
  {
    "Variable": "ICTCYBOPCOST",
    "UsesVariable": "ICTINDEX",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ICTCYBOPCOST",
    "UsesVariable": "GDPPCP",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "ICTCYBOPCOST",
    "UsesVariable": "ICTCYBBENEFIT",
    "Distance": 0,
    "Code": "\rElse\r'ICTCYBOPCOST(R%) = ICTCYBBENEFIT(R%) * AMAX(0.5, (1 - ICTINDEX(R%) / ICTINDEXExp))\rICTCYBOPCOST(R%) = ICTCYBBENEFIT(R%) * (ICTINDEXExp - ICTINDEX(R%)) / 10\rEnd If\r"
  },
  {
    "Variable": "ICTCYBRISKTOT",
    "UsesVariable": "ICTCYBSECSPEND",
    "Distance": 0,
    "Code": "\r\r'mti 2015/06/09 - end\r\r\rICTCYBRISKTOT(R%) = ICTCYBSECSPEND(R%) + ICTCYBEVTCOST(R%) + ICTCYBOPCOST(R%)\r"
  },
  {
    "Variable": "ICTCYBRISKTOT",
    "UsesVariable": "ICTCYBEVTCOST",
    "Distance": 0,
    "Code": "\r\r'mti 2015/06/09 - end\r\r\rICTCYBRISKTOT(R%) = ICTCYBSECSPEND(R%) + ICTCYBEVTCOST(R%) + ICTCYBOPCOST(R%)\r"
  },
  {
    "Variable": "ICTCYBRISKTOT",
    "UsesVariable": "ICTCYBOPCOST",
    "Distance": 0,
    "Code": "\r\r'mti 2015/06/09 - end\r\r\rICTCYBRISKTOT(R%) = ICTCYBSECSPEND(R%) + ICTCYBEVTCOST(R%) + ICTCYBOPCOST(R%)\r"
  },
  {
    "Variable": "ICTCYBRISKTOTCUM",
    "UsesVariable": "ICTCYBRISKTOT",
    "Distance": 0,
    "Code": "\r'bbh 2015/05/17 end\r\rICTCYBRISKTOTCUM(R%) = sICTCYBRISKTOTCUM(R%) + ICTCYBRISKTOT(R%) * GDP(R%) / 100\r"
  },
  {
    "Variable": "ICTCYBRISKTOTCUM",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "\r'bbh 2015/05/17 end\r\rICTCYBRISKTOTCUM(R%) = sICTCYBRISKTOTCUM(R%) + ICTCYBRISKTOT(R%) * GDP(R%) / 100\r"
  },
  {
    "Variable": "ICTCYBSECSPEND",
    "UsesVariable": "ictcybsecspendm",
    "Distance": 0,
    "Code": "\r\r'--------- Cyber Cost --------------\r'mti 2015/04/29 - start - need to check call seq here\r'ICTCYBSECSPEND(R%) = Amin(0.1, AMAX(0.001, (INFRAINDICT(R%) / 83.33) * GDPPCP(R%) / 500)) '83.33 is the max of InfraindICT\r\r'ICTCyberSecSpendExp = Amin(0.4, (Log(Amin(10, ICTINDEX(R%))) / 3.65) * (Log(Amin(80, GDPPCP(R%))) / 6.95))\r'avoiding negatives\rICTCyberSecSpendExp = CSng(Amin(0.4, (Log(AMAX(1.01, Amin(10, ICTINDEX(R%)))) / 3.65) * (Log(Amin(80000, GDPPCP(R%) * 1000)) / 17.805)))\r\r'  Debug.Print IY; RegName(R%)\rICTCYBSECSPEND(R%) = ICTCyberSecSpendExp * ictcybsecspendm(R%)\r"
  },
  {
    "Variable": "ICTCYBSECSPEND",
    "UsesVariable": "ICTINDEX",
    "Distance": 1,
    "Code": "\r\r'--------- Cyber Cost --------------\r'mti 2015/04/29 - start - need to check call seq here\r'ICTCYBSECSPEND(R%) = Amin(0.1, AMAX(0.001, (INFRAINDICT(R%) / 83.33) * GDPPCP(R%) / 500)) '83.33 is the max of InfraindICT\r\r'ICTCyberSecSpendExp = Amin(0.4, (Log(Amin(10, ICTINDEX(R%))) / 3.65) * (Log(Amin(80, GDPPCP(R%))) / 6.95))\r'avoiding negatives\rICTCyberSecSpendExp = CSng(Amin(0.4, (Log(AMAX(1.01, Amin(10, ICTINDEX(R%)))) / 3.65) * (Log(Amin(80000, GDPPCP(R%) * 1000)) / 17.805)))\r"
  },
  {
    "Variable": "ICTCYBSECSPEND",
    "UsesVariable": "GDPPCP",
    "Distance": 1,
    "Code": "\r\r'--------- Cyber Cost --------------\r'mti 2015/04/29 - start - need to check call seq here\r'ICTCYBSECSPEND(R%) = Amin(0.1, AMAX(0.001, (INFRAINDICT(R%) / 83.33) * GDPPCP(R%) / 500)) '83.33 is the max of InfraindICT\r\r'ICTCyberSecSpendExp = Amin(0.4, (Log(Amin(10, ICTINDEX(R%))) / 3.65) * (Log(Amin(80, GDPPCP(R%))) / 6.95))\r'avoiding negatives\rICTCyberSecSpendExp = CSng(Amin(0.4, (Log(AMAX(1.01, Amin(10, ICTINDEX(R%)))) / 3.65) * (Log(Amin(80000, GDPPCP(R%) * 1000)) / 17.805)))\r"
  },
  {
    "Variable": "ICTCYBSECURITY",
    "UsesVariable": "ICTCYBSECSPEND",
    "Distance": 0,
    "Code": "\rCall XYTABL(TbName$, ICTINDEX(R%), ICTIndexContrib, context)\r\r\r'    If RegName(R%) = \"Somalia\" Then Stop 'And IY > 20\r'    If RegName(R%) = \"United States of America\" Then Stop\r\rICTCYBSECURITY(R%) = CSng(ICTIndexContrib * ((ICTCYBSECSPEND(R%) / ICTCyberSecSpendExp) ^ 0.2) * ictcybsecuritym(R%))\r"
  },
  {
    "Variable": "ICTCYBSECURITY",
    "UsesVariable": "ictcybsecuritym",
    "Distance": 0,
    "Code": "\r\r'--------- Cyber Cost --------------\r'mti 2015/04/29 - start - need to check call seq here\r'ICTCYBSECSPEND(R%) = Amin(0.1, AMAX(0.001, (INFRAINDICT(R%) / 83.33) * GDPPCP(R%) / 500)) '83.33 is the max of InfraindICT\r\r'ICTCyberSecSpendExp = Amin(0.4, (Log(Amin(10, ICTINDEX(R%))) / 3.65) * (Log(Amin(80, GDPPCP(R%))) / 6.95))\r'avoiding negatives\rICTCyberSecSpendExp = CSng(Amin(0.4, (Log(AMAX(1.01, Amin(10, ICTINDEX(R%)))) / 3.65) * (Log(Amin(80000, GDPPCP(R%) * 1000)) / 17.805)))\r"
  },
  {
    "Variable": "ICTCYBSECURITY",
    "UsesVariable": "ICTINDEX",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "ICTCYBSECURITY",
    "UsesVariable": "GDPPCP",
    "Distance": 5,
    "Code": "\r\r'--------- Cyber Cost --------------\r'mti 2015/04/29 - start - need to check call seq here\r'ICTCYBSECSPEND(R%) = Amin(0.1, AMAX(0.001, (INFRAINDICT(R%) / 83.33) * GDPPCP(R%) / 500)) '83.33 is the max of InfraindICT\r\r'ICTCyberSecSpendExp = Amin(0.4, (Log(Amin(10, ICTINDEX(R%))) / 3.65) * (Log(Amin(80, GDPPCP(R%))) / 6.95))\r'avoiding negatives\rICTCyberSecSpendExp = CSng(Amin(0.4, (Log(AMAX(1.01, Amin(10, ICTINDEX(R%)))) / 3.65) * (Log(Amin(80000, GDPPCP(R%) * 1000)) / 17.805)))\r"
  },
  {
    "Variable": "ICTINDEX",
    "UsesVariable": "ictindexm",
    "Distance": 0,
    "Code": "\r'mti 2015/06/01 - end\r\r'If RegName(R%) = \"Armenia\" Then Stop\r''If RegName(R%) = \"Iraq\" Then Stop\r'If RegName(R%) = \"France\" Then Stop\rIf IY = 1 Then\rICTIndexShift(R%) = ICTINDEX(R%) - calcICTIndex\rElse\rIf ICTIndexShift(R) < 0 Then 'upward convergence only\rICTINDEX(R%) = calcICTIndex + ConvergeOverTime(ICTIndexShift(R%), 0, 50) '50\rElse\r'mti 2015/05/06 - start\rICTINDEX(R%) = calcICTIndex + ConvergeOverTime(ICTIndexShift(R%), 0, 70) '300 '200\r'mti 2015/05/06 - end\rEnd If\r'mti 2015/06/01 - start\rICTINDEX(R%) = ICTINDEX(R%) * ictindexm(R%)\r'mti 2015/06/01 - end\rEnd If\r\r'If IY = 1 Then Debug.Print RegName(R%); \",\"; TICTTot; \",\"; TICTAcc; \",\"; TICTUse; \",\"; TICTSkill\r'mti 2015/04/29 - end\r\r\r"
  },
  {
    "Variable": "ICTINDEX",
    "UsesVariable": "ICTMOBIL",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "ICTINDEX",
    "UsesVariable": "ICTCOMPUTERS",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "ICTINDEX",
    "UsesVariable": "ICTINTNETHH",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "ICTINDEX",
    "UsesVariable": "ICTBROAD",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "ICTINDEX",
    "UsesVariable": "ICTBROADMOBIL",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "ICTINDEX",
    "UsesVariable": "LIT",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "ICTINDEX",
    "UsesVariable": "EDSECENRG",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "ICTINDEX",
    "UsesVariable": "EDTERENRG",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "ICTINTNETHH",
    "UsesVariable": "ictintnethhm",
    "Distance": 0,
    "Code": "\r\r'mti 2015/06/01 - start\r'ICTINTNETHH(R) = Amin(AMAX(ICTINTNETHH(R), SICTIntNetHH(R, 2)), 100)\rICTINTNETHH(R) = Amin(AMAX(ICTINTNETHH(R), SICTIntNetHH(R, 2)) * ictintnethhm(R), 100)\r"
  },
  {
    "Variable": "ICTINTNETHH",
    "UsesVariable": "ictcomputersteclowrt",
    "Distance": 2,
    "Code": "\r\r'------ Tech Shift (temporarily) using same inflection rate etc as Computers\rincCS = ICTINTNETHH(R) - SICTIntNetHH(R, 1)\r\rIf SICTIntNetHH(R, 2) < ictcomputerstecinflection Then\rincTec = (ictcomputerstechighrt - ictcomputersteclowrt) * SICTIntNetHH(R, 2) / ictcomputerstecinflection + ictcomputersteclowrt\rElse\rincTec = (ictcomputersteclowrt - ictcomputerstechighrt) * (SICTIntNetHH(R, 2) - ictcomputerstecinflection) / (100 - ictcomputerstecinflection) + ictcomputerstechighrt\rEnd If\r\r\r'Add Increase/Decrease to final value, this is the tec factor\r'Total increment can't be more than 25% of the remaining gap to reach target of 120\rICTINTNETHH(R) = SICTIntNetHH(R, 2) + Amin(incTec + incCS, (100 - SICTIntNetHH(R, 2)) / 4)\r"
  },
  {
    "Variable": "ICTINTNETHH",
    "UsesVariable": "ictcomputerstechighrt",
    "Distance": 2,
    "Code": "\r\r'------ Tech Shift (temporarily) using same inflection rate etc as Computers\rincCS = ICTINTNETHH(R) - SICTIntNetHH(R, 1)\r"
  },
  {
    "Variable": "ICTINTNETHH",
    "UsesVariable": "ictcomputerstecinflection",
    "Distance": 2,
    "Code": "\r\r'------ Tech Shift (temporarily) using same inflection rate etc as Computers\rincCS = ICTINTNETHH(R) - SICTIntNetHH(R, 1)\r"
  },
  {
    "Variable": "ICTINTNETHH",
    "UsesVariable": "GDPPCP",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "ICTMOBIL",
    "UsesVariable": "ictmobilsaturation",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ICTMOBIL",
    "UsesVariable": "ictmobilteclowrt",
    "Distance": 6,
    "Code": "\rSMobil(R, 1) = ICTMOBIL(R)\r\r\r\r'jrs 2009/05/06\r'Tec Factor: S-Curve shaped\r'---------------------------\r'jrs 2010/12/06 *** begin: Using Annual Growth Rate ***\r'******************************************************\r'jrs 2009/05/12\r'jrs 2010/12/06 incCS = ICTMOBIL(R) - SMobil(R, 1)\r\r'Scaling CS change depending Data/Function rate\rIf rVal > SMobil(R, 2) Then\rincCS = (ICTMOBIL(R) - SMobil(R, 1)) * SMobil(R, 2) / Math.Abs(rVal)\rElse\rincCS = ICTMOBIL(R) - SMobil(R, 1)\rEnd If\r\r\r'---- Scaling CS change depending Data/Function rate ----\r\rIf SMobil(R, 2) < ictmobiltecinflection Then\rincTec = (ictmobiltechighrt(R%) - ictmobilteclowrt) * SMobil(R, 2) / ictmobiltecinflection + ictmobilteclowrt\rElse\r'Added 10 to saturation to let it go over before coming back\rincTec = (ictmobilteclowrt - ictmobiltechighrt(R%)) * (SMobil(R, 2) - ictmobiltecinflection) / (ictmobilsaturation + 10 - ictmobiltecinflection) + ictmobiltechighrt(R%)\rEnd If\r\r\r'jrs 2010/12/06\rIf Not (ICTMobilGR(R).HasValue) Then\rincTot = incTec + incCS\rElse\r'transition between extrapolative to cross-sectional plus tech shift\r\r'old formulation (first difference convergence, faster)\r'                    HistWg = 0.5\r'                    'incTot = HistWg * ICTMobilGR(R) * SMobil(R, 2) + (1 - HistWg) * (incTec + incCS)\r'                    'Instead of using the compoundig Growth Rate, use just the flat differece between the 2 last years\r'                    'F(y-1) - F(y-2) = F(y-1) * (1 - 1/(1+GR))\r'                    'incTot = HistWg * SMobil(R, 2) * (1 - 1 / (1 + ICTMobilGR(R))) + (1 - HistWg) * (incTec + incCS)\r'                    incTot = ConvergeOverTime(SMobil(R, 2) * (1 - 1 / (1 + ICTMobilGR(R))), incTec + incCS, 10)\r\r\r'new formulation (growth rate convergence, slower)\rgratem = (incTec + incCS) / AMAX(0.01, SMobil(R, 2)) 'growth rate from model\r\r\rgratec = ConvergeOverTime(CSng(ICTMobilGR(R)), gratem, 25) 'growth rate from previous year converge to that from model\r\rincTot = gratec * SMobil(R, 2)\r\r'                    'absolute growth rate calc\r'                    'incTot = ICTMobilGR(R)\r'                    'revert to growth rate\r'                    incTot = ICTMobilGR(R) * SMobil(R, 2)\r'                    'mti July 18, 2011 - Rebase 2010 ICT - end\r'\rEnd If\r\r\rPrivate Sub ICTMobilForecast(SGOVREGQUAL() As Single, sGDPPCP() As Single,\r                                     sPOPTotal() As Single, ByRef SMobil(,) As Single,\r                                     ByRef ICTMobilGR() As Single?, ByRef ICTMobilBF() As Single,\r                                     ByRef sICTMobilBF() As Single, ByRef sMobilBF(,) As Single,\r                                     ByRef ICTMobilGRBF() As Single?, ByRef INFRAINVESTNEWBF(,) As Single,\r                                     ByRef INFRAINVESTMAINTBF(,) As Single, DeppcntMobile As Double,\r                                     SICTMobil() As Single, context As IForecastContext)\r'----------------------------------------------------------------------\r'All Years but First: Access to Mobile phones\r\r'mti 2013/12/20 start\rIf context.HistoricMode AndAlso context.FirstYearHistory < 1990 Then\rFor R% = 1 To NR%\rICTMOBIL(R) = 0\rICTMobilGR(R) = 0\r\rICTMOBILCOST(R%) = 0\rINFRAINVESTNEW(R%, Mobile) = 0\rINFRAINVESTMAINT(R%, Mobile) = 0\r\rICTMobilBF(R%) = 0\rICTMobilGRBF(R%) = 0\r\rINFRAINVESTNEWBF(R%, Mobile) = 0\rINFRAINVESTMAINTBF(R%, Mobile) = 0\rNext\rExit Sub\rEnd If\r\r\rPrivate Sub ICTMobilForecast(SGOVREGQUAL() As Single, sGDPPCP() As Single,\r                                     sPOPTotal() As Single, ByRef SMobil(,) As Single,\r                                     ByRef ICTMobilGR() As Single?, ByRef ICTMobilBF() As Single,\r                                     ByRef sICTMobilBF() As Single, ByRef sMobilBF(,) As Single,\r                                     ByRef ICTMobilGRBF() As Single?, ByRef INFRAINVESTNEWBF(,) As Single,\r                                     ByRef INFRAINVESTMAINTBF(,) As Single, DeppcntMobile As Double,\r                                     SICTMobil() As Single, context As IForecastContext)\r'----------------------------------------------------------------------\r'All Years but First: Access to Mobile phones\r\r'mti 2013/12/20 start\rIf context.HistoricMode AndAlso context.FirstYearHistory < 1990 Then\rFor R% = 1 To NR%\rICTMOBIL(R) = 0\rICTMobilGR(R) = 0\r\rICTMOBILCOST(R%) = 0\rINFRAINVESTNEW(R%, Mobile) = 0\rINFRAINVESTMAINT(R%, Mobile) = 0\r\rICTMobilBF(R%) = 0\rICTMobilGRBF(R%) = 0\r\rINFRAINVESTNEWBF(R%, Mobile) = 0\rINFRAINVESTMAINTBF(R%, Mobile) = 0\rNext\rExit Sub\rEnd If\r\rSMobil(R, 1) = ICTMOBIL(R)\r\r\r'jrs 2010/12/06\rIf Not (ICTMobilGR(R).HasValue) Then\rincTot = incTec + incCS\rElse\r'transition between extrapolative to cross-sectional plus tech shift\r\r'old formulation (first difference convergence, faster)\r'                    HistWg = 0.5\r'                    'incTot = HistWg * ICTMobilGR(R) * SMobil(R, 2) + (1 - HistWg) * (incTec + incCS)\r'                    'Instead of using the compoundig Growth Rate, use just the flat differece between the 2 last years\r'                    'F(y-1) - F(y-2) = F(y-1) * (1 - 1/(1+GR))\r'                    'incTot = HistWg * SMobil(R, 2) * (1 - 1 / (1 + ICTMobilGR(R))) + (1 - HistWg) * (incTec + incCS)\r'                    incTot = ConvergeOverTime(SMobil(R, 2) * (1 - 1 / (1 + ICTMobilGR(R))), incTec + incCS, 10)\r\r\r'new formulation (growth rate convergence, slower)\rgratem = (incTec + incCS) / AMAX(0.01, SMobil(R, 2)) 'growth rate from model\r\r\rgratec = ConvergeOverTime(CSng(ICTMobilGR(R)), gratem, 25) 'growth rate from previous year converge to that from model\r\rincTot = gratec * SMobil(R, 2)\r\r'                    'absolute growth rate calc\r'                    'incTot = ICTMobilGR(R)\r'                    'revert to growth rate\r'                    incTot = ICTMobilGR(R) * SMobil(R, 2)\r'                    'mti July 18, 2011 - Rebase 2010 ICT - end\r'\rEnd If\r"
  },
  {
    "Variable": "ICTMOBIL",
    "UsesVariable": "ictmobiltechighrt",
    "Distance": 6,
    "Code": "\rSMobil(R, 1) = ICTMOBIL(R)\r"
  },
  {
    "Variable": "ICTMOBIL",
    "UsesVariable": "ictmobiltecinflection",
    "Distance": 6,
    "Code": "\r\r\r'Universal target\r'dkb 2013/09/16 added dimension 1 to ictbroadmobilsetar\rIf ictbroadmobiltrgtyr(R%) > 0 And ictbroadmobilsetar(R%) = 0 Then\rDim ICTBROADMOBILTrgt = Amin(ictmobilsaturation, iICTBROADMOBIL(R%) + Amin(ictbroadmobiltrgtyr(R%), IY - 1) * (ictbroadmobiltrgtval(R%) - iICTBROADMOBIL(R%)) / ictbroadmobiltrgtyr(R%))\rICTBROADMOBIL(R%) = AMAX(ICTBROADMOBIL(R%), ICTBROADMOBILTrgt)\r\r'adjust n=mobile to be consistent with mobile BB\rIf ICTMOBIL(R%) < ICTBROADMOBIL(R%) Then\rICTMOBIL(R%) = ICTBROADMOBIL(R%)\rSMobil(R, 2) = ICTMOBIL(R)\rDim ICTMobilDemThousands = ICTMOBIL(R%) * CDbl(POP(R%)) * 10 'Demanded Connections (stock) in Thousands This Year\rDim sICTMobilThousands = SICTMobil(R%) * CDbl(sPOPTotal(R%)) * 10 'Connections (Stock) in Thousands Last Year\r\rCalcInfraInvest(CDbl(ICTMobilDemThousands), CDbl(sICTMobilThousands),\r                                            Deppcnt(Mobile), ICTMOBILCOST(R%), INFRAINVESTNEW(R%, Mobile), INFRAINVESTMAINT(R%, Mobile))\r\r\rEnd If\r\rEnd If\r"
  },
  {
    "Variable": "ICTMOBIL",
    "UsesVariable": "GDPPCP",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "ICTMOBIL",
    "UsesVariable": "GOVREGQUAL",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "ICTMOBIL",
    "UsesVariable": "ictmobilsetar",
    "Distance": 1,
    "Code": "\r\rMOBILshift(R) = ICTMOBIL(R) - mobilVal\r\rIf MOBILshift(R) > 0 Then\rMobilAdd = MOBILshift(R)\rElse\rMobilAdd = ConvergeOverTime(MOBILshift(R), 0, 100)\rEnd If\rCOMPLETE STRUCTURE:Next R%:16499|\rFor R% = 1 To NR%\r'Cross-sectional model (with SE Effect Calculation)\r'--------------------------------------------------------\rCall AnalFuncSE(\"ICT Mobile Access % of Population Rev 2010\",\r            New Single() {GDPPCP(R), SGOVREGQUAL(R)}, rVal, SE,\r            New String() {\"GDP2005PCPPP(MOSTRECENT)/ 1000 (Log)\", \"GovernanceRegQual(MOSTRECENT)+ 2.5 (Linear)\"}, context) 'jrs 2014/10/09 added DepVar Names to check order\r\rDim SE As Single = 0\r\r\rMOBILshift(R) = ICTMOBIL(R) - mobilVal\r"
  },
  {
    "Variable": "ICTMOBIL",
    "UsesVariable": "ictmobilseyrtar",
    "Distance": 1,
    "Code": "\r\rMOBILshift(R) = ICTMOBIL(R) - mobilVal\r"
  },
  {
    "Variable": "ICTMOBIL",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ICTMOBIL",
    "UsesVariable": "ICTBROADMOBIL",
    "Distance": 0,
    "Code": "\r\r\r'Universal target\r'dkb 2013/09/16 added dimension 1 to ictbroadmobilsetar\rIf ictbroadmobiltrgtyr(R%) > 0 And ictbroadmobilsetar(R%) = 0 Then\rDim ICTBROADMOBILTrgt = Amin(ictmobilsaturation, iICTBROADMOBIL(R%) + Amin(ictbroadmobiltrgtyr(R%), IY - 1) * (ictbroadmobiltrgtval(R%) - iICTBROADMOBIL(R%)) / ictbroadmobiltrgtyr(R%))\rICTBROADMOBIL(R%) = AMAX(ICTBROADMOBIL(R%), ICTBROADMOBILTrgt)\r\r'adjust n=mobile to be consistent with mobile BB\rIf ICTMOBIL(R%) < ICTBROADMOBIL(R%) Then\rICTMOBIL(R%) = ICTBROADMOBIL(R%)\rSMobil(R, 2) = ICTMOBIL(R)\rDim ICTMobilDemThousands = ICTMOBIL(R%) * CDbl(POP(R%)) * 10 'Demanded Connections (stock) in Thousands This Year\rDim sICTMobilThousands = SICTMobil(R%) * CDbl(sPOPTotal(R%)) * 10 'Connections (Stock) in Thousands Last Year\r\rCalcInfraInvest(CDbl(ICTMobilDemThousands), CDbl(sICTMobilThousands),\r                                            Deppcnt(Mobile), ICTMOBILCOST(R%), INFRAINVESTNEW(R%, Mobile), INFRAINVESTMAINT(R%, Mobile))\r\r\rEnd If\r\rEnd If\r"
  },
  {
    "Variable": "ICTMOBILCOST",
    "UsesVariable": "ictmobilcostm",
    "Distance": 0,
    "Code": "\r'note to MTI: unlike other infrastructure there is no hard parameter to check against here\r'mti June 04, 2012 - end\r\r\r'spending need\r'MobilConAdded = AMAX(0, (CDbl(ICTMOBIL(R)) * CDbl(POP(R%)) - SICTMobil(R) * CDbl(sPOPTOTAL(R%))) / 100) 'millions of subscribers\r\rCalcInfraUnitCost(R%, 10, 5, ictmobilcostupper, ictmobilcostlower, sGDPPCP(R%), ICTMOBILCOST(R%), False)\rICTMOBILCOST(R%) = ICTMOBILCOST(R%) * ictmobilcostm(R%)\r"
  },
  {
    "Variable": "ICTSPEND",
    "UsesVariable": "ictspendm",
    "Distance": 0,
    "Code": "\r\rPublic Sub IFsInfra1AllbutFirstYear(context As IForecastContext)\r'AllButFirst:  'block for all years but first year (exception: call2 handles exlectricity first year and infrastructure index calculation first year)\r'ttt- ReDim\rReDim INFRAINVESTNEWBF(NR%, NInfraType%)\rReDim INFRAINVESTMAINTBF(NR%, NInfraType%)\r'jrs 2019/10/22\rArray.Copy(sLANDAREA, LANDAREA, NR + 1)\r'jrs 2019/11/25\r'jrs 2019/11/26 Array.Copy(ilandirareasat, landirareasat, NR + 1)\r\rFor R% = 1 To NR%\r\r'sErrorSub = \"IFsInfra\" & CStr(IFUN) & \"-\" & RegName(R%)\r\r'   All but First Call 1:  ICT Spending as Pct. of GDP\r' ---------------------------------------------------\r'Note MTI: came from JRS old ICT model: need to conform with new ICT spending\r\r'jrs 2009/05/18\rDim rVal As Single = 0\rIf context.HistoricMode Then\rTbName$ = \"GDP/Capita (PPP 2000) Versus ICT Expenditures % GDP (2005) Linear\"\rCall XYTABL(TbName$, GDPPCP(R), rVal, context)\rElse\rTbName$ = \"GDP/Capita (PPP 2000) Versus ICT Expenditures % GDP (\" & CStr(BaseYear) & \") Linear\"\rTbName$ = getFunctionNameYrOrMstRct(TbName$, BaseYear, context)\rCall XYTABL(TbName$, GDPPCP(R), rVal, context)\rEnd If\rICTSPEND(R%) = rVal + SPENDshift(R%)\r'applying multiplier\rICTSPEND(R%) = ICTSPEND(R%) * ictspendm(R%)\rICTSPEND(R%) = AMAX(Amin(ICTSPEND(R%), 100), 0)\r\rNext R%\r\r\rPublic Sub IFsInfra1AllbutFirstYear(context As IForecastContext)\r'AllButFirst:  'block for all years but first year (exception: call2 handles exlectricity first year and infrastructure index calculation first year)\r'ttt- ReDim\rReDim INFRAINVESTNEWBF(NR%, NInfraType%)\rReDim INFRAINVESTMAINTBF(NR%, NInfraType%)\r'jrs 2019/10/22\rArray.Copy(sLANDAREA, LANDAREA, NR + 1)\r'jrs 2019/11/25\r'jrs 2019/11/26 Array.Copy(ilandirareasat, landirareasat, NR + 1)\r\rFor R% = 1 To NR%\r\r'sErrorSub = \"IFsInfra\" & CStr(IFUN) & \"-\" & RegName(R%)\r\r'   All but First Call 1:  ICT Spending as Pct. of GDP\r' ---------------------------------------------------\r'Note MTI: came from JRS old ICT model: need to conform with new ICT spending\r\r'jrs 2009/05/18\rDim rVal As Single = 0\rIf context.HistoricMode Then\rTbName$ = \"GDP/Capita (PPP 2000) Versus ICT Expenditures % GDP (2005) Linear\"\rCall XYTABL(TbName$, GDPPCP(R), rVal, context)\rElse\rTbName$ = \"GDP/Capita (PPP 2000) Versus ICT Expenditures % GDP (\" & CStr(BaseYear) & \") Linear\"\rTbName$ = getFunctionNameYrOrMstRct(TbName$, BaseYear, context)\rCall XYTABL(TbName$, GDPPCP(R), rVal, context)\rEnd If\rICTSPEND(R%) = rVal + SPENDshift(R%)\r'applying multiplier\rICTSPEND(R%) = ICTSPEND(R%) * ictspendm(R%)\rICTSPEND(R%) = AMAX(Amin(ICTSPEND(R%), 100), 0)\r\rNext R%\r"
  },
  {
    "Variable": "ICTSPEND",
    "UsesVariable": "GDPPCP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "IGCF",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "ennoprodsw",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "idsm",
    "Distance": 0,
    "Code": "\r\r'   First Year:  Compute Capital, Wages, and Capital Cost\r'   -----------------------------------------------------\r\rFor S% = 1 To NSec%\rkdrate = 1 / AMAX(5, lks(S%))\rIf KGroComp + kdrate <= 0.005 Then\r'bbh 2022/01/30 Branch never used because KGroComp always above -.002 and kdrate always above 0.01\rkgrocomps(S%) = CSng(-kdrate + 0.005)\rElse\rkgrocomps(S%) = KGroComp\rEnd If\rIDS(R%, S%) = AMAX(0.0001, IGCF(R%) * VADD(R%, S%) * salpha(S%) / Sum2)\r'If GRPS(1, R) = \"Philippines\" And S = Ener Then Stop\r'bbh 2022/01/30 To understand the line below, recognize the kgrocomps is defined in function above as Delta KS rate\r'   IDS in a given year can be understood as KS * (delta K rate plus depreciation rate), because it needs to cover both depreciation and capital growth\r'   If IDS = KS * (Delta KS rate + Depreciation rate) then\r'   KS = IDS/(Delta KS rate plus depreciation rate)\r'   Weakness in this formulation is the function above for determination of Delta KS rate from total national investment\r'       The functional form was built subjectively/experimentally, thereby also benefitting subjectively from the division by 2\r'   What would be a better approach?  Actually knowing something about IDS and KS from data; using national data on IGCF to create both IDS and KS is messy\r'   Inside IFsEcoMFP a related set of issues affects the derivative formulation for guestimating the first year annual growth in KS and therefore its contribution by sector\r'       to MFPGROWTH; the annual growth in labor force is undergirded by a stronger set of data, but also not really ideal\rKS(R%, S%) = IDS(R%, S%) / (kgrocomps(S%) + kdrate)\rWAGES(R%, S%) = VADD(R%, S%) * (1 - alphas(R%, S%)) / AMAX(0.01, LABS(R%, S%))\rCAPCOS(R%, S%) = VADD(R%, S%) * alphas(R%, S%) / AMAX(0.001, KS(R%, S%))\r'If RegName$(R%) = \"Sao Tome and Principe\" And S% = 3 Then Stop\r\rIDK(R%, S%) = IDS(R%, S%) / IGCF(R%)\rsidk(R%, S%) = IDK(R%, S%)\r\rNext S%\r"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "agon",
    "Distance": 0,
    "Code": "\r'Call ADJSTR(100, Diff1, Diff2, 0.2, 0.4, Mul)\rCall ADJSTR(100, Diff1, Diff2, 0.05, 0.1, Mul) 'Larger numbers cause oscillation in CRA\r\rFor S% = 1 To NSec%\r'If RegName$(R%) = \"China\" And S% = 2 Then Stop\r\r'bbh 2020/08/03 Start\rStBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%) 'bbh 2021/09/30 ims DOES NOT grow and fixed causes problems, e.g. Vietnam materials\r'StBase(R%, S%) = PFD(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%) 'bbh 2022/10/27\r'StBase(R%, S%) = PFD(R%, S%) + MovAvgMS(R%, S%) 'bbh 2022/10/27 Replaced line above for more control over import contribution to stock need\r'StBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) 'bbh 2021/09/21 ims itself grows; GTPPOT/GDPI was causing problems\r'for countries like China with large stock demands\r'StBase(R%, S%) = VADD(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%)\r'bbh 2020/08/03 end\r\r'mti 2018/10/01 Start\r'            StBase(R%, S%) = zsp(R%, S%) + sms(R%, S%)\r'mti 2018/10/01 End\rIf ((S% > Ener) OrElse (S% = Agri AndAlso agon < 0.9) OrElse (S% = Ener AndAlso enon < 0.9)) Then\rDiff1 = SST(R%, S%) - dstl * StBase(R%, S%)\r'Diff2 = sst(R%, S%) - SSTS(R%, S%) * (1! + igdpr(R%))\rDiff2 = SST(R%, S%) - SSTS(R%, S%) * (1.0! + igdprcor(R%))\rCall ADJSTR(StBase(R%, S%), Diff1, Diff2, elinst1, elinst2, Mul)\r'mti 2018/07/02 Start\rIDS(R%, S%) = IGCF(R%) * IDK(R%, S%) * idsm(R%, S%) * Mul\r'mti 2018/07/02 End\rEnd If\rMinIDS = IDK(R%, S%) * IGCF(R%) * 0.5!\r'If GRPS(1, R%) = \"Guinea Bissau\" And S% = 2 And IY >= 7 Then Stop\rIDS(R%, S%) = AMAX(MinIDS, Amin(IDS(R%, S%), IGCF(R%)))\r\r\r\rIf S% = 1 Then\rIDS(R%, S%) = CSng(Amin(IGCF(R%) * 0.3, Amin(IGCF(R%) * sidk(R%, S%) * 2.5, IDS(R%, S%))))\r'If RegName$(R%) = \"Congo, Democratic Republic Of\" And IY% >= 50 Then Stop\rEnd If\rIf S% = 2 Then\r'jrs 2022/04/18\r'if IGCF(R%) * sidk(R%, S%) > 0.1 then\r'jrs 2022/05/02 If GRPS(1, R%) <> \"Guinea Bissau\" Or context.HistoricMode = True Then\rIf ennoprodsw(R%) = 0 Or context.HistoricMode = True Then\rIDS(R%, S%) = CSng(Amin(IGCF(R%) * 0.5, Amin(IGCF(R%) * sidk(R%, S%) * 3, IDS(R%, S%))))\rEnd If\rEnd If\r\rtids = tids + IDS(R%, S%)\rNext S%\r"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "enon",
    "Distance": 0,
    "Code": "\r'Call ADJSTR(100, Diff1, Diff2, 0.2, 0.4, Mul)\rCall ADJSTR(100, Diff1, Diff2, 0.05, 0.1, Mul) 'Larger numbers cause oscillation in CRA\r"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "elinst1",
    "Distance": 1,
    "Code": "\r'bbh 2020/07/01 end\rDiff2 = Diff1 - SHHFIRMSAVDiff(R%)\r\rFor S% = 1 To NSec%\r'If RegName$(R%) = \"China\" And S% = 2 Then Stop\r\r'bbh 2020/08/03 Start\rStBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%) 'bbh 2021/09/30 ims DOES NOT grow and fixed causes problems, e.g. Vietnam materials\r'StBase(R%, S%) = PFD(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%) 'bbh 2022/10/27\r'StBase(R%, S%) = PFD(R%, S%) + MovAvgMS(R%, S%) 'bbh 2022/10/27 Replaced line above for more control over import contribution to stock need\r'StBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) 'bbh 2021/09/21 ims itself grows; GTPPOT/GDPI was causing problems\r'for countries like China with large stock demands\r'StBase(R%, S%) = VADD(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%)\r'bbh 2020/08/03 end\r\r'mti 2018/10/01 Start\r'            StBase(R%, S%) = zsp(R%, S%) + sms(R%, S%)\r'mti 2018/10/01 End\rIf ((S% > Ener) OrElse (S% = Agri AndAlso agon < 0.9) OrElse (S% = Ener AndAlso enon < 0.9)) Then\rDiff1 = SST(R%, S%) - dstl * StBase(R%, S%)\r'Diff2 = sst(R%, S%) - SSTS(R%, S%) * (1! + igdpr(R%))\rDiff2 = SST(R%, S%) - SSTS(R%, S%) * (1.0! + igdprcor(R%))\rCall ADJSTR(StBase(R%, S%), Diff1, Diff2, elinst1, elinst2, Mul)\r'mti 2018/07/02 Start\rIDS(R%, S%) = IGCF(R%) * IDK(R%, S%) * idsm(R%, S%) * Mul\r'mti 2018/07/02 End\rEnd If\rMinIDS = IDK(R%, S%) * IGCF(R%) * 0.5!\r'If GRPS(1, R%) = \"Guinea Bissau\" And S% = 2 And IY >= 7 Then Stop\rIDS(R%, S%) = AMAX(MinIDS, Amin(IDS(R%, S%), IGCF(R%)))\r\r\r\rIf S% = 1 Then\rIDS(R%, S%) = CSng(Amin(IGCF(R%) * 0.3, Amin(IGCF(R%) * sidk(R%, S%) * 2.5, IDS(R%, S%))))\r'If RegName$(R%) = \"Congo, Democratic Republic Of\" And IY% >= 50 Then Stop\rEnd If\rIf S% = 2 Then\r'jrs 2022/04/18\r'if IGCF(R%) * sidk(R%, S%) > 0.1 then\r'jrs 2022/05/02 If GRPS(1, R%) <> \"Guinea Bissau\" Or context.HistoricMode = True Then\rIf ennoprodsw(R%) = 0 Or context.HistoricMode = True Then\rIDS(R%, S%) = CSng(Amin(IGCF(R%) * 0.5, Amin(IGCF(R%) * sidk(R%, S%) * 3, IDS(R%, S%))))\rEnd If\rEnd If\r\rtids = tids + IDS(R%, S%)\rNext S%\r\r'Base, Target, Years\r'Diff1 = hhfirmsavr - hhfirmsavri(R%)\rDiff1 = hhfirmsavr - HHFirmSavTarget\r\rFor S% = 1 To NSec%\r'If RegName$(R%) = \"China\" And S% = 2 Then Stop\r\r'bbh 2020/08/03 Start\rStBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%) 'bbh 2021/09/30 ims DOES NOT grow and fixed causes problems, e.g. Vietnam materials\r'StBase(R%, S%) = PFD(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%) 'bbh 2022/10/27\r'StBase(R%, S%) = PFD(R%, S%) + MovAvgMS(R%, S%) 'bbh 2022/10/27 Replaced line above for more control over import contribution to stock need\r'StBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) 'bbh 2021/09/21 ims itself grows; GTPPOT/GDPI was causing problems\r'for countries like China with large stock demands\r'StBase(R%, S%) = VADD(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%)\r'bbh 2020/08/03 end\r\r'mti 2018/10/01 Start\r'            StBase(R%, S%) = zsp(R%, S%) + sms(R%, S%)\r'mti 2018/10/01 End\rIf ((S% > Ener) OrElse (S% = Agri AndAlso agon < 0.9) OrElse (S% = Ener AndAlso enon < 0.9)) Then\rDiff1 = SST(R%, S%) - dstl * StBase(R%, S%)\r'Diff2 = sst(R%, S%) - SSTS(R%, S%) * (1! + igdpr(R%))\rDiff2 = SST(R%, S%) - SSTS(R%, S%) * (1.0! + igdprcor(R%))\rCall ADJSTR(StBase(R%, S%), Diff1, Diff2, elinst1, elinst2, Mul)\r'mti 2018/07/02 Start\rIDS(R%, S%) = IGCF(R%) * IDK(R%, S%) * idsm(R%, S%) * Mul\r'mti 2018/07/02 End\rEnd If\rMinIDS = IDK(R%, S%) * IGCF(R%) * 0.5!\r'If GRPS(1, R%) = \"Guinea Bissau\" And S% = 2 And IY >= 7 Then Stop\rIDS(R%, S%) = AMAX(MinIDS, Amin(IDS(R%, S%), IGCF(R%)))\r\r\r\rIf S% = 1 Then\rIDS(R%, S%) = CSng(Amin(IGCF(R%) * 0.3, Amin(IGCF(R%) * sidk(R%, S%) * 2.5, IDS(R%, S%))))\r'If RegName$(R%) = \"Congo, Democratic Republic Of\" And IY% >= 50 Then Stop\rEnd If\rIf S% = 2 Then\r'jrs 2022/04/18\r'if IGCF(R%) * sidk(R%, S%) > 0.1 then\r'jrs 2022/05/02 If GRPS(1, R%) <> \"Guinea Bissau\" Or context.HistoricMode = True Then\rIf ennoprodsw(R%) = 0 Or context.HistoricMode = True Then\rIDS(R%, S%) = CSng(Amin(IGCF(R%) * 0.5, Amin(IGCF(R%) * sidk(R%, S%) * 3, IDS(R%, S%))))\rEnd If\rEnd If\r\rtids = tids + IDS(R%, S%)\rNext S%\r\r\r'   First Year: Compute Initial Stocks and Recompute Stock Ratio\r'       Based on Computed VADD\r'   ------------------------------------------------------------\rFor S% = 1 To NSec%\rims(R%, S%) = MS(R%, S%)\r'bbh 2020/08/03 Start; need to switch stock base from ZS to VADD because over time\r'   the ratio of ZS/VADD changes (in China manufacturing almost doubles); VADD/PFD more stable\r'   Perhaps should even be PFD given the close link of PFD to stock accummulation\r'   Problem with ZS is that over time the swings of ST and CAPUT become reinforcing and very large\rStBase(R%, S%) = ZS(R%, S%) + ims(R%, S%)\r'StBase(R%, S%) = PFD(R%, S%) + ims(R%, S%) 'bbh 2022/10/27\rMovAvgMS(R%, S%) = ims(R%, S%) 'bbh 2022/10/27\r'StBase(R%, S%) = VADD(R%, S%) + ims(R%, S%)\r'bbh 2020/08/03 end\rSMS(R%, S%) = MS(R%, S%) 'bbh 2019/09/13\r\r'mti 2018/10/01 Start\r'            sms(R%, S%) = MS(R%, S%)\r'            StBase(R%, S%) = ZS(R%, S%) + sms(R%, S%)\r'mti 2018/10/01 End\r\rST(R%, S%) = StBase(R%, S%) * dstl\rNext S%\r\rFor S% = 1 To NSec%\r'If RegName$(R%) = \"China\" And S% = 2 Then Stop\r\r'bbh 2020/08/03 Start\rStBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%) 'bbh 2021/09/30 ims DOES NOT grow and fixed causes problems, e.g. Vietnam materials\r'StBase(R%, S%) = PFD(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%) 'bbh 2022/10/27\r'StBase(R%, S%) = PFD(R%, S%) + MovAvgMS(R%, S%) 'bbh 2022/10/27 Replaced line above for more control over import contribution to stock need\r'StBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) 'bbh 2021/09/21 ims itself grows; GTPPOT/GDPI was causing problems\r'for countries like China with large stock demands\r'StBase(R%, S%) = VADD(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%)\r'bbh 2020/08/03 end\r\r'mti 2018/10/01 Start\r'            StBase(R%, S%) = zsp(R%, S%) + sms(R%, S%)\r'mti 2018/10/01 End\rIf ((S% > Ener) OrElse (S% = Agri AndAlso agon < 0.9) OrElse (S% = Ener AndAlso enon < 0.9)) Then\rDiff1 = SST(R%, S%) - dstl * StBase(R%, S%)\r'Diff2 = sst(R%, S%) - SSTS(R%, S%) * (1! + igdpr(R%))\rDiff2 = SST(R%, S%) - SSTS(R%, S%) * (1.0! + igdprcor(R%))\rCall ADJSTR(StBase(R%, S%), Diff1, Diff2, elinst1, elinst2, Mul)\r'mti 2018/07/02 Start\rIDS(R%, S%) = IGCF(R%) * IDK(R%, S%) * idsm(R%, S%) * Mul\r'mti 2018/07/02 End\rEnd If\rMinIDS = IDK(R%, S%) * IGCF(R%) * 0.5!\r'If GRPS(1, R%) = \"Guinea Bissau\" And S% = 2 And IY >= 7 Then Stop\rIDS(R%, S%) = AMAX(MinIDS, Amin(IDS(R%, S%), IGCF(R%)))\r\r\r\rIf S% = 1 Then\rIDS(R%, S%) = CSng(Amin(IGCF(R%) * 0.3, Amin(IGCF(R%) * sidk(R%, S%) * 2.5, IDS(R%, S%))))\r'If RegName$(R%) = \"Congo, Democratic Republic Of\" And IY% >= 50 Then Stop\rEnd If\rIf S% = 2 Then\r'jrs 2022/04/18\r'if IGCF(R%) * sidk(R%, S%) > 0.1 then\r'jrs 2022/05/02 If GRPS(1, R%) <> \"Guinea Bissau\" Or context.HistoricMode = True Then\rIf ennoprodsw(R%) = 0 Or context.HistoricMode = True Then\rIDS(R%, S%) = CSng(Amin(IGCF(R%) * 0.5, Amin(IGCF(R%) * sidk(R%, S%) * 3, IDS(R%, S%))))\rEnd If\rEnd If\r\rtids = tids + IDS(R%, S%)\rNext S%\r"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "elinst2",
    "Distance": 1,
    "Code": "\r'bbh 2020/07/01 end\rDiff2 = Diff1 - SHHFIRMSAVDiff(R%)\r"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "GDPPOT",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "ZS",
    "Distance": 1841,
    "Code": "0"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "ST",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "dstl",
    "Distance": 3,
    "Code": "\r\r'   First Year: Compute Initial Stocks and Recompute Stock Ratio\r'       Based on Computed VADD\r'   ------------------------------------------------------------\rFor S% = 1 To NSec%\rims(R%, S%) = MS(R%, S%)\r'bbh 2020/08/03 Start; need to switch stock base from ZS to VADD because over time\r'   the ratio of ZS/VADD changes (in China manufacturing almost doubles); VADD/PFD more stable\r'   Perhaps should even be PFD given the close link of PFD to stock accummulation\r'   Problem with ZS is that over time the swings of ST and CAPUT become reinforcing and very large\rStBase(R%, S%) = ZS(R%, S%) + ims(R%, S%)\r'StBase(R%, S%) = PFD(R%, S%) + ims(R%, S%) 'bbh 2022/10/27\rMovAvgMS(R%, S%) = ims(R%, S%) 'bbh 2022/10/27\r'StBase(R%, S%) = VADD(R%, S%) + ims(R%, S%)\r'bbh 2020/08/03 end\rSMS(R%, S%) = MS(R%, S%) 'bbh 2019/09/13\r\r'mti 2018/10/01 Start\r'            sms(R%, S%) = MS(R%, S%)\r'            StBase(R%, S%) = ZS(R%, S%) + sms(R%, S%)\r'mti 2018/10/01 End\r\rST(R%, S%) = StBase(R%, S%) * dstl\rNext S%\r"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "igdpr",
    "Distance": 2,
    "Code": "\r\r''mti April 2010 - Infrastructure Consolidation - start\r'\r''   BBH 6/9/04 V5_0 Begin\r''   First Year:  Infrastructure Calculation\r''   ----------------------------------------\r'\r'        'LandPerCap = LD(R%, 1) / POP(R%)\r'        LandPerCap = LANDAREA(R%) / POP(R%)\r'        Call AnalFunc(\"Road Density with Population Density, GDP per Capita (1999)\", _\r'             Array(GDPPCP(R%), LandPerCap), Prediction)\r'\r'        RoadDensRI(R%) = INFRAROAD(R%) / AMAX(0.001, Prediction) '* LD(R%, 1) / AMAX(0.01, LANDAREA(R%))\r'\r'        Call XYTABL(\"GDP/Capita (PPP) Versus Telephones per 1000 (2000)\", _\r'            Amin(40, GDPPCP(R%)), Prediction)\r'        TeleDensRI(R%) = INFRATELE(R%) / AMAX(0.001, Prediction)\r'\r'        TbName$ = \"GDP/Capita (PPP 2000) Versus Kilowatt-Hours per Capita (2000) Linear\"\r'        Call XYTABL(TbName$, Amin(40, GDPPCP(R%)), Prediction)\r'        InfraElecRI(R%) = INFRAELEC(R%) / AMAX(0.001, Prediction)\r'\r'        Call XYTABL(\"GDP/Capita (PPP) Versus Internet Percent Use (2000)\", _\r'                    Amin(40, GDPPCP(R%)), Prediction)\r'        InfraNetRI(R%) = INFRANET(R%) / AMAX(0.001, Prediction)\r'        SINFRAELEC(R%) = INFRAELEC(R%)\r'        SINFRAROAD(R%) = INFRAROAD(R%)\r'        SINFRANET(R%) = INFRANET(R%)\r'        SINFRATELE(R%) = INFRATELE(R%)\r'        INFRAELECMin(R%) = INFRAELEC(R%)\r'        INFRAROADMin(R%) = INFRAROAD(R%)\r'        INFRANETMin(R%) = INFRANET(R%)\r'        INFRATELEMin(R%) = INFRATELE(R%)\r'\r''mti April 2010 - Infrastructure Consolidation -end\r\r'bbh 2020/05/26 moved to IFsEconIntl start\r'        SECONINTEG(R%) = ECONINTEG(R%)\r'        STradeTerm(R%) = TradeTerm(R%)\r'bbh 2020/05/26 moved to IFsEconIntl end\r\r'        TradeTermMa(R%) = TradeTerm(R%) 'bbh 2016/01/19\r'If RegName$(R%) = \"Sweden\" Then Stop\r' If RegName$(R%) = \"Central AfR\" Then Stop\r\r\r'   BBH 6/9/04 V5_0 End\r\r'   First Year:  Stocks and Costs\r'   -----------------------------\r\rFor S% = 1 To NSec%\rSST(R%, S%) = ST(R%, S%)\rSSTS(R%, S%) = ST(R%, S%)\rsstphys(R%, S%) = ST(R%, S%)\rCOSTI(R%, S%) = 0!\rFor s2% = 1 To NSec%\rCOSTI(R%, S%) = COSTI(R%, S%) + AMat(R%, s2%, S%) * PRI(R%, s2%)\rNext s2%\rCost(R%, S%) = COSTI(R%, S%)\r\r'   First Year:  Must Add Capital and Labor Costs\r'   ---------------------------------------------\r\rNext S%\r"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "MS",
    "Distance": 1682,
    "Code": "0"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "GDP",
    "Distance": 1707,
    "Code": "0"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "HHSAV",
    "Distance": 504,
    "Code": "0"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "FIRMSAV",
    "Distance": 504,
    "Code": "0"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "VADD",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "salpha",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "INAG",
    "Distance": 0,
    "Code": "\rIDS(R%, 1) = INAG(R%)\r"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "enconv",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "eninvtm",
    "Distance": 74,
    "Code": "0"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "ENP",
    "Distance": 84,
    "Code": "0"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "lke",
    "Distance": 84,
    "Code": "0"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "QE",
    "Distance": 84,
    "Code": "0"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "ken",
    "Distance": 348,
    "Code": "0"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "eprodr",
    "Distance": 104,
    "Code": "0"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "elass",
    "Distance": 106,
    "Code": "0"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "enpcoalmax",
    "Distance": 95,
    "Code": "0"
  },
  {
    "Variable": "IDS",
    "UsesVariable": "ENDEM",
    "Distance": 91,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "C",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "CS",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "GDPRPA",
    "Distance": 201,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "elasit",
    "Distance": 201,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "VADD",
    "Distance": 860,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "WP",
    "Distance": 860,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "GOVCON",
    "Distance": 2,
    "Code": "\rIf GDPPOTRPA(R%) < 0.001 Then GDPPOTRPA(R%) = 0.001\r\rIf GDPPOTRPA(R%) < 0.001 Then GDPPOTRPA(R%) = 0.001\r\rIf IGCF(R%) < 0.05 * GDPPOTRPA(R%) Then\rDecreaseG = CSng(Amin(0.05 * GDPPOTRPA(R%) - IGCF(R%), 0.3 * GOVCON(R%)))\rGOVCON(R%) = GOVCON(R%) - DecreaseG\rIGCF(R%) = IGCF(R%) + DecreaseG\rEnd If\r\rIf IGCF(R%) < 0.05 * GDPPOTRPA(R%) Then\rDecreaseG = CSng(Amin(0.05 * GDPPOTRPA(R%) - IGCF(R%), 0.3 * GOVCON(R%)))\rGOVCON(R%) = GOVCON(R%) - DecreaseG\rIGCF(R%) = IGCF(R%) + DecreaseG\rEnd If\r"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "enon",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "agon",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "gdprext",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "invm",
    "Distance": 1,
    "Code": "\riadj = IGCF(R%) * (invm(R%) - 1) ' + lifexpterm\r\rIGCF(R%) = IGCF(R%) + iadj '+ SavingsAgeAdj(R%) 'Age structure adjustment term from IFsPop\r"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "igdpr",
    "Distance": 2367,
    "Code": "\r\rPublic Sub ifsECO3AllbutFirstYear(context As IForecastContext)\r'     All but First 3\r'     ******\r\r'call3:\r'   All but First 3: GDP Derivative Calculation\r'   -------------------------------------------------\r'jrs 2014/09/15\rDim GDPRPAR As Single\rDim LabRate As Single 'bbh 2017/10/04\r\rFor R% = 1 To NR%\r'If RegName$(R%) = \"United States of America\" Then Stop\rGDPR(R%) = 0!\rIf (SGDP(R%) > 0.001) Then GDPR(R%) = (GDP(R%) - SGDP(R%)) / SGDP(R%)\rSmoothGDPR(R%) = SmoothGDPR(R%) * 0.95! + GDPR(R%) * 0.05!\r'bbh 2017/10/04 begin\rLabRate = (LAB(R%) - SLab(R%)) / SLab(R%)\rSmoothLabR(R%) = SmoothLabR(R%) * 0.9! + LabRate * 0.1!\rSLab(R%) = LAB(R%)\r'bbh 2017/10/04 end\r'mti 2014/11/27 -start\rssGDP(R%) = SGDP(R%)\r'mti 2014/11/27 -end\r'SGDP(R%) = GDP(R%) 'bbh 2022/06/23 moved to after use in IFsEcoSAM(3)\r\rGDPRPAR = 0!\rIf (sgdprpa(R%) > 0.001) Then GDPRPAR = (GDPRPA(R%) - sgdprpa(R%)) / sgdprpa(R%)\rSmoothGDPRPAR(R%) = SmoothGDPRPAR(R%) * 0.95! + GDPRPAR * 0.05!\rsgdprpa(R%) = GDPRPA(R%)\r'If RegName$(R%) = \"China\" Then Stop\rNext R%\rEnd Sub\r\rSmoothGDPRPAR(R%) = IGDPRCor(R%)\r\r\rPublic Sub ifsECO3AllbutFirstYear(context As IForecastContext)\r'     All but First 3\r'     ******\r\r'call3:\r'   All but First 3: GDP Derivative Calculation\r'   -------------------------------------------------\r'jrs 2014/09/15\rDim GDPRPAR As Single\rDim LabRate As Single 'bbh 2017/10/04\r\rFor R% = 1 To NR%\r'If RegName$(R%) = \"United States of America\" Then Stop\rGDPR(R%) = 0!\rIf (SGDP(R%) > 0.001) Then GDPR(R%) = (GDP(R%) - SGDP(R%)) / SGDP(R%)\rSmoothGDPR(R%) = SmoothGDPR(R%) * 0.95! + GDPR(R%) * 0.05!\r'bbh 2017/10/04 begin\rLabRate = (LAB(R%) - SLab(R%)) / SLab(R%)\rSmoothLabR(R%) = SmoothLabR(R%) * 0.9! + LabRate * 0.1!\rSLab(R%) = LAB(R%)\r'bbh 2017/10/04 end\r'mti 2014/11/27 -start\rssGDP(R%) = SGDP(R%)\r'mti 2014/11/27 -end\r'SGDP(R%) = GDP(R%) 'bbh 2022/06/23 moved to after use in IFsEcoSAM(3)\r\rGDPRPAR = 0!\rIf (sgdprpa(R%) > 0.001) Then GDPRPAR = (GDPRPA(R%) - sgdprpa(R%)) / sgdprpa(R%)\rSmoothGDPRPAR(R%) = SmoothGDPRPAR(R%) * 0.95! + GDPRPAR * 0.05!\rsgdprpa(R%) = GDPRPA(R%)\r'If RegName$(R%) = \"China\" Then Stop\rNext R%\rEnd Sub\r\r\r'bbh 2022/10/17 Converging irai toward global norm over time End\r\r'bbh 2020/08/01 end\r\r'If RegName$(R%) = \"Unitd Kingdm\" And IY% >= 6 Then Stop\r\r'IGCF(R%) = GDPPOTRPA(R%) * (irai(R%) + fditerm + portfolioterm) + immadj\r'bbh 2020/07/23 end\r'         Else\r'            IGCF(R%) = GDPPOTRPA(R%) * (irai(R%) + fditerm + portfolioterm)\r'         End If\r'bbh 2020/07/14 end\r\r\r'If RegName$(R%) = \"Congo, Democratic Republic of\" And IY% >= 17 Then Stop\r'bbh 2020/07/01 end\r'IGCF(R%) = GDPPOTRPA(R%) * (irai(R%) + fditerm) * _\r'smoothsavingsterm(R%)\r\r\r'If RegName$(R%) = \"Israel\" Then Stop\r'BBH 7/27/04 End\r'Almost certainly need something like Immadj on capital spending; also link to\r'   savings as in smoothsavingsterm\r'work on again with more stable overall model behavior\r'bbh 2020/08/10 Start Need to relax growth in IGCF given short-term downward shock of COVID\r'Code change basically removes any constraint; not clear if should still keep some\rGDPRMAX = CSng(1 + SmoothGDPRPAR(R%) + 0.5)\r\r'GDPRMAX = Csng(1 + SmoothGDPRPAR(R%) + 0.05)\r'bbh 2020/08/10 end\r'        IGCF(R%) = Amin(SIGCF(R%) * 1.09, IGCF(R%))\rIGCF(R%) = Amin(SIGCF(R%) * GDPRMAX, IGCF(R%))\r"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "IRA",
    "Distance": 1974,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "XFDIFIN",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "XFDIFOUT",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "xfdioutf",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "XPORTFIN",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "XPORTFOUT",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "HHSAVSURSTOCK",
    "Distance": 77,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "GDPPCP",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "ST",
    "Distance": 518,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "dstl",
    "Distance": 518,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "INTR",
    "Distance": 1962,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "GDPPOT",
    "Distance": 671,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "ZS",
    "Distance": 2508,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "MS",
    "Distance": 2349,
    "Code": "0"
  },
  {
    "Variable": "IGCF",
    "UsesVariable": "I",
    "Distance": 0,
    "Code": "\rIGCF(R%) = I(R%) 'Probably should be subtracting delta stocks out\r"
  },
  {
    "Variable": "igdprcor",
    "UsesVariable": "igdpr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "igdprcor",
    "UsesVariable": "POPR",
    "Distance": 0,
    "Code": "\r\r'jrs 2021/08/16 MinPCGr = 0.01\r'igdpr(R%) = AMAX(0.001, Amin(igdpr(R%), 0.2))\r'IGDPRCor(R%) = AMAX(0.001, AMAX(Amin(igdpr(R%), 0.2), (POPR(R%) + migrater(R%)) / 100  + 0.005))\r'jrs 2014/09/04 *** begin ***\r'jrs 2021/08/02\rIf igdpr(R%) = igdprbase(1, R%) Then\r'jrs 2022/01/11\rigdprcor(R%) = CSng(AMAX(0.001, AMAX(Amin(igdpr(R%), 0.2), POPR(R%) / 100 + minpcgr(R%)))) 'jrs 2021/08/16\r'igdprcor(R%) = CSng(AMAX(0.001, AMAX(Amin(igdpr(R%), 0.2), (CBR(R%) - CDR(R%)) / 1000 + minpcgr(R%)))) 'jrs 2021/08/16\rElse\rigdprcor(R%) = CSng(AMAX(0.001, Amin(igdpr(R%), 0.2)))\rEnd If\r"
  },
  {
    "Variable": "igdprcor",
    "UsesVariable": "minpcgr",
    "Distance": 0,
    "Code": "\r\r'jrs 2021/08/16 MinPCGr = 0.01\r'igdpr(R%) = AMAX(0.001, Amin(igdpr(R%), 0.2))\r'IGDPRCor(R%) = AMAX(0.001, AMAX(Amin(igdpr(R%), 0.2), (POPR(R%) + migrater(R%)) / 100  + 0.005))\r'jrs 2014/09/04 *** begin ***\r'jrs 2021/08/02\rIf igdpr(R%) = igdprbase(1, R%) Then\r'jrs 2022/01/11\rigdprcor(R%) = CSng(AMAX(0.001, AMAX(Amin(igdpr(R%), 0.2), POPR(R%) / 100 + minpcgr(R%)))) 'jrs 2021/08/16\r'igdprcor(R%) = CSng(AMAX(0.001, AMAX(Amin(igdpr(R%), 0.2), (CBR(R%) - CDR(R%)) / 1000 + minpcgr(R%)))) 'jrs 2021/08/16\rElse\rigdprcor(R%) = CSng(AMAX(0.001, Amin(igdpr(R%), 0.2)))\rEnd If\r"
  },
  {
    "Variable": "INAG",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INAG",
    "UsesVariable": "aginvm",
    "Distance": 0,
    "Code": "\rINAG(R%) = INAG(R%) * aginvm(R%)\r"
  },
  {
    "Variable": "INAG",
    "UsesVariable": "KAG",
    "Distance": 0,
    "Code": "\r'If RegName$(R%) = \"Turkmenistan\" AndAlso IY% >= 15 Then Stop\r\r'        TKAG = (YL(r%) / byl(r%) * KAG(r%) ^ Alpha(r%)) ^ (1 / Alpha(r%))\r'        CINAG = TKAG - (KAG(r%) - KAG(r%) / AMAX(lks(1), 0.001))\r'        CINAG = CINAG / (1 - ialk(r%))\r'        INAG(r%) = 0.9 * INAG(r%) + 0.1 * AMAX(0.01, CINAG)\r\rINAG(R%) = CSng(AMAX(0.005 * KAG(R%), Amin(0.4 * KAG(R%), INAG(R%))))\r"
  },
  {
    "Variable": "INAG",
    "UsesVariable": "WGDP",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "INAG",
    "UsesVariable": "dstl",
    "Distance": 653,
    "Code": "0"
  },
  {
    "Variable": "INAG",
    "UsesVariable": "ifsexomodelid",
    "Distance": 653,
    "Code": "0"
  },
  {
    "Variable": "INAG",
    "UsesVariable": "AGDEM",
    "Distance": 103,
    "Code": "0"
  },
  {
    "Variable": "INAG",
    "UsesVariable": "AGP",
    "Distance": 103,
    "Code": "0"
  },
  {
    "Variable": "INAG",
    "UsesVariable": "agstkadjsw",
    "Distance": 111,
    "Code": "0"
  },
  {
    "Variable": "INAG",
    "UsesVariable": "FSTOCK",
    "Distance": 495,
    "Code": "0"
  },
  {
    "Variable": "INAG",
    "UsesVariable": "AGX",
    "Distance": 118,
    "Code": "0"
  },
  {
    "Variable": "INAG",
    "UsesVariable": "AGM",
    "Distance": 118,
    "Code": "0"
  },
  {
    "Variable": "INAG",
    "UsesVariable": "IDS",
    "Distance": 0,
    "Code": "\r\r'   First Year:  Compute Capital\r'   ----------------------------\r\rINAG(R%) = IDS(R%, 1)\r"
  },
  {
    "Variable": "INCOMELT110LN",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT110LN",
    "UsesVariable": "GINIDOM",
    "Distance": 29,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT110LN",
    "UsesVariable": "C",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT110LN",
    "UsesVariable": "PPPCONV",
    "Distance": 70,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT110LN",
    "UsesVariable": "INCOMELT310LN",
    "Distance": 2279,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT110LN",
    "UsesVariable": "INCOMELT190LN",
    "Distance": 2330,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT125CS2005",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT125CS2005",
    "UsesVariable": "GDPPCP",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT125CS2005",
    "UsesVariable": "GINIDOM",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT125LN2005",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT125LN2005",
    "UsesVariable": "incpovlev",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT125LN2005",
    "UsesVariable": "nsnaratm",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT125LN2005",
    "UsesVariable": "GINIDOM",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT125LN2005",
    "UsesVariable": "C",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT125LN2005",
    "UsesVariable": "NSNARAT",
    "Distance": 2157,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT125LN2005",
    "UsesVariable": "PPPCONV",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT125LN2005",
    "UsesVariable": "INCOMELT200CS2005",
    "Distance": 2234,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT125LN2005",
    "UsesVariable": "INCOMELT215LN",
    "Distance": 2248,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT125LN2005",
    "UsesVariable": "INCOMELT310LN",
    "Distance": 65,
    "Code": "\r'mti 2021/10/15 End\r\r'percentage value, put in 0 to 1 scale; do not put in 0 to 100 scale\rlnstddev = CSng(Sqrt(2) * CalcNormalInverse((GINIDOM(R%) + 1) / 2))\r"
  },
  {
    "Variable": "INCOMELT125LN2005",
    "UsesVariable": "INCOMELT125CS2005",
    "Distance": 0,
    "Code": "\r\r'   First Year:  Income Below $1, $2 Log Normal\r'   -------------------------------------------\rINCOMELT125LN2005(R%) = INCOMELT125CS2005(R%)\r"
  },
  {
    "Variable": "INCOMELT190LN",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT190LN",
    "UsesVariable": "GINIDOM",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT190LN",
    "UsesVariable": "C",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT190LN",
    "UsesVariable": "PPPCONV",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT190LN",
    "UsesVariable": "INCOMELT310LN",
    "Distance": 2227,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT200CS2005",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT200CS2005",
    "UsesVariable": "GDPPCP",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT200CS2005",
    "UsesVariable": "GINIDOM",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT200LN2005",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT200LN2005",
    "UsesVariable": "GINIDOM",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT200LN2005",
    "UsesVariable": "C",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT200LN2005",
    "UsesVariable": "nsnaratm",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT200LN2005",
    "UsesVariable": "PPPCONV",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT200LN2005",
    "UsesVariable": "INCOMELT200CS2005",
    "Distance": 2240,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT200LN2005",
    "UsesVariable": "INCOMELT215LN",
    "Distance": 2254,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT200LN2005",
    "UsesVariable": "NSNARAT",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT200LN2005",
    "UsesVariable": "incpovlev",
    "Distance": 8,
    "Code": "\rNSNARAT2(R%) = (meanbackcalc / 1000) / AMAX(0.0001, meanconsumption)\r\r'jrs 2008/07/21\r'        lnstddev = Sqr(2) * NormalInverse((GINIDOM(R%) + 1) / 2)\r'            '=LN(B6*1000)-0.5*(I6^2)\r'        meanconsumption = C(R%) / AMAX(0.0001, POP(R%)) * PPPCONV(R%)\r'        LNMean = Log(meanconsumption * NSNARAT(R%) * 1000) - 0.5 * (lnstddev ^ 2)\r'        incomelt1lnpcnt = LogNormalCDF(365, LNMean, lnstddev)\r'        incomelt1lncalc = Amin(0.9 * POP(R%), incomelt1lnpcnt * POP(R%))\r'        incomelt1lnshift(R%) = INCOMELT125LN2005(R%) - incomelt1lncalc\r'jrs 2008/07/16\r'        If Abs(incomelt1lnshift(R%)) > 0.001 And DevelopmentMode = \"True\" Then\r'            MsgBox \"There is a shift in Poverty <$1 for \" & GRPS(1, R%), vbInformation, \"Economy SAM Module\"\r'        End If\r\r'If RegName$(R%) = \"China\" Then Stop\r\r'   First Year:  Income Below $2 Log Normal Shift\r'   -------------------------------------------------\rNSNARAT2(R%) = NSNARATI2(R%) * nsnaratm(R%)\r"
  },
  {
    "Variable": "INCOMELT200LN2005",
    "UsesVariable": "INCOMELT310LN",
    "Distance": 66,
    "Code": "\r'mti 2021/10/15 End\r\r'percentage value, put in 0 to 1 scale; do not put in 0 to 100 scale\rlnstddev = CSng(Sqrt(2) * CalcNormalInverse((GINIDOM(R%) + 1) / 2))\r"
  },
  {
    "Variable": "INCOMELT215LN",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT215LN",
    "UsesVariable": "GINIDOM",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT215LN",
    "UsesVariable": "C",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT215LN",
    "UsesVariable": "PPPCONV",
    "Distance": 45,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT310LN",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT310LN",
    "UsesVariable": "GINIDOM",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT310LN",
    "UsesVariable": "C",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT310LN",
    "UsesVariable": "PPPCONV",
    "Distance": 26,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT320LN",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT320LN",
    "UsesVariable": "GINIDOM",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT320LN",
    "UsesVariable": "C",
    "Distance": 14,
    "Code": "\r'dkb 2014/07/07 - END\r\r'jrs 2015/11/18 *** begin ***\r''jrs 2014/05/20 *** begin ***\r'\r''   All But First 5:  Income Below $1, $2 - Log-Normal Calculation\r''   -------------------------------------------------------------\r'\r'            'Rapid initial adjustment of PPP sends poverty up in China\r'\r'        meanconsumption11 = AMAX(0.0001, C(R%) * RatioGDP2011to2005GDP(R%) / AMAX(0.0001, POP(R%)) * smpppconv(R%))\r'        LNMean11 = Log(meanconsumption11 * NSNARATFac(R%) * nsnaratm(R%) * 1000) _\r'            - 0.5 * (lnstddev ^ 2)\r'        'bbh 2014/10/18 start\r'        'incomelt1lnpcnt = CalcLogNormalCDF(365 * incpovlev, LNMean11, lnstddev)  'no multiplier\r'        incomelt1lnpcnt = CalcLogNormalCDF(365 * RatioGDP2011to2005GDPUSA1 * incpovlev, LNMean11, lnstddev)  'no multiplier\r'\r'        INCOMELT190LN(R%) = AMAX(0, Amin(0.9 * POP(R%), incomelt1lnpcnt * POP(R%)))\r'\r'        'Compute INCOMELT0.7LN2011 365*0.7=255.5\r'        'incomelt1lnpcnt = CalcLogNormalCDF(255.5, LNMean11, lnstddev)  'no multiplier\r'        incomelt1lnpcnt = CalcLogNormalCDF(255.5 * RatioGDP2011to2005GDPUSA07, LNMean11, lnstddev)  'no multiplier\r'        INCOMELT110LN(R%) = AMAX(0, Amin(0.9 * POP(R%), incomelt1lnpcnt * POP(R%)))\r'        'bbh 2014/10/18 end\r'\r''jrs 2014/05/20 *** end ***\r\r'       All But First 5:  Income Below $1.9, $3.1 ($2011) - Log-Normal Calculation\r'       ---------------------------------------------------------------------------\r\rlnstddev = CSng(Math.Sqrt(2) * CalcNormalInverse((GINIDOM(R%) + 1) / 2))\r"
  },
  {
    "Variable": "INCOMELT320LN",
    "UsesVariable": "PPPCONV",
    "Distance": 29,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT365LN",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT365LN",
    "UsesVariable": "GINIDOM",
    "Distance": 19,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT365LN",
    "UsesVariable": "C",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT365LN",
    "UsesVariable": "PPPCONV",
    "Distance": 60,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT550LN",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT550LN",
    "UsesVariable": "GINIDOM",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT550LN",
    "UsesVariable": "C",
    "Distance": 17,
    "Code": "\r'dkb 2014/07/07 - END\r\r'jrs 2015/11/18 *** begin ***\r''jrs 2014/05/20 *** begin ***\r'\r''   All But First 5:  Income Below $1, $2 - Log-Normal Calculation\r''   -------------------------------------------------------------\r'\r'            'Rapid initial adjustment of PPP sends poverty up in China\r'\r'        meanconsumption11 = AMAX(0.0001, C(R%) * RatioGDP2011to2005GDP(R%) / AMAX(0.0001, POP(R%)) * smpppconv(R%))\r'        LNMean11 = Log(meanconsumption11 * NSNARATFac(R%) * nsnaratm(R%) * 1000) _\r'            - 0.5 * (lnstddev ^ 2)\r'        'bbh 2014/10/18 start\r'        'incomelt1lnpcnt = CalcLogNormalCDF(365 * incpovlev, LNMean11, lnstddev)  'no multiplier\r'        incomelt1lnpcnt = CalcLogNormalCDF(365 * RatioGDP2011to2005GDPUSA1 * incpovlev, LNMean11, lnstddev)  'no multiplier\r'\r'        INCOMELT190LN(R%) = AMAX(0, Amin(0.9 * POP(R%), incomelt1lnpcnt * POP(R%)))\r'\r'        'Compute INCOMELT0.7LN2011 365*0.7=255.5\r'        'incomelt1lnpcnt = CalcLogNormalCDF(255.5, LNMean11, lnstddev)  'no multiplier\r'        incomelt1lnpcnt = CalcLogNormalCDF(255.5 * RatioGDP2011to2005GDPUSA07, LNMean11, lnstddev)  'no multiplier\r'        INCOMELT110LN(R%) = AMAX(0, Amin(0.9 * POP(R%), incomelt1lnpcnt * POP(R%)))\r'        'bbh 2014/10/18 end\r'\r''jrs 2014/05/20 *** end ***\r\r'       All But First 5:  Income Below $1.9, $3.1 ($2011) - Log-Normal Calculation\r'       ---------------------------------------------------------------------------\r\rlnstddev = CSng(Math.Sqrt(2) * CalcNormalInverse((GINIDOM(R%) + 1) / 2))\r"
  },
  {
    "Variable": "INCOMELT550LN",
    "UsesVariable": "PPPCONV",
    "Distance": 32,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT685LN",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT685LN",
    "UsesVariable": "GINIDOM",
    "Distance": 22,
    "Code": "0"
  },
  {
    "Variable": "INCOMELT685LN",
    "UsesVariable": "C",
    "Distance": 21,
    "Code": "\r'mti 2021/07/15 End\r\r'jrs 2022/11/18 *** start ***\r'       All But First 5:  Income Below $2.15, $3.65, $6.85 ($2017) - Log-Normal Calculation\r'       ---------------------------------------------------------------------------\r\rlnstddev = CSng(Math.Sqrt(2) * CalcNormalInverse((GINIDOM(R%) + 1) / 2))\r"
  },
  {
    "Variable": "INCOMELT685LN",
    "UsesVariable": "PPPCONV",
    "Distance": 63,
    "Code": "0"
  },
  {
    "Variable": "INCOMELTNPLLN",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INCOMELTNPLLN",
    "UsesVariable": "povnational",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "INCOMELTNPLLN",
    "UsesVariable": "GINIDOM",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "INCOMELTNPLLN",
    "UsesVariable": "C",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "INCOMELTNPLLN",
    "UsesVariable": "PPPCONV",
    "Distance": 51,
    "Code": "0"
  },
  {
    "Variable": "INDEM",
    "UsesVariable": "AGDEM",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "INDEM",
    "UsesVariable": "FSTOCK",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "INDEM",
    "UsesVariable": "AGP",
    "Distance": 32,
    "Code": "0"
  },
  {
    "Variable": "INDEM",
    "UsesVariable": "AGX",
    "Distance": 31,
    "Code": "\r\r'   First Year:  Profits and Prices\r'   -------------------------------\r\rFor f% = 1 To 3\rFPROFITR(R%, f%) = 1\rsfprofitr(R%, f%) = 1\rSSFProfitR(R%, f%) = 1\rsbalance(R%, f%) = 0\rSBalanceForYl(R%) = 0 'bbh 2022/11/28\rcumstk(R%, f%) = FSTOCK(R%, f%)\rscumstk(R%, f%) = cumstk(R%, f%)\rCumStkNegOK(R%, f%) = FSTOCK(R%, f%) 'bbh 2022/10/27 Added 2 lines allowing Negative Stocks\rSCumStkNegOK(R%, f%) = CumStkNegOK(R%, f%)\rscountryextrasurdef(R%, f%) = 0  'For trade adjustment\rNext f%\r"
  },
  {
    "Variable": "INDEM",
    "UsesVariable": "AGM",
    "Distance": 31,
    "Code": "\r\r'   First Year:  Profits and Prices\r'   -------------------------------\r\rFor f% = 1 To 3\rFPROFITR(R%, f%) = 1\rsfprofitr(R%, f%) = 1\rSSFProfitR(R%, f%) = 1\rsbalance(R%, f%) = 0\rSBalanceForYl(R%) = 0 'bbh 2022/11/28\rcumstk(R%, f%) = FSTOCK(R%, f%)\rscumstk(R%, f%) = cumstk(R%, f%)\rCumStkNegOK(R%, f%) = FSTOCK(R%, f%) 'bbh 2022/10/27 Added 2 lines allowing Negative Stocks\rSCumStkNegOK(R%, f%) = CumStkNegOK(R%, f%)\rscountryextrasurdef(R%, f%) = 0  'For trade adjustment\rNext f%\r"
  },
  {
    "Variable": "INDEM",
    "UsesVariable": "FDEM",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INDEM",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INDEM",
    "UsesVariable": "WAP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INDEM",
    "UsesVariable": "elascd",
    "Distance": 0,
    "Code": "\r\rFor f% = 1 To 3\rswapi(f%) = WAP(f%)\rswxc(f%) = 1\rswmd(f%) = 1\rGlobalSurDefRate(f%) = 0 'bbh 2022/10/27\rSGlobalSurDefRate(f%) = 0 'bbh 2022/11/28\rWTFoodType(f%) = 0 'bbh 2022/10/27 Initialize global trade by food type\rFor R% = 1 To NR%\rWTFoodType(f%) = WTFoodType(f%) + AGX(R%, f%)\rNext R%\rNext f%\r"
  },
  {
    "Variable": "INDEM",
    "UsesVariable": "WEP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INDEM",
    "UsesVariable": "elagind",
    "Distance": 1,
    "Code": "\r'If RegName$(R%) = \"United States of America\" Then Stop\rDim FoodforFuel = ConvergeOverTime(elagind, 0, 50)\r"
  },
  {
    "Variable": "INDEM",
    "UsesVariable": "indemm",
    "Distance": 0,
    "Code": "\rCall XYTABL(\"GDP/Capita (PPP) Versus Industrial Ag Demand/Capita (2010)\",\r            GDPPCP(R%), DComp, context)\r"
  },
  {
    "Variable": "INDEM",
    "UsesVariable": "GDPPCP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "INDIRECTTAX",
    "UsesVariable": "FIRMTAX",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "INDIRECTTAX",
    "UsesVariable": "FIRMGOVSS",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "INDIRECTTAX",
    "UsesVariable": "FIRMEARN",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "INDIRECTTAX",
    "UsesVariable": "govrevtrgtval",
    "Distance": 4,
    "Code": "\r\r'        TAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOT(R%))\rPreTAXRA = AMAX(1, PreGOVREV / AMAX(0.0001, GDPPOTRPA(R%)) * 100)\r\r\r'        TAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOT(R%))\rPreTAXRA = AMAX(1, PreGOVREV / AMAX(0.0001, GDPPOTRPA(R%)) * 100)\rCOMPLETE STRUCTURE:End If:6255|\r'If IY% = 2 Then PreTAXRAi(R%) = PreTAXRA\r\rIf govrevtrgtyr > 1 AndAlso govrevtrgtval(R%) > 1 AndAlso PreTAXRA < govrevtrgtval(R%) Then\rTaxTar = PreTAXRA + (govrevtrgtval(R%) - PreTAXRA) / govrevtrgtyr * Amin(IY%, govrevtrgtyr)\rCOMPLETE STRUCTURE:End If:6255|\r'If RegName$(R%) = \"Chad\" And IY% >= 15 Then Stop\rIf PreTAXRA < TaxTar Then\rTaxTarMul = TaxTar / PreTAXRA\r\rINDIRECTTAX(R%) = INDIRECTTAX(R%) * TaxTarMul\r"
  },
  {
    "Variable": "INDIRECTTAX",
    "UsesVariable": "govrevtrgtyr",
    "Distance": 4,
    "Code": "\r\r'        TAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOT(R%))\rPreTAXRA = AMAX(1, PreGOVREV / AMAX(0.0001, GDPPOTRPA(R%)) * 100)\r"
  },
  {
    "Variable": "INDIRECTTAX",
    "UsesVariable": "HHTAX",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "INDIRECTTAX",
    "UsesVariable": "VADD",
    "Distance": 526,
    "Code": "0"
  },
  {
    "Variable": "INDIRECTTAX",
    "UsesVariable": "WP",
    "Distance": 526,
    "Code": "0"
  },
  {
    "Variable": "INDIRECTTAX",
    "UsesVariable": "HHGOVSS",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "INDIRECTTAX",
    "UsesVariable": "HHINCEARN",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INDIRECTTAX",
    "UsesVariable": "INDIRECTTAXR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INDIRECTTAX",
    "UsesVariable": "indirecttaxrm",
    "Distance": 0,
    "Code": "\r\r\r'mti 2016/09/09 Start\r'INDIRECTTAX(R%) = FIRMINC(R%) * INDIRECTTAXR(R%) / 100 * indirecttaxrm(R%) * mulrev(R%) * govrevm(R%)  'bbh 2016/04/05\r'bbh 2021/05/15 start\rINDIRECTTAX(R%) = (FIRMEARN(R%) + HHINCEARN(R%, Skilled) + HHINCEARN(R%, Unskilled)) * INDIRECTTAXR(R%) / 100 * indirecttaxrm(R%) * mulrev(R%) * govrevm(R%) 'bbh 2016/04/05\r"
  },
  {
    "Variable": "INDIRECTTAX",
    "UsesVariable": "govrevm",
    "Distance": 0,
    "Code": "\rmulrev(R%) = 1\r"
  },
  {
    "Variable": "INDIRECTTAXR",
    "UsesVariable": "GDPPCP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "INDIRECTTAXR",
    "UsesVariable": "govrevtrgtval",
    "Distance": 9,
    "Code": "\r\r'        TAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOT(R%))\rPreTAXRA = AMAX(1, PreGOVREV / AMAX(0.0001, GDPPOTRPA(R%)) * 100)\r\r\r'        TAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOT(R%))\rPreTAXRA = AMAX(1, PreGOVREV / AMAX(0.0001, GDPPOTRPA(R%)) * 100)\rCOMPLETE STRUCTURE:End If:6255|\r'If IY% = 2 Then PreTAXRAi(R%) = PreTAXRA\r\rIf govrevtrgtyr > 1 AndAlso govrevtrgtval(R%) > 1 AndAlso PreTAXRA < govrevtrgtval(R%) Then\rTaxTar = PreTAXRA + (govrevtrgtval(R%) - PreTAXRA) / govrevtrgtyr * Amin(IY%, govrevtrgtyr)\rCOMPLETE STRUCTURE:End If:6255|\r'If RegName$(R%) = \"Chad\" And IY% >= 15 Then Stop\rIf PreTAXRA < TaxTar Then\rTaxTarMul = TaxTar / PreTAXRA\r\rINDIRECTTAXR(R%) = INDIRECTTAXR(R%) * TaxTarMul\r"
  },
  {
    "Variable": "INDIRECTTAXR",
    "UsesVariable": "govrevtrgtyr",
    "Distance": 9,
    "Code": "\r\r'        TAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOT(R%))\rPreTAXRA = AMAX(1, PreGOVREV / AMAX(0.0001, GDPPOTRPA(R%)) * 100)\r"
  },
  {
    "Variable": "INDIRECTTAXR",
    "UsesVariable": "HHTAX",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "INDIRECTTAXR",
    "UsesVariable": "FIRMTAX",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "INDIRECTTAXR",
    "UsesVariable": "INDIRECTTAX",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "INDIRECTTAXR",
    "UsesVariable": "VADD",
    "Distance": 531,
    "Code": "0"
  },
  {
    "Variable": "INDIRECTTAXR",
    "UsesVariable": "WP",
    "Distance": 531,
    "Code": "0"
  },
  {
    "Variable": "INDIRECTTAXR",
    "UsesVariable": "HHGOVSS",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "INDIRECTTAXR",
    "UsesVariable": "FIRMGOVSS",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "INDIRECTTAXR",
    "UsesVariable": "taxinfadjm",
    "Distance": 1,
    "Code": "\r'mti 2015/06/09 - end\r'If RegName$(R%) = \"Peru\" And IY% >= 6 Then Stop\r\r'mti 2016/11/02 Start\rTaxInfAdjustmentFac(R%) = CSng(1 + taxinfadjm(R%) * AMAX(-0.5, Amin(0.5, (ExDefInfGDPi(R%) - ExDefInfGDP))))\r\r\rINDIRECTTAXR(R%) = INDIRECTTAXR(R%) * TaxInfAdjustmentFac(R%)\r"
  },
  {
    "Variable": "INDIRECTTAXR",
    "UsesVariable": "GDPSHADOWSHR",
    "Distance": 1944,
    "Code": "0"
  },
  {
    "Variable": "INDIRECTTAXR",
    "UsesVariable": "gdpshadowon",
    "Distance": 1944,
    "Code": "0"
  },
  {
    "Variable": "INFMOR",
    "UsesVariable": "birthmshr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFMOR",
    "UsesVariable": "tmortr2",
    "Distance": 20,
    "Code": "0"
  },
  {
    "Variable": "INFMOR",
    "UsesVariable": "tmortr",
    "Distance": 21,
    "Code": "0"
  },
  {
    "Variable": "INFMOR",
    "UsesVariable": "GDPPCP",
    "Distance": 569,
    "Code": "0"
  },
  {
    "Variable": "INFMOR",
    "UsesVariable": "LIFEXP",
    "Distance": 38,
    "Code": "0"
  },
  {
    "Variable": "INFMOR",
    "UsesVariable": "CIVDM",
    "Distance": 22,
    "Code": "0"
  },
  {
    "Variable": "INFMOR",
    "UsesVariable": "mortm",
    "Distance": 23,
    "Code": "0"
  },
  {
    "Variable": "INFMOR",
    "UsesVariable": "MORTMG",
    "Distance": 23,
    "Code": "0"
  },
  {
    "Variable": "INFMOR",
    "UsesVariable": "POP",
    "Distance": 43,
    "Code": "0"
  },
  {
    "Variable": "INFMOR",
    "UsesVariable": "DEATHS",
    "Distance": 55,
    "Code": "0"
  },
  {
    "Variable": "INFMOR",
    "UsesVariable": "NEONATMOR",
    "Distance": 79,
    "Code": "0"
  },
  {
    "Variable": "INFMOR",
    "UsesVariable": "hlcomaddprev",
    "Distance": 32,
    "Code": "0"
  },
  {
    "Variable": "INFMOR",
    "UsesVariable": "hlcomaddmort",
    "Distance": 33,
    "Code": "0"
  },
  {
    "Variable": "INFMOR",
    "UsesVariable": "hlmortcdadltm",
    "Distance": 37,
    "Code": "0"
  },
  {
    "Variable": "INFMOR",
    "UsesVariable": "hlmortcdchldm",
    "Distance": 39,
    "Code": "0"
  },
  {
    "Variable": "INFMOR",
    "UsesVariable": "hlmortm",
    "Distance": 41,
    "Code": "0"
  },
  {
    "Variable": "INFMOR",
    "UsesVariable": "hlvehsw",
    "Distance": 50,
    "Code": "0"
  },
  {
    "Variable": "infmormax",
    "UsesVariable": "INFMOR",
    "Distance": 30,
    "Code": "\r\r'mti August 2017 End\r'mti 2017/12/27 End\r\rFor R% = 1 To NR%  'Targets on these indicators may increase\r\rinfmormin = Amin(INFMOR(R%), infmormin)\r'mti LifeExp/ gender May 2006\rLifExpMaxHDI = AMAX(LIFEXP(R%, 3), LifExpMaxHDI)\r'        lifexpmax = AMAX(LIFEXP(R%), lifexpmax)\rGDPPCPMAX = AMAX(GDPPCP(R%), GDPPCPMAX)\r\r\r'        EdYrs25Max = AMAX(EDYRSAG25(R%, 3), EdYrs25Max)\r'        EdYrsSLEMax = AMAX(EDYRSSLE(R%), EdYrsSLEMax)\r\rNext R%\r\r'        PQLILife = (LIFEXP(R%) - lifexpmin) / (lifexpmax - lifexpmin) * 100\rinfmormax = AMAX(infmormax, infmormin + 1)\r"
  },
  {
    "Variable": "INFRABUDDEMMNT",
    "UsesVariable": "infrainvmaintpubshrm",
    "Distance": 0,
    "Code": "\rImports System\rImports System.Collections.Generic\rImports System.IO\rImports System.Linq\rImports IFs.Data\rImports IFs.Data.ProducerScope\rImports System.Math\r\rNamespace Models\r\rPartial Public Module SocioPol\r'-------------------------------------------------------------------------------------------------------------------\r'International Futures System (IFs) - General Public License (GPL) Declaration\r'-------------------------------------------------------------------------------------------------------------------\r'\r'\r'    Copyright 1988-2012 Barry B. Hughes\r'\r'\r'    This file is part of International Futures (IFs) developed by Barry B. Hughes, bhughes@du.edu\r'\r'    IFs is free software: you can redistribute it and/or modify\r'    it under the terms of the GNU General Public License as published by\r'    the Free Software Foundation, either version 3 of the License, or\r'    (at your option) any later version.\r'\r'    IFs is distributed in the hope that it will be useful,\r'    but WITHOUT ANY WARRANTY; without even the implied warranty of\r'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r'    GNU General Public License for more details.\r'\r'    You should have received a copy of the GNU General Public License\r'    along with International Futures System Development Version. If not, please see http://www.gnu.org/licenses/\r'\r'    Developers of International Futures System are required to send the modified code to the IFs core team\r'    Developers should send such code updates, if any, twice every year, on April 1st and on October 1st\r'    Code updates should be sent to Frederick S. Pardee Center for International Futures (contact: pardee@du.edu)\r'-------------------------------------------------------------------------------------------------------------------\r'------------------------------------------------------------------------------------------\r'\r\r'\"Live as if you were to die tommorrow.\"  Popular\r'\"Learn as if you were to live forever.\"  Gandhi\r'\r'\"The future is alwlays present, as a promise, a lure, and a temptation.\"\r'   Karl Popper\r'\r'   Copyright by Barry B. Hughes 1988-2012\r'   Model code available for review and education only\r'   Reproduction or incorporation in other software by permission only\r'\r\r'   Government expenditure categories:\r'       1.  Military\r'       2.  Health\r'       3.  Education\r'       4.  Research and development\r'       5.  Other (including administrative)\r'       6.  Foreign Aid\r\r'Public SSFINTLWARMAG() As Single\r\rDim SCPOW() As Single, SNPOW() As Single, SGDSMil() As Single\r\rDim swatres() As Single 'jrs 2019/10/22\r'clp 2016/08/26 - Adding GDS R&D\rDim SGDSRandD() As Single\rDim SWCPOW As Single, SWNPOW As Single, WGDSMIL As Single, WGDSRandD As Single, WGOV As Single, WGDPPPP As Single, WTECHP As Single, WTECH As Single\r'jrs 2020/11/19\rDim WTECHmix As Single\r\r'dkb 2013/09/09 creating components for world DPI\rDim WDPIBN As Single, WDPIMN As Single, WDPIILN As Single, WDPI As Single\r\r'dkb 2014/07/07 adding world Effective Human Capital component for POWER\rDim WEHC As Single\r\r'jrs 2011/10/11 GPI\rDim WGOVNUCWP As Single, WConvMilSpend As Single, WENX As Single, WENM As Single, WTradeTotal As Single, WXFDIFIN As Single\rDim WAID As Single, WHumCapWkPopHDI As Single, WGOVREV As Single, WInnovationRD As Single, WConnectivityICTProd As Single\r\r'dkb 2014/10/23 - new EnergyNetExport specification - START\rDim WENXM As Single\r'clp 2016/08/25 - Adding world energy production variable\rDim WENProd As Single\r'dkb 2014/10/23 - new EnergyNetExport specification - END\r\r'dkb 2014/08/06 - adding save variables for Diplometrics POWER component calculation - START\rPublic SDIPLOEMBASSY() As Single, SDIPLOIGO() As Single, SDIPLOTREATY() As Single 'jrs 2017/05/22 changed to public\r'Dim SDIPLOEMBASSYMAX, SDIPLOIGOMAX, SDIPLOTREATYMAX\r'dkb 2014/08/06 - END\r\r'jrs 2022/04/20\rPublic SDIPLOEMBASSY2() As Single\r\r\r'mti April 2010 - Infrastructure Consolidation -start\r'jrs 2009/02/25\r'Dim MOBILshift(), BROADshift() As Double\r'jrs 2009/02/26\r'Dim ICTIndexShift()\r'jrs 2009/02/27\r'Dim SMobil()\r'jrs 2009/06/08\r'Public SBroad() As Double\r'jrs 2009/05/18\r'Dim SPENDshift()\r\r'jrs 2009/05/28\r'Dim SGOVREGQUAL()\rPublic SGOVREGQUAL() As Single\r\r\r\r'mti February 2011 Infarstructure - start\r'The following adjustment factor is needed in Infrastr Module\rPublic InfraCostGDSInfraRI() As Single\rPublic sHlthExpPcntGDP() As Single\r'mti February 2011 Infarstructure - end\r\r'dkb 2018/05/09 'Declarations for drug model\rDim drugtotalest() As Single\rDim sdrugtotalest() As Single\rDim DrugAmphetamineEst() As Single, DrugCocaineEst() As Single, DrugOpiateEst() As Single, DrugPrescriptionOpioidEst() As Single, DrugEstTot() As Single\rDim sDrugAmphetamineEst() As Single, sDrugCocaineEst() As Single, sDrugOpiateEst() As Single, sDrugPrescriptionOpioidEst() As Single, sDrugEstTot() As Single\rDim SDRUGUSEAMPHETAMINE() As Single, SDRUGUSECOCAINE() As Single, SDRUGUSEOPIATES() As Single, SDRUGUSEPRESCRIPTOPIOID() As Single\rDim iDrugUseAmphetamine() As Single, iDrugUseCocaine() As Single, iDrugUseOpiates() As Single, iDrugUsePrescriptOpioid() As Single, iDrugUseTot() As Single\rDim iDrugAmphetamineEst() As Single, iDrugCocaineEst() As Single, iDrugOpiateEst(), iDrugPrescriptionOpioidEst() As Single, iDrugEstTot() As Single\rDim hhconpc() As Single, shhconpc() As Single\r'kbn 2018/09/25- Start-\rDim MaxHomicides As Single\r'kbn 2018/09/25- END-\r\r\r'jrs 2009/06/05\r'Dim SICTBroadExp() As Double\r'Dim ICTBroadExpShift() As Double\r'Dim ICTSpendExpShift() As Double\r'Dim GovRegQualShift() As Double\rPublic GovRegQualShift() As Single\r\r'Public ICTBroadExp() As Double\r\r'Dim GOVREGQUALExp() As Double\rPublic GOVREGQUALExp() As Single\r'mti April 2010 - Infrastructure Consolidation -end\r\r'jrs 2011/01/11\rDim GOVRISKMAX() As Single, GOVRISKMIN() As Single, GOVRISKNAME() As String, GOVRISKSIGN() As Single\r'jrs 2011/02/14 *** begin Embeddedness ***\rDim GOVEMBEDShift() As Single, SGOVEMBED() As Single\r'jrs 2011/02/14 *** end Embeddedness ***\r\r\r\r'JAM 2019-08-09\r' Dim dbD As Database, tblK As Recordset, tblR As Recordset, tblC As Recordset\r\r'jrs 2011/10/11\rDim SRANDDEXP() As Single, SGOVNUCWP() As Single\r\r\r'JAM 2019-08-09\r'Dim IFsCtrys As New Collection\r\r\r'jrs 2012/11/05\rDim DIPLOEMBASSYShift() As Single, DIPLOEMBASSYMAXShift As Single\rDim DIPLOIGOShift() As Single, DIPLOIGOMAXShift As Single\rDim DIPLOTREATYShift() As Single, DIPLOTREATYMAXShift As Single\r'jrs 2014/05/26\rPublic PrivExpToCost() As Single\r'jrs 2014/05/30 Dim HLEXPENDPRIVShift() As Single\rDim PrivHLExpPctGDPFxName As String\rDim HlGrTerm() As Single\r'jrs 2016/01/13\rPublic SSFINTLWARMAG() As Single\r'JRS 2016/08/02\rDim HTCGRIShift() As Single, HTCTPIShift() As Single\r'jrs 2017/07/07\rPublic SPOWERGPI() As Single\r'jrs 2022/04/20\rPublic SPOWER() As Single\r'jrs 2017/08/08\rPublic SDEMOCPOLITY() As Single\r'jrs 2018/02/26\rPublic SGOVRISK() As Single\r'dkb 2018/06/01\rPublic SGOVINDSECUR() As Single\rDim svindexmax As Double\r'JAM 2019-08-09 New DEclarations\r\rDim DEMOCPOLITYI() As Single, smdemocpolity() As Single\r'jrs 2023/10/13\rDim DEMOCPOLYARCHYShift() As Single\rPublic SDEMOCPOLYARCHY() As Single\r'Dim SDEMOCPOLYARCHYFX() As Single\r'Dim PolyarchyGR() As Single?\r\rDim swingeffects() As Single, demglobaleffects() As Single\rDim FREEDOMI() As Single, econfreei() As Single, GovEffectAdd() As Single, GovCorruptAdd() As Single\rDim GEMI() As Single, GEMPI() As Single, democcomp() As Single\rDim YTHBULGEI() As Single, gdprmovavg() As Single, ssfintlwarallLoc() As Single, econfreeri() As Single\r'BBH 2011/06/18\rDim energydepend() As Single, ContiguityIntlWarAddI() As Single\rDim democpolityri() As Single\rDim snumnwp() As Single, INUMNWP() As Single, inumnwpgr() As Single, numnwpmin() As Single\rDim SFINSTABALLRI() As Single, SFINSTABMAGRI() As Single, SFINSTABY1RI() As Single\r'BBH 2011/06/18\rDim SFINTLWARALLADD() As Single, SFINTLWARMAGRI() As Single, SFINTLWARY1RI() As Single\r'jrs 2024/05/17\rDim ssfcivilwarUCDPLoc() As Single, SFCIVILWARUCDPADD() As Single, SFCIVILWARUCDPI() As Single\r'bbh 2011/09/21\rDim SFINTLWARALLI() As Single, SFINTLWARMAGI() As Single\rDim SFPredictionI() As Single\rDim SSURVSEI(,) As Single\rDim SwingStsDemoc(9) As Single, SwingStsNumb(9) As Single, sedyrsag15() As Single, EDYRSAG15I() As Single\r'bbh 2011/08/19\rDim sedyrsag15fem() As Single, EDYRSAG15FemI() As Single\rDim RandDExpScale() As Single, RAndDExpI() As Single, EdTerGRateScale() As Single, EdTerGRateI() As Single\r'jrs 2009/04/22\rDim GovRegQualAdd() As Single\r\r'mti 2014/11/14 -start\rDim GovBusCostShift() As Single\r'mti 2014/11/14 - end\r\r'mti 2015/03/04 - start\rDim GovBusRegIndShift() As Single\rDim PoliceShift() As Single, ConflictShift() As Single, SelfHarmShift() As Single, HomicideShift() As Single, WomenandChilshift() As Single, SSVDTHSSELFHARM() As Single, SSVDTHSPOLICS() As Single, Womenshift() As Single, ChilShift() As Single, SelfHarmEstimate() As Single, sSelfHarmEstimate() As Single\rDim SSVDTHSCONFLICT() As Single, SSVDTHSOTHERINTERPERSON() As Single, SSVDTHSWOMENCHILDREN() As Single, SSOCIETALVIOLENCEDEATHS() As Single, SHOMICIDEINDEX() As Single, SSVDTHSWOMEN() As Single, SSVDTHSCHIL() As Single\rDim PoliceEstimate() As Single, ConflictEstimate() As Single, HomicideEstimate() As Single, WomenandChilEstimate() As Single\rDim sPoliceEstimate() As Single, sConflictEstimate() As Single, sWomenandChilEstimate() As Single, sHomicideEstimate() As Single\rDim GIIShift() As Single, GIII() As Single 'jrs 2020/03/23\rDim DemocWaveI As Single\rDim SDEMOCWAVE As Single\rDim SDEMOCWVCOUNT As Single\rDim SDEMOCWVDIR As Single\rDim educ15term As Single\rDim AdultMaleTerm As Double\rDim WomenTerm As Double\rDim ChildrenTerm As Double\rDim poptotalterm As Double\rDim MatPostRAdj() As Double, TradSRatAdj() As Double, SurvSEAdj() As Double\rDim SMATPOSTR(,) As Single, MatPostRI(,) As Single\rDim SSURVSE(,) As Single, SURVSEI(,) As Single\rDim STradSRat(,) As Single, TRADSRATI(,) As Single\rDim POWERI() As Single\rDim gkmul() As Single, milspendrati() As Single, LenWar(,) As Single, PowerTranTermI(,) As Single\rDim AllyI(,) As Single\rDim nowarper(,) As Single, gpowertermI(,) As Single, TerDisputeI(,) As Single\rDim ThreatIData(,) As Single, ThreatIPred(,) As Single\rDim WarGDPOwn() As Single, WarGDPOpp() As Single, WarCPOWOwn() As Single, WarCPOWOpp() As Single\rDim WarNPOWOwn() As Single, WarNPOWOpp() As Single, CPOWDM() As Single, NPOWDM() As Single\rDim gk(,) As Single, gkri(,) As Single, gkcomp() As Single, healthgdpri() As Single, RandDI() As Single\r'jrs 2021/09/09\rDim educgdpri() As Single\r\rDim sumthreatI() As Single ', SGDSMil() As Single\rDim govconwb() As Single, gdswb(,) As Single, RandDExpSh() As Single\r'BBH 4/16/04  V5.0\rDim SMORTMG() As Single\r'mti January 06, 2009\rDim EdCostGDSEdRI() As Single, SEdTotCost() As Single, EdCostGDSEdRIShift() As Single\r'mti January 06, 2009\r'Dim InfraCostGDSInfraRI() As Single, ,\rDim sInfraTotCost() As Single, InfraCostGDSInfraRIShift() As Single\rDim DIPLOINGOPROGRAMShift() As Single, DIPLOINGOADVOCACYShift() As Single\rDim UKcol() As Single, FRAcol() As Single, GERcol() As Single, PORcol() As Single\rDim SPAcol() As Single, NETcol() As Single, RUScol() As Single\r'mti 2016/07/16 Target value in GDS%GDP start\r'Declare array variable for saving initial values and target GDS values (when targeting is set as a parameter)\rDim igk(,) As Single, GDSTrgt(,) As Single\rDim gdssetaside() As Single\rDim GOVEMBEDGR() As Single?\rDim SWGDP As Single\rDim GLOCOMI As Single\rDim PConGreatI As Single\r' Dim CalcInfraBudgetDemand() As Single\rDim InfrabudallocNew() As Single\rDim InfrabudallocMnt() As Single\r'Public sedyrsag15(,) As Single 'JAM 2019-08-21\rPublic SGEM() As Single\r\rPrivate Function CalcInfraBudgetDemand(R As Int32) As Single\r'mti April 2011 - change whole proc\r\r'Estimate public portion of the infrastructure investment and sum to a total budget demand\rDim InfCt%\r\rINFRABUDDEMMNT(R%, InfraTot) = 0\rINFRABUDDEMNEW(R%, InfraTot) = 0\r\rCalcInfraBudgetDemand = 0\r\rFor InfCt% = 1 To NInfraType%\rINFRABUDDEMNEW(R%, InfCt%) = infrainvnewpubshrm(R%, InfCt%) * INFRAINVESTNEW(R%, InfCt%)\rINFRABUDDEMMNT(R%, InfCt%) = infrainvmaintpubshrm(R%, InfCt%) * INFRAINVESTMAINT(R%, InfCt%)\rCalcInfraBudgetDemand = CalcInfraBudgetDemand + INFRABUDDEMNEW(R%, InfCt%) + INFRABUDDEMMNT(R%, InfCt%)  'billion dollars\rINFRABUDDEMNEW(R%, InfraTot) = INFRABUDDEMNEW(R%, InfraTot) + INFRABUDDEMNEW(R%, InfCt%)\rINFRABUDDEMMNT(R%, InfraTot) = INFRABUDDEMMNT(R%, InfraTot) + INFRABUDDEMMNT(R%, InfCt%)\rNext InfCt%\r'mti April 2011 - end\rEnd Function\r\rImports System\rImports System.Collections.Generic\rImports System.IO\rImports System.Linq\rImports IFs.Data\rImports IFs.Data.ProducerScope\rImports System.Math\r\rNamespace Models\r\rPartial Public Module SocioPol\r'-------------------------------------------------------------------------------------------------------------------\r'International Futures System (IFs) - General Public License (GPL) Declaration\r'-------------------------------------------------------------------------------------------------------------------\r'\r'\r'    Copyright 1988-2012 Barry B. Hughes\r'\r'\r'    This file is part of International Futures (IFs) developed by Barry B. Hughes, bhughes@du.edu\r'\r'    IFs is free software: you can redistribute it and/or modify\r'    it under the terms of the GNU General Public License as published by\r'    the Free Software Foundation, either version 3 of the License, or\r'    (at your option) any later version.\r'\r'    IFs is distributed in the hope that it will be useful,\r'    but WITHOUT ANY WARRANTY; without even the implied warranty of\r'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r'    GNU General Public License for more details.\r'\r'    You should have received a copy of the GNU General Public License\r'    along with International Futures System Development Version. If not, please see http://www.gnu.org/licenses/\r'\r'    Developers of International Futures System are required to send the modified code to the IFs core team\r'    Developers should send such code updates, if any, twice every year, on April 1st and on October 1st\r'    Code updates should be sent to Frederick S. Pardee Center for International Futures (contact: pardee@du.edu)\r'-------------------------------------------------------------------------------------------------------------------\r'------------------------------------------------------------------------------------------\r'\r\r'\"Live as if you were to die tommorrow.\"  Popular\r'\"Learn as if you were to live forever.\"  Gandhi\r'\r'\"The future is alwlays present, as a promise, a lure, and a temptation.\"\r'   Karl Popper\r'\r'   Copyright by Barry B. Hughes 1988-2012\r'   Model code available for review and education only\r'   Reproduction or incorporation in other software by permission only\r'\r\r'   Government expenditure categories:\r'       1.  Military\r'       2.  Health\r'       3.  Education\r'       4.  Research and development\r'       5.  Other (including administrative)\r'       6.  Foreign Aid\r\r'Public SSFINTLWARMAG() As Single\r\rDim SCPOW() As Single, SNPOW() As Single, SGDSMil() As Single\r\rDim swatres() As Single 'jrs 2019/10/22\r'clp 2016/08/26 - Adding GDS R&D\rDim SGDSRandD() As Single\rDim SWCPOW As Single, SWNPOW As Single, WGDSMIL As Single, WGDSRandD As Single, WGOV As Single, WGDPPPP As Single, WTECHP As Single, WTECH As Single\r'jrs 2020/11/19\rDim WTECHmix As Single\r\r'dkb 2013/09/09 creating components for world DPI\rDim WDPIBN As Single, WDPIMN As Single, WDPIILN As Single, WDPI As Single\r\r'dkb 2014/07/07 adding world Effective Human Capital component for POWER\rDim WEHC As Single\r\r'jrs 2011/10/11 GPI\rDim WGOVNUCWP As Single, WConvMilSpend As Single, WENX As Single, WENM As Single, WTradeTotal As Single, WXFDIFIN As Single\rDim WAID As Single, WHumCapWkPopHDI As Single, WGOVREV As Single, WInnovationRD As Single, WConnectivityICTProd As Single\r\r'dkb 2014/10/23 - new EnergyNetExport specification - START\rDim WENXM As Single\r'clp 2016/08/25 - Adding world energy production variable\rDim WENProd As Single\r'dkb 2014/10/23 - new EnergyNetExport specification - END\r\r'dkb 2014/08/06 - adding save variables for Diplometrics POWER component calculation - START\rPublic SDIPLOEMBASSY() As Single, SDIPLOIGO() As Single, SDIPLOTREATY() As Single 'jrs 2017/05/22 changed to public\r'Dim SDIPLOEMBASSYMAX, SDIPLOIGOMAX, SDIPLOTREATYMAX\r'dkb 2014/08/06 - END\r\r'jrs 2022/04/20\rPublic SDIPLOEMBASSY2() As Single\r\r\r'mti April 2010 - Infrastructure Consolidation -start\r'jrs 2009/02/25\r'Dim MOBILshift(), BROADshift() As Double\r'jrs 2009/02/26\r'Dim ICTIndexShift()\r'jrs 2009/02/27\r'Dim SMobil()\r'jrs 2009/06/08\r'Public SBroad() As Double\r'jrs 2009/05/18\r'Dim SPENDshift()\r\r'jrs 2009/05/28\r'Dim SGOVREGQUAL()\rPublic SGOVREGQUAL() As Single\r\r\r\r'mti February 2011 Infarstructure - start\r'The following adjustment factor is needed in Infrastr Module\rPublic InfraCostGDSInfraRI() As Single\rPublic sHlthExpPcntGDP() As Single\r'mti February 2011 Infarstructure - end\r\r'dkb 2018/05/09 'Declarations for drug model\rDim drugtotalest() As Single\rDim sdrugtotalest() As Single\rDim DrugAmphetamineEst() As Single, DrugCocaineEst() As Single, DrugOpiateEst() As Single, DrugPrescriptionOpioidEst() As Single, DrugEstTot() As Single\rDim sDrugAmphetamineEst() As Single, sDrugCocaineEst() As Single, sDrugOpiateEst() As Single, sDrugPrescriptionOpioidEst() As Single, sDrugEstTot() As Single\rDim SDRUGUSEAMPHETAMINE() As Single, SDRUGUSECOCAINE() As Single, SDRUGUSEOPIATES() As Single, SDRUGUSEPRESCRIPTOPIOID() As Single\rDim iDrugUseAmphetamine() As Single, iDrugUseCocaine() As Single, iDrugUseOpiates() As Single, iDrugUsePrescriptOpioid() As Single, iDrugUseTot() As Single\rDim iDrugAmphetamineEst() As Single, iDrugCocaineEst() As Single, iDrugOpiateEst(), iDrugPrescriptionOpioidEst() As Single, iDrugEstTot() As Single\rDim hhconpc() As Single, shhconpc() As Single\r'kbn 2018/09/25- Start-\rDim MaxHomicides As Single\r'kbn 2018/09/25- END-\r\r\r'jrs 2009/06/05\r'Dim SICTBroadExp() As Double\r'Dim ICTBroadExpShift() As Double\r'Dim ICTSpendExpShift() As Double\r'Dim GovRegQualShift() As Double\rPublic GovRegQualShift() As Single\r\r'Public ICTBroadExp() As Double\r\r'Dim GOVREGQUALExp() As Double\rPublic GOVREGQUALExp() As Single\r'mti April 2010 - Infrastructure Consolidation -end\r\r'jrs 2011/01/11\rDim GOVRISKMAX() As Single, GOVRISKMIN() As Single, GOVRISKNAME() As String, GOVRISKSIGN() As Single\r'jrs 2011/02/14 *** begin Embeddedness ***\rDim GOVEMBEDShift() As Single, SGOVEMBED() As Single\r'jrs 2011/02/14 *** end Embeddedness ***\r\r\r\r'JAM 2019-08-09\r' Dim dbD As Database, tblK As Recordset, tblR As Recordset, tblC As Recordset\r\r'jrs 2011/10/11\rDim SRANDDEXP() As Single, SGOVNUCWP() As Single\r\r\r'JAM 2019-08-09\r'Dim IFsCtrys As New Collection\r\r\r'jrs 2012/11/05\rDim DIPLOEMBASSYShift() As Single, DIPLOEMBASSYMAXShift As Single\rDim DIPLOIGOShift() As Single, DIPLOIGOMAXShift As Single\rDim DIPLOTREATYShift() As Single, DIPLOTREATYMAXShift As Single\r'jrs 2014/05/26\rPublic PrivExpToCost() As Single\r'jrs 2014/05/30 Dim HLEXPENDPRIVShift() As Single\rDim PrivHLExpPctGDPFxName As String\rDim HlGrTerm() As Single\r'jrs 2016/01/13\rPublic SSFINTLWARMAG() As Single\r'JRS 2016/08/02\rDim HTCGRIShift() As Single, HTCTPIShift() As Single\r'jrs 2017/07/07\rPublic SPOWERGPI() As Single\r'jrs 2022/04/20\rPublic SPOWER() As Single\r'jrs 2017/08/08\rPublic SDEMOCPOLITY() As Single\r'jrs 2018/02/26\rPublic SGOVRISK() As Single\r'dkb 2018/06/01\rPublic SGOVINDSECUR() As Single\rDim svindexmax As Double\r'JAM 2019-08-09 New DEclarations\r\rDim DEMOCPOLITYI() As Single, smdemocpolity() As Single\r'jrs 2023/10/13\rDim DEMOCPOLYARCHYShift() As Single\rPublic SDEMOCPOLYARCHY() As Single\r'Dim SDEMOCPOLYARCHYFX() As Single\r'Dim PolyarchyGR() As Single?\r\rDim swingeffects() As Single, demglobaleffects() As Single\rDim FREEDOMI() As Single, econfreei() As Single, GovEffectAdd() As Single, GovCorruptAdd() As Single\rDim GEMI() As Single, GEMPI() As Single, democcomp() As Single\rDim YTHBULGEI() As Single, gdprmovavg() As Single, ssfintlwarallLoc() As Single, econfreeri() As Single\r'BBH 2011/06/18\rDim energydepend() As Single, ContiguityIntlWarAddI() As Single\rDim democpolityri() As Single\rDim snumnwp() As Single, INUMNWP() As Single, inumnwpgr() As Single, numnwpmin() As Single\rDim SFINSTABALLRI() As Single, SFINSTABMAGRI() As Single, SFINSTABY1RI() As Single\r'BBH 2011/06/18\rDim SFINTLWARALLADD() As Single, SFINTLWARMAGRI() As Single, SFINTLWARY1RI() As Single\r'jrs 2024/05/17\rDim ssfcivilwarUCDPLoc() As Single, SFCIVILWARUCDPADD() As Single, SFCIVILWARUCDPI() As Single\r'bbh 2011/09/21\rDim SFINTLWARALLI() As Single, SFINTLWARMAGI() As Single\rDim SFPredictionI() As Single\rDim SSURVSEI(,) As Single\rDim SwingStsDemoc(9) As Single, SwingStsNumb(9) As Single, sedyrsag15() As Single, EDYRSAG15I() As Single\r'bbh 2011/08/19\rDim sedyrsag15fem() As Single, EDYRSAG15FemI() As Single\rDim RandDExpScale() As Single, RAndDExpI() As Single, EdTerGRateScale() As Single, EdTerGRateI() As Single\r'jrs 2009/04/22\rDim GovRegQualAdd() As Single\r\r'mti 2014/11/14 -start\rDim GovBusCostShift() As Single\r'mti 2014/11/14 - end\r\r'mti 2015/03/04 - start\rDim GovBusRegIndShift() As Single\rDim PoliceShift() As Single, ConflictShift() As Single, SelfHarmShift() As Single, HomicideShift() As Single, WomenandChilshift() As Single, SSVDTHSSELFHARM() As Single, SSVDTHSPOLICS() As Single, Womenshift() As Single, ChilShift() As Single, SelfHarmEstimate() As Single, sSelfHarmEstimate() As Single\rDim SSVDTHSCONFLICT() As Single, SSVDTHSOTHERINTERPERSON() As Single, SSVDTHSWOMENCHILDREN() As Single, SSOCIETALVIOLENCEDEATHS() As Single, SHOMICIDEINDEX() As Single, SSVDTHSWOMEN() As Single, SSVDTHSCHIL() As Single\rDim PoliceEstimate() As Single, ConflictEstimate() As Single, HomicideEstimate() As Single, WomenandChilEstimate() As Single\rDim sPoliceEstimate() As Single, sConflictEstimate() As Single, sWomenandChilEstimate() As Single, sHomicideEstimate() As Single\rDim GIIShift() As Single, GIII() As Single 'jrs 2020/03/23\rDim DemocWaveI As Single\rDim SDEMOCWAVE As Single\rDim SDEMOCWVCOUNT As Single\rDim SDEMOCWVDIR As Single\rDim educ15term As Single\rDim AdultMaleTerm As Double\rDim WomenTerm As Double\rDim ChildrenTerm As Double\rDim poptotalterm As Double\rDim MatPostRAdj() As Double, TradSRatAdj() As Double, SurvSEAdj() As Double\rDim SMATPOSTR(,) As Single, MatPostRI(,) As Single\rDim SSURVSE(,) As Single, SURVSEI(,) As Single\rDim STradSRat(,) As Single, TRADSRATI(,) As Single\rDim POWERI() As Single\rDim gkmul() As Single, milspendrati() As Single, LenWar(,) As Single, PowerTranTermI(,) As Single\rDim AllyI(,) As Single\rDim nowarper(,) As Single, gpowertermI(,) As Single, TerDisputeI(,) As Single\rDim ThreatIData(,) As Single, ThreatIPred(,) As Single\rDim WarGDPOwn() As Single, WarGDPOpp() As Single, WarCPOWOwn() As Single, WarCPOWOpp() As Single\rDim WarNPOWOwn() As Single, WarNPOWOpp() As Single, CPOWDM() As Single, NPOWDM() As Single\rDim gk(,) As Single, gkri(,) As Single, gkcomp() As Single, healthgdpri() As Single, RandDI() As Single\r'jrs 2021/09/09\rDim educgdpri() As Single\r\rDim sumthreatI() As Single ', SGDSMil() As Single\rDim govconwb() As Single, gdswb(,) As Single, RandDExpSh() As Single\r'BBH 4/16/04  V5.0\rDim SMORTMG() As Single\r'mti January 06, 2009\rDim EdCostGDSEdRI() As Single, SEdTotCost() As Single, EdCostGDSEdRIShift() As Single\r'mti January 06, 2009\r'Dim InfraCostGDSInfraRI() As Single, ,\rDim sInfraTotCost() As Single, InfraCostGDSInfraRIShift() As Single\rDim DIPLOINGOPROGRAMShift() As Single, DIPLOINGOADVOCACYShift() As Single\rDim UKcol() As Single, FRAcol() As Single, GERcol() As Single, PORcol() As Single\rDim SPAcol() As Single, NETcol() As Single, RUScol() As Single\r'mti 2016/07/16 Target value in GDS%GDP start\r'Declare array variable for saving initial values and target GDS values (when targeting is set as a parameter)\rDim igk(,) As Single, GDSTrgt(,) As Single\rDim gdssetaside() As Single\rDim GOVEMBEDGR() As Single?\rDim SWGDP As Single\rDim GLOCOMI As Single\rDim PConGreatI As Single\r' Dim CalcInfraBudgetDemand() As Single\rDim InfrabudallocNew() As Single\rDim InfrabudallocMnt() As Single\r'Public sedyrsag15(,) As Single 'JAM 2019-08-21\rPublic SGEM() As Single\r\rPrivate Function CalcInfraBudgetDemand(R As Int32) As Single\r'mti April 2011 - change whole proc\r\r'Estimate public portion of the infrastructure investment and sum to a total budget demand\rDim InfCt%\r\rINFRABUDDEMMNT(R%, InfraTot) = 0\rINFRABUDDEMNEW(R%, InfraTot) = 0\r\rCalcInfraBudgetDemand = 0\r\rFor InfCt% = 1 To NInfraType%\rINFRABUDDEMNEW(R%, InfCt%) = infrainvnewpubshrm(R%, InfCt%) * INFRAINVESTNEW(R%, InfCt%)\rINFRABUDDEMMNT(R%, InfCt%) = infrainvmaintpubshrm(R%, InfCt%) * INFRAINVESTMAINT(R%, InfCt%)\rCalcInfraBudgetDemand = CalcInfraBudgetDemand + INFRABUDDEMNEW(R%, InfCt%) + INFRABUDDEMMNT(R%, InfCt%)  'billion dollars\rINFRABUDDEMNEW(R%, InfraTot) = INFRABUDDEMNEW(R%, InfraTot) + INFRABUDDEMNEW(R%, InfCt%)\rINFRABUDDEMMNT(R%, InfraTot) = INFRABUDDEMMNT(R%, InfraTot) + INFRABUDDEMMNT(R%, InfCt%)\rNext InfCt%\r'mti April 2011 - end\rEnd Function\r"
  },
  {
    "Variable": "INFRABUDDEMMNT",
    "UsesVariable": "INFRAINVESTMAINT",
    "Distance": 0,
    "Code": "\rImports System\rImports System.Collections.Generic\rImports System.IO\rImports System.Linq\rImports IFs.Data\rImports IFs.Data.ProducerScope\rImports System.Math\r\rNamespace Models\r\rPartial Public Module SocioPol\r'-------------------------------------------------------------------------------------------------------------------\r'International Futures System (IFs) - General Public License (GPL) Declaration\r'-------------------------------------------------------------------------------------------------------------------\r'\r'\r'    Copyright 1988-2012 Barry B. Hughes\r'\r'\r'    This file is part of International Futures (IFs) developed by Barry B. Hughes, bhughes@du.edu\r'\r'    IFs is free software: you can redistribute it and/or modify\r'    it under the terms of the GNU General Public License as published by\r'    the Free Software Foundation, either version 3 of the License, or\r'    (at your option) any later version.\r'\r'    IFs is distributed in the hope that it will be useful,\r'    but WITHOUT ANY WARRANTY; without even the implied warranty of\r'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r'    GNU General Public License for more details.\r'\r'    You should have received a copy of the GNU General Public License\r'    along with International Futures System Development Version. If not, please see http://www.gnu.org/licenses/\r'\r'    Developers of International Futures System are required to send the modified code to the IFs core team\r'    Developers should send such code updates, if any, twice every year, on April 1st and on October 1st\r'    Code updates should be sent to Frederick S. Pardee Center for International Futures (contact: pardee@du.edu)\r'-------------------------------------------------------------------------------------------------------------------\r'------------------------------------------------------------------------------------------\r'\r\r'\"Live as if you were to die tommorrow.\"  Popular\r'\"Learn as if you were to live forever.\"  Gandhi\r'\r'\"The future is alwlays present, as a promise, a lure, and a temptation.\"\r'   Karl Popper\r'\r'   Copyright by Barry B. Hughes 1988-2012\r'   Model code available for review and education only\r'   Reproduction or incorporation in other software by permission only\r'\r\r'   Government expenditure categories:\r'       1.  Military\r'       2.  Health\r'       3.  Education\r'       4.  Research and development\r'       5.  Other (including administrative)\r'       6.  Foreign Aid\r\r'Public SSFINTLWARMAG() As Single\r\rDim SCPOW() As Single, SNPOW() As Single, SGDSMil() As Single\r\rDim swatres() As Single 'jrs 2019/10/22\r'clp 2016/08/26 - Adding GDS R&D\rDim SGDSRandD() As Single\rDim SWCPOW As Single, SWNPOW As Single, WGDSMIL As Single, WGDSRandD As Single, WGOV As Single, WGDPPPP As Single, WTECHP As Single, WTECH As Single\r'jrs 2020/11/19\rDim WTECHmix As Single\r\r'dkb 2013/09/09 creating components for world DPI\rDim WDPIBN As Single, WDPIMN As Single, WDPIILN As Single, WDPI As Single\r\r'dkb 2014/07/07 adding world Effective Human Capital component for POWER\rDim WEHC As Single\r\r'jrs 2011/10/11 GPI\rDim WGOVNUCWP As Single, WConvMilSpend As Single, WENX As Single, WENM As Single, WTradeTotal As Single, WXFDIFIN As Single\rDim WAID As Single, WHumCapWkPopHDI As Single, WGOVREV As Single, WInnovationRD As Single, WConnectivityICTProd As Single\r\r'dkb 2014/10/23 - new EnergyNetExport specification - START\rDim WENXM As Single\r'clp 2016/08/25 - Adding world energy production variable\rDim WENProd As Single\r'dkb 2014/10/23 - new EnergyNetExport specification - END\r\r'dkb 2014/08/06 - adding save variables for Diplometrics POWER component calculation - START\rPublic SDIPLOEMBASSY() As Single, SDIPLOIGO() As Single, SDIPLOTREATY() As Single 'jrs 2017/05/22 changed to public\r'Dim SDIPLOEMBASSYMAX, SDIPLOIGOMAX, SDIPLOTREATYMAX\r'dkb 2014/08/06 - END\r\r'jrs 2022/04/20\rPublic SDIPLOEMBASSY2() As Single\r\r\r'mti April 2010 - Infrastructure Consolidation -start\r'jrs 2009/02/25\r'Dim MOBILshift(), BROADshift() As Double\r'jrs 2009/02/26\r'Dim ICTIndexShift()\r'jrs 2009/02/27\r'Dim SMobil()\r'jrs 2009/06/08\r'Public SBroad() As Double\r'jrs 2009/05/18\r'Dim SPENDshift()\r\r'jrs 2009/05/28\r'Dim SGOVREGQUAL()\rPublic SGOVREGQUAL() As Single\r\r\r\r'mti February 2011 Infarstructure - start\r'The following adjustment factor is needed in Infrastr Module\rPublic InfraCostGDSInfraRI() As Single\rPublic sHlthExpPcntGDP() As Single\r'mti February 2011 Infarstructure - end\r\r'dkb 2018/05/09 'Declarations for drug model\rDim drugtotalest() As Single\rDim sdrugtotalest() As Single\rDim DrugAmphetamineEst() As Single, DrugCocaineEst() As Single, DrugOpiateEst() As Single, DrugPrescriptionOpioidEst() As Single, DrugEstTot() As Single\rDim sDrugAmphetamineEst() As Single, sDrugCocaineEst() As Single, sDrugOpiateEst() As Single, sDrugPrescriptionOpioidEst() As Single, sDrugEstTot() As Single\rDim SDRUGUSEAMPHETAMINE() As Single, SDRUGUSECOCAINE() As Single, SDRUGUSEOPIATES() As Single, SDRUGUSEPRESCRIPTOPIOID() As Single\rDim iDrugUseAmphetamine() As Single, iDrugUseCocaine() As Single, iDrugUseOpiates() As Single, iDrugUsePrescriptOpioid() As Single, iDrugUseTot() As Single\rDim iDrugAmphetamineEst() As Single, iDrugCocaineEst() As Single, iDrugOpiateEst(), iDrugPrescriptionOpioidEst() As Single, iDrugEstTot() As Single\rDim hhconpc() As Single, shhconpc() As Single\r'kbn 2018/09/25- Start-\rDim MaxHomicides As Single\r'kbn 2018/09/25- END-\r\r\r'jrs 2009/06/05\r'Dim SICTBroadExp() As Double\r'Dim ICTBroadExpShift() As Double\r'Dim ICTSpendExpShift() As Double\r'Dim GovRegQualShift() As Double\rPublic GovRegQualShift() As Single\r\r'Public ICTBroadExp() As Double\r\r'Dim GOVREGQUALExp() As Double\rPublic GOVREGQUALExp() As Single\r'mti April 2010 - Infrastructure Consolidation -end\r\r'jrs 2011/01/11\rDim GOVRISKMAX() As Single, GOVRISKMIN() As Single, GOVRISKNAME() As String, GOVRISKSIGN() As Single\r'jrs 2011/02/14 *** begin Embeddedness ***\rDim GOVEMBEDShift() As Single, SGOVEMBED() As Single\r'jrs 2011/02/14 *** end Embeddedness ***\r\r\r\r'JAM 2019-08-09\r' Dim dbD As Database, tblK As Recordset, tblR As Recordset, tblC As Recordset\r\r'jrs 2011/10/11\rDim SRANDDEXP() As Single, SGOVNUCWP() As Single\r\r\r'JAM 2019-08-09\r'Dim IFsCtrys As New Collection\r\r\r'jrs 2012/11/05\rDim DIPLOEMBASSYShift() As Single, DIPLOEMBASSYMAXShift As Single\rDim DIPLOIGOShift() As Single, DIPLOIGOMAXShift As Single\rDim DIPLOTREATYShift() As Single, DIPLOTREATYMAXShift As Single\r'jrs 2014/05/26\rPublic PrivExpToCost() As Single\r'jrs 2014/05/30 Dim HLEXPENDPRIVShift() As Single\rDim PrivHLExpPctGDPFxName As String\rDim HlGrTerm() As Single\r'jrs 2016/01/13\rPublic SSFINTLWARMAG() As Single\r'JRS 2016/08/02\rDim HTCGRIShift() As Single, HTCTPIShift() As Single\r'jrs 2017/07/07\rPublic SPOWERGPI() As Single\r'jrs 2022/04/20\rPublic SPOWER() As Single\r'jrs 2017/08/08\rPublic SDEMOCPOLITY() As Single\r'jrs 2018/02/26\rPublic SGOVRISK() As Single\r'dkb 2018/06/01\rPublic SGOVINDSECUR() As Single\rDim svindexmax As Double\r'JAM 2019-08-09 New DEclarations\r\rDim DEMOCPOLITYI() As Single, smdemocpolity() As Single\r'jrs 2023/10/13\rDim DEMOCPOLYARCHYShift() As Single\rPublic SDEMOCPOLYARCHY() As Single\r'Dim SDEMOCPOLYARCHYFX() As Single\r'Dim PolyarchyGR() As Single?\r\rDim swingeffects() As Single, demglobaleffects() As Single\rDim FREEDOMI() As Single, econfreei() As Single, GovEffectAdd() As Single, GovCorruptAdd() As Single\rDim GEMI() As Single, GEMPI() As Single, democcomp() As Single\rDim YTHBULGEI() As Single, gdprmovavg() As Single, ssfintlwarallLoc() As Single, econfreeri() As Single\r'BBH 2011/06/18\rDim energydepend() As Single, ContiguityIntlWarAddI() As Single\rDim democpolityri() As Single\rDim snumnwp() As Single, INUMNWP() As Single, inumnwpgr() As Single, numnwpmin() As Single\rDim SFINSTABALLRI() As Single, SFINSTABMAGRI() As Single, SFINSTABY1RI() As Single\r'BBH 2011/06/18\rDim SFINTLWARALLADD() As Single, SFINTLWARMAGRI() As Single, SFINTLWARY1RI() As Single\r'jrs 2024/05/17\rDim ssfcivilwarUCDPLoc() As Single, SFCIVILWARUCDPADD() As Single, SFCIVILWARUCDPI() As Single\r'bbh 2011/09/21\rDim SFINTLWARALLI() As Single, SFINTLWARMAGI() As Single\rDim SFPredictionI() As Single\rDim SSURVSEI(,) As Single\rDim SwingStsDemoc(9) As Single, SwingStsNumb(9) As Single, sedyrsag15() As Single, EDYRSAG15I() As Single\r'bbh 2011/08/19\rDim sedyrsag15fem() As Single, EDYRSAG15FemI() As Single\rDim RandDExpScale() As Single, RAndDExpI() As Single, EdTerGRateScale() As Single, EdTerGRateI() As Single\r'jrs 2009/04/22\rDim GovRegQualAdd() As Single\r\r'mti 2014/11/14 -start\rDim GovBusCostShift() As Single\r'mti 2014/11/14 - end\r\r'mti 2015/03/04 - start\rDim GovBusRegIndShift() As Single\rDim PoliceShift() As Single, ConflictShift() As Single, SelfHarmShift() As Single, HomicideShift() As Single, WomenandChilshift() As Single, SSVDTHSSELFHARM() As Single, SSVDTHSPOLICS() As Single, Womenshift() As Single, ChilShift() As Single, SelfHarmEstimate() As Single, sSelfHarmEstimate() As Single\rDim SSVDTHSCONFLICT() As Single, SSVDTHSOTHERINTERPERSON() As Single, SSVDTHSWOMENCHILDREN() As Single, SSOCIETALVIOLENCEDEATHS() As Single, SHOMICIDEINDEX() As Single, SSVDTHSWOMEN() As Single, SSVDTHSCHIL() As Single\rDim PoliceEstimate() As Single, ConflictEstimate() As Single, HomicideEstimate() As Single, WomenandChilEstimate() As Single\rDim sPoliceEstimate() As Single, sConflictEstimate() As Single, sWomenandChilEstimate() As Single, sHomicideEstimate() As Single\rDim GIIShift() As Single, GIII() As Single 'jrs 2020/03/23\rDim DemocWaveI As Single\rDim SDEMOCWAVE As Single\rDim SDEMOCWVCOUNT As Single\rDim SDEMOCWVDIR As Single\rDim educ15term As Single\rDim AdultMaleTerm As Double\rDim WomenTerm As Double\rDim ChildrenTerm As Double\rDim poptotalterm As Double\rDim MatPostRAdj() As Double, TradSRatAdj() As Double, SurvSEAdj() As Double\rDim SMATPOSTR(,) As Single, MatPostRI(,) As Single\rDim SSURVSE(,) As Single, SURVSEI(,) As Single\rDim STradSRat(,) As Single, TRADSRATI(,) As Single\rDim POWERI() As Single\rDim gkmul() As Single, milspendrati() As Single, LenWar(,) As Single, PowerTranTermI(,) As Single\rDim AllyI(,) As Single\rDim nowarper(,) As Single, gpowertermI(,) As Single, TerDisputeI(,) As Single\rDim ThreatIData(,) As Single, ThreatIPred(,) As Single\rDim WarGDPOwn() As Single, WarGDPOpp() As Single, WarCPOWOwn() As Single, WarCPOWOpp() As Single\rDim WarNPOWOwn() As Single, WarNPOWOpp() As Single, CPOWDM() As Single, NPOWDM() As Single\rDim gk(,) As Single, gkri(,) As Single, gkcomp() As Single, healthgdpri() As Single, RandDI() As Single\r'jrs 2021/09/09\rDim educgdpri() As Single\r\rDim sumthreatI() As Single ', SGDSMil() As Single\rDim govconwb() As Single, gdswb(,) As Single, RandDExpSh() As Single\r'BBH 4/16/04  V5.0\rDim SMORTMG() As Single\r'mti January 06, 2009\rDim EdCostGDSEdRI() As Single, SEdTotCost() As Single, EdCostGDSEdRIShift() As Single\r'mti January 06, 2009\r'Dim InfraCostGDSInfraRI() As Single, ,\rDim sInfraTotCost() As Single, InfraCostGDSInfraRIShift() As Single\rDim DIPLOINGOPROGRAMShift() As Single, DIPLOINGOADVOCACYShift() As Single\rDim UKcol() As Single, FRAcol() As Single, GERcol() As Single, PORcol() As Single\rDim SPAcol() As Single, NETcol() As Single, RUScol() As Single\r'mti 2016/07/16 Target value in GDS%GDP start\r'Declare array variable for saving initial values and target GDS values (when targeting is set as a parameter)\rDim igk(,) As Single, GDSTrgt(,) As Single\rDim gdssetaside() As Single\rDim GOVEMBEDGR() As Single?\rDim SWGDP As Single\rDim GLOCOMI As Single\rDim PConGreatI As Single\r' Dim CalcInfraBudgetDemand() As Single\rDim InfrabudallocNew() As Single\rDim InfrabudallocMnt() As Single\r'Public sedyrsag15(,) As Single 'JAM 2019-08-21\rPublic SGEM() As Single\r\rPrivate Function CalcInfraBudgetDemand(R As Int32) As Single\r'mti April 2011 - change whole proc\r\r'Estimate public portion of the infrastructure investment and sum to a total budget demand\rDim InfCt%\r\rINFRABUDDEMMNT(R%, InfraTot) = 0\rINFRABUDDEMNEW(R%, InfraTot) = 0\r\rCalcInfraBudgetDemand = 0\r\rFor InfCt% = 1 To NInfraType%\rINFRABUDDEMNEW(R%, InfCt%) = infrainvnewpubshrm(R%, InfCt%) * INFRAINVESTNEW(R%, InfCt%)\rINFRABUDDEMMNT(R%, InfCt%) = infrainvmaintpubshrm(R%, InfCt%) * INFRAINVESTMAINT(R%, InfCt%)\rCalcInfraBudgetDemand = CalcInfraBudgetDemand + INFRABUDDEMNEW(R%, InfCt%) + INFRABUDDEMMNT(R%, InfCt%)  'billion dollars\rINFRABUDDEMNEW(R%, InfraTot) = INFRABUDDEMNEW(R%, InfraTot) + INFRABUDDEMNEW(R%, InfCt%)\rINFRABUDDEMMNT(R%, InfraTot) = INFRABUDDEMMNT(R%, InfraTot) + INFRABUDDEMMNT(R%, InfCt%)\rNext InfCt%\r'mti April 2011 - end\rEnd Function\r"
  },
  {
    "Variable": "INFRABUDDEMNEW",
    "UsesVariable": "infrainvnewpubshrm",
    "Distance": 0,
    "Code": "\rImports System\rImports System.Collections.Generic\rImports System.IO\rImports System.Linq\rImports IFs.Data\rImports IFs.Data.ProducerScope\rImports System.Math\r\rNamespace Models\r\rPartial Public Module SocioPol\r'-------------------------------------------------------------------------------------------------------------------\r'International Futures System (IFs) - General Public License (GPL) Declaration\r'-------------------------------------------------------------------------------------------------------------------\r'\r'\r'    Copyright 1988-2012 Barry B. Hughes\r'\r'\r'    This file is part of International Futures (IFs) developed by Barry B. Hughes, bhughes@du.edu\r'\r'    IFs is free software: you can redistribute it and/or modify\r'    it under the terms of the GNU General Public License as published by\r'    the Free Software Foundation, either version 3 of the License, or\r'    (at your option) any later version.\r'\r'    IFs is distributed in the hope that it will be useful,\r'    but WITHOUT ANY WARRANTY; without even the implied warranty of\r'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r'    GNU General Public License for more details.\r'\r'    You should have received a copy of the GNU General Public License\r'    along with International Futures System Development Version. If not, please see http://www.gnu.org/licenses/\r'\r'    Developers of International Futures System are required to send the modified code to the IFs core team\r'    Developers should send such code updates, if any, twice every year, on April 1st and on October 1st\r'    Code updates should be sent to Frederick S. Pardee Center for International Futures (contact: pardee@du.edu)\r'-------------------------------------------------------------------------------------------------------------------\r'------------------------------------------------------------------------------------------\r'\r\r'\"Live as if you were to die tommorrow.\"  Popular\r'\"Learn as if you were to live forever.\"  Gandhi\r'\r'\"The future is alwlays present, as a promise, a lure, and a temptation.\"\r'   Karl Popper\r'\r'   Copyright by Barry B. Hughes 1988-2012\r'   Model code available for review and education only\r'   Reproduction or incorporation in other software by permission only\r'\r\r'   Government expenditure categories:\r'       1.  Military\r'       2.  Health\r'       3.  Education\r'       4.  Research and development\r'       5.  Other (including administrative)\r'       6.  Foreign Aid\r\r'Public SSFINTLWARMAG() As Single\r\rDim SCPOW() As Single, SNPOW() As Single, SGDSMil() As Single\r\rDim swatres() As Single 'jrs 2019/10/22\r'clp 2016/08/26 - Adding GDS R&D\rDim SGDSRandD() As Single\rDim SWCPOW As Single, SWNPOW As Single, WGDSMIL As Single, WGDSRandD As Single, WGOV As Single, WGDPPPP As Single, WTECHP As Single, WTECH As Single\r'jrs 2020/11/19\rDim WTECHmix As Single\r\r'dkb 2013/09/09 creating components for world DPI\rDim WDPIBN As Single, WDPIMN As Single, WDPIILN As Single, WDPI As Single\r\r'dkb 2014/07/07 adding world Effective Human Capital component for POWER\rDim WEHC As Single\r\r'jrs 2011/10/11 GPI\rDim WGOVNUCWP As Single, WConvMilSpend As Single, WENX As Single, WENM As Single, WTradeTotal As Single, WXFDIFIN As Single\rDim WAID As Single, WHumCapWkPopHDI As Single, WGOVREV As Single, WInnovationRD As Single, WConnectivityICTProd As Single\r\r'dkb 2014/10/23 - new EnergyNetExport specification - START\rDim WENXM As Single\r'clp 2016/08/25 - Adding world energy production variable\rDim WENProd As Single\r'dkb 2014/10/23 - new EnergyNetExport specification - END\r\r'dkb 2014/08/06 - adding save variables for Diplometrics POWER component calculation - START\rPublic SDIPLOEMBASSY() As Single, SDIPLOIGO() As Single, SDIPLOTREATY() As Single 'jrs 2017/05/22 changed to public\r'Dim SDIPLOEMBASSYMAX, SDIPLOIGOMAX, SDIPLOTREATYMAX\r'dkb 2014/08/06 - END\r\r'jrs 2022/04/20\rPublic SDIPLOEMBASSY2() As Single\r\r\r'mti April 2010 - Infrastructure Consolidation -start\r'jrs 2009/02/25\r'Dim MOBILshift(), BROADshift() As Double\r'jrs 2009/02/26\r'Dim ICTIndexShift()\r'jrs 2009/02/27\r'Dim SMobil()\r'jrs 2009/06/08\r'Public SBroad() As Double\r'jrs 2009/05/18\r'Dim SPENDshift()\r\r'jrs 2009/05/28\r'Dim SGOVREGQUAL()\rPublic SGOVREGQUAL() As Single\r\r\r\r'mti February 2011 Infarstructure - start\r'The following adjustment factor is needed in Infrastr Module\rPublic InfraCostGDSInfraRI() As Single\rPublic sHlthExpPcntGDP() As Single\r'mti February 2011 Infarstructure - end\r\r'dkb 2018/05/09 'Declarations for drug model\rDim drugtotalest() As Single\rDim sdrugtotalest() As Single\rDim DrugAmphetamineEst() As Single, DrugCocaineEst() As Single, DrugOpiateEst() As Single, DrugPrescriptionOpioidEst() As Single, DrugEstTot() As Single\rDim sDrugAmphetamineEst() As Single, sDrugCocaineEst() As Single, sDrugOpiateEst() As Single, sDrugPrescriptionOpioidEst() As Single, sDrugEstTot() As Single\rDim SDRUGUSEAMPHETAMINE() As Single, SDRUGUSECOCAINE() As Single, SDRUGUSEOPIATES() As Single, SDRUGUSEPRESCRIPTOPIOID() As Single\rDim iDrugUseAmphetamine() As Single, iDrugUseCocaine() As Single, iDrugUseOpiates() As Single, iDrugUsePrescriptOpioid() As Single, iDrugUseTot() As Single\rDim iDrugAmphetamineEst() As Single, iDrugCocaineEst() As Single, iDrugOpiateEst(), iDrugPrescriptionOpioidEst() As Single, iDrugEstTot() As Single\rDim hhconpc() As Single, shhconpc() As Single\r'kbn 2018/09/25- Start-\rDim MaxHomicides As Single\r'kbn 2018/09/25- END-\r\r\r'jrs 2009/06/05\r'Dim SICTBroadExp() As Double\r'Dim ICTBroadExpShift() As Double\r'Dim ICTSpendExpShift() As Double\r'Dim GovRegQualShift() As Double\rPublic GovRegQualShift() As Single\r\r'Public ICTBroadExp() As Double\r\r'Dim GOVREGQUALExp() As Double\rPublic GOVREGQUALExp() As Single\r'mti April 2010 - Infrastructure Consolidation -end\r\r'jrs 2011/01/11\rDim GOVRISKMAX() As Single, GOVRISKMIN() As Single, GOVRISKNAME() As String, GOVRISKSIGN() As Single\r'jrs 2011/02/14 *** begin Embeddedness ***\rDim GOVEMBEDShift() As Single, SGOVEMBED() As Single\r'jrs 2011/02/14 *** end Embeddedness ***\r\r\r\r'JAM 2019-08-09\r' Dim dbD As Database, tblK As Recordset, tblR As Recordset, tblC As Recordset\r\r'jrs 2011/10/11\rDim SRANDDEXP() As Single, SGOVNUCWP() As Single\r\r\r'JAM 2019-08-09\r'Dim IFsCtrys As New Collection\r\r\r'jrs 2012/11/05\rDim DIPLOEMBASSYShift() As Single, DIPLOEMBASSYMAXShift As Single\rDim DIPLOIGOShift() As Single, DIPLOIGOMAXShift As Single\rDim DIPLOTREATYShift() As Single, DIPLOTREATYMAXShift As Single\r'jrs 2014/05/26\rPublic PrivExpToCost() As Single\r'jrs 2014/05/30 Dim HLEXPENDPRIVShift() As Single\rDim PrivHLExpPctGDPFxName As String\rDim HlGrTerm() As Single\r'jrs 2016/01/13\rPublic SSFINTLWARMAG() As Single\r'JRS 2016/08/02\rDim HTCGRIShift() As Single, HTCTPIShift() As Single\r'jrs 2017/07/07\rPublic SPOWERGPI() As Single\r'jrs 2022/04/20\rPublic SPOWER() As Single\r'jrs 2017/08/08\rPublic SDEMOCPOLITY() As Single\r'jrs 2018/02/26\rPublic SGOVRISK() As Single\r'dkb 2018/06/01\rPublic SGOVINDSECUR() As Single\rDim svindexmax As Double\r'JAM 2019-08-09 New DEclarations\r\rDim DEMOCPOLITYI() As Single, smdemocpolity() As Single\r'jrs 2023/10/13\rDim DEMOCPOLYARCHYShift() As Single\rPublic SDEMOCPOLYARCHY() As Single\r'Dim SDEMOCPOLYARCHYFX() As Single\r'Dim PolyarchyGR() As Single?\r\rDim swingeffects() As Single, demglobaleffects() As Single\rDim FREEDOMI() As Single, econfreei() As Single, GovEffectAdd() As Single, GovCorruptAdd() As Single\rDim GEMI() As Single, GEMPI() As Single, democcomp() As Single\rDim YTHBULGEI() As Single, gdprmovavg() As Single, ssfintlwarallLoc() As Single, econfreeri() As Single\r'BBH 2011/06/18\rDim energydepend() As Single, ContiguityIntlWarAddI() As Single\rDim democpolityri() As Single\rDim snumnwp() As Single, INUMNWP() As Single, inumnwpgr() As Single, numnwpmin() As Single\rDim SFINSTABALLRI() As Single, SFINSTABMAGRI() As Single, SFINSTABY1RI() As Single\r'BBH 2011/06/18\rDim SFINTLWARALLADD() As Single, SFINTLWARMAGRI() As Single, SFINTLWARY1RI() As Single\r'jrs 2024/05/17\rDim ssfcivilwarUCDPLoc() As Single, SFCIVILWARUCDPADD() As Single, SFCIVILWARUCDPI() As Single\r'bbh 2011/09/21\rDim SFINTLWARALLI() As Single, SFINTLWARMAGI() As Single\rDim SFPredictionI() As Single\rDim SSURVSEI(,) As Single\rDim SwingStsDemoc(9) As Single, SwingStsNumb(9) As Single, sedyrsag15() As Single, EDYRSAG15I() As Single\r'bbh 2011/08/19\rDim sedyrsag15fem() As Single, EDYRSAG15FemI() As Single\rDim RandDExpScale() As Single, RAndDExpI() As Single, EdTerGRateScale() As Single, EdTerGRateI() As Single\r'jrs 2009/04/22\rDim GovRegQualAdd() As Single\r\r'mti 2014/11/14 -start\rDim GovBusCostShift() As Single\r'mti 2014/11/14 - end\r\r'mti 2015/03/04 - start\rDim GovBusRegIndShift() As Single\rDim PoliceShift() As Single, ConflictShift() As Single, SelfHarmShift() As Single, HomicideShift() As Single, WomenandChilshift() As Single, SSVDTHSSELFHARM() As Single, SSVDTHSPOLICS() As Single, Womenshift() As Single, ChilShift() As Single, SelfHarmEstimate() As Single, sSelfHarmEstimate() As Single\rDim SSVDTHSCONFLICT() As Single, SSVDTHSOTHERINTERPERSON() As Single, SSVDTHSWOMENCHILDREN() As Single, SSOCIETALVIOLENCEDEATHS() As Single, SHOMICIDEINDEX() As Single, SSVDTHSWOMEN() As Single, SSVDTHSCHIL() As Single\rDim PoliceEstimate() As Single, ConflictEstimate() As Single, HomicideEstimate() As Single, WomenandChilEstimate() As Single\rDim sPoliceEstimate() As Single, sConflictEstimate() As Single, sWomenandChilEstimate() As Single, sHomicideEstimate() As Single\rDim GIIShift() As Single, GIII() As Single 'jrs 2020/03/23\rDim DemocWaveI As Single\rDim SDEMOCWAVE As Single\rDim SDEMOCWVCOUNT As Single\rDim SDEMOCWVDIR As Single\rDim educ15term As Single\rDim AdultMaleTerm As Double\rDim WomenTerm As Double\rDim ChildrenTerm As Double\rDim poptotalterm As Double\rDim MatPostRAdj() As Double, TradSRatAdj() As Double, SurvSEAdj() As Double\rDim SMATPOSTR(,) As Single, MatPostRI(,) As Single\rDim SSURVSE(,) As Single, SURVSEI(,) As Single\rDim STradSRat(,) As Single, TRADSRATI(,) As Single\rDim POWERI() As Single\rDim gkmul() As Single, milspendrati() As Single, LenWar(,) As Single, PowerTranTermI(,) As Single\rDim AllyI(,) As Single\rDim nowarper(,) As Single, gpowertermI(,) As Single, TerDisputeI(,) As Single\rDim ThreatIData(,) As Single, ThreatIPred(,) As Single\rDim WarGDPOwn() As Single, WarGDPOpp() As Single, WarCPOWOwn() As Single, WarCPOWOpp() As Single\rDim WarNPOWOwn() As Single, WarNPOWOpp() As Single, CPOWDM() As Single, NPOWDM() As Single\rDim gk(,) As Single, gkri(,) As Single, gkcomp() As Single, healthgdpri() As Single, RandDI() As Single\r'jrs 2021/09/09\rDim educgdpri() As Single\r\rDim sumthreatI() As Single ', SGDSMil() As Single\rDim govconwb() As Single, gdswb(,) As Single, RandDExpSh() As Single\r'BBH 4/16/04  V5.0\rDim SMORTMG() As Single\r'mti January 06, 2009\rDim EdCostGDSEdRI() As Single, SEdTotCost() As Single, EdCostGDSEdRIShift() As Single\r'mti January 06, 2009\r'Dim InfraCostGDSInfraRI() As Single, ,\rDim sInfraTotCost() As Single, InfraCostGDSInfraRIShift() As Single\rDim DIPLOINGOPROGRAMShift() As Single, DIPLOINGOADVOCACYShift() As Single\rDim UKcol() As Single, FRAcol() As Single, GERcol() As Single, PORcol() As Single\rDim SPAcol() As Single, NETcol() As Single, RUScol() As Single\r'mti 2016/07/16 Target value in GDS%GDP start\r'Declare array variable for saving initial values and target GDS values (when targeting is set as a parameter)\rDim igk(,) As Single, GDSTrgt(,) As Single\rDim gdssetaside() As Single\rDim GOVEMBEDGR() As Single?\rDim SWGDP As Single\rDim GLOCOMI As Single\rDim PConGreatI As Single\r' Dim CalcInfraBudgetDemand() As Single\rDim InfrabudallocNew() As Single\rDim InfrabudallocMnt() As Single\r'Public sedyrsag15(,) As Single 'JAM 2019-08-21\rPublic SGEM() As Single\r\rPrivate Function CalcInfraBudgetDemand(R As Int32) As Single\r'mti April 2011 - change whole proc\r\r'Estimate public portion of the infrastructure investment and sum to a total budget demand\rDim InfCt%\r\rINFRABUDDEMMNT(R%, InfraTot) = 0\rINFRABUDDEMNEW(R%, InfraTot) = 0\r\rCalcInfraBudgetDemand = 0\r\rFor InfCt% = 1 To NInfraType%\rINFRABUDDEMNEW(R%, InfCt%) = infrainvnewpubshrm(R%, InfCt%) * INFRAINVESTNEW(R%, InfCt%)\rINFRABUDDEMMNT(R%, InfCt%) = infrainvmaintpubshrm(R%, InfCt%) * INFRAINVESTMAINT(R%, InfCt%)\rCalcInfraBudgetDemand = CalcInfraBudgetDemand + INFRABUDDEMNEW(R%, InfCt%) + INFRABUDDEMMNT(R%, InfCt%)  'billion dollars\rINFRABUDDEMNEW(R%, InfraTot) = INFRABUDDEMNEW(R%, InfraTot) + INFRABUDDEMNEW(R%, InfCt%)\rINFRABUDDEMMNT(R%, InfraTot) = INFRABUDDEMMNT(R%, InfraTot) + INFRABUDDEMMNT(R%, InfCt%)\rNext InfCt%\r'mti April 2011 - end\rEnd Function\r\rImports System\rImports System.Collections.Generic\rImports System.IO\rImports System.Linq\rImports IFs.Data\rImports IFs.Data.ProducerScope\rImports System.Math\r\rNamespace Models\r\rPartial Public Module SocioPol\r'-------------------------------------------------------------------------------------------------------------------\r'International Futures System (IFs) - General Public License (GPL) Declaration\r'-------------------------------------------------------------------------------------------------------------------\r'\r'\r'    Copyright 1988-2012 Barry B. Hughes\r'\r'\r'    This file is part of International Futures (IFs) developed by Barry B. Hughes, bhughes@du.edu\r'\r'    IFs is free software: you can redistribute it and/or modify\r'    it under the terms of the GNU General Public License as published by\r'    the Free Software Foundation, either version 3 of the License, or\r'    (at your option) any later version.\r'\r'    IFs is distributed in the hope that it will be useful,\r'    but WITHOUT ANY WARRANTY; without even the implied warranty of\r'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r'    GNU General Public License for more details.\r'\r'    You should have received a copy of the GNU General Public License\r'    along with International Futures System Development Version. If not, please see http://www.gnu.org/licenses/\r'\r'    Developers of International Futures System are required to send the modified code to the IFs core team\r'    Developers should send such code updates, if any, twice every year, on April 1st and on October 1st\r'    Code updates should be sent to Frederick S. Pardee Center for International Futures (contact: pardee@du.edu)\r'-------------------------------------------------------------------------------------------------------------------\r'------------------------------------------------------------------------------------------\r'\r\r'\"Live as if you were to die tommorrow.\"  Popular\r'\"Learn as if you were to live forever.\"  Gandhi\r'\r'\"The future is alwlays present, as a promise, a lure, and a temptation.\"\r'   Karl Popper\r'\r'   Copyright by Barry B. Hughes 1988-2012\r'   Model code available for review and education only\r'   Reproduction or incorporation in other software by permission only\r'\r\r'   Government expenditure categories:\r'       1.  Military\r'       2.  Health\r'       3.  Education\r'       4.  Research and development\r'       5.  Other (including administrative)\r'       6.  Foreign Aid\r\r'Public SSFINTLWARMAG() As Single\r\rDim SCPOW() As Single, SNPOW() As Single, SGDSMil() As Single\r\rDim swatres() As Single 'jrs 2019/10/22\r'clp 2016/08/26 - Adding GDS R&D\rDim SGDSRandD() As Single\rDim SWCPOW As Single, SWNPOW As Single, WGDSMIL As Single, WGDSRandD As Single, WGOV As Single, WGDPPPP As Single, WTECHP As Single, WTECH As Single\r'jrs 2020/11/19\rDim WTECHmix As Single\r\r'dkb 2013/09/09 creating components for world DPI\rDim WDPIBN As Single, WDPIMN As Single, WDPIILN As Single, WDPI As Single\r\r'dkb 2014/07/07 adding world Effective Human Capital component for POWER\rDim WEHC As Single\r\r'jrs 2011/10/11 GPI\rDim WGOVNUCWP As Single, WConvMilSpend As Single, WENX As Single, WENM As Single, WTradeTotal As Single, WXFDIFIN As Single\rDim WAID As Single, WHumCapWkPopHDI As Single, WGOVREV As Single, WInnovationRD As Single, WConnectivityICTProd As Single\r\r'dkb 2014/10/23 - new EnergyNetExport specification - START\rDim WENXM As Single\r'clp 2016/08/25 - Adding world energy production variable\rDim WENProd As Single\r'dkb 2014/10/23 - new EnergyNetExport specification - END\r\r'dkb 2014/08/06 - adding save variables for Diplometrics POWER component calculation - START\rPublic SDIPLOEMBASSY() As Single, SDIPLOIGO() As Single, SDIPLOTREATY() As Single 'jrs 2017/05/22 changed to public\r'Dim SDIPLOEMBASSYMAX, SDIPLOIGOMAX, SDIPLOTREATYMAX\r'dkb 2014/08/06 - END\r\r'jrs 2022/04/20\rPublic SDIPLOEMBASSY2() As Single\r\r\r'mti April 2010 - Infrastructure Consolidation -start\r'jrs 2009/02/25\r'Dim MOBILshift(), BROADshift() As Double\r'jrs 2009/02/26\r'Dim ICTIndexShift()\r'jrs 2009/02/27\r'Dim SMobil()\r'jrs 2009/06/08\r'Public SBroad() As Double\r'jrs 2009/05/18\r'Dim SPENDshift()\r\r'jrs 2009/05/28\r'Dim SGOVREGQUAL()\rPublic SGOVREGQUAL() As Single\r\r\r\r'mti February 2011 Infarstructure - start\r'The following adjustment factor is needed in Infrastr Module\rPublic InfraCostGDSInfraRI() As Single\rPublic sHlthExpPcntGDP() As Single\r'mti February 2011 Infarstructure - end\r\r'dkb 2018/05/09 'Declarations for drug model\rDim drugtotalest() As Single\rDim sdrugtotalest() As Single\rDim DrugAmphetamineEst() As Single, DrugCocaineEst() As Single, DrugOpiateEst() As Single, DrugPrescriptionOpioidEst() As Single, DrugEstTot() As Single\rDim sDrugAmphetamineEst() As Single, sDrugCocaineEst() As Single, sDrugOpiateEst() As Single, sDrugPrescriptionOpioidEst() As Single, sDrugEstTot() As Single\rDim SDRUGUSEAMPHETAMINE() As Single, SDRUGUSECOCAINE() As Single, SDRUGUSEOPIATES() As Single, SDRUGUSEPRESCRIPTOPIOID() As Single\rDim iDrugUseAmphetamine() As Single, iDrugUseCocaine() As Single, iDrugUseOpiates() As Single, iDrugUsePrescriptOpioid() As Single, iDrugUseTot() As Single\rDim iDrugAmphetamineEst() As Single, iDrugCocaineEst() As Single, iDrugOpiateEst(), iDrugPrescriptionOpioidEst() As Single, iDrugEstTot() As Single\rDim hhconpc() As Single, shhconpc() As Single\r'kbn 2018/09/25- Start-\rDim MaxHomicides As Single\r'kbn 2018/09/25- END-\r\r\r'jrs 2009/06/05\r'Dim SICTBroadExp() As Double\r'Dim ICTBroadExpShift() As Double\r'Dim ICTSpendExpShift() As Double\r'Dim GovRegQualShift() As Double\rPublic GovRegQualShift() As Single\r\r'Public ICTBroadExp() As Double\r\r'Dim GOVREGQUALExp() As Double\rPublic GOVREGQUALExp() As Single\r'mti April 2010 - Infrastructure Consolidation -end\r\r'jrs 2011/01/11\rDim GOVRISKMAX() As Single, GOVRISKMIN() As Single, GOVRISKNAME() As String, GOVRISKSIGN() As Single\r'jrs 2011/02/14 *** begin Embeddedness ***\rDim GOVEMBEDShift() As Single, SGOVEMBED() As Single\r'jrs 2011/02/14 *** end Embeddedness ***\r\r\r\r'JAM 2019-08-09\r' Dim dbD As Database, tblK As Recordset, tblR As Recordset, tblC As Recordset\r\r'jrs 2011/10/11\rDim SRANDDEXP() As Single, SGOVNUCWP() As Single\r\r\r'JAM 2019-08-09\r'Dim IFsCtrys As New Collection\r\r\r'jrs 2012/11/05\rDim DIPLOEMBASSYShift() As Single, DIPLOEMBASSYMAXShift As Single\rDim DIPLOIGOShift() As Single, DIPLOIGOMAXShift As Single\rDim DIPLOTREATYShift() As Single, DIPLOTREATYMAXShift As Single\r'jrs 2014/05/26\rPublic PrivExpToCost() As Single\r'jrs 2014/05/30 Dim HLEXPENDPRIVShift() As Single\rDim PrivHLExpPctGDPFxName As String\rDim HlGrTerm() As Single\r'jrs 2016/01/13\rPublic SSFINTLWARMAG() As Single\r'JRS 2016/08/02\rDim HTCGRIShift() As Single, HTCTPIShift() As Single\r'jrs 2017/07/07\rPublic SPOWERGPI() As Single\r'jrs 2022/04/20\rPublic SPOWER() As Single\r'jrs 2017/08/08\rPublic SDEMOCPOLITY() As Single\r'jrs 2018/02/26\rPublic SGOVRISK() As Single\r'dkb 2018/06/01\rPublic SGOVINDSECUR() As Single\rDim svindexmax As Double\r'JAM 2019-08-09 New DEclarations\r\rDim DEMOCPOLITYI() As Single, smdemocpolity() As Single\r'jrs 2023/10/13\rDim DEMOCPOLYARCHYShift() As Single\rPublic SDEMOCPOLYARCHY() As Single\r'Dim SDEMOCPOLYARCHYFX() As Single\r'Dim PolyarchyGR() As Single?\r\rDim swingeffects() As Single, demglobaleffects() As Single\rDim FREEDOMI() As Single, econfreei() As Single, GovEffectAdd() As Single, GovCorruptAdd() As Single\rDim GEMI() As Single, GEMPI() As Single, democcomp() As Single\rDim YTHBULGEI() As Single, gdprmovavg() As Single, ssfintlwarallLoc() As Single, econfreeri() As Single\r'BBH 2011/06/18\rDim energydepend() As Single, ContiguityIntlWarAddI() As Single\rDim democpolityri() As Single\rDim snumnwp() As Single, INUMNWP() As Single, inumnwpgr() As Single, numnwpmin() As Single\rDim SFINSTABALLRI() As Single, SFINSTABMAGRI() As Single, SFINSTABY1RI() As Single\r'BBH 2011/06/18\rDim SFINTLWARALLADD() As Single, SFINTLWARMAGRI() As Single, SFINTLWARY1RI() As Single\r'jrs 2024/05/17\rDim ssfcivilwarUCDPLoc() As Single, SFCIVILWARUCDPADD() As Single, SFCIVILWARUCDPI() As Single\r'bbh 2011/09/21\rDim SFINTLWARALLI() As Single, SFINTLWARMAGI() As Single\rDim SFPredictionI() As Single\rDim SSURVSEI(,) As Single\rDim SwingStsDemoc(9) As Single, SwingStsNumb(9) As Single, sedyrsag15() As Single, EDYRSAG15I() As Single\r'bbh 2011/08/19\rDim sedyrsag15fem() As Single, EDYRSAG15FemI() As Single\rDim RandDExpScale() As Single, RAndDExpI() As Single, EdTerGRateScale() As Single, EdTerGRateI() As Single\r'jrs 2009/04/22\rDim GovRegQualAdd() As Single\r\r'mti 2014/11/14 -start\rDim GovBusCostShift() As Single\r'mti 2014/11/14 - end\r\r'mti 2015/03/04 - start\rDim GovBusRegIndShift() As Single\rDim PoliceShift() As Single, ConflictShift() As Single, SelfHarmShift() As Single, HomicideShift() As Single, WomenandChilshift() As Single, SSVDTHSSELFHARM() As Single, SSVDTHSPOLICS() As Single, Womenshift() As Single, ChilShift() As Single, SelfHarmEstimate() As Single, sSelfHarmEstimate() As Single\rDim SSVDTHSCONFLICT() As Single, SSVDTHSOTHERINTERPERSON() As Single, SSVDTHSWOMENCHILDREN() As Single, SSOCIETALVIOLENCEDEATHS() As Single, SHOMICIDEINDEX() As Single, SSVDTHSWOMEN() As Single, SSVDTHSCHIL() As Single\rDim PoliceEstimate() As Single, ConflictEstimate() As Single, HomicideEstimate() As Single, WomenandChilEstimate() As Single\rDim sPoliceEstimate() As Single, sConflictEstimate() As Single, sWomenandChilEstimate() As Single, sHomicideEstimate() As Single\rDim GIIShift() As Single, GIII() As Single 'jrs 2020/03/23\rDim DemocWaveI As Single\rDim SDEMOCWAVE As Single\rDim SDEMOCWVCOUNT As Single\rDim SDEMOCWVDIR As Single\rDim educ15term As Single\rDim AdultMaleTerm As Double\rDim WomenTerm As Double\rDim ChildrenTerm As Double\rDim poptotalterm As Double\rDim MatPostRAdj() As Double, TradSRatAdj() As Double, SurvSEAdj() As Double\rDim SMATPOSTR(,) As Single, MatPostRI(,) As Single\rDim SSURVSE(,) As Single, SURVSEI(,) As Single\rDim STradSRat(,) As Single, TRADSRATI(,) As Single\rDim POWERI() As Single\rDim gkmul() As Single, milspendrati() As Single, LenWar(,) As Single, PowerTranTermI(,) As Single\rDim AllyI(,) As Single\rDim nowarper(,) As Single, gpowertermI(,) As Single, TerDisputeI(,) As Single\rDim ThreatIData(,) As Single, ThreatIPred(,) As Single\rDim WarGDPOwn() As Single, WarGDPOpp() As Single, WarCPOWOwn() As Single, WarCPOWOpp() As Single\rDim WarNPOWOwn() As Single, WarNPOWOpp() As Single, CPOWDM() As Single, NPOWDM() As Single\rDim gk(,) As Single, gkri(,) As Single, gkcomp() As Single, healthgdpri() As Single, RandDI() As Single\r'jrs 2021/09/09\rDim educgdpri() As Single\r\rDim sumthreatI() As Single ', SGDSMil() As Single\rDim govconwb() As Single, gdswb(,) As Single, RandDExpSh() As Single\r'BBH 4/16/04  V5.0\rDim SMORTMG() As Single\r'mti January 06, 2009\rDim EdCostGDSEdRI() As Single, SEdTotCost() As Single, EdCostGDSEdRIShift() As Single\r'mti January 06, 2009\r'Dim InfraCostGDSInfraRI() As Single, ,\rDim sInfraTotCost() As Single, InfraCostGDSInfraRIShift() As Single\rDim DIPLOINGOPROGRAMShift() As Single, DIPLOINGOADVOCACYShift() As Single\rDim UKcol() As Single, FRAcol() As Single, GERcol() As Single, PORcol() As Single\rDim SPAcol() As Single, NETcol() As Single, RUScol() As Single\r'mti 2016/07/16 Target value in GDS%GDP start\r'Declare array variable for saving initial values and target GDS values (when targeting is set as a parameter)\rDim igk(,) As Single, GDSTrgt(,) As Single\rDim gdssetaside() As Single\rDim GOVEMBEDGR() As Single?\rDim SWGDP As Single\rDim GLOCOMI As Single\rDim PConGreatI As Single\r' Dim CalcInfraBudgetDemand() As Single\rDim InfrabudallocNew() As Single\rDim InfrabudallocMnt() As Single\r'Public sedyrsag15(,) As Single 'JAM 2019-08-21\rPublic SGEM() As Single\r\rPrivate Function CalcInfraBudgetDemand(R As Int32) As Single\r'mti April 2011 - change whole proc\r\r'Estimate public portion of the infrastructure investment and sum to a total budget demand\rDim InfCt%\r\rINFRABUDDEMMNT(R%, InfraTot) = 0\rINFRABUDDEMNEW(R%, InfraTot) = 0\r\rCalcInfraBudgetDemand = 0\r\rFor InfCt% = 1 To NInfraType%\rINFRABUDDEMNEW(R%, InfCt%) = infrainvnewpubshrm(R%, InfCt%) * INFRAINVESTNEW(R%, InfCt%)\rINFRABUDDEMMNT(R%, InfCt%) = infrainvmaintpubshrm(R%, InfCt%) * INFRAINVESTMAINT(R%, InfCt%)\rCalcInfraBudgetDemand = CalcInfraBudgetDemand + INFRABUDDEMNEW(R%, InfCt%) + INFRABUDDEMMNT(R%, InfCt%)  'billion dollars\rINFRABUDDEMNEW(R%, InfraTot) = INFRABUDDEMNEW(R%, InfraTot) + INFRABUDDEMNEW(R%, InfCt%)\rINFRABUDDEMMNT(R%, InfraTot) = INFRABUDDEMMNT(R%, InfraTot) + INFRABUDDEMMNT(R%, InfCt%)\rNext InfCt%\r'mti April 2011 - end\rEnd Function\r"
  },
  {
    "Variable": "INFRABUDDEMNEW",
    "UsesVariable": "INFRAINVESTNEW",
    "Distance": 0,
    "Code": "\rImports System\rImports System.Collections.Generic\rImports System.IO\rImports System.Linq\rImports IFs.Data\rImports IFs.Data.ProducerScope\rImports System.Math\r\rNamespace Models\r\rPartial Public Module SocioPol\r'-------------------------------------------------------------------------------------------------------------------\r'International Futures System (IFs) - General Public License (GPL) Declaration\r'-------------------------------------------------------------------------------------------------------------------\r'\r'\r'    Copyright 1988-2012 Barry B. Hughes\r'\r'\r'    This file is part of International Futures (IFs) developed by Barry B. Hughes, bhughes@du.edu\r'\r'    IFs is free software: you can redistribute it and/or modify\r'    it under the terms of the GNU General Public License as published by\r'    the Free Software Foundation, either version 3 of the License, or\r'    (at your option) any later version.\r'\r'    IFs is distributed in the hope that it will be useful,\r'    but WITHOUT ANY WARRANTY; without even the implied warranty of\r'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r'    GNU General Public License for more details.\r'\r'    You should have received a copy of the GNU General Public License\r'    along with International Futures System Development Version. If not, please see http://www.gnu.org/licenses/\r'\r'    Developers of International Futures System are required to send the modified code to the IFs core team\r'    Developers should send such code updates, if any, twice every year, on April 1st and on October 1st\r'    Code updates should be sent to Frederick S. Pardee Center for International Futures (contact: pardee@du.edu)\r'-------------------------------------------------------------------------------------------------------------------\r'------------------------------------------------------------------------------------------\r'\r\r'\"Live as if you were to die tommorrow.\"  Popular\r'\"Learn as if you were to live forever.\"  Gandhi\r'\r'\"The future is alwlays present, as a promise, a lure, and a temptation.\"\r'   Karl Popper\r'\r'   Copyright by Barry B. Hughes 1988-2012\r'   Model code available for review and education only\r'   Reproduction or incorporation in other software by permission only\r'\r\r'   Government expenditure categories:\r'       1.  Military\r'       2.  Health\r'       3.  Education\r'       4.  Research and development\r'       5.  Other (including administrative)\r'       6.  Foreign Aid\r\r'Public SSFINTLWARMAG() As Single\r\rDim SCPOW() As Single, SNPOW() As Single, SGDSMil() As Single\r\rDim swatres() As Single 'jrs 2019/10/22\r'clp 2016/08/26 - Adding GDS R&D\rDim SGDSRandD() As Single\rDim SWCPOW As Single, SWNPOW As Single, WGDSMIL As Single, WGDSRandD As Single, WGOV As Single, WGDPPPP As Single, WTECHP As Single, WTECH As Single\r'jrs 2020/11/19\rDim WTECHmix As Single\r\r'dkb 2013/09/09 creating components for world DPI\rDim WDPIBN As Single, WDPIMN As Single, WDPIILN As Single, WDPI As Single\r\r'dkb 2014/07/07 adding world Effective Human Capital component for POWER\rDim WEHC As Single\r\r'jrs 2011/10/11 GPI\rDim WGOVNUCWP As Single, WConvMilSpend As Single, WENX As Single, WENM As Single, WTradeTotal As Single, WXFDIFIN As Single\rDim WAID As Single, WHumCapWkPopHDI As Single, WGOVREV As Single, WInnovationRD As Single, WConnectivityICTProd As Single\r\r'dkb 2014/10/23 - new EnergyNetExport specification - START\rDim WENXM As Single\r'clp 2016/08/25 - Adding world energy production variable\rDim WENProd As Single\r'dkb 2014/10/23 - new EnergyNetExport specification - END\r\r'dkb 2014/08/06 - adding save variables for Diplometrics POWER component calculation - START\rPublic SDIPLOEMBASSY() As Single, SDIPLOIGO() As Single, SDIPLOTREATY() As Single 'jrs 2017/05/22 changed to public\r'Dim SDIPLOEMBASSYMAX, SDIPLOIGOMAX, SDIPLOTREATYMAX\r'dkb 2014/08/06 - END\r\r'jrs 2022/04/20\rPublic SDIPLOEMBASSY2() As Single\r\r\r'mti April 2010 - Infrastructure Consolidation -start\r'jrs 2009/02/25\r'Dim MOBILshift(), BROADshift() As Double\r'jrs 2009/02/26\r'Dim ICTIndexShift()\r'jrs 2009/02/27\r'Dim SMobil()\r'jrs 2009/06/08\r'Public SBroad() As Double\r'jrs 2009/05/18\r'Dim SPENDshift()\r\r'jrs 2009/05/28\r'Dim SGOVREGQUAL()\rPublic SGOVREGQUAL() As Single\r\r\r\r'mti February 2011 Infarstructure - start\r'The following adjustment factor is needed in Infrastr Module\rPublic InfraCostGDSInfraRI() As Single\rPublic sHlthExpPcntGDP() As Single\r'mti February 2011 Infarstructure - end\r\r'dkb 2018/05/09 'Declarations for drug model\rDim drugtotalest() As Single\rDim sdrugtotalest() As Single\rDim DrugAmphetamineEst() As Single, DrugCocaineEst() As Single, DrugOpiateEst() As Single, DrugPrescriptionOpioidEst() As Single, DrugEstTot() As Single\rDim sDrugAmphetamineEst() As Single, sDrugCocaineEst() As Single, sDrugOpiateEst() As Single, sDrugPrescriptionOpioidEst() As Single, sDrugEstTot() As Single\rDim SDRUGUSEAMPHETAMINE() As Single, SDRUGUSECOCAINE() As Single, SDRUGUSEOPIATES() As Single, SDRUGUSEPRESCRIPTOPIOID() As Single\rDim iDrugUseAmphetamine() As Single, iDrugUseCocaine() As Single, iDrugUseOpiates() As Single, iDrugUsePrescriptOpioid() As Single, iDrugUseTot() As Single\rDim iDrugAmphetamineEst() As Single, iDrugCocaineEst() As Single, iDrugOpiateEst(), iDrugPrescriptionOpioidEst() As Single, iDrugEstTot() As Single\rDim hhconpc() As Single, shhconpc() As Single\r'kbn 2018/09/25- Start-\rDim MaxHomicides As Single\r'kbn 2018/09/25- END-\r\r\r'jrs 2009/06/05\r'Dim SICTBroadExp() As Double\r'Dim ICTBroadExpShift() As Double\r'Dim ICTSpendExpShift() As Double\r'Dim GovRegQualShift() As Double\rPublic GovRegQualShift() As Single\r\r'Public ICTBroadExp() As Double\r\r'Dim GOVREGQUALExp() As Double\rPublic GOVREGQUALExp() As Single\r'mti April 2010 - Infrastructure Consolidation -end\r\r'jrs 2011/01/11\rDim GOVRISKMAX() As Single, GOVRISKMIN() As Single, GOVRISKNAME() As String, GOVRISKSIGN() As Single\r'jrs 2011/02/14 *** begin Embeddedness ***\rDim GOVEMBEDShift() As Single, SGOVEMBED() As Single\r'jrs 2011/02/14 *** end Embeddedness ***\r\r\r\r'JAM 2019-08-09\r' Dim dbD As Database, tblK As Recordset, tblR As Recordset, tblC As Recordset\r\r'jrs 2011/10/11\rDim SRANDDEXP() As Single, SGOVNUCWP() As Single\r\r\r'JAM 2019-08-09\r'Dim IFsCtrys As New Collection\r\r\r'jrs 2012/11/05\rDim DIPLOEMBASSYShift() As Single, DIPLOEMBASSYMAXShift As Single\rDim DIPLOIGOShift() As Single, DIPLOIGOMAXShift As Single\rDim DIPLOTREATYShift() As Single, DIPLOTREATYMAXShift As Single\r'jrs 2014/05/26\rPublic PrivExpToCost() As Single\r'jrs 2014/05/30 Dim HLEXPENDPRIVShift() As Single\rDim PrivHLExpPctGDPFxName As String\rDim HlGrTerm() As Single\r'jrs 2016/01/13\rPublic SSFINTLWARMAG() As Single\r'JRS 2016/08/02\rDim HTCGRIShift() As Single, HTCTPIShift() As Single\r'jrs 2017/07/07\rPublic SPOWERGPI() As Single\r'jrs 2022/04/20\rPublic SPOWER() As Single\r'jrs 2017/08/08\rPublic SDEMOCPOLITY() As Single\r'jrs 2018/02/26\rPublic SGOVRISK() As Single\r'dkb 2018/06/01\rPublic SGOVINDSECUR() As Single\rDim svindexmax As Double\r'JAM 2019-08-09 New DEclarations\r\rDim DEMOCPOLITYI() As Single, smdemocpolity() As Single\r'jrs 2023/10/13\rDim DEMOCPOLYARCHYShift() As Single\rPublic SDEMOCPOLYARCHY() As Single\r'Dim SDEMOCPOLYARCHYFX() As Single\r'Dim PolyarchyGR() As Single?\r\rDim swingeffects() As Single, demglobaleffects() As Single\rDim FREEDOMI() As Single, econfreei() As Single, GovEffectAdd() As Single, GovCorruptAdd() As Single\rDim GEMI() As Single, GEMPI() As Single, democcomp() As Single\rDim YTHBULGEI() As Single, gdprmovavg() As Single, ssfintlwarallLoc() As Single, econfreeri() As Single\r'BBH 2011/06/18\rDim energydepend() As Single, ContiguityIntlWarAddI() As Single\rDim democpolityri() As Single\rDim snumnwp() As Single, INUMNWP() As Single, inumnwpgr() As Single, numnwpmin() As Single\rDim SFINSTABALLRI() As Single, SFINSTABMAGRI() As Single, SFINSTABY1RI() As Single\r'BBH 2011/06/18\rDim SFINTLWARALLADD() As Single, SFINTLWARMAGRI() As Single, SFINTLWARY1RI() As Single\r'jrs 2024/05/17\rDim ssfcivilwarUCDPLoc() As Single, SFCIVILWARUCDPADD() As Single, SFCIVILWARUCDPI() As Single\r'bbh 2011/09/21\rDim SFINTLWARALLI() As Single, SFINTLWARMAGI() As Single\rDim SFPredictionI() As Single\rDim SSURVSEI(,) As Single\rDim SwingStsDemoc(9) As Single, SwingStsNumb(9) As Single, sedyrsag15() As Single, EDYRSAG15I() As Single\r'bbh 2011/08/19\rDim sedyrsag15fem() As Single, EDYRSAG15FemI() As Single\rDim RandDExpScale() As Single, RAndDExpI() As Single, EdTerGRateScale() As Single, EdTerGRateI() As Single\r'jrs 2009/04/22\rDim GovRegQualAdd() As Single\r\r'mti 2014/11/14 -start\rDim GovBusCostShift() As Single\r'mti 2014/11/14 - end\r\r'mti 2015/03/04 - start\rDim GovBusRegIndShift() As Single\rDim PoliceShift() As Single, ConflictShift() As Single, SelfHarmShift() As Single, HomicideShift() As Single, WomenandChilshift() As Single, SSVDTHSSELFHARM() As Single, SSVDTHSPOLICS() As Single, Womenshift() As Single, ChilShift() As Single, SelfHarmEstimate() As Single, sSelfHarmEstimate() As Single\rDim SSVDTHSCONFLICT() As Single, SSVDTHSOTHERINTERPERSON() As Single, SSVDTHSWOMENCHILDREN() As Single, SSOCIETALVIOLENCEDEATHS() As Single, SHOMICIDEINDEX() As Single, SSVDTHSWOMEN() As Single, SSVDTHSCHIL() As Single\rDim PoliceEstimate() As Single, ConflictEstimate() As Single, HomicideEstimate() As Single, WomenandChilEstimate() As Single\rDim sPoliceEstimate() As Single, sConflictEstimate() As Single, sWomenandChilEstimate() As Single, sHomicideEstimate() As Single\rDim GIIShift() As Single, GIII() As Single 'jrs 2020/03/23\rDim DemocWaveI As Single\rDim SDEMOCWAVE As Single\rDim SDEMOCWVCOUNT As Single\rDim SDEMOCWVDIR As Single\rDim educ15term As Single\rDim AdultMaleTerm As Double\rDim WomenTerm As Double\rDim ChildrenTerm As Double\rDim poptotalterm As Double\rDim MatPostRAdj() As Double, TradSRatAdj() As Double, SurvSEAdj() As Double\rDim SMATPOSTR(,) As Single, MatPostRI(,) As Single\rDim SSURVSE(,) As Single, SURVSEI(,) As Single\rDim STradSRat(,) As Single, TRADSRATI(,) As Single\rDim POWERI() As Single\rDim gkmul() As Single, milspendrati() As Single, LenWar(,) As Single, PowerTranTermI(,) As Single\rDim AllyI(,) As Single\rDim nowarper(,) As Single, gpowertermI(,) As Single, TerDisputeI(,) As Single\rDim ThreatIData(,) As Single, ThreatIPred(,) As Single\rDim WarGDPOwn() As Single, WarGDPOpp() As Single, WarCPOWOwn() As Single, WarCPOWOpp() As Single\rDim WarNPOWOwn() As Single, WarNPOWOpp() As Single, CPOWDM() As Single, NPOWDM() As Single\rDim gk(,) As Single, gkri(,) As Single, gkcomp() As Single, healthgdpri() As Single, RandDI() As Single\r'jrs 2021/09/09\rDim educgdpri() As Single\r\rDim sumthreatI() As Single ', SGDSMil() As Single\rDim govconwb() As Single, gdswb(,) As Single, RandDExpSh() As Single\r'BBH 4/16/04  V5.0\rDim SMORTMG() As Single\r'mti January 06, 2009\rDim EdCostGDSEdRI() As Single, SEdTotCost() As Single, EdCostGDSEdRIShift() As Single\r'mti January 06, 2009\r'Dim InfraCostGDSInfraRI() As Single, ,\rDim sInfraTotCost() As Single, InfraCostGDSInfraRIShift() As Single\rDim DIPLOINGOPROGRAMShift() As Single, DIPLOINGOADVOCACYShift() As Single\rDim UKcol() As Single, FRAcol() As Single, GERcol() As Single, PORcol() As Single\rDim SPAcol() As Single, NETcol() As Single, RUScol() As Single\r'mti 2016/07/16 Target value in GDS%GDP start\r'Declare array variable for saving initial values and target GDS values (when targeting is set as a parameter)\rDim igk(,) As Single, GDSTrgt(,) As Single\rDim gdssetaside() As Single\rDim GOVEMBEDGR() As Single?\rDim SWGDP As Single\rDim GLOCOMI As Single\rDim PConGreatI As Single\r' Dim CalcInfraBudgetDemand() As Single\rDim InfrabudallocNew() As Single\rDim InfrabudallocMnt() As Single\r'Public sedyrsag15(,) As Single 'JAM 2019-08-21\rPublic SGEM() As Single\r\rPrivate Function CalcInfraBudgetDemand(R As Int32) As Single\r'mti April 2011 - change whole proc\r\r'Estimate public portion of the infrastructure investment and sum to a total budget demand\rDim InfCt%\r\rINFRABUDDEMMNT(R%, InfraTot) = 0\rINFRABUDDEMNEW(R%, InfraTot) = 0\r\rCalcInfraBudgetDemand = 0\r\rFor InfCt% = 1 To NInfraType%\rINFRABUDDEMNEW(R%, InfCt%) = infrainvnewpubshrm(R%, InfCt%) * INFRAINVESTNEW(R%, InfCt%)\rINFRABUDDEMMNT(R%, InfCt%) = infrainvmaintpubshrm(R%, InfCt%) * INFRAINVESTMAINT(R%, InfCt%)\rCalcInfraBudgetDemand = CalcInfraBudgetDemand + INFRABUDDEMNEW(R%, InfCt%) + INFRABUDDEMMNT(R%, InfCt%)  'billion dollars\rINFRABUDDEMNEW(R%, InfraTot) = INFRABUDDEMNEW(R%, InfraTot) + INFRABUDDEMNEW(R%, InfCt%)\rINFRABUDDEMMNT(R%, InfraTot) = INFRABUDDEMMNT(R%, InfraTot) + INFRABUDDEMMNT(R%, InfCt%)\rNext InfCt%\r'mti April 2011 - end\rEnd Function\r"
  },
  {
    "Variable": "infrabudgetprotec",
    "UsesVariable": "sanitbudgetprotec",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "infrabudgetprotec",
    "UsesVariable": "waterbudgetprotec",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAELEC",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "\r\r'If R% = 81 Then Stop\r\r'jrs 2016/05/11 run to run for Jamaica where there's no data\r'                If INFRAELEC(R%) <= 0 Then 'those with no data\r'                    INFRAELEC(R%) = CalcINFRAELEC\r'                End If\rInfraElecRI(R%) = INFRAELEC(R%) / AMAX(1, CalcINFRAELEC)\r\r\r'   All but First Call 2:  Electricity Consumption\r'------------------------------------------------------------------\r\r'Electricity consumption computed using the energy share of electricity; we use ENDEM consitent with historical data\rDim CompINFRAELEC = ENELECSHRENDEM(R%) * ENDEM(R%) * EnDemDFRIVal * 17000 / AMAX(0.000001, POP(R%)) 'in kwhr ; ENELECSHRENDEM(R%) in 0-100; POP in millions; EnDem in BBOE; 1 BOE = 1700 kwhr\r\r'Apply initial year ratio (or multiplicative shift)\r'If GRPS(1, R) = \"Maldives\" Then Stop\rINFRAELEC(R%) = ConvergeOverTime(CompINFRAELEC * InfraElecRI(R%), CompINFRAELEC, 40) '25\r"
  },
  {
    "Variable": "INFRAELEC",
    "UsesVariable": "ENELECSHRENDEM",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "INFRAELEC",
    "UsesVariable": "ENDEM",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "INFRAELEC",
    "UsesVariable": "POP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "INFRAELEC",
    "UsesVariable": "enconv",
    "Distance": 3,
    "Code": "\r'Initial ratio of ENDEM - data and forecast\rEnDemDFRI(R%) = ENDEMSH(R%) / ENDEM(R%)\r\r\rDim CalcINFRAELEC As Single = ENELECSHRENDEM(R%) * ENDEM(R%) * EnDemDFRI(R%) * 17000 / POP(R%) 'in kwhr ; ENELECSHRENDEM(R%) in 0-100; POP in millions; EnDem in BBOE; 1 BOE = 1700 kwhr\r"
  },
  {
    "Variable": "INFRAELEC",
    "UsesVariable": "ENDEMSH",
    "Distance": 255,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECACC",
    "UsesVariable": "POPURBAN",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECACC",
    "UsesVariable": "HHSIZE",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECACC",
    "UsesVariable": "infraelecaccm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECACC",
    "UsesVariable": "infraelecaccsetar",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECACC",
    "UsesVariable": "infraelecacctrgtyr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECACC",
    "UsesVariable": "infraelecacctrgtval",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECACC",
    "UsesVariable": "GOVEFFECT",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECACC",
    "UsesVariable": "infraelecaccseyrtar",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECACC",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r\r'Compute total electrification from urban and rural elctrification and population\rINFRAELECACC(R%, Total) = (POPURBAN(R%) * INFRAELECACC(R%, Urban) + (POP(R%) - POPURBAN(R%)) * INFRAELECACC(R%, Rural)) / POP(R%)\r"
  },
  {
    "Variable": "INFRAELECACCDEM",
    "UsesVariable": "POPURBAN",
    "Distance": 0,
    "Code": "\rINFRAELECACCDEM(R%, Total) = (SPOPURBAN(R%) * INFRAELECACCDEM(R%, Urban) + (sPOPTotal(R%) - SPOPURBAN(R%)) * INFRAELECACCDEM(R%, Rural)) / sPOPTotal(R%)\r"
  },
  {
    "Variable": "INFRAELECACCDEM",
    "UsesVariable": "INFRAELECACC",
    "Distance": 0,
    "Code": "\r\r'Desired/expected demanded access level\rINFRAELECACCDEM(R%, Rural) = INFRAELECACC(R%, Rural)\r"
  },
  {
    "Variable": "INFRAELECACCPOP",
    "UsesVariable": "INFRAELECACC",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECACCPOP",
    "UsesVariable": "POPURBAN",
    "Distance": 0,
    "Code": "\r'jrs 2023/03/16 INFRAELECACCPOP(R%, Urban) = INFRAELECACC(R%, Urban) * POPURBAN(R%) / 100\rINFRAELECACCPOP(R%, Urban) = INFRAELECACC(R%, Urban) * SPOPURBAN(R%) / 100\r"
  },
  {
    "Variable": "INFRAELECACCPOP",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r\r'mti 2022/08/17 Start\rINFRAELECACCPOP(R%, National) = INFRAELECACC(R%, National) * POP(R%) / 100\r"
  },
  {
    "Variable": "INFRAELECACCRURALCOST",
    "UsesVariable": "infraelecaccruralcostm",
    "Distance": 0,
    "Code": "\r\r'   All but First Call 2: Estimate (Desired) Electricity Access Fund Demand\r'--------------------------------------------------------------------------\rCalcInfraUnitCost(R%, 10, 5, infraelecaccruralcostupper, infraelecaccruralcostlower, sGDPPCP(R%), INFRAELECACCRURALCOST(R%))\rINFRAELECACCRURALCOST(R%) = INFRAELECACCRURALCOST(R%) * infraelecaccruralcostm(R%)\r"
  },
  {
    "Variable": "INFRAELECACCURBANCOST",
    "UsesVariable": "infraelecaccurbancostm",
    "Distance": 0,
    "Code": "\rCalcInfraInvest(CDbl(InfraElecAccRuralDemThousands), CDbl(sInfraElecAccRuralThousands),\r                                Deppcnt(ElectricityAccRural), INFRAELECACCRURALCOST(R%), INFRAINVESTNEW(R%, ElectricityAccRural), INFRAINVESTMAINT(R%, ElectricityAccRural))\r\r\rCalcInfraUnitCost(R%, 10, 5, infraelecaccurbancostupper, infraelecaccurbancostlower, sGDPPCP(R%), INFRAELECACCURBANCOST(R%))\rINFRAELECACCURBANCOST(R%) = INFRAELECACCURBANCOST(R%) * infraelecaccurbancostm(R%)\r"
  },
  {
    "Variable": "INFRAELECADJFACT",
    "UsesVariable": "INFRAELECPROD",
    "Distance": 0,
    "Code": "\r'First Year Call 2: Compute Initial Electricity (Production) Adjustment Factor\r'----------------------------------------------------------------------------------\rINFRAELECADJFACT(R%) = INFRAELECPROD(R%) / If((AMAX(INFRAELECGENCAP(R%) * POP(R%) / (1 + INFRAELECGENCAPRUnConstrained(R%)), 0.0001F) * 8766), 0)\r\r\r\riInfraelecadjfact(R%) = INFRAELECADJFACT(R%)\r\r\r'   All but First Call 2:  Electricity Adjustment Factor, Production, Consumption/productionRatio\r'------------------------------------------------------------------------------------------------\r\r'sErrorSub = saveErrorSub + \" \" + RegName(R%) + \" Electricity Adjustment\"\r\r'convergence of initial value to .55: Note MTI: convergeovertime routine skips 1; so using ConvergeOverTime1 which starts from year 1\r\rINFRAELECADJFACT(R%) = ConvergeOverTime1(If(iInfraelecadjfact(R%), 0), 0.55, 50)\r"
  },
  {
    "Variable": "INFRAELECADJFACT",
    "UsesVariable": "INFRAELECGENCAP",
    "Distance": 0,
    "Code": "\r'First Year Call 2: Compute Initial Electricity (Production) Adjustment Factor\r'----------------------------------------------------------------------------------\rINFRAELECADJFACT(R%) = INFRAELECPROD(R%) / If((AMAX(INFRAELECGENCAP(R%) * POP(R%) / (1 + INFRAELECGENCAPRUnConstrained(R%)), 0.0001F) * 8766), 0)\r"
  },
  {
    "Variable": "INFRAELECADJFACT",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r'First Year Call 2: Compute Initial Electricity (Production) Adjustment Factor\r'----------------------------------------------------------------------------------\rINFRAELECADJFACT(R%) = INFRAELECPROD(R%) / If((AMAX(INFRAELECGENCAP(R%) * POP(R%) / (1 + INFRAELECGENCAPRUnConstrained(R%)), 0.0001F) * 8766), 0)\r"
  },
  {
    "Variable": "INFRAELECADJFACT",
    "UsesVariable": "GDPR",
    "Distance": 2,
    "Code": "\r'First Year Call 2: Electricity Generation Capacity Growth Rate\r'----------------------------------------------------------------\r\rIf InfraElecGenCapGR(R%).HasValue Then\rINFRAELECGENCAPRUnConstrained(R%) = InfraElecGenCapGR(R%)\rElse\r'four countries have null values for growth rate; replaced by GDP growth rate; Timor-Leste has a 6% GDP growth rate\rINFRAELECGENCAPRUnConstrained(R%) = Amin(0.03F, GDPR(R%) / 100)\rEnd If\r"
  },
  {
    "Variable": "INFRAELECCONSPRODRATIO",
    "UsesVariable": "INFRAELEC",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECCONSPRODRATIO",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECCONSPRODRATIO",
    "UsesVariable": "INFRAELECPROD",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECCONSPRODRATIO",
    "UsesVariable": "INFRAELECTRANLOSS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECGENCAP",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECGENCAP",
    "UsesVariable": "infraelecgencapm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECGENCAP",
    "UsesVariable": "LANDIRAREAEQUIP",
    "Distance": 329,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECGENCAP",
    "UsesVariable": "landirareasat",
    "Distance": 329,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECGENCAP",
    "UsesVariable": "GDPR",
    "Distance": 286,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECGENCAP",
    "UsesVariable": "INFRAELECCONSPRODRATIO",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECGENCAP",
    "UsesVariable": "INFRAELECADJFACT",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECGENCAP",
    "UsesVariable": "INFRAELECTRANLOSS",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECGENCAP",
    "UsesVariable": "INFRAELEC",
    "Distance": 17,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECGENCAP",
    "UsesVariable": "INFRAELECPROD",
    "Distance": 279,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECGENCOST",
    "UsesVariable": "infraelecgencostm",
    "Distance": 0,
    "Code": "\r\r'---- Electricity Demand and Supply with base forecast (as opposed to target forecast) on elctricity access - End --\r\r'   All but First Call 2:  Electricity Generation Capacity Finance\r'-----------------------------------------------------------------\r\rCalcInfraUnitCost(R%, 13, 3, infraelecgencostupper, infraelecgencostlower, sGDPPCP(R%), INFRAELECGENCOST(R%)) 'thousand $)\rINFRAELECGENCOST(R%) = INFRAELECGENCOST(R%) * infraelecgencostm(R%)\r"
  },
  {
    "Variable": "INFRAELECPROD",
    "UsesVariable": "INFRAELECGENCAP",
    "Distance": 0,
    "Code": "\r\rINFRAELECPROD(R%) = sINFRAELECGENCAP(R%) * sPOPTotal(R%) * 8766 * INFRAELECADJFACT(R%)\r"
  },
  {
    "Variable": "INFRAELECPROD",
    "UsesVariable": "INFRAELECADJFACT",
    "Distance": 0,
    "Code": "\r\rINFRAELECPROD(R%) = sINFRAELECGENCAP(R%) * sPOPTotal(R%) * 8766 * INFRAELECADJFACT(R%)\r"
  },
  {
    "Variable": "INFRAELECTRANLOSS",
    "UsesVariable": "infraelectranlossm",
    "Distance": 0,
    "Code": "\r\rINFRAELECTRANLOSS(R%) = INFRAELECTRANLOSS(R%) * infraelectranlossm(R%)\r\rINFRAELECTRANLOSS(R%) = AMAX(3, Amin(90, INFRAELECTRANLOSS(R%))) 'lower bound taken from 3 to 2\r"
  },
  {
    "Variable": "INFRAELECTRANLOSS",
    "UsesVariable": "extmafuncelectran",
    "Distance": 1,
    "Code": "\r\r'   All but First Call 2:  Electricity Transmission Loss\r'-------------------------------------------------------\r'sErrorSub = saveErrorSub + \" \" + RegName(R%) + \" Electricity Transmission\"\r\rIf Not InfraElecTranLossGR(R%).HasValue Then\r'cross-sectional model (2nd year only) for countries with not enough data for growth rate\r'Note MTI: check for transient between second and third year\rrVal = CSng(Math.Exp(3.1253418 - 0.124777 * GOVREGQUAL(R%) - 0.025779 * GDPPCP(R%)))\r\r'value was bound between 3 to 90 in data pre-processor\rrVal = Amin(90, AMAX(3, rVal))\r\rIf INFRAELECTRANLOSSShift(R%) > 0 Then\r'higher than function - let it come down (lower is better in his case)\rINFRAELECTRANLOSS(R%) = CSng(rVal + ConvergeOverTime(INFRAELECTRANLOSSShift(R%), 0, 50))\rElse\r'lower than function - keep there (lower is better in his case)\rINFRAELECTRANLOSS(R%) = CSng(rVal + ConvergeOverTime(INFRAELECTRANLOSSShift(R%), 0, 500))\rEnd If\rInfraElecTranLossGR(R%) = INFRAELECTRANLOSS(R%) / PreMultINFRAELECTRANLOSS(R%) - 1\rElse\r\r'extrapolative approach\rPrediction = CSng(Amin(90, AMAX(3, Math.Exp(3.1253418 - 0.124777 * GOVREGQUAL(R%) - 0.025779 * GDPPCP(R%)))))\rPrediction1 = CSng(Amin(90, AMAX(3, Math.Exp(3.1253418 - 0.124777 * SGOVREGQUAL(R%) - 0.025779 * sGDPPCP(R%)))))\r\r'extrapolative approach - can be negative\rInfraElecTranLossGR(R%) = CSng(CalcExtrapolativeGR(InfraElecTranLossGR(R%), extmafuncelectran, extmaposnelectran, CDbl(PreMultINFRAELECTRANLOSS(R%)), CDbl(Prediction), CDbl(Prediction1), extmaposnconvtimeelectran, , True, False))\rEnd If\r\r\r'   All but First Call 2:  Electricity Transmission Loss\r'-------------------------------------------------------\r'sErrorSub = saveErrorSub + \" \" + RegName(R%) + \" Electricity Transmission\"\r\rIf Not InfraElecTranLossGR(R%).HasValue Then\r'cross-sectional model (2nd year only) for countries with not enough data for growth rate\r'Note MTI: check for transient between second and third year\rrVal = CSng(Math.Exp(3.1253418 - 0.124777 * GOVREGQUAL(R%) - 0.025779 * GDPPCP(R%)))\r\r'value was bound between 3 to 90 in data pre-processor\rrVal = Amin(90, AMAX(3, rVal))\r\rIf INFRAELECTRANLOSSShift(R%) > 0 Then\r'higher than function - let it come down (lower is better in his case)\rINFRAELECTRANLOSS(R%) = CSng(rVal + ConvergeOverTime(INFRAELECTRANLOSSShift(R%), 0, 50))\rElse\r'lower than function - keep there (lower is better in his case)\rINFRAELECTRANLOSS(R%) = CSng(rVal + ConvergeOverTime(INFRAELECTRANLOSSShift(R%), 0, 500))\rEnd If\rInfraElecTranLossGR(R%) = INFRAELECTRANLOSS(R%) / PreMultINFRAELECTRANLOSS(R%) - 1\rElse\r\r'extrapolative approach\rPrediction = CSng(Amin(90, AMAX(3, Math.Exp(3.1253418 - 0.124777 * GOVREGQUAL(R%) - 0.025779 * GDPPCP(R%)))))\rPrediction1 = CSng(Amin(90, AMAX(3, Math.Exp(3.1253418 - 0.124777 * SGOVREGQUAL(R%) - 0.025779 * sGDPPCP(R%)))))\r\r'extrapolative approach - can be negative\rInfraElecTranLossGR(R%) = CSng(CalcExtrapolativeGR(InfraElecTranLossGR(R%), extmafuncelectran, extmaposnelectran, CDbl(PreMultINFRAELECTRANLOSS(R%)), CDbl(Prediction), CDbl(Prediction1), extmaposnconvtimeelectran, , True, False))\rEnd If\r\r\rINFRAELECTRANLOSS(R%) = If(PreMultINFRAELECTRANLOSS(R%) * (1 + InfraElecTranLossGR(R%)), 0)\r"
  },
  {
    "Variable": "INFRAELECTRANLOSS",
    "UsesVariable": "extmaposnelectran",
    "Distance": 1,
    "Code": "\r\r'   All but First Call 2:  Electricity Transmission Loss\r'-------------------------------------------------------\r'sErrorSub = saveErrorSub + \" \" + RegName(R%) + \" Electricity Transmission\"\r\rIf Not InfraElecTranLossGR(R%).HasValue Then\r'cross-sectional model (2nd year only) for countries with not enough data for growth rate\r'Note MTI: check for transient between second and third year\rrVal = CSng(Math.Exp(3.1253418 - 0.124777 * GOVREGQUAL(R%) - 0.025779 * GDPPCP(R%)))\r\r'value was bound between 3 to 90 in data pre-processor\rrVal = Amin(90, AMAX(3, rVal))\r\rIf INFRAELECTRANLOSSShift(R%) > 0 Then\r'higher than function - let it come down (lower is better in his case)\rINFRAELECTRANLOSS(R%) = CSng(rVal + ConvergeOverTime(INFRAELECTRANLOSSShift(R%), 0, 50))\rElse\r'lower than function - keep there (lower is better in his case)\rINFRAELECTRANLOSS(R%) = CSng(rVal + ConvergeOverTime(INFRAELECTRANLOSSShift(R%), 0, 500))\rEnd If\rInfraElecTranLossGR(R%) = INFRAELECTRANLOSS(R%) / PreMultINFRAELECTRANLOSS(R%) - 1\rElse\r\r'extrapolative approach\rPrediction = CSng(Amin(90, AMAX(3, Math.Exp(3.1253418 - 0.124777 * GOVREGQUAL(R%) - 0.025779 * GDPPCP(R%)))))\rPrediction1 = CSng(Amin(90, AMAX(3, Math.Exp(3.1253418 - 0.124777 * SGOVREGQUAL(R%) - 0.025779 * sGDPPCP(R%)))))\r\r'extrapolative approach - can be negative\rInfraElecTranLossGR(R%) = CSng(CalcExtrapolativeGR(InfraElecTranLossGR(R%), extmafuncelectran, extmaposnelectran, CDbl(PreMultINFRAELECTRANLOSS(R%)), CDbl(Prediction), CDbl(Prediction1), extmaposnconvtimeelectran, , True, False))\rEnd If\r"
  },
  {
    "Variable": "INFRAELECTRANLOSS",
    "UsesVariable": "extmaposnconvtimeelectran",
    "Distance": 1,
    "Code": "\r\r'   All but First Call 2:  Electricity Transmission Loss\r'-------------------------------------------------------\r'sErrorSub = saveErrorSub + \" \" + RegName(R%) + \" Electricity Transmission\"\r\rIf Not InfraElecTranLossGR(R%).HasValue Then\r'cross-sectional model (2nd year only) for countries with not enough data for growth rate\r'Note MTI: check for transient between second and third year\rrVal = CSng(Math.Exp(3.1253418 - 0.124777 * GOVREGQUAL(R%) - 0.025779 * GDPPCP(R%)))\r\r'value was bound between 3 to 90 in data pre-processor\rrVal = Amin(90, AMAX(3, rVal))\r\rIf INFRAELECTRANLOSSShift(R%) > 0 Then\r'higher than function - let it come down (lower is better in his case)\rINFRAELECTRANLOSS(R%) = CSng(rVal + ConvergeOverTime(INFRAELECTRANLOSSShift(R%), 0, 50))\rElse\r'lower than function - keep there (lower is better in his case)\rINFRAELECTRANLOSS(R%) = CSng(rVal + ConvergeOverTime(INFRAELECTRANLOSSShift(R%), 0, 500))\rEnd If\rInfraElecTranLossGR(R%) = INFRAELECTRANLOSS(R%) / PreMultINFRAELECTRANLOSS(R%) - 1\rElse\r\r'extrapolative approach\rPrediction = CSng(Amin(90, AMAX(3, Math.Exp(3.1253418 - 0.124777 * GOVREGQUAL(R%) - 0.025779 * GDPPCP(R%)))))\rPrediction1 = CSng(Amin(90, AMAX(3, Math.Exp(3.1253418 - 0.124777 * SGOVREGQUAL(R%) - 0.025779 * sGDPPCP(R%)))))\r\r'extrapolative approach - can be negative\rInfraElecTranLossGR(R%) = CSng(CalcExtrapolativeGR(InfraElecTranLossGR(R%), extmafuncelectran, extmaposnelectran, CDbl(PreMultINFRAELECTRANLOSS(R%)), CDbl(Prediction), CDbl(Prediction1), extmaposnconvtimeelectran, , True, False))\rEnd If\r\r\r'   All but First Call 2:  Electricity Transmission Loss\r'-------------------------------------------------------\r'sErrorSub = saveErrorSub + \" \" + RegName(R%) + \" Electricity Transmission\"\r\rIf Not InfraElecTranLossGR(R%).HasValue Then\r'cross-sectional model (2nd year only) for countries with not enough data for growth rate\r'Note MTI: check for transient between second and third year\rrVal = CSng(Math.Exp(3.1253418 - 0.124777 * GOVREGQUAL(R%) - 0.025779 * GDPPCP(R%)))\r\r'value was bound between 3 to 90 in data pre-processor\rrVal = Amin(90, AMAX(3, rVal))\r\rIf INFRAELECTRANLOSSShift(R%) > 0 Then\r'higher than function - let it come down (lower is better in his case)\rINFRAELECTRANLOSS(R%) = CSng(rVal + ConvergeOverTime(INFRAELECTRANLOSSShift(R%), 0, 50))\rElse\r'lower than function - keep there (lower is better in his case)\rINFRAELECTRANLOSS(R%) = CSng(rVal + ConvergeOverTime(INFRAELECTRANLOSSShift(R%), 0, 500))\rEnd If\rInfraElecTranLossGR(R%) = INFRAELECTRANLOSS(R%) / PreMultINFRAELECTRANLOSS(R%) - 1\rElse\r\r'extrapolative approach\rPrediction = CSng(Amin(90, AMAX(3, Math.Exp(3.1253418 - 0.124777 * GOVREGQUAL(R%) - 0.025779 * GDPPCP(R%)))))\rPrediction1 = CSng(Amin(90, AMAX(3, Math.Exp(3.1253418 - 0.124777 * SGOVREGQUAL(R%) - 0.025779 * sGDPPCP(R%)))))\r\r'extrapolative approach - can be negative\rInfraElecTranLossGR(R%) = CSng(CalcExtrapolativeGR(InfraElecTranLossGR(R%), extmafuncelectran, extmaposnelectran, CDbl(PreMultINFRAELECTRANLOSS(R%)), CDbl(Prediction), CDbl(Prediction1), extmaposnconvtimeelectran, , True, False))\rEnd If\r"
  },
  {
    "Variable": "INFRAELECTRANLOSS",
    "UsesVariable": "GOVREGQUAL",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "INFRAELECTRANLOSS",
    "UsesVariable": "GDPPCP",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "INFRAINDELEC",
    "UsesVariable": "infraindeleccompwt",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAINDELEC",
    "UsesVariable": "INFRAINDELECCOMPSDI",
    "Distance": 1,
    "Code": "\rFor IICCnt% = 1 To NInfraIndElecComp%\rTotComp = TotComp + infraindeleccompwt(IICCnt%)\r\rFor IICCnt% = 1 To NInfraIndElecComp%\r'zcomp = (InfraIndElecComp(IICCnt%) - INFRAINDELECCOMPMEANI(IICCnt%)) / INFRAINDELECCOMPSDI(IICCnt%)\r'ttt\rzcomp = If(INFRAINDELECCOMPSDI(IICCnt%) = 0, 0, (InfraIndElecComp(IICCnt%) - INFRAINDELECCOMPMEANI(IICCnt%)) / INFRAINDELECCOMPSDI(IICCnt%))\r\rNext\r'Dim WtPerCompElec = 1 / TotComp\r'ttt\rDim WtPerCompElec = If(TotComp = 0, 0, 1 / TotComp)\r"
  },
  {
    "Variable": "INFRAINDELEC",
    "UsesVariable": "INFRAINDELECCOMPMEANI",
    "Distance": 1,
    "Code": "\r\rInfraIndElecComp(Elec_Share) = CSng(Math.Log(ENELECSHRENDEM(R%)))    'electricity share of total energy\r"
  },
  {
    "Variable": "INFRAINDELEC",
    "UsesVariable": "ENELECSHRENDEM",
    "Distance": 3,
    "Code": "\r\rTotComp = 0\r"
  },
  {
    "Variable": "INFRAINDICT",
    "UsesVariable": "infraindictcompwt",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAINDICT",
    "UsesVariable": "ictmobilsaturation",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "INFRAINDICT",
    "UsesVariable": "ICTBROADMOBIL",
    "Distance": 2,
    "Code": "\rFor IICCnt% = 1 To NInfraIndexICTComp%\rTotComp = TotComp + infraindictcompwt(IICCnt%)\r"
  },
  {
    "Variable": "INFRAINDICTDEM",
    "UsesVariable": "infraindictcompwt",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAINDICTDEM",
    "UsesVariable": "ictmobilsaturation",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "INFRAINDICTDEM",
    "UsesVariable": "ICTBROADMOBILDEM",
    "Distance": 2,
    "Code": "\rFor IICCnt% = 1 To NInfraIndexICTComp%\rTotComp = TotComp + infraindictcompwt(IICCnt%)\r"
  },
  {
    "Variable": "INFRAINDICTDEM",
    "UsesVariable": "INFRAINDICT",
    "Distance": 0,
    "Code": "\r\r\r'mti May 2011 -start\r'If RegName(R%) = \"Sweden\" Then Stop\rIf IY = 1 Then\rSSINFRAINDICT(R%) = INFRAINDICT(R%)\rSSINFRAINDICTDEM(R%) = INFRAINDICTDEM(R%)\r\rINFRAINDICTDEM(R%) = INFRAINDICT(R%)\rElse\rInfraICTIndCompDem(Fixed_Phone) = Amin(100, AMAX(0, INFRATELEDEM(R%)))\rInfraICTIndCompDem(Fixed_Broadband) = Amin(100, AMAX(0, ICTBROADDEM(R%)))\rInfraICTIndCompDem(Mobile_Phone) = Amin(ictmobilsaturation, ICTMOBILDEM(R%)) * To100Fact\rInfraICTIndCompDem(Mobile_Broadband) = Amin(ictmobilsaturation, ICTBROADMOBILDEM(R%)) * To100Fact\r\rINFRAINDICTDEM(R%) = 0\rFor IICCnt% = 1 To NInfraIndexICTComp%\rINFRAINDICTDEM(R%) = INFRAINDICTDEM(R%) + infraindictcompwt(IICCnt%) * WtPerCompICT * InfraICTIndCompDem(IICCnt%)\rNext\r\rSSINFRAINDICT(R%) = SINFRAINDICT(R%)\rSSINFRAINDICTDEM(R%) = SINFRAINDICTDEM(R%)\rEnd If\r\r\r\r'mti May 2011 -start\r'If RegName(R%) = \"Sweden\" Then Stop\rIf IY = 1 Then\rSSINFRAINDICT(R%) = INFRAINDICT(R%)\rSSINFRAINDICTDEM(R%) = INFRAINDICTDEM(R%)\r\rINFRAINDICTDEM(R%) = INFRAINDICT(R%)\rElse\rInfraICTIndCompDem(Fixed_Phone) = Amin(100, AMAX(0, INFRATELEDEM(R%)))\rInfraICTIndCompDem(Fixed_Broadband) = Amin(100, AMAX(0, ICTBROADDEM(R%)))\rInfraICTIndCompDem(Mobile_Phone) = Amin(ictmobilsaturation, ICTMOBILDEM(R%)) * To100Fact\rInfraICTIndCompDem(Mobile_Broadband) = Amin(ictmobilsaturation, ICTBROADMOBILDEM(R%)) * To100Fact\r\rINFRAINDICTDEM(R%) = 0\rFor IICCnt% = 1 To NInfraIndexICTComp%\rINFRAINDICTDEM(R%) = INFRAINDICTDEM(R%) + infraindictcompwt(IICCnt%) * WtPerCompICT * InfraICTIndCompDem(IICCnt%)\rNext\r\rSSINFRAINDICT(R%) = SINFRAINDICT(R%)\rSSINFRAINDICTDEM(R%) = SINFRAINDICTDEM(R%)\rEnd If\r"
  },
  {
    "Variable": "INFRAINDICTZ",
    "UsesVariable": "infraindictzcompwt",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAINDICTZ",
    "UsesVariable": "INFRAINDICTZCOMPMEANI",
    "Distance": 1,
    "Code": "\r\rInfraIndICTzComp(Mobile_Broadband) = CSng(Math.Log(AMAX(0.0001, ICTBROADMOBIL(R%)) / 100))\r\rFor IICCnt% = 1 To NInfraIndexICTComp%\rTotComp = TotComp + infraindictzcompwt(IICCnt%)\r\r\rFor IICCnt% = 1 To NInfraIndexICTComp%\r'mti June 14, 2012 -start\r'zcomp = (InfraIndICTzComp(IICCnt%) - INFRAINDICTZCOMPMEANI(IICCnt%)) / INFRAINDICTZCOMPSDI(IICCnt%)\r\rIf INFRAINDICTZCOMPSDI(IICCnt%) <> 0 Then\rzcomp = (InfraIndICTzComp(IICCnt%) - INFRAINDICTZCOMPMEANI(IICCnt%)) / INFRAINDICTZCOMPSDI(IICCnt%)\rEnd If\r\rNext\r'Dim WtPerCompICTz = 1 / TotComp\r'ttt\rDim WtPerCompICTz = If(TotComp = 0, 0, 1 / TotComp)\r"
  },
  {
    "Variable": "INFRAINDICTZ",
    "UsesVariable": "INFRAINDICTZCOMPSDI",
    "Distance": 1,
    "Code": "\r\rInfraIndICTzComp(Mobile_Broadband) = CSng(Math.Log(AMAX(0.0001, ICTBROADMOBIL(R%)) / 100))\r"
  },
  {
    "Variable": "INFRAINDICTZ",
    "UsesVariable": "ICTBROADMOBIL",
    "Distance": 3,
    "Code": "\r'mti February 28, 2012 - Start\rTotComp = 0\r"
  },
  {
    "Variable": "INFRAINDTRAD",
    "UsesVariable": "INFRAINDTRAN",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAINDTRAD",
    "UsesVariable": "INFRAINDELEC",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAINDTRAD",
    "UsesVariable": "INFRAINDWATSAN",
    "Distance": 0,
    "Code": "\rNext\r\r\r'mti July 18, 2011 - start\r'        If RegName(R%) = \"Sweden\" Or RegName(R%) = \"United States of America\" Or RegName(R%) = \"Zambia\" Or RegName(R%) = \"China\" Or RegName(R%) = \"Chad\" Or RegName(R%) = \"India\" Or RegName(R%) = \"Brazil\" Then\r'            Stop\r'            INFRAINDICT(R%) = INFRAINDICT(R%) + Abs(INFRAINDICT(R%) * (Amin(0.5, (IY - 1) * (1.5 - 1) / 10)))\r'            INFRAINDICT(R%) = Amin(100, INFRAINDICT(R%))\r'        End If\r\r'mti 2014/05/28 - start\rIf Not context.HistoricMode Then\rINFRAINDTRAD(R%) = (INFRAINDTRAN(R%) + INFRAINDELEC(R%) + INFRAINDWATSAN(R%)) / 3\rElse\r'too much rise in sanitation and watsafe - they have been excluded from infratrad index to check MFPPC growth\rINFRAINDTRAD(R%) = (INFRAINDTRAN(R%) + INFRAINDELEC(R%)) / 2\rEnd If\r"
  },
  {
    "Variable": "INFRAINDTRADDEM",
    "UsesVariable": "infraindtrancompwt",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "INFRAINDTRADDEM",
    "UsesVariable": "infraindeleccompwt",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "INFRAINDTRADDEM",
    "UsesVariable": "infraindwatsancompwt",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "INFRAINDTRADDEM",
    "UsesVariable": "INFRAINDTRANCOMPMEANI",
    "Distance": 19,
    "Code": "\rInfraIndTranCompDem(Road_Paved) = CSng(Math.Log(AMAX(0.0001, INFRAROADPAVEDPCNTDEM(R%))))  'Road paved percent, lower bound set at one to avoid negative\r\rFor IICCnt% = 1 To NInfraIndTranComp%\rTotComp = TotComp + infraindtrancompwt(IICCnt%)\r\rFor IICCnt% = 1 To NInfraIndWatSanComp%\rZCompDem = (InfraIndWatSanCompDem(IICCnt%) - INFRAINDWATSANCOMPMEANI(IICCnt%)) / INFRAINDWATSANCOMPSDI(IICCnt%)\r\rNext\r'Dim WtPerCompWatSan = 1 / TotComp\r'ttt\rDim WtPerCompWatSan = If(TotComp = 0, 0, 1 / TotComp)\r"
  },
  {
    "Variable": "INFRAINDTRADDEM",
    "UsesVariable": "INFRAINDTRANCOMPSDI",
    "Distance": 19,
    "Code": "\rInfraIndTranCompDem(Road_Paved) = CSng(Math.Log(AMAX(0.0001, INFRAROADPAVEDPCNTDEM(R%))))  'Road paved percent, lower bound set at one to avoid negative\r"
  },
  {
    "Variable": "INFRAINDTRADDEM",
    "UsesVariable": "INFRAINDELECCOMPMEANI",
    "Distance": 12,
    "Code": "\rInfraIndElecCompDem(Elec_Share) = InfraIndElecComp(Elec_Share) 'Math.Log(ENELECSHRENDEM(R%))    'electricity share of total energy\r\rFor IICCnt% = 1 To NInfraIndElecComp%\rTotComp = TotComp + infraindeleccompwt(IICCnt%)\r"
  },
  {
    "Variable": "INFRAINDTRADDEM",
    "UsesVariable": "INFRAINDELECCOMPSDI",
    "Distance": 12,
    "Code": "\rInfraIndElecCompDem(Elec_Share) = InfraIndElecComp(Elec_Share) 'Math.Log(ENELECSHRENDEM(R%))    'electricity share of total energy\r"
  },
  {
    "Variable": "INFRAINDTRADDEM",
    "UsesVariable": "INFRAINDWATSANCOMPMEANI",
    "Distance": 2,
    "Code": "\rInfraIndWatSanCompDem(Watsan_WasteTreat) = CSng(Log(CSng(AMAX(0.0001, WATWASTETREATDEM(R%)))))  'waste water treatment access, household connection percentage, lower bound set at one to avoid negative\r\rFor IICCnt% = 1 To NInfraIndWatSanComp%\rTotComp = TotComp + infraindwatsancompwt(IICCnt%)\r"
  },
  {
    "Variable": "INFRAINDTRADDEM",
    "UsesVariable": "INFRAINDWATSANCOMPSDI",
    "Distance": 2,
    "Code": "\rInfraIndWatSanCompDem(Watsan_WasteTreat) = CSng(Log(CSng(AMAX(0.0001, WATWASTETREATDEM(R%)))))  'waste water treatment access, household connection percentage, lower bound set at one to avoid negative\r"
  },
  {
    "Variable": "INFRAINDTRADDEM",
    "UsesVariable": "INFRAROADPAVEDPCNTDEM",
    "Distance": 22,
    "Code": "\rTotComp = 0\r"
  },
  {
    "Variable": "INFRAINDTRADDEM",
    "UsesVariable": "WATWASTETREATDEM",
    "Distance": 4,
    "Code": "\r'mti June 08, 2011  - end\r\rDim TotComp As Single = 0\r"
  },
  {
    "Variable": "INFRAINDTRADDEM",
    "UsesVariable": "ENELECSHRENDEM",
    "Distance": 49,
    "Code": "\r'mti June 08, 2011  - end\r\rDim TotComp As Single = 0\r"
  },
  {
    "Variable": "INFRAINDTRADDEM",
    "UsesVariable": "INFRAINDTRAD",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:End If:16182|\r'mti 2014/05/28 - end\r\r'   If RegName(R%) = \"Afghanistan\" And IY < 5 Then Debug.Print IY; INFRAINDTRAD(R%); INFRAINDTRAN(R%); INFRAINDELEC(R%); INFRAINDWATSAN(R%)\r'mti October 20, 2011 - start\rIf IY = 1 Then\rINFRAINDTRADDEM(R%) = INFRAINDTRAD(R%)\r"
  },
  {
    "Variable": "INFRAINDTRADEXP",
    "UsesVariable": "GDPPCP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "INFRAINDTRAN",
    "UsesVariable": "infraindtrancompwt",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAINDTRAN",
    "UsesVariable": "INFRAINDTRANCOMPSDI",
    "Distance": 1,
    "Code": "\rFor IICCnt% = 1 To NInfraIndTranComp%\rTotComp = TotComp + infraindtrancompwt(IICCnt%)\r\rFor IICCnt% = 1 To NInfraIndTranComp%\r'zcomp = (InfraIndTranComp(IICCnt%) - INFRAINDTRANCOMPMEANI(IICCnt%)) / INFRAINDTRANCOMPSDI(IICCnt%)\r'ttt\rzcomp = If(INFRAINDTRANCOMPSDI(IICCnt%) = 0, 0, (InfraIndTranComp(IICCnt%) - INFRAINDTRANCOMPMEANI(IICCnt%)) / INFRAINDTRANCOMPSDI(IICCnt%))\r\rNext\r'Dim WtPerCompTran = 1 / TotComp\r'ttt\rDim WtPerCompTran = If(TotComp = 0, 0, 1 / TotComp)\r"
  },
  {
    "Variable": "INFRAINDTRAN",
    "UsesVariable": "INFRAINDTRANCOMPMEANI",
    "Distance": 1,
    "Code": "\rInfraIndTranComp(Road_Paved) = CSng(Math.Log(AMAX(0.0001, INFRAROADPAVEDPCNT(R%))))  'Road paved percent, lower bound set at one to avoid negative\r"
  },
  {
    "Variable": "INFRAINDTRAN",
    "UsesVariable": "INFRAROADPAVEDPCNT",
    "Distance": 4,
    "Code": "\rTotComp = 0\r"
  },
  {
    "Variable": "INFRAINDWATSAN",
    "UsesVariable": "infraindwatsancompwt",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAINDWATSAN",
    "UsesVariable": "INFRAINDWATSANCOMPMEANI",
    "Distance": 1,
    "Code": "\rInfraIndWatSanComp(Watsan_WasteTreat) = CSng(Log(CSng(AMAX(0.0001, WATWASTETREAT(R%)))))  'waste water treatment access, household connection percentage, lower bound set at one to avoid negative\r\rFor IICCnt% = 1 To NInfraIndWatSanComp%\rTotComp = TotComp + infraindwatsancompwt(IICCnt%)\r\r\r\rFor IICCnt% = 1 To NInfraIndWatSanComp%\rzcomp = (InfraIndWatSanComp(IICCnt%) - INFRAINDWATSANCOMPMEANI(IICCnt%)) / INFRAINDWATSANCOMPSDI(IICCnt%)\r\rNext\r'Dim WtPerCompWatSan = 1 / TotComp\r'ttt\rDim WtPerCompWatSan = If(TotComp = 0, 0, 1 / TotComp)\r"
  },
  {
    "Variable": "INFRAINDWATSAN",
    "UsesVariable": "INFRAINDWATSANCOMPSDI",
    "Distance": 1,
    "Code": "\rInfraIndWatSanComp(Watsan_WasteTreat) = CSng(Log(CSng(AMAX(0.0001, WATWASTETREAT(R%)))))  'waste water treatment access, household connection percentage, lower bound set at one to avoid negative\r"
  },
  {
    "Variable": "INFRAINDWATSAN",
    "UsesVariable": "WATWASTETREAT",
    "Distance": 3,
    "Code": "\r'mti June 08, 2011  - end\r\rDim TotComp As Single = 0\r"
  },
  {
    "Variable": "INFRAINVESTMAINT",
    "UsesVariable": "infrainvmaintpubshrm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAINVESTMAINT",
    "UsesVariable": "INFRATELE",
    "Distance": 371,
    "Code": "0"
  },
  {
    "Variable": "INFRAINVESTMAINT",
    "UsesVariable": "infraelecaccurbanlife",
    "Distance": 826,
    "Code": "0"
  },
  {
    "Variable": "INFRAINVESTMAINT",
    "UsesVariable": "INFRAINVESTMAINTPUB",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "INFRAINVESTMAINT",
    "UsesVariable": "INFRABUDDEMMNT",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "INFRAINVESTMAINT",
    "UsesVariable": "WATWASTETREAT",
    "Distance": 0,
    "Code": "\rINFRAINVESTMAINT(R%, WasteWater) = CSng(SWATWASTETREAT(R%) * CDbl(sPOPTotal(R%)) * DeppcntWS(WasteWater) * WATWASTETREATCOST(R%) / 100) 'million people * 1000 $ = billion $)\r\r\r'mti July 25, 2012 -moved this - moved back to where it was to avoid run to run\r'sGDPPCP(R%) = GDPPCP(R%)\r\r'mti February 2011 Infarstructure - end\r\r\r'******** All Years but first: Water and Sanitation *********************\r'***************************** end *************************************\r'********'sum infrastructure investment across all infrastructure types (all years but 1): sum for first year is at IFsInfra (since that is called later\r'mti 2022/09/26 start\rIf watsafenewsw < 1 Then    'forward/funding linkage from watsan old (3 category)\r'mti 2022/09/26 End\rINFRAINVESTNEW(R%, InfraTot) = 0\rINFRAINVESTMAINT(R%, InfraTot) = 0\r\rINFRAINVESTNEWPUB(R%, InfraTot) = 0\rINFRAINVESTMAINTPUB(R%, InfraTot) = 0\r\rFor j = 1 To InfraTot - 1\rINFRAINVESTNEW(R%, InfraTot) = INFRAINVESTNEW(R%, InfraTot) + INFRAINVESTNEW(R%, j)\rINFRAINVESTMAINT(R%, InfraTot) = INFRAINVESTMAINT(R%, InfraTot) + INFRAINVESTMAINT(R%, j)\r\rINFRAINVESTNEWPUB(R%, InfraTot) = INFRAINVESTNEWPUB(R%, InfraTot) + INFRAINVESTNEWPUB(R%, j)\rINFRAINVESTMAINTPUB(R%, InfraTot) = INFRAINVESTMAINTPUB(R%, InfraTot) + INFRAINVESTMAINTPUB(R%, j)\rNext\r'mti 2022/09/26 start\rEnd If 'watsafenewsw < 1 Then\r\r\r'mti July 25, 2012 -moved this - moved back to where it was to avoid run to run\r'sGDPPCP(R%) = GDPPCP(R%)\r\r'mti February 2011 Infarstructure - end\r\r\r'******** All Years but first: Water and Sanitation *********************\r'***************************** end *************************************\r'********'sum infrastructure investment across all infrastructure types (all years but 1): sum for first year is at IFsInfra (since that is called later\r'mti 2022/09/26 start\rIf watsafenewsw < 1 Then    'forward/funding linkage from watsan old (3 category)\r'mti 2022/09/26 End\rINFRAINVESTNEW(R%, InfraTot) = 0\rINFRAINVESTMAINT(R%, InfraTot) = 0\r\rINFRAINVESTNEWPUB(R%, InfraTot) = 0\rINFRAINVESTMAINTPUB(R%, InfraTot) = 0\r\rFor j = 1 To InfraTot - 1\rINFRAINVESTNEW(R%, InfraTot) = INFRAINVESTNEW(R%, InfraTot) + INFRAINVESTNEW(R%, j)\rINFRAINVESTMAINT(R%, InfraTot) = INFRAINVESTMAINT(R%, InfraTot) + INFRAINVESTMAINT(R%, j)\r\rINFRAINVESTNEWPUB(R%, InfraTot) = INFRAINVESTNEWPUB(R%, InfraTot) + INFRAINVESTNEWPUB(R%, j)\rINFRAINVESTMAINTPUB(R%, InfraTot) = INFRAINVESTMAINTPUB(R%, InfraTot) + INFRAINVESTMAINTPUB(R%, j)\rNext\r'mti 2022/09/26 start\rEnd If 'watsafenewsw < 1 Then\r'mti 2022/09/26 End\r\r'If RegName(R%) = \"Albania\" And IY = 2 Then Debug.Print HealthExp, sGDPPCP(R%), SEDYRSAG25(R%), Poverty, RuralPop, WATSAFE(R%, 3)\r'mti 2015/03/04 - start\rFor j = 1 To 3\rWATERFILTERED(R%, j) = AMAX(0, Amin(100, WATERFILTERED(R%, j) * waterfilteredm(R%, j)))\rNext j\r'mti 2015/03/04 -end\r\rNext 'R%\r\rINFRAINVESTMAINT(R%, InfraTot) = 0\r\rINFRAINVESTMAINT(R%, InfraTot) = INFRAINVESTMAINT(R%, InfraTot) + INFRAINVESTMAINT(R%, j)\r\rINFRAINVESTMAINT(R%, BroadbandMobile) = 0\r"
  },
  {
    "Variable": "INFRAINVESTMAINT",
    "UsesVariable": "WATWASTETREATCOST",
    "Distance": 0,
    "Code": "\r'mti January 2011 - end\r'            INFRAINVESTMAINT(R%, WatSafeHH) = WATSAFE(R%, 3) * POP(R%) * 10000 * DeppcntWS(WatSafeHH) * WATSAFECOST(R%) / 1000000 / HHSIZE(R%) 'billion dollars\r\r'mti February 2011 Infarstructure -start\rDeppcntWS(WasteWater) = Math.Exp(Math.Log(2) / watwastetreatlife) - 1\r"
  },
  {
    "Variable": "INFRAINVESTMAINT",
    "UsesVariable": "watwastetreatlife",
    "Distance": 307,
    "Code": "\r'mti January 2011 - end\r'            INFRAINVESTMAINT(R%, WatSafeHH) = WATSAFE(R%, 3) * POP(R%) * 10000 * DeppcntWS(WatSafeHH) * WATSAFECOST(R%) / 1000000 / HHSIZE(R%) 'billion dollars\r\r'mti February 2011 Infarstructure -start\rDeppcntWS(WasteWater) = Math.Exp(Math.Log(2) / watwastetreatlife) - 1\r"
  },
  {
    "Variable": "INFRAINVESTMAINT",
    "UsesVariable": "SANITHHINVESTMAINT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAINVESTMAINT",
    "UsesVariable": "WATERHHINVESTMAINT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAINVESTMAINTPUB",
    "UsesVariable": "infrabudgetprotec",
    "Distance": 0,
    "Code": "\r\rFor j = 1 To NInfraType%\rDim BaseDemandNew = INFRAINVESTNEWBF(R%, j) * infrainvnewpubshrm(R%, j)\rDim TargetBaseDiffNew = AMAX(0, INFRAINVESTNEWPUB(R%, j) - BaseDemandNew)\rDim AddtoBaseNew = TargetBaseDiffNew * SurplustoBaseDemand / Sum_TargetBaseDiff\r'unless fund protection is sought, make sure base fund demand is met for all infra-types, and distribute the remainder proportionately,\rIf infrabudgetprotec(R%, j) = 0 Then INFRAINVESTNEWPUB(R%, j) = CSng(Amin(INFRAINVESTNEWPUB(R%, j), BaseDemandNew + AddtoBaseNew))\r\rDim BaseDemandMnt = INFRAINVESTMAINTBF(R%, j) * infrainvmaintpubshrm(R%, j)\rDim TargetBaseDiffMnt = AMAX(0, INFRAINVESTMAINTPUB(R%, j) - BaseDemandMnt)\rDim AddtoBaseMaint = TargetBaseDiffMnt * SurplustoBaseDemand / Sum_TargetBaseDiff\rIf infrabudgetprotec(R%, j) = 0 Then INFRAINVESTMAINTPUB(R%, j) = CSng(Amin(INFRAINVESTMAINTPUB(R%, j), BaseDemandMnt + AddtoBaseMaint))\rNext j\r\r\rFor j = 1 To NInfraType%\rDim BaseDemandNew = INFRAINVESTNEWBF(R%, j) * infrainvnewpubshrm(R%, j)\rDim TargetBaseDiffNew = AMAX(0, INFRAINVESTNEWPUB(R%, j) - BaseDemandNew)\rDim AddtoBaseNew = TargetBaseDiffNew * SurplustoBaseDemand / Sum_TargetBaseDiff\r'unless fund protection is sought, make sure base fund demand is met for all infra-types, and distribute the remainder proportionately,\rIf infrabudgetprotec(R%, j) = 0 Then INFRAINVESTNEWPUB(R%, j) = CSng(Amin(INFRAINVESTNEWPUB(R%, j), BaseDemandNew + AddtoBaseNew))\r\rDim BaseDemandMnt = INFRAINVESTMAINTBF(R%, j) * infrainvmaintpubshrm(R%, j)\rDim TargetBaseDiffMnt = AMAX(0, INFRAINVESTMAINTPUB(R%, j) - BaseDemandMnt)\rDim AddtoBaseMaint = TargetBaseDiffMnt * SurplustoBaseDemand / Sum_TargetBaseDiff\rIf infrabudgetprotec(R%, j) = 0 Then INFRAINVESTMAINTPUB(R%, j) = CSng(Amin(INFRAINVESTMAINTPUB(R%, j), BaseDemandMnt + AddtoBaseMaint))\rNext j\r\r\rFor j = 1 To NInfraType%\rDim BaseDemandNew = INFRAINVESTNEWBF(R%, j) * infrainvnewpubshrm(R%, j)\rDim TargetBaseDiffNew = AMAX(0, INFRAINVESTNEWPUB(R%, j) - BaseDemandNew)\rDim AddtoBaseNew = TargetBaseDiffNew * SurplustoBaseDemand / Sum_TargetBaseDiff\r'unless fund protection is sought, make sure base fund demand is met for all infra-types, and distribute the remainder proportionately,\rIf infrabudgetprotec(R%, j) = 0 Then INFRAINVESTNEWPUB(R%, j) = CSng(Amin(INFRAINVESTNEWPUB(R%, j), BaseDemandNew + AddtoBaseNew))\r\rDim BaseDemandMnt = INFRAINVESTMAINTBF(R%, j) * infrainvmaintpubshrm(R%, j)\rDim TargetBaseDiffMnt = AMAX(0, INFRAINVESTMAINTPUB(R%, j) - BaseDemandMnt)\rDim AddtoBaseMaint = TargetBaseDiffMnt * SurplustoBaseDemand / Sum_TargetBaseDiff\rIf infrabudgetprotec(R%, j) = 0 Then INFRAINVESTMAINTPUB(R%, j) = CSng(Amin(INFRAINVESTMAINTPUB(R%, j), BaseDemandMnt + AddtoBaseMaint))\rNext j\r"
  },
  {
    "Variable": "INFRAINVESTMAINTPUB",
    "UsesVariable": "infrainvmaintpubshrm",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "INFRAINVESTMAINTPUB",
    "UsesVariable": "INFRAINVESTMAINT",
    "Distance": 60,
    "Code": "0"
  },
  {
    "Variable": "INFRAINVESTMAINTPUB",
    "UsesVariable": "INFRAINVESTNEWPUB",
    "Distance": 14,
    "Code": "\r\r'reallocate to each task as base demand for the task\r'plus distribution of \"total surplus to base demand\" (if any) proportional to additional demand for each target (aka target base differential)\r\r'sum of additinal demand for target (i.e., target base differential) across all tasks\rDim Sum_TargetBaseDiff As Double = 0\r\rInfraPublicFundDemandBF = InfraPublicFundDemandBF + INFRAINVESTMAINTBF(R%, j) * infrainvmaintpubshrm(R%, j)\r"
  },
  {
    "Variable": "INFRAINVESTMAINTPUB",
    "UsesVariable": "infrainvnewpubshrm",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "INFRAINVESTMAINTPUB",
    "UsesVariable": "INFRAINVESTNEW",
    "Distance": 61,
    "Code": "0"
  },
  {
    "Variable": "INFRAINVESTMAINTPUB",
    "UsesVariable": "INFRABUDDEMMNT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAINVESTMAINTPUB",
    "UsesVariable": "GDS",
    "Distance": 389,
    "Code": "\r\r\rElse\r'  no boxcar for freemoney scenario; and GDS(R%, Infra) is as much as was demanded\rInfraBudImpact = GDS(R%, Infra) / AMAX(0.0001, InfraPublicFundDemand) 'supply  by demand\r\r\r'mti 2022/10/20 start Redim sInfraBudImpactByType(NR%, NInfraType%)\rFor j = 1 To NInfraType%\rsInfraBudImpactByType(R%, j) = CSng(InfraBudImpact)\rNext j\r'mti 2022/10/20 end\r\r"
  },
  {
    "Variable": "INFRAINVESTMAINTPUB",
    "UsesVariable": "INFRABUDDEMNEW",
    "Distance": 413,
    "Code": "0"
  },
  {
    "Variable": "INFRAINVESTMAINTPUB",
    "UsesVariable": "watsafenewsw",
    "Distance": 0,
    "Code": "\r\r'mti July 25, 2012 -moved this - moved back to where it was to avoid run to run\r'sGDPPCP(R%) = GDPPCP(R%)\r\r'mti February 2011 Infarstructure - end\r\r\r'******** All Years but first: Water and Sanitation *********************\r'***************************** end *************************************\r'********'sum infrastructure investment across all infrastructure types (all years but 1): sum for first year is at IFsInfra (since that is called later\r'mti 2022/09/26 start\rIf watsafenewsw < 1 Then    'forward/funding linkage from watsan old (3 category)\r'mti 2022/09/26 End\rINFRAINVESTNEW(R%, InfraTot) = 0\rINFRAINVESTMAINT(R%, InfraTot) = 0\r\rINFRAINVESTNEWPUB(R%, InfraTot) = 0\rINFRAINVESTMAINTPUB(R%, InfraTot) = 0\r\rFor j = 1 To InfraTot - 1\rINFRAINVESTNEW(R%, InfraTot) = INFRAINVESTNEW(R%, InfraTot) + INFRAINVESTNEW(R%, j)\rINFRAINVESTMAINT(R%, InfraTot) = INFRAINVESTMAINT(R%, InfraTot) + INFRAINVESTMAINT(R%, j)\r\rINFRAINVESTNEWPUB(R%, InfraTot) = INFRAINVESTNEWPUB(R%, InfraTot) + INFRAINVESTNEWPUB(R%, j)\rINFRAINVESTMAINTPUB(R%, InfraTot) = INFRAINVESTMAINTPUB(R%, InfraTot) + INFRAINVESTMAINTPUB(R%, j)\rNext\r'mti 2022/09/26 start\rEnd If 'watsafenewsw < 1 Then\r'mti 2022/09/26 End\r\r'If RegName(R%) = \"Albania\" And IY = 2 Then Debug.Print HealthExp, sGDPPCP(R%), SEDYRSAG25(R%), Poverty, RuralPop, WATSAFE(R%, 3)\r'mti 2015/03/04 - start\rFor j = 1 To 3\rWATERFILTERED(R%, j) = AMAX(0, Amin(100, WATERFILTERED(R%, j) * waterfilteredm(R%, j)))\rNext j\r'mti 2015/03/04 -end\r\rNext 'R%\r\rINFRAINVESTMAINTPUB(R%, InfraTot) = 0\r"
  },
  {
    "Variable": "INFRAINVESTNEW",
    "UsesVariable": "INFRAINVESTNEWPUB",
    "Distance": 11,
    "Code": "\r\rDim TotalFundsNewCon, PhysStckAdded, InvestNewConPri As Double\rIf Not IsICT Then\r'same deficit in public and private\rTotalFundsNewCon = INFRAINVESTNEWPUB(R%, InfraType) / infrainvnewpubshrm(R%, InfraType)\rPhysStckAdded = 1000 * TotalFundsNewCon / AMAX(0.01, UnitCostInThoUSAnd)  ' 1000* (billion $) / (thoUSAnd $/ha) =  1000 ha\rElse\r'no deficit in private for ICT\r'same logic maintained for ICT private (private sector) investment in a target scenario\rInvestNewConPri = (INFRABUDDEMNEW(R%, InfraType) / infrainvnewpubshrm(R%, InfraType)) * (1 - infrainvnewpubshrm(R%, InfraType))\r\rTotalFundsNewCon = INFRAINVESTNEWPUB(R%, InfraType) + InvestNewConPri\rPhysStckAdded = 1000 * TotalFundsNewCon / AMAX(0.01, UnitCostInThoUSAnd)  ' 1000* (billion $) / (thoUSAnd $/ha) =  1000 ha\rEnd If\r\r\rDim TotalFundsNewCon, PhysStckAdded, InvestNewConPri As Double\rIf Not IsICT Then\r'same deficit in public and private\rTotalFundsNewCon = INFRAINVESTNEWPUB(R%, InfraType) / infrainvnewpubshrm(R%, InfraType)\rPhysStckAdded = 1000 * TotalFundsNewCon / AMAX(0.01, UnitCostInThoUSAnd)  ' 1000* (billion $) / (thoUSAnd $/ha) =  1000 ha\rElse\r'no deficit in private for ICT\r'same logic maintained for ICT private (private sector) investment in a target scenario\rInvestNewConPri = (INFRABUDDEMNEW(R%, InfraType) / infrainvnewpubshrm(R%, InfraType)) * (1 - infrainvnewpubshrm(R%, InfraType))\r\rTotalFundsNewCon = INFRAINVESTNEWPUB(R%, InfraType) + InvestNewConPri\rPhysStckAdded = 1000 * TotalFundsNewCon / AMAX(0.01, UnitCostInThoUSAnd)  ' 1000* (billion $) / (thoUSAnd $/ha) =  1000 ha\rEnd If\r\r\r\r'readjust total investment - new construction\rINFRAINVESTNEW(R%, InfraType) = CSng(PhysStckAdded * UnitCostInThoUSAnd / 1000)  'in billion $\r\r\r\rPrivate Sub ICTMobilForecast(SGOVREGQUAL() As Single, sGDPPCP() As Single,\r                                     sPOPTotal() As Single, ByRef SMobil(,) As Single,\r                                     ByRef ICTMobilGR() As Single?, ByRef ICTMobilBF() As Single,\r                                     ByRef sICTMobilBF() As Single, ByRef sMobilBF(,) As Single,\r                                     ByRef ICTMobilGRBF() As Single?, ByRef INFRAINVESTNEWBF(,) As Single,\r                                     ByRef INFRAINVESTMAINTBF(,) As Single, DeppcntMobile As Double,\r                                     SICTMobil() As Single, context As IForecastContext)\r'----------------------------------------------------------------------\r'All Years but First: Access to Mobile phones\r\r'mti 2013/12/20 start\rIf context.HistoricMode AndAlso context.FirstYearHistory < 1990 Then\rFor R% = 1 To NR%\rICTMOBIL(R) = 0\rICTMobilGR(R) = 0\r\rICTMOBILCOST(R%) = 0\rINFRAINVESTNEW(R%, Mobile) = 0\rINFRAINVESTMAINT(R%, Mobile) = 0\r\rICTMobilBF(R%) = 0\rICTMobilGRBF(R%) = 0\r\rINFRAINVESTNEWBF(R%, Mobile) = 0\rINFRAINVESTMAINTBF(R%, Mobile) = 0\rNext\rExit Sub\rEnd If\r\r\rPrivate Sub ICTFixedBBForecast(ByRef SGOVREGQUAL() As Single, ByRef sGDPPCP() As Single, ByRef sPOPTotal() As Single,\r                                       ByRef SBroad(,) As Single, ByRef ICTBroadGR() As Single?, ByRef ICTBroadBF() As Single,\r                                       ByRef sICTBroadBF() As Single, ByRef sBroadBF(,) As Single, ByRef ICTBroadGRBF() As Single?,\r                                       ByRef INFRAINVESTNEWBF(,) As Single, ByRef INFRAINVESTMAINTBF(,) As Single, DeppcntBroad As Double,\r                                       ByRef SICTBroad() As Single, ByRef SSINFRATELE() As Double, ByRef SINFRATELE() As Double,\r                                       ByRef iICTBroad() As Single, ByRef ictbroadtrgtyr() As Single, ByRef ictbroadtrgtval() As Single, context As IForecastContext)\r'----------------------------------------------------------------------------------------------------------------------------------\r'mti June 14, 2012 - start\r\r'mti 2013/12/20 start\rIf context.HistoricMode = True AndAlso context.FirstYearHistory < 1990 Then\r'no Fixed BB for pre-1990 hist base\rFor R% = 1 To NR%\rICTBROAD(R) = 0\rICTBroadGR(R) = 0\r\rICTBROADCOST(R%) = 0\rINFRAINVESTNEW(R%, Broadband) = 0\rINFRAINVESTMAINT(R%, Broadband) = 0\r\rICTBroadBF(R%) = 0\rICTBroadGRBF(R%) = 0\rINFRAINVESTNEWBF(R%, Broadband) = 0\rINFRAINVESTMAINTBF(R%, Broadband) = 0\rNext\rExit Sub\rEnd If\r"
  },
  {
    "Variable": "INFRAINVESTNEW",
    "UsesVariable": "INFRABUDDEMNEW",
    "Distance": 12,
    "Code": "\r\rDim TotalFundsNewCon, PhysStckAdded, InvestNewConPri As Double\rIf Not IsICT Then\r'same deficit in public and private\rTotalFundsNewCon = INFRAINVESTNEWPUB(R%, InfraType) / infrainvnewpubshrm(R%, InfraType)\rPhysStckAdded = 1000 * TotalFundsNewCon / AMAX(0.01, UnitCostInThoUSAnd)  ' 1000* (billion $) / (thoUSAnd $/ha) =  1000 ha\rElse\r'no deficit in private for ICT\r'same logic maintained for ICT private (private sector) investment in a target scenario\rInvestNewConPri = (INFRABUDDEMNEW(R%, InfraType) / infrainvnewpubshrm(R%, InfraType)) * (1 - infrainvnewpubshrm(R%, InfraType))\r\rTotalFundsNewCon = INFRAINVESTNEWPUB(R%, InfraType) + InvestNewConPri\rPhysStckAdded = 1000 * TotalFundsNewCon / AMAX(0.01, UnitCostInThoUSAnd)  ' 1000* (billion $) / (thoUSAnd $/ha) =  1000 ha\rEnd If\r"
  },
  {
    "Variable": "INFRAINVESTNEW",
    "UsesVariable": "infrainvnewpubshrm",
    "Distance": 12,
    "Code": "\r\rDim TotalFundsNewCon, PhysStckAdded, InvestNewConPri As Double\rIf Not IsICT Then\r'same deficit in public and private\rTotalFundsNewCon = INFRAINVESTNEWPUB(R%, InfraType) / infrainvnewpubshrm(R%, InfraType)\rPhysStckAdded = 1000 * TotalFundsNewCon / AMAX(0.01, UnitCostInThoUSAnd)  ' 1000* (billion $) / (thoUSAnd $/ha) =  1000 ha\rElse\r'no deficit in private for ICT\r'same logic maintained for ICT private (private sector) investment in a target scenario\rInvestNewConPri = (INFRABUDDEMNEW(R%, InfraType) / infrainvnewpubshrm(R%, InfraType)) * (1 - infrainvnewpubshrm(R%, InfraType))\r\rTotalFundsNewCon = INFRAINVESTNEWPUB(R%, InfraType) + InvestNewConPri\rPhysStckAdded = 1000 * TotalFundsNewCon / AMAX(0.01, UnitCostInThoUSAnd)  ' 1000* (billion $) / (thoUSAnd $/ha) =  1000 ha\rEnd If\r"
  },
  {
    "Variable": "INFRAINVESTNEW",
    "UsesVariable": "WATWASTETREATCOST",
    "Distance": 0,
    "Code": "\r'mti June 04, 2012 - end\r\r'base forecast\r'            PredictionBF = 100 / (1 + Exp(2.4821024086192 - 3.82380937051429E-02 * sGDPPCP(R%) - 2.88342684215034E-02 * WATWASTEBF(R%)))\r'            WatWasteTreatBF(R%) = PredictionBF + WWTAdd\r'            WatWasteTreatBF(R%) = Amin(WATWASTEBF(R%), WatWasteTreatBF(R%))\r\r'--cost of new construction of treatment plants ---------\rDim WATWASTETREATAdded = WATWASTETREAT(R%) * POP(R%) / 100 - SWATWASTETREAT(R%) * CDbl(sPOPTotal(R%)) / 100 'million people added\r\r'mti October 20, 2011 - end\r\rINFRAINVESTNEW(R%, WasteWater) = AMAX(WATWASTETREATAdded, 0) * WATWASTETREATCOST(R%)  'million people * 1000 $ = billion $\r\r\r'mti July 25, 2012 -moved this - moved back to where it was to avoid run to run\r'sGDPPCP(R%) = GDPPCP(R%)\r\r'mti February 2011 Infarstructure - end\r\r\r'******** All Years but first: Water and Sanitation *********************\r'***************************** end *************************************\r'********'sum infrastructure investment across all infrastructure types (all years but 1): sum for first year is at IFsInfra (since that is called later\r'mti 2022/09/26 start\rIf watsafenewsw < 1 Then    'forward/funding linkage from watsan old (3 category)\r'mti 2022/09/26 End\rINFRAINVESTNEW(R%, InfraTot) = 0\rINFRAINVESTMAINT(R%, InfraTot) = 0\r\rINFRAINVESTNEWPUB(R%, InfraTot) = 0\rINFRAINVESTMAINTPUB(R%, InfraTot) = 0\r\rFor j = 1 To InfraTot - 1\rINFRAINVESTNEW(R%, InfraTot) = INFRAINVESTNEW(R%, InfraTot) + INFRAINVESTNEW(R%, j)\rINFRAINVESTMAINT(R%, InfraTot) = INFRAINVESTMAINT(R%, InfraTot) + INFRAINVESTMAINT(R%, j)\r\rINFRAINVESTNEWPUB(R%, InfraTot) = INFRAINVESTNEWPUB(R%, InfraTot) + INFRAINVESTNEWPUB(R%, j)\rINFRAINVESTMAINTPUB(R%, InfraTot) = INFRAINVESTMAINTPUB(R%, InfraTot) + INFRAINVESTMAINTPUB(R%, j)\rNext\r'mti 2022/09/26 start\rEnd If 'watsafenewsw < 1 Then\r\r\r'mti July 25, 2012 -moved this - moved back to where it was to avoid run to run\r'sGDPPCP(R%) = GDPPCP(R%)\r\r'mti February 2011 Infarstructure - end\r\r\r'******** All Years but first: Water and Sanitation *********************\r'***************************** end *************************************\r'********'sum infrastructure investment across all infrastructure types (all years but 1): sum for first year is at IFsInfra (since that is called later\r'mti 2022/09/26 start\rIf watsafenewsw < 1 Then    'forward/funding linkage from watsan old (3 category)\r'mti 2022/09/26 End\rINFRAINVESTNEW(R%, InfraTot) = 0\rINFRAINVESTMAINT(R%, InfraTot) = 0\r\rINFRAINVESTNEWPUB(R%, InfraTot) = 0\rINFRAINVESTMAINTPUB(R%, InfraTot) = 0\r\rFor j = 1 To InfraTot - 1\rINFRAINVESTNEW(R%, InfraTot) = INFRAINVESTNEW(R%, InfraTot) + INFRAINVESTNEW(R%, j)\rINFRAINVESTMAINT(R%, InfraTot) = INFRAINVESTMAINT(R%, InfraTot) + INFRAINVESTMAINT(R%, j)\r\rINFRAINVESTNEWPUB(R%, InfraTot) = INFRAINVESTNEWPUB(R%, InfraTot) + INFRAINVESTNEWPUB(R%, j)\rINFRAINVESTMAINTPUB(R%, InfraTot) = INFRAINVESTMAINTPUB(R%, InfraTot) + INFRAINVESTMAINTPUB(R%, j)\rNext\r'mti 2022/09/26 start\rEnd If 'watsafenewsw < 1 Then\r'mti 2022/09/26 End\r\r'If RegName(R%) = \"Albania\" And IY = 2 Then Debug.Print HealthExp, sGDPPCP(R%), SEDYRSAG25(R%), Poverty, RuralPop, WATSAFE(R%, 3)\r'mti 2015/03/04 - start\rFor j = 1 To 3\rWATERFILTERED(R%, j) = AMAX(0, Amin(100, WATERFILTERED(R%, j) * waterfilteredm(R%, j)))\rNext j\r'mti 2015/03/04 -end\r\rNext 'R%\r\r'ttt 2019/10/08 Taken Out\r'sgdpp(R%) = GDPP(R%)\r'sLANDAREA(R%) = LANDAREA(R%)\r'sGDPPCP(R%) = GDPPCP(R%)\r\r'SICTMobil(R%) = ICTMOBIL(R%)\r'SICTBroad(R%) = ICTBROAD(R%)\r\r'INFRAROADRUnConstrained(R%) = InfraRoadGR(R%)\r\r'sum investment across all infrastructure types (year 1): sum for latter year is at IFsInfraWatsan (since that is called later)\rINFRAINVESTNEW(R%, InfraTot) = 0\r\r\r\rFor j = 1 To NInfraType%\rINFRAINVESTNEW(R%, InfraTot) = INFRAINVESTNEW(R%, InfraTot) + INFRAINVESTNEW(R%, j)\r\rINFRAINVESTNEW(R%, BroadbandMobile) = 0\r"
  },
  {
    "Variable": "INFRAINVESTNEW",
    "UsesVariable": "WATWASTETREAT",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "INFRAINVESTNEW",
    "UsesVariable": "POP",
    "Distance": 2,
    "Code": "\r'mti June 04, 2012 - end\r\r'base forecast\r'            PredictionBF = 100 / (1 + Exp(2.4821024086192 - 3.82380937051429E-02 * sGDPPCP(R%) - 2.88342684215034E-02 * WATWASTEBF(R%)))\r'            WatWasteTreatBF(R%) = PredictionBF + WWTAdd\r'            WatWasteTreatBF(R%) = Amin(WATWASTEBF(R%), WatWasteTreatBF(R%))\r\r'--cost of new construction of treatment plants ---------\rDim WATWASTETREATAdded = WATWASTETREAT(R%) * POP(R%) / 100 - SWATWASTETREAT(R%) * CDbl(sPOPTotal(R%)) / 100 'million people added\r"
  },
  {
    "Variable": "INFRAINVESTNEW",
    "UsesVariable": "SANITHHINVESTCAP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAINVESTNEW",
    "UsesVariable": "WATERHHINVESTCAP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAINVESTNEWPUB",
    "UsesVariable": "infrabudgetprotec",
    "Distance": 0,
    "Code": "\r\rFor j = 1 To NInfraType%\rDim BaseDemandNew = INFRAINVESTNEWBF(R%, j) * infrainvnewpubshrm(R%, j)\rDim TargetBaseDiffNew = AMAX(0, INFRAINVESTNEWPUB(R%, j) - BaseDemandNew)\rDim AddtoBaseNew = TargetBaseDiffNew * SurplustoBaseDemand / Sum_TargetBaseDiff\r'unless fund protection is sought, make sure base fund demand is met for all infra-types, and distribute the remainder proportionately,\rIf infrabudgetprotec(R%, j) = 0 Then INFRAINVESTNEWPUB(R%, j) = CSng(Amin(INFRAINVESTNEWPUB(R%, j), BaseDemandNew + AddtoBaseNew))\r\rDim BaseDemandMnt = INFRAINVESTMAINTBF(R%, j) * infrainvmaintpubshrm(R%, j)\rDim TargetBaseDiffMnt = AMAX(0, INFRAINVESTMAINTPUB(R%, j) - BaseDemandMnt)\rDim AddtoBaseMaint = TargetBaseDiffMnt * SurplustoBaseDemand / Sum_TargetBaseDiff\rIf infrabudgetprotec(R%, j) = 0 Then INFRAINVESTMAINTPUB(R%, j) = CSng(Amin(INFRAINVESTMAINTPUB(R%, j), BaseDemandMnt + AddtoBaseMaint))\rNext j\r\r\rFor j = 1 To NInfraType%\rDim BaseDemandNew = INFRAINVESTNEWBF(R%, j) * infrainvnewpubshrm(R%, j)\rDim TargetBaseDiffNew = AMAX(0, INFRAINVESTNEWPUB(R%, j) - BaseDemandNew)\rDim AddtoBaseNew = TargetBaseDiffNew * SurplustoBaseDemand / Sum_TargetBaseDiff\r'unless fund protection is sought, make sure base fund demand is met for all infra-types, and distribute the remainder proportionately,\rIf infrabudgetprotec(R%, j) = 0 Then INFRAINVESTNEWPUB(R%, j) = CSng(Amin(INFRAINVESTNEWPUB(R%, j), BaseDemandNew + AddtoBaseNew))\r\rDim BaseDemandMnt = INFRAINVESTMAINTBF(R%, j) * infrainvmaintpubshrm(R%, j)\rDim TargetBaseDiffMnt = AMAX(0, INFRAINVESTMAINTPUB(R%, j) - BaseDemandMnt)\rDim AddtoBaseMaint = TargetBaseDiffMnt * SurplustoBaseDemand / Sum_TargetBaseDiff\rIf infrabudgetprotec(R%, j) = 0 Then INFRAINVESTMAINTPUB(R%, j) = CSng(Amin(INFRAINVESTMAINTPUB(R%, j), BaseDemandMnt + AddtoBaseMaint))\rNext j\r\r\rFor j = 1 To NInfraType%\rDim BaseDemandNew = INFRAINVESTNEWBF(R%, j) * infrainvnewpubshrm(R%, j)\rDim TargetBaseDiffNew = AMAX(0, INFRAINVESTNEWPUB(R%, j) - BaseDemandNew)\rDim AddtoBaseNew = TargetBaseDiffNew * SurplustoBaseDemand / Sum_TargetBaseDiff\r'unless fund protection is sought, make sure base fund demand is met for all infra-types, and distribute the remainder proportionately,\rIf infrabudgetprotec(R%, j) = 0 Then INFRAINVESTNEWPUB(R%, j) = CSng(Amin(INFRAINVESTNEWPUB(R%, j), BaseDemandNew + AddtoBaseNew))\r\rDim BaseDemandMnt = INFRAINVESTMAINTBF(R%, j) * infrainvmaintpubshrm(R%, j)\rDim TargetBaseDiffMnt = AMAX(0, INFRAINVESTMAINTPUB(R%, j) - BaseDemandMnt)\rDim AddtoBaseMaint = TargetBaseDiffMnt * SurplustoBaseDemand / Sum_TargetBaseDiff\rIf infrabudgetprotec(R%, j) = 0 Then INFRAINVESTMAINTPUB(R%, j) = CSng(Amin(INFRAINVESTMAINTPUB(R%, j), BaseDemandMnt + AddtoBaseMaint))\rNext j\r"
  },
  {
    "Variable": "INFRAINVESTNEWPUB",
    "UsesVariable": "infrainvnewpubshrm",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "INFRAINVESTNEWPUB",
    "UsesVariable": "INFRAINVESTNEW",
    "Distance": 57,
    "Code": "0"
  },
  {
    "Variable": "INFRAINVESTNEWPUB",
    "UsesVariable": "INFRAINVESTMAINTPUB",
    "Distance": 9,
    "Code": "\rFor j = 1 To NInfraType%\r'target (public)  - base(all) * public share\rSum_TargetBaseDiff = Sum_TargetBaseDiff + AMAX(0, INFRAINVESTNEWPUB(R%, j) - INFRAINVESTNEWBF(R%, j) * infrainvnewpubshrm(R%, j))\rSum_TargetBaseDiff = Sum_TargetBaseDiff + AMAX(0, INFRAINVESTMAINTPUB(R%, j) - INFRAINVESTMAINTBF(R%, j) * infrainvmaintpubshrm(R%, j))\r\rNext j\r\rNext\rInfraPublicFundDemandBF = InfraPublicFundDemandBF * InfraCostGDSInfraRI(R%)  ' multiply by initial ratio, as it was done for the base demaand\r\r\rFor j = 1 To NInfraType%\rDim BaseDemandNew = INFRAINVESTNEWBF(R%, j) * infrainvnewpubshrm(R%, j)\rDim TargetBaseDiffNew = AMAX(0, INFRAINVESTNEWPUB(R%, j) - BaseDemandNew)\rDim AddtoBaseNew = TargetBaseDiffNew * SurplustoBaseDemand / Sum_TargetBaseDiff\r'unless fund protection is sought, make sure base fund demand is met for all infra-types, and distribute the remainder proportionately,\rIf infrabudgetprotec(R%, j) = 0 Then INFRAINVESTNEWPUB(R%, j) = CSng(Amin(INFRAINVESTNEWPUB(R%, j), BaseDemandNew + AddtoBaseNew))\r\rDim BaseDemandMnt = INFRAINVESTMAINTBF(R%, j) * infrainvmaintpubshrm(R%, j)\rDim TargetBaseDiffMnt = AMAX(0, INFRAINVESTMAINTPUB(R%, j) - BaseDemandMnt)\rDim AddtoBaseMaint = TargetBaseDiffMnt * SurplustoBaseDemand / Sum_TargetBaseDiff\rIf infrabudgetprotec(R%, j) = 0 Then INFRAINVESTMAINTPUB(R%, j) = CSng(Amin(INFRAINVESTMAINTPUB(R%, j), BaseDemandMnt + AddtoBaseMaint))\rNext j\r"
  },
  {
    "Variable": "INFRAINVESTNEWPUB",
    "UsesVariable": "infrainvmaintpubshrm",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "INFRAINVESTNEWPUB",
    "UsesVariable": "INFRAINVESTMAINT",
    "Distance": 56,
    "Code": "0"
  },
  {
    "Variable": "INFRAINVESTNEWPUB",
    "UsesVariable": "INFRABUDDEMNEW",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAINVESTNEWPUB",
    "UsesVariable": "GDS",
    "Distance": 388,
    "Code": "\r\r\rElse\r'  no boxcar for freemoney scenario; and GDS(R%, Infra) is as much as was demanded\rInfraBudImpact = GDS(R%, Infra) / AMAX(0.0001, InfraPublicFundDemand) 'supply  by demand\r\r\r'mti 2022/10/20 start Redim sInfraBudImpactByType(NR%, NInfraType%)\rFor j = 1 To NInfraType%\rsInfraBudImpactByType(R%, j) = CSng(InfraBudImpact)\rNext j\r'mti 2022/10/20 end\r\r"
  },
  {
    "Variable": "INFRAINVESTNEWPUB",
    "UsesVariable": "INFRABUDDEMMNT",
    "Distance": 412,
    "Code": "0"
  },
  {
    "Variable": "INFRANET",
    "UsesVariable": "NUMNWP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRANET",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRANET",
    "UsesVariable": "infranetm",
    "Distance": 0,
    "Code": "\r\r'   All but First Call 2: Estimate (Desired) ICT Network (old variable)\r'---------------------------------------------------------------------\r'Note MTI: Legacy Variable, ask BBH to move it: BBH said we should do it in September 2012\r\r'sErrorSub = saveErrorSub + \" \" + RegName(R%) + \" InfraNet\"\r\rINFRANET(R%) = NUMNWP(R%) / AMAX(0.001, POP(R%)) * 100 * infranetm(R%)\r"
  },
  {
    "Variable": "INFRAROAD",
    "UsesVariable": "LANDAREA",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAROAD",
    "UsesVariable": "INFRAROADPAVEDPCNT",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "INFRAROAD",
    "UsesVariable": "WATWASTETREAT",
    "Distance": 524,
    "Code": "0"
  },
  {
    "Variable": "INFRAROAD",
    "UsesVariable": "POP",
    "Distance": 524,
    "Code": "0"
  },
  {
    "Variable": "INFRAROAD",
    "UsesVariable": "infraroadraitrgtyr",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "INFRAROAD",
    "UsesVariable": "infraroadraisetar",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "INFRAROAD",
    "UsesVariable": "INFRAROADDEM",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAROAD",
    "UsesVariable": "INFRAROADRAI",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAROAD",
    "UsesVariable": "infraroadraitrgtval",
    "Distance": 196,
    "Code": "0"
  },
  {
    "Variable": "INFRAROAD",
    "UsesVariable": "GDPP",
    "Distance": 31,
    "Code": "0"
  },
  {
    "Variable": "INFRAROAD",
    "UsesVariable": "infraroadraiseyrtar",
    "Distance": 16,
    "Code": "0"
  },
  {
    "Variable": "INFRAROAD",
    "UsesVariable": "infraroadm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAROAD",
    "UsesVariable": "mfpconv",
    "Distance": 0,
    "Code": "\rRoadDensShift(R%) = INFRAROAD(R%) - Prediction\r\r'current year drivers and forecast\r\rPrediction = ComputeRoadDensity(GDPP(R%), POP(R%), LANDAREA(R%))\r\r\r'If RegName(R%) = \"Bangladesh\" Then Stop\r'If IY = 2 Then Debug.Print RegName(R%); InfraRoadGR(R%)\r'If IY = 11 And GRPS(1, R) = \"Congo, Republic of\" Then Stop\rIf InfraRoadGR(R%).HasValue Then\r\r'Previous year's driver values and prediction obatained from those drivers\rDim Prediction1 = ComputeRoadDensity(sgdpp(R%), sPOPTotal(R%), sLANDAREA(R%))\r\r'Compute growth rate using extrapolative approach\r'Attempts to converge current value to expected value using:\r'a.growth due to the annual change in driver variables, b. growth to cover up positional gap, b. moving average with previous year's growth rate\rInfraRoadGR(R%) = CSng(CalcExtrapolativeGR(INFRAROADRUnConstrained(R%), CDbl(extmafuncroad), CDbl(extmaposnroad), CDbl(PreMultINFRAROAD(R%)), CDbl(Prediction), CDbl(Prediction1), CDbl(extmaposnconvtimeroad)))\r\r'apply growth rate on previous year's (base or pre-target or pre-multiplier) forecast\rINFRAROAD(R%) = CSng((1 + If(InfraRoadGR(R%), 0)) * PreMultINFRAROAD(R%))\r\rElse  'Growth rate could not be computed for lack of data: use cross-sectional model\rIf RoadDensShift(R%) > 0 Then 'data value higher than prediction - slower convergence\rINFRAROAD(R%) = Prediction + ConvergeOverTime(RoadDensShift(R%), 0, mfpconv(R%) * 6) 'mfpconv = 50 years\rElse\rINFRAROAD(R%) = Prediction + ConvergeOverTime(RoadDensShift(R%), 0, 40) 'mfpconv = 50 years\rEnd If\rEnd If\r"
  },
  {
    "Variable": "INFRAROAD",
    "UsesVariable": "extmafuncroad",
    "Distance": 1,
    "Code": "\r\r'If RegName(R%) = \"Bangladesh\" Then Stop\r'If IY = 2 Then Debug.Print RegName(R%); InfraRoadGR(R%)\r'If IY = 11 And GRPS(1, R) = \"Congo, Republic of\" Then Stop\rIf InfraRoadGR(R%).HasValue Then\r\r'Previous year's driver values and prediction obatained from those drivers\rDim Prediction1 = ComputeRoadDensity(sgdpp(R%), sPOPTotal(R%), sLANDAREA(R%))\r\r'Compute growth rate using extrapolative approach\r'Attempts to converge current value to expected value using:\r'a.growth due to the annual change in driver variables, b. growth to cover up positional gap, b. moving average with previous year's growth rate\rInfraRoadGR(R%) = CSng(CalcExtrapolativeGR(INFRAROADRUnConstrained(R%), CDbl(extmafuncroad), CDbl(extmaposnroad), CDbl(PreMultINFRAROAD(R%)), CDbl(Prediction), CDbl(Prediction1), CDbl(extmaposnconvtimeroad)))\r\r'apply growth rate on previous year's (base or pre-target or pre-multiplier) forecast\rINFRAROAD(R%) = CSng((1 + If(InfraRoadGR(R%), 0)) * PreMultINFRAROAD(R%))\r\rElse  'Growth rate could not be computed for lack of data: use cross-sectional model\rIf RoadDensShift(R%) > 0 Then 'data value higher than prediction - slower convergence\rINFRAROAD(R%) = Prediction + ConvergeOverTime(RoadDensShift(R%), 0, mfpconv(R%) * 6) 'mfpconv = 50 years\rElse\rINFRAROAD(R%) = Prediction + ConvergeOverTime(RoadDensShift(R%), 0, 40) 'mfpconv = 50 years\rEnd If\rEnd If\r\r\r'If RegName(R%) = \"Bangladesh\" Then Stop\r'If IY = 2 Then Debug.Print RegName(R%); InfraRoadGR(R%)\r'If IY = 11 And GRPS(1, R) = \"Congo, Republic of\" Then Stop\rIf InfraRoadGR(R%).HasValue Then\r\r'Previous year's driver values and prediction obatained from those drivers\rDim Prediction1 = ComputeRoadDensity(sgdpp(R%), sPOPTotal(R%), sLANDAREA(R%))\r\r'Compute growth rate using extrapolative approach\r'Attempts to converge current value to expected value using:\r'a.growth due to the annual change in driver variables, b. growth to cover up positional gap, b. moving average with previous year's growth rate\rInfraRoadGR(R%) = CSng(CalcExtrapolativeGR(INFRAROADRUnConstrained(R%), CDbl(extmafuncroad), CDbl(extmaposnroad), CDbl(PreMultINFRAROAD(R%)), CDbl(Prediction), CDbl(Prediction1), CDbl(extmaposnconvtimeroad)))\r\r'apply growth rate on previous year's (base or pre-target or pre-multiplier) forecast\rINFRAROAD(R%) = CSng((1 + If(InfraRoadGR(R%), 0)) * PreMultINFRAROAD(R%))\r\rElse  'Growth rate could not be computed for lack of data: use cross-sectional model\rIf RoadDensShift(R%) > 0 Then 'data value higher than prediction - slower convergence\rINFRAROAD(R%) = Prediction + ConvergeOverTime(RoadDensShift(R%), 0, mfpconv(R%) * 6) 'mfpconv = 50 years\rElse\rINFRAROAD(R%) = Prediction + ConvergeOverTime(RoadDensShift(R%), 0, 40) 'mfpconv = 50 years\rEnd If\rEnd If\r"
  },
  {
    "Variable": "INFRAROAD",
    "UsesVariable": "extmaposnroad",
    "Distance": 1,
    "Code": "\r\r'If RegName(R%) = \"Bangladesh\" Then Stop\r'If IY = 2 Then Debug.Print RegName(R%); InfraRoadGR(R%)\r'If IY = 11 And GRPS(1, R) = \"Congo, Republic of\" Then Stop\rIf InfraRoadGR(R%).HasValue Then\r\r'Previous year's driver values and prediction obatained from those drivers\rDim Prediction1 = ComputeRoadDensity(sgdpp(R%), sPOPTotal(R%), sLANDAREA(R%))\r\r'Compute growth rate using extrapolative approach\r'Attempts to converge current value to expected value using:\r'a.growth due to the annual change in driver variables, b. growth to cover up positional gap, b. moving average with previous year's growth rate\rInfraRoadGR(R%) = CSng(CalcExtrapolativeGR(INFRAROADRUnConstrained(R%), CDbl(extmafuncroad), CDbl(extmaposnroad), CDbl(PreMultINFRAROAD(R%)), CDbl(Prediction), CDbl(Prediction1), CDbl(extmaposnconvtimeroad)))\r\r'apply growth rate on previous year's (base or pre-target or pre-multiplier) forecast\rINFRAROAD(R%) = CSng((1 + If(InfraRoadGR(R%), 0)) * PreMultINFRAROAD(R%))\r\rElse  'Growth rate could not be computed for lack of data: use cross-sectional model\rIf RoadDensShift(R%) > 0 Then 'data value higher than prediction - slower convergence\rINFRAROAD(R%) = Prediction + ConvergeOverTime(RoadDensShift(R%), 0, mfpconv(R%) * 6) 'mfpconv = 50 years\rElse\rINFRAROAD(R%) = Prediction + ConvergeOverTime(RoadDensShift(R%), 0, 40) 'mfpconv = 50 years\rEnd If\rEnd If\r"
  },
  {
    "Variable": "INFRAROAD",
    "UsesVariable": "extmaposnconvtimeroad",
    "Distance": 1,
    "Code": "\r\r'If RegName(R%) = \"Bangladesh\" Then Stop\r'If IY = 2 Then Debug.Print RegName(R%); InfraRoadGR(R%)\r'If IY = 11 And GRPS(1, R) = \"Congo, Republic of\" Then Stop\rIf InfraRoadGR(R%).HasValue Then\r\r'Previous year's driver values and prediction obatained from those drivers\rDim Prediction1 = ComputeRoadDensity(sgdpp(R%), sPOPTotal(R%), sLANDAREA(R%))\r\r'Compute growth rate using extrapolative approach\r'Attempts to converge current value to expected value using:\r'a.growth due to the annual change in driver variables, b. growth to cover up positional gap, b. moving average with previous year's growth rate\rInfraRoadGR(R%) = CSng(CalcExtrapolativeGR(INFRAROADRUnConstrained(R%), CDbl(extmafuncroad), CDbl(extmaposnroad), CDbl(PreMultINFRAROAD(R%)), CDbl(Prediction), CDbl(Prediction1), CDbl(extmaposnconvtimeroad)))\r\r'apply growth rate on previous year's (base or pre-target or pre-multiplier) forecast\rINFRAROAD(R%) = CSng((1 + If(InfraRoadGR(R%), 0)) * PreMultINFRAROAD(R%))\r\rElse  'Growth rate could not be computed for lack of data: use cross-sectional model\rIf RoadDensShift(R%) > 0 Then 'data value higher than prediction - slower convergence\rINFRAROAD(R%) = Prediction + ConvergeOverTime(RoadDensShift(R%), 0, mfpconv(R%) * 6) 'mfpconv = 50 years\rElse\rINFRAROAD(R%) = Prediction + ConvergeOverTime(RoadDensShift(R%), 0, 40) 'mfpconv = 50 years\rEnd If\rEnd If\r\r'current year drivers and forecast\r\rPrediction = ComputeRoadDensity(GDPP(R%), POP(R%), LANDAREA(R%))\r"
  },
  {
    "Variable": "INFRAROADPAVEDCOST",
    "UsesVariable": "infraroadpavedcostm",
    "Distance": 0,
    "Code": "\r'   All but First Call 2: Estimate (Desired) Road Costs for Construction and Maintenance\r'---------------------------------------------------------------------------------------\r\r'                sErrorSub = saveErrorSub + \" \" + RegName(R%) + \" Road Costs\"\r\r'-- Paved Roads------------\rCalcInfraUnitCost(R%, 13, 3, infraroadpavedcostupper, infraroadpavedcostlower, sGDPPCP(R%), INFRAROADPAVEDCOST(R%))\rINFRAROADPAVEDCOST(R%) = INFRAROADPAVEDCOST(R%) * infraroadpavedcostm(R%) 'multiplier on cost\r"
  },
  {
    "Variable": "INFRAROADPAVEDPCNT",
    "UsesVariable": "LANDAREA",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "INFRAROADPAVEDPCNT",
    "UsesVariable": "INFRAROAD",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "INFRAROADPAVEDPCNT",
    "UsesVariable": "WATWASTETREAT",
    "Distance": 525,
    "Code": "0"
  },
  {
    "Variable": "INFRAROADPAVEDPCNT",
    "UsesVariable": "POP",
    "Distance": 525,
    "Code": "0"
  },
  {
    "Variable": "INFRAROADPAVEDPCNT",
    "UsesVariable": "infraroadraitrgtyr",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "INFRAROADPAVEDPCNT",
    "UsesVariable": "infraroadraisetar",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "INFRAROADPAVEDPCNT",
    "UsesVariable": "GDPPCP",
    "Distance": 65,
    "Code": "0"
  },
  {
    "Variable": "INFRAROADPAVEDPCNT",
    "UsesVariable": "infraroadpavedpcntm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAROADPAVEDPCNT",
    "UsesVariable": "extmafuncroadpaved",
    "Distance": 2,
    "Code": "\rIf InfraRoadPavedPcntGR(R%).HasValue Then\r\rDim Prediction1 = CSng(ComputePavePcnt(sGDPPCP(R%), sPOPTotal(R%), LANDAREA(R%), SINFRAROAD(R%)))\rDim Prediction1BF = ComputePavePcnt(sGDPPCP(R%), sPOPTotal(R%), LANDAREA(R%), sINFRAROADBF(R%))\r\r'extrapolative approach\rInfraRoadPavedPcntR = CSng(CalcExtrapolativeGR(sInfraRoadPavedPcntR(R%), extmafuncroadpaved, extmaposnroadpaved, CDbl(PreMultINFRAROADPAVEDPCNT(R%)), CDbl(Prediction), CDbl(Prediction1), extmaposnconvtimeroadpaved))\rInfraRoadPavedPcntRBF = CSng(CalcExtrapolativeGR(sInfraRoadPavedPcntRBF(R%), extmafuncroadpaved, extmaposnroadpaved, CDbl(sInfraRoadPavedPcntBF(R%)), CDbl(PredictionBF), CDbl(Prediction1BF), extmaposnconvtimeroadpaved))\rINFRAROADPAVEDPCNT(R%) = CSng((1 + InfraRoadPavedPcntR) * PreMultINFRAROADPAVEDPCNT(R%))\rInfraRoadPavedPcntBF(R%) = (1 + InfraRoadPavedPcntRBF) * InfraRoadPavedPcntBF(R%)\r\rElse\r'growth rate could not be obtained from data: use cross-sectional approach\rIf INFRARoadPavedPcntShift(R%) > 0 Then\r'historical value higher than forecast at the initial year - keep higher by imposing a very slow shift convergence\rINFRAROADPAVEDPCNT(R%) = Prediction + ConvergeOverTime(INFRARoadPavedPcntShift(R%), 0, 500)\rInfraRoadPavedPcntBF(R%) = PredictionBF + ConvergeOverTime(INFRARoadPavedPcntShift(R%), 0, 500)\rElse\r'historical value lower than forecast at the initial year - bring up\rINFRAROADPAVEDPCNT(R%) = Prediction + ConvergeOverTime(INFRARoadPavedPcntShift(R%), 0, 50)\rInfraRoadPavedPcntBF(R%) = PredictionBF + ConvergeOverTime(INFRARoadPavedPcntShift(R%), 0, 50)\rEnd If\r\rEnd If\r\rIf InfraRoadPavedPcntGR(R%).HasValue Then\r\rDim Prediction1 = CSng(ComputePavePcnt(sGDPPCP(R%), sPOPTotal(R%), LANDAREA(R%), SINFRAROAD(R%)))\rDim Prediction1BF = ComputePavePcnt(sGDPPCP(R%), sPOPTotal(R%), LANDAREA(R%), sINFRAROADBF(R%))\r\r'extrapolative approach\rInfraRoadPavedPcntR = CSng(CalcExtrapolativeGR(sInfraRoadPavedPcntR(R%), extmafuncroadpaved, extmaposnroadpaved, CDbl(PreMultINFRAROADPAVEDPCNT(R%)), CDbl(Prediction), CDbl(Prediction1), extmaposnconvtimeroadpaved))\rInfraRoadPavedPcntRBF = CSng(CalcExtrapolativeGR(sInfraRoadPavedPcntRBF(R%), extmafuncroadpaved, extmaposnroadpaved, CDbl(sInfraRoadPavedPcntBF(R%)), CDbl(PredictionBF), CDbl(Prediction1BF), extmaposnconvtimeroadpaved))\rINFRAROADPAVEDPCNT(R%) = CSng((1 + InfraRoadPavedPcntR) * PreMultINFRAROADPAVEDPCNT(R%))\rInfraRoadPavedPcntBF(R%) = (1 + InfraRoadPavedPcntRBF) * InfraRoadPavedPcntBF(R%)\r\rElse\r'growth rate could not be obtained from data: use cross-sectional approach\rIf INFRARoadPavedPcntShift(R%) > 0 Then\r'historical value higher than forecast at the initial year - keep higher by imposing a very slow shift convergence\rINFRAROADPAVEDPCNT(R%) = Prediction + ConvergeOverTime(INFRARoadPavedPcntShift(R%), 0, 500)\rInfraRoadPavedPcntBF(R%) = PredictionBF + ConvergeOverTime(INFRARoadPavedPcntShift(R%), 0, 500)\rElse\r'historical value lower than forecast at the initial year - bring up\rINFRAROADPAVEDPCNT(R%) = Prediction + ConvergeOverTime(INFRARoadPavedPcntShift(R%), 0, 50)\rInfraRoadPavedPcntBF(R%) = PredictionBF + ConvergeOverTime(INFRARoadPavedPcntShift(R%), 0, 50)\rEnd If\r\rEnd If\r"
  },
  {
    "Variable": "INFRAROADPAVEDPCNT",
    "UsesVariable": "extmaposnroadpaved",
    "Distance": 2,
    "Code": "\rIf InfraRoadPavedPcntGR(R%).HasValue Then\r\rDim Prediction1 = CSng(ComputePavePcnt(sGDPPCP(R%), sPOPTotal(R%), LANDAREA(R%), SINFRAROAD(R%)))\rDim Prediction1BF = ComputePavePcnt(sGDPPCP(R%), sPOPTotal(R%), LANDAREA(R%), sINFRAROADBF(R%))\r\r'extrapolative approach\rInfraRoadPavedPcntR = CSng(CalcExtrapolativeGR(sInfraRoadPavedPcntR(R%), extmafuncroadpaved, extmaposnroadpaved, CDbl(PreMultINFRAROADPAVEDPCNT(R%)), CDbl(Prediction), CDbl(Prediction1), extmaposnconvtimeroadpaved))\rInfraRoadPavedPcntRBF = CSng(CalcExtrapolativeGR(sInfraRoadPavedPcntRBF(R%), extmafuncroadpaved, extmaposnroadpaved, CDbl(sInfraRoadPavedPcntBF(R%)), CDbl(PredictionBF), CDbl(Prediction1BF), extmaposnconvtimeroadpaved))\rINFRAROADPAVEDPCNT(R%) = CSng((1 + InfraRoadPavedPcntR) * PreMultINFRAROADPAVEDPCNT(R%))\rInfraRoadPavedPcntBF(R%) = (1 + InfraRoadPavedPcntRBF) * InfraRoadPavedPcntBF(R%)\r\rElse\r'growth rate could not be obtained from data: use cross-sectional approach\rIf INFRARoadPavedPcntShift(R%) > 0 Then\r'historical value higher than forecast at the initial year - keep higher by imposing a very slow shift convergence\rINFRAROADPAVEDPCNT(R%) = Prediction + ConvergeOverTime(INFRARoadPavedPcntShift(R%), 0, 500)\rInfraRoadPavedPcntBF(R%) = PredictionBF + ConvergeOverTime(INFRARoadPavedPcntShift(R%), 0, 500)\rElse\r'historical value lower than forecast at the initial year - bring up\rINFRAROADPAVEDPCNT(R%) = Prediction + ConvergeOverTime(INFRARoadPavedPcntShift(R%), 0, 50)\rInfraRoadPavedPcntBF(R%) = PredictionBF + ConvergeOverTime(INFRARoadPavedPcntShift(R%), 0, 50)\rEnd If\r\rEnd If\r"
  },
  {
    "Variable": "INFRAROADPAVEDPCNT",
    "UsesVariable": "extmaposnconvtimeroadpaved",
    "Distance": 2,
    "Code": "\rIf InfraRoadPavedPcntGR(R%).HasValue Then\r\rDim Prediction1 = CSng(ComputePavePcnt(sGDPPCP(R%), sPOPTotal(R%), LANDAREA(R%), SINFRAROAD(R%)))\rDim Prediction1BF = ComputePavePcnt(sGDPPCP(R%), sPOPTotal(R%), LANDAREA(R%), sINFRAROADBF(R%))\r\r'extrapolative approach\rInfraRoadPavedPcntR = CSng(CalcExtrapolativeGR(sInfraRoadPavedPcntR(R%), extmafuncroadpaved, extmaposnroadpaved, CDbl(PreMultINFRAROADPAVEDPCNT(R%)), CDbl(Prediction), CDbl(Prediction1), extmaposnconvtimeroadpaved))\rInfraRoadPavedPcntRBF = CSng(CalcExtrapolativeGR(sInfraRoadPavedPcntRBF(R%), extmafuncroadpaved, extmaposnroadpaved, CDbl(sInfraRoadPavedPcntBF(R%)), CDbl(PredictionBF), CDbl(Prediction1BF), extmaposnconvtimeroadpaved))\rINFRAROADPAVEDPCNT(R%) = CSng((1 + InfraRoadPavedPcntR) * PreMultINFRAROADPAVEDPCNT(R%))\rInfraRoadPavedPcntBF(R%) = (1 + InfraRoadPavedPcntRBF) * InfraRoadPavedPcntBF(R%)\r\rElse\r'growth rate could not be obtained from data: use cross-sectional approach\rIf INFRARoadPavedPcntShift(R%) > 0 Then\r'historical value higher than forecast at the initial year - keep higher by imposing a very slow shift convergence\rINFRAROADPAVEDPCNT(R%) = Prediction + ConvergeOverTime(INFRARoadPavedPcntShift(R%), 0, 500)\rInfraRoadPavedPcntBF(R%) = PredictionBF + ConvergeOverTime(INFRARoadPavedPcntShift(R%), 0, 500)\rElse\r'historical value lower than forecast at the initial year - bring up\rINFRAROADPAVEDPCNT(R%) = Prediction + ConvergeOverTime(INFRARoadPavedPcntShift(R%), 0, 50)\rInfraRoadPavedPcntBF(R%) = PredictionBF + ConvergeOverTime(INFRARoadPavedPcntShift(R%), 0, 50)\rEnd If\r\rEnd If\r\r'Current year forecast\rPrediction = CSng(ComputePavePcnt(GDPPCP(R%), POP(R%), LANDAREA(R%), INFRAROAD(R%)))\r"
  },
  {
    "Variable": "INFRAROADRAI",
    "UsesVariable": "GDPP",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "INFRAROADRAI",
    "UsesVariable": "LANDAREA",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "INFRAROADRAI",
    "UsesVariable": "INFRAROAD",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "INFRAROADRAI",
    "UsesVariable": "POP",
    "Distance": 515,
    "Code": "0"
  },
  {
    "Variable": "INFRAROADRAI",
    "UsesVariable": "infraroadraitrgtyr",
    "Distance": 4,
    "Code": "\r\r'target/bound for RAI is the minimum of halfway towards universal access and target parameter infraroadraitrgtval; unless initial data is higher (which is then st as bound)\rtrgtINFRAROADRAI(R%) = Amin(AMAX(infraroadraitrgtval(R%), iINFRAROADRAI(R%)), iINFRAROADRAI(R%) + (100 - iINFRAROADRAI(R%)) / 2)\r\r\r'add RAI growth required by SE targeting with appropriate bounding (bounds are different for negative shift)\rinfraroadraicalc = AMAX(0.001, Amin(RUBound - shiftadded, Amin(RUBound, infraroadraicalc + EffectSE))) ' could be high for countries with negative initial shift; e.g., Brunei\r\r'   All but First Call 2: Rural Road Access Index- Universal target\r'------------------------------------------------------------------\r\r'dkb 2013/09/16 added dimension 1 to infraroadraisetar\rIf infraroadraitrgtyr(R%) > 0 And infraroadraisetar(R%) = 0 Then 'cannot do universal target and SE target together\r'RAI  required to reach universal target\r'target value is capped (above) at trgtINFRAROADRAI(R%), which is the maximum between a. initial value and b. the minimum of a target value parameter and the value halfway to universal from the initial value\rDim INFRAROADRAITrgt = Amin(trgtINFRAROADRAI(R%), iINFRAROADRAI(R%) + Amin(infraroadraitrgtyr(R%), IY - 1) * (trgtINFRAROADRAI(R%) - iINFRAROADRAI(R%)) / infraroadraitrgtyr(R%))\r\r'If target RAI is higher than base RAI estimate more roads will be needed\rIf INFRAROADRAI(R%) < INFRAROADRAITrgt Then\r\r'Shift factor that was added to RAI base estimate: need recalculation here in case final RAI estimate was adjusted by bounds\rshiftadded = INFRAROADRAI(R%) - infraroadraicalc\r\r'new bound : per new hard target algorithm\rDim UpBound = 130 '100 '500 '120 '100 'mti: there might be an issue here;\r'Note MTI: if initial (pre-target) INFRAROADRAICalc was >100 (it was not bound), back calculation might result in a decrease in roads density\r'this can be prevented by bounding back calculated INFRAROAD with initial forecast of INFRAROAD\r\r'estimated RAI to be used for reverse calculation of roads\rinfraroadraicalc = AMAX(0.001, Amin(UpBound, INFRAROADRAITrgt - shiftadded))  'mti negative shift countries will be bound at UpBound\r\r\r'save desired RAI (not affected by fund) 'kept the bound at more than 100 for debugging help\rINFRAROADRAI(R%) = AMAX(0.001, Amin(UpBound, infraroadraicalc + shiftadded))\r\r'Reverse calculation of road requirement\rDim TotalRoadsDensityPopTrgt = CSng(Math.Exp((Math.Log(infraroadraicalc) - 1.04696183207415 - 0.132781679654008 * Math.Log(If(IncomeDensityLand, 0))) / 0.239067182377656))\rINFRAROAD(R%) = TotalRoadsDensityPopTrgt * sPOPTotal(R%) / AMAX(LANDAREA(R%), 0.0001F) / 1000\r\r'roads should not go down while chasing universal RAI target\rINFRAROAD(R%) = AMAX(INFRAROAD(R%), sINFRAROADDEM(R%))\r\rElse\r\r'Note MTI: if traget RAI is less than or equal to base estimate: nothing needs to be done\r'MTI commented the following line on 09 August 2012\rINFRAROAD(R%) = AMAX(INFRAROAD(R%), sINFRAROADDEM(R%))\r\rEnd If\r\rEnd If\r\r'   All but First Call 2: Rural Road Access Index- Universal target\r'------------------------------------------------------------------\r\r'dkb 2013/09/16 added dimension 1 to infraroadraisetar\rIf infraroadraitrgtyr(R%) > 0 And infraroadraisetar(R%) = 0 Then 'cannot do universal target and SE target together\r'RAI  required to reach universal target\r'target value is capped (above) at trgtINFRAROADRAI(R%), which is the maximum between a. initial value and b. the minimum of a target value parameter and the value halfway to universal from the initial value\rDim INFRAROADRAITrgt = Amin(trgtINFRAROADRAI(R%), iINFRAROADRAI(R%) + Amin(infraroadraitrgtyr(R%), IY - 1) * (trgtINFRAROADRAI(R%) - iINFRAROADRAI(R%)) / infraroadraitrgtyr(R%))\r\r'If target RAI is higher than base RAI estimate more roads will be needed\rIf INFRAROADRAI(R%) < INFRAROADRAITrgt Then\r\r'Shift factor that was added to RAI base estimate: need recalculation here in case final RAI estimate was adjusted by bounds\rshiftadded = INFRAROADRAI(R%) - infraroadraicalc\r\r'new bound : per new hard target algorithm\rDim UpBound = 130 '100 '500 '120 '100 'mti: there might be an issue here;\r'Note MTI: if initial (pre-target) INFRAROADRAICalc was >100 (it was not bound), back calculation might result in a decrease in roads density\r'this can be prevented by bounding back calculated INFRAROAD with initial forecast of INFRAROAD\r\r'estimated RAI to be used for reverse calculation of roads\rinfraroadraicalc = AMAX(0.001, Amin(UpBound, INFRAROADRAITrgt - shiftadded))  'mti negative shift countries will be bound at UpBound\r\r\r'save desired RAI (not affected by fund) 'kept the bound at more than 100 for debugging help\rINFRAROADRAI(R%) = AMAX(0.001, Amin(UpBound, infraroadraicalc + shiftadded))\r\r'Reverse calculation of road requirement\rDim TotalRoadsDensityPopTrgt = CSng(Math.Exp((Math.Log(infraroadraicalc) - 1.04696183207415 - 0.132781679654008 * Math.Log(If(IncomeDensityLand, 0))) / 0.239067182377656))\rINFRAROAD(R%) = TotalRoadsDensityPopTrgt * sPOPTotal(R%) / AMAX(LANDAREA(R%), 0.0001F) / 1000\r\r'roads should not go down while chasing universal RAI target\rINFRAROAD(R%) = AMAX(INFRAROAD(R%), sINFRAROADDEM(R%))\r\rElse\r\r'Note MTI: if traget RAI is less than or equal to base estimate: nothing needs to be done\r'MTI commented the following line on 09 August 2012\rINFRAROAD(R%) = AMAX(INFRAROAD(R%), sINFRAROADDEM(R%))\r\rEnd If\r\rEnd If\r\r'   All but First Call 2: Rural Road Access Index- Universal target\r'------------------------------------------------------------------\r\r'dkb 2013/09/16 added dimension 1 to infraroadraisetar\rIf infraroadraitrgtyr(R%) > 0 And infraroadraisetar(R%) = 0 Then 'cannot do universal target and SE target together\r'RAI  required to reach universal target\r'target value is capped (above) at trgtINFRAROADRAI(R%), which is the maximum between a. initial value and b. the minimum of a target value parameter and the value halfway to universal from the initial value\rDim INFRAROADRAITrgt = Amin(trgtINFRAROADRAI(R%), iINFRAROADRAI(R%) + Amin(infraroadraitrgtyr(R%), IY - 1) * (trgtINFRAROADRAI(R%) - iINFRAROADRAI(R%)) / infraroadraitrgtyr(R%))\r\r'If target RAI is higher than base RAI estimate more roads will be needed\rIf INFRAROADRAI(R%) < INFRAROADRAITrgt Then\r\r'Shift factor that was added to RAI base estimate: need recalculation here in case final RAI estimate was adjusted by bounds\rshiftadded = INFRAROADRAI(R%) - infraroadraicalc\r\r'new bound : per new hard target algorithm\rDim UpBound = 130 '100 '500 '120 '100 'mti: there might be an issue here;\r'Note MTI: if initial (pre-target) INFRAROADRAICalc was >100 (it was not bound), back calculation might result in a decrease in roads density\r'this can be prevented by bounding back calculated INFRAROAD with initial forecast of INFRAROAD\r\r'estimated RAI to be used for reverse calculation of roads\rinfraroadraicalc = AMAX(0.001, Amin(UpBound, INFRAROADRAITrgt - shiftadded))  'mti negative shift countries will be bound at UpBound\r\r\r'save desired RAI (not affected by fund) 'kept the bound at more than 100 for debugging help\rINFRAROADRAI(R%) = AMAX(0.001, Amin(UpBound, infraroadraicalc + shiftadded))\r\r'Reverse calculation of road requirement\rDim TotalRoadsDensityPopTrgt = CSng(Math.Exp((Math.Log(infraroadraicalc) - 1.04696183207415 - 0.132781679654008 * Math.Log(If(IncomeDensityLand, 0))) / 0.239067182377656))\rINFRAROAD(R%) = TotalRoadsDensityPopTrgt * sPOPTotal(R%) / AMAX(LANDAREA(R%), 0.0001F) / 1000\r\r'roads should not go down while chasing universal RAI target\rINFRAROAD(R%) = AMAX(INFRAROAD(R%), sINFRAROADDEM(R%))\r\rElse\r\r'Note MTI: if traget RAI is less than or equal to base estimate: nothing needs to be done\r'MTI commented the following line on 09 August 2012\rINFRAROAD(R%) = AMAX(INFRAROAD(R%), sINFRAROADDEM(R%))\r\rEnd If\r\rEnd If\r\r'   All but First Call 2: Rural Road Access Index- Universal target\r'------------------------------------------------------------------\r\r'dkb 2013/09/16 added dimension 1 to infraroadraisetar\rIf infraroadraitrgtyr(R%) > 0 And infraroadraisetar(R%) = 0 Then 'cannot do universal target and SE target together\r'RAI  required to reach universal target\r'target value is capped (above) at trgtINFRAROADRAI(R%), which is the maximum between a. initial value and b. the minimum of a target value parameter and the value halfway to universal from the initial value\rDim INFRAROADRAITrgt = Amin(trgtINFRAROADRAI(R%), iINFRAROADRAI(R%) + Amin(infraroadraitrgtyr(R%), IY - 1) * (trgtINFRAROADRAI(R%) - iINFRAROADRAI(R%)) / infraroadraitrgtyr(R%))\r\r'If target RAI is higher than base RAI estimate more roads will be needed\rIf INFRAROADRAI(R%) < INFRAROADRAITrgt Then\r\r'Shift factor that was added to RAI base estimate: need recalculation here in case final RAI estimate was adjusted by bounds\rshiftadded = INFRAROADRAI(R%) - infraroadraicalc\r\r'new bound : per new hard target algorithm\rDim UpBound = 130 '100 '500 '120 '100 'mti: there might be an issue here;\r'Note MTI: if initial (pre-target) INFRAROADRAICalc was >100 (it was not bound), back calculation might result in a decrease in roads density\r'this can be prevented by bounding back calculated INFRAROAD with initial forecast of INFRAROAD\r\r'estimated RAI to be used for reverse calculation of roads\rinfraroadraicalc = AMAX(0.001, Amin(UpBound, INFRAROADRAITrgt - shiftadded))  'mti negative shift countries will be bound at UpBound\r\r\r'save desired RAI (not affected by fund) 'kept the bound at more than 100 for debugging help\rINFRAROADRAI(R%) = AMAX(0.001, Amin(UpBound, infraroadraicalc + shiftadded))\r\r'Reverse calculation of road requirement\rDim TotalRoadsDensityPopTrgt = CSng(Math.Exp((Math.Log(infraroadraicalc) - 1.04696183207415 - 0.132781679654008 * Math.Log(If(IncomeDensityLand, 0))) / 0.239067182377656))\rINFRAROAD(R%) = TotalRoadsDensityPopTrgt * sPOPTotal(R%) / AMAX(LANDAREA(R%), 0.0001F) / 1000\r\r'roads should not go down while chasing universal RAI target\rINFRAROAD(R%) = AMAX(INFRAROAD(R%), sINFRAROADDEM(R%))\r\rElse\r\r'Note MTI: if traget RAI is less than or equal to base estimate: nothing needs to be done\r'MTI commented the following line on 09 August 2012\rINFRAROAD(R%) = AMAX(INFRAROAD(R%), sINFRAROADDEM(R%))\r\rEnd If\r\rEnd If\r\r'   All but First Call 2: Rural Road Access Index- Universal target\r'------------------------------------------------------------------\r\r'dkb 2013/09/16 added dimension 1 to infraroadraisetar\rIf infraroadraitrgtyr(R%) > 0 And infraroadraisetar(R%) = 0 Then 'cannot do universal target and SE target together\r'RAI  required to reach universal target\r'target value is capped (above) at trgtINFRAROADRAI(R%), which is the maximum between a. initial value and b. the minimum of a target value parameter and the value halfway to universal from the initial value\rDim INFRAROADRAITrgt = Amin(trgtINFRAROADRAI(R%), iINFRAROADRAI(R%) + Amin(infraroadraitrgtyr(R%), IY - 1) * (trgtINFRAROADRAI(R%) - iINFRAROADRAI(R%)) / infraroadraitrgtyr(R%))\r\r'If target RAI is higher than base RAI estimate more roads will be needed\rIf INFRAROADRAI(R%) < INFRAROADRAITrgt Then\r\r'Shift factor that was added to RAI base estimate: need recalculation here in case final RAI estimate was adjusted by bounds\rshiftadded = INFRAROADRAI(R%) - infraroadraicalc\r\r'new bound : per new hard target algorithm\rDim UpBound = 130 '100 '500 '120 '100 'mti: there might be an issue here;\r'Note MTI: if initial (pre-target) INFRAROADRAICalc was >100 (it was not bound), back calculation might result in a decrease in roads density\r'this can be prevented by bounding back calculated INFRAROAD with initial forecast of INFRAROAD\r\r'estimated RAI to be used for reverse calculation of roads\rinfraroadraicalc = AMAX(0.001, Amin(UpBound, INFRAROADRAITrgt - shiftadded))  'mti negative shift countries will be bound at UpBound\r\r\r'save desired RAI (not affected by fund) 'kept the bound at more than 100 for debugging help\rINFRAROADRAI(R%) = AMAX(0.001, Amin(UpBound, infraroadraicalc + shiftadded))\r\r'Reverse calculation of road requirement\rDim TotalRoadsDensityPopTrgt = CSng(Math.Exp((Math.Log(infraroadraicalc) - 1.04696183207415 - 0.132781679654008 * Math.Log(If(IncomeDensityLand, 0))) / 0.239067182377656))\rINFRAROAD(R%) = TotalRoadsDensityPopTrgt * sPOPTotal(R%) / AMAX(LANDAREA(R%), 0.0001F) / 1000\r\r'roads should not go down while chasing universal RAI target\rINFRAROAD(R%) = AMAX(INFRAROAD(R%), sINFRAROADDEM(R%))\r\rElse\r\r'Note MTI: if traget RAI is less than or equal to base estimate: nothing needs to be done\r'MTI commented the following line on 09 August 2012\rINFRAROAD(R%) = AMAX(INFRAROAD(R%), sINFRAROADDEM(R%))\r\rEnd If\r\rEnd If\r\r'   All but First Call 2: Rural Road Access Index- Universal target\r'------------------------------------------------------------------\r\r'dkb 2013/09/16 added dimension 1 to infraroadraisetar\rIf infraroadraitrgtyr(R%) > 0 And infraroadraisetar(R%) = 0 Then 'cannot do universal target and SE target together\r'RAI  required to reach universal target\r'target value is capped (above) at trgtINFRAROADRAI(R%), which is the maximum between a. initial value and b. the minimum of a target value parameter and the value halfway to universal from the initial value\rDim INFRAROADRAITrgt = Amin(trgtINFRAROADRAI(R%), iINFRAROADRAI(R%) + Amin(infraroadraitrgtyr(R%), IY - 1) * (trgtINFRAROADRAI(R%) - iINFRAROADRAI(R%)) / infraroadraitrgtyr(R%))\r\r'If target RAI is higher than base RAI estimate more roads will be needed\rIf INFRAROADRAI(R%) < INFRAROADRAITrgt Then\r\r'Shift factor that was added to RAI base estimate: need recalculation here in case final RAI estimate was adjusted by bounds\rshiftadded = INFRAROADRAI(R%) - infraroadraicalc\r\r'new bound : per new hard target algorithm\rDim UpBound = 130 '100 '500 '120 '100 'mti: there might be an issue here;\r'Note MTI: if initial (pre-target) INFRAROADRAICalc was >100 (it was not bound), back calculation might result in a decrease in roads density\r'this can be prevented by bounding back calculated INFRAROAD with initial forecast of INFRAROAD\r\r'estimated RAI to be used for reverse calculation of roads\rinfraroadraicalc = AMAX(0.001, Amin(UpBound, INFRAROADRAITrgt - shiftadded))  'mti negative shift countries will be bound at UpBound\r\r\r'save desired RAI (not affected by fund) 'kept the bound at more than 100 for debugging help\rINFRAROADRAI(R%) = AMAX(0.001, Amin(UpBound, infraroadraicalc + shiftadded))\r\r'Reverse calculation of road requirement\rDim TotalRoadsDensityPopTrgt = CSng(Math.Exp((Math.Log(infraroadraicalc) - 1.04696183207415 - 0.132781679654008 * Math.Log(If(IncomeDensityLand, 0))) / 0.239067182377656))\rINFRAROAD(R%) = TotalRoadsDensityPopTrgt * sPOPTotal(R%) / AMAX(LANDAREA(R%), 0.0001F) / 1000\r\r'roads should not go down while chasing universal RAI target\rINFRAROAD(R%) = AMAX(INFRAROAD(R%), sINFRAROADDEM(R%))\r\rElse\r\r'Note MTI: if traget RAI is less than or equal to base estimate: nothing needs to be done\r'MTI commented the following line on 09 August 2012\rINFRAROAD(R%) = AMAX(INFRAROAD(R%), sINFRAROADDEM(R%))\r\rEnd If\r\rEnd If\r\r'   All but First Call 2: Rural Road Access Index- Universal target\r'------------------------------------------------------------------\r\r'dkb 2013/09/16 added dimension 1 to infraroadraisetar\rIf infraroadraitrgtyr(R%) > 0 And infraroadraisetar(R%) = 0 Then 'cannot do universal target and SE target together\r'RAI  required to reach universal target\r'target value is capped (above) at trgtINFRAROADRAI(R%), which is the maximum between a. initial value and b. the minimum of a target value parameter and the value halfway to universal from the initial value\rDim INFRAROADRAITrgt = Amin(trgtINFRAROADRAI(R%), iINFRAROADRAI(R%) + Amin(infraroadraitrgtyr(R%), IY - 1) * (trgtINFRAROADRAI(R%) - iINFRAROADRAI(R%)) / infraroadraitrgtyr(R%))\r\r'If target RAI is higher than base RAI estimate more roads will be needed\rIf INFRAROADRAI(R%) < INFRAROADRAITrgt Then\r\r'Shift factor that was added to RAI base estimate: need recalculation here in case final RAI estimate was adjusted by bounds\rshiftadded = INFRAROADRAI(R%) - infraroadraicalc\r\r'new bound : per new hard target algorithm\rDim UpBound = 130 '100 '500 '120 '100 'mti: there might be an issue here;\r'Note MTI: if initial (pre-target) INFRAROADRAICalc was >100 (it was not bound), back calculation might result in a decrease in roads density\r'this can be prevented by bounding back calculated INFRAROAD with initial forecast of INFRAROAD\r\r'estimated RAI to be used for reverse calculation of roads\rinfraroadraicalc = AMAX(0.001, Amin(UpBound, INFRAROADRAITrgt - shiftadded))  'mti negative shift countries will be bound at UpBound\r\r\r'save desired RAI (not affected by fund) 'kept the bound at more than 100 for debugging help\rINFRAROADRAI(R%) = AMAX(0.001, Amin(UpBound, infraroadraicalc + shiftadded))\r\r'Reverse calculation of road requirement\rDim TotalRoadsDensityPopTrgt = CSng(Math.Exp((Math.Log(infraroadraicalc) - 1.04696183207415 - 0.132781679654008 * Math.Log(If(IncomeDensityLand, 0))) / 0.239067182377656))\rINFRAROAD(R%) = TotalRoadsDensityPopTrgt * sPOPTotal(R%) / AMAX(LANDAREA(R%), 0.0001F) / 1000\r\r'roads should not go down while chasing universal RAI target\rINFRAROAD(R%) = AMAX(INFRAROAD(R%), sINFRAROADDEM(R%))\r\rElse\r\r'Note MTI: if traget RAI is less than or equal to base estimate: nothing needs to be done\r'MTI commented the following line on 09 August 2012\rINFRAROAD(R%) = AMAX(INFRAROAD(R%), sINFRAROADDEM(R%))\r\rEnd If\r\rEnd If\r"
  },
  {
    "Variable": "INFRAROADRAI",
    "UsesVariable": "infraroadraitrgtval",
    "Distance": 192,
    "Code": "0"
  },
  {
    "Variable": "INFRAROADRAI",
    "UsesVariable": "infraroadraisetar",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "INFRAROADRAI",
    "UsesVariable": "infraroadraiseyrtar",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "INFRAROADRAIDEM",
    "UsesVariable": "INFRAROADRAI",
    "Distance": 0,
    "Code": "\r\r'save desired RAI (not affected by fund)\rINFRAROADRAIDEM(R%) = INFRAROADRAI(R%)\r"
  },
  {
    "Variable": "INFRAROADTOTAL",
    "UsesVariable": "LANDAREA",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAROADTOTAL",
    "UsesVariable": "INFRAROAD",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRAROADUNPAVEDCOST",
    "UsesVariable": "infraroadunpavedcostm",
    "Distance": 0,
    "Code": "\rCalcInfraInvest(CDbl(InfraRoadPavedDemThousands), CDbl(sInfraRoadPavedThousands),\r                            Deppcnt(RoadPaved), INFRAROADPAVEDCOST(R%) * 1000, INFRAINVESTNEW(R%, RoadPaved), INFRAINVESTMAINT(R%, RoadPaved))\r\r'--Unpaved Roads------------\rCalcInfraUnitCost(R%, 13, 3, infraroadunpavedcostupper, infraroadunpavedcostlower, sGDPPCP(R%), INFRAROADUNPAVEDCOST(R%))\rINFRAROADUNPAVEDCOST(R%) = INFRAROADUNPAVEDCOST(R%) * infraroadunpavedcostm(R%) 'multiplier on cost\r"
  },
  {
    "Variable": "INFRATELE",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "INFRATELE",
    "UsesVariable": "infratelem",
    "Distance": 0,
    "Code": "\r\rINFRATELE(R%) = Amin(100, AMAX(0.5, INFRATELE(R%) * infratelem(R%)))\r\r'might be an issue in a multiplier scenario; as SICTBROAD will have multiplier effect; and SBroad(R, 3)  is saved pre-multiplier\r\r'      If RegName(R%) = \"Saudi Arabia\" And IY >= 7 Then Stop\r\r'In case curve has shifted up (by extra money in the previous year, demand signal needs to be sent so that it could continue to stay there\rINFRATELE(R%) = CSng(Amin(100, INFRATELE(R%) + INFRATELEShiftPrevYear))\r"
  },
  {
    "Variable": "INFRATELE",
    "UsesVariable": "igdpr",
    "Distance": 223,
    "Code": "\rDim cGrowthRatePosition = RatChange ^ (1 / ConvTime) - 1 'can be negative\r\r'Note MTI: This cap means only upward movement (growth) is picked up from function\r'Downward movement (decline) results only from downward saturation algorithm later in the sequence\r\rDim SatVal As Single\rDim ConvTime As Single\rDim ShareGrowthRatePosition As Single\r'---Rate of change taking fixed telephone down to a floor value as mobile phone grows (up to the function otherwise): positional growth rate\rIf TeleDensSaturation(R%) < 0 Then 'Note MTI: check why this condition is necessary\rIf SICTMobil(R%) > 30 Then 'peak at Mobil = 30\r'Cell phone reached 30%; allow fixed phone to start to decline towards a floor of 2.5%\rTeleDensSaturation(R%) = 2.5\rSatVal = TeleDensSaturation(R%)\rConvTime = infrateledtfp ' 15 '30\rShareGrowthRatePosition = 0.12\rElse\r'Mobile is still low; Fixed phone can grow towards whatever its estimation function predicts\rSatVal = AMAX(0, Prediction)\rConvTime = 20\rShareGrowthRatePosition = 0.1\rEnd If\rElse\r'This must be coming from a legacy bug fix; does not seem necessary now; will keep as is for now\rSatVal = TeleDensSaturation(R%)\rConvTime = infrateledtfp '15 '30\rShareGrowthRatePosition = 0.12\rEnd If\r\r\rcGrowthRateFunction = AMAX(0, cGrowthRateFunction)\r\rDim ShareGrowthRateFunction = (1 - ShareGrowthRateLastYear) - ShareGrowthRatePosition\r\r'ttt 2019/10/08 Taken Out\r'PreMultINFRAROAD(R%) = INFRAROAD(R%)\r'PreMultINFRAROADPAVEDPCNT(R%) = INFRAROADPAVEDPCNT(R%)\r'PreMultINFRATELE(R%) = INFRATELE(R%)\r'PreMultEnElecShrEnDem(R%) = ENELECSHRENDEM(R%)\r'PreMultLANDIRAREAEQUIP(R%) = LANDIRAREAEQUIP(R%)\r'PreMultINFRAELECTRANLOSS(R%) = INFRAELECTRANLOSS(R%)\r\r'SINFRANET(R%) = INFRANET(R%)\r\r'SINFRATELEOLD(R%) = INFRATELEOLD(R%)\r'SINFRATELE(R%) = INFRATELE(R%)\r'SSINFRATELE(R%) = SINFRATELE(R%)\r\r''mti 2014/05/28 - start\r'sPreBudINFRATELE(R%) = INFRATELE(R%)\r''mti 2014/05/28 - end\r\rIf Not InfraTeleGR(R%).HasValue Then\rInfraTeleGR(R%) = Amin(0.05F, igdpr(R%) * 0.5F)\rEnd If\r\r\r'---Moving average with previous year's rate of change----------\rDim ShareGrowthRateLastYear = 0.8\r\r\rInfraTeleGR(R%) = CType(ShareGrowthRateLastYear * InfraTeleGR(R%) + ShareGrowthRateFunction * cGrowthRateFunction + ShareGrowthRatePosition * cGrowthRatePosition, Single?)\r\rINFRATELE(R%) = If((1 + InfraTeleGR(R%)) * PreMultINFRATELE(R%), 0)\r"
  },
  {
    "Variable": "INFRATELE",
    "UsesVariable": "infrateledtfp",
    "Distance": 7,
    "Code": "\r'Note MTI: This cap means only upward movement (growth) is picked up from function\r'Downward movement (decline) results only from downward saturation algorithm later in the sequence\r\rDim SatVal As Single\rDim ConvTime As Single\rDim ShareGrowthRatePosition As Single\r'---Rate of change taking fixed telephone down to a floor value as mobile phone grows (up to the function otherwise): positional growth rate\rIf TeleDensSaturation(R%) < 0 Then 'Note MTI: check why this condition is necessary\rIf SICTMobil(R%) > 30 Then 'peak at Mobil = 30\r'Cell phone reached 30%; allow fixed phone to start to decline towards a floor of 2.5%\rTeleDensSaturation(R%) = 2.5\rSatVal = TeleDensSaturation(R%)\rConvTime = infrateledtfp ' 15 '30\rShareGrowthRatePosition = 0.12\rElse\r'Mobile is still low; Fixed phone can grow towards whatever its estimation function predicts\rSatVal = AMAX(0, Prediction)\rConvTime = 20\rShareGrowthRatePosition = 0.1\rEnd If\rElse\r'This must be coming from a legacy bug fix; does not seem necessary now; will keep as is for now\rSatVal = TeleDensSaturation(R%)\rConvTime = infrateledtfp '15 '30\rShareGrowthRatePosition = 0.12\rEnd If\r\rPrediction1 = AMAX(1, Prediction1)\r\rPrediction1 = AMAX(1, Prediction1)\r\r\rPrediction = AMAX(1, Prediction)\r\r'Note MTI: This cap means only upward movement (growth) is picked up from function\r'Downward movement (decline) results only from downward saturation algorithm later in the sequence\r\rDim SatVal As Single\rDim ConvTime As Single\rDim ShareGrowthRatePosition As Single\r'---Rate of change taking fixed telephone down to a floor value as mobile phone grows (up to the function otherwise): positional growth rate\rIf TeleDensSaturation(R%) < 0 Then 'Note MTI: check why this condition is necessary\rIf SICTMobil(R%) > 30 Then 'peak at Mobil = 30\r'Cell phone reached 30%; allow fixed phone to start to decline towards a floor of 2.5%\rTeleDensSaturation(R%) = 2.5\rSatVal = TeleDensSaturation(R%)\rConvTime = infrateledtfp ' 15 '30\rShareGrowthRatePosition = 0.12\rElse\r'Mobile is still low; Fixed phone can grow towards whatever its estimation function predicts\rSatVal = AMAX(0, Prediction)\rConvTime = 20\rShareGrowthRatePosition = 0.1\rEnd If\rElse\r'This must be coming from a legacy bug fix; does not seem necessary now; will keep as is for now\rSatVal = TeleDensSaturation(R%)\rConvTime = infrateledtfp '15 '30\rShareGrowthRatePosition = 0.12\rEnd If\r\r\rDim RatChange = SatVal / PreMultINFRATELE(R%)\r\r'--- annual growth rate along prediction function (functional growth) ---\rDim cGrowthRateFunction = (Prediction - Prediction1) / Prediction1\r\r'Note MTI: This cap means only upward movement (growth) is picked up from function\r'Downward movement (decline) results only from downward saturation algorithm later in the sequence\r\rDim SatVal As Single\rDim ConvTime As Single\rDim ShareGrowthRatePosition As Single\r'---Rate of change taking fixed telephone down to a floor value as mobile phone grows (up to the function otherwise): positional growth rate\rIf TeleDensSaturation(R%) < 0 Then 'Note MTI: check why this condition is necessary\rIf SICTMobil(R%) > 30 Then 'peak at Mobil = 30\r'Cell phone reached 30%; allow fixed phone to start to decline towards a floor of 2.5%\rTeleDensSaturation(R%) = 2.5\rSatVal = TeleDensSaturation(R%)\rConvTime = infrateledtfp ' 15 '30\rShareGrowthRatePosition = 0.12\rElse\r'Mobile is still low; Fixed phone can grow towards whatever its estimation function predicts\rSatVal = AMAX(0, Prediction)\rConvTime = 20\rShareGrowthRatePosition = 0.1\rEnd If\rElse\r'This must be coming from a legacy bug fix; does not seem necessary now; will keep as is for now\rSatVal = TeleDensSaturation(R%)\rConvTime = infrateledtfp '15 '30\rShareGrowthRatePosition = 0.12\rEnd If\r\r\r'---Moving average with previous year's rate of change----------\rDim ShareGrowthRateLastYear = 0.8\r"
  },
  {
    "Variable": "INFRATELE",
    "UsesVariable": "GDPPCP",
    "Distance": 21,
    "Code": "0"
  },
  {
    "Variable": "INFRATELECOST",
    "UsesVariable": "infratelecostm",
    "Distance": 0,
    "Code": "\r'mti 2014/05/28 - end\r'   All but First Call 2: Estimate (Desired) Fixed Telephone Fund Demand\r'-----------------------------------------------------------------------\rCalcInfraUnitCost(R%, 10, 5, infratelecostupper, infratelecostlower, sGDPPCP(R%), INFRATELECOST(R%), False)\r\rINFRATELECOST(R%) = INFRATELECOST(R%) * infratelecostm(R%) 'multiplier on phone cost\r"
  },
  {
    "Variable": "INFRATELEOLD",
    "UsesVariable": "mfpconv",
    "Distance": 0,
    "Code": "\r\r'function is per 1000; new variable is per 100\rTeleDensRI(R%) = INFRATELEOLD(R%) * 10 / AMAX(1, TeleDens)\r\r'   All but First Call 2: Estimate (Desired) Fixed Telephone Access Rate\r'-----------------------------------------------------------------------\r\r'sErrorSub = saveErrorSub + \" \" + RegName(R%) + \" Fixed Phone\"\r\r'--------- Old way of doing fixed telephone model --------------------\r'Note MTI: Infrateleold is used for determining MFPPC old way (when inframfpsw <3): for Base inframfpsw=3 now\r'We can now take away INFRATELEOLD (ask BBH first)\r\rCall XYTABL(\"GDP/Capita (PPP) Versus Telephones per 1000 (2000)\",\r                Amin(40, GDPPCP(R%)), Prediction, context)\r\r\rINFRATELEOLD(R%) = ConvergeOverTime(Prediction * TeleDensRI(R%), Prediction, mfpconv(R%))\r\r\r'Estimation function is per 1000: Variable is per 100: converting here\rINFRATELEOLD(R%) = INFRATELEOLD(R%) / 10\r\r\rINFRATELEOLD(R%) = AMAX(INFRATELEMin(R%), INFRATELEOLD(R%))\r"
  },
  {
    "Variable": "INFRATELEOLD",
    "UsesVariable": "GDPPCP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "INTR",
    "UsesVariable": "dstl",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "INTR",
    "UsesVariable": "ST",
    "Distance": 5,
    "Code": "\rrsT = 0\r"
  },
  {
    "Variable": "INTR",
    "UsesVariable": "GDPPOT",
    "Distance": 159,
    "Code": "0"
  },
  {
    "Variable": "INTR",
    "UsesVariable": "ZS",
    "Distance": 1996,
    "Code": "0"
  },
  {
    "Variable": "INTR",
    "UsesVariable": "MS",
    "Distance": 1837,
    "Code": "0"
  },
  {
    "Variable": "INTR",
    "UsesVariable": "GDP",
    "Distance": 1862,
    "Code": "0"
  },
  {
    "Variable": "INVS",
    "UsesVariable": "IGCF",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "IRA",
    "UsesVariable": "IGCF",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "IRA",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "IRA",
    "UsesVariable": "gdprext",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "IRA",
    "UsesVariable": "GDPRPA",
    "Distance": 121,
    "Code": "0"
  },
  {
    "Variable": "IRA",
    "UsesVariable": "elasit",
    "Distance": 121,
    "Code": "0"
  },
  {
    "Variable": "IRA",
    "UsesVariable": "VADD",
    "Distance": 780,
    "Code": "0"
  },
  {
    "Variable": "IRA",
    "UsesVariable": "WP",
    "Distance": 780,
    "Code": "0"
  },
  {
    "Variable": "KAG",
    "UsesVariable": "IDS",
    "Distance": 0,
    "Code": "\rKAG(R%) = CSng(IDS(R%, 1) *\r            (1.0! - IALK(R%)) / AMAX(KGroComp + 1 / AMAX(lks(1), 0.001), 0.001))\r"
  },
  {
    "Variable": "KAG",
    "UsesVariable": "IALK",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "KAG",
    "UsesVariable": "lks",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "KAG",
    "UsesVariable": "I",
    "Distance": 9,
    "Code": "\rCall XYTABL(\"Investment Ratio Versus Capital Growth Rate\",\r            I(R%) / GDP(R%), KGroComp, context)\r"
  },
  {
    "Variable": "KAG",
    "UsesVariable": "GDP",
    "Distance": 9,
    "Code": "\rCall XYTABL(\"Investment Ratio Versus Capital Growth Rate\",\r            I(R%) / GDP(R%), KGroComp, context)\r"
  },
  {
    "Variable": "KAG",
    "UsesVariable": "CIVDM",
    "Distance": 0,
    "Code": "\r\r'If RegName$(R%) = \"Israel\" Then Stop\r\rIf (agon < 0.5) Then iaval = INAG(R%)\r"
  },
  {
    "Variable": "KAG",
    "UsesVariable": "INAG",
    "Distance": 129,
    "Code": "\r\r'If RegName$(R%) = \"Israel\" Then Stop\r\rIf (agon < 0.5) Then iaval = INAG(R%)\r"
  },
  {
    "Variable": "KAG",
    "UsesVariable": "agon",
    "Distance": 129,
    "Code": "\r\r'If RegName$(R%) = \"Israel\" Then Stop\r\rIf (agon < 0.5) Then iaval = INAG(R%)\r"
  },
  {
    "Variable": "ken",
    "UsesVariable": "CIVDM",
    "Distance": 0,
    "Code": "\rFor e% = 1 To Renew  'Oil, gas, coal, hydro, nuclear, renewable\r'jrs 2021/11/30 If (tineed(R%) >= 0.001) Then Maldives blows up in 1961\r'jrs 2022/03/25 If (tineed(R%) >= 0.0001) Then Guinea Bissau blows up in 2009\rIf (tineed(R%) >= 0.00001) Then\rineed(R%, e%) = inen * ineed(R%, e%) * eninvtm(R%, e%) / tineed(R%)\rDim KEN_Shr = ineed(R%, e%) - sken(R%, e%) / lke(e%)  'jrs 2021/11/15 changed to sken\rken(R%, e%) = (sken(R%, e%) + KEN_Shr) * (1 - CIVDM(R%))  'jrs 2021/11/15 changed to sken\rken(R%, e%) = AMAX(0.00001, ken(R%, e%)) 'bbh 2013/11/20\r'ken(R%, e%) = AMAX(0.001, ken(R%, e%))\r'jrs 2021/11/15\r'sken(R%, e%) = ken(R%, e%)   'bbh 2023/12/31+ replace this with if-then below\r'The reason: oil production and export value =>GDP in early/exogenous years and grows much even as exogenous values of GDP jump + and -\r'in large swings; model forces non ag/en sectors to absorb all of swings in exog GDP creating huge stock messes for other sectors\r'and setting up crazy behavior for early post exog GDP years and longer term; need to constrain oil production to smooth all out\r'   WHen the base year of IFs is beyond huge swings in GDP and oil is smaller share of GDP, probably take this if-then out and let model compute\r'   changes in oil production\rIf (GRPS(1, R) = \"Sudan South\") And e% = 1 And IY% < 10 Then\rsken(R%, e%) = CSng(sken(R%, e%) * 1.03) 'bbh 2023/12/31+\rElseIf (GRPS(1, R) = \"Sudan South\") And e% = 1 And IY% >= 10 Then\rsken(R%, e%) = CSng(sken(R%, e%) * ConvergeOverTimeFromStartYear(1.03, 1, 20, 10))\r'ConvergeOverTimeFromStartYear(ByVal Base As Single, ByVal Target As Single, ByVal YearsToConverge As Integer, Optional StartYr As Integer = 2) As Single\rElse\rsken(R%, e%) = ken(R%, e%)\rEnd If\r\rEnd If\rIf IY% >= 2 Then    'If recompute 1st year, changes initial values\r'jrs 2022/04/12 ENPRR(R%, e%) = ineed(R%, e%) / ken(R%, e%) - 1.0! / lke(e%)\rENPRR(R%, e%) = CSng(ineed(R%, e%) / AMAX(ken(R%, e%), 0.00001) - 1.0! / lke(e%))\r'If RegName$(R%) = \"China\" And e% = Nucl Then Stop\r\rEnd If\r\r'     bbh2013/06/09\r'     All Years 2:  Undiscovered Resources\r'     ----------------------------------------------\rResorTot(R%, e%) = resorm(R%, e%) * resor(R%, e%) +\r                    resorunconm(R%, e%) * resoruncon(R%, e%) '* enresunce(R%) 'was used earlier for synoil\r'may need to revitalize and use enresunce\rNext e%\r\rFor e% = 1 To Renew  'Oil, gas, coal, hydro, nuclear, renewable\r'jrs 2021/11/30 If (tineed(R%) >= 0.001) Then Maldives blows up in 1961\r'jrs 2022/03/25 If (tineed(R%) >= 0.0001) Then Guinea Bissau blows up in 2009\rIf (tineed(R%) >= 0.00001) Then\rineed(R%, e%) = inen * ineed(R%, e%) * eninvtm(R%, e%) / tineed(R%)\rDim KEN_Shr = ineed(R%, e%) - sken(R%, e%) / lke(e%)  'jrs 2021/11/15 changed to sken\rken(R%, e%) = (sken(R%, e%) + KEN_Shr) * (1 - CIVDM(R%))  'jrs 2021/11/15 changed to sken\rken(R%, e%) = AMAX(0.00001, ken(R%, e%)) 'bbh 2013/11/20\r'ken(R%, e%) = AMAX(0.001, ken(R%, e%))\r'jrs 2021/11/15\r'sken(R%, e%) = ken(R%, e%)   'bbh 2023/12/31+ replace this with if-then below\r'The reason: oil production and export value =>GDP in early/exogenous years and grows much even as exogenous values of GDP jump + and -\r'in large swings; model forces non ag/en sectors to absorb all of swings in exog GDP creating huge stock messes for other sectors\r'and setting up crazy behavior for early post exog GDP years and longer term; need to constrain oil production to smooth all out\r'   WHen the base year of IFs is beyond huge swings in GDP and oil is smaller share of GDP, probably take this if-then out and let model compute\r'   changes in oil production\rIf (GRPS(1, R) = \"Sudan South\") And e% = 1 And IY% < 10 Then\rsken(R%, e%) = CSng(sken(R%, e%) * 1.03) 'bbh 2023/12/31+\rElseIf (GRPS(1, R) = \"Sudan South\") And e% = 1 And IY% >= 10 Then\rsken(R%, e%) = CSng(sken(R%, e%) * ConvergeOverTimeFromStartYear(1.03, 1, 20, 10))\r'ConvergeOverTimeFromStartYear(ByVal Base As Single, ByVal Target As Single, ByVal YearsToConverge As Integer, Optional StartYr As Integer = 2) As Single\rElse\rsken(R%, e%) = ken(R%, e%)\rEnd If\r\rEnd If\rIf IY% >= 2 Then    'If recompute 1st year, changes initial values\r'jrs 2022/04/12 ENPRR(R%, e%) = ineed(R%, e%) / ken(R%, e%) - 1.0! / lke(e%)\rENPRR(R%, e%) = CSng(ineed(R%, e%) / AMAX(ken(R%, e%), 0.00001) - 1.0! / lke(e%))\r'If RegName$(R%) = \"China\" And e% = Nucl Then Stop\r\rEnd If\r\r'     bbh2013/06/09\r'     All Years 2:  Undiscovered Resources\r'     ----------------------------------------------\rResorTot(R%, e%) = resorm(R%, e%) * resor(R%, e%) +\r                    resorunconm(R%, e%) * resoruncon(R%, e%) '* enresunce(R%) 'was used earlier for synoil\r'may need to revitalize and use enresunce\rNext e%\r\rFor e% = 1 To Renew  'Oil, gas, coal, hydro, nuclear, renewable\r'jrs 2021/11/30 If (tineed(R%) >= 0.001) Then Maldives blows up in 1961\r'jrs 2022/03/25 If (tineed(R%) >= 0.0001) Then Guinea Bissau blows up in 2009\rIf (tineed(R%) >= 0.00001) Then\rineed(R%, e%) = inen * ineed(R%, e%) * eninvtm(R%, e%) / tineed(R%)\rDim KEN_Shr = ineed(R%, e%) - sken(R%, e%) / lke(e%)  'jrs 2021/11/15 changed to sken\rken(R%, e%) = (sken(R%, e%) + KEN_Shr) * (1 - CIVDM(R%))  'jrs 2021/11/15 changed to sken\rken(R%, e%) = AMAX(0.00001, ken(R%, e%)) 'bbh 2013/11/20\r'ken(R%, e%) = AMAX(0.001, ken(R%, e%))\r'jrs 2021/11/15\r'sken(R%, e%) = ken(R%, e%)   'bbh 2023/12/31+ replace this with if-then below\r'The reason: oil production and export value =>GDP in early/exogenous years and grows much even as exogenous values of GDP jump + and -\r'in large swings; model forces non ag/en sectors to absorb all of swings in exog GDP creating huge stock messes for other sectors\r'and setting up crazy behavior for early post exog GDP years and longer term; need to constrain oil production to smooth all out\r'   WHen the base year of IFs is beyond huge swings in GDP and oil is smaller share of GDP, probably take this if-then out and let model compute\r'   changes in oil production\rIf (GRPS(1, R) = \"Sudan South\") And e% = 1 And IY% < 10 Then\rsken(R%, e%) = CSng(sken(R%, e%) * 1.03) 'bbh 2023/12/31+\rElseIf (GRPS(1, R) = \"Sudan South\") And e% = 1 And IY% >= 10 Then\rsken(R%, e%) = CSng(sken(R%, e%) * ConvergeOverTimeFromStartYear(1.03, 1, 20, 10))\r'ConvergeOverTimeFromStartYear(ByVal Base As Single, ByVal Target As Single, ByVal YearsToConverge As Integer, Optional StartYr As Integer = 2) As Single\rElse\rsken(R%, e%) = ken(R%, e%)\rEnd If\r\rEnd If\rIf IY% >= 2 Then    'If recompute 1st year, changes initial values\r'jrs 2022/04/12 ENPRR(R%, e%) = ineed(R%, e%) / ken(R%, e%) - 1.0! / lke(e%)\rENPRR(R%, e%) = CSng(ineed(R%, e%) / AMAX(ken(R%, e%), 0.00001) - 1.0! / lke(e%))\r'If RegName$(R%) = \"China\" And e% = Nucl Then Stop\r\rEnd If\r\r'     bbh2013/06/09\r'     All Years 2:  Undiscovered Resources\r'     ----------------------------------------------\rResorTot(R%, e%) = resorm(R%, e%) * resor(R%, e%) +\r                    resorunconm(R%, e%) * resoruncon(R%, e%) '* enresunce(R%) 'was used earlier for synoil\r'may need to revitalize and use enresunce\rNext e%\r"
  },
  {
    "Variable": "ken",
    "UsesVariable": "lke",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "ken",
    "UsesVariable": "eninvtm",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "ken",
    "UsesVariable": "IDS",
    "Distance": 3,
    "Code": "\rineed(R%, e%) = CSng(AMAX(mininv, Amin(maxinv, ineed(R%, e%))))\r\r\r\r'If RegName$(R%) = \"China\" Then Stop\r\rmaxinv = CSng((enppot(R%, Nucl) * 0.01 +\r                    ENP(R%, Nucl) / lke(Nucl)) * QE(R%, Nucl))\r\rmininv = CSng(ENP(R%, Nucl) * 0.5 * 1 / lke(Nucl) * QE(R%, Nucl))\r\rFor e% = 1 To Renew  'Oil, gas, coal, hydro, nuclear, renewable\rtineed(R%) = tineed(R%) + ineed(R%, e%) * eninvtm(R%, e%)\rNext e%\r"
  },
  {
    "Variable": "ken",
    "UsesVariable": "enon",
    "Distance": 3,
    "Code": "\rineed(R%, e%) = CSng(AMAX(mininv, Amin(maxinv, ineed(R%, e%))))\r\r"
  },
  {
    "Variable": "ken",
    "UsesVariable": "ENP",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "ken",
    "UsesVariable": "QE",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "ken",
    "UsesVariable": "ennoprodsw",
    "Distance": 34,
    "Code": "0"
  },
  {
    "Variable": "ken",
    "UsesVariable": "eprodr",
    "Distance": 35,
    "Code": "0"
  },
  {
    "Variable": "ken",
    "UsesVariable": "elass",
    "Distance": 37,
    "Code": "0"
  },
  {
    "Variable": "ken",
    "UsesVariable": "enpcoalmax",
    "Distance": 26,
    "Code": "0"
  },
  {
    "Variable": "ken",
    "UsesVariable": "ENDEM",
    "Distance": 22,
    "Code": "0"
  },
  {
    "Variable": "KNENVINDEX",
    "UsesVariable": "ECONFREE",
    "Distance": 15,
    "Code": "\rDim GovRegQualIndex = AMAX(0, Amin(1, GOVREGQUAL(R%) / 5))\r\rDim FreeDomIndex = AMAX(0, Amin(1, FREEDOM(R%) / 14))\r\r'If IY% = 1 Then Debug.Print RegName(R%); EdterGRateIndex\r\rDim EonFreeIndex = AMAX(0, Amin(1, ECONFREE(R%) / 10))\r\rKNENVINDEX(R%) = (EonFreeIndex + FreeDomIndex + GovRegQualIndex) / 3\r"
  },
  {
    "Variable": "KNENVINDEX",
    "UsesVariable": "FREEDOM",
    "Distance": 14,
    "Code": "\rDim GovRegQualIndex = AMAX(0, Amin(1, GOVREGQUAL(R%) / 5))\r"
  },
  {
    "Variable": "KNENVINDEX",
    "UsesVariable": "GOVREGQUAL",
    "Distance": 13,
    "Code": "\rDim GovRegQualIndex = AMAX(0, Amin(1, GOVREGQUAL(R%) / 5))\r"
  },
  {
    "Variable": "KNEXTINDEX",
    "UsesVariable": "XRPA",
    "Distance": 6,
    "Code": "\rDim InvCompFixMax = Math.Log(500)\r\rIf context.HistoricMode Then\rInvIndex = 0  'No FDI data historically\rElse\rDim InvComp = Math.Log(AMAX(1, 100 * (XFDISTOCK(R%) + XFDISTOUT(R%)) / GDPPOT(R%))) '/ FDIBenchI\rInvIndex = CSng(Amin(1, InvComp / InvCompFixMax))\rEnd If\r\r\r\r'mti Sept 2010 Revise Knowledge Model\r\rDim TradeCompFixMax = Math.Log(1000)\r\r'TradeCompFixMin = 0\r'  If RegName(R%) = \"Luxembourg\" Then Stop\r'      For R% = 1 To NR%\rDim TradeComp = Math.Log(AMAX(1, 100 * (XRPA(R%) + MRPA(R%)) / GDPPOT(R%))) '/ TradeBenchI\r\rIf context.HistoricMode Then\rInvIndex = 0  'No FDI data historically\rElse\rDim InvComp = Math.Log(AMAX(1, 100 * (XFDISTOCK(R%) + XFDISTOUT(R%)) / GDPPOT(R%))) '/ FDIBenchI\rInvIndex = CSng(Amin(1, InvComp / InvCompFixMax))\rEnd If\r\rDim TradeIndex = Amin(1, TradeComp / TradeCompFixMax)\r\r\r'greater emphasis on FDI\rKNEXTINDEX(R%) = CSng((TradeIndex + 2 * InvIndex) / 3) '* 100\r"
  },
  {
    "Variable": "KNEXTINDEX",
    "UsesVariable": "MRPA",
    "Distance": 6,
    "Code": "\rDim InvCompFixMax = Math.Log(500)\r"
  },
  {
    "Variable": "KNEXTINDEX",
    "UsesVariable": "GDPPOT",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "KNEXTINDEX",
    "UsesVariable": "XFDISTOCK",
    "Distance": 2,
    "Code": "\rDim InvCompFixMax = Math.Log(500)\r"
  },
  {
    "Variable": "KNEXTINDEX",
    "UsesVariable": "XFDISTOUT",
    "Distance": 2,
    "Code": "\rDim InvCompFixMax = Math.Log(500)\r"
  },
  {
    "Variable": "KNHCINDEX",
    "UsesVariable": "LIT",
    "Distance": 21,
    "Code": "\r\r'0 to 1 - Linear\rDim AdultSecPerIndex = AMAX(0, Amin(1, (EDSECPER(R%, Total) - AdultSecPerFixMin) /\r             (AdultSecPerFixMax - AdultSecPerFixMin)))\rCOMPLETE STRUCTURE:Next R%:16705|\r\r\rFor R% = 1 To NR%\r\r'0 to 1 - logarithmic\r'LitIndex = AMAX(0, Amin(1, Log(LIT(R%)) / 2 * Log(10))) 'Log(100)/2 =1  '0 to 1\r\rDim LitIndex = AMAX(0, Amin(1, LIT(R%) / 100)) 'Log(100)/2 =1  '0 to 1\r\r\r'       Next R%\r'EconIntegIndex = ECONINTEG(R%) / 100\r\rKNHCINDEX(R%) = (LitIndex + AdultSecPerIndex) / 2\r"
  },
  {
    "Variable": "KNHCINDEX",
    "UsesVariable": "EDSECPER",
    "Distance": 20,
    "Code": "\r\r'0 to 1 - Linear\rDim AdultSecPerIndex = AMAX(0, Amin(1, (EDSECPER(R%, Total) - AdultSecPerFixMin) /\r             (AdultSecPerFixMax - AdultSecPerFixMin)))\r"
  },
  {
    "Variable": "KNICTINDEX",
    "UsesVariable": "INFRATELE",
    "Distance": 20,
    "Code": "\rDim ICTComputersIndex = AMAX(0, Amin(1, ICTCOMPUTERS(R%) / 100))\r\rDim ICTBroadIndex = AMAX(0, Amin(1, ICTBROAD(R%) / 100))\r\rDim ICTMobileIndex = AMAX(0, Amin(1, ICTMOBIL(R%) / 100))\r\r\r'mti 2010/04/12 ICTTelephoneIndex = AMAX(0, Amin(1, Log(INFRATELE(R%)) / 3 / Log(10)))  'Log in VB is natural log; Log(x)/Log(n) goves log of x with base n\rDim ICTTelephoneIndex = AMAX(0, Amin(1, Math.Log(AMAX(0.00000001, INFRATELE(R%))) / 3 / Math.Log(10))) 'Log in VB is natural log; Log(x)/Log(n) goves log of x with base n\r\rKNICTINDEX(R%) = CSng((ICTTelephoneIndex + ICTMobileIndex + ICTBroadIndex + ICTComputersIndex) / 4)\r"
  },
  {
    "Variable": "KNICTINDEX",
    "UsesVariable": "ICTMOBIL",
    "Distance": 19,
    "Code": "\rDim ICTComputersIndex = AMAX(0, Amin(1, ICTCOMPUTERS(R%) / 100))\r"
  },
  {
    "Variable": "KNICTINDEX",
    "UsesVariable": "ICTBROAD",
    "Distance": 18,
    "Code": "\rDim ICTComputersIndex = AMAX(0, Amin(1, ICTCOMPUTERS(R%) / 100))\r"
  },
  {
    "Variable": "KNICTINDEX",
    "UsesVariable": "ICTCOMPUTERS",
    "Distance": 17,
    "Code": "\rDim ICTComputersIndex = AMAX(0, Amin(1, ICTCOMPUTERS(R%) / 100))\r"
  },
  {
    "Variable": "KNINNOVINDEX",
    "UsesVariable": "RANDDEXP",
    "Distance": 17,
    "Code": "\rDim EdterGRateIndex = AMAX(0, Amin(1, EdTerGRSciEnRate / 25)) 'maxed on 25% (of 100% total grad)\r\r\rDim RandDExpIndex = AMAX(0, Amin(1, (Amin(4, RANDDEXP(R%)) - 0) / (4 - 0))) 'max at 4%\r\rKNINNOVINDEX(R%) = (RandDExpIndex + EdterGRateIndex) / 2\r"
  },
  {
    "Variable": "KNINNOVINDEX",
    "UsesVariable": "EDTERGRATE",
    "Distance": 16,
    "Code": "\r\r'EdterGRateIndex = AMAX(0, Amin(1, EDTERGRATE(R%, Total) / 100))\r\rDim EdTerGRSciEnRate = AMAX(1, Amin(70, EDTERGRATE(R%, Total) * EDTERGRSCIEN(R%) / 100))\r"
  },
  {
    "Variable": "KNINNOVINDEX",
    "UsesVariable": "EDTERGRSCIEN",
    "Distance": 16,
    "Code": "\r\r'EdterGRateIndex = AMAX(0, Amin(1, EDTERGRATE(R%, Total) / 100))\r\rDim EdTerGRSciEnRate = AMAX(1, Amin(70, EDTERGRATE(R%, Total) * EDTERGRSCIEN(R%) / 100))\r"
  },
  {
    "Variable": "KNOWSOC",
    "UsesVariable": "EDTERGRATE",
    "Distance": 3,
    "Code": "\r'ttt 2019/10/08   Take Out\rArray.Copy(RANDDEXP, RandDExpScale, RandDExpScale.Length)\rFor R% = 1 To NR%\r'ttt 2019/10/08 RandDExpScale(R%) = RANDDEXP(R%)\rEdTerGRateScale(R%) = EDTERGRATE(R%, 3)\rNext R%\r\rCall ScaleMeOrig(RandDExpScale, RAndDExpI)\rCall ScaleMeOrig(EdTerGRateScale, EdTerGRateI)\rFor R% = 1 To NR%\rKNOWSOC(R%) = (RandDExpScale(R%) + EdTerGRateScale(R%)) / 2\rNext R%\r"
  },
  {
    "Variable": "KNTOTALINDEX",
    "UsesVariable": "KNEXTINDEX",
    "Distance": 0,
    "Code": "\r\rKNTOTALINDEX(R%) = CSng(KNTOTALINDEX(R%) * 0.9 + KNEXTINDEX(R%) / 10)\r'mti Sept 2010 Revise Knowledge Model\r' + KNEXTINDEX(R%)) / 5\r\r\r\r"
  },
  {
    "Variable": "KNTOTALINDEX",
    "UsesVariable": "KNHCINDEX",
    "Distance": 0,
    "Code": "\r\r'KNEXTINDEX(R%) = EconIntegIndex '/ 100\r\rKNTOTALINDEX(R%) = (KNHCINDEX(R%) + KNICTINDEX(R%) + KNINNOVINDEX(R%) + KNENVINDEX(R%)) / 4\r"
  },
  {
    "Variable": "KNTOTALINDEX",
    "UsesVariable": "KNICTINDEX",
    "Distance": 0,
    "Code": "\r\r'KNEXTINDEX(R%) = EconIntegIndex '/ 100\r\rKNTOTALINDEX(R%) = (KNHCINDEX(R%) + KNICTINDEX(R%) + KNINNOVINDEX(R%) + KNENVINDEX(R%)) / 4\r"
  },
  {
    "Variable": "KNTOTALINDEX",
    "UsesVariable": "KNINNOVINDEX",
    "Distance": 0,
    "Code": "\r\r'KNEXTINDEX(R%) = EconIntegIndex '/ 100\r\rKNTOTALINDEX(R%) = (KNHCINDEX(R%) + KNICTINDEX(R%) + KNINNOVINDEX(R%) + KNENVINDEX(R%)) / 4\r"
  },
  {
    "Variable": "KNTOTALINDEX",
    "UsesVariable": "KNENVINDEX",
    "Distance": 0,
    "Code": "\r\r'KNEXTINDEX(R%) = EconIntegIndex '/ 100\r\rKNTOTALINDEX(R%) = (KNHCINDEX(R%) + KNICTINDEX(R%) + KNINNOVINDEX(R%) + KNENVINDEX(R%)) / 4\r"
  },
  {
    "Variable": "KS",
    "UsesVariable": "IDS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "KS",
    "UsesVariable": "lks",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "KS",
    "UsesVariable": "IGCF",
    "Distance": 7,
    "Code": "\r\r\r'   First Year:  Compute Capital and Labor Growth Rates\r'   ---------------------------------------------------\r\rCall XYTABL(\"Investment Ratio Versus Capital Growth Rate\",\r            IGCF(R%) / GDP(R%), KGroComp, context)\r"
  },
  {
    "Variable": "KS",
    "UsesVariable": "GDP",
    "Distance": 7,
    "Code": "\r\r\r'   First Year:  Compute Capital and Labor Growth Rates\r'   ---------------------------------------------------\r\rCall XYTABL(\"Investment Ratio Versus Capital Growth Rate\",\r            IGCF(R%) / GDP(R%), KGroComp, context)\r"
  },
  {
    "Variable": "KS",
    "UsesVariable": "ksm",
    "Distance": 0,
    "Code": "\r\r'     All Steps:  Update Capital\r'     --------------------------\r\r'If RegName$(R%) = \"United States of America\" Then Stop\rFor S% = 1 To NSec%\rlks(S%) = CSng(LKStruct(S%) * (1 - 0.00667 * keqshr))\r'mti June 2010 - run to run historical -start\rslks(S%) = lks(S%)\r'mti June 2010 - run to run historical -end\rSKS_Bas = (KS(R%, S%) + (IDS(R%, S%) - KS(R%, S%) / lks(S%)))\r'If IY = 19 And GRPS(1, R) = \"Israel\" And S = 4 Then Stop\rSKS(R%, S%) = SKS_Bas * (1.0! - CIVDM(R%))\rSKS(R%, S%) = SKS(R%, S%) * ksm(R%, S%) ' clp 2024/01/22 Adding ksm to enable destruction of capital stocks due to events such as conflict.\rSKS(R%, S%) = AMAX(0.0001, Amin(SKS(R%, S%), 1000000))\rNext S%\r\r\r'     All Steps:  Update Capital\r'     --------------------------\r\r'If RegName$(R%) = \"United States of America\" Then Stop\rFor S% = 1 To NSec%\rlks(S%) = CSng(LKStruct(S%) * (1 - 0.00667 * keqshr))\r'mti June 2010 - run to run historical -start\rslks(S%) = lks(S%)\r'mti June 2010 - run to run historical -end\rSKS_Bas = (KS(R%, S%) + (IDS(R%, S%) - KS(R%, S%) / lks(S%)))\r'If IY = 19 And GRPS(1, R) = \"Israel\" And S = 4 Then Stop\rSKS(R%, S%) = SKS_Bas * (1.0! - CIVDM(R%))\rSKS(R%, S%) = SKS(R%, S%) * ksm(R%, S%) ' clp 2024/01/22 Adding ksm to enable destruction of capital stocks due to events such as conflict.\rSKS(R%, S%) = AMAX(0.0001, Amin(SKS(R%, S%), 1000000))\rNext S%\r"
  },
  {
    "Variable": "KS",
    "UsesVariable": "CIVDM",
    "Distance": 0,
    "Code": "\r\r'     All Steps:  Update Capital\r'     --------------------------\r\r'If RegName$(R%) = \"United States of America\" Then Stop\rFor S% = 1 To NSec%\rlks(S%) = CSng(LKStruct(S%) * (1 - 0.00667 * keqshr))\r'mti June 2010 - run to run historical -start\rslks(S%) = lks(S%)\r'mti June 2010 - run to run historical -end\rSKS_Bas = (KS(R%, S%) + (IDS(R%, S%) - KS(R%, S%) / lks(S%)))\r'If IY = 19 And GRPS(1, R) = \"Israel\" And S = 4 Then Stop\rSKS(R%, S%) = SKS_Bas * (1.0! - CIVDM(R%))\rSKS(R%, S%) = SKS(R%, S%) * ksm(R%, S%) ' clp 2024/01/22 Adding ksm to enable destruction of capital stocks due to events such as conflict.\rSKS(R%, S%) = AMAX(0.0001, Amin(SKS(R%, S%), 1000000))\rNext S%\r\r\r'     All Steps:  Update Capital\r'     --------------------------\r\r'If RegName$(R%) = \"United States of America\" Then Stop\rFor S% = 1 To NSec%\rlks(S%) = CSng(LKStruct(S%) * (1 - 0.00667 * keqshr))\r'mti June 2010 - run to run historical -start\rslks(S%) = lks(S%)\r'mti June 2010 - run to run historical -end\rSKS_Bas = (KS(R%, S%) + (IDS(R%, S%) - KS(R%, S%) / lks(S%)))\r'If IY = 19 And GRPS(1, R) = \"Israel\" And S = 4 Then Stop\rSKS(R%, S%) = SKS_Bas * (1.0! - CIVDM(R%))\rSKS(R%, S%) = SKS(R%, S%) * ksm(R%, S%) ' clp 2024/01/22 Adding ksm to enable destruction of capital stocks due to events such as conflict.\rSKS(R%, S%) = AMAX(0.0001, Amin(SKS(R%, S%), 1000000))\rNext S%\r"
  },
  {
    "Variable": "LAB",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r\r'  If RegName(R%) = \"Micronesia, Fed. Sts.\" Then Stop\rLAB(R%) = CSng(pop_by_cohort(R%, agedst, 4) * LABPARR(R%, 3) / 100)\r"
  },
  {
    "Variable": "LAB",
    "UsesVariable": "LABPARR",
    "Distance": 0,
    "Code": "\r\r'  If RegName(R%) = \"Micronesia, Fed. Sts.\" Then Stop\rLAB(R%) = CSng(pop_by_cohort(R%, agedst, 4) * LABPARR(R%, 3) / 100)\r"
  },
  {
    "Variable": "LABCOEFFS",
    "UsesVariable": "labcoeffsm",
    "Distance": 0,
    "Code": "\r\r\r'LABCOEFFS(R%, S%, Unskilled) = LABCOEFFS(R%, S%, Unskilled) * labcoeffsm(S%, Unskilled)\rLABCOEFFS(R%, S%, sk%) = LABCOEFFS(R%, S%, sk%) * labcoeffsm(S%, sk%)\r\r\r'mti 2018/05/07 Start\r'mti 2018/05/22 Start\rFor S% = 1 To NSec%\rFor sk% = 1 To 2\rLABEMPS(R%, S%, sk%) = LABDEMS(R%, S%, sk%)\rNext sk%\rLABCOEFFS(R%, S%, NSkill%) = LABCOEFFS(R%, S%, Unskilled) + LABCOEFFS(R%, S%, Skilled)\rLABDEMS(R%, S%, NSkill%) = LABDEMS(R%, S%, Unskilled) + LABDEMS(R%, S%, Skilled)\rLABEMPS(R%, S%, NSkill%) = LABEMPS(R%, S%, Unskilled) + LABEMPS(R%, S%, Skilled)\r\r'mti 2018/10/01 Start\rsLABS(R%, S%) = LABS(R%, S%)\r'mti 2018/10/01 End\r\rNext S%\r"
  },
  {
    "Variable": "LABCOEFFS",
    "UsesVariable": "igdpr",
    "Distance": 17,
    "Code": "0"
  },
  {
    "Variable": "LABCOEFFS",
    "UsesVariable": "gdprext",
    "Distance": 17,
    "Code": "\rIf IY% = 2 Then\rLabChng = (LAB(R%) / SLab(R%) - 1)\rIf gdprext(R%) > -20 Then\rVAddChng = gdprext(R%) / 100   'igdpr(R%) 'IRGDPR(R%) '\rElse\rVAddChng = igdpr(R%)\rEnd If\rEnd If\r"
  },
  {
    "Variable": "LABCOEFFS",
    "UsesVariable": "LAB",
    "Distance": 19,
    "Code": "0"
  },
  {
    "Variable": "LABCOEFFS",
    "UsesVariable": "enpadd",
    "Distance": 1,
    "Code": "\rIf S% = 2 Then\r'If RegName(R%) = \"United States of America\" And sk% = 1 Then Stop\rDim SumENP As Single = 0\rDim SumENPMul As Single = 0\rFor EnType = 1 To 6  'Oil, gas, coal, hydro, nuclear, renewable\rSumENP = SumENP + SENP2(R%, EnType)\rSumENPMul = SumENPMul + SENP2(R%, EnType) * enpm(R%, EnType)\r'jrs 2022/04/05\rSumENPMul = SumENPMul + enpadd(R%, EnType)\rNext EnType\rLABCOEFFS(R%, S%, sk%) = LABCOEFFS(R%, S%, sk%) * SumENP / AMAX(0.001, SumENPMul)\rEnd If\r\r\r'bbh 2020/07/07 start\r'   All Steps: Save Energy Production\r'   ---------------------------------\rFor EnType = 1 To 6\rSENP2(R%, EnType) = ENP(R%, EnType)\rNext EnType\r\rIf S% = 2 Then\r'If RegName(R%) = \"United States of America\" And sk% = 1 Then Stop\rDim SumENP As Single = 0\rDim SumENPMul As Single = 0\rFor EnType = 1 To 6  'Oil, gas, coal, hydro, nuclear, renewable\rSumENP = SumENP + SENP2(R%, EnType)\rSumENPMul = SumENPMul + SENP2(R%, EnType) * enpm(R%, EnType)\r'jrs 2022/04/05\rSumENPMul = SumENPMul + enpadd(R%, EnType)\rNext EnType\rLABCOEFFS(R%, S%, sk%) = LABCOEFFS(R%, S%, sk%) * SumENP / AMAX(0.001, SumENPMul)\rEnd If\r\rIf S% = 2 Then\r'If RegName(R%) = \"United States of America\" And sk% = 1 Then Stop\rDim SumENP As Single = 0\rDim SumENPMul As Single = 0\rFor EnType = 1 To 6  'Oil, gas, coal, hydro, nuclear, renewable\rSumENP = SumENP + SENP2(R%, EnType)\rSumENPMul = SumENPMul + SENP2(R%, EnType) * enpm(R%, EnType)\r'jrs 2022/04/05\rSumENPMul = SumENPMul + enpadd(R%, EnType)\rNext EnType\rLABCOEFFS(R%, S%, sk%) = LABCOEFFS(R%, S%, sk%) * SumENP / AMAX(0.001, SumENPMul)\rEnd If\r\rIf S% = 2 Then\r'If RegName(R%) = \"United States of America\" And sk% = 1 Then Stop\rDim SumENP As Single = 0\rDim SumENPMul As Single = 0\rFor EnType = 1 To 6  'Oil, gas, coal, hydro, nuclear, renewable\rSumENP = SumENP + SENP2(R%, EnType)\rSumENPMul = SumENPMul + SENP2(R%, EnType) * enpm(R%, EnType)\r'jrs 2022/04/05\rSumENPMul = SumENPMul + enpadd(R%, EnType)\rNext EnType\rLABCOEFFS(R%, S%, sk%) = LABCOEFFS(R%, S%, sk%) * SumENP / AMAX(0.001, SumENPMul)\rEnd If\r\rIf S% = 2 Then\r'If RegName(R%) = \"United States of America\" And sk% = 1 Then Stop\rDim SumENP As Single = 0\rDim SumENPMul As Single = 0\rFor EnType = 1 To 6  'Oil, gas, coal, hydro, nuclear, renewable\rSumENP = SumENP + SENP2(R%, EnType)\rSumENPMul = SumENPMul + SENP2(R%, EnType) * enpm(R%, EnType)\r'jrs 2022/04/05\rSumENPMul = SumENPMul + enpadd(R%, EnType)\rNext EnType\rLABCOEFFS(R%, S%, sk%) = LABCOEFFS(R%, S%, sk%) * SumENP / AMAX(0.001, SumENPMul)\rEnd If\r\r'bbh 2020/07/01 end\r\rLABCOEFFS(R%, S%, sk%) = CSng(0.1 * LABCOEFFS(R%, S%, sk%) + 0.9 * sLABCOEFFS(R%, S%, sk%)) 'bbh 2021/09/30 Overly rapid change makes total demand drop too fast\r"
  },
  {
    "Variable": "LABCOEFFS",
    "UsesVariable": "ENP",
    "Distance": 1287,
    "Code": "0"
  },
  {
    "Variable": "LABCOEFFS",
    "UsesVariable": "enpm",
    "Distance": 2,
    "Code": "\r\r'bbh 2020/07/07 start\r'   All Steps: Save Energy Production\r'   ---------------------------------\rFor EnType = 1 To 6\rSENP2(R%, EnType) = ENP(R%, EnType)\rNext EnType\r\rIf S% = 2 Then\r'If RegName(R%) = \"United States of America\" And sk% = 1 Then Stop\rDim SumENP As Single = 0\rDim SumENPMul As Single = 0\rFor EnType = 1 To 6  'Oil, gas, coal, hydro, nuclear, renewable\rSumENP = SumENP + SENP2(R%, EnType)\rSumENPMul = SumENPMul + SENP2(R%, EnType) * enpm(R%, EnType)\r'jrs 2022/04/05\rSumENPMul = SumENPMul + enpadd(R%, EnType)\rNext EnType\rLABCOEFFS(R%, S%, sk%) = LABCOEFFS(R%, S%, sk%) * SumENP / AMAX(0.001, SumENPMul)\rEnd If\r"
  },
  {
    "Variable": "LABCOEFFS",
    "UsesVariable": "ylm",
    "Distance": 0,
    "Code": "\r'LABCOEFFS(R%, S%, Skilled) = LaborF(R%, Skilled, S%)  'sLABCOEFFS(R%, S%, Skilled) * 0.5 + 0.5 * LaborF(R%, Skilled, S%) '* (1 - labwageimpact * 0.6)\r\r'bbh 2020/07/01 start   'Must back scenario enhancement of production in ag and en out of labor demand coefficients or\r'labor code will boost labor to accomplish the production boost that is typically meant to come from extra productivty\rIf S% = 1 And ylm(R%) <> 1 Then LABCOEFFS(R%, S%, sk%) = LABCOEFFS(R%, S%, sk%) / AMAX(0.001, ylm(R%))\r"
  },
  {
    "Variable": "LABCOEFFS",
    "UsesVariable": "GDPPCP",
    "Distance": 1337,
    "Code": "0"
  },
  {
    "Variable": "LABCOEFFS",
    "UsesVariable": "POPR",
    "Distance": 1338,
    "Code": "COMPLETE STRUCTURE:End Function:4209|\r\rFunction LaborF(R%, skill As Integer, ss As Integer, context As IForecastContext) As Single\r'- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\r'mti 10/05/2017 whole procedure\r\r'mti 2017/09 whole procedure\r'changed GDPPC to GDPPC;\r'jrs 2015/05/22\r'GDPPC is in Thousands, iothresh is in regular dollars\r'so I had to add a multiplication x 1000 to GDPPC for all evaluations and computations\r'If RegName(R) = \"Chad\" And ss = 4 And skill = 2 Then Stop\r'jrs 2014/09/15\r'gvdb 2024/04/05\r' unused variable\r'Dim Thr As Integer, fac As Single\r'Dim x_beg, x_end, y_beg, y_end As Single\rDim sGDPPC_Use As Single\rDim sec_name$, skill_name$, func_name$\r\r'mti 2018/03/20 start\r'mti 2019/01/22 start\r'    If IY = 1 Then\r'        sGDPPC_Use = sGDPPC(R%) / (1 + (igdpr(R%) - POPR(R%) / 100)) '0.95 ' 0.97  'IGDPRCor not calculated yet\r'    Else\r'        sGDPPC_Use = sGDPPC(R%)\r'    End If\rIf IY = 1 Then\rsGDPPC_Use = GDPPCP(R%) / (1 + (igdpr(R%) - POPR(R%) / 100)) '0.95 ' 0.97  'IGDPRCor not calculated yet\rElse\r'sGDPPC_Use = sGDPPCP(R%)\rsGDPPC_Use = AMAX(iGDPPCP(R%), sGDPPCP(R%)) 'bbh 2021/09/30\r'sGDPPC_Use = iGDPPCP(R%) 'bbh 2021/09/30 For testing behavior if labor coefficients don't change\rEnd If\r"
  },
  {
    "Variable": "LABDEMS",
    "UsesVariable": "LAB",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "LABDEMS",
    "UsesVariable": "LABUNEMPR",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "LABDEMS",
    "UsesVariable": "LABS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "LABDEMS",
    "UsesVariable": "POPURBAN",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "LABDEMS",
    "UsesVariable": "POP",
    "Distance": 1551,
    "Code": "0"
  },
  {
    "Variable": "LABDEMS",
    "UsesVariable": "igdpr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "LABDEMS",
    "UsesVariable": "LABCOEFFS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "LABDEMS",
    "UsesVariable": "labdemsm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "LABDEMS",
    "UsesVariable": "VADD",
    "Distance": 1593,
    "Code": "0"
  },
  {
    "Variable": "LABDEMS",
    "UsesVariable": "LABEMPS",
    "Distance": 1539,
    "Code": "0"
  },
  {
    "Variable": "LABEMPS",
    "UsesVariable": "LABDEMS",
    "Distance": 0,
    "Code": "\r\r'mti 2018/05/07 Start\r'mti 2018/05/22 Start\rFor S% = 1 To NSec%\rFor sk% = 1 To 2\rLABEMPS(R%, S%, sk%) = LABDEMS(R%, S%, sk%)\rNext sk%\rLABCOEFFS(R%, S%, NSkill%) = LABCOEFFS(R%, S%, Unskilled) + LABCOEFFS(R%, S%, Skilled)\rLABDEMS(R%, S%, NSkill%) = LABDEMS(R%, S%, Unskilled) + LABDEMS(R%, S%, Skilled)\rLABEMPS(R%, S%, NSkill%) = LABEMPS(R%, S%, Unskilled) + LABEMPS(R%, S%, Skilled)\r\r'mti 2018/10/01 Start\rsLABS(R%, S%) = LABS(R%, S%)\r'mti 2018/10/01 End\r\rNext S%\r\r\r'mti 2018/05/07 Start\r'mti 2018/05/22 Start\rFor S% = 1 To NSec%\rFor sk% = 1 To 2\rLABEMPS(R%, S%, sk%) = LABDEMS(R%, S%, sk%)\rNext sk%\rLABCOEFFS(R%, S%, NSkill%) = LABCOEFFS(R%, S%, Unskilled) + LABCOEFFS(R%, S%, Skilled)\rLABDEMS(R%, S%, NSkill%) = LABDEMS(R%, S%, Unskilled) + LABDEMS(R%, S%, Skilled)\rLABEMPS(R%, S%, NSkill%) = LABEMPS(R%, S%, Unskilled) + LABEMPS(R%, S%, Skilled)\r\r'mti 2018/10/01 Start\rsLABS(R%, S%) = LABS(R%, S%)\r'mti 2018/10/01 End\r\rNext S%\r"
  },
  {
    "Variable": "LABINFORMPCNTINF",
    "UsesVariable": "infinformcoeffintercept",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "LABINFORMPCNTINF",
    "UsesVariable": "infinformcoefflabinf",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "LABINFORMPCNTINF",
    "UsesVariable": "LABINFORMSHR",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "LABINFORMPCNTNONINF",
    "UsesVariable": "LABINFORMPCNTINF",
    "Distance": 0,
    "Code": "\r\rLABINFORMPCNTNONINF(R%, Total) = 100 - LABINFORMPCNTINF(R%, Total)\r\rLABINFORMPCNTNONINFFemShare(R%) = LABINFORMPCNTNONINF(R%, Female) / LABINFORMPCNTNONINF(R%, Total)\r\r\rLABINFORMPCNTNONINF(R%, Female) = LABINFORMPCNTNONINFFemShare(R%) * LABINFORMPCNTNONINF(R%, Total)\r\rLABINFORMPCNTNONINFFemShare(R%) = LABINFORMPCNTNONINF(R%, Female) / LABINFORMPCNTNONINF(R%, Total)\r\rLABINFORMPCNTNONINF(R%, Male) = (1 - LABINFORMPCNTNONINFFemShare(R%)) * LABINFORMPCNTNONINF(R%, Total)\r\r'mti 2015/03/04 - end\r'mti 2015/03/04 - end\r'mti 2014/11/27 -  start\r"
  },
  {
    "Variable": "LABINFORMSHR",
    "UsesVariable": "labinformshrm",
    "Distance": 0,
    "Code": "\r'slabinfaddurbfrac(R%) = labinfaddurbfrac(R%)\r'mti 2019/01/09 End\r\r\rLABINFORMSHR(R%) = Amin(85, AMAX(1, LABINFORMSHR(R%) * labinformshrm(R%)))\r"
  },
  {
    "Variable": "LABINFORMSHR",
    "UsesVariable": "POPURBAN",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "LABINFORMSHR",
    "UsesVariable": "POPR",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "LABINFORMSHR",
    "UsesVariable": "LABEMPS",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "LABINFORMSHR",
    "UsesVariable": "labinformcoeffed",
    "Distance": 4,
    "Code": "\rLabInfFirmTaxTerm = CSng(labinformcoefftax * (Math.Log(AMAX(1.001, sfirmtaxr(R%))) - iLabInfFirmTaxTerm(R%)))\r\rLabInfBusRegTerm = labinformcoeffbus * (sgovbusregind(R%) - iLabInfBusRegTerm(R%))\r\rLabInfTransTerm = labinformcoeffhhtrn * ((100 * sgovhhtrn(R%) / gdplastyr) - iLabInfTransTerm(R%))\r\r\r'Multiple regression model DKB : (TotalTaxrate replaced with FIRMTAXR which is very different)\r\r'mti 2015/01/20 - start\r'labinformal = 113.96 - 2.402 * sedyrsag15(R%) - 2.24 * Sqr(100 * sgds(R%, RandD) / gdplastyr) - 1.6 * (100 * sgovhhtrn(R%) / gdplastyr) _\r'- 12.19 * sgovbusregind(R%) + 11.06 * Log(sfirmtaxr(R%))\r'mti 2015/03/04 - start\r'labinformal = labinformcoeffintercept + labinformcoeffed * sedyrsag15(R%) + labinformcoeffRanD * Sqr(100 * sgds(R%, RandD) / gdplastyr) + labinformcoeffhhtrn * (100 * sgovhhtrn(R%) / gdplastyr) _\r'+ labinformcoeffbus * sgovbusregind(R%) + labinformcoefftax * Log(sfirmtaxr(R%))\r' If RegName(R%) = \"Turkmenistan\" Then Stop\r'bbh 2019/07/21 start\r'labinformal = labinformcoeffintercept + labinformcoeffed * sedyrsag15(R%) _\r'+ labinformcoeffhhtrn * (100 * sgovhhtrn(R%) / gdplastyr) _\r'+ labinformcoeffbus * sgovbusregind(R%) + labinformcoefftax * Log(sfirmtaxr(R%))\r\r'labinformal = labinformcoeffintercept + labinformcoeffed * sedyrsag15(R%) _\r' + labinformcoeffhhtrn * (100 * sgovhhtrn(R%) / gdplastyr) _\r'+ labinformcoeffbus * sgovbusregind(R%) + labinformcoefftax * Log(AMAX(1.001, sfirmtaxr(R%)))\r\r'labinformcoefftax = 5\rLabInfEducTerm = labinformcoeffed * (sedyrsag15(R%) - iLabInfEducTerm(R%))\r\riLABINFORMSHR(R%) = LABINFORMSHR(R%)\r\r\r'LABINFORMSHR(R%) = sLabInformShrReg(R%) + LabInfEducTerm + LabInfTransTerm + LabInfBusRegTerm + LabInfFirmTaxTerm\rLABINFORMSHR(R%) = iLABINFORMSHR(R%) + LabInfEducTerm + LabInfTransTerm + LabInfBusRegTerm + LabInfFirmTaxTerm\r\r\r'mti 2015/01/20 - end\r\r'mti 2019/01/09 Start\r'labinformal = Amin(85, AMAX(1, labinformal))\r\r'labinformshrshift(R%) = LABINFORMSHR(R%) - labinformal\r'labinformshrshift(R%) = 0 'temporary to test\r'LABINFORMSHR(R%) = labinformal 'temporary to test\r'bbh 2019/07/21 end\r\rsLabInformShrReg(R%) = LABINFORMSHR(R%)\r\rLABINFORMSHR(R%) = CSng(0.2 * LABINFORMSHR(R%) + 0.8 * sLabInformShrReg(R%))\r\r\r'mti 2015/01/20 - end\r\r'mti 2019/01/09 Start\r'labinformal = Amin(85, AMAX(1, labinformal))\r\r'labinformshrshift(R%) = LABINFORMSHR(R%) - labinformal\r'labinformshrshift(R%) = 0 'temporary to test\r'LABINFORMSHR(R%) = labinformal 'temporary to test\r'bbh 2019/07/21 end\r\rsLabInformShrReg(R%) = LABINFORMSHR(R%)\r\r\r'iLABINFORMSHR(R%) = LABINFORMSHR(R%)\r'        SLabInfEducTerm(R%) = sedyrsag15(R%)\r'        SLabInfTransTerm(R%) = 100 * sgovhhtrn(R%) / gdplastyr\r'        SLabInfBusRegTerm(R%) = sgovbusregind(R%)\r'        SLabInfFirmTaxTerm(R%) = Log(AMAX(1.001, sfirmtaxr(R%)))\r\r\r'If RegName$(R%) = \"Macedonia\" Then Stop\r'mti 2015/01/20 - end\r\r'If RegName(R%) = \"Libya\" Then Stop\r\r' If RegName$(R%) = \"Uganda\" Then Stop\r'  If RegName$(R%) = \"Iran\" Then Stop\r\r'mti 2019/01/09 start\r'labinformal = Amin(85, AMAX(1, labinformal))\r'mti 2015/03/04 - end\r'bbh 2019/07/21 end\r\r'        If labinformshrshift(R%) > 0 Then\r'            labinfconvyr = 85 '40\r'        Else\r'            labinfconvyr = 120  '90  'lower value might raise inf share\r'        End If\r\r\r'mti 2015/03/04 - start\r\r\r'LABINFORMSHR(R%) = Amin(85, AMAX(1, labinformal _\r'+ ConvergeOverTime(labinformshrshift(R%), 0, labinfconvyr))) '3\r\r'        labinformal = Amin(85, AMAX(1, labinformal _\r' + ConvergeOverTime(labinformshrshift(R%), 0, labinfconvyr))) '3\r\r\r\r' If RegName(R%) = \"Mexico\" Then Debug.Print labinformal;\r\r'fix Iran? mov av here = base_0118\r'labinformal = 0.2 * labinformal + 0.8 * sLabInformShrReg(R%)\r'labinformal = 0.2 * LABINFORMSHR(R%) + 0.8 * sLabInformShrReg(R%)\rlabinformal = LABINFORMSHR(R%)\r\r'bbh 2019/07/21 end\r\rlabinformaldelta = labinformal - sLabInformShrReg(R%)\r"
  },
  {
    "Variable": "LABINFORMSHR",
    "UsesVariable": "EDYRSAG15",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "LABINFORMSHR",
    "UsesVariable": "labinformcoeffhhtrn",
    "Distance": 3,
    "Code": "\r\r'Multiple Regression from DKB\r'mti 2015/03/04 - start\r\r'coeffs changed per new regression\r\r'labinformal = labinformcoeffintercept + labinformcoeffed * EDYRSAG15(R%, 3) + labinformcoeffRanD * Sqr(100 * GDS(R%, RandD) / GDP(R%)) + labinformcoeffhhtrn * (100 * ghhtrn / GDP(R%)) _\r'+ labinformcoeffbus * GOVBUSREGIND(R%) + labinformcoefftax * Log(FIRMTAXR(R%))\r\r'  If RegName(R%) = \"Turkmenistan\" Then Stop\r'bbh 2019/07/21 start\r\r'labinformal = labinformcoeffintercept + labinformcoeffed * EDYRSAG15(R%, 3) + labinformcoeffhhtrn * (100 * ghhtrn / GDP(R%)) _\r'+ labinformcoeffbus * GOVBUSREGIND(R%) + labinformcoefftax * Log(FIRMTAXR(R%))\r'labinformal = labinformcoeffintercept + labinformcoeffed * EDYRSAG15(R%, 3) + labinformcoeffhhtrn * (100 * ghhtrn / GDP(R%)) _\r'+ labinformcoeffbus * GOVBUSREGIND(R%) + labinformcoefftax * Log(AMAX(1.001, FIRMTAXR(R%)))\r' If RegName(R%) = \"Germany\" Then Stop\r\riLabInfEducTerm(R%) = EDYRSAG15(R%, 3)\r"
  },
  {
    "Variable": "LABINFORMSHR",
    "UsesVariable": "GOVHHTRN",
    "Distance": 3,
    "Code": "\r\r'Multiple Regression from DKB\r'mti 2015/03/04 - start\r\r'coeffs changed per new regression\r\r'labinformal = labinformcoeffintercept + labinformcoeffed * EDYRSAG15(R%, 3) + labinformcoeffRanD * Sqr(100 * GDS(R%, RandD) / GDP(R%)) + labinformcoeffhhtrn * (100 * ghhtrn / GDP(R%)) _\r'+ labinformcoeffbus * GOVBUSREGIND(R%) + labinformcoefftax * Log(FIRMTAXR(R%))\r\r'  If RegName(R%) = \"Turkmenistan\" Then Stop\r'bbh 2019/07/21 start\r\r'labinformal = labinformcoeffintercept + labinformcoeffed * EDYRSAG15(R%, 3) + labinformcoeffhhtrn * (100 * ghhtrn / GDP(R%)) _\r'+ labinformcoeffbus * GOVBUSREGIND(R%) + labinformcoefftax * Log(FIRMTAXR(R%))\r'labinformal = labinformcoeffintercept + labinformcoeffed * EDYRSAG15(R%, 3) + labinformcoeffhhtrn * (100 * ghhtrn / GDP(R%)) _\r'+ labinformcoeffbus * GOVBUSREGIND(R%) + labinformcoefftax * Log(AMAX(1.001, FIRMTAXR(R%)))\r' If RegName(R%) = \"Germany\" Then Stop\r\riLabInfEducTerm(R%) = EDYRSAG15(R%, 3)\r"
  },
  {
    "Variable": "LABINFORMSHR",
    "UsesVariable": "labinformcoeffbus",
    "Distance": 2,
    "Code": "\riLabInfTransTerm(R%) = 100 * ghhtrn / GDP(R%)\r\r\r'mti 2014/11/27 -  start\r\r'   All But First 1:  Informal Economy Labor Share\r'   ----------------------------------------------\r\r'      If RegName$(R%) = \"Singapore\" Then Stop\r'\r'Informal Labor Share Model\r\r'Smoothing of GDP to take care of transients in the first few years coming from IMF data\rgdplastyr = CSng(SGDP(R%) * 0.2 + ssGDP(R%) * 0.8)\r"
  },
  {
    "Variable": "LABINFORMSHR",
    "UsesVariable": "GOVBUSREGIND",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "LABINFORMSHR",
    "UsesVariable": "labinformcoefftax",
    "Distance": 1,
    "Code": "\riLabInfBusRegTerm(R%) = GOVBUSREGIND(R%)\r"
  },
  {
    "Variable": "LABINFORMSHR",
    "UsesVariable": "FIRMTAXR",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "LABINFORMSHR",
    "UsesVariable": "GDP",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "LABINFORMSHR",
    "UsesVariable": "GOVEXP",
    "Distance": 1601,
    "Code": "\r\r'mti 2018/10/01 End\r\r\r\r\r\r'mti 2017/09 End\r\r\r'If RegName$(R%) = \"Puerto Rico\" Then Stop\r\r''mti 2018/05/22 start\r''   First Year:  Labor Force by Skill Level\r''   ---------------------------------------\r'\r''        TBName$ = \"GDP/Capita (PPP) Versus Portion of Secondary Educated Who Are Skilled\"\r''        TBName2$ = \"GDP/Capita (PPP) Versus Portion of Tertiary Educated Who Are Skilled\"\r''        Call XYTABL(TBName$, GDPPCP(R%), SecondaryPer)\r''        Call XYTABL(TBName2$, GDPPCP(R%), TertiaryPer)\r''\r''        PerParSkilledSec = (EDSECPER(R%) - EDTERPER(R%)) * SecondaryPer / 100\r''        PerSkilled = EDTERPER(R%) * TertiaryPer / 100 + PerParSkilledSec\r''        PerSkilledI(R%) = AMAX(0.01, PerSkilled)\r''        PerSkilledAdj(R%) = 1\r''        PerUnSkilled = 100 - PerSkilled\r''        LABSUP(R%, Unskilled) = LAB(R%) * PerUnSkilled / 100\r''        LABSUP(R%, Skilled) = LAB(R%) * PerSkilled / 100\r'\r'        'bbh 2017/12/17 Function update\r'        'TbName$ = \"GDP/Capita (PPP) Versus Skilled Labor Share (GTAP 5) Log Variation\"\r'        TbName$ = \"GDP2011PCPPP(2011)/ 1000 Versus Skilled share Lab (2011) Log\"\r'        Call XYTABL(TbName$, GDPPCP(R%), perskilled)\r'        PerSkilledI(R%) = AMAX(0.01, perskilled)\r'        PerSkilledAdj(R%) = 1\r'        LABSUP(R%, Skilled) = LAB(R%) * perskilled / 100\r'        LABSUP(R%, Unskilled) = LAB(R%) - LABSUP(R%, Skilled)\r'\r'        'sgh 2016/01/29 - Make unskilled labor force in first year a global parameter to use for MALNPOPP calcs\r'        labsupi(R%) = LABSUP(R%, Unskilled)\r'        labsups(R%) = labsupi(R%)\r'        'sgh 2016/01/29 - END\r'\r''If RegName$(R%) = \"Puerto Rico\" Then Stop\r'\r'        'mti 2014/11/27 - End\r\r'mti 2018/05/22 End\r\r'jrs 2019/10/14 new comment begin\r'The Shadow Economy variables are alternatives to the Informal GDP variables.\r'They are both key series related to informal production that claimed to measure the same thing.\r'They are essentially mirrors of one another (differing only in the initial values).\r'The parameters (like gdpshadowshrm) are simply coefficients on the forecast equation.\r'jrs 2019/10/14 new comment end\r\r'   First Year:  Informal Economy\r'   -----------------------------\r'Calculate Shift Factors for informal labor shares\r\r'This calculation comes later in the code sequence; so a calculation is also needed here (model gives a warning when CON > EXP in that latter calculation)\rghhtrn = AMAX(0.001, GOVEXP(R%) - GOVCON(R%))\r"
  },
  {
    "Variable": "LABINFORMSHR",
    "UsesVariable": "GOVCON",
    "Distance": 1601,
    "Code": "\r\r'mti 2018/10/01 End\r\r\r\r\r\r'mti 2017/09 End\r\r\r'If RegName$(R%) = \"Puerto Rico\" Then Stop\r\r''mti 2018/05/22 start\r''   First Year:  Labor Force by Skill Level\r''   ---------------------------------------\r'\r''        TBName$ = \"GDP/Capita (PPP) Versus Portion of Secondary Educated Who Are Skilled\"\r''        TBName2$ = \"GDP/Capita (PPP) Versus Portion of Tertiary Educated Who Are Skilled\"\r''        Call XYTABL(TBName$, GDPPCP(R%), SecondaryPer)\r''        Call XYTABL(TBName2$, GDPPCP(R%), TertiaryPer)\r''\r''        PerParSkilledSec = (EDSECPER(R%) - EDTERPER(R%)) * SecondaryPer / 100\r''        PerSkilled = EDTERPER(R%) * TertiaryPer / 100 + PerParSkilledSec\r''        PerSkilledI(R%) = AMAX(0.01, PerSkilled)\r''        PerSkilledAdj(R%) = 1\r''        PerUnSkilled = 100 - PerSkilled\r''        LABSUP(R%, Unskilled) = LAB(R%) * PerUnSkilled / 100\r''        LABSUP(R%, Skilled) = LAB(R%) * PerSkilled / 100\r'\r'        'bbh 2017/12/17 Function update\r'        'TbName$ = \"GDP/Capita (PPP) Versus Skilled Labor Share (GTAP 5) Log Variation\"\r'        TbName$ = \"GDP2011PCPPP(2011)/ 1000 Versus Skilled share Lab (2011) Log\"\r'        Call XYTABL(TbName$, GDPPCP(R%), perskilled)\r'        PerSkilledI(R%) = AMAX(0.01, perskilled)\r'        PerSkilledAdj(R%) = 1\r'        LABSUP(R%, Skilled) = LAB(R%) * perskilled / 100\r'        LABSUP(R%, Unskilled) = LAB(R%) - LABSUP(R%, Skilled)\r'\r'        'sgh 2016/01/29 - Make unskilled labor force in first year a global parameter to use for MALNPOPP calcs\r'        labsupi(R%) = LABSUP(R%, Unskilled)\r'        labsups(R%) = labsupi(R%)\r'        'sgh 2016/01/29 - END\r'\r''If RegName$(R%) = \"Puerto Rico\" Then Stop\r'\r'        'mti 2014/11/27 - End\r\r'mti 2018/05/22 End\r\r'jrs 2019/10/14 new comment begin\r'The Shadow Economy variables are alternatives to the Informal GDP variables.\r'They are both key series related to informal production that claimed to measure the same thing.\r'They are essentially mirrors of one another (differing only in the initial values).\r'The parameters (like gdpshadowshrm) are simply coefficients on the forecast equation.\r'jrs 2019/10/14 new comment end\r\r'   First Year:  Informal Economy\r'   -----------------------------\r'Calculate Shift Factors for informal labor shares\r\r'This calculation comes later in the code sequence; so a calculation is also needed here (model gives a warning when CON > EXP in that latter calculation)\rghhtrn = AMAX(0.001, GOVEXP(R%) - GOVCON(R%))\r"
  },
  {
    "Variable": "LABPARR",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r'mti 2017/11/29 End\r\r'If RegName(R%) = \"Bangladesh\" Then Stop\r' If RegName(R%) = \"Micronesia, Fed. Sts.\" Then Stop\r\r'Debug.Print j, cagedst(j%, ICount%, 1), cagedst(j%, ICount%, 2), pop_male, pop_female, pop_male + pop_female\r\r'Average male and female to get the number for both sexes\rLABPARR(R%, 3) = CSng(pop_wt_avg(R%, LABPARR(R%, Male), LABPARR(R%, Female), agedst, 4, NCohorts)) '15 plus\r"
  },
  {
    "Variable": "LABPARR",
    "UsesVariable": "labretagem",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "LABPARR",
    "UsesVariable": "labparm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "LABPARR",
    "UsesVariable": "labmarketsw",
    "Distance": 0,
    "Code": "\r'mti 2017/11/29 start\r'        For gndr% = 1 To 2\r'            LABPARR(R%, gndr%) = AMAX(10, Amin(95, LABPARR(R%, gndr%) * (1 - labwageimpact * 0.05) * AMAX(0.1, labretagem(R%)) * labparm(R%, gndr%)))\r'        Next gndr%\r\r\rFor gndr% = 1 To 2\rIf labmarketsw = 1 Then\r'bbh 2021/11/26 turned labwageimpact back on\rLABPARR(R%, gndr%) = CSng(AMAX(10, Amin(95, LABPARR(R%, gndr%) * (1 - labwageimpact * 0.05) * AMAX(0.1, labretagem(R%)) * labparm(R%, gndr%))))\r'LABPARR(R%, gndr%) = AMAX(10, Amin(95, LABPARR(R%, gndr%) * AMAX(0.1, labretagem(R%)) * labparm(R%, gndr%))) 'bbh 2021/09/30 Removal of supply impact from laborwageimpact\rElse\rLABPARR(R%, gndr%) = CSng(AMAX(10, Amin(95, LABPARR(R%, gndr%) * AMAX(0.1, labretagem(R%)) * labparm(R%, gndr%))))\rEnd If\rNext gndr%\r"
  },
  {
    "Variable": "LABPARR",
    "UsesVariable": "LABWAGEIND",
    "Distance": 17,
    "Code": "\rslabwageimpact(R%) = 0!\r"
  },
  {
    "Variable": "LABPARR",
    "UsesVariable": "POPWORKING",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "LABPARR",
    "UsesVariable": "POPGT65",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "LABS",
    "UsesVariable": "LABDEMS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "LABS",
    "UsesVariable": "labmarketsw",
    "Distance": 0,
    "Code": "\r'bbh 2021/09/30 end block on upward shocks\r\r'If IY% >= 15 And RegName(R%) = \"Guinea Bissau\" Then Stop\r\r\r'   All but First 1:  If Labor Market is On, Allow Demand to Drive Production Function, Else Supply\r'   ----------------------------------------------------------------------------------------------\r'   Turn on labor market only when willng to have demand swings drive ecoonomy\r\rIf labmarketsw = 1 Then 'labor market on; demand swings will drive production\rFor S% = 1 To NSec%\rLABS(R%, S%) = LABDEMS(R%, S%, Unskilled) + LABDEMS(R%, S%, Skilled) 'LABDEMS(R%, S%)\rNext S%\rElse  'labor market off; supply normalized to demand pattern\r'bbh 2020/04/18 start\r'            sumld = 0 bbh 2020/12/27 jrs 2021/01/06 I added this comment, not marked by Barry\r'            For S% = 1 To NSec% 'bbh 2020/12/27 new loop to test if labor demand change is growth driver\r'                LABDEMS(R%, S%, Unskilled) = LABDEMSI(R%, S%, Unskilled)\r'                LABDEMS(R%, S%, Skilled) = LABDEMSI(R%, S%, Skilled)\r'                sumld = sumld + LABDEMS(R%, S%, Unskilled) + LABDEMS(R%, S%, Skilled)\r'            Next S%\rFor S% = 1 To NSec%\r'mti 2018/08/15 start\r'LABUNEMPR(R%) = LabUnEmpRateTarget(R%)\r\r'                LABUNEMPR(R%) = 10\r'                UNEMPR(R%) = LABUNEMPR(R%) / 100\r'                UNEMPL(R%) = LAB(R%) * UNEMPR(R%)\r'                LABS(R%, S%) = AMAX(0.0001, LAB(R%) * (1 - UNEMPR(R%)) * labsf(R%, S%))\r'                sumld = AMAX(0.0001, (LABDEMS(R%, S%, Unskilled) + LABDEMS(R%, S%, Skilled)))\r'                LABDEMS(R%, S%, Unskilled) = LABDEMS(R%, S%, Unskilled) * LABS(R%, S%) / sumld\r'                LABDEMS(R%, S%, Skilled) = LABDEMS(R%, S%, Skilled) * LABS(R%, S%) / sumld\r\rLABUNEMPR(R%) = LABUNEMPRi(R%) * labunemprm(R%) 'bbh 2021/09/30\rLabUnEmplTar = ConvergeOverTime(LABUNEMPRi(R%), LabUnEmpRateTarget(R%), labunemprtrgtyr(R%)) * labunemprm(R%)\rIf LabUnEmplTar <> LABUNEMPR(R%) Then LABUNEMPR(R%) = LabUnEmplTar\rUNEMPR(R%) = LABUNEMPR(R%) / 100\rUNEMPL(R%) = LAB(R%) * UNEMPR(R%)\r\r'sumld = AMAX(0.0001, (LABDEMS(R%, S%, Unskilled) + LABDEMS(R%, S%, Skilled)))\r'jrs 2020/06/27 If IY = 7 And GRPS(1, R) = \"China\" And S = 5 Then Stop\rLABDEMS(R%, S%, Unskilled) = LABDEMS(R%, S%, Unskilled) * AMAX(0.0001, LAB(R%) * (1 - UNEMPR(R%))) / sumld\rLABDEMS(R%, S%, Skilled) = LABDEMS(R%, S%, Skilled) * AMAX(0.0001, LAB(R%) * (1 - UNEMPR(R%))) / sumld\rLABS(R%, S%) = LABDEMS(R%, S%, Unskilled) + LABDEMS(R%, S%, Skilled)\r'If IY% >= 10 And RegName(R%) = \"Taiwan\" And S% = 1 Then Stop\r'bbh 2020/04/18 end\rNext\rEnd If\r"
  },
  {
    "Variable": "LABSUP",
    "UsesVariable": "LAB",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "LABSUP",
    "UsesVariable": "EDYRSAG15",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "LABSUP",
    "UsesVariable": "GDPPCP",
    "Distance": 2005,
    "Code": "\rEDYRSAG15I(R%) = EDYRSAG15(R%, 3) 'bbh 2020/04/18\r"
  },
  {
    "Variable": "LABUNEMPR",
    "UsesVariable": "labunemprtrgtyr",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "LABUNEMPR",
    "UsesVariable": "labunemprm",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "LABUNEMPR",
    "UsesVariable": "labunemprtrgtval",
    "Distance": 1627,
    "Code": "0"
  },
  {
    "Variable": "LABUNEMPR",
    "UsesVariable": "LAB",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "LABUNEMPR",
    "UsesVariable": "LABDEMS",
    "Distance": 21,
    "Code": "0"
  },
  {
    "Variable": "LABWAGE",
    "UsesVariable": "HHINCEARN",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "LABWAGE",
    "UsesVariable": "LABEMPS",
    "Distance": 48,
    "Code": "0"
  },
  {
    "Variable": "LABWAGE",
    "UsesVariable": "VADDHHS",
    "Distance": 2,
    "Code": "\rVADDHHSTot = 0\r\r\rFor S% = 1 To NSec%\rLABUnSkTot = LABUnSkTot + LABEMPS(R%, S%, Unskilled)\rLABSkTot = LABSkTot + LABEMPS(R%, S%, Skilled)\rNext S%\r\rFor S% = 1 To NSec%\r'            VADDHHU(R%, S%) = VADD(R%, S%) * LaborF(R%, Unskilled, S%)\r'            VADDHHS(R%, S%) = VADD(R%, S%) * LaborF(R%, Skilled, S%)\r'            'LABWAGES(R%, S%, Unskilled) = VAddFromLab * LABWAGESSHRSKL(R%, S%, Unskilled) / 100 / AMAX(0.0001, LABEMPS(R%, S%, Unskilled))\r\rVADDHHU(R%, S%) = LABWAGES(R%, S%, Unskilled) * LABEMPS(R%, S%, Unskilled)\rVADDHHS(R%, S%) = LABWAGES(R%, S%, Skilled) * LABEMPS(R%, S%, Skilled)\r\r'  Debug.Print RegName(R%); \",\"; IY; \",\"; S%; \",\"; LABEMPS(R%, S%, Skilled); \",\"; LABEMPS(R%, S%, Unskilled); \",\"; LABWAGES(R%, S%, Skilled); \",\"; LABWAGES(R%, S%, Unskilled)\r\rVAddCalc = VADDHHU(R%, S%) + VADDHHS(R%, S%)\rVADDHHU(R%, S%) = VADDHHU(R%, S%) * VADD(R%, S%) / AMAX(0.001, VAddCalc)    ' (1 - alphas(R%, S%))\rVADDHHS(R%, S%) = VADDHHS(R%, S%) * VADD(R%, S%) / AMAX(0.001, VAddCalc)\r\r\r'                    VADDHHU(R%, S%) = VADDHHU(R%, S%) * VADD(R%, S%) * (1 - alphas(R%, S%)) / AMAX(0.001, VAddCalc)  ' (1 - alphas(R%, S%))\r'                    VADDHHS(R%, S%) = VADDHHS(R%, S%) * VADD(R%, S%) * (1 - alphas(R%, S%)) / AMAX(0.001, VAddCalc)\r\r\rVADDHHUTot = VADDHHUTot + VADDHHU(R%, S%)\rVADDHHSTot = VADDHHSTot + VADDHHS(R%, S%)\r\r\rNext S%\r\rLABWAGE(R%, Skilled) = VADDHHSTot / LABSkTot\r"
  },
  {
    "Variable": "LABWAGE",
    "UsesVariable": "VADDHHU",
    "Distance": 2,
    "Code": "\rDo While i2 < 30\r\rVADDHHUTot = 0\r\r\rFor S% = 1 To NSec%\rLABUnSkTot = LABUnSkTot + LABEMPS(R%, S%, Unskilled)\rLABSkTot = LABSkTot + LABEMPS(R%, S%, Skilled)\rNext S%\r\rFor S% = 1 To NSec%\r'            VADDHHU(R%, S%) = VADD(R%, S%) * LaborF(R%, Unskilled, S%)\r'            VADDHHS(R%, S%) = VADD(R%, S%) * LaborF(R%, Skilled, S%)\r'            'LABWAGES(R%, S%, Unskilled) = VAddFromLab * LABWAGESSHRSKL(R%, S%, Unskilled) / 100 / AMAX(0.0001, LABEMPS(R%, S%, Unskilled))\r\rVADDHHU(R%, S%) = LABWAGES(R%, S%, Unskilled) * LABEMPS(R%, S%, Unskilled)\rVADDHHS(R%, S%) = LABWAGES(R%, S%, Skilled) * LABEMPS(R%, S%, Skilled)\r\r'  Debug.Print RegName(R%); \",\"; IY; \",\"; S%; \",\"; LABEMPS(R%, S%, Skilled); \",\"; LABEMPS(R%, S%, Unskilled); \",\"; LABWAGES(R%, S%, Skilled); \",\"; LABWAGES(R%, S%, Unskilled)\r\rVAddCalc = VADDHHU(R%, S%) + VADDHHS(R%, S%)\rVADDHHU(R%, S%) = VADDHHU(R%, S%) * VADD(R%, S%) / AMAX(0.001, VAddCalc)    ' (1 - alphas(R%, S%))\rVADDHHS(R%, S%) = VADDHHS(R%, S%) * VADD(R%, S%) / AMAX(0.001, VAddCalc)\r\r\r'                    VADDHHU(R%, S%) = VADDHHU(R%, S%) * VADD(R%, S%) * (1 - alphas(R%, S%)) / AMAX(0.001, VAddCalc)  ' (1 - alphas(R%, S%))\r'                    VADDHHS(R%, S%) = VADDHHS(R%, S%) * VADD(R%, S%) * (1 - alphas(R%, S%)) / AMAX(0.001, VAddCalc)\r\r\rVADDHHUTot = VADDHHUTot + VADDHHU(R%, S%)\rVADDHHSTot = VADDHHSTot + VADDHHS(R%, S%)\r\r\rNext S%\r\r\rLABWAGE(R%, Unskilled) = VADDHHUTot / LABUnSkTot\r"
  },
  {
    "Variable": "LABWAGEIND",
    "UsesVariable": "LABUNEMPR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "LABWAGEIND",
    "UsesVariable": "labunemprtrgtyr",
    "Distance": 1,
    "Code": "\rIf LabUnEmpRateTarget(R%) = 0 Then\rLabUnEmpRateTarget(R%) = Amin(LABUNEMPRi(R%), 10)\rEnd If\r\rLABUNEMPRi(R%) = LABUNEMPR(R%)\r"
  },
  {
    "Variable": "LABWAGEIND",
    "UsesVariable": "labunemprtrgtval",
    "Distance": 1605,
    "Code": "\r\r'mti 2018/07/02 Start\rLabUnEmpRateTarget(R%) = labunemprtrgtval(R%)\r"
  },
  {
    "Variable": "LABWAGES",
    "UsesVariable": "LABWAGESSHRSKL",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "LABWAGES",
    "UsesVariable": "LABEMPS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "LABWAGES",
    "UsesVariable": "VADD",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "LABWAGES",
    "UsesVariable": "salpha",
    "Distance": 1083,
    "Code": "0"
  },
  {
    "Variable": "LABWAGES",
    "UsesVariable": "CDALF",
    "Distance": 1085,
    "Code": "0"
  },
  {
    "Variable": "LABWAGESEXRAT",
    "UsesVariable": "labwagesexratm",
    "Distance": 0,
    "Code": "\r'mti 2018/10/22 End\r\r\r'FIRMEARN(R%) = FIRMINC(R%)\r'bbh 2021/05/15 end\r\r'mti 2020/02/28 Start\rIf IY = 1 Then\riLABWAGESEXRAT(R%) = LABWAGESEXRAT(R%)\rElse\r'base case uses the base/initial year value throughout the horizon; multiplier changes it\rLABWAGESEXRAT(R%) = iLABWAGESEXRAT(R%) * labwagesexratm(R%)\rEnd If\r\r'mti 2018/10/22 End\r\r\r'FIRMEARN(R%) = FIRMINC(R%)\r'bbh 2021/05/15 end\r\r'mti 2020/02/28 Start\rIf IY = 1 Then\riLABWAGESEXRAT(R%) = LABWAGESEXRAT(R%)\rElse\r'base case uses the base/initial year value throughout the horizon; multiplier changes it\rLABWAGESEXRAT(R%) = iLABWAGESEXRAT(R%) * labwagesexratm(R%)\rEnd If\r'mti 2020/02/28 End\r"
  },
  {
    "Variable": "landarablepot",
    "UsesVariable": "landarablepotlow",
    "Distance": 0,
    "Code": "\r'wv 2021/08/12 make the landarablepot scenario dependent. standard this is set to the high level, but in scenarios with stricter land policies this can be adjusted\r'landarablepotsw = 3\rIf landarablepotsw = 3 Then\rlandarablepot(R%) = landarablepot(R%)\rElseIf landarablepotsw = 2 Then\rlandarablepot(R%) = landarablepotmed(R%)\rElse\rlandarablepot(R%) = landarablepotlow(R%)\rEnd If\r"
  },
  {
    "Variable": "landarablepot",
    "UsesVariable": "landarablepotmed",
    "Distance": 0,
    "Code": "\r'wv 2021/08/12 make the landarablepot scenario dependent. standard this is set to the high level, but in scenarios with stricter land policies this can be adjusted\r'landarablepotsw = 3\rIf landarablepotsw = 3 Then\rlandarablepot(R%) = landarablepot(R%)\rElseIf landarablepotsw = 2 Then\rlandarablepot(R%) = landarablepotmed(R%)\rElse\rlandarablepot(R%) = landarablepotlow(R%)\rEnd If\r"
  },
  {
    "Variable": "landarablepot",
    "UsesVariable": "landarablepotsw",
    "Distance": 0,
    "Code": "\r'wv 2021/08/12 make the landarablepot scenario dependent. standard this is set to the high level, but in scenarios with stricter land policies this can be adjusted\r'landarablepotsw = 3\rIf landarablepotsw = 3 Then\rlandarablepot(R%) = landarablepot(R%)\rElseIf landarablepotsw = 2 Then\rlandarablepot(R%) = landarablepotmed(R%)\rElse\rlandarablepot(R%) = landarablepotlow(R%)\rEnd If\r"
  },
  {
    "Variable": "LANDIRAREAACTUAL",
    "UsesVariable": "LANDIRAREAEQUIP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "LANDIRAREAACTUAL",
    "UsesVariable": "landirareaactualm",
    "Distance": 0,
    "Code": "\r\r'sgh 2016/11/17\rslandirareaactualpercent(R%) = (LANDIRAREAACTUAL(R%) / LANDIRAREAEQUIP(R%))\r"
  },
  {
    "Variable": "LANDIRAREAEQUIP",
    "UsesVariable": "landirareasat",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "LANDIRAREAEQUIP",
    "UsesVariable": "LD",
    "Distance": 0,
    "Code": "\r\r'sgh 2018/01/04 - START\r'Constrain LANDIRAREAEQUIP by crop land as well\rIf LANDIRAREAEQUIP(R%) > (LD(R%, 1) * 1000) Then\rLANDIRAREAEQUIP(R%) = (LD(R%, 1) * 1000)\rEnd If\r"
  },
  {
    "Variable": "LANDIRAREAEQUIP",
    "UsesVariable": "landirareaequipm",
    "Distance": 0,
    "Code": "\r'If RegName(R%) = \"Saudi Arabia\" Then Stop\r'sgh 2018/04/26 - END\r'If RegName(R%) = \"South Africa\" Then Stop\r'sgh 2018/01/04 - END\r\rLANDIRAREAEQUIP(R%) = LANDIRAREAEQUIP(R%) * landirareaequipm(R%)\r"
  },
  {
    "Variable": "LANDIRAREAEQUIP",
    "UsesVariable": "WATPRICE",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "LANDIRAREAEQUIP",
    "UsesVariable": "landirareaequipelas",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "LANDIRAREAEQUIP",
    "UsesVariable": "FPRI",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "LANDIRAREAEQUIP",
    "UsesVariable": "ENVPRCHG",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "LANDIRAREAEQUIP",
    "UsesVariable": "GDPPCP",
    "Distance": 85,
    "Code": "0"
  },
  {
    "Variable": "LANDIRAREAEQUIP",
    "UsesVariable": "POP",
    "Distance": 85,
    "Code": "0"
  },
  {
    "Variable": "LANDIRAREAEQUIP",
    "UsesVariable": "LANDAREA",
    "Distance": 85,
    "Code": "0"
  },
  {
    "Variable": "LANDIRAREAEQUIP",
    "UsesVariable": "INFRAROAD",
    "Distance": 85,
    "Code": "0"
  },
  {
    "Variable": "LANDIRCOST",
    "UsesVariable": "landircostm",
    "Distance": 0,
    "Code": "\rCalcInfraUnitCost(R%, 10, 5, landircostupper, landircostlower, sGDPPCP(R%), LANDIRCOST(R%))\r\rLANDIRCOST(R%) = LANDIRCOST(R%) * landircostm(R%)   'base 1 multiplier on irrigation cost\r"
  },
  {
    "Variable": "LAPOPR",
    "UsesVariable": "labretagem",
    "Distance": 0,
    "Code": "\r'jrs 2013/04/12 POP15to65Ratio = POP15TO65(R%) / POP(R%)\r\r\r'mti 2018/07/02 Start\r'POP15to65Ratio = POPWORKING(R%) / POP(R%)\r'bbh 2020/04/18 2 lines\r'POPAgingRatio = POPWORKING(R%) / AMAX(0.01, POPGT65(R%))\rDim LaborAgeScaleFac = (POPWORKING(R%) * 0.75 + POPGT65(R%) * 0.15) / (POPWORKING(R%) + POPGT65(R%))\r\r\r\r'jrs 2013/04/11\r'Changing Retirement Age multiplier to additive factor\r'-----------------------------------------------------\r'        Dim mult As Single\r'        mult = 0\r'        If labretagem(R%) > 0 Then\r'            For j = 65 To 65 + labretagem(R%) - 1\r'                mult = mult + fagedst(j, R%, 1) + fagedst(j, R%, 2)\r'            Next j\r'        Else\r'            For j = 65 To 65 + labretagem(R%) - 1 Step -1\r'                mult = mult - fagedst(j, R%, 1) - fagedst(j, R%, 2)\r'            Next j\r'        End If\r'\r'        If POP(R%) > 0 Then\r'            mult = mult / POP(R%)\r'        End If\r'        mult = 1 + mult\r\r'mti 2018/07/02 Start\r'LAPOPR(R%) = LAPOPR(R%) * POP15to65Ratio * AMAX(0.1, labretagem(R%)) / POP15to65RatioI(R%)\r'bbh 2020/04/18 start 2 lines\r'LAPOPR(R%) = LAPOPR(R%) * POPAgingRatio * AMAX(0.1, labretagem(R%)) / POPAgingRatioI(R%)\rLAPOPR(R%) = CSng(LAPOPR(R%) * LaborAgeScaleFac * AMAX(0.1, labretagem(R%)) / LaborAgeScaleFacI(R%))\r"
  },
  {
    "Variable": "LAPOPR",
    "UsesVariable": "POPWORKING",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "LAPOPR",
    "UsesVariable": "POPGT65",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "LAPOPR",
    "UsesVariable": "FEMSHRLAB",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "LD",
    "UsesVariable": "forestm",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "LD",
    "UsesVariable": "CLD",
    "Distance": 17,
    "Code": "0"
  },
  {
    "Variable": "LD",
    "UsesVariable": "IALK",
    "Distance": 19,
    "Code": "0"
  },
  {
    "Variable": "LD",
    "UsesVariable": "GDPPCP",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "LD",
    "UsesVariable": "landarablepot",
    "Distance": 29,
    "Code": "0"
  },
  {
    "Variable": "LD",
    "UsesVariable": "INAG",
    "Distance": 100,
    "Code": "0"
  },
  {
    "Variable": "LD",
    "UsesVariable": "agon",
    "Distance": 100,
    "Code": "0"
  },
  {
    "Variable": "LD",
    "UsesVariable": "ldcropm",
    "Distance": 26,
    "Code": "0"
  },
  {
    "Variable": "LD",
    "UsesVariable": "dkl",
    "Distance": 26,
    "Code": "0"
  },
  {
    "Variable": "LD",
    "UsesVariable": "POP",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "LIFEXP",
    "UsesVariable": "POP",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "LIFEXP",
    "UsesVariable": "tmortr2",
    "Distance": 47,
    "Code": "0"
  },
  {
    "Variable": "LIFEXP",
    "UsesVariable": "tmortr",
    "Distance": 48,
    "Code": "0"
  },
  {
    "Variable": "LIFEXP",
    "UsesVariable": "GDPPCP",
    "Distance": 596,
    "Code": "0"
  },
  {
    "Variable": "LIFEXP",
    "UsesVariable": "CIVDM",
    "Distance": 49,
    "Code": "0"
  },
  {
    "Variable": "LIFEXP",
    "UsesVariable": "mortconv",
    "Distance": 454,
    "Code": "0"
  },
  {
    "Variable": "LIFEXP",
    "UsesVariable": "CLNEED",
    "Distance": 60,
    "Code": "0"
  },
  {
    "Variable": "LIFEXP",
    "UsesVariable": "clsexp",
    "Distance": 60,
    "Code": "0"
  },
  {
    "Variable": "LIFEXP",
    "UsesVariable": "mortm",
    "Distance": 50,
    "Code": "0"
  },
  {
    "Variable": "LIFEXP",
    "UsesVariable": "MORTMG",
    "Distance": 50,
    "Code": "0"
  },
  {
    "Variable": "LIFEXP",
    "UsesVariable": "AIDSDTHS",
    "Distance": 457,
    "Code": "0"
  },
  {
    "Variable": "LIFEXP",
    "UsesVariable": "CLAVAL",
    "Distance": 63,
    "Code": "0"
  },
  {
    "Variable": "LIFEXP",
    "UsesVariable": "agon",
    "Distance": 63,
    "Code": "0"
  },
  {
    "Variable": "LIFEXP",
    "UsesVariable": "tfrconv",
    "Distance": 107,
    "Code": "\rultlifetar = LifExpTar(gend%) + lifexpspendshift\r"
  },
  {
    "Variable": "LIFEXP",
    "UsesVariable": "LIFEXPHLM",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "LIFEXPHLM",
    "UsesVariable": "POP",
    "Distance": 16,
    "Code": "0"
  },
  {
    "Variable": "LIFEXPHLM",
    "UsesVariable": "DEATHS",
    "Distance": 35,
    "Code": "0"
  },
  {
    "Variable": "LIFEXPHLM",
    "UsesVariable": "NEONATMOR",
    "Distance": 59,
    "Code": "0"
  },
  {
    "Variable": "LIQUIDITY",
    "UsesVariable": "XRESERVES",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "LIQUIDITY",
    "UsesVariable": "CURACT",
    "Distance": 0,
    "Code": "\rLIQUIDITY(R%) = CURACT(R%) / AMAX(0.001, ReserveAbs) * 100\r"
  },
  {
    "Variable": "LIQUIDITY",
    "UsesVariable": "GDPPOT",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "LIQUIDITY",
    "UsesVariable": "govfinconv",
    "Distance": 5,
    "Code": "\r'bbh 2022/06/23 End Addition of elaborated/revised intl stock and flow accouting\r\r'       Reserves - treated as necessary level in the long run\r'       -----------------------------------------------------\r\r'TargetRes = SXReserves(R%)\r'DelXReserves = TargetRes - SXReserves(R%)\r'XRESERVES(R%) = SXReserves(R%) + DelXReserves\r'SXReserves(R%) = XRESERVES(R%)\r'LIQUIDITY(R%) = CURACT(R%) / AMAX(0.001, XRESERVES(R%)) * 100\r\r' Save reserves in absolute levels (SXReserves); Report as % of GDP (XRESERVES)\rTargetRes = ConvergeOverTime(SXReserves(R%) / GDPPOT(R%) * 100, 15, govfinconv)\r"
  },
  {
    "Variable": "LIT",
    "UsesVariable": "EDPRIPER",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "lks",
    "UsesVariable": "keqshr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "LVHERD",
    "UsesVariable": "slr",
    "Distance": 0,
    "Code": "\rAGPppl(R%, 2) = AGP(R%, 2) / (1 - (aglossmeatperc / 100))\r\r'        LVHERDppl(R%) = LVHERD(R%) / (1 - aglossprodperc(R%, 2) / 100)\r'dsr 2015/06/25 Calculate livestock herd size from actual production numbers\r\r'bbh 2017/05/21 added miniumum value of LVHERD below; correction needed in preprocessor\r'to create nonzero LVHERD and create meat production different from milk and eggs only\rLVHERD(R%) = AMAX(0.1 * AGPppl(R%, 2) / slr, (AGPppl(R%, 2) - AGPMILKEGGSppl(R%)) / slr)\r"
  },
  {
    "Variable": "LVHERD",
    "UsesVariable": "AGP",
    "Distance": 3,
    "Code": "\rAGPMILKEGGSppl(R%) = AGPMILKEGGS(R%) / (1 - aglossmeatperc / 100)\r"
  },
  {
    "Variable": "LVHERD",
    "UsesVariable": "AGPMILKEGGS",
    "Distance": 1,
    "Code": "\r'sgh 2018/01/04 - END\r\r'dsr 2014/12/21 For some reason, wrong line was commented out\r'jrs 2014/12/03\r'dsr 2015/06/15 Compute Pre-Production Loss Production in first year\r'dsr 2015/06/15 Compute Production Loss in first year\r'dsr 2015/06/15 Compute Pre-Production Loss Non-Animal Production in first year\r'kbn 2017/09/13 As no data on meat losses are available, these are kept constant at 10 percent. Have added this temporary\r' variable below so the value of the multiplier can be maintained.\rDim aglossmeatperc = Amin(AMAX(10 * aglossprodm(R%, 2), 2), 20)\r"
  },
  {
    "Variable": "LVHERD",
    "UsesVariable": "aglossprodm",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "M",
    "UsesVariable": "MS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MALNCHIL",
    "UsesVariable": "MALNCHP",
    "Distance": 0,
    "Code": "\r\rDim ChildPop As Double\r\rFor R% = 1 To NR%\rChildPop = agedst(1, R%, 1) + agedst(1, R%, 2) '+ agedst(2, R%, 1)  + agedst(2, R%, 2)\r'Children defined as <5 by WB, others; cohort, region, gender is sequence\rMALNCHIL(R%) = CSng(ChildPop * MALNCHP(R%) / 100)\rNext R%\r\r\rDim ChildPop As Double\r\rFor R% = 1 To NR%\rChildPop = agedst(1, R%, 1) + agedst(1, R%, 2) '+ agedst(2, R%, 1)  + agedst(2, R%, 2)\r'Children defined as <5 by WB, others; cohort, region, gender is sequence\rMALNCHIL(R%) = CSng(ChildPop * MALNCHP(R%) / 100)\rNext R%\r"
  },
  {
    "Variable": "MALNCHIL",
    "UsesVariable": "POP",
    "Distance": 1,
    "Code": "\r\rDim ChildPop As Double\r\rFor R% = 1 To NR%\rChildPop = agedst(1, R%, 1) + agedst(1, R%, 2) '+ agedst(2, R%, 1)  + agedst(2, R%, 2)\r'Children defined as <5 by WB, others; cohort, region, gender is sequence\rMALNCHIL(R%) = CSng(ChildPop * MALNCHP(R%) / 100)\rNext R%\r"
  },
  {
    "Variable": "MALNCHP",
    "UsesVariable": "samtomalnchpsw",
    "Distance": 0,
    "Code": "\r\r'jrs 2016/01/29 sSAMAVERTED(R%) = SAMAVERTED(R%)\r\r'All years but first\r'-------------------\r'Adjust SAM\rDim SAMAVERTEDAsPctOfTotalPop As Single, SAMAVERTEDAsPctOfTotalPop2 As Single\rSAMAVERTEDAsPctOfTotalPop = 0\r\r'If GRPS(1, R) = \"India\" AndAlso FirstYear + IY - 1 > 2015 Then Stop\rIf malnhldsw = 0 AndAlso (samavertedm(R%) <> 1 OrElse samadmissionm(R%) <> 1 OrElse samadmissionadd(R%) <> 0) Then 'jrs 2016/02/13\r'jrs 2016/02/17\r'                SAMAVERTEDAsPctOfTotalPop = SAMAVERTED(R%) / 100 * SAMADMISSION(R%) / 100 * (MALNCHPSAM(R%) + MALNCHPSAMINC(R%))\r'                SAMAVERTEDAsPctOfTotalPop = SAMAVERTEDAsPctOfTotalPop - (SAMAVERTED(R%) - DiffAverted) / 100 * (SAMADMISSION(R%) - DiffAdmission) / 100 * (MALNCHPSAM(R%) + MALNCHPSAMINC(R%))\r'                'jrs 2016/02/04 now assuming SAM already has endogenous averted, so we want to find Pre-Endog Aveted SAM by dividing by (1-Adm/100*Avert/100)\r'                If Not (SAMADMISSION(R%) - DiffAdmission = 100 AndAlso SAMAVERTED(R%) - DiffAverted = 100) Then\r'                    SAMAVERTEDAsPctOfTotalPop = SAMAVERTEDAsPctOfTotalPop / (1 - (SAMADMISSION(R%) - DiffAdmission) / 100 * (SAMAVERTED(R%) - DiffAverted) / 100)\r'                End If\r'                SAMAVERTEDAsPctOfTotalPop2 = SAMAVERTEDAsPctOfTotalPop\r'                If MALNCHPSAM(R%) + MALNCHPSAMINC(R%) <> 0 Then\r'                    SAMAVERTEDAsPctOfTotalPop = SAMAVERTEDAsPctOfTotalPop * MALNCHPSAM(R%) / (MALNCHPSAM(R%) + MALNCHPSAMINC(R%))\r'                    SAMAVERTEDAsPctOfTotalPop2 = SAMAVERTEDAsPctOfTotalPop2 * MALNCHPSAMINC(R%) / (MALNCHPSAM(R%) + MALNCHPSAMINC(R%))\r'                End If\r'\r'                SAMAVERTEDAsPctOfTotalPop = Amin(SAMAVERTEDAsPctOfTotalPop, MALNCHPSAM(R%))\r'                MALNCHPSAM(R%) = (MALNCHPSAM(R%) - SAMAVERTEDAsPctOfTotalPop)\rSAMAVERTEDAsPctOfTotalPop = MALNCHPSAM(R%)\rMALNCHPSAM(R%) = (1 - SAMADMISSION(R%) / 100 * SAMAVERTED(R%) / 100) * (MALNCHPSAM(R%) / (1 - (SAMADMISSION(R%) - DiffAdmission) / 100 * (SAMAVERTED(R%) - DiffAverted) / 100))\rSAMAVERTEDAsPctOfTotalPop = SAMAVERTEDAsPctOfTotalPop - MALNCHPSAM(R%)\r\r'SAMAVERTEDAsPctOfTotalPop2 = Amin(SAMAVERTEDAsPctOfTotalPop2, MALNCHPSAMINC(R%))\r'MALNCHPSAMINC(R%) = (MALNCHPSAMINC(R%) - SAMAVERTEDAsPctOfTotalPop2)\r'jrs 2016/05/12 added switch to control if sam averted stay malnurished or go fully healthy (default)\r'jrs 2017/02/17 If samtomalnchpsw = 0 Then\rIf samtomalnchpsw < 1 Then\r'jrs 2016/01/22\r'jrs 2017/02/17 MALNCHP(R%) = AMAX(0, Amin(MALNCHP(R%) - SAMAVERTEDAsPctOfTotalPop, 100))\rMALNCHP(R%) = AMAX(0, Amin(MALNCHP(R%) - (SAMAVERTEDAsPctOfTotalPop * (1 - samtomalnchpsw)), 100))\rEnd If\rMALNCHPSAM(R%) = CSng(AMAX(0, Amin(MALNCHPSAM(R%), 0.91 * MALNCHP(R%)))) 'I'm leavign at least 9% room for non-severe malnutrition (that's the min level I saw from Data, Eq. Guinea)\rEnd If\r\r'If GRPS(1, R) = \"India\" AndAlso FirstYear + IY - 1 > 2015 Then Stop\rIf malnhldsw = 0 AndAlso (samavertedm(R%) <> 1 OrElse samadmissionm(R%) <> 1 OrElse samadmissionadd(R%) <> 0) Then 'jrs 2016/02/13\r'jrs 2016/02/17\r'                SAMAVERTEDAsPctOfTotalPop = SAMAVERTED(R%) / 100 * SAMADMISSION(R%) / 100 * (MALNCHPSAM(R%) + MALNCHPSAMINC(R%))\r'                SAMAVERTEDAsPctOfTotalPop = SAMAVERTEDAsPctOfTotalPop - (SAMAVERTED(R%) - DiffAverted) / 100 * (SAMADMISSION(R%) - DiffAdmission) / 100 * (MALNCHPSAM(R%) + MALNCHPSAMINC(R%))\r'                'jrs 2016/02/04 now assuming SAM already has endogenous averted, so we want to find Pre-Endog Aveted SAM by dividing by (1-Adm/100*Avert/100)\r'                If Not (SAMADMISSION(R%) - DiffAdmission = 100 AndAlso SAMAVERTED(R%) - DiffAverted = 100) Then\r'                    SAMAVERTEDAsPctOfTotalPop = SAMAVERTEDAsPctOfTotalPop / (1 - (SAMADMISSION(R%) - DiffAdmission) / 100 * (SAMAVERTED(R%) - DiffAverted) / 100)\r'                End If\r'                SAMAVERTEDAsPctOfTotalPop2 = SAMAVERTEDAsPctOfTotalPop\r'                If MALNCHPSAM(R%) + MALNCHPSAMINC(R%) <> 0 Then\r'                    SAMAVERTEDAsPctOfTotalPop = SAMAVERTEDAsPctOfTotalPop * MALNCHPSAM(R%) / (MALNCHPSAM(R%) + MALNCHPSAMINC(R%))\r'                    SAMAVERTEDAsPctOfTotalPop2 = SAMAVERTEDAsPctOfTotalPop2 * MALNCHPSAMINC(R%) / (MALNCHPSAM(R%) + MALNCHPSAMINC(R%))\r'                End If\r'\r'                SAMAVERTEDAsPctOfTotalPop = Amin(SAMAVERTEDAsPctOfTotalPop, MALNCHPSAM(R%))\r'                MALNCHPSAM(R%) = (MALNCHPSAM(R%) - SAMAVERTEDAsPctOfTotalPop)\rSAMAVERTEDAsPctOfTotalPop = MALNCHPSAM(R%)\rMALNCHPSAM(R%) = (1 - SAMADMISSION(R%) / 100 * SAMAVERTED(R%) / 100) * (MALNCHPSAM(R%) / (1 - (SAMADMISSION(R%) - DiffAdmission) / 100 * (SAMAVERTED(R%) - DiffAverted) / 100))\rSAMAVERTEDAsPctOfTotalPop = SAMAVERTEDAsPctOfTotalPop - MALNCHPSAM(R%)\r\r'SAMAVERTEDAsPctOfTotalPop2 = Amin(SAMAVERTEDAsPctOfTotalPop2, MALNCHPSAMINC(R%))\r'MALNCHPSAMINC(R%) = (MALNCHPSAMINC(R%) - SAMAVERTEDAsPctOfTotalPop2)\r'jrs 2016/05/12 added switch to control if sam averted stay malnurished or go fully healthy (default)\r'jrs 2017/02/17 If samtomalnchpsw = 0 Then\rIf samtomalnchpsw < 1 Then\r'jrs 2016/01/22\r'jrs 2017/02/17 MALNCHP(R%) = AMAX(0, Amin(MALNCHP(R%) - SAMAVERTEDAsPctOfTotalPop, 100))\rMALNCHP(R%) = AMAX(0, Amin(MALNCHP(R%) - (SAMAVERTEDAsPctOfTotalPop * (1 - samtomalnchpsw)), 100))\rEnd If\rMALNCHPSAM(R%) = CSng(AMAX(0, Amin(MALNCHPSAM(R%), 0.91 * MALNCHP(R%)))) 'I'm leavign at least 9% room for non-severe malnutrition (that's the min level I saw from Data, Eq. Guinea)\rEnd If\r\r'If GRPS(1, R) = \"India\" AndAlso FirstYear + IY - 1 > 2015 Then Stop\rIf malnhldsw = 0 AndAlso (samavertedm(R%) <> 1 OrElse samadmissionm(R%) <> 1 OrElse samadmissionadd(R%) <> 0) Then 'jrs 2016/02/13\r'jrs 2016/02/17\r'                SAMAVERTEDAsPctOfTotalPop = SAMAVERTED(R%) / 100 * SAMADMISSION(R%) / 100 * (MALNCHPSAM(R%) + MALNCHPSAMINC(R%))\r'                SAMAVERTEDAsPctOfTotalPop = SAMAVERTEDAsPctOfTotalPop - (SAMAVERTED(R%) - DiffAverted) / 100 * (SAMADMISSION(R%) - DiffAdmission) / 100 * (MALNCHPSAM(R%) + MALNCHPSAMINC(R%))\r'                'jrs 2016/02/04 now assuming SAM already has endogenous averted, so we want to find Pre-Endog Aveted SAM by dividing by (1-Adm/100*Avert/100)\r'                If Not (SAMADMISSION(R%) - DiffAdmission = 100 AndAlso SAMAVERTED(R%) - DiffAverted = 100) Then\r'                    SAMAVERTEDAsPctOfTotalPop = SAMAVERTEDAsPctOfTotalPop / (1 - (SAMADMISSION(R%) - DiffAdmission) / 100 * (SAMAVERTED(R%) - DiffAverted) / 100)\r'                End If\r'                SAMAVERTEDAsPctOfTotalPop2 = SAMAVERTEDAsPctOfTotalPop\r'                If MALNCHPSAM(R%) + MALNCHPSAMINC(R%) <> 0 Then\r'                    SAMAVERTEDAsPctOfTotalPop = SAMAVERTEDAsPctOfTotalPop * MALNCHPSAM(R%) / (MALNCHPSAM(R%) + MALNCHPSAMINC(R%))\r'                    SAMAVERTEDAsPctOfTotalPop2 = SAMAVERTEDAsPctOfTotalPop2 * MALNCHPSAMINC(R%) / (MALNCHPSAM(R%) + MALNCHPSAMINC(R%))\r'                End If\r'\r'                SAMAVERTEDAsPctOfTotalPop = Amin(SAMAVERTEDAsPctOfTotalPop, MALNCHPSAM(R%))\r'                MALNCHPSAM(R%) = (MALNCHPSAM(R%) - SAMAVERTEDAsPctOfTotalPop)\rSAMAVERTEDAsPctOfTotalPop = MALNCHPSAM(R%)\rMALNCHPSAM(R%) = (1 - SAMADMISSION(R%) / 100 * SAMAVERTED(R%) / 100) * (MALNCHPSAM(R%) / (1 - (SAMADMISSION(R%) - DiffAdmission) / 100 * (SAMAVERTED(R%) - DiffAverted) / 100))\rSAMAVERTEDAsPctOfTotalPop = SAMAVERTEDAsPctOfTotalPop - MALNCHPSAM(R%)\r\r'SAMAVERTEDAsPctOfTotalPop2 = Amin(SAMAVERTEDAsPctOfTotalPop2, MALNCHPSAMINC(R%))\r'MALNCHPSAMINC(R%) = (MALNCHPSAMINC(R%) - SAMAVERTEDAsPctOfTotalPop2)\r'jrs 2016/05/12 added switch to control if sam averted stay malnurished or go fully healthy (default)\r'jrs 2017/02/17 If samtomalnchpsw = 0 Then\rIf samtomalnchpsw < 1 Then\r'jrs 2016/01/22\r'jrs 2017/02/17 MALNCHP(R%) = AMAX(0, Amin(MALNCHP(R%) - SAMAVERTEDAsPctOfTotalPop, 100))\rMALNCHP(R%) = AMAX(0, Amin(MALNCHP(R%) - (SAMAVERTEDAsPctOfTotalPop * (1 - samtomalnchpsw)), 100))\rEnd If\rMALNCHPSAM(R%) = CSng(AMAX(0, Amin(MALNCHPSAM(R%), 0.91 * MALNCHP(R%)))) 'I'm leavign at least 9% room for non-severe malnutrition (that's the min level I saw from Data, Eq. Guinea)\rEnd If\r"
  },
  {
    "Variable": "MALNCHP",
    "UsesVariable": "MALNCHPSAM",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "MALNCHP",
    "UsesVariable": "malnchpsamm",
    "Distance": 1,
    "Code": "\r\rIf malnhldsw = 0 Then\rmalnbase = malnbase * malnm(R%)\rIf malnchpsamm(R%) <> 1 Then\rDim malnDiff As Single\rmalnDiff = malnbase * (malnchpsamm(R%) - 1)\rMALNCHP(R%) = AMAX(0, Amin(MALNCHP(R%) + malnDiff, 100))\rmalnbase = malnbase + malnDiff\rEnd If\rMALNCHPSAM(R%) = CSng(AMAX(0, Amin(malnbase, 0.91 * MALNCHP(R%)))) 'I'm leavign at least 9% room for non-severe malnutrition (that's the min level I saw from Data, Eq. Guinea)\rElse\rMALNCHPSAM(R%) = malnchpsami(R%)\rEnd If\r\r\rIf malnhldsw = 0 Then\rmalnbase = malnbase * malnm(R%)\rIf malnchpsamm(R%) <> 1 Then\rDim malnDiff As Single\rmalnDiff = malnbase * (malnchpsamm(R%) - 1)\rMALNCHP(R%) = AMAX(0, Amin(MALNCHP(R%) + malnDiff, 100))\rmalnbase = malnbase + malnDiff\rEnd If\rMALNCHPSAM(R%) = CSng(AMAX(0, Amin(malnbase, 0.91 * MALNCHP(R%)))) 'I'm leavign at least 9% room for non-severe malnutrition (that's the min level I saw from Data, Eq. Guinea)\rElse\rMALNCHPSAM(R%) = malnchpsami(R%)\rEnd If\r\r\rIf malnhldsw = 0 Then\rmalnbase = malnbase * malnm(R%)\rIf malnchpsamm(R%) <> 1 Then\rDim malnDiff As Single\rmalnDiff = malnbase * (malnchpsamm(R%) - 1)\rMALNCHP(R%) = AMAX(0, Amin(MALNCHP(R%) + malnDiff, 100))\rmalnbase = malnbase + malnDiff\rEnd If\rMALNCHPSAM(R%) = CSng(AMAX(0, Amin(malnbase, 0.91 * MALNCHP(R%)))) 'I'm leavign at least 9% room for non-severe malnutrition (that's the min level I saw from Data, Eq. Guinea)\rElse\rMALNCHPSAM(R%) = malnchpsami(R%)\rEnd If\r"
  },
  {
    "Variable": "MALNCHP",
    "UsesVariable": "malnm",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "MALNCHP",
    "UsesVariable": "malnconv",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "MALNCHP",
    "UsesVariable": "CLPC",
    "Distance": 55,
    "Code": "0"
  },
  {
    "Variable": "MALNCHP",
    "UsesVariable": "EDYRSAG25",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "MALNCHP",
    "UsesVariable": "GOVCORRUPT",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "MALNCHP",
    "UsesVariable": "SFINTLWARMAG",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "MALNCHP",
    "UsesVariable": "WATSAFE",
    "Distance": 24,
    "Code": "0"
  },
  {
    "Variable": "MALNCHP",
    "UsesVariable": "SANITATION",
    "Distance": 24,
    "Code": "0"
  },
  {
    "Variable": "MALNCHP",
    "UsesVariable": "watsafenewsw",
    "Distance": 24,
    "Code": "0"
  },
  {
    "Variable": "MALNCHP",
    "UsesVariable": "watsafefwdsw",
    "Distance": 24,
    "Code": "0"
  },
  {
    "Variable": "MALNCHP",
    "UsesVariable": "malnhldsw",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:End Sub:14133|COMPLETE STRUCTURE:End If:14087|COMPLETE STRUCTURE:Next R%:14013|\r\r'jrs 2015/12/09\rPrivate Sub ifsPopMALN(ByRef malnchpi As Single(), ByRef MalnChilCompI As Single(), ByRef smalnmul As Single(),\r        ByRef CLPCi As Single(), ByRef malnchpsami As Single(), ByRef smalnsamcomp As Single(),\r        ByRef samadmshift As Single(), ByRef sSAMAVERTED As Single(),\r        ByRef malnpoppi As Single(), ByRef smalnpopmul As Single(), ByRef MalnChilShift As Single(),\r        ByRef SMalnChP As Single(), context As IForecastContext) 'bbh 2019/06/02 changed name of parameter from smalncomp to MalnChilCompI, and added , ByRef MalnChilShift As Variant, ByRef SMalnChP As Variant\r\r'   All Years 2: Malnourished Children (0-5 Years of Age)\r'   -----------------------------------------------------\r'jrs 2009/12/23\rDim z As Single\rDim TbName As String\rDim samadmcomp, malncomp, ConvTime, malnbase, malnmul, MalnCompI, MaxChg, TimeFAc As Single\r\rIf IY% = 1 Then\r'jrs 2016/03/07\rReDim ISAMADMISSION(NR)\r\r'first year\r'-------------------\rFor R% = 1 To NR%\r'malnchpi(R%) = MALNCHP(R%) 'bbh 2019/06/02 replaced this with following\rmalnchpi(R%) = AMAX(0.001, MALNCHP(R%))\r\r\rIf malnhldsw = 0 Then\r'jrs 2008/01/15 added Malnutrition Multiplier\rMALNCHP(R%) = AMAX(0.001, Amin(MALNCHP(R%) * malnm(R%), 100))\rElse\rMALNCHP(R%) = AMAX(0.001, Amin(malnchpi(R%), 100))\rEnd If\r"
  },
  {
    "Variable": "MALNCHPSAM",
    "UsesVariable": "MALNCHP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MALNCHPSAM",
    "UsesVariable": "SAMADMISSION",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MALNCHPSAM",
    "UsesVariable": "SAMAVERTED",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MALNCHPSAM",
    "UsesVariable": "samadmissionadd",
    "Distance": 13,
    "Code": "\r\r'jrs 2016/02/17 adding total averted\r'jrs 2016/03/01 MALNCHPSAMINC(R%) = MALNCHPSAMINC(R%) + SAMADMISSION(R%) / 100 * SAMAVERTED(R%) / 100 * MALNCHPSAM(R%) * (1 + malnchpsamadj)\r\rIf samavertedm(R%) <> 1 OrElse samadmissionm(R%) <> 1 OrElse samadmissionadd(R%) <> 0 Then\rDiffAdmission = (SAMADMISSION(R%) + samadmissionadd(R%)) * samadmissionm(R%) - SAMADMISSION(R%) 'jrs 2016/02/13\rDiffAdmission = AMAX(Amin(DiffAdmission, 100 - SAMADMISSION(R%)), -1 * SAMADMISSION(R%))\rSAMADMISSION(R%) = (SAMADMISSION(R%) + samadmissionadd(R%)) * samadmissionm(R%)\r'dkb 2015/12/18 - Bounding SAMADMISSION to 100%. Mostly affecting for countries with large samadmshift (small samadcomp)\rSAMADMISSION(R%) = AMAX(Amin(SAMADMISSION(R%), 100), 0)\r'jrs 2016/02/13\rIf DiffAdmission <> 0 Then\rIf SAMADMISSIONTOTCOST(R%) = 0 Then 'jrs 2016/02/15\r'jrs 2016/04/05 I had not removed the extra + 1 that went with malnchpsamadj, so I was mult by 2.6 instead of 1.6\rSAMADMISSIONTOTCOST(R%) = (MALNCHPSAM(R%) * (malnchpsamadj)) * SAMADMISSION(R%) * POP0TO5(R%) / 10000 * samadmissioncost(R%)\rElseIf SAMADMISSION(R%) - DiffAdmission > 0 Then\rSAMADMISSIONTOTCOST(R%) = SAMADMISSIONTOTCOST(R%) * SAMADMISSION(R%) / (SAMADMISSION(R%) - DiffAdmission)\rEnd If\rEnd If\r\rDiffAverted = SAMAVERTED(R%) * (samavertedm(R%) - 1)\rDiffAverted = AMAX(Amin(DiffAverted, 100 - SAMAVERTED(R%)), -1 * SAMAVERTED(R%))\rSAMAVERTED(R%) = SAMAVERTED(R%) * samavertedm(R%)\r'jrs 2016/01/28\rSAMAVERTED(R%) = Amin(SAMAVERTED(R%), 100)\rEnd If\r"
  },
  {
    "Variable": "MALNCHPSAM",
    "UsesVariable": "samadmissionm",
    "Distance": 13,
    "Code": "\r\r'jrs 2016/02/17 adding total averted\r'jrs 2016/03/01 MALNCHPSAMINC(R%) = MALNCHPSAMINC(R%) + SAMADMISSION(R%) / 100 * SAMAVERTED(R%) / 100 * MALNCHPSAM(R%) * (1 + malnchpsamadj)\r\rIf samavertedm(R%) <> 1 OrElse samadmissionm(R%) <> 1 OrElse samadmissionadd(R%) <> 0 Then\rDiffAdmission = (SAMADMISSION(R%) + samadmissionadd(R%)) * samadmissionm(R%) - SAMADMISSION(R%) 'jrs 2016/02/13\rDiffAdmission = AMAX(Amin(DiffAdmission, 100 - SAMADMISSION(R%)), -1 * SAMADMISSION(R%))\rSAMADMISSION(R%) = (SAMADMISSION(R%) + samadmissionadd(R%)) * samadmissionm(R%)\r'dkb 2015/12/18 - Bounding SAMADMISSION to 100%. Mostly affecting for countries with large samadmshift (small samadcomp)\rSAMADMISSION(R%) = AMAX(Amin(SAMADMISSION(R%), 100), 0)\r'jrs 2016/02/13\rIf DiffAdmission <> 0 Then\rIf SAMADMISSIONTOTCOST(R%) = 0 Then 'jrs 2016/02/15\r'jrs 2016/04/05 I had not removed the extra + 1 that went with malnchpsamadj, so I was mult by 2.6 instead of 1.6\rSAMADMISSIONTOTCOST(R%) = (MALNCHPSAM(R%) * (malnchpsamadj)) * SAMADMISSION(R%) * POP0TO5(R%) / 10000 * samadmissioncost(R%)\rElseIf SAMADMISSION(R%) - DiffAdmission > 0 Then\rSAMADMISSIONTOTCOST(R%) = SAMADMISSIONTOTCOST(R%) * SAMADMISSION(R%) / (SAMADMISSION(R%) - DiffAdmission)\rEnd If\rEnd If\r\rDiffAverted = SAMAVERTED(R%) * (samavertedm(R%) - 1)\rDiffAverted = AMAX(Amin(DiffAverted, 100 - SAMAVERTED(R%)), -1 * SAMAVERTED(R%))\rSAMAVERTED(R%) = SAMAVERTED(R%) * samavertedm(R%)\r'jrs 2016/01/28\rSAMAVERTED(R%) = Amin(SAMAVERTED(R%), 100)\rEnd If\r"
  },
  {
    "Variable": "MALNCHPSAM",
    "UsesVariable": "samavertedm",
    "Distance": 7,
    "Code": "\r\r'jrs 2016/02/17 adding total averted\r'jrs 2016/03/01 MALNCHPSAMINC(R%) = MALNCHPSAMINC(R%) + SAMADMISSION(R%) / 100 * SAMAVERTED(R%) / 100 * MALNCHPSAM(R%) * (1 + malnchpsamadj)\r\rIf samavertedm(R%) <> 1 OrElse samadmissionm(R%) <> 1 OrElse samadmissionadd(R%) <> 0 Then\rDiffAdmission = (SAMADMISSION(R%) + samadmissionadd(R%)) * samadmissionm(R%) - SAMADMISSION(R%) 'jrs 2016/02/13\rDiffAdmission = AMAX(Amin(DiffAdmission, 100 - SAMADMISSION(R%)), -1 * SAMADMISSION(R%))\rSAMADMISSION(R%) = (SAMADMISSION(R%) + samadmissionadd(R%)) * samadmissionm(R%)\r'dkb 2015/12/18 - Bounding SAMADMISSION to 100%. Mostly affecting for countries with large samadmshift (small samadcomp)\rSAMADMISSION(R%) = AMAX(Amin(SAMADMISSION(R%), 100), 0)\r'jrs 2016/02/13\rIf DiffAdmission <> 0 Then\rIf SAMADMISSIONTOTCOST(R%) = 0 Then 'jrs 2016/02/15\r'jrs 2016/04/05 I had not removed the extra + 1 that went with malnchpsamadj, so I was mult by 2.6 instead of 1.6\rSAMADMISSIONTOTCOST(R%) = (MALNCHPSAM(R%) * (malnchpsamadj)) * SAMADMISSION(R%) * POP0TO5(R%) / 10000 * samadmissioncost(R%)\rElseIf SAMADMISSION(R%) - DiffAdmission > 0 Then\rSAMADMISSIONTOTCOST(R%) = SAMADMISSIONTOTCOST(R%) * SAMADMISSION(R%) / (SAMADMISSION(R%) - DiffAdmission)\rEnd If\rEnd If\r\rDiffAverted = SAMAVERTED(R%) * (samavertedm(R%) - 1)\rDiffAverted = AMAX(Amin(DiffAverted, 100 - SAMAVERTED(R%)), -1 * SAMAVERTED(R%))\rSAMAVERTED(R%) = SAMAVERTED(R%) * samavertedm(R%)\r'jrs 2016/01/28\rSAMAVERTED(R%) = Amin(SAMAVERTED(R%), 100)\rEnd If\r"
  },
  {
    "Variable": "MALNCHPSAM",
    "UsesVariable": "malnchpsamm",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "MALNCHPSAM",
    "UsesVariable": "malnm",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "MALNCHPSAM",
    "UsesVariable": "malnconv",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "MALNCHPSAM",
    "UsesVariable": "CLPC",
    "Distance": 57,
    "Code": "0"
  },
  {
    "Variable": "MALNCHPSAM",
    "UsesVariable": "EDYRSAG25",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "MALNCHPSAM",
    "UsesVariable": "GOVCORRUPT",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "MALNCHPSAM",
    "UsesVariable": "SFINTLWARMAG",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "MALNCHPSAM",
    "UsesVariable": "WATSAFE",
    "Distance": 26,
    "Code": "0"
  },
  {
    "Variable": "MALNCHPSAM",
    "UsesVariable": "SANITATION",
    "Distance": 26,
    "Code": "0"
  },
  {
    "Variable": "MALNCHPSAM",
    "UsesVariable": "watsafenewsw",
    "Distance": 26,
    "Code": "0"
  },
  {
    "Variable": "MALNCHPSAM",
    "UsesVariable": "watsafefwdsw",
    "Distance": 26,
    "Code": "0"
  },
  {
    "Variable": "MALNCHPSAMINC",
    "UsesVariable": "MALNCHPSAM",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MALNCHPSAMINC",
    "UsesVariable": "malnchpsamadj",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MALNCHPSAMINC",
    "UsesVariable": "SAMADMISSION",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MALNCHPSAMINC",
    "UsesVariable": "SAMAVERTED",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MALNCHPSH",
    "UsesVariable": "MALNCHP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MALNCHPSH",
    "UsesVariable": "CLPC",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MALNCHPSH",
    "UsesVariable": "EDSECENRG",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MALNCHPSH",
    "UsesVariable": "WATSAFE",
    "Distance": 0,
    "Code": "\r\r'bbh 2010/10/20 end\r'mti WatSafe->MalnchpSH May 2006\r'   All Years 3:  Child malnutrition according to Smith and Haddad\r'   ------------------------------------------------------------\r'mti MalnchpSH revise June 2006 start\rDim lifeexprat As Single\rFor R% = 1 To NR%  'Targets on these indicators may increase\r'percentage of people with access to safewater\r'If RegName(R%) = \"India\" Then Stop\rIf IY% > 1 Then\rlifeexprat = LIFEXP(R%, Female) / AMAX(1, LIFEXP(R%, Male))\r'Kilocal = AMAX(500, CLAVAL(R%) / POP(R%))\r'jrs 2009/02/19 MALNCHPSH(R%) = malnchpi(R%) - 25.24 * _\r'(Log(CLPC(R%, 4)) - Log(sCLPC(R%))) - 71.76 * (lifeexprat - SLIFEXPRat(R%)) _\r'- 0.22 * (EDSECENRG(R%, Female) - SEdSecEnrGFem(R%)) - 0.08 * (WATSAFE(R%) - sWATSAFE(R%))\r\r'mti 2022/08/17 start\r'mti 2022/10/20 start 'watsafefwdsw\r'If watsafenewsw = 1 Then 'new 5 category model\rIf watsafenewsw = 1 And watsafefwdsw = 1 Then 'new 5 category model\r'mti 2022/10/20 end\r\rDim WaterUnSafe = WATERHH(R%, Surface, National) + WATERHH(R%, Unimproved, National)\rMALNCHPSH(R%) = CSng(malnchpi(R%) - 25.24 *\r                        (Log(CLPC(R%, 4)) - Log(sCLPC(R%))) - 71.76 * (lifeexprat - SLIFEXPRat(R%)) _\r                        - 0.22 * (EDSECENRG(R%, Female) - SEdSecEnrGFem(R%)) - 0.08 * (100 - WaterUnSafe - WATSAFEI(R%)))\r\rElse\r\rMALNCHPSH(R%) = CSng(malnchpi(R%) - 25.24 *\r                        (Log(CLPC(R%, 4)) - Log(sCLPC(R%))) - 71.76 * (lifeexprat - SLIFEXPRat(R%)) _\r                        - 0.22 * (EDSECENRG(R%, Female) - SEdSecEnrGFem(R%)) - 0.08 * (100 - WATSAFE(R%, 1) - WATSAFEI(R%)))\r\rEnd If\r\r'mti 2022/08/17 End\r\r'            MALNCHPSH(R%) = 100 - 25.24 * Log(CLPC(R%, 4) - sCLPC(R%)) - 71.76 * (lifeexprat - SLIFEXPRat(R%)) _\r'- 0.22 * (EDSECENRG(R%, Female) - SEdSecEnrGFem(R%)) - 0.08 * (WATSAFE(R%) - SWATSAFE(R%))\rMALNCHPSH(R%) = AMAX(0, MALNCHPSH(R%))\rElse 'first year\rMALNCHPSH(R%) = MALNCHP(R%)\r'mti MalnchpSH Delta fix June 2006 -start\rSLIFEXPRat(R%) = LIFEXP(R%, Female) / AMAX(1, LIFEXP(R%, Male))\rSEdSecEnrGFem(R%) = EDSECENRG(R%, Female)\r'jrs 2009/02/18 sWATSAFE(R%) = WATSAFE(R%)\r'mti 2022/08/17 start\r'mti 2022/10/20 start 'watsafefwdsw\r'If watsafenewsw = 1 Then 'new 5 category model\rIf watsafenewsw = 1 And watsafefwdsw = 1 Then 'new 5 category model\r'mti 2022/10/20 end\rWATSAFEI(R%) = 100 - WATERHH(R%, Surface, National) - WATERHH(R%, Unimproved, National)\rElse\rWATSAFEI(R%) = 100 - WATSAFE(R%, 1)\rEnd If\r'mti 2022/08/17 End\rsCLPC(R%) = CLPC(R%, 4)\r\rEnd If\rNext R\r"
  },
  {
    "Variable": "MALNCHPSH",
    "UsesVariable": "watsafenewsw",
    "Distance": 0,
    "Code": "\r\r'bbh 2010/10/20 end\r'mti WatSafe->MalnchpSH May 2006\r'   All Years 3:  Child malnutrition according to Smith and Haddad\r'   ------------------------------------------------------------\r'mti MalnchpSH revise June 2006 start\rDim lifeexprat As Single\rFor R% = 1 To NR%  'Targets on these indicators may increase\r'percentage of people with access to safewater\r'If RegName(R%) = \"India\" Then Stop\rIf IY% > 1 Then\rlifeexprat = LIFEXP(R%, Female) / AMAX(1, LIFEXP(R%, Male))\r'Kilocal = AMAX(500, CLAVAL(R%) / POP(R%))\r'jrs 2009/02/19 MALNCHPSH(R%) = malnchpi(R%) - 25.24 * _\r'(Log(CLPC(R%, 4)) - Log(sCLPC(R%))) - 71.76 * (lifeexprat - SLIFEXPRat(R%)) _\r'- 0.22 * (EDSECENRG(R%, Female) - SEdSecEnrGFem(R%)) - 0.08 * (WATSAFE(R%) - sWATSAFE(R%))\r\r'mti 2022/08/17 start\r'mti 2022/10/20 start 'watsafefwdsw\r'If watsafenewsw = 1 Then 'new 5 category model\rIf watsafenewsw = 1 And watsafefwdsw = 1 Then 'new 5 category model\r'mti 2022/10/20 end\r\rDim WaterUnSafe = WATERHH(R%, Surface, National) + WATERHH(R%, Unimproved, National)\rMALNCHPSH(R%) = CSng(malnchpi(R%) - 25.24 *\r                        (Log(CLPC(R%, 4)) - Log(sCLPC(R%))) - 71.76 * (lifeexprat - SLIFEXPRat(R%)) _\r                        - 0.22 * (EDSECENRG(R%, Female) - SEdSecEnrGFem(R%)) - 0.08 * (100 - WaterUnSafe - WATSAFEI(R%)))\r\rElse\r\rMALNCHPSH(R%) = CSng(malnchpi(R%) - 25.24 *\r                        (Log(CLPC(R%, 4)) - Log(sCLPC(R%))) - 71.76 * (lifeexprat - SLIFEXPRat(R%)) _\r                        - 0.22 * (EDSECENRG(R%, Female) - SEdSecEnrGFem(R%)) - 0.08 * (100 - WATSAFE(R%, 1) - WATSAFEI(R%)))\r\rEnd If\r\r'mti 2022/08/17 End\r\r'            MALNCHPSH(R%) = 100 - 25.24 * Log(CLPC(R%, 4) - sCLPC(R%)) - 71.76 * (lifeexprat - SLIFEXPRat(R%)) _\r'- 0.22 * (EDSECENRG(R%, Female) - SEdSecEnrGFem(R%)) - 0.08 * (WATSAFE(R%) - SWATSAFE(R%))\rMALNCHPSH(R%) = AMAX(0, MALNCHPSH(R%))\rElse 'first year\rMALNCHPSH(R%) = MALNCHP(R%)\r'mti MalnchpSH Delta fix June 2006 -start\rSLIFEXPRat(R%) = LIFEXP(R%, Female) / AMAX(1, LIFEXP(R%, Male))\rSEdSecEnrGFem(R%) = EDSECENRG(R%, Female)\r'jrs 2009/02/18 sWATSAFE(R%) = WATSAFE(R%)\r'mti 2022/08/17 start\r'mti 2022/10/20 start 'watsafefwdsw\r'If watsafenewsw = 1 Then 'new 5 category model\rIf watsafenewsw = 1 And watsafefwdsw = 1 Then 'new 5 category model\r'mti 2022/10/20 end\rWATSAFEI(R%) = 100 - WATERHH(R%, Surface, National) - WATERHH(R%, Unimproved, National)\rElse\rWATSAFEI(R%) = 100 - WATSAFE(R%, 1)\rEnd If\r'mti 2022/08/17 End\rsCLPC(R%) = CLPC(R%, 4)\r\rEnd If\rNext R\r"
  },
  {
    "Variable": "MALNCHPSH",
    "UsesVariable": "watsafefwdsw",
    "Distance": 0,
    "Code": "\r\r'bbh 2010/10/20 end\r'mti WatSafe->MalnchpSH May 2006\r'   All Years 3:  Child malnutrition according to Smith and Haddad\r'   ------------------------------------------------------------\r'mti MalnchpSH revise June 2006 start\rDim lifeexprat As Single\rFor R% = 1 To NR%  'Targets on these indicators may increase\r'percentage of people with access to safewater\r'If RegName(R%) = \"India\" Then Stop\rIf IY% > 1 Then\rlifeexprat = LIFEXP(R%, Female) / AMAX(1, LIFEXP(R%, Male))\r'Kilocal = AMAX(500, CLAVAL(R%) / POP(R%))\r'jrs 2009/02/19 MALNCHPSH(R%) = malnchpi(R%) - 25.24 * _\r'(Log(CLPC(R%, 4)) - Log(sCLPC(R%))) - 71.76 * (lifeexprat - SLIFEXPRat(R%)) _\r'- 0.22 * (EDSECENRG(R%, Female) - SEdSecEnrGFem(R%)) - 0.08 * (WATSAFE(R%) - sWATSAFE(R%))\r\r'mti 2022/08/17 start\r'mti 2022/10/20 start 'watsafefwdsw\r'If watsafenewsw = 1 Then 'new 5 category model\rIf watsafenewsw = 1 And watsafefwdsw = 1 Then 'new 5 category model\r'mti 2022/10/20 end\r\rDim WaterUnSafe = WATERHH(R%, Surface, National) + WATERHH(R%, Unimproved, National)\rMALNCHPSH(R%) = CSng(malnchpi(R%) - 25.24 *\r                        (Log(CLPC(R%, 4)) - Log(sCLPC(R%))) - 71.76 * (lifeexprat - SLIFEXPRat(R%)) _\r                        - 0.22 * (EDSECENRG(R%, Female) - SEdSecEnrGFem(R%)) - 0.08 * (100 - WaterUnSafe - WATSAFEI(R%)))\r\rElse\r\rMALNCHPSH(R%) = CSng(malnchpi(R%) - 25.24 *\r                        (Log(CLPC(R%, 4)) - Log(sCLPC(R%))) - 71.76 * (lifeexprat - SLIFEXPRat(R%)) _\r                        - 0.22 * (EDSECENRG(R%, Female) - SEdSecEnrGFem(R%)) - 0.08 * (100 - WATSAFE(R%, 1) - WATSAFEI(R%)))\r\rEnd If\r\r'mti 2022/08/17 End\r\r'            MALNCHPSH(R%) = 100 - 25.24 * Log(CLPC(R%, 4) - sCLPC(R%)) - 71.76 * (lifeexprat - SLIFEXPRat(R%)) _\r'- 0.22 * (EDSECENRG(R%, Female) - SEdSecEnrGFem(R%)) - 0.08 * (WATSAFE(R%) - SWATSAFE(R%))\rMALNCHPSH(R%) = AMAX(0, MALNCHPSH(R%))\rElse 'first year\rMALNCHPSH(R%) = MALNCHP(R%)\r'mti MalnchpSH Delta fix June 2006 -start\rSLIFEXPRat(R%) = LIFEXP(R%, Female) / AMAX(1, LIFEXP(R%, Male))\rSEdSecEnrGFem(R%) = EDSECENRG(R%, Female)\r'jrs 2009/02/18 sWATSAFE(R%) = WATSAFE(R%)\r'mti 2022/08/17 start\r'mti 2022/10/20 start 'watsafefwdsw\r'If watsafenewsw = 1 Then 'new 5 category model\rIf watsafenewsw = 1 And watsafefwdsw = 1 Then 'new 5 category model\r'mti 2022/10/20 end\rWATSAFEI(R%) = 100 - WATERHH(R%, Surface, National) - WATERHH(R%, Unimproved, National)\rElse\rWATSAFEI(R%) = 100 - WATSAFE(R%, 1)\rEnd If\r'mti 2022/08/17 End\rsCLPC(R%) = CLPC(R%, 4)\r\rEnd If\rNext R\r"
  },
  {
    "Variable": "MALNCHPSH",
    "UsesVariable": "LIFEXP",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "MALNCHPSH",
    "UsesVariable": "WATERHH",
    "Distance": 1,
    "Code": "\r\r'bbh 2010/10/20 end\r'mti WatSafe->MalnchpSH May 2006\r'   All Years 3:  Child malnutrition according to Smith and Haddad\r'   ------------------------------------------------------------\r'mti MalnchpSH revise June 2006 start\rDim lifeexprat As Single\rFor R% = 1 To NR%  'Targets on these indicators may increase\r'percentage of people with access to safewater\r'If RegName(R%) = \"India\" Then Stop\rIf IY% > 1 Then\rlifeexprat = LIFEXP(R%, Female) / AMAX(1, LIFEXP(R%, Male))\r'Kilocal = AMAX(500, CLAVAL(R%) / POP(R%))\r'jrs 2009/02/19 MALNCHPSH(R%) = malnchpi(R%) - 25.24 * _\r'(Log(CLPC(R%, 4)) - Log(sCLPC(R%))) - 71.76 * (lifeexprat - SLIFEXPRat(R%)) _\r'- 0.22 * (EDSECENRG(R%, Female) - SEdSecEnrGFem(R%)) - 0.08 * (WATSAFE(R%) - sWATSAFE(R%))\r\r'mti 2022/08/17 start\r'mti 2022/10/20 start 'watsafefwdsw\r'If watsafenewsw = 1 Then 'new 5 category model\rIf watsafenewsw = 1 And watsafefwdsw = 1 Then 'new 5 category model\r'mti 2022/10/20 end\r\rDim WaterUnSafe = WATERHH(R%, Surface, National) + WATERHH(R%, Unimproved, National)\rMALNCHPSH(R%) = CSng(malnchpi(R%) - 25.24 *\r                        (Log(CLPC(R%, 4)) - Log(sCLPC(R%))) - 71.76 * (lifeexprat - SLIFEXPRat(R%)) _\r                        - 0.22 * (EDSECENRG(R%, Female) - SEdSecEnrGFem(R%)) - 0.08 * (100 - WaterUnSafe - WATSAFEI(R%)))\r\rElse\r\rMALNCHPSH(R%) = CSng(malnchpi(R%) - 25.24 *\r                        (Log(CLPC(R%, 4)) - Log(sCLPC(R%))) - 71.76 * (lifeexprat - SLIFEXPRat(R%)) _\r                        - 0.22 * (EDSECENRG(R%, Female) - SEdSecEnrGFem(R%)) - 0.08 * (100 - WATSAFE(R%, 1) - WATSAFEI(R%)))\r\rEnd If\r\r'mti 2022/08/17 End\r\r'            MALNCHPSH(R%) = 100 - 25.24 * Log(CLPC(R%, 4) - sCLPC(R%)) - 71.76 * (lifeexprat - SLIFEXPRat(R%)) _\r'- 0.22 * (EDSECENRG(R%, Female) - SEdSecEnrGFem(R%)) - 0.08 * (WATSAFE(R%) - SWATSAFE(R%))\rMALNCHPSH(R%) = AMAX(0, MALNCHPSH(R%))\rElse 'first year\rMALNCHPSH(R%) = MALNCHP(R%)\r'mti MalnchpSH Delta fix June 2006 -start\rSLIFEXPRat(R%) = LIFEXP(R%, Female) / AMAX(1, LIFEXP(R%, Male))\rSEdSecEnrGFem(R%) = EDSECENRG(R%, Female)\r'jrs 2009/02/18 sWATSAFE(R%) = WATSAFE(R%)\r'mti 2022/08/17 start\r'mti 2022/10/20 start 'watsafefwdsw\r'If watsafenewsw = 1 Then 'new 5 category model\rIf watsafenewsw = 1 And watsafefwdsw = 1 Then 'new 5 category model\r'mti 2022/10/20 end\rWATSAFEI(R%) = 100 - WATERHH(R%, Surface, National) - WATERHH(R%, Unimproved, National)\rElse\rWATSAFEI(R%) = 100 - WATSAFE(R%, 1)\rEnd If\r'mti 2022/08/17 End\rsCLPC(R%) = CLPC(R%, 4)\r\rEnd If\rNext R\r"
  },
  {
    "Variable": "MALNPOPP",
    "UsesVariable": "CLPCCV",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "MALNPOPP",
    "UsesVariable": "CLPCMDER",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "MALNPOPP",
    "UsesVariable": "CLPC",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "MALNPOPP",
    "UsesVariable": "malnconv",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "MALNPOPP",
    "UsesVariable": "POP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "MALNPOPP",
    "UsesVariable": "MALNCHIL",
    "Distance": 2,
    "Code": "\r'mti 03/10/2011 - end\rElse\r'sgh 2016/01/06 - START\r'Use population equation rather than underweight children\r'            Call XYTABL(\"Calories per capita (2009) versus Malnourished Children (2011) LN\", _\r'                CLPC(R%, 4), malnpopcomp)\r'            Call XYTABL(\"Calories per capita (2009) versus Malnourished Children (2011) LN\", _\r'                CLPCi(R%), malnpopcompi)\r'This is just replacing equation with OLD undernourished population equation\r'            Call XYTABL(\"Calories per capita (2007) versus Malnourished Population Percent\", _\r'                CLPC(R%, 4), malnpopcomp)\r'            Call XYTABL(\"Calories per capita (2007) versus Malnourished Population Percent\", _\r'                CLPCi(R%), malnpopcompi)\r'This is the new (2015/01/08) undernourished vs. calories per capita per day equation\r'            Call XYTABL(\"MalnPop%WB(MOSTRECENT) (Linear) versus Calories per capita (total) (Log)\", _\r'                CLPC(R%, 4), malnpopcomp)\r'            Call XYTABL(\"MalnPop%WB(MOSTRECENT) (Linear) versus Calories per capita (total) (Log)\", _\r'                CLPCi(R%), malnpopcompi)\r'If RegName$(R%) = \"India\" Then Stop\r'jrs 2024/01/29 Call AnalFunc(\"MALNPOPP using HHINC and CLPC\", New Single() {CLPC(R%, 4), HHINC(R%, 1) / labsups(R%)},\rCall AnalFunc(\"MALNPOPP using HHINC and CLPC\", New Single() {CLPC(R%, 4), HHINCDIS(R%, 1) / labsups(R%)},\r                        malnpopcomp, New String() {\"CLCP (log)\", \"HHINC (unskilled) / LABSUP (unskilled)\"}, context)\r"
  },
  {
    "Variable": "MALNPOPP",
    "UsesVariable": "HHINCDIS",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "MALNPOPP",
    "UsesVariable": "MALNCHP",
    "Distance": 0,
    "Code": "\rIf MALNPOPP(R%) < 0.001 AndAlso MALNCHP(R%) > 0.01 Then\rMALNPOPP(R%) = CSng(0.1 * MALNCHP(R%))\rEnd If\r"
  },
  {
    "Variable": "MARMS",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MARMS",
    "UsesVariable": "marmsadd",
    "Distance": 0,
    "Code": "\riMARMSTOGDP(R%) = MARMS(R%) / GDP(R%)\r\r"
  },
  {
    "Variable": "MARMS",
    "UsesVariable": "marmsm",
    "Distance": 0,
    "Code": "\riMARMSTOGDP(R%) = MARMS(R%) / GDP(R%)\r\r"
  },
  {
    "Variable": "MARMS",
    "UsesVariable": "GDS",
    "Distance": 0,
    "Code": "\riMARMSTOGDP(R%) = MARMS(R%) / GDP(R%)\r\r"
  },
  {
    "Variable": "MARMS",
    "UsesVariable": "armsimmaxpctmilexp",
    "Distance": 0,
    "Code": "\riMARMSTOGDP(R%) = MARMS(R%) / GDP(R%)\r\r"
  },
  {
    "Variable": "MARRIEDFEMPOP",
    "UsesVariable": "MARRIEDFEMSHR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MARRIEDFEMPOP",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MATMORTRATIO",
    "UsesVariable": "GDPPCP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MATMORTRATIO",
    "UsesVariable": "matmortratiom",
    "Distance": 0,
    "Code": "\r'jrs 2019/06/04\rMATMORTRATIO(R%) = MATMORTRATIO(R%) * matmortratiom(R%)\r\rIf MATMORTRATIO(R%) > 40 Or MATMORTRATIO(R%) > 80 Then MatMortTimePar = CSng(0.97 - 0.04 * (MATMORTRATIO(R%) - 40) / 40)\r\rIf IY% > 1 Then\rMATMORTRATIO(R%) = AMAX(MATMORTRATIO(R%), sMATMORTRATIO(R%) * MatMortTimePar)\rEnd If\r"
  },
  {
    "Variable": "MATMORTRATIO",
    "UsesVariable": "TFR",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "MATPOSTR",
    "UsesVariable": "matpostradd",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MATPOSTR",
    "UsesVariable": "mprconv",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "MATPOSTR",
    "UsesVariable": "cultshmp",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "MATPOSTR",
    "UsesVariable": "CULTREG",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "MATPOSTR",
    "UsesVariable": "GDPPCP",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "MFPBAS",
    "UsesVariable": "VADD",
    "Distance": 426,
    "Code": "0"
  },
  {
    "Variable": "MFPBAS",
    "UsesVariable": "MFPRATE",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MFPCOR",
    "UsesVariable": "VADD",
    "Distance": 427,
    "Code": "0"
  },
  {
    "Variable": "MFPCOR",
    "UsesVariable": "mfpconv",
    "Distance": 17,
    "Code": "\rIf CorrectReduced > 0 And MFPCorSI(R%, S%) < 0 Then CorrectReduced = 0\r\r'If RegName$(R%) = \"Bangladesh\" And IY% >= 4 Then Stop\rFor S% = 1 To NSec%\rsVADD(R%, S%) = VADD(R%, S%)\rSmVadd(R%, S%) = CSng(SmVadd(R%, S%) * 0.8 + VADD(R%, S%) * 0.2)\r'If RegName$(R%) = \"Ukraine\" And S% = 2 Then Stop\rNext S%\r\r'bbh 2021/04/12 end\r'If S = 5 And GRPS(1, R) = \"Eritrea\" And (IY% = 20) Then Stop  'bbh 2023/12/12\rIf MFPCorSI(R%, S%) < 0 Then\r'correctionterm = ConvergeOverTime(MFPCorS(R%, S%), 0, mfpconv(R%) * 0.2)\r'correctionterm = ConvergeOverTime(MFPCorSI(R%, S%), 0, mfpconv(R%)) 'bbh 2023/12/28 commented out\r'correctionterm = ConvergeOverTime(CorrectReduced, 0, mfpconv(R%))\r'Base, Target, Years\rIf CorrectReduced < -0.01 Then 'bbh 2023/12/28 If-then added to replace line above and converge high MFPCORS values faster when above 1%\rcorrectionterm = ConvergeOverTime(CorrectReduced, 0, mfpconv(R%) / CSng((-CorrectReduced * 100) ^ 0.5))\rElse\rcorrectionterm = ConvergeOverTime(CorrectReduced, 0, mfpconv(R%))\rEnd If\rElse\r'correctionterm = ConvergeOverTime(MFPCorSI(R%, S%), 0, mfpconvadj)\r'correctionterm = ConvergeOverTime(CorrectReduced, 0, mfpconv(R%)) 'bbh 2023/12/28 commented out\rIf CorrectReduced > 0.01 Then 'bbh 2023/12/28 If-then added to replace line above and converge high MFPCORS values faster when above 1%\rcorrectionterm = ConvergeOverTime(CorrectReduced, 0, mfpconv(R%) / CSng((CorrectReduced * 100) ^ 0.5))\rElse\rcorrectionterm = ConvergeOverTime(CorrectReduced, 0, mfpconv(R%))\rEnd If\r'If CorrectReduced > 0.01 Then correctionterm = ConvergeOverTime(CorrectReduced, 0, mfpconv(R%) / ((CorrectReduced ^ 0.5) * 100))\r'bbh 2023/12/28 Above line added: Large positive corrections suggest overly large initial adjustments that should be phased out\r'Base, Target, Years\rEnd If\r\r'mti October 03, 2011 - end\r\rMFPCOR(R%) = MFPCOR(R%) + correctionterm * 100 * SmVadd(R%, S%)\r\r\r'dsr 2016/05/04 Set bGDPPCPExogenous = False, otherwise get run-to-run like error\rbGDPPCPExogenous = False\r"
  },
  {
    "Variable": "MFPCOR",
    "UsesVariable": "MFPCORS",
    "Distance": 1083,
    "Code": "0"
  },
  {
    "Variable": "MFPCOR",
    "UsesVariable": "igdpr",
    "Distance": 2106,
    "Code": "0"
  },
  {
    "Variable": "MFPCOR",
    "UsesVariable": "GDP",
    "Distance": 2109,
    "Code": "\rIf (agon > 0.9) Then 'Only agriculture because ENPRR normalized to IGDPR in Energy\rIf GDPPC(R%) < 5 Then\r'sectorgr(R%, 1) = AMAX(0.5 * igdpr(R%), TGRYL(R%) * 2)\rsectorgr(R%, 1) = AMAX(0.5 * IGDPRCor(R%), TGRYL(R%) * 2)\r'Poorer countries also have land growth, etc.\rElse\rsectorgr(R%, 1) = TGRYL(R%)\rEnd If\rSVADDGR = VADD(R%, Agri) * sectorgr(R%, 1)\rNonPrimVadd = 0\rFor S% = 2 To NSec%\rNonPrimVadd = NonPrimVadd + VADD(R%, S%)\rNext S%\r'bbh 2020/03/26 start\rSectorGrAgAdj(R%) = (GDP(R%) * IGDPRCor(R%) - SVADDGR) / NonPrimVadd\rFor S% = 2 To NSec%\rsectorgr(R%, S%) = SectorGrAgAdj(R%)\r'sectorgr(R%, S%) = AMAX(sectorgr(R%, S%), (POPR(R%) + migrater(R%)) / 100 + 0.005)\rsectorgr(R%, S%) = AMAX(sectorgr(R%, S%), POPR(R%) / 100 + minpcgr(R%)) 'jrs 2021/08/16\rNext S%\rSectorGrAgAdj(R%) = SectorGrAgAdj(R%) - IGDPRCor(R%)\r'bbh 2020/03/26 end\rElse\rFor S% = 1 To NSec%\rsectorgr(R%, S%) = IGDPRCor(R%)\r'sectorgr(R%, S%) = AMAX(sectorgr(R%, S%), (POPR(R%) + migrater(R%)) / 100 + 0.005)\rsectorgr(R%, S%) = AMAX(sectorgr(R%, S%), POPR(R%) / 100 + minpcgr(R%))  'jrs 2021/08/16\rNext S%\rEnd If\r"
  },
  {
    "Variable": "MFPCOR",
    "UsesVariable": "TGRYL",
    "Distance": 2113,
    "Code": "\rIf (agon > 0.9) Then 'Only agriculture because ENPRR normalized to IGDPR in Energy\rIf GDPPC(R%) < 5 Then\r'sectorgr(R%, 1) = AMAX(0.5 * igdpr(R%), TGRYL(R%) * 2)\rsectorgr(R%, 1) = AMAX(0.5 * IGDPRCor(R%), TGRYL(R%) * 2)\r'Poorer countries also have land growth, etc.\rElse\rsectorgr(R%, 1) = TGRYL(R%)\rEnd If\rSVADDGR = VADD(R%, Agri) * sectorgr(R%, 1)\rNonPrimVadd = 0\rFor S% = 2 To NSec%\rNonPrimVadd = NonPrimVadd + VADD(R%, S%)\rNext S%\r'bbh 2020/03/26 start\rSectorGrAgAdj(R%) = (GDP(R%) * IGDPRCor(R%) - SVADDGR) / NonPrimVadd\rFor S% = 2 To NSec%\rsectorgr(R%, S%) = SectorGrAgAdj(R%)\r'sectorgr(R%, S%) = AMAX(sectorgr(R%, S%), (POPR(R%) + migrater(R%)) / 100 + 0.005)\rsectorgr(R%, S%) = AMAX(sectorgr(R%, S%), POPR(R%) / 100 + minpcgr(R%)) 'jrs 2021/08/16\rNext S%\rSectorGrAgAdj(R%) = SectorGrAgAdj(R%) - IGDPRCor(R%)\r'bbh 2020/03/26 end\rElse\rFor S% = 1 To NSec%\rsectorgr(R%, S%) = IGDPRCor(R%)\r'sectorgr(R%, S%) = AMAX(sectorgr(R%, S%), (POPR(R%) + migrater(R%)) / 100 + 0.005)\rsectorgr(R%, S%) = AMAX(sectorgr(R%, S%), POPR(R%) / 100 + minpcgr(R%))  'jrs 2021/08/16\rNext S%\rEnd If\r"
  },
  {
    "Variable": "MFPCOR",
    "UsesVariable": "GDPPC",
    "Distance": 2113,
    "Code": "\rIf (agon > 0.9) Then 'Only agriculture because ENPRR normalized to IGDPR in Energy\rIf GDPPC(R%) < 5 Then\r'sectorgr(R%, 1) = AMAX(0.5 * igdpr(R%), TGRYL(R%) * 2)\rsectorgr(R%, 1) = AMAX(0.5 * IGDPRCor(R%), TGRYL(R%) * 2)\r'Poorer countries also have land growth, etc.\rElse\rsectorgr(R%, 1) = TGRYL(R%)\rEnd If\rSVADDGR = VADD(R%, Agri) * sectorgr(R%, 1)\rNonPrimVadd = 0\rFor S% = 2 To NSec%\rNonPrimVadd = NonPrimVadd + VADD(R%, S%)\rNext S%\r'bbh 2020/03/26 start\rSectorGrAgAdj(R%) = (GDP(R%) * IGDPRCor(R%) - SVADDGR) / NonPrimVadd\rFor S% = 2 To NSec%\rsectorgr(R%, S%) = SectorGrAgAdj(R%)\r'sectorgr(R%, S%) = AMAX(sectorgr(R%, S%), (POPR(R%) + migrater(R%)) / 100 + 0.005)\rsectorgr(R%, S%) = AMAX(sectorgr(R%, S%), POPR(R%) / 100 + minpcgr(R%)) 'jrs 2021/08/16\rNext S%\rSectorGrAgAdj(R%) = SectorGrAgAdj(R%) - IGDPRCor(R%)\r'bbh 2020/03/26 end\rElse\rFor S% = 1 To NSec%\rsectorgr(R%, S%) = IGDPRCor(R%)\r'sectorgr(R%, S%) = AMAX(sectorgr(R%, S%), (POPR(R%) + migrater(R%)) / 100 + 0.005)\rsectorgr(R%, S%) = AMAX(sectorgr(R%, S%), POPR(R%) / 100 + minpcgr(R%))  'jrs 2021/08/16\rNext S%\rEnd If\r"
  },
  {
    "Variable": "MFPCORS",
    "UsesVariable": "VADD",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "MFPCORS",
    "UsesVariable": "GDP",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "MFPCORS",
    "UsesVariable": "igdpr",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "MFPCORS",
    "UsesVariable": "ZS",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "MFPCORS",
    "UsesVariable": "mfpconv",
    "Distance": 1,
    "Code": "\rIf CorrectReduced > 0 And MFPCorSI(R%, S%) < 0 Then CorrectReduced = 0\r\r'bbh 2021/04/12 end\r'If S = 5 And GRPS(1, R) = \"Eritrea\" And (IY% = 20) Then Stop  'bbh 2023/12/12\rIf MFPCorSI(R%, S%) < 0 Then\r'correctionterm = ConvergeOverTime(MFPCorS(R%, S%), 0, mfpconv(R%) * 0.2)\r'correctionterm = ConvergeOverTime(MFPCorSI(R%, S%), 0, mfpconv(R%)) 'bbh 2023/12/28 commented out\r'correctionterm = ConvergeOverTime(CorrectReduced, 0, mfpconv(R%))\r'Base, Target, Years\rIf CorrectReduced < -0.01 Then 'bbh 2023/12/28 If-then added to replace line above and converge high MFPCORS values faster when above 1%\rcorrectionterm = ConvergeOverTime(CorrectReduced, 0, mfpconv(R%) / CSng((-CorrectReduced * 100) ^ 0.5))\rElse\rcorrectionterm = ConvergeOverTime(CorrectReduced, 0, mfpconv(R%))\rEnd If\rElse\r'correctionterm = ConvergeOverTime(MFPCorSI(R%, S%), 0, mfpconvadj)\r'correctionterm = ConvergeOverTime(CorrectReduced, 0, mfpconv(R%)) 'bbh 2023/12/28 commented out\rIf CorrectReduced > 0.01 Then 'bbh 2023/12/28 If-then added to replace line above and converge high MFPCORS values faster when above 1%\rcorrectionterm = ConvergeOverTime(CorrectReduced, 0, mfpconv(R%) / CSng((CorrectReduced * 100) ^ 0.5))\rElse\rcorrectionterm = ConvergeOverTime(CorrectReduced, 0, mfpconv(R%))\rEnd If\r'If CorrectReduced > 0.01 Then correctionterm = ConvergeOverTime(CorrectReduced, 0, mfpconv(R%) / ((CorrectReduced ^ 0.5) * 100))\r'bbh 2023/12/28 Above line added: Large positive corrections suggest overly large initial adjustments that should be phased out\r'Base, Target, Years\rEnd If\r\r'bbh 2020/03/26 end of main changes\r'If S = 5 And GRPS(1, R) = \"Eritrea\" And (IY% = 20) Then Stop  'bbh 2023/12/121\r'correctionterm = 0 'bbh 2023/12/06 test\r'CorrectIncreaseFromEn = 0 'bbh 2023/12/06 test\r\rMFPCORS(R%, S%) = correctionterm * 100\r"
  },
  {
    "Variable": "MFPCORS",
    "UsesVariable": "TGRYL",
    "Distance": 2097,
    "Code": "\rIf (agon > 0.9) Then 'Only agriculture because ENPRR normalized to IGDPR in Energy\rIf GDPPC(R%) < 5 Then\r'sectorgr(R%, 1) = AMAX(0.5 * igdpr(R%), TGRYL(R%) * 2)\rsectorgr(R%, 1) = AMAX(0.5 * IGDPRCor(R%), TGRYL(R%) * 2)\r'Poorer countries also have land growth, etc.\rElse\rsectorgr(R%, 1) = TGRYL(R%)\rEnd If\rSVADDGR = VADD(R%, Agri) * sectorgr(R%, 1)\rNonPrimVadd = 0\rFor S% = 2 To NSec%\rNonPrimVadd = NonPrimVadd + VADD(R%, S%)\rNext S%\r'bbh 2020/03/26 start\rSectorGrAgAdj(R%) = (GDP(R%) * IGDPRCor(R%) - SVADDGR) / NonPrimVadd\rFor S% = 2 To NSec%\rsectorgr(R%, S%) = SectorGrAgAdj(R%)\r'sectorgr(R%, S%) = AMAX(sectorgr(R%, S%), (POPR(R%) + migrater(R%)) / 100 + 0.005)\rsectorgr(R%, S%) = AMAX(sectorgr(R%, S%), POPR(R%) / 100 + minpcgr(R%)) 'jrs 2021/08/16\rNext S%\rSectorGrAgAdj(R%) = SectorGrAgAdj(R%) - IGDPRCor(R%)\r'bbh 2020/03/26 end\rElse\rFor S% = 1 To NSec%\rsectorgr(R%, S%) = IGDPRCor(R%)\r'sectorgr(R%, S%) = AMAX(sectorgr(R%, S%), (POPR(R%) + migrater(R%)) / 100 + 0.005)\rsectorgr(R%, S%) = AMAX(sectorgr(R%, S%), POPR(R%) / 100 + minpcgr(R%))  'jrs 2021/08/16\rNext S%\rEnd If\r"
  },
  {
    "Variable": "MFPCORS",
    "UsesVariable": "GDPPC",
    "Distance": 2097,
    "Code": "\rIf (agon > 0.9) Then 'Only agriculture because ENPRR normalized to IGDPR in Energy\rIf GDPPC(R%) < 5 Then\r'sectorgr(R%, 1) = AMAX(0.5 * igdpr(R%), TGRYL(R%) * 2)\rsectorgr(R%, 1) = AMAX(0.5 * IGDPRCor(R%), TGRYL(R%) * 2)\r'Poorer countries also have land growth, etc.\rElse\rsectorgr(R%, 1) = TGRYL(R%)\rEnd If\rSVADDGR = VADD(R%, Agri) * sectorgr(R%, 1)\rNonPrimVadd = 0\rFor S% = 2 To NSec%\rNonPrimVadd = NonPrimVadd + VADD(R%, S%)\rNext S%\r'bbh 2020/03/26 start\rSectorGrAgAdj(R%) = (GDP(R%) * IGDPRCor(R%) - SVADDGR) / NonPrimVadd\rFor S% = 2 To NSec%\rsectorgr(R%, S%) = SectorGrAgAdj(R%)\r'sectorgr(R%, S%) = AMAX(sectorgr(R%, S%), (POPR(R%) + migrater(R%)) / 100 + 0.005)\rsectorgr(R%, S%) = AMAX(sectorgr(R%, S%), POPR(R%) / 100 + minpcgr(R%)) 'jrs 2021/08/16\rNext S%\rSectorGrAgAdj(R%) = SectorGrAgAdj(R%) - IGDPRCor(R%)\r'bbh 2020/03/26 end\rElse\rFor S% = 1 To NSec%\rsectorgr(R%, S%) = IGDPRCor(R%)\r'sectorgr(R%, S%) = AMAX(sectorgr(R%, S%), (POPR(R%) + migrater(R%)) / 100 + 0.005)\rsectorgr(R%, S%) = AMAX(sectorgr(R%, S%), POPR(R%) / 100 + minpcgr(R%))  'jrs 2021/08/16\rNext S%\rEnd If\r"
  },
  {
    "Variable": "MFPCORS",
    "UsesVariable": "MFPGROWTH",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MFPCORS",
    "UsesVariable": "MFPRATE",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MFPCORS",
    "UsesVariable": "MFPHC",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MFPCORS",
    "UsesVariable": "MFPSC",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MFPCORS",
    "UsesVariable": "MFPPC",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MFPCORS",
    "UsesVariable": "MFPKN",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MFPGLOCOR",
    "UsesVariable": "VADD",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "MFPGLOCOR",
    "UsesVariable": "MFPCORS",
    "Distance": 0,
    "Code": "\r'glocorrect = glocorrect / AMAX(0.001, GloGDP)\r\rFor R% = 1 To NR%\r'bbh 2021/05/15 techpremium = PremTechComp(R%) / 100\rMFPPREMIUM(R%) = PremTechComp(R%) / 100\r\r'If (GRPS(1, R) = \"Eritrea\") Then Stop  'bbh 2023/12/12\r'MFPPREMIUM(R%) = 0 'bbh 2023/12/05 test\r\rFor S% = 1 To NSec%\rMFPRATE(R%, S%) = MFPRATE(R%, S%) + MFPPREMIUM(R%) 'techpremium 'bbh 2021/05/15\r'bbh 2021/05/15 MFPCORS(R%, S%) = MFPGro(R%, S%) - MFPRATE(R%, S%) _\r'- (MFPHC(R%) + MFPSC(R%) + MFPPC(R%) + MFPKN(R%)) / 100\rMFPCORS(R%, S%) = MFPGROWTH(R%, S%) - MFPRATE(R%, S%) _\r                   - (MFPHC(R%) + MFPSC(R%) + MFPPC(R%) + MFPKN(R%)) / 100\r\r'bbh 2021/05/15 glocorrect = glocorrect + MFPCORS(R%, S%) * VADD(R%, S%)\rMFPGLOCOR = MFPGLOCOR + MFPCORS(R%, S%) * VADD(R%, S%)\r\rGloGDP = GloGDP + VADD(R%, S%)\r'Base for bringing regional MFP growth to predicted over time\rNext S%\rNext R%\r"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "MFPRATE",
    "Distance": 0,
    "Code": "\r\r'jrs 2014/08/13 *** end ***\r\r'Note: value of mfpconv(R%) makes great difference in behavior for many countries\r' e.g. China has growth far above basic mfp rates and low mfpconv(R%)\r'       brings it down fast\r' e.g. Czech Rep has growth well below basic mfp so low mfpconv(R%)\r'       brings it up fast\r'Most countries with negative MFPCorS are transition economies and\r'       should recover fairly fast\r'bbh 2020/12/23 Start:  use of correction term when growth is exogenous changes behavior with igdpr; don't\r'            If gdprext(R%) > -50 Then\r'bbh 2021/05/15 start MFPGROWTH for MFPGro\r\rMFPGROWTH(R%, S%) = MFPRATE(R%, S%) + MFPKN(R%) / 100 + qualityterms _\r                    + correctionterm + CorrectIncreaseFromEn 'bbh 2023/07/22\r\r'If S = 5 And GRPS(1, R) = \"Ethiopia\" And (IY% = 10 Or IY% = 31) Then Stop  'bbh 2023/12/121\r'bbh 2023/07/22 End addition of correction for energy sector growth differential\r'            Else\r'                MFPGro(R%, S%) = MFPRATE(R%, S%) + MFPKN(R%) / 100 + qualityterms\r'            End If\r'bbh 2020/12/23 end\rMFPGROWTH(R%, S%) = CSng(AMAX(-0.3, Amin(0.3, MFPGROWTH(R%, S%))))\r"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "MFPKN",
    "Distance": 0,
    "Code": "\r\r'jrs 2014/08/13 *** end ***\r\r'Note: value of mfpconv(R%) makes great difference in behavior for many countries\r' e.g. China has growth far above basic mfp rates and low mfpconv(R%)\r'       brings it down fast\r' e.g. Czech Rep has growth well below basic mfp so low mfpconv(R%)\r'       brings it up fast\r'Most countries with negative MFPCorS are transition economies and\r'       should recover fairly fast\r'bbh 2020/12/23 Start:  use of correction term when growth is exogenous changes behavior with igdpr; don't\r'            If gdprext(R%) > -50 Then\r'bbh 2021/05/15 start MFPGROWTH for MFPGro\r\rMFPGROWTH(R%, S%) = MFPRATE(R%, S%) + MFPKN(R%) / 100 + qualityterms _\r                    + correctionterm + CorrectIncreaseFromEn 'bbh 2023/07/22\r"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "MFPHC",
    "Distance": 13,
    "Code": "\rIf IY% >= 3 Then\rCorrectIncreaseFromEn = sVADD(R%, Ener) / AMAX(0.01, SGDP(R%)) * (igdprcor(R%) - (szs(R%, Ener) - sszs(R%, Ener)) / AMAX(0.0001, sszs(R%, Ener)))\rEnd If\r\r'bbh 2021/04/12 end\r'If S = 5 And GRPS(1, R) = \"Eritrea\" And (IY% = 20) Then Stop  'bbh 2023/12/12\rIf MFPCorSI(R%, S%) < 0 Then\r'correctionterm = ConvergeOverTime(MFPCorS(R%, S%), 0, mfpconv(R%) * 0.2)\r'correctionterm = ConvergeOverTime(MFPCorSI(R%, S%), 0, mfpconv(R%)) 'bbh 2023/12/28 commented out\r'correctionterm = ConvergeOverTime(CorrectReduced, 0, mfpconv(R%))\r'Base, Target, Years\rIf CorrectReduced < -0.01 Then 'bbh 2023/12/28 If-then added to replace line above and converge high MFPCORS values faster when above 1%\rcorrectionterm = ConvergeOverTime(CorrectReduced, 0, mfpconv(R%) / CSng((-CorrectReduced * 100) ^ 0.5))\rElse\rcorrectionterm = ConvergeOverTime(CorrectReduced, 0, mfpconv(R%))\rEnd If\rElse\r'correctionterm = ConvergeOverTime(MFPCorSI(R%, S%), 0, mfpconvadj)\r'correctionterm = ConvergeOverTime(CorrectReduced, 0, mfpconv(R%)) 'bbh 2023/12/28 commented out\rIf CorrectReduced > 0.01 Then 'bbh 2023/12/28 If-then added to replace line above and converge high MFPCORS values faster when above 1%\rcorrectionterm = ConvergeOverTime(CorrectReduced, 0, mfpconv(R%) / CSng((CorrectReduced * 100) ^ 0.5))\rElse\rcorrectionterm = ConvergeOverTime(CorrectReduced, 0, mfpconv(R%))\rEnd If\r'If CorrectReduced > 0.01 Then correctionterm = ConvergeOverTime(CorrectReduced, 0, mfpconv(R%) / ((CorrectReduced ^ 0.5) * 100))\r'bbh 2023/12/28 Above line added: Large positive corrections suggest overly large initial adjustments that should be phased out\r'Base, Target, Years\rEnd If\rCOMPLETE STRUCTURE:Next S%:6198|\r'CorrectIncreaseFromEn = 0\rFor S% = 1 To NSec%\rqualityterms = (MFPHC(R%) + MFPSC(R%) + MFPPC(R%)) / 100\r"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "MFPSC",
    "Distance": 13,
    "Code": "\rIf IY% >= 3 Then\rCorrectIncreaseFromEn = sVADD(R%, Ener) / AMAX(0.01, SGDP(R%)) * (igdprcor(R%) - (szs(R%, Ener) - sszs(R%, Ener)) / AMAX(0.0001, sszs(R%, Ener)))\rEnd If\r"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "MFPPC",
    "Distance": 13,
    "Code": "\rIf IY% >= 3 Then\rCorrectIncreaseFromEn = sVADD(R%, Ener) / AMAX(0.01, SGDP(R%)) * (igdprcor(R%) - (szs(R%, Ener) - sszs(R%, Ener)) / AMAX(0.0001, sszs(R%, Ener)))\rEnd If\r"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "mfpconv",
    "Distance": 3,
    "Code": "\rIf CorrectReduced > 0 And MFPCorSI(R%, S%) < 0 Then CorrectReduced = 0\r"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "VADD",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "GDP",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "igdpr",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "ZS",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "MFPCORS",
    "Distance": 1069,
    "Code": "0"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "TGRYL",
    "Distance": 2099,
    "Code": "\rIf (agon > 0.9) Then 'Only agriculture because ENPRR normalized to IGDPR in Energy\rIf GDPPC(R%) < 5 Then\r'sectorgr(R%, 1) = AMAX(0.5 * igdpr(R%), TGRYL(R%) * 2)\rsectorgr(R%, 1) = AMAX(0.5 * IGDPRCor(R%), TGRYL(R%) * 2)\r'Poorer countries also have land growth, etc.\rElse\rsectorgr(R%, 1) = TGRYL(R%)\rEnd If\rSVADDGR = VADD(R%, Agri) * sectorgr(R%, 1)\rNonPrimVadd = 0\rFor S% = 2 To NSec%\rNonPrimVadd = NonPrimVadd + VADD(R%, S%)\rNext S%\r'bbh 2020/03/26 start\rSectorGrAgAdj(R%) = (GDP(R%) * IGDPRCor(R%) - SVADDGR) / NonPrimVadd\rFor S% = 2 To NSec%\rsectorgr(R%, S%) = SectorGrAgAdj(R%)\r'sectorgr(R%, S%) = AMAX(sectorgr(R%, S%), (POPR(R%) + migrater(R%)) / 100 + 0.005)\rsectorgr(R%, S%) = AMAX(sectorgr(R%, S%), POPR(R%) / 100 + minpcgr(R%)) 'jrs 2021/08/16\rNext S%\rSectorGrAgAdj(R%) = SectorGrAgAdj(R%) - IGDPRCor(R%)\r'bbh 2020/03/26 end\rElse\rFor S% = 1 To NSec%\rsectorgr(R%, S%) = IGDPRCor(R%)\r'sectorgr(R%, S%) = AMAX(sectorgr(R%, S%), (POPR(R%) + migrater(R%)) / 100 + 0.005)\rsectorgr(R%, S%) = AMAX(sectorgr(R%, S%), POPR(R%) / 100 + minpcgr(R%))  'jrs 2021/08/16\rNext S%\rEnd If\r"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "GDPPC",
    "Distance": 2099,
    "Code": "\rIf (agon > 0.9) Then 'Only agriculture because ENPRR normalized to IGDPR in Energy\rIf GDPPC(R%) < 5 Then\r'sectorgr(R%, 1) = AMAX(0.5 * igdpr(R%), TGRYL(R%) * 2)\rsectorgr(R%, 1) = AMAX(0.5 * IGDPRCor(R%), TGRYL(R%) * 2)\r'Poorer countries also have land growth, etc.\rElse\rsectorgr(R%, 1) = TGRYL(R%)\rEnd If\rSVADDGR = VADD(R%, Agri) * sectorgr(R%, 1)\rNonPrimVadd = 0\rFor S% = 2 To NSec%\rNonPrimVadd = NonPrimVadd + VADD(R%, S%)\rNext S%\r'bbh 2020/03/26 start\rSectorGrAgAdj(R%) = (GDP(R%) * IGDPRCor(R%) - SVADDGR) / NonPrimVadd\rFor S% = 2 To NSec%\rsectorgr(R%, S%) = SectorGrAgAdj(R%)\r'sectorgr(R%, S%) = AMAX(sectorgr(R%, S%), (POPR(R%) + migrater(R%)) / 100 + 0.005)\rsectorgr(R%, S%) = AMAX(sectorgr(R%, S%), POPR(R%) / 100 + minpcgr(R%)) 'jrs 2021/08/16\rNext S%\rSectorGrAgAdj(R%) = SectorGrAgAdj(R%) - IGDPRCor(R%)\r'bbh 2020/03/26 end\rElse\rFor S% = 1 To NSec%\rsectorgr(R%, S%) = IGDPRCor(R%)\r'sectorgr(R%, S%) = AMAX(sectorgr(R%, S%), (POPR(R%) + migrater(R%)) / 100 + 0.005)\rsectorgr(R%, S%) = AMAX(sectorgr(R%, S%), POPR(R%) / 100 + minpcgr(R%))  'jrs 2021/08/16\rNext S%\rEnd If\r"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "KS",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "LABS",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "GDPPCP",
    "Distance": 29,
    "Code": "0"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "POPR",
    "Distance": 1002,
    "Code": "0"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "minpcgr",
    "Distance": 1002,
    "Code": "\rIf (agon > 0.9) Then 'Only agriculture because ENPRR normalized to IGDPR in Energy\rIf GDPPC(R%) < 5 Then\r'sectorgr(R%, 1) = AMAX(0.5 * igdpr(R%), TGRYL(R%) * 2)\rsectorgr(R%, 1) = AMAX(0.5 * IGDPRCor(R%), TGRYL(R%) * 2)\r'Poorer countries also have land growth, etc.\rElse\rsectorgr(R%, 1) = TGRYL(R%)\rEnd If\rSVADDGR = VADD(R%, Agri) * sectorgr(R%, 1)\rNonPrimVadd = 0\rFor S% = 2 To NSec%\rNonPrimVadd = NonPrimVadd + VADD(R%, S%)\rNext S%\r'bbh 2020/03/26 start\rSectorGrAgAdj(R%) = (GDP(R%) * IGDPRCor(R%) - SVADDGR) / NonPrimVadd\rFor S% = 2 To NSec%\rsectorgr(R%, S%) = SectorGrAgAdj(R%)\r'sectorgr(R%, S%) = AMAX(sectorgr(R%, S%), (POPR(R%) + migrater(R%)) / 100 + 0.005)\rsectorgr(R%, S%) = AMAX(sectorgr(R%, S%), POPR(R%) / 100 + minpcgr(R%)) 'jrs 2021/08/16\rNext S%\rSectorGrAgAdj(R%) = SectorGrAgAdj(R%) - IGDPRCor(R%)\r'bbh 2020/03/26 end\rElse\rFor S% = 1 To NSec%\rsectorgr(R%, S%) = IGDPRCor(R%)\r'sectorgr(R%, S%) = AMAX(sectorgr(R%, S%), (POPR(R%) + migrater(R%)) / 100 + 0.005)\rsectorgr(R%, S%) = AMAX(sectorgr(R%, S%), POPR(R%) / 100 + minpcgr(R%))  'jrs 2021/08/16\rNext S%\rEnd If\r"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "lks",
    "Distance": 13,
    "Code": "\r'bbh 2019/09/08 end\r'If RegName$(R%) = \"Myanmar\" Then Stop\r\r'   First Year 2:  Compute Capital and Labor Growth Rates (repeated from 1st call)\r'   ------------------------------------------------------------------------------\rCall XYTABL(\"Investment Ratio Versus Capital Growth Rate\",\r                IGCF(R%) / GDP(R%), KGroComp, context)\rCOMPLETE STRUCTURE:Next S%:5098|\rFor S% = 1 To NSec%\rpalphas = pcdalf * salphas(R%, S%)\r"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "femshrgr",
    "Distance": 30,
    "Code": "0"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "IGCF",
    "Distance": 32,
    "Code": "\r\rFor S% = 1 To NSec%\ralphas(R%, S%) = SUM1 / Sum2 * salpha(S%)\ralphas(R%, S%) = AMAX(0, Amin(alphas(R%, S%), 1))\rsalphas(R%, S%) = alphas(R%, S%) / CDALF(R%)\rNext S%\r\r\r'pcdalf = AMAX(0.05, Amin(pcdalf / 100, 1))\r'pcdalflag = AMAX(0.05, Amin(pcdalflag / 100, 1))\rpcdalf = AMAX(0.2, Amin(pcdalf / 100, 1))\r"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "CDALF",
    "Distance": 1018,
    "Code": "0"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "FEMSHRLAB",
    "Distance": 1103,
    "Code": "0"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "GDPP",
    "Distance": 28,
    "Code": "0"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "POP",
    "Distance": 28,
    "Code": "0"
  },
  {
    "Variable": "MFPGROWTH",
    "UsesVariable": "salpha",
    "Distance": 1020,
    "Code": "0"
  },
  {
    "Variable": "MFPHC",
    "UsesVariable": "MFPSC",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "MFPHC",
    "UsesVariable": "MFPPC",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "MFPHC",
    "UsesVariable": "MFPKN",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "MFPHC",
    "UsesVariable": "EDQUALAG15",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MFPHC",
    "UsesVariable": "GDS",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "MFPHC",
    "UsesVariable": "igdpr",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "MFPHC",
    "UsesVariable": "mfpedspn",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "MFPHC",
    "UsesVariable": "EDYRSAG15",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "MFPHC",
    "UsesVariable": "mfpedyrs",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "MFPHC",
    "UsesVariable": "HLSTUNT",
    "Distance": 8,
    "Code": "\r'jrs 2013/11/28 Call XYTABL(\"GDP/Capita (PPP) Versus Years Of Educ at 15+ (2000)\", _\r'   GDPPCP(R%), yrsedcomp)\rCall XYTABL(\"GDP/Capita (PPP 2005) Versus Years of Educ at 15+ (2010) Log\",\r                    GDPPCP(R%), yrsedcomp, context)\r"
  },
  {
    "Variable": "MFPHC",
    "UsesVariable": "mfpstunt",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "MFPHC",
    "UsesVariable": "LIFEXP",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "MFPHC",
    "UsesVariable": "mfplife",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "MFPHC",
    "UsesVariable": "mfpedqual",
    "Distance": 686,
    "Code": "0"
  },
  {
    "Variable": "MFPHC",
    "UsesVariable": "GDP",
    "Distance": 26,
    "Code": "0"
  },
  {
    "Variable": "MFPHC",
    "UsesVariable": "GDPPCP",
    "Distance": 19,
    "Code": "0"
  },
  {
    "Variable": "MFPHC",
    "UsesVariable": "POPWORKING",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "MFPHC",
    "UsesVariable": "mfphlyld",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "MFPHC",
    "UsesVariable": "EDSECLOWRVOC",
    "Distance": 68,
    "Code": "0"
  },
  {
    "Variable": "MFPHC",
    "UsesVariable": "EDSECUPPRVOC",
    "Distance": 67,
    "Code": "0"
  },
  {
    "Variable": "MFPHC",
    "UsesVariable": "mfpedvoc",
    "Distance": 694,
    "Code": "0"
  },
  {
    "Variable": "MFPHC",
    "UsesVariable": "HLYLDWORK",
    "Distance": 75,
    "Code": "0"
  },
  {
    "Variable": "MFPHC",
    "UsesVariable": "HLSTUNTWORK",
    "Distance": 2,
    "Code": "\r'jrs 2013/11/28\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Years Of Educ at 15+ (2000)\", _\r'               GDPPCP(R%), yrsedcomp)\rCall XYTABL(\"GDP/Capita (PPP 2005) Versus Years of Educ at 15+ (2010) Log\",\r                    GDPPCP(R%), yrsedcomp, context)\r"
  },
  {
    "Variable": "MFPKN",
    "UsesVariable": "MFPHC",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "MFPKN",
    "UsesVariable": "MFPSC",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "MFPKN",
    "UsesVariable": "MFPPC",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "MFPKN",
    "UsesVariable": "EDTERGRSCIEN",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MFPKN",
    "UsesVariable": "RANDDEXP",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "MFPKN",
    "UsesVariable": "mfprandd",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "MFPKN",
    "UsesVariable": "mfpedscien",
    "Distance": 715,
    "Code": "\r\rPrivate Function EdTerSciContrib(R%, ByRef saveEdTerGrSciEn As Single, context As IForecastContext) As Single\r'jrs 2014/09/16\rDim EDTerGRSciEncomp As Single\r\r'mti 2014/03/27 - new proc\r\r'mfpedscien = 0.01\r\r'        If frm_MainMenu.IFsGUIctrl1.cHistoricBase = True Then\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Tertiary SciEngg Graduation Share (MostRecent)\", _\r'                Amin(50, GDPPCP(R%)), EDTerGRSciEncomp)\r'        Else\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Tertiary SciEngg Graduation Share (MostRecent)\", _\r'                Amin(50, GDPPCP(R%)), EDTerGRSciEncomp)\r'        End If\r\rIf context.HistoricMode = True Then\rCall XYTABL(\"GDP/Capita (PPP) Versus Tertiary SciEngg Graduation Rate Log (MostRecent)\",\r                    Amin(50, GDPPCP(R%)), EDTerGRSciEncomp, context)\rElse\rCall XYTABL(\"GDP/Capita (PPP) Versus Tertiary SciEngg Graduation Rate Log (MostRecent)\",\r                    Amin(50, GDPPCP(R%)), EDTerGRSciEncomp, context)\rEnd If\r\rEDTerGRSciEncomp = AMAX(0, EDTerGRSciEncomp)\r\r' If RegName(R%) = \"United States of America\" Then Stop\r\rIf IY% = 1 Then 'rate not share\rsaveEdTerGrSciEn = EDTERGRATE(R%, 3) * EDTERGRSCIEN(R%) / 100\rEnd If\r\rIf context.HistoricMode = True Then\rEdTerSciContrib = 0  '0 for now\rElse\rEdTerSciContrib = (saveEdTerGrSciEn - CSng(EDTerGRSciEncomp)) * mfpedscien\rEnd If\r\r'        saveEdTerGrSciEn = EDTERGRSCIEN(R%)\r\rEnd Function\r\r\rPrivate Function EdTerSciContrib(R%, ByRef saveEdTerGrSciEn As Single, context As IForecastContext) As Single\r'jrs 2014/09/16\rDim EDTerGRSciEncomp As Single\r\r'mti 2014/03/27 - new proc\r\r'mfpedscien = 0.01\r\r'        If frm_MainMenu.IFsGUIctrl1.cHistoricBase = True Then\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Tertiary SciEngg Graduation Share (MostRecent)\", _\r'                Amin(50, GDPPCP(R%)), EDTerGRSciEncomp)\r'        Else\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Tertiary SciEngg Graduation Share (MostRecent)\", _\r'                Amin(50, GDPPCP(R%)), EDTerGRSciEncomp)\r'        End If\r\rIf context.HistoricMode = True Then\rCall XYTABL(\"GDP/Capita (PPP) Versus Tertiary SciEngg Graduation Rate Log (MostRecent)\",\r                    Amin(50, GDPPCP(R%)), EDTerGRSciEncomp, context)\rElse\rCall XYTABL(\"GDP/Capita (PPP) Versus Tertiary SciEngg Graduation Rate Log (MostRecent)\",\r                    Amin(50, GDPPCP(R%)), EDTerGRSciEncomp, context)\rEnd If\r\rEDTerGRSciEncomp = AMAX(0, EDTerGRSciEncomp)\r\r' If RegName(R%) = \"United States of America\" Then Stop\r\rIf IY% = 1 Then 'rate not share\rsaveEdTerGrSciEn = EDTERGRATE(R%, 3) * EDTERGRSCIEN(R%) / 100\rEnd If\r\rIf context.HistoricMode = True Then\rEdTerSciContrib = 0  '0 for now\rElse\rEdTerSciContrib = (saveEdTerGrSciEn - CSng(EDTerGRSciEncomp)) * mfpedscien\rEnd If\r\r'        saveEdTerGrSciEn = EDTERGRSCIEN(R%)\r\rEnd Function\r\r\rPrivate Function EdTerSciContrib(R%, ByRef saveEdTerGrSciEn As Single, context As IForecastContext) As Single\r'jrs 2014/09/16\rDim EDTerGRSciEncomp As Single\r\r'mti 2014/03/27 - new proc\r\r'mfpedscien = 0.01\r\r'        If frm_MainMenu.IFsGUIctrl1.cHistoricBase = True Then\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Tertiary SciEngg Graduation Share (MostRecent)\", _\r'                Amin(50, GDPPCP(R%)), EDTerGRSciEncomp)\r'        Else\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Tertiary SciEngg Graduation Share (MostRecent)\", _\r'                Amin(50, GDPPCP(R%)), EDTerGRSciEncomp)\r'        End If\r\rIf context.HistoricMode = True Then\rCall XYTABL(\"GDP/Capita (PPP) Versus Tertiary SciEngg Graduation Rate Log (MostRecent)\",\r                    Amin(50, GDPPCP(R%)), EDTerGRSciEncomp, context)\rElse\rCall XYTABL(\"GDP/Capita (PPP) Versus Tertiary SciEngg Graduation Rate Log (MostRecent)\",\r                    Amin(50, GDPPCP(R%)), EDTerGRSciEncomp, context)\rEnd If\r\rEDTerGRSciEncomp = AMAX(0, EDTerGRSciEncomp)\r\r' If RegName(R%) = \"United States of America\" Then Stop\r\rIf IY% = 1 Then 'rate not share\rsaveEdTerGrSciEn = EDTERGRATE(R%, 3) * EDTERGRSCIEN(R%) / 100\rEnd If\r\rIf context.HistoricMode = True Then\rEdTerSciContrib = 0  '0 for now\rElse\rEdTerSciContrib = (saveEdTerGrSciEn - CSng(EDTerGRSciEncomp)) * mfpedscien\rEnd If\r\r'        saveEdTerGrSciEn = EDTERGRSCIEN(R%)\r\rEnd Function\r\r\rPrivate Function EdTerSciContrib(R%, ByRef saveEdTerGrSciEn As Single, context As IForecastContext) As Single\r'jrs 2014/09/16\rDim EDTerGRSciEncomp As Single\r\r'mti 2014/03/27 - new proc\r\r'mfpedscien = 0.01\r\r'        If frm_MainMenu.IFsGUIctrl1.cHistoricBase = True Then\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Tertiary SciEngg Graduation Share (MostRecent)\", _\r'                Amin(50, GDPPCP(R%)), EDTerGRSciEncomp)\r'        Else\r'            Call XYTABL(\"GDP/Capita (PPP) Versus Tertiary SciEngg Graduation Share (MostRecent)\", _\r'                Amin(50, GDPPCP(R%)), EDTerGRSciEncomp)\r'        End If\r\rIf context.HistoricMode = True Then\rCall XYTABL(\"GDP/Capita (PPP) Versus Tertiary SciEngg Graduation Rate Log (MostRecent)\",\r                    Amin(50, GDPPCP(R%)), EDTerGRSciEncomp, context)\rElse\rCall XYTABL(\"GDP/Capita (PPP) Versus Tertiary SciEngg Graduation Rate Log (MostRecent)\",\r                    Amin(50, GDPPCP(R%)), EDTerGRSciEncomp, context)\rEnd If\r\rEDTerGRSciEncomp = AMAX(0, EDTerGRSciEncomp)\r\r' If RegName(R%) = \"United States of America\" Then Stop\r\rIf IY% = 1 Then 'rate not share\rsaveEdTerGrSciEn = EDTERGRATE(R%, 3) * EDTERGRSCIEN(R%) / 100\rEnd If\r\rIf context.HistoricMode = True Then\rEdTerSciContrib = 0  '0 for now\rElse\rEdTerSciContrib = (saveEdTerGrSciEn - CSng(EDTerGRSciEncomp)) * mfpedscien\rEnd If\r\r'        saveEdTerGrSciEn = EDTERGRSCIEN(R%)\r\rEnd Function\r\rFor S% = 1 To NSec%\relasterm = AMAX(0.1 * mfpeconints(R%, S%), Amin(2 * mfpeconints(R%, S%), mfpeconints(R%, S%) * MulTrade))\r\rIf IY% = 2 Then\rSTradeTermSec(R%, S%) = TradeTermSec(R%, S%)\rTradeTermShift(R%, S%) = 0\rElseIf IY% = 3 Then\rTradeTermShift(R%, S%) = TradeTermSec(R%, S%) - STradeTermSec(R%, S%)\rEnd If\rcorrectionterm = ConvergeOverTime(TradeTermShift(R%, S%), 0, 100)\recintcontrib = ecintcontrib + (TradeTermSec(R%, S%) - STradeTermSec(R%, S%) - correctionterm) / 10 * elasterm\rSTradeTermSec(R%, S%) = TradeTermSec(R%, S%)\r\r'If RegName$(R%) = \"Zambia\" Then Stop\r\r'If RegName$(R%) = \"China\" Then Stop\rNext S%\r\rFor S% = 1 To NSec%\relasterm = AMAX(0.1 * mfpeconints(R%, S%), Amin(2 * mfpeconints(R%, S%), mfpeconints(R%, S%) * MulTrade))\r\rIf IY% = 2 Then\rSTradeTermSec(R%, S%) = TradeTermSec(R%, S%)\rTradeTermShift(R%, S%) = 0\rElseIf IY% = 3 Then\rTradeTermShift(R%, S%) = TradeTermSec(R%, S%) - STradeTermSec(R%, S%)\rEnd If\rcorrectionterm = ConvergeOverTime(TradeTermShift(R%, S%), 0, 100)\recintcontrib = ecintcontrib + (TradeTermSec(R%, S%) - STradeTermSec(R%, S%) - correctionterm) / 10 * elasterm\rSTradeTermSec(R%, S%) = TradeTermSec(R%, S%)\r\r'If RegName$(R%) = \"Zambia\" Then Stop\r\r'If RegName$(R%) = \"China\" Then Stop\rNext S%\r\rFor S% = 1 To NSec%\relasterm = AMAX(0.1 * mfpeconints(R%, S%), Amin(2 * mfpeconints(R%, S%), mfpeconints(R%, S%) * MulTrade))\r\rIf IY% = 2 Then\rSTradeTermSec(R%, S%) = TradeTermSec(R%, S%)\rTradeTermShift(R%, S%) = 0\rElseIf IY% = 3 Then\rTradeTermShift(R%, S%) = TradeTermSec(R%, S%) - STradeTermSec(R%, S%)\rEnd If\rcorrectionterm = ConvergeOverTime(TradeTermShift(R%, S%), 0, 100)\recintcontrib = ecintcontrib + (TradeTermSec(R%, S%) - STradeTermSec(R%, S%) - correctionterm) / 10 * elasterm\rSTradeTermSec(R%, S%) = TradeTermSec(R%, S%)\r\r'If RegName$(R%) = \"Zambia\" Then Stop\r\r'If RegName$(R%) = \"China\" Then Stop\rNext S%\r\r'Call ScaleMe(ECONINTEG)\rCall ScaleMeOrig(ECONINTEG, EconIntegI)\r\r'     All Steps:  Trade terms needed for IFsEcoMFP to compute trade trade openness impact on MFP\r'     ------------------------------------------------------------------------------------------\r\rFor R% = 1 To NR%\rIf IY% = 1 Then\r'TradeTerm(R%) = (XRPA(R%) + MRPA(R%)) / GDPPOT(R%) * 100\rTradeTerm(R%) = (X(R%) + M(R%)) / GDPPOT(R%) * 100 'X,MRPA terms were causing WP rises to affect productivity\rTradeTermI(R%) = TradeTerm(R%)\r'                    TradeTermMa(R%) = TradeTerm(R%)\rFor S% = 1 To NSec%\rTradeTermSec(R%, S%) = TradeTerm(R%) * (XS(R%, S%) + MS(R%, S%)) / (X(R%) + M(R%))\rTradeTermISec(R%, S%) = TradeTermSec(R%, S%)\r'                        TradeTermMaSec(R%, S%) = TradeTermSec(R%, S%)\rSTradeTermSec(R%, S%) = TradeTermSec(R%, S%)\rNext S%\rElse\rTradeTerm(R%) = CSng(SmTradeTerm(R%) * (1 + igdprcor(R%)) * 0.8 +\r                        (XRPA(R%) + MRPA(R%)) / GDPPOT(R%) * 100 * 0.2)\r'                    TradeTermMa(R%) = 0.9 * TradeTermMa(R%) + 0.1 * TradeTerm(R%) 'This was being done in IFsEco\r'Line above was setting up in IFsEcoMFP a comparison of TradeTerm and TradeTermMA,\r'   faster and slower moving averages; was not working because of growing lag effect boosting MFPKN\rFor S% = 1 To NSec%\rTradeTermSec(R%, S%) = TradeTerm(R%) * (XS(R%, S%) + MS(R%, S%)) / (X(R%) + M(R%))\r'                        TradeTermMaSec(R%, S%) = 0.9 * TradeTermMaSec(R%, S%) + 0.1 * TradeTermSec(R%, S%)\r'                        STradeTermSec(R%, S%) = TradeTermSec(R%, S%)\rNext S%\rEnd If\rSmTradeTerm(R%) = TradeTerm(R%)\r'               STradeTerm(R%) = TradeTerm(R%)\r\rNext R%\r\r'         elasterm = AMAX(0.1 * mfpeconint, Amin(2 * mfpeconint, mfpeconint * MulTrade))\r'Entrepot economies like Hong Kong should not be effected as much by\r'same percentage change in trade levels as very closed economies\r'         'ecintcontrib = (STradeTerm(R%) - tradetermI(R%)) / 10 * elasterm\r'         ecintcontrib = (STradeTerm(R%) - TradeTermMa(R%)) / 10 * elasterm\r'If RegName$(R%) = \"United States of America\" Then Stop\recintcontrib = 0\r"
  },
  {
    "Variable": "MFPKN",
    "UsesVariable": "GDPPCP",
    "Distance": 71,
    "Code": "0"
  },
  {
    "Variable": "MFPKN",
    "UsesVariable": "XS",
    "Distance": 1255,
    "Code": "0"
  },
  {
    "Variable": "MFPKN",
    "UsesVariable": "MS",
    "Distance": 1255,
    "Code": "0"
  },
  {
    "Variable": "MFPKN",
    "UsesVariable": "X",
    "Distance": 1255,
    "Code": "0"
  },
  {
    "Variable": "MFPKN",
    "UsesVariable": "M",
    "Distance": 1255,
    "Code": "0"
  },
  {
    "Variable": "MFPKN",
    "UsesVariable": "mfpeconints",
    "Distance": 7,
    "Code": "\rFor S% = 1 To NSec%\relasterm = AMAX(0.1 * mfpeconints(R%, S%), Amin(2 * mfpeconints(R%, S%), mfpeconints(R%, S%) * MulTrade))\r\rIf IY% = 2 Then\rSTradeTermSec(R%, S%) = TradeTermSec(R%, S%)\rTradeTermShift(R%, S%) = 0\rElseIf IY% = 3 Then\rTradeTermShift(R%, S%) = TradeTermSec(R%, S%) - STradeTermSec(R%, S%)\rEnd If\rcorrectionterm = ConvergeOverTime(TradeTermShift(R%, S%), 0, 100)\recintcontrib = ecintcontrib + (TradeTermSec(R%, S%) - STradeTermSec(R%, S%) - correctionterm) / 10 * elasterm\rSTradeTermSec(R%, S%) = TradeTermSec(R%, S%)\r\r'If RegName$(R%) = \"Zambia\" Then Stop\r\r'If RegName$(R%) = \"China\" Then Stop\rNext S%\r\r'Call ScaleMe(ECONINTEG)\rCall ScaleMeOrig(ECONINTEG, EconIntegI)\r\r'     All Steps:  Trade terms needed for IFsEcoMFP to compute trade trade openness impact on MFP\r'     ------------------------------------------------------------------------------------------\r\rFor R% = 1 To NR%\rIf IY% = 1 Then\r'TradeTerm(R%) = (XRPA(R%) + MRPA(R%)) / GDPPOT(R%) * 100\rTradeTerm(R%) = (X(R%) + M(R%)) / GDPPOT(R%) * 100 'X,MRPA terms were causing WP rises to affect productivity\rTradeTermI(R%) = TradeTerm(R%)\r'                    TradeTermMa(R%) = TradeTerm(R%)\rFor S% = 1 To NSec%\rTradeTermSec(R%, S%) = TradeTerm(R%) * (XS(R%, S%) + MS(R%, S%)) / (X(R%) + M(R%))\rTradeTermISec(R%, S%) = TradeTermSec(R%, S%)\r'                        TradeTermMaSec(R%, S%) = TradeTermSec(R%, S%)\rSTradeTermSec(R%, S%) = TradeTermSec(R%, S%)\rNext S%\rElse\rTradeTerm(R%) = CSng(SmTradeTerm(R%) * (1 + igdprcor(R%)) * 0.8 +\r                        (XRPA(R%) + MRPA(R%)) / GDPPOT(R%) * 100 * 0.2)\r'                    TradeTermMa(R%) = 0.9 * TradeTermMa(R%) + 0.1 * TradeTerm(R%) 'This was being done in IFsEco\r'Line above was setting up in IFsEcoMFP a comparison of TradeTerm and TradeTermMA,\r'   faster and slower moving averages; was not working because of growing lag effect boosting MFPKN\rFor S% = 1 To NSec%\rTradeTermSec(R%, S%) = TradeTerm(R%) * (XS(R%, S%) + MS(R%, S%)) / (X(R%) + M(R%))\r'                        TradeTermMaSec(R%, S%) = 0.9 * TradeTermMaSec(R%, S%) + 0.1 * TradeTermSec(R%, S%)\r'                        STradeTermSec(R%, S%) = TradeTermSec(R%, S%)\rNext S%\rEnd If\rSmTradeTerm(R%) = TradeTerm(R%)\r'               STradeTerm(R%) = TradeTerm(R%)\r\rNext R%\r"
  },
  {
    "Variable": "MFPKN",
    "UsesVariable": "EDTERGRATE",
    "Distance": 717,
    "Code": "\r\r'bbh 2020/05/26 start\rMulTrade = 1 + (50 - TradeTermI(R%)) / 50 '50 about global average\r"
  },
  {
    "Variable": "MFPKN",
    "UsesVariable": "igdpr",
    "Distance": 1256,
    "Code": "0"
  },
  {
    "Variable": "MFPKN",
    "UsesVariable": "XRPA",
    "Distance": 1256,
    "Code": "0"
  },
  {
    "Variable": "MFPKN",
    "UsesVariable": "MRPA",
    "Distance": 1256,
    "Code": "0"
  },
  {
    "Variable": "MFPKN",
    "UsesVariable": "GDPPOT",
    "Distance": 1256,
    "Code": "0"
  },
  {
    "Variable": "MFPPC",
    "UsesVariable": "MFPHC",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "MFPPC",
    "UsesVariable": "MFPSC",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "MFPPC",
    "UsesVariable": "MFPKN",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "MFPPC",
    "UsesVariable": "INFRAINDTRAD",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "MFPPC",
    "UsesVariable": "mfpinfrindtrad",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "MFPPC",
    "UsesVariable": "mfpinfrindict",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "MFPPC",
    "UsesVariable": "mfpiospn",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "MFPPC",
    "UsesVariable": "GDPPCP",
    "Distance": 16,
    "Code": "0"
  },
  {
    "Variable": "MFPPC",
    "UsesVariable": "GDS",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "MFPPC",
    "UsesVariable": "igdpr",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "MFPPC",
    "UsesVariable": "INFRAINDICT",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "MFPPC",
    "UsesVariable": "ictindexm",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "MFPPC",
    "UsesVariable": "GDP",
    "Distance": 66,
    "Code": "0"
  },
  {
    "Variable": "MFPPC",
    "UsesVariable": "WEP",
    "Distance": 125,
    "Code": "0"
  },
  {
    "Variable": "MFPPC",
    "UsesVariable": "mfpenpri",
    "Distance": 125,
    "Code": "0"
  },
  {
    "Variable": "MFPPCDEM",
    "UsesVariable": "MFPPC",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "MFPPCDEM",
    "UsesVariable": "MFPHC",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "MFPPCDEM",
    "UsesVariable": "MFPSC",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "MFPPCDEM",
    "UsesVariable": "MFPKN",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "MFPPCDEM",
    "UsesVariable": "INFRAINDTRADDEM",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "MFPPCDEM",
    "UsesVariable": "mfpinfrindtrad",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "MFPPCDEM",
    "UsesVariable": "mfpinfrindict",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "MFPPCDEM",
    "UsesVariable": "mfpiospn",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "MFPPCDEM",
    "UsesVariable": "GDPPCP",
    "Distance": 17,
    "Code": "0"
  },
  {
    "Variable": "MFPPCDEM",
    "UsesVariable": "INFRAINDICTDEM",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "MFPPCDEM",
    "UsesVariable": "GDS",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "MFPPCDEM",
    "UsesVariable": "igdpr",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "MFPPCDEM",
    "UsesVariable": "GDP",
    "Distance": 67,
    "Code": "0"
  },
  {
    "Variable": "MFPPCDEM",
    "UsesVariable": "WEP",
    "Distance": 126,
    "Code": "0"
  },
  {
    "Variable": "MFPPCDEM",
    "UsesVariable": "mfpenpri",
    "Distance": 126,
    "Code": "0"
  },
  {
    "Variable": "MFPPREMIUM",
    "UsesVariable": "GDPPCP",
    "Distance": 610,
    "Code": "\r'bbh 2019/05/24 end of new version\r\rFunction PremTechConv(R%, context As IForecastContext) As Single\r'- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\r'\rIf R% = TechLeadRegion% Then\rPremTechConv = 0\rExit Function\rEnd If\r'jrs 2014/09/16\r'gvdb 2024/04/05\r' unused variable\rDim PremTechComp As Single, GDPPCLead As Single, PreLeadConvergeLevel As Single, Pt8LeaderLevel As Single ' PremTechConvPeak As Single,\rDim Pt8GDPPCLead As Single\r\r' bbh 2019/07/09 start\rGDPPCLead = AMAX(0.1, GDPPCP(TechLeadRegion%))\rPt8GDPPCLead = CSng(GDPPCLead * 0.8)\r' bbh 2019/09/07 start\r'    Select Case mfpconvfunc 'Tech convergence function; default base corresponds roughly to SSP2, etc.\r'        Case 1\r'             Call XYTABL(\"GDP/Capita (PPP) Versus Technological Premium High SSP1 (2015)\", GDPPCP(R%), PremTechComp)\r'             Call XYTABL(\"GDP/Capita (PPP) Versus Technological Premium High SSP1 (2015)\", 15, PreLeadConvergeLevel)\r'             Call XYTABL(\"GDP/Capita (PPP) Versus Technological Premium High SSP1 (2015)\", Pt8GDPPCLead, Pt8LeaderLevel)\r'        Case 2\rCall XYTABL(\"GDP/Capita (PPP) Versus Technological Premium Medium SSP2 (2015)\", GDPPCP(R%), PremTechComp, context)\rCall XYTABL(\"GDP/Capita (PPP) Versus Technological Premium Medium SSP2 (2015)\", 15, PreLeadConvergeLevel, context)\rCall XYTABL(\"GDP/Capita (PPP) Versus Technological Premium Medium SSP2 (2015)\", Pt8GDPPCLead, Pt8LeaderLevel, context)\r'        Case 3\r'             Call XYTABL(\"GDP/Capita (PPP) Versus Technological Premium Low SSP3 (2015)\", GDPPCP(R%), PremTechComp)\r'             Call XYTABL(\"GDP/Capita (PPP) Versus Technological Premium Low SSP3 (2015)\", 15, PreLeadConvergeLevel)\r'             Call XYTABL(\"GDP/Capita (PPP) Versus Technological Premium Low SSP3 (2015)\", Pt8GDPPCLead, Pt8LeaderLevel)\r'        Case 4\r'             Call XYTABL(\"GDP/Capita (PPP) Versus Technological Premium Mixed SSP4 (2015)\", GDPPCP(R%), PremTechComp)\r'             Call XYTABL(\"GDP/Capita (PPP) Versus Technological Premium Mixed SSP4 (2015)\", 15, PreLeadConvergeLevel)\r'             Call XYTABL(\"GDP/Capita (PPP) Versus Technological Premium Mixed SSP4 (2015)\", Pt8GDPPCLead, Pt8LeaderLevel)\r'        Case 5\r'             Call XYTABL(\"GDP/Capita (PPP) Versus Technological Premium High SSP5 (2015)\", GDPPCP(R%), PremTechComp)\r'             Call XYTABL(\"GDP/Capita (PPP) Versus Technological Premium High SSP5 (2015)\", 15, PreLeadConvergeLevel)\r'             Call XYTABL(\"GDP/Capita (PPP) Versus Technological Premium High SSP5 (2015)\", Pt8GDPPCLead, Pt8LeaderLevel)\r'        Case Else\r'             Call XYTABL(\"GDP/Capita (PPP) Versus Technological Premium Medium SSP2 (2015)\", GDPPCP(R%), PremTechComp)\r'             Call XYTABL(\"GDP/Capita (PPP) Versus Technological Premium Medium SSP2 (2015)\", 15, PreLeadConvergeLevel)\r'             Call XYTABL(\"GDP/Capita (PPP) Versus Technological Premium Medium SSP2 (2015)\", Pt8GDPPCLead, Pt8LeaderLevel)\r'    End Select\r\r'    Call XYTABL(\"GDP/Capita Versus Technological Premium\", GDPPCP(R%), PremTechComp)\r'    Call XYTABL(\"GDP/Capita Versus Technological Premium\", 10, PremTechConvPeak)\r'Call XYTABL(\"GDP/Capita (PPP) Versus Technological Premium (2015)\", GDPPCP(R%), PremTechComp, context)\r'Call XYTABL(\"GDP/Capita (PPP) Versus Technological Premium (2015)\", 6, PremTechConvPeak)\r'Call XYTABL(\"GDP/Capita (PPP) Versus Technological Premium (2015)\", 15, PreLeadConvergeLevel, context)\r'Call XYTABL(\"GDP/Capita (PPP) Versus Technological Premium (2015)\", Pt8GDPPCLead, Pt8LeaderLevel, context)\r'Tech convergence rates on this function were set by looking at MFPCOR for WB income group levels\r'  and at average GDPPCP for those income groups and adjusting values to move corrections toward 0\r'  The function specifies tech convergence rates at average GDPPCP for the income groups\r'  Hardest part is dealing with convergence as countries approach and exceed leader GDPPCP, see code below\r' bbh 2019/07/09 end\r' bbh 2019/09/07 end\r\r'    If GDPPCP(R%) <= 10 Then\r'        PremTechConv = PremTechComp\r'    ElseIf GDPPCP(R%) > 10 And GDPPCP(R%) < 0.8 * GDPPCLead Then\r'        PremTechConv = PremTechConvPeak\r'    ElseIf GDPPCP(R%) >= 0.8 * GDPPCLead And GDPPCP(R%) <= 0.9 * GDPPCLead Then\r'        'take to 1/2 premium\r'        PremTechConv = PremTechConvPeak * (GDPPCLead - GDPPCP(R%)) / (0.2 * GDPPCLead)\r'    ElseIf GDPPCP(R%) >= 0.9 * GDPPCLead And GDPPCP(R%) <= GDPPCLead Then\r'        'take to 1/2 premium - 3.0\r'        PremTechConv = PremTechConvPeak * 0.5 - _\r'            1.5 * (GDPPCP(R%) - 0.9 * GDPPCLead) / (0.1 * GDPPCLead)\r'    ElseIf GDPPCP(R%) > GDPPCLead And GDPPCP(R%) <= 1.1 * GDPPCLead Then\r'        'take to 1/2 premium -3.0\r'        PremTechConv = PremTechConvPeak * 0.5 - _\r'            1.5 - 1.5 * (GDPPCP(R%) - GDPPCLead) / (0.1 * GDPPCLead)\r'    Else\r'        PremTechConv = PremTechConvPeak * 0.5 - 3#\r'    End If\r\r' bbh 2019/07/09 start\r'    If GDPPCP(R%) <= 10 Then\r'        PremTechConv = PremTechComp 'rising premium with function to premium peak\r'    ElseIf GDPPCP(R%) > 10 And GDPPCP(R%) < 0.8 * GDPPCLead Then\r'        PremTechConv = PremTechConvPeak\r'    ElseIf GDPPCP(R%) >= 0.8 * GDPPCLead And GDPPCP(R%) <= 0.9 * GDPPCLead Then\r'        'take from full peak premium to 1/2 peak premium\r'        PremTechConv = PremTechConvPeak - _\r'            0.5 * PremTechConvPeak * (GDPPCP(R%) - 0.8 * GDPPCLead) / (0.1 * GDPPCLead)\r'    ElseIf GDPPCP(R%) >= 0.9 * GDPPCLead And GDPPCP(R%) <= GDPPCLead Then\r'        'take from half peak premium to 0\r'        PremTechConv = PremTechConvPeak * 0.5 - _\r'            0.5 * PremTechConvPeak * (GDPPCP(R%) - 0.9 * GDPPCLead) / (0.1 * GDPPCLead)\r'    'bbh 2011/09/24 start\r''    ElseIf GDPPCP(R%) > GDPPCLead And GDPPCP(R%) <= 1.1 * GDPPCLead Then\r''        'take from 0 to -3.0 relative to leader\r''        PremTechConv = 0 - _\r''            3# * (GDPPCP(R%) - GDPPCLead) / (0.1 * GDPPCLead)\r'    ElseIf GDPPCP(R%) > GDPPCLead And GDPPCP(R%) <= 2 * GDPPCLead Then\r'        'take from 0 to -1.5 relative to leader\r'        PremTechConv = 0 - _\r'            1.5 * (GDPPCP(R%) - GDPPCLead) / GDPPCLead\r'    Else 'leave at -1.5 relative to leader\r''        PremTechConv = -3#\r'        PremTechConv = -1.5\r'    'bbh 2011/09/24 end\r'    End If\r\rIf GDPPCP(R%) <= 15 Then\rPremTechConv = PremTechComp 'premium in range best defined (to average of upper-middle income GDPPCP)\r\rElseIf GDPPCP(R%) > 15 AndAlso GDPPCP(R%) < 0.8 * GDPPCLead Then\rPremTechConv = PremTechComp  'range of stable, function-driven convergence level, above peak of upper-middle range\r\rElseIf GDPPCP(R%) >= 0.8 * GDPPCLead AndAlso GDPPCP(R%) <= 0.9 * GDPPCLead Then\r'slowing range; take from pre leader convergence rate to 1/2 preleaderconvergence rate\r'0.8 level set because that is above the top of upper middle and bottom of high income\r'   should be reviewed over time as income ranges change\rPremTechConv = CSng(Pt8LeaderLevel -\r            0.5 * Pt8LeaderLevel * (GDPPCP(R%) - 0.8 * GDPPCLead) / (0.1 * GDPPCLead))\r\rElseIf GDPPCP(R%) >= 0.9 * GDPPCLead AndAlso GDPPCP(R%) <= GDPPCLead Then\r'accelerated slowing; from half pre leader convergence to 0\rPremTechConv = CSng(Pt8LeaderLevel * 0.5 -\r            0.5 * Pt8LeaderLevel * (GDPPCP(R%) - 0.9 * GDPPCLead) / (0.1 * GDPPCLead))\r\rElseIf GDPPCP(R%) > GDPPCLead AndAlso GDPPCP(R%) <= 2 * GDPPCLead Then\r'above leader; take from 0 to -1.5 relative to leader\rPremTechConv = CSng(0 -\r            1.5 * (GDPPCP(R%) - GDPPCLead) / GDPPCLead)\rEnd If\r' bbh 2019/07/09 end\r\r\r'Logic:  Function itself doesn't allow GDPpc of leader to move up\r'   Others rise or fall relative to leader\r\rEnd Function\rCOMPLETE STRUCTURE:Next R%:6202|\r\rFor R% = 1 To NR%\r\r\r'   All but First 1:  Technological Growth:  Set Base Rates at Technology Leader Rate\r'   ---------------------------------------------------------------------------------\r'bbh 2019/09/08 start\r'Dim techpremium = PremTechConv(R%, context)\r'bbh 2021/05/15 Dim techpremium = PremTechComp(R%)\rMFPPREMIUM(R%) = PremTechComp(R%)\r"
  },
  {
    "Variable": "MFPRATE",
    "UsesVariable": "MFPPREMIUM",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MFPRATE",
    "UsesVariable": "mfpadd",
    "Distance": 0,
    "Code": "\r\rFor S% = 1 To NSec%\r'bbh 7/2/2009  Made possible addition of mfpadd to exogenous growth\r'If RegName$(R%) = \"United States of America\" And IY% >= 5 And S% = 5 Then Stop\r'            If gdprext(R%) >= -10 Then\r'bbh 2021/05/15 MFPRATE(R%, S%) = MFPRATE(R%, S%) + techpremium / 100 + mfpadd(R%) _\r'+ mfpbasgr + mfpbasinc * zy + glocorrect\rMFPRATE(R%, S%) = MFPRATE(R%, S%) + MFPPREMIUM(R%) / 100 + mfpadd(R%) _\r                    + mfpbasgr + mfpbasinc * zy + MFPGLOCOR\r'jrs 2023/05/02\rIf GRPS(1, R%) = \"Central African Republic\" And context.HistoricMode = False Then\rMFPRATE(R%, S%) = CSng(MFPRATE(R%, S%) + 0.01)\rEnd If\r'bbh 2019/09/08 end\r'            Else\r'                MFPRATE(R%, S%) = MFPRATE(R%, S%) + techpremium / 100 _\r'+ mfpbasgr + mfpbasinc * zy + glocorrect 'no growth boost if have historic\r'            End If\r'If RegName$(R%) = \"United States of America\" And IY% >= 5 And S% = 5 Then Stop\r'bbh 7/2/2009 end\rNext S%\r"
  },
  {
    "Variable": "MFPRATE",
    "UsesVariable": "mfpbasgr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MFPRATE",
    "UsesVariable": "mfpbasinc",
    "Distance": 0,
    "Code": "\r\rFor S% = 1 To NSec%\r'bbh 7/2/2009  Made possible addition of mfpadd to exogenous growth\r'If RegName$(R%) = \"United States of America\" And IY% >= 5 And S% = 5 Then Stop\r'            If gdprext(R%) >= -10 Then\r'bbh 2021/05/15 MFPRATE(R%, S%) = MFPRATE(R%, S%) + techpremium / 100 + mfpadd(R%) _\r'+ mfpbasgr + mfpbasinc * zy + glocorrect\rMFPRATE(R%, S%) = MFPRATE(R%, S%) + MFPPREMIUM(R%) / 100 + mfpadd(R%) _\r                    + mfpbasgr + mfpbasinc * zy + MFPGLOCOR\r'jrs 2023/05/02\rIf GRPS(1, R%) = \"Central African Republic\" And context.HistoricMode = False Then\rMFPRATE(R%, S%) = CSng(MFPRATE(R%, S%) + 0.01)\rEnd If\r'bbh 2019/09/08 end\r'            Else\r'                MFPRATE(R%, S%) = MFPRATE(R%, S%) + techpremium / 100 _\r'+ mfpbasgr + mfpbasinc * zy + glocorrect 'no growth boost if have historic\r'            End If\r'If RegName$(R%) = \"United States of America\" And IY% >= 5 And S% = 5 Then Stop\r'bbh 7/2/2009 end\rNext S%\r"
  },
  {
    "Variable": "MFPRATE",
    "UsesVariable": "MFPGLOCOR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MFPRATE",
    "UsesVariable": "mfpconv2",
    "Distance": 0,
    "Code": "\r'MFPPREMIUM(R%) = ConvergeOverTime(MFPPREMIUM(R%), 0, mfpconv2 * 2) 'bbh 2023/12/22 Test - Like MFPCORS declines\r'MFPPREMIUM(R%) = 0 'bbh 2023/12/05 test\r'If IY% = 20 And (GRPS(1, R) = \"Eritrea\") Then Stop  'bbh 2023/12/12\rFor S% = 1 To NSec%  'Set base rates at technological leader of system\rMFPRATE(R%, S%) = mfpleadr(S%)\rIf S% = ICT Then 'ICT growth starts very high, but gradually converges to services\rMFPRATE(R%, S%) = ConvergeOverTime(MFPRATE(R%, S%), MFPRATE(R%, Serv), mfpconv2)\r'Base, Target, Years\rEnd If\rNext S%\r"
  },
  {
    "Variable": "MFPRATE",
    "UsesVariable": "mfpleadr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MFPRATET",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "\r'jrs 2023/03/25 MFPGROWTH is empty in year 1 after rebuilding the base\rIf IY > 1 Then\rFor S% = 1 To NSec%\r'            MFPRATET(R%) = MFPRATET(R%) + MFPRATE(R%, S%) * VADD(R%, S%)\r'bbh 2021/05/15 MFPRATET(R%) = MFPRATET(R%) + MFPGro(R%, S%) * VADD(R%, S%)\rMFPRATET(R%) = MFPRATET(R%) + MFPGROWTH(R%, S%) * VADD(R%, S%)\rNext S%\rMFPRATET(R%) = MFPRATET(R%) / AMAX(0.01, GDP(R%))\rEnd If\r"
  },
  {
    "Variable": "MFPRATET",
    "UsesVariable": "MFPGROWTH",
    "Distance": 0,
    "Code": "\r'jrs 2023/03/25 MFPGROWTH is empty in year 1 after rebuilding the base\rIf IY > 1 Then\rFor S% = 1 To NSec%\r'            MFPRATET(R%) = MFPRATET(R%) + MFPRATE(R%, S%) * VADD(R%, S%)\r'bbh 2021/05/15 MFPRATET(R%) = MFPRATET(R%) + MFPGro(R%, S%) * VADD(R%, S%)\rMFPRATET(R%) = MFPRATET(R%) + MFPGROWTH(R%, S%) * VADD(R%, S%)\rNext S%\rMFPRATET(R%) = MFPRATET(R%) / AMAX(0.01, GDP(R%))\rEnd If\r"
  },
  {
    "Variable": "MFPRATET",
    "UsesVariable": "VADD",
    "Distance": 0,
    "Code": "\r'jrs 2023/03/25 MFPGROWTH is empty in year 1 after rebuilding the base\rIf IY > 1 Then\rFor S% = 1 To NSec%\r'            MFPRATET(R%) = MFPRATET(R%) + MFPRATE(R%, S%) * VADD(R%, S%)\r'bbh 2021/05/15 MFPRATET(R%) = MFPRATET(R%) + MFPGro(R%, S%) * VADD(R%, S%)\rMFPRATET(R%) = MFPRATET(R%) + MFPGROWTH(R%, S%) * VADD(R%, S%)\rNext S%\rMFPRATET(R%) = MFPRATET(R%) / AMAX(0.01, GDP(R%))\rEnd If\r"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "MFPHC",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "MFPPC",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "MFPKN",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "ECONFREE",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "mfpefree",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "GOVEFFECT",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "mfpgoveff",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "GOVCORRUPT",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "mfpgovcor",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "mfpdemoc",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "FREEDOM",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "mfpfree",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "GOVINDSECUR",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "mfpconflict",
    "Distance": 1,
    "Code": "\r\rPublic Sub ifsECO7AllbutFirstYear(context As IForecastContext)\r'call7:\r'bbh 2011/09/21 start\r'   All but First 7: Save Internal War\r'   ----------------------------------\r'ttt 2019/10/08 TakeOut\rArray.Copy(GOVINDSECUR, SGOVINDSECUR, NR + 1)\rArray.Copy(CLIMECONIMP, SClimEconImp, NR + 1)\r'jrs 2022/11/30 need this line for exogenous forecast using growth rates, it was commented out\rArray.Copy(SFINTLWARALL, ssfintlwarall, NR + 1)\rArray.Copy(SFCIVILWARUCDP, sSFCIVILWARUCDP, NR + 1) 'jrs 2024/05/20\r\rFor R% = 1 To NR%\r'ssfintlwarall(R%) = SFINTLWARALL(R%)\r'ttt 2019/10/08 TakenOut\r'SGOVINDSECUR(R%) = GOVINDSECUR(R%)\r'bbh 2016/01/19 changed from GOVINDSECRURI to GOVINDSECURMa\rGOVINDSECURMa(R%) = GOVINDSECURMa(R%) * 0.9! + GOVINDSECUR(R%) * 0.1!\rMFPSCCONFL(R%) = (1 - GOVINDSECUR(R%)) * mfpconflict\r'If RegName$(R%) = \"Afghanistan\" Then Stop\r\r'   All but First 7: Climate change impact\r'   ----------------------------------\r'ttt 2019/10/08 TakenOut\r'SClimEconImp(R%) = CLIMECONIMP(R%) 'bbh 2017/10/04\r\r'   All but First 7: Intersectoral flows in agriculture model 'bbh 2022/12/20\r'   ----------------------------------\rAgINTSFlows(R%) = (FDEM(R%, 1) + FEDDEM(R%, 1) + FMDEM(R%, 1) + INDEM(R%, 1)) / FDEM(R%, 1)\r\rNext R%\r'mti 2015/05/06 - start\r'   All but First 7: Cyber\r'   ----------------------------------\r'    IFsCyb sgdpr1(), iCostChangeFac(), sICTCYBBENTOTCUM(), sICTCYBRISKTOTCUM(), iLCybCrimeEspF, TechLeadRegion%\r'bbh 2015/05/17\r'IFsCyb sgdpr1(), iCostChangeFac(), sICTCYBBENTOTCUM(), sICTCYBRISKTOTCUM(), GDPICyb(), ICTGrowthCumCompound(), ICTSurplusCumCompound(), iLCybCrimeEspF, TechLeadRegion%\r'bbh 2015/06/06\r\rIFsCyb(sgdpr1, iCostChangeFac, sICTCYBBENTOTCUM, sICTCYBRISKTOTCUM, GDPICyb,\r        ICTGrowthCumCompound, ICTSurplusCumCompound, ICTIndexB4Mul, iLCybCrimeEspF, TechLeadRegion%, context)\r\r'mti 2015/05/06 - end\r'\r\r\r\rEnd Sub\r"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "confforsw",
    "Distance": 1,
    "Code": "\r\rPublic Sub ifsECO7AllbutFirstYear(context As IForecastContext)\r'call7:\r'bbh 2011/09/21 start\r'   All but First 7: Save Internal War\r'   ----------------------------------\r'ttt 2019/10/08 TakeOut\rArray.Copy(GOVINDSECUR, SGOVINDSECUR, NR + 1)\rArray.Copy(CLIMECONIMP, SClimEconImp, NR + 1)\r'jrs 2022/11/30 need this line for exogenous forecast using growth rates, it was commented out\rArray.Copy(SFINTLWARALL, ssfintlwarall, NR + 1)\rArray.Copy(SFCIVILWARUCDP, sSFCIVILWARUCDP, NR + 1) 'jrs 2024/05/20\r\rFor R% = 1 To NR%\r'ssfintlwarall(R%) = SFINTLWARALL(R%)\r'ttt 2019/10/08 TakenOut\r'SGOVINDSECUR(R%) = GOVINDSECUR(R%)\r'bbh 2016/01/19 changed from GOVINDSECRURI to GOVINDSECURMa\rGOVINDSECURMa(R%) = GOVINDSECURMa(R%) * 0.9! + GOVINDSECUR(R%) * 0.1!\rMFPSCCONFL(R%) = (1 - GOVINDSECUR(R%)) * mfpconflict\r'If RegName$(R%) = \"Afghanistan\" Then Stop\r\r'   All but First 7: Climate change impact\r'   ----------------------------------\r'ttt 2019/10/08 TakenOut\r'SClimEconImp(R%) = CLIMECONIMP(R%) 'bbh 2017/10/04\r\r'   All but First 7: Intersectoral flows in agriculture model 'bbh 2022/12/20\r'   ----------------------------------\rAgINTSFlows(R%) = (FDEM(R%, 1) + FEDDEM(R%, 1) + FMDEM(R%, 1) + INDEM(R%, 1)) / FDEM(R%, 1)\r\rNext R%\r'mti 2015/05/06 - start\r'   All but First 7: Cyber\r'   ----------------------------------\r'    IFsCyb sgdpr1(), iCostChangeFac(), sICTCYBBENTOTCUM(), sICTCYBRISKTOTCUM(), iLCybCrimeEspF, TechLeadRegion%\r'bbh 2015/05/17\r'IFsCyb sgdpr1(), iCostChangeFac(), sICTCYBBENTOTCUM(), sICTCYBRISKTOTCUM(), GDPICyb(), ICTGrowthCumCompound(), ICTSurplusCumCompound(), iLCybCrimeEspF, TechLeadRegion%\r'bbh 2015/06/06\r\rIFsCyb(sgdpr1, iCostChangeFac, sICTCYBBENTOTCUM, sICTCYBRISKTOTCUM, GDPICyb,\r        ICTGrowthCumCompound, ICTSurplusCumCompound, ICTIndexB4Mul, iLCybCrimeEspF, TechLeadRegion%, context)\r\r'mti 2015/05/06 - end\r'\r\r\r\rEnd Sub\r"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "GDPPCP",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "EDYRSAG15",
    "Distance": 17,
    "Code": "0"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "ENX",
    "Distance": 1093,
    "Code": "0"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "ENPRI",
    "Distance": 1093,
    "Code": "0"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "GDP",
    "Distance": 1093,
    "Code": "0"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "igdpr",
    "Distance": 45,
    "Code": "0"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "DEMOCPOLITY",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "GEM",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "MFPSC",
    "UsesVariable": "YTHBULGE",
    "Distance": 11,
    "Code": "\r'If RegName$(R%) = \"Nigeria\" Then Stop\r\r'mti 2018/01/18 End\r'mti 2014/03/27 - end\r\r'   First Year 2:  Compute Contributions of Multiple Factors to MFPSC\r'   -----------------------------------------------------------------\r'bbh 2011/04/09 start\r'         energyterm = ENX(R%) * WEPBYEAR / GDP(R%)\r'bbh 2011/04/30\renergydepend(R%) = ENX(R%) * ENPRI(R%) / GDP(R%)\r"
  },
  {
    "Variable": "MFPSCCONFL",
    "UsesVariable": "GOVINDSECUR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MFPSCCONFL",
    "UsesVariable": "mfpconflict",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MFPTOT",
    "UsesVariable": "MFPBAS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MFPTOT",
    "UsesVariable": "MFPHC",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MFPTOT",
    "UsesVariable": "MFPSC",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MFPTOT",
    "UsesVariable": "MFPPC",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MFPTOT",
    "UsesVariable": "MFPKN",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MFPTOT",
    "UsesVariable": "MFPCOR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MIGRANTS",
    "UsesVariable": "MIGRANTSIN",
    "Distance": 0,
    "Code": "\rMIGRANTS(R%) = MIGRANTSIN(R%) - MIGRANTSOUT(R%)\r"
  },
  {
    "Variable": "MIGRANTS",
    "UsesVariable": "MIGRANTSOUT",
    "Distance": 0,
    "Code": "\rMIGRANTS(R%) = MIGRANTSIN(R%) - MIGRANTSOUT(R%)\r"
  },
  {
    "Variable": "MIGRANTS",
    "UsesVariable": "MIGRATE",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MIGRANTS",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MIGRANTS",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MIGRANTSFORCEDOUT",
    "UsesVariable": "GOVRISK",
    "Distance": 1,
    "Code": "\r\r'All but First: Forced Migrants\r'---------------------------------------------------\rDim Est As Single\rFor i = 1 To NR\rIf SMIGFORCEDEST(i) > 0 Then\r'JRS 2018/02/26\r'Est = 1.2825 + 17.3877 * SSFINTLWARMAG(i) / POP(i)\r'jrs 2018/06/19 Est = AMAX((-0.076 + (1.103 * SGOVRISK(i) ^ 2)) * POP(i), 0)\rEst = CSng(Math.Exp(3.469 - 12.8129 * SGOVINDSECUR(i)) * POP(i) / 100)\rMIGRANTSFORCEDOUT(i) = 0\r'If i = 10 Then Stop\rMIGRANTSFORCEDOUT(i) = MIGRANTSFORCEDOUT(i) * Est / SMIGFORCEDEST(i)\rSMIGFORCEDEST(i) = Est\r\r'If i = 70 Then Stop\r'JRS 2018/02/26\r'ElseIf SSFINTLWARMAG(i) > 0 Then\rElseIf SGOVRISK(i) > 0 Then\r'14 pc -> 4%\r'Est = 1.2825 + 17.3877 * SSFINTLWARMAG(i) / POP(i)\rEst = AMAX((-0.076 + (1.103 * SGOVRISK(i) ^ 2)) * POP(i), 0)\rMIGRANTSFORCEDOUT(i) = Est\rSMIGFORCEDEST(i) = Est\rEnd If\rNext i\r\r\r'All but First: Forced Migrants\r'---------------------------------------------------\rDim Est As Single\rFor i = 1 To NR\rIf SMIGFORCEDEST(i) > 0 Then\r'JRS 2018/02/26\r'Est = 1.2825 + 17.3877 * SSFINTLWARMAG(i) / POP(i)\r'jrs 2018/06/19 Est = AMAX((-0.076 + (1.103 * SGOVRISK(i) ^ 2)) * POP(i), 0)\rEst = CSng(Math.Exp(3.469 - 12.8129 * SGOVINDSECUR(i)) * POP(i) / 100)\rMIGRANTSFORCEDOUT(i) = 0\r'If i = 10 Then Stop\rMIGRANTSFORCEDOUT(i) = MIGRANTSFORCEDOUT(i) * Est / SMIGFORCEDEST(i)\rSMIGFORCEDEST(i) = Est\r\r'If i = 70 Then Stop\r'JRS 2018/02/26\r'ElseIf SSFINTLWARMAG(i) > 0 Then\rElseIf SGOVRISK(i) > 0 Then\r'14 pc -> 4%\r'Est = 1.2825 + 17.3877 * SSFINTLWARMAG(i) / POP(i)\rEst = AMAX((-0.076 + (1.103 * SGOVRISK(i) ^ 2)) * POP(i), 0)\rMIGRANTSFORCEDOUT(i) = Est\rSMIGFORCEDEST(i) = Est\rEnd If\rNext i\rCOMPLETE STRUCTURE:End If:13665|\r\r'jrs 2018/01/19\rIf IY = 1 Then\rFor i = 1 To NR\rMIGRANTSFORCEDOUT(i) = 0\rMIGRANTSFORCEDRETURN(i) = 0\rMIGRANTSVOLIN(i) = 0\rMIGRANTSVOLOUT(i) = 0\rPOPREFUGEE(i) = 0\r'jrs 2018/03/16\rPOPFOREIGNOUT(i) = 0\rPOPFOREIGNIN(i) = 0\rNext i\r\r\rFor i = 1 To NR\rMIGRANTSFORCEDOUT(i) = MIGRANTSFORCEDOUT(i) / 1000000\r'jrs 2018/03/16\rPOPFOREIGNOUT(i) = POPFOREIGNOUT(i) + DYADPOPFOREIGN(i, j) / 1000000\r'If Single.IsNaN(DYADPOPFOREIGN(i, j)) Then Stop\rPOPFOREIGNIN(j) = POPFOREIGNIN(j) + DYADPOPFOREIGN(i, j) / 1000000\r'jrs 2018/04/03\rSPopForeignIn(j) = POPFOREIGNIN(j)\rNext j\rNext i\r"
  },
  {
    "Variable": "MIGRANTSFORCEDOUT",
    "UsesVariable": "POP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "MIGRANTSFORCEDOUT",
    "UsesVariable": "GOVINDSECUR",
    "Distance": 2,
    "Code": "\r\r'All but First: Forced Migrants\r'---------------------------------------------------\rDim Est As Single\rFor i = 1 To NR\rIf SMIGFORCEDEST(i) > 0 Then\r'JRS 2018/02/26\r'Est = 1.2825 + 17.3877 * SSFINTLWARMAG(i) / POP(i)\r'jrs 2018/06/19 Est = AMAX((-0.076 + (1.103 * SGOVRISK(i) ^ 2)) * POP(i), 0)\rEst = CSng(Math.Exp(3.469 - 12.8129 * SGOVINDSECUR(i)) * POP(i) / 100)\rMIGRANTSFORCEDOUT(i) = 0\r'If i = 10 Then Stop\rMIGRANTSFORCEDOUT(i) = MIGRANTSFORCEDOUT(i) * Est / SMIGFORCEDEST(i)\rSMIGFORCEDEST(i) = Est\r\r'If i = 70 Then Stop\r'JRS 2018/02/26\r'ElseIf SSFINTLWARMAG(i) > 0 Then\rElseIf SGOVRISK(i) > 0 Then\r'14 pc -> 4%\r'Est = 1.2825 + 17.3877 * SSFINTLWARMAG(i) / POP(i)\rEst = AMAX((-0.076 + (1.103 * SGOVRISK(i) ^ 2)) * POP(i), 0)\rMIGRANTSFORCEDOUT(i) = Est\rSMIGFORCEDEST(i) = Est\rEnd If\rNext i\r\r\r'All but First: Forced Migrants\r'---------------------------------------------------\rDim Est As Single\rFor i = 1 To NR\rIf SMIGFORCEDEST(i) > 0 Then\r'JRS 2018/02/26\r'Est = 1.2825 + 17.3877 * SSFINTLWARMAG(i) / POP(i)\r'jrs 2018/06/19 Est = AMAX((-0.076 + (1.103 * SGOVRISK(i) ^ 2)) * POP(i), 0)\rEst = CSng(Math.Exp(3.469 - 12.8129 * SGOVINDSECUR(i)) * POP(i) / 100)\rMIGRANTSFORCEDOUT(i) = 0\r'If i = 10 Then Stop\rMIGRANTSFORCEDOUT(i) = MIGRANTSFORCEDOUT(i) * Est / SMIGFORCEDEST(i)\rSMIGFORCEDEST(i) = Est\r\r'If i = 70 Then Stop\r'JRS 2018/02/26\r'ElseIf SSFINTLWARMAG(i) > 0 Then\rElseIf SGOVRISK(i) > 0 Then\r'14 pc -> 4%\r'Est = 1.2825 + 17.3877 * SSFINTLWARMAG(i) / POP(i)\rEst = AMAX((-0.076 + (1.103 * SGOVRISK(i) ^ 2)) * POP(i), 0)\rMIGRANTSFORCEDOUT(i) = Est\rSMIGFORCEDEST(i) = Est\rEnd If\rNext i\r"
  },
  {
    "Variable": "MIGRANTSIN",
    "UsesVariable": "MIGRANTSOUT",
    "Distance": 2,
    "Code": "\rSUMEM = 0\rCOMPLETE STRUCTURE:End Sub:13568|\r\r'bbh 2020/03/09 entire Sub\rSub MigrationGross(context As IForecastContext)\r\r'gvdb 2024/04/05\r'unused variable\rDim SUMEM As Single, SUMIM As Single ', WORLDDIMEM As Single\rDim PopForInRatio As Single, ReturnOfImmigrants As Single 'bbh 2022/06/23 PopForIn As Single,\rDim PopForInRatioMax As Single\r\r'   Normalize global migration to average of immigration, emigration\r'   ----------------------------------------------------------------\rSUMIM = 0\rCOMPLETE STRUCTURE:End Sub:13568|\r\r'bbh 2020/03/09 entire Sub\rSub MigrationGross(context As IForecastContext)\r\r'gvdb 2024/04/05\r'unused variable\rDim SUMEM As Single, SUMIM As Single ', WORLDDIMEM As Single\rDim PopForInRatio As Single, ReturnOfImmigrants As Single 'bbh 2022/06/23 PopForIn As Single,\rDim PopForInRatioMax As Single\r\r'   Normalize global migration to average of immigration, emigration\r'   ----------------------------------------------------------------\rSUMIM = 0\r\rSUMEM = SUMEM + MIGRANTSOUT(R%)\r\r'MIGRANTSOUT(R%) = Amin(0.15 * SPopForeignIn(R%), MIGRANTSOUT(R%) * MigOutFlowMul(R%))\r'MIGRANTSIN(R%) = AMAX(0, Amin(MIGRANTSIN(R%), PopForInRatioMax * POP(R%) - SPopForeignIn(R%) * (1 - SCDR(R%) / 1000) - MIGRANTSOUT(R%)))\r'If RegName$(R%) = \"United Arab Emirates\" And IY% + 2016 >= 2060 Then Stop\r'MIGRANTSOUT(R%) = CSng(Amin(MIGRANTSOUT(R%), POP(R%) * 0.1)) 'bbh 2024/03/22\r\rSUMIM = SUMIM + MIGRANTSIN(R%)\r\r'MIGRANTSOUT(R%) = Amin(0.15 * SPopForeignIn(R%), MIGRANTSOUT(R%) * MigOutFlowMul(R%))\r'MIGRANTSIN(R%) = AMAX(0, Amin(MIGRANTSIN(R%), PopForInRatioMax * POP(R%) - SPopForeignIn(R%) * (1 - SCDR(R%) / 1000) - MIGRANTSOUT(R%)))\r'If RegName$(R%) = \"United Arab Emirates\" And IY% + 2016 >= 2060 Then Stop\r'MIGRANTSOUT(R%) = CSng(Amin(MIGRANTSOUT(R%), POP(R%) * 0.1)) 'bbh 2024/03/22\r\rSUMIM = SUMIM + MIGRANTSIN(R%)\r\r\rDim WORLDIMEM = Amin(SUMIM, SUMEM)  'Minimum instead of average does slow down migration globally over time\rCOMPLETE STRUCTURE:Next R%:13565|\r'WORLDIMEM = (SUMIM + SUMEM) / 2\r\rFor R% = 1 To NR%\rMIGRANTSIN(R%) = MIGRANTSIN(R%) * WORLDIMEM / AMAX(0.001, SUMIM)\r\r'jrs 2019/07/18 *** translate later: end ***\r\r'jrs 2017/12/04\rFor i = 1 To NR\rMIGRANTSOUT(i) = 0\rMIGRANTSIN(i) = 0\rNext i\r"
  },
  {
    "Variable": "MIGRANTSIN",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MIGRANTSIN",
    "UsesVariable": "wmigrm",
    "Distance": 0,
    "Code": "\r\rIf IY > 1 Then\r'If GRPS(1, R%) = \"Ukraine\" And IY = 7 Then Stop\r'bbh 2020/04/11 multipliers added to 2 lines\rMIGRANTSIN(R%) = MIGRANTSIN(R%) * wmigrm * migrateinm(R%) 'swap in exogenous rate\rMIGRANTSOUT(R%) = MIGRANTSOUT(R%) * wmigrm * migrateoutm(R%)\r'leave MIGRATEIN/OUT unchanged or create run-to-run; those are parameters\rEnd If\r\r'jrs 2020/04/22 Dim AbsMigMax As Single = CSng(AMAX(1, 4 - 0.1 * IY%)) 'Drop max rate to 1% over 30 years\rDim AbsMigMax As Single = CSng(AMAX(MaxMIGRATEIN / 2, MaxMIGRATEIN - 0.1 * IY%))\r"
  },
  {
    "Variable": "MIGRANTSIN",
    "UsesVariable": "migrateinm",
    "Distance": 0,
    "Code": "\r\rIf IY > 1 Then\r'If GRPS(1, R%) = \"Ukraine\" And IY = 7 Then Stop\r'bbh 2020/04/11 multipliers added to 2 lines\rMIGRANTSIN(R%) = MIGRANTSIN(R%) * wmigrm * migrateinm(R%) 'swap in exogenous rate\rMIGRANTSOUT(R%) = MIGRANTSOUT(R%) * wmigrm * migrateoutm(R%)\r'leave MIGRATEIN/OUT unchanged or create run-to-run; those are parameters\rEnd If\r"
  },
  {
    "Variable": "MIGRANTSIN",
    "UsesVariable": "MIGRATEIN",
    "Distance": 0,
    "Code": "\r\rMIGRANTSIN(R%) = MIGRATEIN(R%) / 100 * POP(R%)\r"
  },
  {
    "Variable": "MIGRANTSOUT",
    "UsesVariable": "MIGRANTSIN",
    "Distance": 4,
    "Code": "COMPLETE STRUCTURE:End Sub:13568|\r\r'bbh 2020/03/09 entire Sub\rSub MigrationGross(context As IForecastContext)\r\r'gvdb 2024/04/05\r'unused variable\rDim SUMEM As Single, SUMIM As Single ', WORLDDIMEM As Single\rDim PopForInRatio As Single, ReturnOfImmigrants As Single 'bbh 2022/06/23 PopForIn As Single,\rDim PopForInRatioMax As Single\r\r'   Normalize global migration to average of immigration, emigration\r'   ----------------------------------------------------------------\rSUMIM = 0\r\rSUMEM = 0\r\rSUMEM = SUMEM + MIGRANTSOUT(R%)\r\r'MIGRANTSOUT(R%) = Amin(0.15 * SPopForeignIn(R%), MIGRANTSOUT(R%) * MigOutFlowMul(R%))\r'MIGRANTSIN(R%) = AMAX(0, Amin(MIGRANTSIN(R%), PopForInRatioMax * POP(R%) - SPopForeignIn(R%) * (1 - SCDR(R%) / 1000) - MIGRANTSOUT(R%)))\r'If RegName$(R%) = \"United Arab Emirates\" And IY% + 2016 >= 2060 Then Stop\r'MIGRANTSOUT(R%) = CSng(Amin(MIGRANTSOUT(R%), POP(R%) * 0.1)) 'bbh 2024/03/22\r\rSUMIM = SUMIM + MIGRANTSIN(R%)\r\rSUMEM = SUMEM + MIGRANTSOUT(R%)\r\r\rDim WORLDIMEM = Amin(SUMIM, SUMEM)  'Minimum instead of average does slow down migration globally over time\r\rMIGRANTSOUT(R%) = MIGRANTSOUT(R%) * WORLDIMEM / AMAX(0.001, SUMEM)\r\r'jrs 2019/07/18 *** translate later: end ***\r\r'jrs 2017/12/04\rFor i = 1 To NR\rMIGRANTSOUT(i) = 0\rMIGRANTSIN(i) = 0\rNext i\r"
  },
  {
    "Variable": "MIGRANTSOUT",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MIGRANTSOUT",
    "UsesVariable": "wmigrm",
    "Distance": 0,
    "Code": "\r\rIf IY > 1 Then\r'If GRPS(1, R%) = \"Ukraine\" And IY = 7 Then Stop\r'bbh 2020/04/11 multipliers added to 2 lines\rMIGRANTSIN(R%) = MIGRANTSIN(R%) * wmigrm * migrateinm(R%) 'swap in exogenous rate\rMIGRANTSOUT(R%) = MIGRANTSOUT(R%) * wmigrm * migrateoutm(R%)\r'leave MIGRATEIN/OUT unchanged or create run-to-run; those are parameters\rEnd If\r\r'jrs 2020/04/22 Dim AbsMigMax As Single = CSng(AMAX(1, 4 - 0.1 * IY%)) 'Drop max rate to 1% over 30 years\rDim AbsMigMax As Single = CSng(AMAX(MaxMIGRATEIN / 2, MaxMIGRATEIN - 0.1 * IY%))\r"
  },
  {
    "Variable": "MIGRANTSOUT",
    "UsesVariable": "migrateoutm",
    "Distance": 0,
    "Code": "\r\rIf IY > 1 Then\r'If GRPS(1, R%) = \"Ukraine\" And IY = 7 Then Stop\r'bbh 2020/04/11 multipliers added to 2 lines\rMIGRANTSIN(R%) = MIGRANTSIN(R%) * wmigrm * migrateinm(R%) 'swap in exogenous rate\rMIGRANTSOUT(R%) = MIGRANTSOUT(R%) * wmigrm * migrateoutm(R%)\r'leave MIGRATEIN/OUT unchanged or create run-to-run; those are parameters\rEnd If\r"
  },
  {
    "Variable": "MIGRANTSOUT",
    "UsesVariable": "MIGRATEOUT",
    "Distance": 0,
    "Code": "\rMIGRANTSOUT(R%) = MIGRATEOUT(R%) / 100 * POP(R%)\r"
  },
  {
    "Variable": "MIGRATE",
    "UsesVariable": "MIGRANTS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MIGRATE",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MIGRATE",
    "UsesVariable": "migrater",
    "Distance": 0,
    "Code": "\r\r'dkb 2013/08/22 Change max imigration and pop decline to 6 (for WC migration targets)\r'AbsMigMax = AMAX(1, 6 - 0.1 * IY%) 'Drop max rate to 1% over 50 years\r'AbsPopDec = AMAX(0.5, 6 - 0.1 * IY%) 'Drop max pop decline with migration to .5% over 55 years\r\rFor R% = 1 To NR%\r'jrs 2017/11/06\rIf IY = 1 Then\rsmigrater(R%) = migrater(R%)\rEnd If\rsmigrater(R%) = migrater(R%)\r\rMIGRATE(R%) = migrater(R%) * wmigrm 'swap in exogenous rate\rIf Math.Abs(MIGRATE(R%)) > AbsMigMax Then\rIf MIGRATE(R%) < 0 Then\rMIGRATE(R%) = -AbsMigMax\rElse\rMIGRATE(R%) = AbsMigMax\rEnd If\rEnd If\r'If RegName$(R%) = \"Afghanistan\" Then Stop\r' jrs 2018/01/12 identified the next 3 lines as causing bad behavior in China; bbh removed\r'        If MIGRATE(R%) < 0 AndAlso MIGRATE(R%) + (SCBR(R%) - SCDR(R%)) / 1000 * 100 < -AbsPopDec Then\r'            MIGRATE(R%) = Amin(0, -AbsPopDec - (SCBR(R%) - SCDR(R%)) / 1000 * 100)\r'            'if do not bound, exporters become importers, potentially big ones (China)\r'        End If\r'If RegName$(R%) = \"Afghanistan\" Then Stop\r\rIf MIGRATE(R%) > 0 Then\rSUMIM = SUMIM + MIGRATE(R%) / 100 * POP(R%)\rElse\rSUMEM = SUMEM - MIGRATE(R%) / 100 * POP(R%)\rEnd If\rNext R%\r\r\r'sgh dkb 2013/08/21 Change max immigration and pop decline from 3 to 4\r'AbsMigMax = AMAX(1, 3 - 0.1 * IY%) 'Drop max rate to 1% over 20 years\r'AbsPopDec = AMAX(0.5, 3 - 0.1 * IY%) 'Drop max pop decline with migration to .5% over 25 years\r\r'jrs 2020/06/12 Syria has a Net Migration rate of 6.26% negative, going out\r'AbsMigMax = AMAX(1S, CSng(4 - 0.1 * IY%)) 'Drop max rate to 1% over 30 years\rAbsMigMax = AMAX(1S, CSng(6 - 0.1 * IY%)) 'Drop max rate to 1% over 30 years\r\r\r'dkb 2013/08/22 Change max imigration and pop decline to 6 (for WC migration targets)\r'AbsMigMax = AMAX(1, 6 - 0.1 * IY%) 'Drop max rate to 1% over 50 years\r'AbsPopDec = AMAX(0.5, 6 - 0.1 * IY%) 'Drop max pop decline with migration to .5% over 55 years\r\rFor R% = 1 To NR%\r'jrs 2017/11/06\rIf IY = 1 Then\rsmigrater(R%) = migrater(R%)\rEnd If\rsmigrater(R%) = migrater(R%)\r\rMIGRATE(R%) = migrater(R%) * wmigrm 'swap in exogenous rate\rIf Math.Abs(MIGRATE(R%)) > AbsMigMax Then\rIf MIGRATE(R%) < 0 Then\rMIGRATE(R%) = -AbsMigMax\rElse\rMIGRATE(R%) = AbsMigMax\rEnd If\rEnd If\r'If RegName$(R%) = \"Afghanistan\" Then Stop\r' jrs 2018/01/12 identified the next 3 lines as causing bad behavior in China; bbh removed\r'        If MIGRATE(R%) < 0 AndAlso MIGRATE(R%) + (SCBR(R%) - SCDR(R%)) / 1000 * 100 < -AbsPopDec Then\r'            MIGRATE(R%) = Amin(0, -AbsPopDec - (SCBR(R%) - SCDR(R%)) / 1000 * 100)\r'            'if do not bound, exporters become importers, potentially big ones (China)\r'        End If\r'If RegName$(R%) = \"Afghanistan\" Then Stop\r\rIf MIGRATE(R%) > 0 Then\rSUMIM = SUMIM + MIGRATE(R%) / 100 * POP(R%)\rElse\rSUMEM = SUMEM - MIGRATE(R%) / 100 * POP(R%)\rEnd If\rNext R%\r\r\r'sgh dkb 2013/08/21 Change max immigration and pop decline from 3 to 4\r'AbsMigMax = AMAX(1, 3 - 0.1 * IY%) 'Drop max rate to 1% over 20 years\r'AbsPopDec = AMAX(0.5, 3 - 0.1 * IY%) 'Drop max pop decline with migration to .5% over 25 years\r\r'jrs 2020/06/12 Syria has a Net Migration rate of 6.26% negative, going out\r'AbsMigMax = AMAX(1S, CSng(4 - 0.1 * IY%)) 'Drop max rate to 1% over 30 years\rAbsMigMax = AMAX(1S, CSng(6 - 0.1 * IY%)) 'Drop max rate to 1% over 30 years\r\r\r'dkb 2013/08/22 Change max imigration and pop decline to 6 (for WC migration targets)\r'AbsMigMax = AMAX(1, 6 - 0.1 * IY%) 'Drop max rate to 1% over 50 years\r'AbsPopDec = AMAX(0.5, 6 - 0.1 * IY%) 'Drop max pop decline with migration to .5% over 55 years\r\rFor R% = 1 To NR%\r'jrs 2017/11/06\rIf IY = 1 Then\rsmigrater(R%) = migrater(R%)\rEnd If\rsmigrater(R%) = migrater(R%)\r\rMIGRATE(R%) = migrater(R%) * wmigrm 'swap in exogenous rate\rIf Math.Abs(MIGRATE(R%)) > AbsMigMax Then\rIf MIGRATE(R%) < 0 Then\rMIGRATE(R%) = -AbsMigMax\rElse\rMIGRATE(R%) = AbsMigMax\rEnd If\rEnd If\r'If RegName$(R%) = \"Afghanistan\" Then Stop\r' jrs 2018/01/12 identified the next 3 lines as causing bad behavior in China; bbh removed\r'        If MIGRATE(R%) < 0 AndAlso MIGRATE(R%) + (SCBR(R%) - SCDR(R%)) / 1000 * 100 < -AbsPopDec Then\r'            MIGRATE(R%) = Amin(0, -AbsPopDec - (SCBR(R%) - SCDR(R%)) / 1000 * 100)\r'            'if do not bound, exporters become importers, potentially big ones (China)\r'        End If\r'If RegName$(R%) = \"Afghanistan\" Then Stop\r\rIf MIGRATE(R%) > 0 Then\rSUMIM = SUMIM + MIGRATE(R%) / 100 * POP(R%)\rElse\rSUMEM = SUMEM - MIGRATE(R%) / 100 * POP(R%)\rEnd If\rNext R%\r"
  },
  {
    "Variable": "MIGRATE",
    "UsesVariable": "wmigrm",
    "Distance": 0,
    "Code": "\r\r'dkb 2013/08/22 Change max imigration and pop decline to 6 (for WC migration targets)\r'AbsMigMax = AMAX(1, 6 - 0.1 * IY%) 'Drop max rate to 1% over 50 years\r'AbsPopDec = AMAX(0.5, 6 - 0.1 * IY%) 'Drop max pop decline with migration to .5% over 55 years\r\rFor R% = 1 To NR%\r'jrs 2017/11/06\rIf IY = 1 Then\rsmigrater(R%) = migrater(R%)\rEnd If\rsmigrater(R%) = migrater(R%)\r\rMIGRATE(R%) = migrater(R%) * wmigrm 'swap in exogenous rate\rIf Math.Abs(MIGRATE(R%)) > AbsMigMax Then\rIf MIGRATE(R%) < 0 Then\rMIGRATE(R%) = -AbsMigMax\rElse\rMIGRATE(R%) = AbsMigMax\rEnd If\rEnd If\r'If RegName$(R%) = \"Afghanistan\" Then Stop\r' jrs 2018/01/12 identified the next 3 lines as causing bad behavior in China; bbh removed\r'        If MIGRATE(R%) < 0 AndAlso MIGRATE(R%) + (SCBR(R%) - SCDR(R%)) / 1000 * 100 < -AbsPopDec Then\r'            MIGRATE(R%) = Amin(0, -AbsPopDec - (SCBR(R%) - SCDR(R%)) / 1000 * 100)\r'            'if do not bound, exporters become importers, potentially big ones (China)\r'        End If\r'If RegName$(R%) = \"Afghanistan\" Then Stop\r\rIf MIGRATE(R%) > 0 Then\rSUMIM = SUMIM + MIGRATE(R%) / 100 * POP(R%)\rElse\rSUMEM = SUMEM - MIGRATE(R%) / 100 * POP(R%)\rEnd If\rNext R%\r"
  },
  {
    "Variable": "MIGRATEIN",
    "UsesVariable": "MIGRANTSIN",
    "Distance": 0,
    "Code": "\r\rFor i = 1 To NR\r'If Abs(MIGRANTS(i) - MIGRANTSIN(i) + MIGRANTSOUT(i)) > 0.06 AndAlso IY > 1 Then Stop\rMIGRATEOUT(i) = MIGRANTSOUT(i) / POP(i) * 100\rMIGRATEIN(i) = MIGRANTSIN(i) / POP(i) * 100\rNext i\r"
  },
  {
    "Variable": "MIGRATEIN",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r\rFor i = 1 To NR\r'If Abs(MIGRANTS(i) - MIGRANTSIN(i) + MIGRANTSOUT(i)) > 0.06 AndAlso IY > 1 Then Stop\rMIGRATEOUT(i) = MIGRANTSOUT(i) / POP(i) * 100\rMIGRATEIN(i) = MIGRANTSIN(i) / POP(i) * 100\rNext i\r"
  },
  {
    "Variable": "MIGRATEOUT",
    "UsesVariable": "MIGRANTSOUT",
    "Distance": 0,
    "Code": "\r\rFor i = 1 To NR\r'If Abs(MIGRANTS(i) - MIGRANTSIN(i) + MIGRANTSOUT(i)) > 0.06 AndAlso IY > 1 Then Stop\rMIGRATEOUT(i) = MIGRANTSOUT(i) / POP(i) * 100\rMIGRATEIN(i) = MIGRANTSIN(i) / POP(i) * 100\rNext i\r"
  },
  {
    "Variable": "MIGRATEOUT",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r\rFor i = 1 To NR\r'If Abs(MIGRANTS(i) - MIGRANTSIN(i) + MIGRANTSOUT(i)) > 0.06 AndAlso IY > 1 Then Stop\rMIGRATEOUT(i) = MIGRANTSOUT(i) / POP(i) * 100\rMIGRATEIN(i) = MIGRANTSIN(i) / POP(i) * 100\rNext i\r"
  },
  {
    "Variable": "MIGRATEOUT",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "\r\rFor R% = 1 To NR%\r\r'jrs 2020/05/11\rIf IY = 1 Then\rSMigrateIn(R%) = MIGRATEIN(R%)\rSMigrateOut(R%) = MIGRATEOUT(R%)\rEnd If\r\rSMigrateOut(R%) = MIGRATEOUT(R%)\r"
  },
  {
    "Variable": "migrater",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "\r\r'dkb 2013/08/22 Change max imigration and pop decline to 6 (for WC migration targets)\r'AbsMigMax = AMAX(1, 6 - 0.1 * IY%) 'Drop max rate to 1% over 50 years\r'AbsPopDec = AMAX(0.5, 6 - 0.1 * IY%) 'Drop max pop decline with migration to .5% over 55 years\r\rFor R% = 1 To NR%\r'jrs 2017/11/06\rIf IY = 1 Then\rsmigrater(R%) = migrater(R%)\rEnd If\rsmigrater(R%) = migrater(R%)\r\rMIGRATE(R%) = migrater(R%) * wmigrm 'swap in exogenous rate\rIf Math.Abs(MIGRATE(R%)) > AbsMigMax Then\rIf MIGRATE(R%) < 0 Then\rMIGRATE(R%) = -AbsMigMax\rElse\rMIGRATE(R%) = AbsMigMax\rEnd If\rEnd If\r'If RegName$(R%) = \"Afghanistan\" Then Stop\r' jrs 2018/01/12 identified the next 3 lines as causing bad behavior in China; bbh removed\r'        If MIGRATE(R%) < 0 AndAlso MIGRATE(R%) + (SCBR(R%) - SCDR(R%)) / 1000 * 100 < -AbsPopDec Then\r'            MIGRATE(R%) = Amin(0, -AbsPopDec - (SCBR(R%) - SCDR(R%)) / 1000 * 100)\r'            'if do not bound, exporters become importers, potentially big ones (China)\r'        End If\r'If RegName$(R%) = \"Afghanistan\" Then Stop\r\rIf MIGRATE(R%) > 0 Then\rSUMIM = SUMIM + MIGRATE(R%) / 100 * POP(R%)\rElse\rSUMEM = SUMEM - MIGRATE(R%) / 100 * POP(R%)\rEnd If\rNext R%\r\r\r'dkb 2013/08/22 Change max imigration and pop decline to 6 (for WC migration targets)\r'AbsMigMax = AMAX(1, 6 - 0.1 * IY%) 'Drop max rate to 1% over 50 years\r'AbsPopDec = AMAX(0.5, 6 - 0.1 * IY%) 'Drop max pop decline with migration to .5% over 55 years\r\rFor R% = 1 To NR%\r'jrs 2017/11/06\rIf IY = 1 Then\rsmigrater(R%) = migrater(R%)\rEnd If\rsmigrater(R%) = migrater(R%)\r\rMIGRATE(R%) = migrater(R%) * wmigrm 'swap in exogenous rate\rIf Math.Abs(MIGRATE(R%)) > AbsMigMax Then\rIf MIGRATE(R%) < 0 Then\rMIGRATE(R%) = -AbsMigMax\rElse\rMIGRATE(R%) = AbsMigMax\rEnd If\rEnd If\r'If RegName$(R%) = \"Afghanistan\" Then Stop\r' jrs 2018/01/12 identified the next 3 lines as causing bad behavior in China; bbh removed\r'        If MIGRATE(R%) < 0 AndAlso MIGRATE(R%) + (SCBR(R%) - SCDR(R%)) / 1000 * 100 < -AbsPopDec Then\r'            MIGRATE(R%) = Amin(0, -AbsPopDec - (SCBR(R%) - SCDR(R%)) / 1000 * 100)\r'            'if do not bound, exporters become importers, potentially big ones (China)\r'        End If\r'If RegName$(R%) = \"Afghanistan\" Then Stop\r\rIf MIGRATE(R%) > 0 Then\rSUMIM = SUMIM + MIGRATE(R%) / 100 * POP(R%)\rElse\rSUMEM = SUMEM - MIGRATE(R%) / 100 * POP(R%)\rEnd If\rNext R%\r"
  },
  {
    "Variable": "MILEXPSTOCK",
    "UsesVariable": "GDS",
    "Distance": 0,
    "Code": "\r\r'clp 2022/06/12 ***START*** Calculate monadic mil expenditures stock\rIf IY > 1 Then\rMILEXPSTOCK(R%) = CSng((SMILEXPSTOCK(R%) * 0.9) + sgds(R%, Mil))\rEnd If\r"
  },
  {
    "Variable": "MORTMG",
    "UsesVariable": "GDS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MORTMG",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MORTMG",
    "UsesVariable": "elashc",
    "Distance": 0,
    "Code": "\r\rhealthgdpri(R%) = GDS(R%, Health) / GDP(R%)\r"
  },
  {
    "Variable": "MRPA",
    "UsesVariable": "XRPA",
    "Distance": 9,
    "Code": "\r\r'     All Steps:  Terms of Trade - Exogenous Change\r'     ---------------------------------------------\r\rWX = 0!\r\rWM = 0!\r\r\r'     All Steps:  Terms of Trade - Exogenous Change\r'     ---------------------------------------------\r\rWX = 0!\r\rFor R% = 1 To NR%\rIf GDPPCI(R%) < nsdiv Then\rXRPA(R%) = XRPA(R%) * termtrm\rMRPA(R%) = MRPA(R%) / termtrm\rElse\rXRPA(R%) = XRPA(R%) / termtrm\rMRPA(R%) = MRPA(R%) * termtrm\rEnd If\r'bbh 2021/07/07 start Worked on this, but then moved to end of IFsEcoIntl\r'                 FORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) ' - XWORKEMIT(R%) 'Price adjusted compatible with XDEBTRPA\r'                 'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'                 'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'                    FIRMSAV (R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'                 FORSAV(R%) = M(R%) - X(R%) - AID(R%) ' - XWORKEMIT(R%) 'bbh 2021/07/07\r'                 SAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\r'                 SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'                 If RegName$(R%) = \"Ethiopia\" Then Stop\r'bbh 2021/07/07 end\rWX = WX + XRPA(R%)\rWM = WM + MRPA(R%)\rNext R%\r\rWM = 0!\r\rFor R% = 1 To NR%\rIf GDPPCI(R%) < nsdiv Then\rXRPA(R%) = XRPA(R%) * termtrm\rMRPA(R%) = MRPA(R%) / termtrm\rElse\rXRPA(R%) = XRPA(R%) / termtrm\rMRPA(R%) = MRPA(R%) * termtrm\rEnd If\r'bbh 2021/07/07 start Worked on this, but then moved to end of IFsEcoIntl\r'                 FORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) ' - XWORKEMIT(R%) 'Price adjusted compatible with XDEBTRPA\r'                 'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'                 'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'                    FIRMSAV (R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'                 FORSAV(R%) = M(R%) - X(R%) - AID(R%) ' - XWORKEMIT(R%) 'bbh 2021/07/07\r'                 SAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\r'                 SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'                 If RegName$(R%) = \"Ethiopia\" Then Stop\r'bbh 2021/07/07 end\rWX = WX + XRPA(R%)\rWM = WM + MRPA(R%)\rNext R%\r\rWM = 0!\r\r\r'     All Steps:  Relative-price Adjusted Trade and Payments Balances\r'     ---------------------------------------------------------------\rWX = AMAX(0.01, WX)\r\rWM = AMAX(0.01, WM)\r\rWM = 0!\r\rFor R% = 1 To NR%\rIf GDPPCI(R%) < nsdiv Then\rXRPA(R%) = XRPA(R%) * termtrm\rMRPA(R%) = MRPA(R%) / termtrm\rElse\rXRPA(R%) = XRPA(R%) / termtrm\rMRPA(R%) = MRPA(R%) * termtrm\rEnd If\r'bbh 2021/07/07 start Worked on this, but then moved to end of IFsEcoIntl\r'                 FORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) ' - XWORKEMIT(R%) 'Price adjusted compatible with XDEBTRPA\r'                 'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'                 'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'                    FIRMSAV (R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'                 FORSAV(R%) = M(R%) - X(R%) - AID(R%) ' - XWORKEMIT(R%) 'bbh 2021/07/07\r'                 SAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\r'                 SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'                 If RegName$(R%) = \"Ethiopia\" Then Stop\r'bbh 2021/07/07 end\rWX = WX + XRPA(R%)\rWM = WM + MRPA(R%)\rNext R%\r\rWT = (WM + WX) / 2\r\rWM = AMAX(0.01, WM)\r\rFor R% = 1 To NR%\rXRPA(R%) = XRPA(R%) / AMAX(0.01, WX) * WT\rMRPA(R%) = MRPA(R%) / AMAX(0.01, WM) * WT\r'TRADEBAL(R%) = XRPA(R%) - MRPA(R%)\rTRADEBAL(R%) = X(R%) - M(R%) 'bbh 2021/07/07\rSExRate(R%) = EXRATE(R%)\r'jrs 2014/04/11\r'             SX(R%) = X(R%)\r'             SM(R%) = M(R%)\rIf IY% > 1 Then\raidlp(R%) = AMAX(0, Amin(1, AIDLPI(R%) * aidlpm))\rEnd If\rIf AID(R%) > 0 Then 'Recipients\rSumAid = SumAid + AID(R%)\rSumAidLP = SumAidLP + AID(R%) * aidlp(R%)\rEnd If\rNext R%\r"
  },
  {
    "Variable": "MRPA",
    "UsesVariable": "termtrm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MRPA",
    "UsesVariable": "nsdiv",
    "Distance": 0,
    "Code": "\rGDPPCI(R%) = GDPPC(R%)\r"
  },
  {
    "Variable": "MRPA",
    "UsesVariable": "GDPPC",
    "Distance": 243,
    "Code": "\rGDPPCI(R%) = GDPPC(R%)\r"
  },
  {
    "Variable": "MRPA",
    "UsesVariable": "MS",
    "Distance": 0,
    "Code": "\r\rPublic Sub IFsEcoIntl1AllYears(context As IForecastContext)\r'jrs 2014/09/16\rDim S As Integer, WX As Single, WM As Single, WT As Single, SumAid As Single, SumAidLP As Single\r\r'jrs 2014/04/11 *** using IFUN to avoid repeating calculation in IFUN = 3\r'If IFUN = 2 Then\rFor R% = 1 To NR%\r'         X(R%) = 0!\r'         M(R%) = 0!\rXRPA(R%) = 0\rMRPA(R%) = 0\r\r'     All Steps:  Trade and Relative Price-Adjusted Trade\r'     ---------------------------------------------------\r\rFor S% = 1 To NSec%\r'            X(R%) = X(R%) + XS(R%, S%)\r'            M(R%) = M(R%) + MS(R%, S%)\rXRPA(R%) = XRPA(R%) + XS(R%, S%) * WP(S%) '* PRI(r%, s%) * EXRATE(r%)\rMRPA(R%) = MRPA(R%) + MS(R%, S%) * WP(S%)\r\rNext S%\rNext R%\r"
  },
  {
    "Variable": "MRPA",
    "UsesVariable": "WP",
    "Distance": 0,
    "Code": "\r\rPublic Sub IFsEcoIntl1AllYears(context As IForecastContext)\r'jrs 2014/09/16\rDim S As Integer, WX As Single, WM As Single, WT As Single, SumAid As Single, SumAidLP As Single\r\r'jrs 2014/04/11 *** using IFUN to avoid repeating calculation in IFUN = 3\r'If IFUN = 2 Then\rFor R% = 1 To NR%\r'         X(R%) = 0!\r'         M(R%) = 0!\rXRPA(R%) = 0\rMRPA(R%) = 0\r\r'     All Steps:  Trade and Relative Price-Adjusted Trade\r'     ---------------------------------------------------\r\rFor S% = 1 To NSec%\r'            X(R%) = X(R%) + XS(R%, S%)\r'            M(R%) = M(R%) + MS(R%, S%)\rXRPA(R%) = XRPA(R%) + XS(R%, S%) * WP(S%) '* PRI(r%, s%) * EXRATE(r%)\rMRPA(R%) = MRPA(R%) + MS(R%, S%) * WP(S%)\r\rNext S%\rNext R%\r"
  },
  {
    "Variable": "MS",
    "UsesVariable": "bilateraltradeforwardlinksw",
    "Distance": 0,
    "Code": "\rPrivate Sub AdjustXSMS()\rDim i As Integer, j As Integer, k As Integer, TotVal As Single\r'Exports\rFor i = 1 To NR\rFor k = 1 To NSec\rTotVal = 0\rIf TotVal > 0 Then 'jrs 2017/01/12\rXS(i, k) = (1 - bilateraltradeforwardlinksw) * XS(i, k) + bilateraltradeforwardlinksw * TotVal / 1000000000\rEnd If\rNext k\rNext i\r'Imports\rFor i = 1 To NR\rFor k = 1 To NSec\rTotVal = 0\rIf TotVal > 0 Then 'jrs 2017/01/12\rMS(i, k) = (1 - bilateraltradeforwardlinksw) * MS(i, k) + bilateraltradeforwardlinksw * TotVal / 1000000000\rEnd If\rNext k\rNext i\rEnd Sub\r"
  },
  {
    "Variable": "MS",
    "UsesVariable": "msm",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "gdprext",
    "Distance": 27,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "xsm",
    "Distance": 9,
    "Code": "\r'                MulSwing = AMAX(0.1, 1 - sxkav(R%, S%) * 3)\r'                Mul = AMAX(1 - MulSwing, Amin(1 + MulSwing, Mul))\r\rxc(R%, S%) = xbase * Mul\r\r'bbh 2021/09/21 Possible for prices elsewhere to pull exports out of countries also facing shortages\r'                If SST(R%, S%) / (StBase(R%, S%) * dstl) < 0.5 Then xc(R%, S%) = xc(R%, S%) - 0.2 * (StBase(R%, S%) * dstl - SST(R%, S%))\r'bbh 2022/10/27 Above was commented out; reactivated concept below with two lines but with slower impact and with focus on getting rid of extra stocks or shortages of them\r'Stock shortages can exist, e,g. in Sudan services toward 2100, because early surge of ag imports causes debt build up, EXRATE fall, and long export rise\r'EXRATE is focused on overall trade surplus or deficit and next lines are focused on sector-specific surplus or deficit\r'The line improved Sudan XDEBT/GDP a bit, service stocks quite a bit, and price index globally,\r'but Burundi XDebt up a bit and Hong Kong with a bit of oscillation; commented again but should keep concept in mind.\r'Perhaps a stock related PID multiplier to supplement the price-based one, affecting both XS and MS would be a good idea\r'                If SST(R%, S%) / (StBase(R%, S%) * dstl) > 1.4 Then xc(R%, S%) = Amin(1.1 * xc(R%, S%), xc(R%, S%) + 0.2 * (SST(R%, S%) - StBase(R%, S%) * dstl))\r'                If SST(R%, S%) / (StBase(R%, S%) * dstl) < 0.6 Then xc(R%, S%) = AMAX(0.9 * xc(R%, S%), xc(R%, S%) - 0.2 * (StBase(R%, S%) * dstl - SST(R%, S%)))\r\rIf xc(R%, S%) < 0.0001 Then xc(R%, S%) = 0.0001\r\r'If RegName$(R%) = \"Nigeria\" And S% = 4 Then Stop\r'if spri*EXRATE rises relative to mpric (WP), should raise imports; so if iniital tariffs are higher than saved, should do same\r'above price difference is local price minus price of imported good where an appreciated exchange rate cheapens imports,\r'and a swing in import tariff rates relative to the first year raises (higher tariffs) or lowers import prices\r'SMTariffTaxR(R%, S%) = MTARIFFTAXR(R%, S%) 'did consider SMTARIFFTAXR rather than iMTARIFFTAXR, see note further down\r'bbh 2019/10/15 end\r\rIf pridiff > 50 Then\rMul = 1.8 'even if local prices are extremely much higher, limit increase in imports to 80%\rElse\rDiff1 = pridiff * elastrpr(R%, S%)\rDiff2 = (Diff1 - mprclag(R%, S%)) * elastrpr(R%, S%)\r'Diff2 = (Diff1 - mprclag(R%, S%)) * elastrpr(R%, S%) * 2 'bbh 2022/12/20 moving PID second-order to 2* first order parameter\rmprclag(R%, S%) = CSng(0.4 * (spri(R%, S%) * EXRATE(R%) - mpric) +\r                                                0.6 * mprclag(R%, S%))\r'mprclag(R%, S%) = Diff1 'bbh 2022/12/20 Changed 2nd order term to be normal PID approach\r'bbh note: It might be good to change line above to my added comment below so as to pass through the tariff rate change to the lagged\r'import price.  But there is messiness here in the relationship between absolute changes (pridiff) and lagged and smoothed changes\r'(mprclag) and (SMKAV below); an expericment with lagged treatment of pridiff using SMTARIFFTAXR instead of iMTARIFFTAXR basically\r'washed out import changes with tariff changes; need ongoing impact relative to initial levels\r' mprclag(R%, S%) = 0.4 * (pridiff) + 0.6 * mprclag(R%, S%)\r\rCall ADJSTR(PriBase, Diff1, Diff2, elmpr1adj, elmpr2adj, Mul)\rIf S% = 6 Then Mul = CSng(Mul ^ 0.5) 'bbh 2022/12/20\rEnd If\r\r'   b) if import share of demand base is very low, allow more potential annual change in import pattern\rDim mulswing = AMAX(mulswingpar, 1 - smkav(R%, S%) * 3)\r\r'dbase = (CS(R%, S%) + GS(R%, S%) + INVS(R%, S%) + zsp(R%, S%)) * MulInc\rIf gdprext(R%) < -99 Then 'endogenous 'bbh 2022/09/05 added if-then-else block for line above\rdbase = (CS(R%, S%) + GS(R%, S%) + INVS(R%, S%) + zsp(R%, S%)) * MulInc\rElse 'exogenous\rdbase = (CS(R%, S%) + GS(R%, S%) + INVS(R%, S%) + ZS(R%, S%)) * MulInc 'allow ZS to drive when highly volatile\rEnd If\r\rsmkav(R%, S%) = AMAX(0.0001, mkav(R%, S%))\r"
  },
  {
    "Variable": "MS",
    "UsesVariable": "CS",
    "Distance": 31,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "GS",
    "Distance": 31,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "INVS",
    "Distance": 31,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "ZS",
    "Distance": 31,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "ST",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "dstl",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "PRI",
    "Distance": 23,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "EXRATE",
    "Distance": 23,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "MTARIFFTAXR",
    "Distance": 23,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "XS",
    "Distance": 48,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "xshift",
    "Distance": 48,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "elasxinc",
    "Distance": 49,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "GDPPOT",
    "Distance": 100,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "elastrpr",
    "Distance": 21,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "elmpr1",
    "Distance": 41,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "elmpr2",
    "Distance": 40,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "bilateralsw",
    "Distance": 1293,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "WP",
    "Distance": 24,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "protecm",
    "Distance": 24,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "GDP",
    "Distance": 1803,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "XTARIFFTAXR",
    "Distance": 46,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "elxpr1",
    "Distance": 43,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "elxpr2",
    "Distance": 42,
    "Code": "0"
  },
  {
    "Variable": "MS",
    "UsesVariable": "AGMVALUE",
    "Distance": 0,
    "Code": "\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\r'    WTRA = (WX + WM) / 2\rFor f% = 1 To 3\rDim WTRA = (WX(f%) + WM(f%)) / 2\rFor R% = 1 To NR%\r'             XS(R%, 1) = XS(R%, 1) * WTRA / AMAX(WX, 0.001)\r'             MS(R%, 1) = MS(R%, 1) * WTRA / AMAX(WM, 0.001)\rAGMVALUE(R%, f%) = CSng(AGMVALUE(R%, f%) * WTRA / AMAX(WM(f%), 0.001))\rAGXVALUE(R%, f%) = CSng(AGXVALUE(R%, f%) * WTRA / AMAX(WX(f%), 0.001))\rMS(R%, 1) = MS(R%, 1) + AGMVALUE(R%, f%)\rXS(R%, 1) = XS(R%, 1) + AGXVALUE(R%, f%)\rNext R%\rNext f%\r"
  },
  {
    "Variable": "MS",
    "UsesVariable": "ENM",
    "Distance": 0,
    "Code": "\rMS(R%, Ener) = ENM(R%) * iwepbyear 'ENPRII(R%) 'currency already in energy model\rCOMPLETE STRUCTURE:Next R%:3589|\r\rFor R% = 1 To NR%\r'sgh and dsr 2015/07/24 xsf and msf now have second dimension\r'        XS(R%, 1) = xsf(R%) * (AGX(R%, 1) * swapi(1) + AGX(R%, 2) * swapi(2) + AGX(R%, 3) * swapi(3))\r'        MS(R%, 1) = msf(R%) * (AGM(R%, 1) * swapi(1) + AGM(R%, 2) * swapi(2) + AGM(R%, 3) * swapi(3))\r'dsr 2015/07/29 Add code to calculate trade values by commodity\rMS(R%, 1) = 0\r"
  },
  {
    "Variable": "MS",
    "UsesVariable": "WEPBYEAR",
    "Distance": 414,
    "Code": "\riwepbyear = WEPBYEAR\r"
  },
  {
    "Variable": "MTARIFFREV",
    "UsesVariable": "MTARIFFTAXR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MTARIFFREV",
    "UsesVariable": "MS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MTARIFFREV",
    "UsesVariable": "bilateralsw",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MTARIFFTAXR",
    "UsesVariable": "MTARIFFREV",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MTARIFFTAXR",
    "UsesVariable": "MS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MTARIFFTAXR",
    "UsesVariable": "mtarifftaxrm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "MTARIFFTAXR",
    "UsesVariable": "bilateralsw",
    "Distance": 1756,
    "Code": "\r\rPublic Sub ifsECOSAM2FirstYear(context As IForecastContext)\r\r'**********************\r'mti 2020/02/28 start\r'   First Year 2:  Poverty by Age-Sex\r'   ----------------------------------\rIFsEcoPovAgeSexFirstYear()\r'mti 2020/02/28 End\r\r'mti 2021/01/29 Start\rIFsEcoPovAgeSex32FirstYear()\rIFsEcoPovAgeSex55FirstYear()\r'mti 2021/01/29 End\r\r'jrs 2022/11/22 start\rIFsEcoPovAgeSex365FirstYear()\rIFsEcoPovAgeSex685FirstYear()\r'jrs 2022/11/22 end\r\r'mti 2021/07/15 start\rIFsEcoPovAgeSexNPLFirstYear()\r'mti 2021/07/15 End\r\r'Y1Call2:\rFor R% = 1 To NR%\r'bbh 2019/10/15 start\r'   First Year 2:  Tariff revenue shift from Dyadic calcuation\r'   ----------------------------------------------------------\rIf bilateralsw > 0 Then\r'SMTariffRevTotDyadic(R%) = 0 'bbh 2019/10/25\rFor S% = 1 To NSec%\r'SMTariffRevTotDyadic(R%) = SMTariffRevTotDyadic(R%) + MTARIFFREV(R%, S%) 'bbh 2019/10/25\rMTariffRevShift(R%, S%) = MTARIFFREV(R%, S%) - SMTariffRev(R%, S%)\r\rMTARIFFREV(R%, S%) = MTARIFFREV(R%, S%) - MTariffRevShift(R%, S%) 'dkb 2019/10/22\rMTARIFFTAXR(R%, S%) = MTARIFFREV(R%, S%) / AMAX(0.001, MS(R%, S%)) * 100 'bbh 2019/10/24\riMTariffTaxR(R%, S%) = MTARIFFTAXR(R%, S%) 'bbh 2019/10/24\rNext S%\rXTARIFFREV(R%, S%) = 0\rNext S%\rEnd If\r"
  },
  {
    "Variable": "NEONATMOR",
    "UsesVariable": "INFMOR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "NEONATMOR",
    "UsesVariable": "neonatmorm",
    "Distance": 0,
    "Code": "\r\r'    If RegName(R%) = \"Kosovo\" Then Stop\r\rNEONATMORBase = CSng(Amin(INFMOR(R%) * 0.9, AMAX(INFMOR(R%) * 0.2, CalNeoNatMor + ConvergeOverTime(NeoNatMorshift(R%), 0, ConvTime))))\r"
  },
  {
    "Variable": "NPOW",
    "UsesVariable": "drnpow",
    "Distance": 0,
    "Code": "\r\r'kbn 2018/02/16 Start Drug model below\rCall ComputeDrugs(context)\r'kbn 2018/02/16 end\r\r\r'   All but First 1:  Power:  Conventional and Nuclear\r'   ------------------------------------------------\r\rFor R% = 1 To NR%\rNPOW(R%) = SNPOW(R%) * (1 - drnpow) + GDS(R%, Mil) * nmilf(R%) * npowf\r'Note:  This is inconsistent with specification in preprocessor\r' (.002 billion/warhead)\r'and results in sharp decline in arsenals; result right, but wrong reasons\rcpowf(R%) = cpowldcf - (cpowldcf - 1) * Amin(10, GDPPC(R%)) / 10 'as in preprocessor\rCPOW(R%) = SCPOW(R%) * (1 - drcpow) + GDS(R%, Mil) * (1 - nmilf(R%)) * cpowf(R%)\rNPOW(R%) = AMAX(0, Amin(NPOW(R%), 100000))\rCPOW(R%) = AMAX(0, Amin(CPOW(R%), 100000))\r'bbh 2011/08/18\rGOVNUCWP(R%) = GOVNUCWP(R%) + govnucwpadd(R%)\rGOVNUCWP(R%) = AMAX(0, Amin(GOVNUCWP(R%), 900000))\r'bbh 2011/08/18 end\r'jrs 2011/10/11\rSGOVNUCWP(R%) = GOVNUCWP(R%)\rNext R%\r\r\r'kbn 2018/02/16 Start Drug model below\rCall ComputeDrugs(context)\r'kbn 2018/02/16 end\r\r\r'   All but First 1:  Power:  Conventional and Nuclear\r'   ------------------------------------------------\r\rFor R% = 1 To NR%\rNPOW(R%) = SNPOW(R%) * (1 - drnpow) + GDS(R%, Mil) * nmilf(R%) * npowf\r'Note:  This is inconsistent with specification in preprocessor\r' (.002 billion/warhead)\r'and results in sharp decline in arsenals; result right, but wrong reasons\rcpowf(R%) = cpowldcf - (cpowldcf - 1) * Amin(10, GDPPC(R%)) / 10 'as in preprocessor\rCPOW(R%) = SCPOW(R%) * (1 - drcpow) + GDS(R%, Mil) * (1 - nmilf(R%)) * cpowf(R%)\rNPOW(R%) = AMAX(0, Amin(NPOW(R%), 100000))\rCPOW(R%) = AMAX(0, Amin(CPOW(R%), 100000))\r'bbh 2011/08/18\rGOVNUCWP(R%) = GOVNUCWP(R%) + govnucwpadd(R%)\rGOVNUCWP(R%) = AMAX(0, Amin(GOVNUCWP(R%), 900000))\r'bbh 2011/08/18 end\r'jrs 2011/10/11\rSGOVNUCWP(R%) = GOVNUCWP(R%)\rNext R%\r"
  },
  {
    "Variable": "NPOW",
    "UsesVariable": "GDS",
    "Distance": 0,
    "Code": "\r\r'kbn 2018/02/16 Start Drug model below\rCall ComputeDrugs(context)\r'kbn 2018/02/16 end\r\r\r'   All but First 1:  Power:  Conventional and Nuclear\r'   ------------------------------------------------\r\rFor R% = 1 To NR%\rNPOW(R%) = SNPOW(R%) * (1 - drnpow) + GDS(R%, Mil) * nmilf(R%) * npowf\r'Note:  This is inconsistent with specification in preprocessor\r' (.002 billion/warhead)\r'and results in sharp decline in arsenals; result right, but wrong reasons\rcpowf(R%) = cpowldcf - (cpowldcf - 1) * Amin(10, GDPPC(R%)) / 10 'as in preprocessor\rCPOW(R%) = SCPOW(R%) * (1 - drcpow) + GDS(R%, Mil) * (1 - nmilf(R%)) * cpowf(R%)\rNPOW(R%) = AMAX(0, Amin(NPOW(R%), 100000))\rCPOW(R%) = AMAX(0, Amin(CPOW(R%), 100000))\r'bbh 2011/08/18\rGOVNUCWP(R%) = GOVNUCWP(R%) + govnucwpadd(R%)\rGOVNUCWP(R%) = AMAX(0, Amin(GOVNUCWP(R%), 900000))\r'bbh 2011/08/18 end\r'jrs 2011/10/11\rSGOVNUCWP(R%) = GOVNUCWP(R%)\rNext R%\r"
  },
  {
    "Variable": "NPOW",
    "UsesVariable": "nmilf",
    "Distance": 0,
    "Code": "\r\r'kbn 2018/02/16 Start Drug model below\rCall ComputeDrugs(context)\r'kbn 2018/02/16 end\r\r\r'   All but First 1:  Power:  Conventional and Nuclear\r'   ------------------------------------------------\r\rFor R% = 1 To NR%\rNPOW(R%) = SNPOW(R%) * (1 - drnpow) + GDS(R%, Mil) * nmilf(R%) * npowf\r'Note:  This is inconsistent with specification in preprocessor\r' (.002 billion/warhead)\r'and results in sharp decline in arsenals; result right, but wrong reasons\rcpowf(R%) = cpowldcf - (cpowldcf - 1) * Amin(10, GDPPC(R%)) / 10 'as in preprocessor\rCPOW(R%) = SCPOW(R%) * (1 - drcpow) + GDS(R%, Mil) * (1 - nmilf(R%)) * cpowf(R%)\rNPOW(R%) = AMAX(0, Amin(NPOW(R%), 100000))\rCPOW(R%) = AMAX(0, Amin(CPOW(R%), 100000))\r'bbh 2011/08/18\rGOVNUCWP(R%) = GOVNUCWP(R%) + govnucwpadd(R%)\rGOVNUCWP(R%) = AMAX(0, Amin(GOVNUCWP(R%), 900000))\r'bbh 2011/08/18 end\r'jrs 2011/10/11\rSGOVNUCWP(R%) = GOVNUCWP(R%)\rNext R%\r"
  },
  {
    "Variable": "NPOW",
    "UsesVariable": "npowf",
    "Distance": 0,
    "Code": "\r\r'kbn 2018/02/16 Start Drug model below\rCall ComputeDrugs(context)\r'kbn 2018/02/16 end\r\r\r'   All but First 1:  Power:  Conventional and Nuclear\r'   ------------------------------------------------\r\rFor R% = 1 To NR%\rNPOW(R%) = SNPOW(R%) * (1 - drnpow) + GDS(R%, Mil) * nmilf(R%) * npowf\r'Note:  This is inconsistent with specification in preprocessor\r' (.002 billion/warhead)\r'and results in sharp decline in arsenals; result right, but wrong reasons\rcpowf(R%) = cpowldcf - (cpowldcf - 1) * Amin(10, GDPPC(R%)) / 10 'as in preprocessor\rCPOW(R%) = SCPOW(R%) * (1 - drcpow) + GDS(R%, Mil) * (1 - nmilf(R%)) * cpowf(R%)\rNPOW(R%) = AMAX(0, Amin(NPOW(R%), 100000))\rCPOW(R%) = AMAX(0, Amin(CPOW(R%), 100000))\r'bbh 2011/08/18\rGOVNUCWP(R%) = GOVNUCWP(R%) + govnucwpadd(R%)\rGOVNUCWP(R%) = AMAX(0, Amin(GOVNUCWP(R%), 900000))\r'bbh 2011/08/18 end\r'jrs 2011/10/11\rSGOVNUCWP(R%) = GOVNUCWP(R%)\rNext R%\r"
  },
  {
    "Variable": "NPOW",
    "UsesVariable": "nwarsv",
    "Distance": 3,
    "Code": "\rFor tar% = 1 To NR%\rIf CWAR(act%, tar%) > 0.5 Then 'Conventional war with target, add damage\rConvDAM = cwarsv * CPOW(tar%)\rCIVDM(act%) = CIVDM(act%) + ConvDAM / AMAX(0.01, GDP(act%)) * cdmf\rCPOWDM(act%) = CPOWDM(act%) + ConvDAM * cpowdf\rEnd If\rIf NWAR(act%, tar%) > 0.5 Then 'Nuclear war with target, add damage\rNuclDam = CSng(1.0! - 0.5 ^ ((NPOW(tar%) * nwarsv / 1000) ^ elndpow))\rCIVDM(act%) = CIVDM(act%) + NuclDam\rCPOWDM(act%) = CPOWDM(act%) + NuclDam\rNPOWDM(act%) = nwarsv * NPOW(act%)\rEnd If\rNext tar%\r\rSNPOW(act%) = SNPOW(act%) - NPOWDM(act%)\r"
  },
  {
    "Variable": "NPOW",
    "UsesVariable": "NWAR",
    "Distance": 3,
    "Code": "\rFor tar% = 1 To NR%\rIf CWAR(act%, tar%) > 0.5 Then 'Conventional war with target, add damage\rConvDAM = cwarsv * CPOW(tar%)\rCIVDM(act%) = CIVDM(act%) + ConvDAM / AMAX(0.01, GDP(act%)) * cdmf\rCPOWDM(act%) = CPOWDM(act%) + ConvDAM * cpowdf\rEnd If\rIf NWAR(act%, tar%) > 0.5 Then 'Nuclear war with target, add damage\rNuclDam = CSng(1.0! - 0.5 ^ ((NPOW(tar%) * nwarsv / 1000) ^ elndpow))\rCIVDM(act%) = CIVDM(act%) + NuclDam\rCPOWDM(act%) = CPOWDM(act%) + NuclDam\rNPOWDM(act%) = nwarsv * NPOW(act%)\rEnd If\rNext tar%\r"
  },
  {
    "Variable": "NSGAPA",
    "UsesVariable": "GDP",
    "Distance": 33,
    "Code": "0"
  },
  {
    "Variable": "NSGAPA",
    "UsesVariable": "POP",
    "Distance": 34,
    "Code": "0"
  },
  {
    "Variable": "NSGAPA",
    "UsesVariable": "nsdiv",
    "Distance": 31,
    "Code": "\rGDPPCI(R%) = GDPPC(R%)\r"
  },
  {
    "Variable": "NSGAPA",
    "UsesVariable": "GDPPC",
    "Distance": 342,
    "Code": "\rPSO = 0!\r"
  },
  {
    "Variable": "NSGAPR",
    "UsesVariable": "GDP",
    "Distance": 32,
    "Code": "0"
  },
  {
    "Variable": "NSGAPR",
    "UsesVariable": "POP",
    "Distance": 33,
    "Code": "0"
  },
  {
    "Variable": "NSGAPR",
    "UsesVariable": "nsdiv",
    "Distance": 30,
    "Code": "\rGDPPCI(R%) = GDPPC(R%)\r"
  },
  {
    "Variable": "NSGAPR",
    "UsesVariable": "GDPPC",
    "Distance": 341,
    "Code": "\rPSO = 0!\r"
  },
  {
    "Variable": "NSGAPRTB",
    "UsesVariable": "GDPPOT",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "NSGAPRTB",
    "UsesVariable": "POP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "NSGAPRTB",
    "UsesVariable": "WPOP",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "NSNARAT",
    "UsesVariable": "nsnaratm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "NSNARAT",
    "UsesVariable": "INCOMELT200CS2005",
    "Distance": 2229,
    "Code": "0"
  },
  {
    "Variable": "NSNARAT",
    "UsesVariable": "POP",
    "Distance": 2229,
    "Code": "0"
  },
  {
    "Variable": "NSNARAT",
    "UsesVariable": "C",
    "Distance": 2222,
    "Code": "0"
  },
  {
    "Variable": "NSNARAT",
    "UsesVariable": "PPPCONV",
    "Distance": 2222,
    "Code": "0"
  },
  {
    "Variable": "NSNARAT",
    "UsesVariable": "GINIDOM",
    "Distance": 2226,
    "Code": "0"
  },
  {
    "Variable": "NSNARAT",
    "UsesVariable": "INCOMELT215LN",
    "Distance": 2243,
    "Code": "0"
  },
  {
    "Variable": "NSNARAT",
    "UsesVariable": "INCOMELT125CS2005",
    "Distance": 8,
    "Code": "\r\r'   First Year:  Back-calculate Mean of Consumption for Log Normal $1\r'   -----------------------------------------------------------------\rportionpoor = CSng(Amin(0.99, INCOMELT125CS2005(R%) / AMAX(0.0001, POP(R%))))\r\r'jrs 2008/07/17\r'        If portionpoor < 0.001 Then\r'            NSNARAT(R%) = -1 'jrs 2008/07/17\r'        Else\r\r'mti Sept 04, 2009 -start\rNInv = CalcNormalInverse(portionpoor)\r"
  },
  {
    "Variable": "NSPQLI",
    "UsesVariable": "POP",
    "Distance": 113,
    "Code": "0"
  },
  {
    "Variable": "NSPQLI",
    "UsesVariable": "PQLI",
    "Distance": 113,
    "Code": "0"
  },
  {
    "Variable": "NSPQLI",
    "UsesVariable": "nsdiv",
    "Distance": 111,
    "Code": "\rIf IY% = 1 Then GDPPCI(R%) = GDPPC(R%)\r"
  },
  {
    "Variable": "NSPQLI",
    "UsesVariable": "GDPPC",
    "Distance": 638,
    "Code": "\rPSO = 0!\r"
  },
  {
    "Variable": "NUMNWP",
    "UsesVariable": "mfpconv",
    "Distance": 1,
    "Code": "\r'Call XYTABL(\"GDP/Capita (PPP) Versus Internet Percent Use (2000)\", _\r'Amin(40, GDPPCP(R%)), NetComp)\rnetcompnum = CSng(AMAX(0, nwplimfunc * POP(R%)))\r\r\rConvTar = ConvergeOverTime(NUMNWP(R%), netcompnum, mfpconv(R%))\r\r'Base, Target, Years\rNUMNWP(R%) = CSng(Amin(NUMNWP(R%) * 1.5, ConvTar))\r\rnumnwpmin(R%) = NUMNWP(R%)\r\rnumnwpmin(R%) = AMAX(numnwpmin(R%), NUMNWP(R%)) 'Don't let decline\r\r'mti 2023/05/04 start\r'NUMNWP(R%) = Amin(numnwpmin(R%), nwplimfunc * POP(R%))\rNUMNWP(R%) = AMAX(numnwpmin(R%), NUMNWP(R%))\r"
  },
  {
    "Variable": "NUMNWP",
    "UsesVariable": "POP",
    "Distance": 2,
    "Code": "\rnwplimfunc = nwplimfunc / 100\r"
  },
  {
    "Variable": "NUMNWP",
    "UsesVariable": "GDPPCP",
    "Distance": 10,
    "Code": "COMPLETE STRUCTURE:Next R%:1467|\r\r'kbn 2018/04/27 END\r'All but First 1:  Networked Person Calculations\r'   ---------------------------------------------\r\rFor R% = 1 To NR%\r\r'If RegName$(R%) = \"Somalia\" Then Stop\r\rCall XYTABL(\"GDP/Capita (PPP) Versus Internet Percent Use Target\", Amin(40, GDPPCP(R%)), nwplimfunc, context)\r"
  },
  {
    "Variable": "NUMNWP",
    "UsesVariable": "NUMNWPGR",
    "Distance": 0,
    "Code": "\rNUMNWP(R%) = snumnwp(R%) * (1 + NUMNWPGR(R%) / 100)\r"
  },
  {
    "Variable": "NUMNWPGR",
    "UsesVariable": "NUMNWP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "NUMNWPGR",
    "UsesVariable": "POP",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "NUMNWPGR",
    "UsesVariable": "GDPPCP",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "NUMNWPGR",
    "UsesVariable": "numnwpgrm",
    "Distance": 0,
    "Code": "\rinumnwpgr(R%) = NUMNWPGR(R%)\r\r'nwplim = numnwplim * POP(R%)\rNUMNWPGR(R%) = CSng(inumnwpgr(R%) * numnwpgrm(R%) *\r                    (AMAX(0.01, (nwplim - snumnwp(R%)) / (nwplim - INUMNWP(R%)))) ^ 3)  ' 2\r\rNUMNWPGR(R%) = Amin(NUMNWPGR(R%), 200) 'bbh 2016/03/11\r"
  },
  {
    "Variable": "NWARPB",
    "UsesVariable": "NPOW",
    "Distance": 0,
    "Code": "\rIf NPOW(act%) < 1 And NPOW(tar%) < 1 Then NWARPB(act%, tar%) = 0\r"
  },
  {
    "Variable": "NWARPB",
    "UsesVariable": "CWAR",
    "Distance": 0,
    "Code": "\rNWARPB(act%, tar%) = CWAR(act%, tar%) * cwarsv * nwarf * 100  'Nuclear War Prob\r"
  },
  {
    "Variable": "NWARPB",
    "UsesVariable": "cwarsv",
    "Distance": 0,
    "Code": "\rNWARPB(act%, tar%) = CWAR(act%, tar%) * cwarsv * nwarf * 100  'Nuclear War Prob\r"
  },
  {
    "Variable": "NWARPB",
    "UsesVariable": "nwarf",
    "Distance": 0,
    "Code": "\rNWARPB(act%, tar%) = CWAR(act%, tar%) * cwarsv * nwarf * 100  'Nuclear War Prob\r"
  },
  {
    "Variable": "OILGPR",
    "UsesVariable": "WENP",
    "Distance": 0,
    "Code": "\rOILGPR = CSng((WENP(Oil) + WENP(Gas)) / AMAX(TWENP, 0.001))\r"
  },
  {
    "Variable": "OILGPR",
    "UsesVariable": "ENP",
    "Distance": 2,
    "Code": "\rDim TWENP = 0!\r\rFor e% = 1 To Renew  'Oil, gas, coal, hydro, nuclear, renewable\rWENP(e%) = 0!\rFor R% = 1 To NR%\rWENP(e%) = WENP(e%) + ENP(R%, e%)\rTWENP = TWENP + ENP(R%, e%)\rNext R%\rSWENP(e%) = CSng(0.8 * SWENP(e%) + 0.2 * WENP(e%))\rNext e%\r"
  },
  {
    "Variable": "PCONGREAT",
    "UsesVariable": "POWERHH",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "PCONGREAT",
    "UsesVariable": "wpgreatlev",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "PCONGREAT",
    "UsesVariable": "POWER",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "PCONGREATEU",
    "UsesVariable": "POWERHH",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "PCONGREATEU",
    "UsesVariable": "wpgreatlev",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "PCONGREATEU",
    "UsesVariable": "eumembsw",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "PCONGREATEU",
    "UsesVariable": "POWER",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "PCONGREATEUF",
    "UsesVariable": "POWERHH",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "PCONGREATEUF",
    "UsesVariable": "wpgreatlev",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "PCONGREATEUF",
    "UsesVariable": "eumembsw",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "PCONGREATEUF",
    "UsesVariable": "wpgreatthresh",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "PCONGREATEUF",
    "UsesVariable": "POWER",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "PCONGREATF",
    "UsesVariable": "POWERHH",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "PCONGREATF",
    "UsesVariable": "wpgreatlev",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "PCONGREATF",
    "UsesVariable": "wpgreatthresh",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "PCONGREATF",
    "UsesVariable": "POWER",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "PCONSYS",
    "UsesVariable": "POWERHH",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "PCONSYS",
    "UsesVariable": "POWER",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "PERSCON",
    "UsesVariable": "INFRATELE",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "PERSCON",
    "UsesVariable": "WPOP",
    "Distance": 818,
    "Code": "0"
  },
  {
    "Variable": "PERSCON",
    "UsesVariable": "POP",
    "Distance": 820,
    "Code": "0"
  },
  {
    "Variable": "PERSCON",
    "UsesVariable": "XWORKREMIT",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "PERSCON",
    "UsesVariable": "GDPPOT",
    "Distance": 2,
    "Code": "\rSumGlobal = 0\r"
  },
  {
    "Variable": "PERSCON",
    "UsesVariable": "WGDP",
    "Distance": 819,
    "Code": "0"
  },
  {
    "Variable": "PERSCON",
    "UsesVariable": "GDP",
    "Distance": 2,
    "Code": "\rSumGlobal = 0\r"
  },
  {
    "Variable": "PFD",
    "UsesVariable": "ZS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "PFD",
    "UsesVariable": "FDEM",
    "Distance": 1812,
    "Code": "0"
  },
  {
    "Variable": "PFD",
    "UsesVariable": "FEDDEM",
    "Distance": 1812,
    "Code": "0"
  },
  {
    "Variable": "PFD",
    "UsesVariable": "FMDEM",
    "Distance": 1812,
    "Code": "0"
  },
  {
    "Variable": "PFD",
    "UsesVariable": "INDEM",
    "Distance": 1812,
    "Code": "0"
  },
  {
    "Variable": "PFD",
    "UsesVariable": "inputictm",
    "Distance": 84,
    "Code": "0"
  },
  {
    "Variable": "PFD",
    "UsesVariable": "inputservm",
    "Distance": 85,
    "Code": "0"
  },
  {
    "Variable": "PFD",
    "UsesVariable": "inputmanum",
    "Distance": 86,
    "Code": "0"
  },
  {
    "Variable": "PFD",
    "UsesVariable": "inputmatem",
    "Distance": 87,
    "Code": "0"
  },
  {
    "Variable": "PFD",
    "UsesVariable": "inputenerm",
    "Distance": 88,
    "Code": "0"
  },
  {
    "Variable": "PFD",
    "UsesVariable": "inputagrim",
    "Distance": 89,
    "Code": "0"
  },
  {
    "Variable": "PFD",
    "UsesVariable": "ENRGDP",
    "Distance": 91,
    "Code": "0"
  },
  {
    "Variable": "PFD",
    "UsesVariable": "GDPPC",
    "Distance": 1606,
    "Code": "0"
  },
  {
    "Variable": "POP",
    "UsesVariable": "BIRTHS",
    "Distance": 639,
    "Code": "0"
  },
  {
    "Variable": "POP",
    "UsesVariable": "birthmshr",
    "Distance": 1215,
    "Code": "0"
  },
  {
    "Variable": "POP",
    "UsesVariable": "tmortr2",
    "Distance": 567,
    "Code": "0"
  },
  {
    "Variable": "POP",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "\r'    wpop1550 = 0\r'    hivratechk = 0\rFor R% = 1 To NR% 'temporary computation of Pop\rIf IY% > 1 Then\rPOP(R%) = 0!\rFor j% = 1 To NCohorts\rPOP(R%) = CSng(POP(R%) + agedst(j%, R%, 1) + agedst(j%, R%, 2))\rNext j%\rPOP(R%) = AMAX(0.001, POP(R%))\rEnd If\rNext R%\r\rIf IY% > 1 Then POP(R%) = 0!\r\rFor j% = 1 To NCohorts\rIf IY% > 1 Then POP(R%) = CSng(POP(R%) + agedst(j%, R%, 1) + agedst(j%, R%, 2))\r'jrs 2012/09/03\r'If Not IsNull(clage(j%)) Then\rCLNEED(R%) = CSng(CLNEED(R%) +\r                    (agedst(j%, R%, 1) + agedst(j%, R%, 2)) * clage(j%) * clnf(R%))\r'jrs 2012/10/30\r'Else\r'    j% = NCohorts\r'End If\rNext j%\r\r'mti LifeExp/ gender May 2006 -end\r\r'jrs 2007/09/04\r'jrs 2009/05/22 Dim mfactorMCohort As Integer, mfactorFCohort As Integer\rDim mFactorM As Single, mFactorF As Single\r\r'jrs 2009/05/22\r'Explained by Randall Kuhn\r'Life Expectancy was computed as the median age at death,\r'and it should be computed as a mean\r'average number of years of life given the survival rates in each age group\r\r'jrs 2007/09/04\r'mfactor for Males\r'        mortinfants = BasMordst(0, R%, 1)\r'        cumMort = mortinfants  'Infant Mortality\r'        CumLif = 0\r'\r'        For j% = 1 To NCohorts\r'            MortCohort = BasMordst(j%, R%, 1)\r'            cohMort = MortCohort\r'\r'            If CumLif + 5 < LIFEXP(R%, 1) Then\r'                cumMort = cumMort + cohMort * 5 'Five year cohorts\r'                CumLif = CumLif + 5\r'            Else\r'                Dif = LIFEXP(R%, 1) - CumLif\r'                cumMort = cumMort + cohMort * Dif\r'                CumLif = CumLif + Dif\r'                mfactorMCohort = j\r'                Exit For\r'            End If\r'        Next j%\r'        mFactorM = 0.5 / cumMort  '.5 represents 50% chance of dying younger,\r'jrs 2019/05/06 maxfactor from 6 to 14 for Iran historical\rmFactorM = matchMortWLifeExp(BasMordst, R, 1, LIFEXP(R, 1), 0, 14, bCancelMsgMatchMortLE) 'jrs 2016/11/01 change the max factor from 6 to 7\r\r'If RegName$(R%) = \"China\" Then Stop\r\r\r'   All Years 2:  Compute a multiplier (mfactor) to adjust mortality by cohort to life expectancy\r'   ---------------------------------------------------------------------------------------------\r'jrs 2009/05/22\r'Explained by Randall Kuhn\r'Life Expectancy was computed as the median age at death,\r'and it should be computed as a mean\r'average number of years of life given the survival rates in each age group\r\r'mfactor for Males\r'-----------------\r'jrs 2009/05/22\r'        mortinfants = mordst(0, R%, 1)\r'        cumMort = mortinfants '* fdeath(R%) '* mortmul 'Infant Mortality\r'        CumLif = 0\r'        For j% = 1 To NCohorts\r'            MortCohort = mordst(j%, R%, 1)\r'            cohMort = MortCohort '* fdeath(R%)\r'\r'            If CumLif + 5 < LIFEXP(R%, 1) Then\r'                cumMort = cumMort + cohMort * 5 'Five year cohorts\r'                CumLif = CumLif + 5\r'            Else\r'                Dif = LIFEXP(R%, 1) - CumLif\r'                cumMort = cumMort + cohMort * Dif\r'                CumLif = CumLif + Dif\r'                'jrs 2007/09/04\r'                mfactorMCohort = j\r'                Exit For\r'            End If\r'        Next j%\r'        mFactorM = 0.5 / cumMort  '.5 represents 50% chance of dying younger,\r'jrs 2019/05/06 maxfactor from 7 to 14 for Maldives historical\rmFactorM = matchMortWLifeExp(mordst, R, 1, LIFEXP(R, 1), 0, 14, bCancelMsgMatchMortLE)  'jrs 2016/11/01 change the max factor from 6 to 7\r\r\r'mfactor for FeMales\r'        mortinfants = BasMordst(0, R%, 2)\r'        cumMort = mortinfants  'Infant Mortality\r'        CumLif = 0\r'\r'        For j% = 1 To NCohorts\r'            MortCohort = BasMordst(j%, R%, 2)\r'            cohMort = MortCohort\r'\r'            If CumLif + 5 < LIFEXP(R%, 2) Then\r'                cumMort = cumMort + cohMort * 5 'Five year cohorts\r'                CumLif = CumLif + 5\r'            Else\r'                Dif = LIFEXP(R%, 2) - CumLif\r'                cumMort = cumMort + cohMort * Dif\r'                CumLif = CumLif + Dif\r'                mfactorFCohort = j\r'                Exit For\r'            End If\r'        Next j%\r'        mFactorF = 0.5 / cumMort  '.5 represents 50% chance of dying younger,\r'jrs 2019/05/06 maxfactor from 6 to 16 for Iran historical\rmFactorF = matchMortWLifeExp(BasMordst, R, 2, LIFEXP(R, 2), 0, 16, bCancelMsgMatchMortLE) 'jrs 2016/11/01 change the max factor from 6 to 7\r\r\r' and 50% change of dying older; hence life expectancy at birth\r\r'mfactor for Females\r'-------------------\r'jrs 2009/05/22\r'        mortinfants = mordst(0, R%, 2)\r'        cumMort = mortinfants '* fdeath(R%) '* mortmul 'Infant Mortality\r'        CumLif = 0\r'        For j% = 1 To NCohorts\r'            MortCohort = mordst(j%, R%, 2)\r'            cohMort = MortCohort '* fdeath(R%)\r'\r'            If CumLif + 5 < LIFEXP(R%, 2) Then\r'                cumMort = cumMort + cohMort * 5 'Five year cohorts\r'                CumLif = CumLif + 5\r'            Else\r'                Dif = LIFEXP(R%, 2) - CumLif\r'                cumMort = cumMort + cohMort * Dif\r'                CumLif = CumLif + Dif\r'                'jrs 2007/09/04\r'                mfactorFCohort = j\r'                Exit For\r'            End If\r'        Next j%\r'        mFactorF = 0.5 / cumMort  '.5 represents 50% chance of dying younger,\r' and 50% change of dying older; hence life expectancy at birth\r\r'jrs 2019/05/06 maxfactor from 7 to 16 for Maldives historical\rmFactorF = matchMortWLifeExp(mordst, R, 2, LIFEXP(R, 2), 0, 16, bCancelMsgMatchMortLE)  'jrs 2016/11/01 change the max factor from 6 to 7\r\rGDPPCPI(R%) = GDPPCP(R%)\r"
  },
  {
    "Variable": "POP0TO5",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POP15ANDABOVE",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POP15TO65",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POP15TO65",
    "UsesVariable": "POPLE15",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POP15TO65",
    "UsesVariable": "POPGT65",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POP25ANDABOVE",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r'mti 2022/11/25 end\r\r'mti 2023/05/30 start\rFor gend% = 1 To 2\rPOP15ANDABOVE(R%, gend%) = CSng(agedst(4, R%, gend%))\rPOP25ANDABOVE(R%, gend%) = 0\rFor j% = 5 To NCohorts\rPOP15ANDABOVE(R%, gend%) = CSng(POP15ANDABOVE(R%, gend%) + agedst(j, R%, gend%))\rPOP25ANDABOVE(R%, gend%) = CSng(POP25ANDABOVE(R%, gend%) + agedst(j, R%, gend%))\rNext j\rNext gend%\r\rPOP25ANDABOVE(R%, 3) = POP25ANDABOVE(R%, 1) + POP25ANDABOVE(R%, 2)\r"
  },
  {
    "Variable": "POPEDPRI",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POPEDPRIGRAD",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\rCase seclowrstart1\rPOPEDPRIGRAD(R%, gndr%) = CSng(POPEDPRIGRAD(R%, gndr%) + fagedst(CohNo, R, gndr%))\r"
  },
  {
    "Variable": "POPEDPRIINT",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:Next CohNo:9046|COMPLETE STRUCTURE:End Select:9046|\r\r\rFor CohNo = 1 To 100 'NCohorts 'edpristart1(R%) To edpristart1(R%) + edprilen(R%) - 1\r\rSelect Case CohNo\rCase pristart1\rPOPEDPRIINT(R%, gndr%) = CSng(POPEDPRIINT(R%, gndr%) + fagedst(CohNo, R, gndr%))\r"
  },
  {
    "Variable": "POPEDSECLOWR",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POPEDSECLOWRGRAD",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\rCase secupprstart1\rPOPEDSECLOWRGRAD(R%, gndr%) = CSng(POPEDSECLOWRGRAD(R%, gndr%) + fagedst(CohNo, R, gndr%))\r"
  },
  {
    "Variable": "POPEDSECUPPR",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POPEDSECUPPRGRAD",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\rCase terstart1\rPOPEDSECUPPRGRAD(R%, gndr%) = CSng(POPEDSECUPPRGRAD(R%, gndr%) + fagedst(CohNo, R, gndr%))\r"
  },
  {
    "Variable": "POPEDTER",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POPEDTERGRAD",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\rCase terstart1 + terlen1\rPOPEDTERGRAD(R%, gndr%) = CSng(POPEDTERGRAD(R%, gndr%) + fagedst(CohNo, R, gndr%))\rCase Else\r\r\r\r\r\r\r\r\r\r"
  },
  {
    "Variable": "POPFEM15TO24",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r\r'mti 2022/11/25 start\rPOPFEM15TO24(R%) = CSng(agedst(4, R%, Female) + agedst(5, R%, Female))\r"
  },
  {
    "Variable": "POPFOREIGN",
    "UsesVariable": "POPFOREIGNIN",
    "Distance": 0,
    "Code": "\r\r'SPopForeign(R%) = POPFOREIGN(R%) * (1 - SCDR(R%) / 1000) + MIGRANTS(R%)\rSPopForeign(R%) = SPopForeignIn(R%) - SPopForeignOut(R%)\r'bbh 2022/06/23 In DataEcon PopForeign is computed as the net of POPFOREIGNIN and POPFOREIGNOUT, so reasonable to do the same here\r'Not used for computation of remitances now and is tally of whether country is net recipient or sender of migrants\r"
  },
  {
    "Variable": "POPFOREIGN",
    "UsesVariable": "POPFOREIGNOUT",
    "Distance": 0,
    "Code": "\r\r'SPopForeign(R%) = POPFOREIGN(R%) * (1 - SCDR(R%) / 1000) + MIGRANTS(R%)\rSPopForeign(R%) = SPopForeignIn(R%) - SPopForeignOut(R%)\r'bbh 2022/06/23 In DataEcon PopForeign is computed as the net of POPFOREIGNIN and POPFOREIGNOUT, so reasonable to do the same here\r'Not used for computation of remitances now and is tally of whether country is net recipient or sender of migrants\r"
  },
  {
    "Variable": "POPFOREIGNIN",
    "UsesVariable": "POPFOREIGNOUT",
    "Distance": 1,
    "Code": "\rPopForInRatio = SPopForeignIn(R%) / POP(R%)\r\rReturnOfImmigrants = Amin(PopForInRatio * SPopForeignOut(R%), Amin(PopForInRatio * POP(R%), MIGRANTSOUT(R%) * SPopForeignIn(R%) / POP(R%)))\r\r'ReturnOfImmigrants = Amin(0.5 * SPopForeignOut(R%), Amin(0.5 * POP(R%), MIGRANTSOUT(R%) * SPopForeignIn(R%) / POP(R%)))\r'If RegName$(R%) = \"Kuwait\" And IY% + 2016 = 2090 Then Stop\r'bbh 2022/06/03 Computed and used this because outmigration should consist of native and foreign born; in the absence\r'of info about the relative propensity to leave (probably in many countries most are temporary workers going home),setting\r'proportion of returnees as proportion of foreign born, which is probably conservative in GCC and most outmigraton should be of former immigrants\rSPopForeignIn(R%) = SPopForeignIn(R%) - ReturnOfImmigrants\r\r'jrs 2018/03/16\rPOPFOREIGNOUT(i) = POPFOREIGNOUT(i) + DYADPOPFOREIGN(i, j) / 1000000\rPOPFOREIGNIN(j) = POPFOREIGNIN(j) + DYADPOPFOREIGN(i, j) / 1000000\r'jrs 2018/04/03\rSPopForeignIn(j) = POPFOREIGNIN(j)\rNext j\rNext i\r\r\rFor i = 1 To NR\rMIGRANTSFORCEDOUT(i) = MIGRANTSFORCEDOUT(i) / 1000000\r'jrs 2018/03/16\rPOPFOREIGNOUT(i) = POPFOREIGNOUT(i) + DYADPOPFOREIGN(i, j) / 1000000\r'If Single.IsNaN(DYADPOPFOREIGN(i, j)) Then Stop\rPOPFOREIGNIN(j) = POPFOREIGNIN(j) + DYADPOPFOREIGN(i, j) / 1000000\r'jrs 2018/04/03\rSPopForeignIn(j) = POPFOREIGNIN(j)\rNext j\rNext i\r\r\rCatch ex As Exception\r\rEnd Try\r\r"
  },
  {
    "Variable": "POPFOREIGNIN",
    "UsesVariable": "POP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "POPFOREIGNIN",
    "UsesVariable": "MIGRANTSOUT",
    "Distance": 1,
    "Code": "\rPopForInRatio = SPopForeignIn(R%) / POP(R%)\r"
  },
  {
    "Variable": "POPFOREIGNIN",
    "UsesVariable": "CDR",
    "Distance": 0,
    "Code": "\r\rSPopForeignIn(R%) = POPFOREIGNIN(R%) * (1 - SCDR(R%) / 1000) + MIGRANTSIN(R%)\r"
  },
  {
    "Variable": "POPFOREIGNIN",
    "UsesVariable": "MIGRANTSIN",
    "Distance": 0,
    "Code": "\r\rSPopForeignIn(R%) = POPFOREIGNIN(R%) * (1 - SCDR(R%) / 1000) + MIGRANTSIN(R%)\r"
  },
  {
    "Variable": "POPFOREIGNOUT",
    "UsesVariable": "CDR",
    "Distance": 0,
    "Code": "\rSPopForeignOut(R%) = POPFOREIGNOUT(R%) * (1 - SCDR(R%) / 1000) + (MIGRANTSOUT(R%) - ReturnOfImmigrants)\r"
  },
  {
    "Variable": "POPFOREIGNOUT",
    "UsesVariable": "MIGRANTSOUT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POPFOREIGNOUT",
    "UsesVariable": "POP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "POPFOREIGNOUT",
    "UsesVariable": "POPFOREIGNIN",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "POPGT65",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POPLE15",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POPMEDAGE",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POPPREWORK",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POPR",
    "UsesVariable": "CBR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POPR",
    "UsesVariable": "CDR",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POPR",
    "UsesVariable": "MIGRATE",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POPRETIRED",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POPRURAL",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POPRURAL",
    "UsesVariable": "POPURBAN",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POPURBAN",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POPURBAN",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POPURBAN",
    "UsesVariable": "LANDAREA",
    "Distance": 183,
    "Code": "0"
  },
  {
    "Variable": "POPURBAN",
    "UsesVariable": "POPR",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "POPURBAN",
    "UsesVariable": "POPURBGR",
    "Distance": 873,
    "Code": "0"
  },
  {
    "Variable": "POPURBAN",
    "UsesVariable": "migrater",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "POPURBGR",
    "UsesVariable": "POPURBAN",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POPWORKING",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\rPOPWORKING(R%) = CSng(Math.Round(POP(R%) - POPPREWORK(R%) - POPRETIRED(R%), 6))\r"
  },
  {
    "Variable": "POPWORKING",
    "UsesVariable": "POPPREWORK",
    "Distance": 0,
    "Code": "\rPOPWORKING(R%) = CSng(Math.Round(POP(R%) - POPPREWORK(R%) - POPRETIRED(R%), 6))\r"
  },
  {
    "Variable": "POPWORKING",
    "UsesVariable": "POPRETIRED",
    "Distance": 0,
    "Code": "\rPOPWORKING(R%) = CSng(Math.Round(POP(R%) - POPPREWORK(R%) - POPRETIRED(R%), 6))\r"
  },
  {
    "Variable": "POTSUPRAT",
    "UsesVariable": "POPWORKING",
    "Distance": 0,
    "Code": "\r'jrs 2013/04/12 POTSUPRAT(R%) = POP15TO65(R%) / AMAX(POPGT65(R%), 0.001)\rPOTSUPRAT(R%) = CSng(POPWORKING(R%) / AMAX(POPRETIRED(R%), 0.001))\r"
  },
  {
    "Variable": "POTSUPRAT",
    "UsesVariable": "POPRETIRED",
    "Distance": 0,
    "Code": "\r'jrs 2013/04/12 POTSUPRAT(R%) = POP15TO65(R%) / AMAX(POPGT65(R%), 0.001)\rPOTSUPRAT(R%) = CSng(POPWORKING(R%) / AMAX(POPRETIRED(R%), 0.001))\r"
  },
  {
    "Variable": "POVCOUNT",
    "UsesVariable": "POVRATE",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POVCOUNT",
    "UsesVariable": "POPPOVAG",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POVGAP",
    "UsesVariable": "INCOMELT190LN",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "POVGAP",
    "UsesVariable": "POP",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "POVGAP",
    "UsesVariable": "GINIDOM",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVGAP",
    "UsesVariable": "INCOMELT215LN",
    "Distance": 2395,
    "Code": "0"
  },
  {
    "Variable": "POVGNDRATIO",
    "UsesVariable": "POVRATE",
    "Distance": 0,
    "Code": "\rPOVGNDRATIO(R%, TotPovAGCount) = POVRATE(R%, TotPovAGCount, Female) / POVRATE(R%, TotPovAGCount, Male)\r"
  },
  {
    "Variable": "POVGNDRATIO",
    "UsesVariable": "POVCOUNT",
    "Distance": 2,
    "Code": "\rNormTot = 0\r\rNormTot = NormTot + POVCOUNT(R%, j%, Total) 'POVRATE(R%, j%, Total) * POPPOVAG(R%, j%, Total) / 100\r\rNext\r\rIf NormTot = 0 Then\rFor j% = 1 To TotPovAGCount\rFor gndr% = 1 To NGender\rPOVCOUNT(R%, j%, gndr%) = 0\rNext\rPOVGNDRATIO(R%, j%) = 1\rNext\rExit Sub\rEnd If\r"
  },
  {
    "Variable": "povnational",
    "UsesVariable": "povagesexdynamic",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "povnational",
    "UsesVariable": "C",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "povnational",
    "UsesVariable": "POP",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "povnational",
    "UsesVariable": "GINIDOM",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "povnational",
    "UsesVariable": "PPPCONV",
    "Distance": 2240,
    "Code": "0"
  },
  {
    "Variable": "povnational",
    "UsesVariable": "INCOMELT215LN",
    "Distance": 2288,
    "Code": "0"
  },
  {
    "Variable": "povnational",
    "UsesVariable": "INCOMELT310LN",
    "Distance": 2228,
    "Code": "0"
  },
  {
    "Variable": "povnational",
    "UsesVariable": "INCOMELT190LN",
    "Distance": 2279,
    "Code": "\r\r'jrs 2015/11/18 *** begin ***\r'        'jrs 2014/05/20 *** begin ***\r'        meanconsumption11 = AMAX(0.0001, C(R%) * RatioGDP2011to2005GDP(R%) / AMAX(0.0001, POP(R%)) * PPPCONV(R%))\r'        LNMean11 = Log(meanconsumption11 * NSNARAT(R%) * 1000) _\r'            - 0.5 * (lnstddev ^ 2)\r'\r'        'bbh 2014/10/18 start\r'        'Prediction = CalcLogNormalCDF(365 * incpovlev, LNMean11, lnstddev)  'no multiplier\r'        Prediction = CalcLogNormalCDF(365 * incpovlev * RatioGDP2011to2005GDPUSA1, LNMean11, lnstddev)\r'        INCOMELT190LN(R%) = AMAX(0, Amin(0.9 * POP(R%), Prediction * POP(R%)))\r'        'Compute INCOMELT0.7LN2011\r'        'Prediction = CalcLogNormalCDF(255.5, LNMean11, lnstddev)  'no multiplier\r'        Prediction = CalcLogNormalCDF(255.5 * RatioGDP2011to2005GDPUSA07, LNMean11, lnstddev)  'no multiplier\r'        INCOMELT110LN(R%) = AMAX(0, Amin(0.9 * POP(R%), Prediction * POP(R%)))\r'        'bbh 2014/10/18 end\r'        'jrs 2014/05/20 *** end ***\r\r'       First Year:  Back-calculate Mean of Consumption for Log Normal $1.9 ($2011)\r'       --------------------------------------------------------------------------\rportionpoor = CSng(Amin(0.99, INCOMELT190LN(R%) / AMAX(0.0001, POP(R%))))\r"
  },
  {
    "Variable": "POVRATE",
    "UsesVariable": "dyadtarifffundsw",
    "Distance": 0,
    "Code": "\r\r\r'Compute gender difference (and poverty rate) in other age-groups using changes in reference group gender difference\rFor j% = 1 To TotPovAGCount\r\rIf j% <> RefAGGnd Then\r\rIf POVRATE(R%, j%, Total) = 0 Then\rPOVRATE(R%, j%, Male) = 0\rPOVRATE(R%, j%, Female) = 0\rElse\r\r'mti 2021/07/15 start\rIf iPovGndDiffAG(R%, RefAGGnd) <> 0 And Abs(iPovGndDiffAG(R%, RefAGGnd)) > 0.9 Then ' changed .2 to .9\r'mti 2021/07/15 end\rPovGndDiffAG = iPovGndDiffAG(R%, j%) + PcntChangeDiffRefAG * iPovGndDiffAG(R%, j%)\rElse\rPovGndDiffAG = iPovGndDiffAG(R%, j%) + PcntPointChangeDiffRefAG\rEnd If\r\r'Prevent the gender difference from being too large compared to total poverty and zeroing out poverty in one of the sexes\rIf PovGndDiffAG >= 0 Then\rPovGndDiffAG = CSng(Amin(PovGndDiffAG, 1.5 * POVRATE(R%, j, Total)))\rElse\rPovGndDiffAG = CSng(AMAX(PovGndDiffAG, -1.5 * POVRATE(R%, j, Total)))\rEnd If\r\rPOVRATE(R%, j%, Male) = AMAX(0, (POVRATE(R%, j%, Total) * POPPOVAG(R%, j%, Total) - PovGndDiffAG * POPPOVAG(R%, j%, Female)) / POPPOVAG(R%, j%, Total))\rPOVRATE(R%, j%, Female) = AMAX(0, PovGndDiffAG + POVRATE(R%, j%, Male))\r'\r'Make sure there is at least some poverty in each gender\r'mti 2020/04/29 Start\r'POVRATE(R%, j%, Male) = AMAX(0, (POVRATE(R%, j%, Total) * POPPOVAG(R%, j%, Total) - PovGndDiffAG * POPPOVAG(R%, j%, Female)) / POPPOVAG(R%, j%, Total))\rPOVRATE(R%, j%, Male) = AMAX(0, (POVRATE(R%, j%, Total) * POPPOVAG(R%, j%, Total) - PovGndDiffAG * POPPOVAG(R%, j%, Female)) / AMAX(0.000001, POPPOVAG(R%, j%, Total)))\r'mti 2020/04/29 End\rPOVRATE(R%, j%, Female) = AMAX(POVRATE(R%, j%, Male) * 0.2, POVRATE(R%, j%, Female))\r\r\rEnd If\r\r\r\rEnd If\r\rNext j%\r'mti 2020/03/18 End\r\r'Normalize poverty across sexes within the same age group\r'mti 2021/12/28 start\rPovertyNormalizeGender(R%, POVRATE, POVCOUNT, POVGNDRATIO)\rIFsEcoPovBroadAG(R%, POV15PCT, POV25PCT, POVCOUNT, agEnd)\r'mti 2021/12/28 End\r\r\r"
  },
  {
    "Variable": "POVRATE",
    "UsesVariable": "POPPOVAG",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POVRATE",
    "UsesVariable": "GINIDOM",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE",
    "UsesVariable": "POPLE15",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE",
    "UsesVariable": "POP",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE",
    "UsesVariable": "LABWAGESEXRAT",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE",
    "UsesVariable": "EDYRSAG15",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE",
    "UsesVariable": "GDPPCP",
    "Distance": 0,
    "Code": "\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG(R%, j%) * povagesexagratnat\rPOVRATE(R%, j%, Total) = AMAX(0, Amin(100, POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'mti 2020/11/10 start\r'POVRATE(R%, j%, Total) = POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE(R%, j%, Total) = AMAX(0, Amin(100, POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r'mti 2020/11/10 start\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r'mti 2020/11/10 End\rEnd If\r\rFor j% = 1 To TotPovAGCount\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG(R%, j%) + IncTrgtCovd * (CSng(PovRateRatioToRefAG_Trgt(j%)) - iPovRateRatioToRefAG(R%, j%))  'AMAX(0, (can be in both direction)\r\r'mti 2020/11/10 start\r'POVRATE(R%, j%, Total) = POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE(R%, j%, Total) = AMAX(0, Amin(100, POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r'mti 2020/11/10 End\rNext\rEnd If\r'mti 2021/12/28 start\rEnd If\r\r\r'Aggregate population to poverty age groups\rAggagedstflex(agStart, agEnd, POPPOVAG) ' agedstpov\rReDim POPPOVAGD(NR, 11, 3)\rAggagedstflex(agStart, agEnd, POPPOVAGD)\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG(R%, j%) * povagesexagratnat\rPOVRATE(R%, j%, Total) = AMAX(0, Amin(100, POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'mti 2020/11/10 start\r'POVRATE(R%, j%, Total) = POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE(R%, j%, Total) = AMAX(0, Amin(100, POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r'mti 2020/11/10 start\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r'mti 2020/11/10 End\rEnd If\r\rFor j% = 1 To TotPovAGCount\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG(R%, j%) + IncTrgtCovd * (CSng(PovRateRatioToRefAG_Trgt(j%)) - iPovRateRatioToRefAG(R%, j%))  'AMAX(0, (can be in both direction)\r\r'mti 2020/11/10 start\r'POVRATE(R%, j%, Total) = POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE(R%, j%, Total) = AMAX(0, Amin(100, POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r'mti 2020/11/10 End\rNext\rEnd If\r'mti 2021/12/28 start\rEnd If\r\r\r'Aggregate population to poverty age groups\rAggagedstflex(agStart, agEnd, POPPOVAG) ' agedstpov\rReDim POPPOVAGD(NR, 11, 3)\rAggagedstflex(agStart, agEnd, POPPOVAGD)\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r\rFor j% = 1 To TotPovAGCount\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATE(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAG(R%, j%) = POVRATE(R%, j%, Total) / POVRATE(R%, RefAGTot, Total)  'could also use iPovRatioNational(R%)\rEnd If\r\r'mti 2020/03/18 Start\r'Save initial gender difference for all age groups\riPovGndDiffAG(R%, j%) = POVRATE(R%, j%, Female) - POVRATE(R%, j%, Male)\r'mti 2020/03/18 End\rNext\r\r'\rNext R%\r\r\r'Aggregate population to poverty age groups\rAggagedstflex(agStart, agEnd, POPPOVAG) ' agedstpov\rReDim POPPOVAGD(NR, 11, 3)\rAggagedstflex(agStart, agEnd, POPPOVAGD)\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG(R%, j%) * povagesexagratnat\rPOVRATE(R%, j%, Total) = AMAX(0, Amin(100, POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'mti 2020/11/10 start\r'POVRATE(R%, j%, Total) = POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE(R%, j%, Total) = AMAX(0, Amin(100, POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r'mti 2020/11/10 start\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r'mti 2020/11/10 End\rEnd If\r\rFor j% = 1 To TotPovAGCount\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG(R%, j%) + IncTrgtCovd * (CSng(PovRateRatioToRefAG_Trgt(j%)) - iPovRateRatioToRefAG(R%, j%))  'AMAX(0, (can be in both direction)\r\r'mti 2020/11/10 start\r'POVRATE(R%, j%, Total) = POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE(R%, j%, Total) = AMAX(0, Amin(100, POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r'mti 2020/11/10 End\rNext\rEnd If\r'mti 2021/12/28 start\rEnd If\r\r\r\rFor j% = 1 To TotPovAGCount\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATE(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAG(R%, j%) = POVRATE(R%, j%, Total) / POVRATE(R%, RefAGTot, Total)  'could also use iPovRatioNational(R%)\rEnd If\r\r'mti 2020/03/18 Start\r'Save initial gender difference for all age groups\riPovGndDiffAG(R%, j%) = POVRATE(R%, j%, Female) - POVRATE(R%, j%, Male)\r'mti 2020/03/18 End\rNext\r\r'\rNext R%\rCOMPLETE STRUCTURE:Next R%:7588|\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG(R%, j%) * povagesexagratnat\rPOVRATE(R%, j%, Total) = AMAX(0, Amin(100, POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'mti 2020/11/10 start\r'POVRATE(R%, j%, Total) = POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE(R%, j%, Total) = AMAX(0, Amin(100, POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r'mti 2020/11/10 start\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r'mti 2020/11/10 End\rEnd If\r\rFor j% = 1 To TotPovAGCount\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG(R%, j%) + IncTrgtCovd * (CSng(PovRateRatioToRefAG_Trgt(j%)) - iPovRateRatioToRefAG(R%, j%))  'AMAX(0, (can be in both direction)\r\r'mti 2020/11/10 start\r'POVRATE(R%, j%, Total) = POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE(R%, j%, Total) = AMAX(0, Amin(100, POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r'mti 2020/11/10 End\rNext\rEnd If\r'mti 2021/12/28 start\rEnd If\r\r\r'Aggregate population to poverty age groups\rAggagedstflex(agStart, agEnd, POPPOVAG) ' agedstpov\rReDim POPPOVAGD(NR, 11, 3)\rAggagedstflex(agStart, agEnd, POPPOVAGD)\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG(R%, j%) * povagesexagratnat\rPOVRATE(R%, j%, Total) = AMAX(0, Amin(100, POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'mti 2020/11/10 start\r'POVRATE(R%, j%, Total) = POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE(R%, j%, Total) = AMAX(0, Amin(100, POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r'mti 2020/11/10 start\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r'mti 2020/11/10 End\rEnd If\r\rFor j% = 1 To TotPovAGCount\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG(R%, j%) + IncTrgtCovd * (CSng(PovRateRatioToRefAG_Trgt(j%)) - iPovRateRatioToRefAG(R%, j%))  'AMAX(0, (can be in both direction)\r\r'mti 2020/11/10 start\r'POVRATE(R%, j%, Total) = POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE(R%, j%, Total) = AMAX(0, Amin(100, POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r'mti 2020/11/10 End\rNext\rEnd If\r'mti 2021/12/28 start\rEnd If\r\r\r'mti 2020/03/18 Start\r'use gender gap and total (both sexes) poverty to compute female and male poverty rates - reference age group\rIf POVRATE(R%, RefAGGnd, Total) = 0 Then\rPOVRATE(R%, RefAGGnd, Male) = 0\rPOVRATE(R%, RefAGGnd, Female) = 0\rElse\r\r'           'For gender distribution of very low poverty make sure there is some poverty in each of the sexes\rIf PovGndDiffRefAG >= 0 Then\rPovGndDiffRefAG = CSng(Amin(PovGndDiffRefAG, 1.5 * POVRATE(R%, RefAGGnd, Total))) '1.5\r\rElse\rPovGndDiffRefAG = CSng(AMAX(PovGndDiffRefAG, -1.5 * POVRATE(R%, RefAGGnd, Total)))  '-1.5\rEnd If\r\r'Use gender difference and total poverty to compute poverty rates for each of the sexes\r'mti 2020/04/29 Start\r'POVRATE(R%, RefAGGnd, Male) = AMAX(0, (POVRATE(R%, RefAGGnd, Total) * POPPOVAG(R%, RefAGGnd, Total) - PovGndDiffRefAG * POPPOVAG(R%, RefAGGnd, Female)) / POPPOVAG(R%, RefAGGnd, Total))\rPOVRATE(R%, RefAGGnd, Male) = AMAX(0, (POVRATE(R%, RefAGGnd, Total) * POPPOVAG(R%, RefAGGnd, Total) - PovGndDiffRefAG * POPPOVAG(R%, RefAGGnd, Female)) / AMAX(0.000001, POPPOVAG(R%, RefAGGnd, Total)))\r'mti 2020/04/29 End\rPOVRATE(R%, RefAGGnd, Female) = AMAX(0, PovGndDiffRefAG + POVRATE(R%, RefAGGnd, Male))\r\r'            'once again, make sure there is at least some poverty in each gender\rPOVRATE(R%, RefAGGnd, Male) = AMAX(POVRATE(R%, RefAGGnd, Female) * 0.2, POVRATE(R%, RefAGGnd, Male))\rPOVRATE(R%, RefAGGnd, Female) = AMAX(POVRATE(R%, RefAGGnd, Male) * 0.2, POVRATE(R%, RefAGGnd, Female))\r\rEnd If\r\r\r'mti 2020/03/18 Start\r'use gender gap and total (both sexes) poverty to compute female and male poverty rates - reference age group\rIf POVRATE(R%, RefAGGnd, Total) = 0 Then\rPOVRATE(R%, RefAGGnd, Male) = 0\rPOVRATE(R%, RefAGGnd, Female) = 0\rElse\r\r'           'For gender distribution of very low poverty make sure there is some poverty in each of the sexes\rIf PovGndDiffRefAG >= 0 Then\rPovGndDiffRefAG = CSng(Amin(PovGndDiffRefAG, 1.5 * POVRATE(R%, RefAGGnd, Total))) '1.5\r\rElse\rPovGndDiffRefAG = CSng(AMAX(PovGndDiffRefAG, -1.5 * POVRATE(R%, RefAGGnd, Total)))  '-1.5\rEnd If\r\r'Use gender difference and total poverty to compute poverty rates for each of the sexes\r'mti 2020/04/29 Start\r'POVRATE(R%, RefAGGnd, Male) = AMAX(0, (POVRATE(R%, RefAGGnd, Total) * POPPOVAG(R%, RefAGGnd, Total) - PovGndDiffRefAG * POPPOVAG(R%, RefAGGnd, Female)) / POPPOVAG(R%, RefAGGnd, Total))\rPOVRATE(R%, RefAGGnd, Male) = AMAX(0, (POVRATE(R%, RefAGGnd, Total) * POPPOVAG(R%, RefAGGnd, Total) - PovGndDiffRefAG * POPPOVAG(R%, RefAGGnd, Female)) / AMAX(0.000001, POPPOVAG(R%, RefAGGnd, Total)))\r'mti 2020/04/29 End\rPOVRATE(R%, RefAGGnd, Female) = AMAX(0, PovGndDiffRefAG + POVRATE(R%, RefAGGnd, Male))\r\r'            'once again, make sure there is at least some poverty in each gender\rPOVRATE(R%, RefAGGnd, Male) = AMAX(POVRATE(R%, RefAGGnd, Female) * 0.2, POVRATE(R%, RefAGGnd, Male))\rPOVRATE(R%, RefAGGnd, Female) = AMAX(POVRATE(R%, RefAGGnd, Male) * 0.2, POVRATE(R%, RefAGGnd, Female))\r\rEnd If\r\rRefAGGnd = AG_25_34\r"
  },
  {
    "Variable": "POVRATE",
    "UsesVariable": "povagesexagratnat",
    "Distance": 1,
    "Code": "\r\r\rFor j% = 1 To TotPovAGCount\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATE(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAG(R%, j%) = POVRATE(R%, j%, Total) / POVRATE(R%, RefAGTot, Total)  'could also use iPovRatioNational(R%)\rEnd If\r\r'mti 2020/03/18 Start\r'Save initial gender difference for all age groups\riPovGndDiffAG(R%, j%) = POVRATE(R%, j%, Female) - POVRATE(R%, j%, Male)\r'mti 2020/03/18 End\rNext\r\r'\rNext R%\r\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG(R%, j%) * povagesexagratnat\rPOVRATE(R%, j%, Total) = AMAX(0, Amin(100, POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'mti 2020/11/10 start\r'POVRATE(R%, j%, Total) = POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE(R%, j%, Total) = AMAX(0, Amin(100, POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r'mti 2020/11/10 start\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r'mti 2020/11/10 End\rEnd If\r\rFor j% = 1 To TotPovAGCount\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG(R%, j%) + IncTrgtCovd * (CSng(PovRateRatioToRefAG_Trgt(j%)) - iPovRateRatioToRefAG(R%, j%))  'AMAX(0, (can be in both direction)\r\r'mti 2020/11/10 start\r'POVRATE(R%, j%, Total) = POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE(R%, j%, Total) = AMAX(0, Amin(100, POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r'mti 2020/11/10 End\rNext\rEnd If\r'mti 2021/12/28 start\rEnd If\r\r\r'Aggregate population to poverty age groups\rAggagedstflex(agStart, agEnd, POPPOVAG) ' agedstpov\rReDim POPPOVAGD(NR, 11, 3)\rAggagedstflex(agStart, agEnd, POPPOVAGD)\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG(R%, j%) * povagesexagratnat\rPOVRATE(R%, j%, Total) = AMAX(0, Amin(100, POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'mti 2020/11/10 start\r'POVRATE(R%, j%, Total) = POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE(R%, j%, Total) = AMAX(0, Amin(100, POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r'mti 2020/11/10 start\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r'mti 2020/11/10 End\rEnd If\r\rFor j% = 1 To TotPovAGCount\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG(R%, j%) + IncTrgtCovd * (CSng(PovRateRatioToRefAG_Trgt(j%)) - iPovRateRatioToRefAG(R%, j%))  'AMAX(0, (can be in both direction)\r\r'mti 2020/11/10 start\r'POVRATE(R%, j%, Total) = POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE(R%, j%, Total) = AMAX(0, Amin(100, POVRATE(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r'mti 2020/11/10 End\rNext\rEnd If\r'mti 2021/12/28 start\rEnd If\r\r\r'Aggregate population to poverty age groups\rAggagedstflex(agStart, agEnd, POPPOVAG) ' agedstpov\rReDim POPPOVAGD(NR, 11, 3)\rAggagedstflex(agStart, agEnd, POPPOVAGD)\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r\rFor j% = 1 To TotPovAGCount\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATE(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAG(R%, j%) = POVRATE(R%, j%, Total) / POVRATE(R%, RefAGTot, Total)  'could also use iPovRatioNational(R%)\rEnd If\r\r'mti 2020/03/18 Start\r'Save initial gender difference for all age groups\riPovGndDiffAG(R%, j%) = POVRATE(R%, j%, Female) - POVRATE(R%, j%, Male)\r'mti 2020/03/18 End\rNext\r\r'\rNext R%\r"
  },
  {
    "Variable": "POVRATE",
    "UsesVariable": "INCOMELT215LN",
    "Distance": 0,
    "Code": "\r\rPrivate Sub IFsEcoPovAgeSexAllButFirst()\r\r\r'   All But First:  Poverty by age-sex\r'   -------------------------------------------\r\r\r'All But First: Compute population by poverty age-sex grouping\r'------------------------------------------------------------\rAggagedstflex(agStart, agEnd, POPPOVAG) 'agedstpov\rAggagedstflex(agStart, agEnd, POPPOVAGD)\r\r'All But First: Compue poverty rates by age group for both sexes combined\r'--------------------------------------------------------------------------\rFor R% = 1 To NR%\r\r'jrs 2022/11/22\rIf ConstantDollarsYear = 2011 Then\rIf INCOMELT190LN(R%) = 0 Then 'no poverty\rPOVRATE(R%, RefAGTot, Total) = 0\rElse\r'poverty rate,  both sexes = national poverty rate, when reference AG is All Ages\rPOVRATE(R%, RefAGTot, Total) = 100 * INCOMELT190LN(R%) / POP(R%)\rEnd If\rElse\r'poverty rate,  both sexes = national poverty rate, when reference AG is All Ages\rPOVRATE(R%, RefAGTot, Total) = 100 * INCOMELT215LN(R%) / POP(R%)\rEnd If\rEnd If\r\r\r'Aggregate population to poverty age groups\rAggagedstflex(agStart, agEnd, POPPOVAG) ' agedstpov\rReDim POPPOVAGD(NR, 11, 3)\rAggagedstflex(agStart, agEnd, POPPOVAGD)\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r"
  },
  {
    "Variable": "POVRATE",
    "UsesVariable": "INCOMELT190LN",
    "Distance": 0,
    "Code": "\r\rPrivate Sub IFsEcoPovAgeSexAllButFirst()\r\r\r'   All But First:  Poverty by age-sex\r'   -------------------------------------------\r\r\r'All But First: Compute population by poverty age-sex grouping\r'------------------------------------------------------------\rAggagedstflex(agStart, agEnd, POPPOVAG) 'agedstpov\rAggagedstflex(agStart, agEnd, POPPOVAGD)\r\r'All But First: Compue poverty rates by age group for both sexes combined\r'--------------------------------------------------------------------------\rFor R% = 1 To NR%\r\r'jrs 2022/11/22\rIf ConstantDollarsYear = 2011 Then\rIf INCOMELT190LN(R%) = 0 Then 'no poverty\rPOVRATE(R%, RefAGTot, Total) = 0\rElse\r'poverty rate,  both sexes = national poverty rate, when reference AG is All Ages\rPOVRATE(R%, RefAGTot, Total) = 100 * INCOMELT190LN(R%) / POP(R%)\rEnd If\rElse\r'poverty rate,  both sexes = national poverty rate, when reference AG is All Ages\rPOVRATE(R%, RefAGTot, Total) = 100 * INCOMELT215LN(R%) / POP(R%)\rEnd If\rEnd If\r"
  },
  {
    "Variable": "POVRATE",
    "UsesVariable": "POVCOUNT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POVRATE",
    "UsesVariable": "POVGNDRATIO",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POVRATE32",
    "UsesVariable": "POPPOVAG",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POVRATE32",
    "UsesVariable": "GINIDOM",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE32",
    "UsesVariable": "POPLE15",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE32",
    "UsesVariable": "POP",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE32",
    "UsesVariable": "LABWAGESEXRAT",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE32",
    "UsesVariable": "EDYRSAG15",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE32",
    "UsesVariable": "povagesexnormstatic",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:Next R%:7638|\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG32(R%, j%) * povagesexagratnat\rPOVRATE32(R%, j%, Total) = AMAX(0, Amin(100, POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG32(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE32(R%, j%, Total) = POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE32(R%, j%, Total) = AMAX(0, Amin(100, POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG32(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG32(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG32(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE32(R%, j%, Total) = AMAX(0, Amin(100, POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7602|\r\rDim iPovRatioNational32(), PovGndDiffRefAGShift32() As Single\rDim iPovRateRatioToRefAG32(,) As Single\rDim iPovGndDiffAG32(,) As Single\rDim PovGndDiffRefAGScaleUp32() As Single\r\rPrivate Sub IFsEcoPovAgeSex32FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\r\rDim j%, R%\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'gvdb 2024/04/05\r' unused variable\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG19 As Single\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational32(NR%), PovGndDiffRefAGShift32(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG32(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp32(NR%)\r\r\rReDim iPovGndDiffAG32(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG32(R%, j%) * povagesexagratnat\rPOVRATE32(R%, j%, Total) = AMAX(0, Amin(100, POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG32(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE32(R%, j%, Total) = POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE32(R%, j%, Total) = AMAX(0, Amin(100, POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG32(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG32(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG32(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE32(R%, j%, Total) = AMAX(0, Amin(100, POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 start\rEnd If\r\r'\r'use gender gap and total (both sexes) poverty to compute female and male poverty rates - reference age group\rIf POVRATE32(R%, RefAGGnd, Total) = 0 Then\rPOVRATE32(R%, RefAGGnd, Male) = 0\rPOVRATE32(R%, RefAGGnd, Female) = 0\rElse\r\r'           'For gender distribution of very low poverty make sure there is some poverty in each of the sexes\rIf PovGndDiffRefAG >= 0 Then\rPovGndDiffRefAG = CSng(Amin(PovGndDiffRefAG, 1.5 * POVRATE32(R%, RefAGGnd, Total))) '1.5\r\rElse\rPovGndDiffRefAG = CSng(AMAX(PovGndDiffRefAG, -1.5 * POVRATE32(R%, RefAGGnd, Total)))  '-1.5\rEnd If\r\r'Use gender difference and total poverty to compute poverty rates for each of the sexes\rPOVRATE32(R%, RefAGGnd, Male) = AMAX(0, (POVRATE32(R%, RefAGGnd, Total) * POPPOVAG(R%, RefAGGnd, Total) - PovGndDiffRefAG * POPPOVAG(R%, RefAGGnd, Female)) / AMAX(0.000001, POPPOVAG(R%, RefAGGnd, Total)))\rPOVRATE32(R%, RefAGGnd, Female) = AMAX(0, PovGndDiffRefAG + POVRATE32(R%, RefAGGnd, Male))\r\r'            'once again, make sure there is at least some poverty in each gender\rPOVRATE32(R%, RefAGGnd, Male) = AMAX(POVRATE32(R%, RefAGGnd, Female) * 0.2, POVRATE32(R%, RefAGGnd, Male))\rPOVRATE32(R%, RefAGGnd, Female) = AMAX(POVRATE32(R%, RefAGGnd, Male) * 0.2, POVRATE32(R%, RefAGGnd, Female))\r\rEnd If\r\r'\r'use gender gap and total (both sexes) poverty to compute female and male poverty rates - reference age group\rIf POVRATE32(R%, RefAGGnd, Total) = 0 Then\rPOVRATE32(R%, RefAGGnd, Male) = 0\rPOVRATE32(R%, RefAGGnd, Female) = 0\rElse\r\r'           'For gender distribution of very low poverty make sure there is some poverty in each of the sexes\rIf PovGndDiffRefAG >= 0 Then\rPovGndDiffRefAG = CSng(Amin(PovGndDiffRefAG, 1.5 * POVRATE32(R%, RefAGGnd, Total))) '1.5\r\rElse\rPovGndDiffRefAG = CSng(AMAX(PovGndDiffRefAG, -1.5 * POVRATE32(R%, RefAGGnd, Total)))  '-1.5\rEnd If\r\r'Use gender difference and total poverty to compute poverty rates for each of the sexes\rPOVRATE32(R%, RefAGGnd, Male) = AMAX(0, (POVRATE32(R%, RefAGGnd, Total) * POPPOVAG(R%, RefAGGnd, Total) - PovGndDiffRefAG * POPPOVAG(R%, RefAGGnd, Female)) / AMAX(0.000001, POPPOVAG(R%, RefAGGnd, Total)))\rPOVRATE32(R%, RefAGGnd, Female) = AMAX(0, PovGndDiffRefAG + POVRATE32(R%, RefAGGnd, Male))\r\r'            'once again, make sure there is at least some poverty in each gender\rPOVRATE32(R%, RefAGGnd, Male) = AMAX(POVRATE32(R%, RefAGGnd, Female) * 0.2, POVRATE32(R%, RefAGGnd, Male))\rPOVRATE32(R%, RefAGGnd, Female) = AMAX(POVRATE32(R%, RefAGGnd, Male) * 0.2, POVRATE32(R%, RefAGGnd, Female))\r\rEnd If\r"
  },
  {
    "Variable": "POVRATE32",
    "UsesVariable": "GDPPCP",
    "Distance": 0,
    "Code": "\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG32(R%, j%) * povagesexagratnat\rPOVRATE32(R%, j%, Total) = AMAX(0, Amin(100, POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG32(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE32(R%, j%, Total) = POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE32(R%, j%, Total) = AMAX(0, Amin(100, POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG32(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG32(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG32(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE32(R%, j%, Total) = AMAX(0, Amin(100, POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7602|\r\rDim iPovRatioNational32(), PovGndDiffRefAGShift32() As Single\rDim iPovRateRatioToRefAG32(,) As Single\rDim iPovGndDiffAG32(,) As Single\rDim PovGndDiffRefAGScaleUp32() As Single\r\rPrivate Sub IFsEcoPovAgeSex32FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\r\rDim j%, R%\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'gvdb 2024/04/05\r' unused variable\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG19 As Single\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational32(NR%), PovGndDiffRefAGShift32(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG32(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp32(NR%)\r\r\rReDim iPovGndDiffAG32(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG32(R%, j%) * povagesexagratnat\rPOVRATE32(R%, j%, Total) = AMAX(0, Amin(100, POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG32(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE32(R%, j%, Total) = POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE32(R%, j%, Total) = AMAX(0, Amin(100, POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG32(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG32(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG32(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE32(R%, j%, Total) = AMAX(0, Amin(100, POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7602|\r\rDim iPovRatioNational32(), PovGndDiffRefAGShift32() As Single\rDim iPovRateRatioToRefAG32(,) As Single\rDim iPovGndDiffAG32(,) As Single\rDim PovGndDiffRefAGScaleUp32() As Single\r\rPrivate Sub IFsEcoPovAgeSex32FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\r\rDim j%, R%\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'gvdb 2024/04/05\r' unused variable\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG19 As Single\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational32(NR%), PovGndDiffRefAGShift32(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG32(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp32(NR%)\r\r\rReDim iPovGndDiffAG32(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r\rFor j% = 1 To TotPovAGCount\r\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATE32(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAG32(R%, j%) = POVRATE32(R%, j%, Total) / POVRATE32(R%, RefAGTot, Total)  'could also use iPovRatioNational32(R%)\rEnd If\r\r'Save initial gender difference for all age groups\riPovGndDiffAG32(R%, j%) = POVRATE32(R%, j%, Female) - POVRATE32(R%, j%, Male)\rNext\r\r'\rNext R%\rCOMPLETE STRUCTURE:End Sub:7602|\r\rDim iPovRatioNational32(), PovGndDiffRefAGShift32() As Single\rDim iPovRateRatioToRefAG32(,) As Single\rDim iPovGndDiffAG32(,) As Single\rDim PovGndDiffRefAGScaleUp32() As Single\r\rPrivate Sub IFsEcoPovAgeSex32FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\r\rDim j%, R%\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'gvdb 2024/04/05\r' unused variable\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG19 As Single\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational32(NR%), PovGndDiffRefAGShift32(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG32(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp32(NR%)\r\r\rReDim iPovGndDiffAG32(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG32(R%, j%) * povagesexagratnat\rPOVRATE32(R%, j%, Total) = AMAX(0, Amin(100, POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG32(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE32(R%, j%, Total) = POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE32(R%, j%, Total) = AMAX(0, Amin(100, POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG32(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG32(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG32(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE32(R%, j%, Total) = AMAX(0, Amin(100, POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 start\rEnd If\r\r\r\rFor j% = 1 To TotPovAGCount\r\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATE32(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAG32(R%, j%) = POVRATE32(R%, j%, Total) / POVRATE32(R%, RefAGTot, Total)  'could also use iPovRatioNational32(R%)\rEnd If\r\r'Save initial gender difference for all age groups\riPovGndDiffAG32(R%, j%) = POVRATE32(R%, j%, Female) - POVRATE32(R%, j%, Male)\rNext\r\r'\rNext R%\r"
  },
  {
    "Variable": "POVRATE32",
    "UsesVariable": "povagesexagratnat",
    "Distance": 1,
    "Code": "\r\r\rFor j% = 1 To TotPovAGCount\r\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATE32(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAG32(R%, j%) = POVRATE32(R%, j%, Total) / POVRATE32(R%, RefAGTot, Total)  'could also use iPovRatioNational32(R%)\rEnd If\r\r'Save initial gender difference for all age groups\riPovGndDiffAG32(R%, j%) = POVRATE32(R%, j%, Female) - POVRATE32(R%, j%, Male)\rNext\r\r'\rNext R%\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG32(R%, j%) * povagesexagratnat\rPOVRATE32(R%, j%, Total) = AMAX(0, Amin(100, POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG32(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE32(R%, j%, Total) = POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE32(R%, j%, Total) = AMAX(0, Amin(100, POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG32(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG32(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG32(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE32(R%, j%, Total) = AMAX(0, Amin(100, POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7602|\r\rDim iPovRatioNational32(), PovGndDiffRefAGShift32() As Single\rDim iPovRateRatioToRefAG32(,) As Single\rDim iPovGndDiffAG32(,) As Single\rDim PovGndDiffRefAGScaleUp32() As Single\r\rPrivate Sub IFsEcoPovAgeSex32FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\r\rDim j%, R%\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'gvdb 2024/04/05\r' unused variable\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG19 As Single\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational32(NR%), PovGndDiffRefAGShift32(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG32(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp32(NR%)\r\r\rReDim iPovGndDiffAG32(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG32(R%, j%) * povagesexagratnat\rPOVRATE32(R%, j%, Total) = AMAX(0, Amin(100, POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG32(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE32(R%, j%, Total) = POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE32(R%, j%, Total) = AMAX(0, Amin(100, POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG32(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG32(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG32(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE32(R%, j%, Total) = AMAX(0, Amin(100, POVRATE32(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7602|\r\rDim iPovRatioNational32(), PovGndDiffRefAGShift32() As Single\rDim iPovRateRatioToRefAG32(,) As Single\rDim iPovGndDiffAG32(,) As Single\rDim PovGndDiffRefAGScaleUp32() As Single\r\rPrivate Sub IFsEcoPovAgeSex32FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\r\rDim j%, R%\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'gvdb 2024/04/05\r' unused variable\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG19 As Single\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational32(NR%), PovGndDiffRefAGShift32(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG32(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp32(NR%)\r\r\rReDim iPovGndDiffAG32(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r\rFor j% = 1 To TotPovAGCount\r\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATE32(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAG32(R%, j%) = POVRATE32(R%, j%, Total) / POVRATE32(R%, RefAGTot, Total)  'could also use iPovRatioNational32(R%)\rEnd If\r\r'Save initial gender difference for all age groups\riPovGndDiffAG32(R%, j%) = POVRATE32(R%, j%, Female) - POVRATE32(R%, j%, Male)\rNext\r\r'\rNext R%\r"
  },
  {
    "Variable": "POVRATE32",
    "UsesVariable": "INCOMELT320LN",
    "Distance": 0,
    "Code": "\r\rPrivate Sub IFsEcoPovAgeSex32AllButFirst()\r\r'   All But First:  Poverty by age-sex\r'   -------------------------------------------\r\r\r'All But First: Compute population by poverty age-sex grouping\r'------------------------------------------------------------\r'Aggagedstflex agStart, agEnd, POPPOVAG 'agedstpov\r\r\r'All But First: Compue poverty rates by age group for both sexes combined\r'--------------------------------------------------------------------------\rFor R% = 1 To NR%\r\rIf INCOMELT320LN(R%) = 0 Then 'no poverty\rPOVRATE32(R%, RefAGTot, Total) = 0\rElse\r'poverty rate,  both sexes = national poverty rate, when reference AG is All Ages\rPOVRATE32(R%, RefAGTot, Total) = 100 * INCOMELT320LN(R%) / POP(R%)\rEnd If\rCOMPLETE STRUCTURE:End Sub:7602|\r\rDim iPovRatioNational32(), PovGndDiffRefAGShift32() As Single\rDim iPovRateRatioToRefAG32(,) As Single\rDim iPovGndDiffAG32(,) As Single\rDim PovGndDiffRefAGScaleUp32() As Single\r\rPrivate Sub IFsEcoPovAgeSex32FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\r\rDim j%, R%\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'gvdb 2024/04/05\r' unused variable\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG19 As Single\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational32(NR%), PovGndDiffRefAGShift32(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG32(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp32(NR%)\r\r\rReDim iPovGndDiffAG32(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r"
  },
  {
    "Variable": "POVRATE365",
    "UsesVariable": "POPPOVAG",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POVRATE365",
    "UsesVariable": "GINIDOM",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE365",
    "UsesVariable": "POPLE15",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE365",
    "UsesVariable": "POP",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE365",
    "UsesVariable": "LABWAGESEXRAT",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE365",
    "UsesVariable": "EDYRSAG15",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE365",
    "UsesVariable": "povagesexnormstatic",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:Next R%:7688|\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG365(R%, j%) * povagesexagratnat\rPOVRATE365(R%, j%, Total) = AMAX(0, Amin(100, POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG365(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE365(R%, j%, Total) = POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE365(R%, j%, Total) = AMAX(0, Amin(100, POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG365(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG365(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG365(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE365(R%, j%, Total) = AMAX(0, Amin(100, POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7652|\r\r'jrs 2022/11/22 start\rDim iPovRatioNational365(), PovGndDiffRefAGShift365() As Single\rDim iPovRateRatioToRefAG365(,) As Single\rDim iPovGndDiffAG365(,) As Single\rDim PovGndDiffRefAGScaleUp365() As Single\r\rPrivate Sub IFsEcoPovAgeSex365FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\r\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG215 As Single\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational365(NR%), PovGndDiffRefAGShift365(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG365(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp365(NR%)\r\r\rReDim iPovGndDiffAG365(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG365(R%, j%) * povagesexagratnat\rPOVRATE365(R%, j%, Total) = AMAX(0, Amin(100, POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG365(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE365(R%, j%, Total) = POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE365(R%, j%, Total) = AMAX(0, Amin(100, POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG365(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG365(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG365(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE365(R%, j%, Total) = AMAX(0, Amin(100, POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 start\rEnd If\r\r'\r'use gender gap and total (both sexes) poverty to compute female and male poverty rates - reference age group\rIf POVRATE365(R%, RefAGGnd, Total) = 0 Then\rPOVRATE365(R%, RefAGGnd, Male) = 0\rPOVRATE365(R%, RefAGGnd, Female) = 0\rElse\r\r'           'For gender distribution of very low poverty make sure there is some poverty in each of the sexes\rIf PovGndDiffRefAG >= 0 Then\rPovGndDiffRefAG = CSng(Amin(PovGndDiffRefAG, 1.5 * POVRATE365(R%, RefAGGnd, Total))) '1.5\r\rElse\rPovGndDiffRefAG = CSng(AMAX(PovGndDiffRefAG, -1.5 * POVRATE365(R%, RefAGGnd, Total)))  '-1.5\rEnd If\r\r'Use gender difference and total poverty to compute poverty rates for each of the sexes\rPOVRATE365(R%, RefAGGnd, Male) = AMAX(0, (POVRATE365(R%, RefAGGnd, Total) * POPPOVAG(R%, RefAGGnd, Total) - PovGndDiffRefAG * POPPOVAG(R%, RefAGGnd, Female)) / AMAX(0.000001, POPPOVAG(R%, RefAGGnd, Total)))\rPOVRATE365(R%, RefAGGnd, Female) = AMAX(0, PovGndDiffRefAG + POVRATE365(R%, RefAGGnd, Male))\r\r'            'once again, make sure there is at least some poverty in each gender\rPOVRATE365(R%, RefAGGnd, Male) = AMAX(POVRATE365(R%, RefAGGnd, Female) * 0.2, POVRATE365(R%, RefAGGnd, Male))\rPOVRATE365(R%, RefAGGnd, Female) = AMAX(POVRATE365(R%, RefAGGnd, Male) * 0.2, POVRATE365(R%, RefAGGnd, Female))\r\rEnd If\r\r'\r'use gender gap and total (both sexes) poverty to compute female and male poverty rates - reference age group\rIf POVRATE365(R%, RefAGGnd, Total) = 0 Then\rPOVRATE365(R%, RefAGGnd, Male) = 0\rPOVRATE365(R%, RefAGGnd, Female) = 0\rElse\r\r'           'For gender distribution of very low poverty make sure there is some poverty in each of the sexes\rIf PovGndDiffRefAG >= 0 Then\rPovGndDiffRefAG = CSng(Amin(PovGndDiffRefAG, 1.5 * POVRATE365(R%, RefAGGnd, Total))) '1.5\r\rElse\rPovGndDiffRefAG = CSng(AMAX(PovGndDiffRefAG, -1.5 * POVRATE365(R%, RefAGGnd, Total)))  '-1.5\rEnd If\r\r'Use gender difference and total poverty to compute poverty rates for each of the sexes\rPOVRATE365(R%, RefAGGnd, Male) = AMAX(0, (POVRATE365(R%, RefAGGnd, Total) * POPPOVAG(R%, RefAGGnd, Total) - PovGndDiffRefAG * POPPOVAG(R%, RefAGGnd, Female)) / AMAX(0.000001, POPPOVAG(R%, RefAGGnd, Total)))\rPOVRATE365(R%, RefAGGnd, Female) = AMAX(0, PovGndDiffRefAG + POVRATE365(R%, RefAGGnd, Male))\r\r'            'once again, make sure there is at least some poverty in each gender\rPOVRATE365(R%, RefAGGnd, Male) = AMAX(POVRATE365(R%, RefAGGnd, Female) * 0.2, POVRATE365(R%, RefAGGnd, Male))\rPOVRATE365(R%, RefAGGnd, Female) = AMAX(POVRATE365(R%, RefAGGnd, Male) * 0.2, POVRATE365(R%, RefAGGnd, Female))\r\rEnd If\r"
  },
  {
    "Variable": "POVRATE365",
    "UsesVariable": "GDPPCP",
    "Distance": 0,
    "Code": "\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG365(R%, j%) * povagesexagratnat\rPOVRATE365(R%, j%, Total) = AMAX(0, Amin(100, POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG365(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE365(R%, j%, Total) = POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE365(R%, j%, Total) = AMAX(0, Amin(100, POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG365(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG365(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG365(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE365(R%, j%, Total) = AMAX(0, Amin(100, POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7652|\r\r'jrs 2022/11/22 start\rDim iPovRatioNational365(), PovGndDiffRefAGShift365() As Single\rDim iPovRateRatioToRefAG365(,) As Single\rDim iPovGndDiffAG365(,) As Single\rDim PovGndDiffRefAGScaleUp365() As Single\r\rPrivate Sub IFsEcoPovAgeSex365FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\r\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG215 As Single\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational365(NR%), PovGndDiffRefAGShift365(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG365(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp365(NR%)\r\r\rReDim iPovGndDiffAG365(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG365(R%, j%) * povagesexagratnat\rPOVRATE365(R%, j%, Total) = AMAX(0, Amin(100, POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG365(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE365(R%, j%, Total) = POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE365(R%, j%, Total) = AMAX(0, Amin(100, POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG365(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG365(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG365(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE365(R%, j%, Total) = AMAX(0, Amin(100, POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7652|\r\r'jrs 2022/11/22 start\rDim iPovRatioNational365(), PovGndDiffRefAGShift365() As Single\rDim iPovRateRatioToRefAG365(,) As Single\rDim iPovGndDiffAG365(,) As Single\rDim PovGndDiffRefAGScaleUp365() As Single\r\rPrivate Sub IFsEcoPovAgeSex365FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\r\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG215 As Single\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational365(NR%), PovGndDiffRefAGShift365(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG365(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp365(NR%)\r\r\rReDim iPovGndDiffAG365(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r\rFor j% = 1 To TotPovAGCount\r\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATE365(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAG365(R%, j%) = POVRATE365(R%, j%, Total) / POVRATE365(R%, RefAGTot, Total)  'could also use iPovRatioNational365(R%)\rEnd If\r\r'Save initial gender difference for all age groups\riPovGndDiffAG365(R%, j%) = POVRATE365(R%, j%, Female) - POVRATE365(R%, j%, Male)\rNext\r\r'\rNext R%\rCOMPLETE STRUCTURE:End Sub:7652|\r\r'jrs 2022/11/22 start\rDim iPovRatioNational365(), PovGndDiffRefAGShift365() As Single\rDim iPovRateRatioToRefAG365(,) As Single\rDim iPovGndDiffAG365(,) As Single\rDim PovGndDiffRefAGScaleUp365() As Single\r\rPrivate Sub IFsEcoPovAgeSex365FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\r\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG215 As Single\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational365(NR%), PovGndDiffRefAGShift365(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG365(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp365(NR%)\r\r\rReDim iPovGndDiffAG365(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG365(R%, j%) * povagesexagratnat\rPOVRATE365(R%, j%, Total) = AMAX(0, Amin(100, POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG365(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE365(R%, j%, Total) = POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE365(R%, j%, Total) = AMAX(0, Amin(100, POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG365(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG365(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG365(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE365(R%, j%, Total) = AMAX(0, Amin(100, POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 start\rEnd If\r\r\r\rFor j% = 1 To TotPovAGCount\r\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATE365(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAG365(R%, j%) = POVRATE365(R%, j%, Total) / POVRATE365(R%, RefAGTot, Total)  'could also use iPovRatioNational365(R%)\rEnd If\r\r'Save initial gender difference for all age groups\riPovGndDiffAG365(R%, j%) = POVRATE365(R%, j%, Female) - POVRATE365(R%, j%, Male)\rNext\r\r'\rNext R%\r"
  },
  {
    "Variable": "POVRATE365",
    "UsesVariable": "povagesexagratnat",
    "Distance": 1,
    "Code": "\r\r\rFor j% = 1 To TotPovAGCount\r\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATE365(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAG365(R%, j%) = POVRATE365(R%, j%, Total) / POVRATE365(R%, RefAGTot, Total)  'could also use iPovRatioNational365(R%)\rEnd If\r\r'Save initial gender difference for all age groups\riPovGndDiffAG365(R%, j%) = POVRATE365(R%, j%, Female) - POVRATE365(R%, j%, Male)\rNext\r\r'\rNext R%\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG365(R%, j%) * povagesexagratnat\rPOVRATE365(R%, j%, Total) = AMAX(0, Amin(100, POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG365(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE365(R%, j%, Total) = POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE365(R%, j%, Total) = AMAX(0, Amin(100, POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG365(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG365(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG365(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE365(R%, j%, Total) = AMAX(0, Amin(100, POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7652|\r\r'jrs 2022/11/22 start\rDim iPovRatioNational365(), PovGndDiffRefAGShift365() As Single\rDim iPovRateRatioToRefAG365(,) As Single\rDim iPovGndDiffAG365(,) As Single\rDim PovGndDiffRefAGScaleUp365() As Single\r\rPrivate Sub IFsEcoPovAgeSex365FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\r\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG215 As Single\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational365(NR%), PovGndDiffRefAGShift365(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG365(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp365(NR%)\r\r\rReDim iPovGndDiffAG365(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG365(R%, j%) * povagesexagratnat\rPOVRATE365(R%, j%, Total) = AMAX(0, Amin(100, POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG365(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE365(R%, j%, Total) = POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE365(R%, j%, Total) = AMAX(0, Amin(100, POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG365(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG365(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG365(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE365(R%, j%, Total) = AMAX(0, Amin(100, POVRATE365(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7652|\r\r'jrs 2022/11/22 start\rDim iPovRatioNational365(), PovGndDiffRefAGShift365() As Single\rDim iPovRateRatioToRefAG365(,) As Single\rDim iPovGndDiffAG365(,) As Single\rDim PovGndDiffRefAGScaleUp365() As Single\r\rPrivate Sub IFsEcoPovAgeSex365FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\r\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG215 As Single\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational365(NR%), PovGndDiffRefAGShift365(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG365(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp365(NR%)\r\r\rReDim iPovGndDiffAG365(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r\rFor j% = 1 To TotPovAGCount\r\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATE365(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAG365(R%, j%) = POVRATE365(R%, j%, Total) / POVRATE365(R%, RefAGTot, Total)  'could also use iPovRatioNational365(R%)\rEnd If\r\r'Save initial gender difference for all age groups\riPovGndDiffAG365(R%, j%) = POVRATE365(R%, j%, Female) - POVRATE365(R%, j%, Male)\rNext\r\r'\rNext R%\r"
  },
  {
    "Variable": "POVRATE365",
    "UsesVariable": "INCOMELT365LN",
    "Distance": 0,
    "Code": "\r\rPrivate Sub IFsEcoPovAgeSex365AllButFirst()\r\r'   All But First:  Poverty by age-sex\r'   -------------------------------------------\r\r\r'All But First: Compute population by poverty age-sex grouping\r'------------------------------------------------------------\r'Aggagedstflex agStart, agEnd, POPPOVAG 'agedstpov\r\r\r'All But First: Compue poverty rates by age group for both sexes combined\r'--------------------------------------------------------------------------\rFor R% = 1 To NR%\r\rIf INCOMELT365LN(R%) = 0 Then 'no poverty\rPOVRATE365(R%, RefAGTot, Total) = 0\rElse\r'poverty rate,  both sexes = national poverty rate, when reference AG is All Ages\rPOVRATE365(R%, RefAGTot, Total) = 100 * INCOMELT365LN(R%) / POP(R%)\rEnd If\rCOMPLETE STRUCTURE:End Sub:7652|\r\r'jrs 2022/11/22 start\rDim iPovRatioNational365(), PovGndDiffRefAGShift365() As Single\rDim iPovRateRatioToRefAG365(,) As Single\rDim iPovGndDiffAG365(,) As Single\rDim PovGndDiffRefAGScaleUp365() As Single\r\rPrivate Sub IFsEcoPovAgeSex365FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\r\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG215 As Single\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational365(NR%), PovGndDiffRefAGShift365(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG365(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp365(NR%)\r\r\rReDim iPovGndDiffAG365(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r"
  },
  {
    "Variable": "POVRATE55",
    "UsesVariable": "POPPOVAG",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POVRATE55",
    "UsesVariable": "GINIDOM",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE55",
    "UsesVariable": "POPLE15",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE55",
    "UsesVariable": "POP",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE55",
    "UsesVariable": "LABWAGESEXRAT",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE55",
    "UsesVariable": "EDYRSAG15",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE55",
    "UsesVariable": "povagesexnormstatic",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:Next R%:7738|\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG55(R%, j%) * povagesexagratnat\rPOVRATE55(R%, j%, Total) = AMAX(0, Amin(100, POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG55(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE55(R%, j%, Total) = POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE55(R%, j%, Total) = AMAX(0, Amin(100, POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG55(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG55(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG55(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE55(R%, j%, Total) = AMAX(0, Amin(100, POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 Start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7702|\r\r'jrs 2022/11/22 end\r\rDim iPovGndDiffAG55(,) As Single\rDim PovGndDiffRefAGScaleUp55() As Single\rDim iPovRatioNational55() As Single\rDim PovGndDiffRefAGShift55() As Single\rDim iPovRateRatioToRefAG55(,) As Single\r\r'-------------------------------------------Economy.bas ----------------\rPrivate Sub IFsEcoPovAgeSex55FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG19 As Single\r\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational55(NR%), PovGndDiffRefAGShift55(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG55(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp55(NR%)\r\r\rReDim iPovGndDiffAG55(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG55(R%, j%) * povagesexagratnat\rPOVRATE55(R%, j%, Total) = AMAX(0, Amin(100, POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG55(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE55(R%, j%, Total) = POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE55(R%, j%, Total) = AMAX(0, Amin(100, POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG55(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG55(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG55(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE55(R%, j%, Total) = AMAX(0, Amin(100, POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 Start\rEnd If\r\r'\r'use gender gap and total (both sexes) poverty to compute female and male poverty rates - reference age group\rIf POVRATE55(R%, RefAGGnd, Total) = 0 Then\rPOVRATE55(R%, RefAGGnd, Male) = 0\rPOVRATE55(R%, RefAGGnd, Female) = 0\rElse\r\r'           'For gender distribution of very low poverty make sure there is some poverty in each of the sexes\rIf PovGndDiffRefAG >= 0 Then\rPovGndDiffRefAG = CSng(Amin(PovGndDiffRefAG, 1.5 * POVRATE55(R%, RefAGGnd, Total))) '1.5\r\rElse\rPovGndDiffRefAG = CSng(AMAX(PovGndDiffRefAG, -1.5 * POVRATE55(R%, RefAGGnd, Total)))  '-1.5\rEnd If\r\r'Use gender difference and total poverty to compute poverty rates for each of the sexes\rPOVRATE55(R%, RefAGGnd, Male) = AMAX(0, (POVRATE55(R%, RefAGGnd, Total) * POPPOVAG(R%, RefAGGnd, Total) - PovGndDiffRefAG * POPPOVAG(R%, RefAGGnd, Female)) / AMAX(0.000001, POPPOVAG(R%, RefAGGnd, Total)))\rPOVRATE55(R%, RefAGGnd, Female) = AMAX(0, PovGndDiffRefAG + POVRATE55(R%, RefAGGnd, Male))\r\r'            'once again, make sure there is at least some poverty in each gender\rPOVRATE55(R%, RefAGGnd, Male) = AMAX(POVRATE55(R%, RefAGGnd, Female) * 0.2, POVRATE55(R%, RefAGGnd, Male))\rPOVRATE55(R%, RefAGGnd, Female) = AMAX(POVRATE55(R%, RefAGGnd, Male) * 0.2, POVRATE55(R%, RefAGGnd, Female))\r\rEnd If\r\r'\r'use gender gap and total (both sexes) poverty to compute female and male poverty rates - reference age group\rIf POVRATE55(R%, RefAGGnd, Total) = 0 Then\rPOVRATE55(R%, RefAGGnd, Male) = 0\rPOVRATE55(R%, RefAGGnd, Female) = 0\rElse\r\r'           'For gender distribution of very low poverty make sure there is some poverty in each of the sexes\rIf PovGndDiffRefAG >= 0 Then\rPovGndDiffRefAG = CSng(Amin(PovGndDiffRefAG, 1.5 * POVRATE55(R%, RefAGGnd, Total))) '1.5\r\rElse\rPovGndDiffRefAG = CSng(AMAX(PovGndDiffRefAG, -1.5 * POVRATE55(R%, RefAGGnd, Total)))  '-1.5\rEnd If\r\r'Use gender difference and total poverty to compute poverty rates for each of the sexes\rPOVRATE55(R%, RefAGGnd, Male) = AMAX(0, (POVRATE55(R%, RefAGGnd, Total) * POPPOVAG(R%, RefAGGnd, Total) - PovGndDiffRefAG * POPPOVAG(R%, RefAGGnd, Female)) / AMAX(0.000001, POPPOVAG(R%, RefAGGnd, Total)))\rPOVRATE55(R%, RefAGGnd, Female) = AMAX(0, PovGndDiffRefAG + POVRATE55(R%, RefAGGnd, Male))\r\r'            'once again, make sure there is at least some poverty in each gender\rPOVRATE55(R%, RefAGGnd, Male) = AMAX(POVRATE55(R%, RefAGGnd, Female) * 0.2, POVRATE55(R%, RefAGGnd, Male))\rPOVRATE55(R%, RefAGGnd, Female) = AMAX(POVRATE55(R%, RefAGGnd, Male) * 0.2, POVRATE55(R%, RefAGGnd, Female))\r\rEnd If\r"
  },
  {
    "Variable": "POVRATE55",
    "UsesVariable": "GDPPCP",
    "Distance": 0,
    "Code": "\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG55(R%, j%) * povagesexagratnat\rPOVRATE55(R%, j%, Total) = AMAX(0, Amin(100, POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG55(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE55(R%, j%, Total) = POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE55(R%, j%, Total) = AMAX(0, Amin(100, POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG55(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG55(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG55(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE55(R%, j%, Total) = AMAX(0, Amin(100, POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 Start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7702|\r\r'jrs 2022/11/22 end\r\rDim iPovGndDiffAG55(,) As Single\rDim PovGndDiffRefAGScaleUp55() As Single\rDim iPovRatioNational55() As Single\rDim PovGndDiffRefAGShift55() As Single\rDim iPovRateRatioToRefAG55(,) As Single\r\r'-------------------------------------------Economy.bas ----------------\rPrivate Sub IFsEcoPovAgeSex55FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG19 As Single\r\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational55(NR%), PovGndDiffRefAGShift55(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG55(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp55(NR%)\r\r\rReDim iPovGndDiffAG55(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG55(R%, j%) * povagesexagratnat\rPOVRATE55(R%, j%, Total) = AMAX(0, Amin(100, POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG55(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE55(R%, j%, Total) = POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE55(R%, j%, Total) = AMAX(0, Amin(100, POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG55(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG55(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG55(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE55(R%, j%, Total) = AMAX(0, Amin(100, POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 Start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7702|\r\r'jrs 2022/11/22 end\r\rDim iPovGndDiffAG55(,) As Single\rDim PovGndDiffRefAGScaleUp55() As Single\rDim iPovRatioNational55() As Single\rDim PovGndDiffRefAGShift55() As Single\rDim iPovRateRatioToRefAG55(,) As Single\r\r'-------------------------------------------Economy.bas ----------------\rPrivate Sub IFsEcoPovAgeSex55FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG19 As Single\r\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational55(NR%), PovGndDiffRefAGShift55(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG55(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp55(NR%)\r\r\rReDim iPovGndDiffAG55(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r\rFor j% = 1 To TotPovAGCount\r\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATE55(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAG55(R%, j%) = POVRATE55(R%, j%, Total) / POVRATE55(R%, RefAGTot, Total)  'could also use iPovRatioNational55(R%)\rEnd If\r\r'Save initial gender difference for all age groups\riPovGndDiffAG55(R%, j%) = POVRATE55(R%, j%, Female) - POVRATE55(R%, j%, Male)\rNext\r\r'\rNext R%\rCOMPLETE STRUCTURE:End Sub:7702|\r\r'jrs 2022/11/22 end\r\rDim iPovGndDiffAG55(,) As Single\rDim PovGndDiffRefAGScaleUp55() As Single\rDim iPovRatioNational55() As Single\rDim PovGndDiffRefAGShift55() As Single\rDim iPovRateRatioToRefAG55(,) As Single\r\r'-------------------------------------------Economy.bas ----------------\rPrivate Sub IFsEcoPovAgeSex55FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG19 As Single\r\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational55(NR%), PovGndDiffRefAGShift55(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG55(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp55(NR%)\r\r\rReDim iPovGndDiffAG55(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG55(R%, j%) * povagesexagratnat\rPOVRATE55(R%, j%, Total) = AMAX(0, Amin(100, POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG55(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE55(R%, j%, Total) = POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE55(R%, j%, Total) = AMAX(0, Amin(100, POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG55(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG55(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG55(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE55(R%, j%, Total) = AMAX(0, Amin(100, POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 Start\rEnd If\r\r\r\rFor j% = 1 To TotPovAGCount\r\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATE55(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAG55(R%, j%) = POVRATE55(R%, j%, Total) / POVRATE55(R%, RefAGTot, Total)  'could also use iPovRatioNational55(R%)\rEnd If\r\r'Save initial gender difference for all age groups\riPovGndDiffAG55(R%, j%) = POVRATE55(R%, j%, Female) - POVRATE55(R%, j%, Male)\rNext\r\r'\rNext R%\r"
  },
  {
    "Variable": "POVRATE55",
    "UsesVariable": "povagesexagratnat",
    "Distance": 1,
    "Code": "\r\r\rFor j% = 1 To TotPovAGCount\r\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATE55(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAG55(R%, j%) = POVRATE55(R%, j%, Total) / POVRATE55(R%, RefAGTot, Total)  'could also use iPovRatioNational55(R%)\rEnd If\r\r'Save initial gender difference for all age groups\riPovGndDiffAG55(R%, j%) = POVRATE55(R%, j%, Female) - POVRATE55(R%, j%, Male)\rNext\r\r'\rNext R%\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG55(R%, j%) * povagesexagratnat\rPOVRATE55(R%, j%, Total) = AMAX(0, Amin(100, POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG55(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE55(R%, j%, Total) = POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE55(R%, j%, Total) = AMAX(0, Amin(100, POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG55(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG55(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG55(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE55(R%, j%, Total) = AMAX(0, Amin(100, POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 Start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7702|\r\r'jrs 2022/11/22 end\r\rDim iPovGndDiffAG55(,) As Single\rDim PovGndDiffRefAGScaleUp55() As Single\rDim iPovRatioNational55() As Single\rDim PovGndDiffRefAGShift55() As Single\rDim iPovRateRatioToRefAG55(,) As Single\r\r'-------------------------------------------Economy.bas ----------------\rPrivate Sub IFsEcoPovAgeSex55FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG19 As Single\r\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational55(NR%), PovGndDiffRefAGShift55(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG55(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp55(NR%)\r\r\rReDim iPovGndDiffAG55(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG55(R%, j%) * povagesexagratnat\rPOVRATE55(R%, j%, Total) = AMAX(0, Amin(100, POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG55(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE55(R%, j%, Total) = POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE55(R%, j%, Total) = AMAX(0, Amin(100, POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG55(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG55(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG55(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE55(R%, j%, Total) = AMAX(0, Amin(100, POVRATE55(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 Start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7702|\r\r'jrs 2022/11/22 end\r\rDim iPovGndDiffAG55(,) As Single\rDim PovGndDiffRefAGScaleUp55() As Single\rDim iPovRatioNational55() As Single\rDim PovGndDiffRefAGShift55() As Single\rDim iPovRateRatioToRefAG55(,) As Single\r\r'-------------------------------------------Economy.bas ----------------\rPrivate Sub IFsEcoPovAgeSex55FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG19 As Single\r\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational55(NR%), PovGndDiffRefAGShift55(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG55(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp55(NR%)\r\r\rReDim iPovGndDiffAG55(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r\rFor j% = 1 To TotPovAGCount\r\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATE55(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAG55(R%, j%) = POVRATE55(R%, j%, Total) / POVRATE55(R%, RefAGTot, Total)  'could also use iPovRatioNational55(R%)\rEnd If\r\r'Save initial gender difference for all age groups\riPovGndDiffAG55(R%, j%) = POVRATE55(R%, j%, Female) - POVRATE55(R%, j%, Male)\rNext\r\r'\rNext R%\r"
  },
  {
    "Variable": "POVRATE55",
    "UsesVariable": "INCOMELT550LN",
    "Distance": 0,
    "Code": "\r\rPrivate Sub IFsEcoPovAgeSex55AllButFirst()\r'   All But First:  Poverty by age-sex\r'   -------------------------------------------\r\r\r'All But First: Compute population by poverty age-sex grouping\r'------------------------------------------------------------\r'Aggagedstflex agStart, agEnd, POPPOVAG 'agedstpov\r\r\r'All But First: Compue poverty rates by age group for both sexes combined\r'--------------------------------------------------------------------------\rFor R% = 1 To NR%\r\rIf INCOMELT550LN(R%) = 0 Then 'no poverty\rPOVRATE55(R%, RefAGTot, Total) = 0\rElse\r'poverty rate,  both sexes = national poverty rate, when reference AG is All Ages\rPOVRATE55(R%, RefAGTot, Total) = 100 * INCOMELT550LN(R%) / POP(R%)\rEnd If\rCOMPLETE STRUCTURE:End Sub:7702|\r\r'jrs 2022/11/22 end\r\rDim iPovGndDiffAG55(,) As Single\rDim PovGndDiffRefAGScaleUp55() As Single\rDim iPovRatioNational55() As Single\rDim PovGndDiffRefAGShift55() As Single\rDim iPovRateRatioToRefAG55(,) As Single\r\r'-------------------------------------------Economy.bas ----------------\rPrivate Sub IFsEcoPovAgeSex55FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG19 As Single\r\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational55(NR%), PovGndDiffRefAGShift55(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG55(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp55(NR%)\r\r\rReDim iPovGndDiffAG55(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r"
  },
  {
    "Variable": "POVRATE685",
    "UsesVariable": "POPPOVAG",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POVRATE685",
    "UsesVariable": "GINIDOM",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE685",
    "UsesVariable": "POPLE15",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE685",
    "UsesVariable": "POP",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE685",
    "UsesVariable": "LABWAGESEXRAT",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE685",
    "UsesVariable": "EDYRSAG15",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATE685",
    "UsesVariable": "povagesexnormstatic",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:Next R%:7788|\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG685(R%, j%) * povagesexagratnat\rPOVRATE685(R%, j%, Total) = AMAX(0, Amin(100, POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG685(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE685(R%, j%, Total) = POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE685(R%, j%, Total) = AMAX(0, Amin(100, POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG685(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG685(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG685(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE685(R%, j%, Total) = AMAX(0, Amin(100, POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 Start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7752|\r\r'jrs 2022/11/22 start\rDim iPovGndDiffAG685(,) As Single\rDim PovGndDiffRefAGScaleUp685() As Single\rDim iPovRatioNational685() As Single\rDim PovGndDiffRefAGShift685() As Single\rDim iPovRateRatioToRefAG685(,) As Single\r\r'-------------------------------------------Economy.bas ----------------\rPrivate Sub IFsEcoPovAgeSex685FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG215 As Single\r\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational685(NR%), PovGndDiffRefAGShift685(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG685(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp685(NR%)\r\r\rReDim iPovGndDiffAG685(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG685(R%, j%) * povagesexagratnat\rPOVRATE685(R%, j%, Total) = AMAX(0, Amin(100, POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG685(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE685(R%, j%, Total) = POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE685(R%, j%, Total) = AMAX(0, Amin(100, POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG685(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG685(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG685(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE685(R%, j%, Total) = AMAX(0, Amin(100, POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 Start\rEnd If\r\r'\r'use gender gap and total (both sexes) poverty to compute female and male poverty rates - reference age group\rIf POVRATE685(R%, RefAGGnd, Total) = 0 Then\rPOVRATE685(R%, RefAGGnd, Male) = 0\rPOVRATE685(R%, RefAGGnd, Female) = 0\rElse\r\r'           'For gender distribution of very low poverty make sure there is some poverty in each of the sexes\rIf PovGndDiffRefAG >= 0 Then\rPovGndDiffRefAG = CSng(Amin(PovGndDiffRefAG, 1.5 * POVRATE685(R%, RefAGGnd, Total))) '1.5\r\rElse\rPovGndDiffRefAG = CSng(AMAX(PovGndDiffRefAG, -1.5 * POVRATE685(R%, RefAGGnd, Total)))  '-1.5\rEnd If\r\r'Use gender difference and total poverty to compute poverty rates for each of the sexes\rPOVRATE685(R%, RefAGGnd, Male) = AMAX(0, (POVRATE685(R%, RefAGGnd, Total) * POPPOVAG(R%, RefAGGnd, Total) - PovGndDiffRefAG * POPPOVAG(R%, RefAGGnd, Female)) / AMAX(0.000001, POPPOVAG(R%, RefAGGnd, Total)))\rPOVRATE685(R%, RefAGGnd, Female) = AMAX(0, PovGndDiffRefAG + POVRATE685(R%, RefAGGnd, Male))\r\r'            'once again, make sure there is at least some poverty in each gender\rPOVRATE685(R%, RefAGGnd, Male) = AMAX(POVRATE685(R%, RefAGGnd, Female) * 0.2, POVRATE685(R%, RefAGGnd, Male))\rPOVRATE685(R%, RefAGGnd, Female) = AMAX(POVRATE685(R%, RefAGGnd, Male) * 0.2, POVRATE685(R%, RefAGGnd, Female))\r\rEnd If\r\r'\r'use gender gap and total (both sexes) poverty to compute female and male poverty rates - reference age group\rIf POVRATE685(R%, RefAGGnd, Total) = 0 Then\rPOVRATE685(R%, RefAGGnd, Male) = 0\rPOVRATE685(R%, RefAGGnd, Female) = 0\rElse\r\r'           'For gender distribution of very low poverty make sure there is some poverty in each of the sexes\rIf PovGndDiffRefAG >= 0 Then\rPovGndDiffRefAG = CSng(Amin(PovGndDiffRefAG, 1.5 * POVRATE685(R%, RefAGGnd, Total))) '1.5\r\rElse\rPovGndDiffRefAG = CSng(AMAX(PovGndDiffRefAG, -1.5 * POVRATE685(R%, RefAGGnd, Total)))  '-1.5\rEnd If\r\r'Use gender difference and total poverty to compute poverty rates for each of the sexes\rPOVRATE685(R%, RefAGGnd, Male) = AMAX(0, (POVRATE685(R%, RefAGGnd, Total) * POPPOVAG(R%, RefAGGnd, Total) - PovGndDiffRefAG * POPPOVAG(R%, RefAGGnd, Female)) / AMAX(0.000001, POPPOVAG(R%, RefAGGnd, Total)))\rPOVRATE685(R%, RefAGGnd, Female) = AMAX(0, PovGndDiffRefAG + POVRATE685(R%, RefAGGnd, Male))\r\r'            'once again, make sure there is at least some poverty in each gender\rPOVRATE685(R%, RefAGGnd, Male) = AMAX(POVRATE685(R%, RefAGGnd, Female) * 0.2, POVRATE685(R%, RefAGGnd, Male))\rPOVRATE685(R%, RefAGGnd, Female) = AMAX(POVRATE685(R%, RefAGGnd, Male) * 0.2, POVRATE685(R%, RefAGGnd, Female))\r\rEnd If\r"
  },
  {
    "Variable": "POVRATE685",
    "UsesVariable": "GDPPCP",
    "Distance": 0,
    "Code": "\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG685(R%, j%) * povagesexagratnat\rPOVRATE685(R%, j%, Total) = AMAX(0, Amin(100, POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG685(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE685(R%, j%, Total) = POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE685(R%, j%, Total) = AMAX(0, Amin(100, POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG685(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG685(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG685(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE685(R%, j%, Total) = AMAX(0, Amin(100, POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 Start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7752|\r\r'jrs 2022/11/22 start\rDim iPovGndDiffAG685(,) As Single\rDim PovGndDiffRefAGScaleUp685() As Single\rDim iPovRatioNational685() As Single\rDim PovGndDiffRefAGShift685() As Single\rDim iPovRateRatioToRefAG685(,) As Single\r\r'-------------------------------------------Economy.bas ----------------\rPrivate Sub IFsEcoPovAgeSex685FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG215 As Single\r\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational685(NR%), PovGndDiffRefAGShift685(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG685(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp685(NR%)\r\r\rReDim iPovGndDiffAG685(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG685(R%, j%) * povagesexagratnat\rPOVRATE685(R%, j%, Total) = AMAX(0, Amin(100, POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG685(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE685(R%, j%, Total) = POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE685(R%, j%, Total) = AMAX(0, Amin(100, POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG685(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG685(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG685(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE685(R%, j%, Total) = AMAX(0, Amin(100, POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 Start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7752|\r\r'jrs 2022/11/22 start\rDim iPovGndDiffAG685(,) As Single\rDim PovGndDiffRefAGScaleUp685() As Single\rDim iPovRatioNational685() As Single\rDim PovGndDiffRefAGShift685() As Single\rDim iPovRateRatioToRefAG685(,) As Single\r\r'-------------------------------------------Economy.bas ----------------\rPrivate Sub IFsEcoPovAgeSex685FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG215 As Single\r\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational685(NR%), PovGndDiffRefAGShift685(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG685(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp685(NR%)\r\r\rReDim iPovGndDiffAG685(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r\rFor j% = 1 To TotPovAGCount\r\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATE685(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAG685(R%, j%) = POVRATE685(R%, j%, Total) / POVRATE685(R%, RefAGTot, Total)  'could also use iPovRatioNational685(R%)\rEnd If\r\r'Save initial gender difference for all age groups\riPovGndDiffAG685(R%, j%) = POVRATE685(R%, j%, Female) - POVRATE685(R%, j%, Male)\rNext\r\r'\rNext R%\rCOMPLETE STRUCTURE:End Sub:7752|\r\r'jrs 2022/11/22 start\rDim iPovGndDiffAG685(,) As Single\rDim PovGndDiffRefAGScaleUp685() As Single\rDim iPovRatioNational685() As Single\rDim PovGndDiffRefAGShift685() As Single\rDim iPovRateRatioToRefAG685(,) As Single\r\r'-------------------------------------------Economy.bas ----------------\rPrivate Sub IFsEcoPovAgeSex685FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG215 As Single\r\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational685(NR%), PovGndDiffRefAGShift685(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG685(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp685(NR%)\r\r\rReDim iPovGndDiffAG685(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG685(R%, j%) * povagesexagratnat\rPOVRATE685(R%, j%, Total) = AMAX(0, Amin(100, POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG685(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE685(R%, j%, Total) = POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE685(R%, j%, Total) = AMAX(0, Amin(100, POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG685(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG685(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG685(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE685(R%, j%, Total) = AMAX(0, Amin(100, POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 Start\rEnd If\r\r\r\rFor j% = 1 To TotPovAGCount\r\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATE685(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAG685(R%, j%) = POVRATE685(R%, j%, Total) / POVRATE685(R%, RefAGTot, Total)  'could also use iPovRatioNational685(R%)\rEnd If\r\r'Save initial gender difference for all age groups\riPovGndDiffAG685(R%, j%) = POVRATE685(R%, j%, Female) - POVRATE685(R%, j%, Male)\rNext\r\r'\rNext R%\r"
  },
  {
    "Variable": "POVRATE685",
    "UsesVariable": "povagesexagratnat",
    "Distance": 1,
    "Code": "\r\r\rFor j% = 1 To TotPovAGCount\r\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATE685(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAG685(R%, j%) = POVRATE685(R%, j%, Total) / POVRATE685(R%, RefAGTot, Total)  'could also use iPovRatioNational685(R%)\rEnd If\r\r'Save initial gender difference for all age groups\riPovGndDiffAG685(R%, j%) = POVRATE685(R%, j%, Female) - POVRATE685(R%, j%, Male)\rNext\r\r'\rNext R%\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG685(R%, j%) * povagesexagratnat\rPOVRATE685(R%, j%, Total) = AMAX(0, Amin(100, POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG685(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE685(R%, j%, Total) = POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE685(R%, j%, Total) = AMAX(0, Amin(100, POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG685(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG685(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG685(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE685(R%, j%, Total) = AMAX(0, Amin(100, POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 Start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7752|\r\r'jrs 2022/11/22 start\rDim iPovGndDiffAG685(,) As Single\rDim PovGndDiffRefAGScaleUp685() As Single\rDim iPovRatioNational685() As Single\rDim PovGndDiffRefAGShift685() As Single\rDim iPovRateRatioToRefAG685(,) As Single\r\r'-------------------------------------------Economy.bas ----------------\rPrivate Sub IFsEcoPovAgeSex685FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG215 As Single\r\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational685(NR%), PovGndDiffRefAGShift685(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG685(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp685(NR%)\r\r\rReDim iPovGndDiffAG685(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAG685(R%, j%) * povagesexagratnat\rPOVRATE685(R%, j%, Total) = AMAX(0, Amin(100, POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAG685(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATE685(R%, j%, Total) = POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATE685(R%, j%, Total) = AMAX(0, Amin(100, POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAG685(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAG685(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAG685(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATE685(R%, j%, Total) = AMAX(0, Amin(100, POVRATE685(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 Start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7752|\r\r'jrs 2022/11/22 start\rDim iPovGndDiffAG685(,) As Single\rDim PovGndDiffRefAGScaleUp685() As Single\rDim iPovRatioNational685() As Single\rDim PovGndDiffRefAGShift685() As Single\rDim iPovRateRatioToRefAG685(,) As Single\r\r'-------------------------------------------Economy.bas ----------------\rPrivate Sub IFsEcoPovAgeSex685FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG215 As Single\r\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational685(NR%), PovGndDiffRefAGShift685(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG685(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp685(NR%)\r\r\rReDim iPovGndDiffAG685(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r\rFor j% = 1 To TotPovAGCount\r\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATE685(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAG685(R%, j%) = POVRATE685(R%, j%, Total) / POVRATE685(R%, RefAGTot, Total)  'could also use iPovRatioNational685(R%)\rEnd If\r\r'Save initial gender difference for all age groups\riPovGndDiffAG685(R%, j%) = POVRATE685(R%, j%, Female) - POVRATE685(R%, j%, Male)\rNext\r\r'\rNext R%\r"
  },
  {
    "Variable": "POVRATE685",
    "UsesVariable": "INCOMELT685LN",
    "Distance": 0,
    "Code": "\r\rPrivate Sub IFsEcoPovAgeSex685AllButFirst()\r'   All But First:  Poverty by age-sex\r'   -------------------------------------------\r\r\r'All But First: Compute population by poverty age-sex grouping\r'------------------------------------------------------------\r'Aggagedstflex agStart, agEnd, POPPOVAG 'agedstpov\r\r\r'All But First: Compue poverty rates by age group for both sexes combined\r'--------------------------------------------------------------------------\rFor R% = 1 To NR%\r\rIf INCOMELT685LN(R%) = 0 Then 'no poverty\rPOVRATE685(R%, RefAGTot, Total) = 0\rElse\r'poverty rate,  both sexes = national poverty rate, when reference AG is All Ages\rPOVRATE685(R%, RefAGTot, Total) = 100 * INCOMELT685LN(R%) / POP(R%)\rEnd If\rCOMPLETE STRUCTURE:End Sub:7752|\r\r'jrs 2022/11/22 start\rDim iPovGndDiffAG685(,) As Single\rDim PovGndDiffRefAGScaleUp685() As Single\rDim iPovRatioNational685() As Single\rDim PovGndDiffRefAGShift685() As Single\rDim iPovRateRatioToRefAG685(,) As Single\r\r'-------------------------------------------Economy.bas ----------------\rPrivate Sub IFsEcoPovAgeSex685FirstYear()\r'----------------------------------------------------------------\r'mti 2021/01/29 new procedure\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG215 As Single\r\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNational685(NR%), PovGndDiffRefAGShift685(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAG685(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUp685(NR%)\r\r\rReDim iPovGndDiffAG685(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r"
  },
  {
    "Variable": "POVRATENPL",
    "UsesVariable": "POPPOVAG",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "POVRATENPL",
    "UsesVariable": "GINIDOM",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATENPL",
    "UsesVariable": "POPLE15",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATENPL",
    "UsesVariable": "POP",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATENPL",
    "UsesVariable": "LABWAGESEXRAT",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATENPL",
    "UsesVariable": "EDYRSAG15",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "POVRATENPL",
    "UsesVariable": "povagesexnormstatic",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:Next R%:7838|\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAGNPL(R%, j%) * povagesexagratnat\rPOVRATENPL(R%, j%, Total) = AMAX(0, Amin(100, POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAGNPL(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATENPL(R%, j%, Total) = POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATENPL(R%, j%, Total) = AMAX(0, Amin(100, POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAGNPL(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAGNPL(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAGNPL(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATENPL(R%, j%, Total) = AMAX(0, Amin(100, POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 Start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7802|\r'jrs 2022/11/22 end\r\rDim iPovGndDiffAGNPL(,) As Single\rDim PovGndDiffRefAGScaleUpNPL() As Single\rDim iPovRatioNationalNPL() As Single\rDim PovGndDiffRefAGShiftNPL() As Single\rDim iPovRateRatioToRefAGNPL(,) As Single\r\rPrivate Sub IFsEcoPovAgeSexNPLFirstYear()\r'----------------------------------------------------------------\r'mti 2021/07/15 new procedure\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG19 As Single\r\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNationalNPL(NR%), PovGndDiffRefAGShiftNPL(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAGNPL(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUpNPL(NR%)\r\r\rReDim iPovGndDiffAGNPL(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAGNPL(R%, j%) * povagesexagratnat\rPOVRATENPL(R%, j%, Total) = AMAX(0, Amin(100, POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAGNPL(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATENPL(R%, j%, Total) = POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATENPL(R%, j%, Total) = AMAX(0, Amin(100, POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAGNPL(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAGNPL(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAGNPL(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATENPL(R%, j%, Total) = AMAX(0, Amin(100, POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 Start\rEnd If\r\r'\r'use gender gap and total (both sexes) poverty to compute female and male poverty rates - reference age group\rIf POVRATENPL(R%, RefAGGnd, Total) = 0 Then\rPOVRATENPL(R%, RefAGGnd, Male) = 0\rPOVRATENPL(R%, RefAGGnd, Female) = 0\rElse\r\r'           'For gender distribution of very low poverty make sure there is some poverty in each of the sexes\rIf PovGndDiffRefAG >= 0 Then\rPovGndDiffRefAG = CSng(Amin(PovGndDiffRefAG, 1.5 * POVRATENPL(R%, RefAGGnd, Total))) '1.5\r\rElse\rPovGndDiffRefAG = CSng(AMAX(PovGndDiffRefAG, -1.5 * POVRATENPL(R%, RefAGGnd, Total)))  '-1.5\rEnd If\r\r'Use gender difference and total poverty to compute poverty rates for each of the sexes\rPOVRATENPL(R%, RefAGGnd, Male) = AMAX(0, (POVRATENPL(R%, RefAGGnd, Total) * POPPOVAG(R%, RefAGGnd, Total) - PovGndDiffRefAG * POPPOVAG(R%, RefAGGnd, Female)) / AMAX(0.000001, POPPOVAG(R%, RefAGGnd, Total)))\rPOVRATENPL(R%, RefAGGnd, Female) = AMAX(0, PovGndDiffRefAG + POVRATENPL(R%, RefAGGnd, Male))\r\r'            'once again, make sure there is at least some poverty in each gender\rPOVRATENPL(R%, RefAGGnd, Male) = AMAX(POVRATENPL(R%, RefAGGnd, Female) * 0.2, POVRATENPL(R%, RefAGGnd, Male))\rPOVRATENPL(R%, RefAGGnd, Female) = AMAX(POVRATENPL(R%, RefAGGnd, Male) * 0.2, POVRATENPL(R%, RefAGGnd, Female))\r\rEnd If\r\r'\r'use gender gap and total (both sexes) poverty to compute female and male poverty rates - reference age group\rIf POVRATENPL(R%, RefAGGnd, Total) = 0 Then\rPOVRATENPL(R%, RefAGGnd, Male) = 0\rPOVRATENPL(R%, RefAGGnd, Female) = 0\rElse\r\r'           'For gender distribution of very low poverty make sure there is some poverty in each of the sexes\rIf PovGndDiffRefAG >= 0 Then\rPovGndDiffRefAG = CSng(Amin(PovGndDiffRefAG, 1.5 * POVRATENPL(R%, RefAGGnd, Total))) '1.5\r\rElse\rPovGndDiffRefAG = CSng(AMAX(PovGndDiffRefAG, -1.5 * POVRATENPL(R%, RefAGGnd, Total)))  '-1.5\rEnd If\r\r'Use gender difference and total poverty to compute poverty rates for each of the sexes\rPOVRATENPL(R%, RefAGGnd, Male) = AMAX(0, (POVRATENPL(R%, RefAGGnd, Total) * POPPOVAG(R%, RefAGGnd, Total) - PovGndDiffRefAG * POPPOVAG(R%, RefAGGnd, Female)) / AMAX(0.000001, POPPOVAG(R%, RefAGGnd, Total)))\rPOVRATENPL(R%, RefAGGnd, Female) = AMAX(0, PovGndDiffRefAG + POVRATENPL(R%, RefAGGnd, Male))\r\r'            'once again, make sure there is at least some poverty in each gender\rPOVRATENPL(R%, RefAGGnd, Male) = AMAX(POVRATENPL(R%, RefAGGnd, Female) * 0.2, POVRATENPL(R%, RefAGGnd, Male))\rPOVRATENPL(R%, RefAGGnd, Female) = AMAX(POVRATENPL(R%, RefAGGnd, Male) * 0.2, POVRATENPL(R%, RefAGGnd, Female))\r\rEnd If\r"
  },
  {
    "Variable": "POVRATENPL",
    "UsesVariable": "GDPPCP",
    "Distance": 0,
    "Code": "\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAGNPL(R%, j%) * povagesexagratnat\rPOVRATENPL(R%, j%, Total) = AMAX(0, Amin(100, POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAGNPL(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATENPL(R%, j%, Total) = POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATENPL(R%, j%, Total) = AMAX(0, Amin(100, POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAGNPL(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAGNPL(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAGNPL(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATENPL(R%, j%, Total) = AMAX(0, Amin(100, POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 Start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7802|\r'jrs 2022/11/22 end\r\rDim iPovGndDiffAGNPL(,) As Single\rDim PovGndDiffRefAGScaleUpNPL() As Single\rDim iPovRatioNationalNPL() As Single\rDim PovGndDiffRefAGShiftNPL() As Single\rDim iPovRateRatioToRefAGNPL(,) As Single\r\rPrivate Sub IFsEcoPovAgeSexNPLFirstYear()\r'----------------------------------------------------------------\r'mti 2021/07/15 new procedure\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG19 As Single\r\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNationalNPL(NR%), PovGndDiffRefAGShiftNPL(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAGNPL(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUpNPL(NR%)\r\r\rReDim iPovGndDiffAGNPL(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAGNPL(R%, j%) * povagesexagratnat\rPOVRATENPL(R%, j%, Total) = AMAX(0, Amin(100, POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAGNPL(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATENPL(R%, j%, Total) = POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATENPL(R%, j%, Total) = AMAX(0, Amin(100, POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAGNPL(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAGNPL(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAGNPL(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATENPL(R%, j%, Total) = AMAX(0, Amin(100, POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 Start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7802|\r'jrs 2022/11/22 end\r\rDim iPovGndDiffAGNPL(,) As Single\rDim PovGndDiffRefAGScaleUpNPL() As Single\rDim iPovRatioNationalNPL() As Single\rDim PovGndDiffRefAGShiftNPL() As Single\rDim iPovRateRatioToRefAGNPL(,) As Single\r\rPrivate Sub IFsEcoPovAgeSexNPLFirstYear()\r'----------------------------------------------------------------\r'mti 2021/07/15 new procedure\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG19 As Single\r\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNationalNPL(NR%), PovGndDiffRefAGShiftNPL(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAGNPL(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUpNPL(NR%)\r\r\rReDim iPovGndDiffAGNPL(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r\rFor j% = 1 To TotPovAGCount\r\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATENPL(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAGNPL(R%, j%) = POVRATENPL(R%, j%, Total) / POVRATENPL(R%, RefAGTot, Total)  'could also use iPovRatioNationalNPL(R%)\rEnd If\r\r'Save initial gender difference for all age groups\riPovGndDiffAGNPL(R%, j%) = POVRATENPL(R%, j%, Female) - POVRATENPL(R%, j%, Male)\rNext\r\r'\rNext R%\rCOMPLETE STRUCTURE:End Sub:7802|\r'jrs 2022/11/22 end\r\rDim iPovGndDiffAGNPL(,) As Single\rDim PovGndDiffRefAGScaleUpNPL() As Single\rDim iPovRatioNationalNPL() As Single\rDim PovGndDiffRefAGShiftNPL() As Single\rDim iPovRateRatioToRefAGNPL(,) As Single\r\rPrivate Sub IFsEcoPovAgeSexNPLFirstYear()\r'----------------------------------------------------------------\r'mti 2021/07/15 new procedure\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG19 As Single\r\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNationalNPL(NR%), PovGndDiffRefAGShiftNPL(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAGNPL(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUpNPL(NR%)\r\r\rReDim iPovGndDiffAGNPL(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAGNPL(R%, j%) * povagesexagratnat\rPOVRATENPL(R%, j%, Total) = AMAX(0, Amin(100, POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAGNPL(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATENPL(R%, j%, Total) = POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATENPL(R%, j%, Total) = AMAX(0, Amin(100, POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAGNPL(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAGNPL(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAGNPL(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATENPL(R%, j%, Total) = AMAX(0, Amin(100, POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 Start\rEnd If\r\r\r\rFor j% = 1 To TotPovAGCount\r\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATENPL(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAGNPL(R%, j%) = POVRATENPL(R%, j%, Total) / POVRATENPL(R%, RefAGTot, Total)  'could also use iPovRatioNationalNPL(R%)\rEnd If\r\r'Save initial gender difference for all age groups\riPovGndDiffAGNPL(R%, j%) = POVRATENPL(R%, j%, Female) - POVRATENPL(R%, j%, Male)\rNext\r\r'\rNext R%\r"
  },
  {
    "Variable": "POVRATENPL",
    "UsesVariable": "povagesexagratnat",
    "Distance": 1,
    "Code": "\r\r\rFor j% = 1 To TotPovAGCount\r\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATENPL(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAGNPL(R%, j%) = POVRATENPL(R%, j%, Total) / POVRATENPL(R%, RefAGTot, Total)  'could also use iPovRatioNationalNPL(R%)\rEnd If\r\r'Save initial gender difference for all age groups\riPovGndDiffAGNPL(R%, j%) = POVRATENPL(R%, j%, Female) - POVRATENPL(R%, j%, Male)\rNext\r\r'\rNext R%\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAGNPL(R%, j%) * povagesexagratnat\rPOVRATENPL(R%, j%, Total) = AMAX(0, Amin(100, POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAGNPL(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATENPL(R%, j%, Total) = POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATENPL(R%, j%, Total) = AMAX(0, Amin(100, POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAGNPL(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAGNPL(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAGNPL(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATENPL(R%, j%, Total) = AMAX(0, Amin(100, POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 Start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7802|\r'jrs 2022/11/22 end\r\rDim iPovGndDiffAGNPL(,) As Single\rDim PovGndDiffRefAGScaleUpNPL() As Single\rDim iPovRatioNationalNPL() As Single\rDim PovGndDiffRefAGShiftNPL() As Single\rDim iPovRateRatioToRefAGNPL(,) As Single\r\rPrivate Sub IFsEcoPovAgeSexNPLFirstYear()\r'----------------------------------------------------------------\r'mti 2021/07/15 new procedure\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG19 As Single\r\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNationalNPL(NR%), PovGndDiffRefAGShiftNPL(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAGNPL(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUpNPL(NR%)\r\r\rReDim iPovGndDiffAGNPL(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r'mti 2021/12/28 start\rIf povagesexagratnat <> 0 Then\r\rFor j% = 1 To TotPovAGCount\r'Poverty (Age group - multiple of all ages)\rPovRateRatioToRefAG_Cur = iPovRateRatioToRefAGNPL(R%, j%) * povagesexagratnat\rPOVRATENPL(R%, j%, Total) = AMAX(0, Amin(100, POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\r\rIf iGDPPCP(R%) >= IncomeTrgt Then\r'at year 1 country already at target income; poverty ratio to ref group merges to target value temporally\rFor j% = 1 To TotPovAGCount\r'temporal (20 yr) convergence of initial ratio to target ratio\rPovRateRatioToRefAG_Cur = ConvergeOverTime(iPovRateRatioToRefAGNPL(R%, j%), CSng(PovRateRatioToRefAG_Trgt(j%)), 20) 'AMAX(0, (can be in both direction)\r'POVRATENPL(R%, j%, Total) = POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur\rPOVRATENPL(R%, j%, Total) = AMAX(0, Amin(100, POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rElse  'negatives will also be handled below\rIncTrgtCovd = (sGDPPCP(R%) - iGDPPCP(R%)) / (IncomeTrgt - iGDPPCP(R%))\r\rIf sGDPPCP(R%) < iGDPPCP(R%) Then  'declining income; increasing national poverty\r\rFor j% = 1 To TotPovAGCount - 1\rIf PovRateRatioToRefAG_Trgt(j%) < iPovRateRatioToRefAGNPL(R%, j%) Then  'Venzuela: 60+: 1.4 initial; .52 target\rIncTrgtCovd = 0 'initial AG/refAG Pov ratio higher than target;\rEnd If\rNext\rEnd If\r\rEnd If\r\r\rFor j% = 1 To TotPovAGCount\r\r'Poverty (AG multiple of all ages) target covered up so far  = IncTrgtCovd\rPovRateRatioToRefAG_Cur = CSng(iPovRateRatioToRefAGNPL(R%, j%) + IncTrgtCovd * (PovRateRatioToRefAG_Trgt(j%) - iPovRateRatioToRefAGNPL(R%, j%)))  'AMAX(0, (can be in both direction)\r\rPOVRATENPL(R%, j%, Total) = AMAX(0, Amin(100, POVRATENPL(R%, RefAGTot, Total) * PovRateRatioToRefAG_Cur))\rNext\rEnd If\r'mti 2021/12/28 Start\rEnd If\rCOMPLETE STRUCTURE:End Sub:7802|\r'jrs 2022/11/22 end\r\rDim iPovGndDiffAGNPL(,) As Single\rDim PovGndDiffRefAGScaleUpNPL() As Single\rDim iPovRatioNationalNPL() As Single\rDim PovGndDiffRefAGShiftNPL() As Single\rDim iPovRateRatioToRefAGNPL(,) As Single\r\rPrivate Sub IFsEcoPovAgeSexNPLFirstYear()\r'----------------------------------------------------------------\r'mti 2021/07/15 new procedure\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG19 As Single\r\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNationalNPL(NR%), PovGndDiffRefAGShiftNPL(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAGNPL(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUpNPL(NR%)\r\r\rReDim iPovGndDiffAGNPL(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r\r\r\rFor j% = 1 To TotPovAGCount\r\r'Save initial ratio of age-group poverty to that of the reference age group\rIf POVRATENPL(R%, RefAGTot, Total) > 0 Then\riPovRateRatioToRefAGNPL(R%, j%) = POVRATENPL(R%, j%, Total) / POVRATENPL(R%, RefAGTot, Total)  'could also use iPovRatioNationalNPL(R%)\rEnd If\r\r'Save initial gender difference for all age groups\riPovGndDiffAGNPL(R%, j%) = POVRATENPL(R%, j%, Female) - POVRATENPL(R%, j%, Male)\rNext\r\r'\rNext R%\r"
  },
  {
    "Variable": "POVRATENPL",
    "UsesVariable": "INCOMELTNPLLN",
    "Distance": 0,
    "Code": "\r\rPrivate Sub IFsEcoPovAgeSexNPLAllButFirst()\r\r'   All But First:  Poverty by age-sex\r'   -------------------------------------------\r\r\r'All But First: Compute population by poverty age-sex grouping\r'------------------------------------------------------------\r'Aggagedstflex agStart, agEnd, POPPOVAG 'agedstpov\r\r\r'All But First: Compue poverty rates by age group for both sexes combined\r'--------------------------------------------------------------------------\rFor R% = 1 To NR%\r\rIf INCOMELTNPLLN(R%) = 0 Then 'no poverty\rPOVRATENPL(R%, RefAGTot, Total) = 0\rElse\r'poverty rate,  both sexes = national poverty rate, when reference AG is All Ages\rPOVRATENPL(R%, RefAGTot, Total) = 100 * INCOMELTNPLLN(R%) / POP(R%)\rEnd If\rCOMPLETE STRUCTURE:End Sub:7802|\r'jrs 2022/11/22 end\r\rDim iPovGndDiffAGNPL(,) As Single\rDim PovGndDiffRefAGScaleUpNPL() As Single\rDim iPovRatioNationalNPL() As Single\rDim PovGndDiffRefAGShiftNPL() As Single\rDim iPovRateRatioToRefAGNPL(,) As Single\r\rPrivate Sub IFsEcoPovAgeSexNPLFirstYear()\r'----------------------------------------------------------------\r'mti 2021/07/15 new procedure\rDim j%, R%\r\r'gvdb 2024/04/05\r' unused variable\rDim PovGndDiffRefAG As Single, PovGndDiffRefAGComp As Single ', PovGndDiffAG As Single\r'Dim IncomeTrgt As Single, IncTrgtCovd As Single, PovRateRatioToRefAG_Cur As Single\rDim RefAGGnd%, RefAGTot%\r'Dim ChangePovGndDiffRefAG As Single\rDim PovGndDiffRefAG19 As Single\r\r\r'   First Year: Age-sex population by poverty age groups\r'   ----------------------------------------------------------\r\r\r'    ReDim agStart(TotPovAGCount), agEnd(TotPovAGCount)\r\rReDim PovRateRatioToRefAG_Trgt(TotPovAGCount)\rReDim iGDPPCP(NR%), iPovRatioNationalNPL(NR%), PovGndDiffRefAGShiftNPL(NR%)\r'mti 2020/03/18 Start\rReDim iPovRateRatioToRefAGNPL(NR%, TotPovAGCount)  ', iPovGndDiffRatioToRefAG(NR%, TotPovAGCount)\rReDim PovGndDiffRefAGScaleUpNPL(NR%)\r\r\rReDim iPovGndDiffAGNPL(NR%, TotPovAGCount)\r'gvdb 2024/04/05\r' unused variable\r'Dim PcntChangeDiffRefAG, PcntPointChangeDiffRefAG As Single\r'mti 2020/03/18 End\r\r'Dim AdjPovDiff As Single\r\r\r'    'Poverty Age Group to five year age group mapping\r'    agStart(AG_0_14) = 1: agEnd(AG_0_14) = 3\r'    agStart(AG_15_24) = 4: agEnd(AG_15_24) = 5\r'    agStart(AG_25_34) = 6: agEnd(AG_25_34) = 7\r'    agStart(AG_35_39) = 8: agEnd(AG_35_39) = 8\r'    agStart(AG_40_49) = 9: agEnd(AG_40_49) = 10\r'    agStart(AG_50_54) = 11: agEnd(AG_50_54) = 11\r'    agStart(AG_55_59) = 12: agEnd(AG_55_59) = 12\r'    agStart(AG_60_Over) = 13: agEnd(AG_60_Over) = NCohorts\r'    agStart(AG_AllAges) = 1: agEnd(AG_AllAges) = NCohorts\r'\r'    'Aggregate population to poverty age groups\r'    Aggagedstflex agStart, agEnd, POPPOVAG ' agedstpov\r\r'Read target (HIC) ratios of age-group poverty rates to ref AG poverty rates\rGetPovTrgt(PovRateRatioToRefAG_Trgt)\r\r'Reference Age Groups\rRefAGTot = AG_AllAges\r"
  },
  {
    "Variable": "POWER",
    "UsesVariable": "DIPLOEMBASSY",
    "Distance": 25,
    "Code": "\rIf SGOVNUCWP(R%) > 0 Then\rpower_GovNucWP = CSng(Log(SGOVNUCWP(R%)) / AMAX(0.001, WGOVNUCWP))\rEnd If\r\r'dkb 2014/10/23 - new EnergyNetExport specification - END\r'dkb 2014/10/06 - As per Tim Smith's request, power_EnergyNetExport is not allowed to go below 0 - END\r\r'              If IY% = 1 Then\r'            power_EnergyNetExport = (XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)\r'       Else\r'            power_EnergyNetExport = SENX(R%) / AMAX(0.001, WENX)\r'       End If\r\rpower_TradeTotal = (X(R%) + M(R%)) / AMAX(0.001, WTradeTotal)\r\rPOWER_TECH = GDP(R%) * GDPPC(R%) / AMAX(0.001, WTECH)\r\rpower_mil = SGDSMil(R%) / AMAX(0.001, WGDSMIL)\r\r\r'dkb 2014/10/27 - Not using save variables for first year - START\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\rIf IY% = 1 Then\r'power_embassy = ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((DIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((DIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'(0.33 * ((DIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'(0.17 * (((DIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r\rpower_embassy = DIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = DIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = DIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * DIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\rpower_dpi = CSng(((((99.83 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                    (35.49 * (DIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                    (7.34 * ((DIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                    AMAX(0.001, WDPI))\r'power_dpi = (((0.5 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (DIPLOIGO(R%) / DIPLOIGOMAX)) + _\r' (0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\r\rElse\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\r'power_embassy = ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'   (0.33 * ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'  (0.17 * (((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r' AMAX(0.001, WDPI)\rpower_embassy = SDIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = SDIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = SDIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\r'power_dpi = ((((0.5 * SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * SDIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\rpower_dpi = CSng(((((99.83 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                                (35.49 * (SDIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                                (7.34 * ((SDIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                                AMAX(0.001, WDPI))\r\r''power_dpi = (((0.5 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (SDIPLOIGO(R%) / DIPLOIGOMAX)) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\rEnd If\r\r'dkb 2014/09/24 - Hardcoding POWERHHMI components - END\r\r'jrs 2021/04/09 (item 19 + 7 + 5 + 12 + 10)\rPOWER(R%) = CSng(0.2 * power_embassy + 0.2 * power_mil + 0.2 * POWER_TECH + 0.2 * power_TradeTotal + 0.2 * power_GovNucWP)\r\r'jrs 2021/04/26\rPOWER(R%) = POWER(R%) * 100\r"
  },
  {
    "Variable": "POWER",
    "UsesVariable": "GDP",
    "Distance": 52,
    "Code": "\rIf SGOVNUCWP(R%) > 0 Then\rpower_GovNucWP = CSng(Log(SGOVNUCWP(R%)) / AMAX(0.001, WGOVNUCWP))\rEnd If\r"
  },
  {
    "Variable": "POWER",
    "UsesVariable": "GDPPC",
    "Distance": 52,
    "Code": "\rIf SGOVNUCWP(R%) > 0 Then\rpower_GovNucWP = CSng(Log(SGOVNUCWP(R%)) / AMAX(0.001, WGOVNUCWP))\rEnd If\r"
  },
  {
    "Variable": "POWER",
    "UsesVariable": "X",
    "Distance": 36,
    "Code": "\rIf SGOVNUCWP(R%) > 0 Then\rpower_GovNucWP = CSng(Log(SGOVNUCWP(R%)) / AMAX(0.001, WGOVNUCWP))\rEnd If\r"
  },
  {
    "Variable": "POWER",
    "UsesVariable": "M",
    "Distance": 36,
    "Code": "\rIf SGOVNUCWP(R%) > 0 Then\rpower_GovNucWP = CSng(Log(SGOVNUCWP(R%)) / AMAX(0.001, WGOVNUCWP))\rEnd If\r"
  },
  {
    "Variable": "POWER",
    "UsesVariable": "GOVNUCWP",
    "Distance": 45,
    "Code": "\rIf SGOVNUCWP(R%) > 0 Then\rpower_GovNucWP = CSng(Log(SGOVNUCWP(R%)) / AMAX(0.001, WGOVNUCWP))\rEnd If\r"
  },
  {
    "Variable": "POWERGPI",
    "UsesVariable": "GDP",
    "Distance": 82,
    "Code": "\r'dkb 2014/10/27 - Not using save variables for first year - START\r'clp 2016/08/23 - Update to match new calculations from Tim/Alanna\r'power_effectivehumancap = ((POP15TO65(R%) - (SINCOMELT1LN(R%) * (POP15TO65(R%) / POP(R%))) - _\r' (((SINCOMELT2LN(R%) - SINCOMELT1LN(R%)) / 2) * (POP15TO65(R%) / POP(R%)))) * SHDINEW(R%)) / AMAX(0.001, WEHC)\r\r'power_effectivehumancap = ((POP15TO65(R%) - (SINCOMELT190LN(R%) * (POP15TO65(R%) / POP(R%))) - _\r'(((SINCOMELT310LN(R%) - SINCOMELT190LN(R%)) / 2) * (POP15TO65(R%) / POP(R%)))) * SHDINEW(R%)) / AMAX(0.001, WEHC)\r'jrs 2021/09/02 changed from 3.10 to 3.20/day\r'power_effectivehumancap = (((POP(R%) - SINCOMELT310LN(R%)) * (POP15TO65(R%) / POP(R%))) * SHDINEW(R%) * SHDINEW(R%)) / AMAX(0.001, WEHC)\r'jrs 2021/11/21\rIf ConstantDollarsYear = 2011 Then\rpower_effectivehumancap = (((POP(R%) - SINCOMELT320LN(R%)) * (POP15TO65(R%) / POP(R%))) * SHDINEW(R%) * SHDINEW(R%)) / AMAX(0.001, WEHC)\rElse\rpower_effectivehumancap = (((POP(R%) - SINCOMELT365LN(R%)) * (POP15TO65(R%) / POP(R%))) * SHDINEW(R%) * SHDINEW(R%)) / AMAX(0.001, WEHC)\rEnd If\r\r\r'dkb 2014/10/27 - Not using save variables for first year - START\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\rIf IY% = 1 Then\r'power_embassy = ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((DIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((DIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'(0.33 * ((DIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'(0.17 * (((DIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r\rpower_embassy = DIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = DIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = DIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * DIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\rpower_dpi = CSng(((((99.83 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                    (35.49 * (DIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                    (7.34 * ((DIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                    AMAX(0.001, WDPI))\r'power_dpi = (((0.5 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (DIPLOIGO(R%) / DIPLOIGOMAX)) + _\r' (0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\r\rElse\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\r'power_embassy = ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'   (0.33 * ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'  (0.17 * (((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r' AMAX(0.001, WDPI)\rpower_embassy = SDIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = SDIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = SDIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\r'power_dpi = ((((0.5 * SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * SDIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\rpower_dpi = CSng(((((99.83 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                                (35.49 * (SDIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                                (7.34 * ((SDIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                                AMAX(0.001, WDPI))\r\r''power_dpi = (((0.5 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (SDIPLOIGO(R%) / DIPLOIGOMAX)) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\rEnd If\r\rpower_ConnectivityICTProd = KS(R%, 6) / AMAX(0.001, WConnectivityICTProd)\r\r'clp 2016/08/26 - Adding power_RandD\rpower_RandD = (SGDSRandD(R%) / AMAX(0.001, WGDSRandD))\r\r\rIf AID(R%) < 0 Then 'AID power of that of donors (net aid receipts<0) not recipients (aid>0)\rpower_AID = 0 - AID(R%) / AMAX(0.001, WAID)\rEnd If\r\rpower_FDIInflows = XFDIFIN(R%) / AMAX(0.001, WXFDIFIN)\r\r'dkb 2014/10/23 - new EnergyNetExport specification - END\r'dkb 2014/10/06 - As per Tim Smith's request, power_EnergyNetExport is not allowed to go below 0 - END\r\r'              If IY% = 1 Then\r'            power_EnergyNetExport = (XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)\r'       Else\r'            power_EnergyNetExport = SENX(R%) / AMAX(0.001, WENX)\r'       End If\r\rpower_TradeTotal = (X(R%) + M(R%)) / AMAX(0.001, WTradeTotal)\r\r\r'       If IY% = 1 Then\r'            power_EnergyNetExport = ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'        AMAX(0.001, WENM))\r'       Else\r'            power_EnergyNetExport = (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM))\r'       End If\r\r'dkb 2014/10/06 - As per Tim Smith's request, power_EnergyNetExport is not allowed to go below 0 - START\r'dkb 2014/10/23 - new EnergyNetExport specification - START\r'clp 2016/08/25 - adding energy production variable\rIf IY% = 1 Then\r'    power_EnergyNetExport = AMAX(0, ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, (XS(R%, Ener) / WEPBYEAR) - ((MS(R%, Ener) / WEPBYEAR))) / AMAX(0.001, WENXM)\r\rEnTot = 0\rFor E = 1 To Renew 'Oil, gas, coal, hydro, nuclear, renewable\rIf E <= Hydro Then\rEnTot = EnTot + ENP(R%, E)\r'bbh 2011/10/16\r'Else\r'   EnTot = EnTot + ENP(R%, e%) '* 0.5\rEnd If\rNext E\r\rpower_EnProd = EnTot / WENProd\r\rElse\r'   power_EnergyNetExport = AMAX(0, (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, SENX(R%) - SENM(R%)) / AMAX(0.001, WENXM)\rpower_EnProd = SEnTotal(R%) / WENProd\r\rEnd If\r\r\r'       If IY% = 1 Then\r'            power_EnergyNetExport = ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'        AMAX(0.001, WENM))\r'       Else\r'            power_EnergyNetExport = (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM))\r'       End If\r\r'dkb 2014/10/06 - As per Tim Smith's request, power_EnergyNetExport is not allowed to go below 0 - START\r'dkb 2014/10/23 - new EnergyNetExport specification - START\r'clp 2016/08/25 - adding energy production variable\rIf IY% = 1 Then\r'    power_EnergyNetExport = AMAX(0, ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, (XS(R%, Ener) / WEPBYEAR) - ((MS(R%, Ener) / WEPBYEAR))) / AMAX(0.001, WENXM)\r\rEnTot = 0\rFor E = 1 To Renew 'Oil, gas, coal, hydro, nuclear, renewable\rIf E <= Hydro Then\rEnTot = EnTot + ENP(R%, E)\r'bbh 2011/10/16\r'Else\r'   EnTot = EnTot + ENP(R%, e%) '* 0.5\rEnd If\rNext E\r\rpower_EnProd = EnTot / WENProd\r\rElse\r'   power_EnergyNetExport = AMAX(0, (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, SENX(R%) - SENM(R%)) / AMAX(0.001, WENXM)\rpower_EnProd = SEnTotal(R%) / WENProd\r\rEnd If\r\rIf SGOVNUCWP(R%) > 0 Then\rpower_GovNucWP = CSng(Log(SGOVNUCWP(R%)) / AMAX(0.001, WGOVNUCWP))\rEnd If\r\rpower_mil = SGDSMil(R%) / AMAX(0.001, WGDSMIL)\r\rpower_GDP = GDP(R%) / AMAX(0.001, WGDP)\r\rpowerGPI_effectivehumancap = CSng(power_effectivehumancap * 0.05)\r\rpowerGPI_dpi = CSng(power_dpi * 0.2)\r\rpowerGPI_ConnectivityICTProd = CSng(power_ConnectivityICTProd * 0.05)\r\r'clp 2016/08/26 - New R&D calculation for GPI\r'powerGPI_InnovationRD = power_InnovationRD * 0.05\rpowerGPI_InnovationRD = CSng(power_RandD * 0.05)\r\rpowerGPI_AID = CSng(power_AID * 0.05)\r\rpowerGPI_FDIInflows = CSng(power_FDIInflows * 0.05)\r\rpowerGPI_TradeTotal = CSng(power_TradeTotal * 0.05)\r\r'clp 2016/08/25 - changed Energy Exports to production\r'powerGPI_EnergyNetExport = power_EnergyNetExport * 0.05\rpowerGPI_EnergyNetExport = CSng(power_EnProd * 0.05)\r\rpowerGPI_GovNucWP = CSng(power_GovNucWP * 0.05)\r\rpowerGPI_mil = CSng(power_mil * 0.2)\r\r\r'If RegName(R%) = \"Seychelles\" Then Stop\r\r'dkb 2014/09/24 - Hardcoding POWERGPI components - START\r'clp 2016/08/23 - Updated GPI weights\r'powerGPI_GDPPPP = power_GDPPPP * 0.2\rpowerGPI_GDPPPP = CSng(power_GDP * 0.2)\r\r\rPOWERGPI(R%) = powerGPI_GDPPPP + powerGPI_mil + powerGPI_GovNucWP + powerGPI_EnergyNetExport +\r                powerGPI_TradeTotal + powerGPI_FDIInflows + powerGPI_AID + powerGPI_InnovationRD +\r                powerGPI_ConnectivityICTProd + powerGPI_dpi + powerGPI_effectivehumancap\r\r'POWERGPI(R%) = AMAX(-0.1, POWERGPI(R%) / AMAX(0.001, 1 - 0.05) * 100)\rPOWERGPI(R%) = AMAX(-0.1, POWERGPI(R%) / AMAX(0.001, 1) * 100)\r\rPOWERGPI(R%) = AMAX(0.000001, Amin(90, POWERGPI(R%)))\r"
  },
  {
    "Variable": "POWERGPI",
    "UsesVariable": "WGDP",
    "Distance": 82,
    "Code": "\r'dkb 2014/10/27 - Not using save variables for first year - START\r'clp 2016/08/23 - Update to match new calculations from Tim/Alanna\r'power_effectivehumancap = ((POP15TO65(R%) - (SINCOMELT1LN(R%) * (POP15TO65(R%) / POP(R%))) - _\r' (((SINCOMELT2LN(R%) - SINCOMELT1LN(R%)) / 2) * (POP15TO65(R%) / POP(R%)))) * SHDINEW(R%)) / AMAX(0.001, WEHC)\r\r'power_effectivehumancap = ((POP15TO65(R%) - (SINCOMELT190LN(R%) * (POP15TO65(R%) / POP(R%))) - _\r'(((SINCOMELT310LN(R%) - SINCOMELT190LN(R%)) / 2) * (POP15TO65(R%) / POP(R%)))) * SHDINEW(R%)) / AMAX(0.001, WEHC)\r'jrs 2021/09/02 changed from 3.10 to 3.20/day\r'power_effectivehumancap = (((POP(R%) - SINCOMELT310LN(R%)) * (POP15TO65(R%) / POP(R%))) * SHDINEW(R%) * SHDINEW(R%)) / AMAX(0.001, WEHC)\r'jrs 2021/11/21\rIf ConstantDollarsYear = 2011 Then\rpower_effectivehumancap = (((POP(R%) - SINCOMELT320LN(R%)) * (POP15TO65(R%) / POP(R%))) * SHDINEW(R%) * SHDINEW(R%)) / AMAX(0.001, WEHC)\rElse\rpower_effectivehumancap = (((POP(R%) - SINCOMELT365LN(R%)) * (POP15TO65(R%) / POP(R%))) * SHDINEW(R%) * SHDINEW(R%)) / AMAX(0.001, WEHC)\rEnd If\r"
  },
  {
    "Variable": "POWERGPI",
    "UsesVariable": "GOVNUCWP",
    "Distance": 73,
    "Code": "\r'dkb 2014/10/27 - Not using save variables for first year - START\r'clp 2016/08/23 - Update to match new calculations from Tim/Alanna\r'power_effectivehumancap = ((POP15TO65(R%) - (SINCOMELT1LN(R%) * (POP15TO65(R%) / POP(R%))) - _\r' (((SINCOMELT2LN(R%) - SINCOMELT1LN(R%)) / 2) * (POP15TO65(R%) / POP(R%)))) * SHDINEW(R%)) / AMAX(0.001, WEHC)\r\r'power_effectivehumancap = ((POP15TO65(R%) - (SINCOMELT190LN(R%) * (POP15TO65(R%) / POP(R%))) - _\r'(((SINCOMELT310LN(R%) - SINCOMELT190LN(R%)) / 2) * (POP15TO65(R%) / POP(R%)))) * SHDINEW(R%)) / AMAX(0.001, WEHC)\r'jrs 2021/09/02 changed from 3.10 to 3.20/day\r'power_effectivehumancap = (((POP(R%) - SINCOMELT310LN(R%)) * (POP15TO65(R%) / POP(R%))) * SHDINEW(R%) * SHDINEW(R%)) / AMAX(0.001, WEHC)\r'jrs 2021/11/21\rIf ConstantDollarsYear = 2011 Then\rpower_effectivehumancap = (((POP(R%) - SINCOMELT320LN(R%)) * (POP15TO65(R%) / POP(R%))) * SHDINEW(R%) * SHDINEW(R%)) / AMAX(0.001, WEHC)\rElse\rpower_effectivehumancap = (((POP(R%) - SINCOMELT365LN(R%)) * (POP15TO65(R%) / POP(R%))) * SHDINEW(R%) * SHDINEW(R%)) / AMAX(0.001, WEHC)\rEnd If\r"
  },
  {
    "Variable": "POWERGPI",
    "UsesVariable": "X",
    "Distance": 64,
    "Code": "\r\r'       If IY% = 1 Then\r'            power_EnergyNetExport = ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'        AMAX(0.001, WENM))\r'       Else\r'            power_EnergyNetExport = (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM))\r'       End If\r\r'dkb 2014/10/06 - As per Tim Smith's request, power_EnergyNetExport is not allowed to go below 0 - START\r'dkb 2014/10/23 - new EnergyNetExport specification - START\r'clp 2016/08/25 - adding energy production variable\rIf IY% = 1 Then\r'    power_EnergyNetExport = AMAX(0, ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, (XS(R%, Ener) / WEPBYEAR) - ((MS(R%, Ener) / WEPBYEAR))) / AMAX(0.001, WENXM)\r\rEnTot = 0\rFor E = 1 To Renew 'Oil, gas, coal, hydro, nuclear, renewable\rIf E <= Hydro Then\rEnTot = EnTot + ENP(R%, E)\r'bbh 2011/10/16\r'Else\r'   EnTot = EnTot + ENP(R%, e%) '* 0.5\rEnd If\rNext E\r\rpower_EnProd = EnTot / WENProd\r\rElse\r'   power_EnergyNetExport = AMAX(0, (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, SENX(R%) - SENM(R%)) / AMAX(0.001, WENXM)\rpower_EnProd = SEnTotal(R%) / WENProd\r\rEnd If\r\r\r'       If IY% = 1 Then\r'            power_EnergyNetExport = ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'        AMAX(0.001, WENM))\r'       Else\r'            power_EnergyNetExport = (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM))\r'       End If\r\r'dkb 2014/10/06 - As per Tim Smith's request, power_EnergyNetExport is not allowed to go below 0 - START\r'dkb 2014/10/23 - new EnergyNetExport specification - START\r'clp 2016/08/25 - adding energy production variable\rIf IY% = 1 Then\r'    power_EnergyNetExport = AMAX(0, ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, (XS(R%, Ener) / WEPBYEAR) - ((MS(R%, Ener) / WEPBYEAR))) / AMAX(0.001, WENXM)\r\rEnTot = 0\rFor E = 1 To Renew 'Oil, gas, coal, hydro, nuclear, renewable\rIf E <= Hydro Then\rEnTot = EnTot + ENP(R%, E)\r'bbh 2011/10/16\r'Else\r'   EnTot = EnTot + ENP(R%, e%) '* 0.5\rEnd If\rNext E\r\rpower_EnProd = EnTot / WENProd\r\rElse\r'   power_EnergyNetExport = AMAX(0, (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, SENX(R%) - SENM(R%)) / AMAX(0.001, WENXM)\rpower_EnProd = SEnTotal(R%) / WENProd\r\rEnd If\r"
  },
  {
    "Variable": "POWERGPI",
    "UsesVariable": "M",
    "Distance": 64,
    "Code": "\r\r'       If IY% = 1 Then\r'            power_EnergyNetExport = ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'        AMAX(0.001, WENM))\r'       Else\r'            power_EnergyNetExport = (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM))\r'       End If\r\r'dkb 2014/10/06 - As per Tim Smith's request, power_EnergyNetExport is not allowed to go below 0 - START\r'dkb 2014/10/23 - new EnergyNetExport specification - START\r'clp 2016/08/25 - adding energy production variable\rIf IY% = 1 Then\r'    power_EnergyNetExport = AMAX(0, ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, (XS(R%, Ener) / WEPBYEAR) - ((MS(R%, Ener) / WEPBYEAR))) / AMAX(0.001, WENXM)\r\rEnTot = 0\rFor E = 1 To Renew 'Oil, gas, coal, hydro, nuclear, renewable\rIf E <= Hydro Then\rEnTot = EnTot + ENP(R%, E)\r'bbh 2011/10/16\r'Else\r'   EnTot = EnTot + ENP(R%, e%) '* 0.5\rEnd If\rNext E\r\rpower_EnProd = EnTot / WENProd\r\rElse\r'   power_EnergyNetExport = AMAX(0, (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, SENX(R%) - SENM(R%)) / AMAX(0.001, WENXM)\rpower_EnProd = SEnTotal(R%) / WENProd\r\rEnd If\r"
  },
  {
    "Variable": "POWERGPI",
    "UsesVariable": "XFDIFIN",
    "Distance": 63,
    "Code": "\r\r'       If IY% = 1 Then\r'            power_EnergyNetExport = ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'        AMAX(0.001, WENM))\r'       Else\r'            power_EnergyNetExport = (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM))\r'       End If\r\r'dkb 2014/10/06 - As per Tim Smith's request, power_EnergyNetExport is not allowed to go below 0 - START\r'dkb 2014/10/23 - new EnergyNetExport specification - START\r'clp 2016/08/25 - adding energy production variable\rIf IY% = 1 Then\r'    power_EnergyNetExport = AMAX(0, ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, (XS(R%, Ener) / WEPBYEAR) - ((MS(R%, Ener) / WEPBYEAR))) / AMAX(0.001, WENXM)\r\rEnTot = 0\rFor E = 1 To Renew 'Oil, gas, coal, hydro, nuclear, renewable\rIf E <= Hydro Then\rEnTot = EnTot + ENP(R%, E)\r'bbh 2011/10/16\r'Else\r'   EnTot = EnTot + ENP(R%, e%) '* 0.5\rEnd If\rNext E\r\rpower_EnProd = EnTot / WENProd\r\rElse\r'   power_EnergyNetExport = AMAX(0, (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, SENX(R%) - SENM(R%)) / AMAX(0.001, WENXM)\rpower_EnProd = SEnTotal(R%) / WENProd\r\rEnd If\r"
  },
  {
    "Variable": "POWERGPI",
    "UsesVariable": "AID",
    "Distance": 62,
    "Code": "\r\r'       If IY% = 1 Then\r'            power_EnergyNetExport = ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'        AMAX(0.001, WENM))\r'       Else\r'            power_EnergyNetExport = (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM))\r'       End If\r\r'dkb 2014/10/06 - As per Tim Smith's request, power_EnergyNetExport is not allowed to go below 0 - START\r'dkb 2014/10/23 - new EnergyNetExport specification - START\r'clp 2016/08/25 - adding energy production variable\rIf IY% = 1 Then\r'    power_EnergyNetExport = AMAX(0, ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, (XS(R%, Ener) / WEPBYEAR) - ((MS(R%, Ener) / WEPBYEAR))) / AMAX(0.001, WENXM)\r\rEnTot = 0\rFor E = 1 To Renew 'Oil, gas, coal, hydro, nuclear, renewable\rIf E <= Hydro Then\rEnTot = EnTot + ENP(R%, E)\r'bbh 2011/10/16\r'Else\r'   EnTot = EnTot + ENP(R%, e%) '* 0.5\rEnd If\rNext E\r\rpower_EnProd = EnTot / WENProd\r\rElse\r'   power_EnergyNetExport = AMAX(0, (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, SENX(R%) - SENM(R%)) / AMAX(0.001, WENXM)\rpower_EnProd = SEnTotal(R%) / WENProd\r\rEnd If\r"
  },
  {
    "Variable": "POWERGPI",
    "UsesVariable": "KS",
    "Distance": 58,
    "Code": "\r\r'       If IY% = 1 Then\r'            power_EnergyNetExport = ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'        AMAX(0.001, WENM))\r'       Else\r'            power_EnergyNetExport = (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM))\r'       End If\r\r'dkb 2014/10/06 - As per Tim Smith's request, power_EnergyNetExport is not allowed to go below 0 - START\r'dkb 2014/10/23 - new EnergyNetExport specification - START\r'clp 2016/08/25 - adding energy production variable\rIf IY% = 1 Then\r'    power_EnergyNetExport = AMAX(0, ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, (XS(R%, Ener) / WEPBYEAR) - ((MS(R%, Ener) / WEPBYEAR))) / AMAX(0.001, WENXM)\r\rEnTot = 0\rFor E = 1 To Renew 'Oil, gas, coal, hydro, nuclear, renewable\rIf E <= Hydro Then\rEnTot = EnTot + ENP(R%, E)\r'bbh 2011/10/16\r'Else\r'   EnTot = EnTot + ENP(R%, e%) '* 0.5\rEnd If\rNext E\r\rpower_EnProd = EnTot / WENProd\r\rElse\r'   power_EnergyNetExport = AMAX(0, (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, SENX(R%) - SENM(R%)) / AMAX(0.001, WENXM)\rpower_EnProd = SEnTotal(R%) / WENProd\r\rEnd If\r"
  },
  {
    "Variable": "POWERGPI",
    "UsesVariable": "DIPLOEMBASSY",
    "Distance": 50,
    "Code": "\r\r'       If IY% = 1 Then\r'            power_EnergyNetExport = ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'        AMAX(0.001, WENM))\r'       Else\r'            power_EnergyNetExport = (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM))\r'       End If\r\r'dkb 2014/10/06 - As per Tim Smith's request, power_EnergyNetExport is not allowed to go below 0 - START\r'dkb 2014/10/23 - new EnergyNetExport specification - START\r'clp 2016/08/25 - adding energy production variable\rIf IY% = 1 Then\r'    power_EnergyNetExport = AMAX(0, ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, (XS(R%, Ener) / WEPBYEAR) - ((MS(R%, Ener) / WEPBYEAR))) / AMAX(0.001, WENXM)\r\rEnTot = 0\rFor E = 1 To Renew 'Oil, gas, coal, hydro, nuclear, renewable\rIf E <= Hydro Then\rEnTot = EnTot + ENP(R%, E)\r'bbh 2011/10/16\r'Else\r'   EnTot = EnTot + ENP(R%, e%) '* 0.5\rEnd If\rNext E\r\rpower_EnProd = EnTot / WENProd\r\rElse\r'   power_EnergyNetExport = AMAX(0, (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, SENX(R%) - SENM(R%)) / AMAX(0.001, WENXM)\rpower_EnProd = SEnTotal(R%) / WENProd\r\rEnd If\r"
  },
  {
    "Variable": "POWERGPI",
    "UsesVariable": "DIPLOEMBASSYMAX",
    "Distance": 50,
    "Code": "\r\r'       If IY% = 1 Then\r'            power_EnergyNetExport = ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'        AMAX(0.001, WENM))\r'       Else\r'            power_EnergyNetExport = (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM))\r'       End If\r\r'dkb 2014/10/06 - As per Tim Smith's request, power_EnergyNetExport is not allowed to go below 0 - START\r'dkb 2014/10/23 - new EnergyNetExport specification - START\r'clp 2016/08/25 - adding energy production variable\rIf IY% = 1 Then\r'    power_EnergyNetExport = AMAX(0, ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, (XS(R%, Ener) / WEPBYEAR) - ((MS(R%, Ener) / WEPBYEAR))) / AMAX(0.001, WENXM)\r\rEnTot = 0\rFor E = 1 To Renew 'Oil, gas, coal, hydro, nuclear, renewable\rIf E <= Hydro Then\rEnTot = EnTot + ENP(R%, E)\r'bbh 2011/10/16\r'Else\r'   EnTot = EnTot + ENP(R%, e%) '* 0.5\rEnd If\rNext E\r\rpower_EnProd = EnTot / WENProd\r\rElse\r'   power_EnergyNetExport = AMAX(0, (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, SENX(R%) - SENM(R%)) / AMAX(0.001, WENXM)\rpower_EnProd = SEnTotal(R%) / WENProd\r\rEnd If\r"
  },
  {
    "Variable": "POWERGPI",
    "UsesVariable": "DIPLOIGO",
    "Distance": 50,
    "Code": "\r\r'       If IY% = 1 Then\r'            power_EnergyNetExport = ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'        AMAX(0.001, WENM))\r'       Else\r'            power_EnergyNetExport = (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM))\r'       End If\r\r'dkb 2014/10/06 - As per Tim Smith's request, power_EnergyNetExport is not allowed to go below 0 - START\r'dkb 2014/10/23 - new EnergyNetExport specification - START\r'clp 2016/08/25 - adding energy production variable\rIf IY% = 1 Then\r'    power_EnergyNetExport = AMAX(0, ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, (XS(R%, Ener) / WEPBYEAR) - ((MS(R%, Ener) / WEPBYEAR))) / AMAX(0.001, WENXM)\r\rEnTot = 0\rFor E = 1 To Renew 'Oil, gas, coal, hydro, nuclear, renewable\rIf E <= Hydro Then\rEnTot = EnTot + ENP(R%, E)\r'bbh 2011/10/16\r'Else\r'   EnTot = EnTot + ENP(R%, e%) '* 0.5\rEnd If\rNext E\r\rpower_EnProd = EnTot / WENProd\r\rElse\r'   power_EnergyNetExport = AMAX(0, (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, SENX(R%) - SENM(R%)) / AMAX(0.001, WENXM)\rpower_EnProd = SEnTotal(R%) / WENProd\r\rEnd If\r"
  },
  {
    "Variable": "POWERGPI",
    "UsesVariable": "DIPLOIGOMAX",
    "Distance": 50,
    "Code": "\r\r'       If IY% = 1 Then\r'            power_EnergyNetExport = ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'        AMAX(0.001, WENM))\r'       Else\r'            power_EnergyNetExport = (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM))\r'       End If\r\r'dkb 2014/10/06 - As per Tim Smith's request, power_EnergyNetExport is not allowed to go below 0 - START\r'dkb 2014/10/23 - new EnergyNetExport specification - START\r'clp 2016/08/25 - adding energy production variable\rIf IY% = 1 Then\r'    power_EnergyNetExport = AMAX(0, ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, (XS(R%, Ener) / WEPBYEAR) - ((MS(R%, Ener) / WEPBYEAR))) / AMAX(0.001, WENXM)\r\rEnTot = 0\rFor E = 1 To Renew 'Oil, gas, coal, hydro, nuclear, renewable\rIf E <= Hydro Then\rEnTot = EnTot + ENP(R%, E)\r'bbh 2011/10/16\r'Else\r'   EnTot = EnTot + ENP(R%, e%) '* 0.5\rEnd If\rNext E\r\rpower_EnProd = EnTot / WENProd\r\rElse\r'   power_EnergyNetExport = AMAX(0, (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, SENX(R%) - SENM(R%)) / AMAX(0.001, WENXM)\rpower_EnProd = SEnTotal(R%) / WENProd\r\rEnd If\r"
  },
  {
    "Variable": "POWERGPI",
    "UsesVariable": "DIPLOTREATY",
    "Distance": 50,
    "Code": "\r\r'       If IY% = 1 Then\r'            power_EnergyNetExport = ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'        AMAX(0.001, WENM))\r'       Else\r'            power_EnergyNetExport = (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM))\r'       End If\r\r'dkb 2014/10/06 - As per Tim Smith's request, power_EnergyNetExport is not allowed to go below 0 - START\r'dkb 2014/10/23 - new EnergyNetExport specification - START\r'clp 2016/08/25 - adding energy production variable\rIf IY% = 1 Then\r'    power_EnergyNetExport = AMAX(0, ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, (XS(R%, Ener) / WEPBYEAR) - ((MS(R%, Ener) / WEPBYEAR))) / AMAX(0.001, WENXM)\r\rEnTot = 0\rFor E = 1 To Renew 'Oil, gas, coal, hydro, nuclear, renewable\rIf E <= Hydro Then\rEnTot = EnTot + ENP(R%, E)\r'bbh 2011/10/16\r'Else\r'   EnTot = EnTot + ENP(R%, e%) '* 0.5\rEnd If\rNext E\r\rpower_EnProd = EnTot / WENProd\r\rElse\r'   power_EnergyNetExport = AMAX(0, (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, SENX(R%) - SENM(R%)) / AMAX(0.001, WENXM)\rpower_EnProd = SEnTotal(R%) / WENProd\r\rEnd If\r"
  },
  {
    "Variable": "POWERGPI",
    "UsesVariable": "DIPLOTREATYMAX",
    "Distance": 50,
    "Code": "\r\r'       If IY% = 1 Then\r'            power_EnergyNetExport = ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'        AMAX(0.001, WENM))\r'       Else\r'            power_EnergyNetExport = (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM))\r'       End If\r\r'dkb 2014/10/06 - As per Tim Smith's request, power_EnergyNetExport is not allowed to go below 0 - START\r'dkb 2014/10/23 - new EnergyNetExport specification - START\r'clp 2016/08/25 - adding energy production variable\rIf IY% = 1 Then\r'    power_EnergyNetExport = AMAX(0, ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, (XS(R%, Ener) / WEPBYEAR) - ((MS(R%, Ener) / WEPBYEAR))) / AMAX(0.001, WENXM)\r\rEnTot = 0\rFor E = 1 To Renew 'Oil, gas, coal, hydro, nuclear, renewable\rIf E <= Hydro Then\rEnTot = EnTot + ENP(R%, E)\r'bbh 2011/10/16\r'Else\r'   EnTot = EnTot + ENP(R%, e%) '* 0.5\rEnd If\rNext E\r\rpower_EnProd = EnTot / WENProd\r\rElse\r'   power_EnergyNetExport = AMAX(0, (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, SENX(R%) - SENM(R%)) / AMAX(0.001, WENXM)\rpower_EnProd = SEnTotal(R%) / WENProd\r\rEnd If\r"
  },
  {
    "Variable": "POWERGPI",
    "UsesVariable": "GOVREV",
    "Distance": 50,
    "Code": "\r\r'       If IY% = 1 Then\r'            power_EnergyNetExport = ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'        AMAX(0.001, WENM))\r'       Else\r'            power_EnergyNetExport = (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM))\r'       End If\r\r'dkb 2014/10/06 - As per Tim Smith's request, power_EnergyNetExport is not allowed to go below 0 - START\r'dkb 2014/10/23 - new EnergyNetExport specification - START\r'clp 2016/08/25 - adding energy production variable\rIf IY% = 1 Then\r'    power_EnergyNetExport = AMAX(0, ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, (XS(R%, Ener) / WEPBYEAR) - ((MS(R%, Ener) / WEPBYEAR))) / AMAX(0.001, WENXM)\r\rEnTot = 0\rFor E = 1 To Renew 'Oil, gas, coal, hydro, nuclear, renewable\rIf E <= Hydro Then\rEnTot = EnTot + ENP(R%, E)\r'bbh 2011/10/16\r'Else\r'   EnTot = EnTot + ENP(R%, e%) '* 0.5\rEnd If\rNext E\r\rpower_EnProd = EnTot / WENProd\r\rElse\r'   power_EnergyNetExport = AMAX(0, (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, SENX(R%) - SENM(R%)) / AMAX(0.001, WENXM)\rpower_EnProd = SEnTotal(R%) / WENProd\r\rEnd If\r"
  },
  {
    "Variable": "POWERGPI",
    "UsesVariable": "POP",
    "Distance": 48,
    "Code": "\r\r'       If IY% = 1 Then\r'            power_EnergyNetExport = ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'        AMAX(0.001, WENM))\r'       Else\r'            power_EnergyNetExport = (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM))\r'       End If\r\r'dkb 2014/10/06 - As per Tim Smith's request, power_EnergyNetExport is not allowed to go below 0 - START\r'dkb 2014/10/23 - new EnergyNetExport specification - START\r'clp 2016/08/25 - adding energy production variable\rIf IY% = 1 Then\r'    power_EnergyNetExport = AMAX(0, ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, (XS(R%, Ener) / WEPBYEAR) - ((MS(R%, Ener) / WEPBYEAR))) / AMAX(0.001, WENXM)\r\rEnTot = 0\rFor E = 1 To Renew 'Oil, gas, coal, hydro, nuclear, renewable\rIf E <= Hydro Then\rEnTot = EnTot + ENP(R%, E)\r'bbh 2011/10/16\r'Else\r'   EnTot = EnTot + ENP(R%, e%) '* 0.5\rEnd If\rNext E\r\rpower_EnProd = EnTot / WENProd\r\rElse\r'   power_EnergyNetExport = AMAX(0, (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, SENX(R%) - SENM(R%)) / AMAX(0.001, WENXM)\rpower_EnProd = SEnTotal(R%) / WENProd\r\rEnd If\r"
  },
  {
    "Variable": "POWERGPI",
    "UsesVariable": "INCOMELT365LN",
    "Distance": 48,
    "Code": "\r\r'       If IY% = 1 Then\r'            power_EnergyNetExport = ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'        AMAX(0.001, WENM))\r'       Else\r'            power_EnergyNetExport = (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM))\r'       End If\r\r'dkb 2014/10/06 - As per Tim Smith's request, power_EnergyNetExport is not allowed to go below 0 - START\r'dkb 2014/10/23 - new EnergyNetExport specification - START\r'clp 2016/08/25 - adding energy production variable\rIf IY% = 1 Then\r'    power_EnergyNetExport = AMAX(0, ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, (XS(R%, Ener) / WEPBYEAR) - ((MS(R%, Ener) / WEPBYEAR))) / AMAX(0.001, WENXM)\r\rEnTot = 0\rFor E = 1 To Renew 'Oil, gas, coal, hydro, nuclear, renewable\rIf E <= Hydro Then\rEnTot = EnTot + ENP(R%, E)\r'bbh 2011/10/16\r'Else\r'   EnTot = EnTot + ENP(R%, e%) '* 0.5\rEnd If\rNext E\r\rpower_EnProd = EnTot / WENProd\r\rElse\r'   power_EnergyNetExport = AMAX(0, (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, SENX(R%) - SENM(R%)) / AMAX(0.001, WENXM)\rpower_EnProd = SEnTotal(R%) / WENProd\r\rEnd If\r"
  },
  {
    "Variable": "POWERGPI",
    "UsesVariable": "POP15TO65",
    "Distance": 48,
    "Code": "\r\r'       If IY% = 1 Then\r'            power_EnergyNetExport = ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'        AMAX(0.001, WENM))\r'       Else\r'            power_EnergyNetExport = (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM))\r'       End If\r\r'dkb 2014/10/06 - As per Tim Smith's request, power_EnergyNetExport is not allowed to go below 0 - START\r'dkb 2014/10/23 - new EnergyNetExport specification - START\r'clp 2016/08/25 - adding energy production variable\rIf IY% = 1 Then\r'    power_EnergyNetExport = AMAX(0, ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, (XS(R%, Ener) / WEPBYEAR) - ((MS(R%, Ener) / WEPBYEAR))) / AMAX(0.001, WENXM)\r\rEnTot = 0\rFor E = 1 To Renew 'Oil, gas, coal, hydro, nuclear, renewable\rIf E <= Hydro Then\rEnTot = EnTot + ENP(R%, E)\r'bbh 2011/10/16\r'Else\r'   EnTot = EnTot + ENP(R%, e%) '* 0.5\rEnd If\rNext E\r\rpower_EnProd = EnTot / WENProd\r\rElse\r'   power_EnergyNetExport = AMAX(0, (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, SENX(R%) - SENM(R%)) / AMAX(0.001, WENXM)\rpower_EnProd = SEnTotal(R%) / WENProd\r\rEnd If\r"
  },
  {
    "Variable": "POWERGPI",
    "UsesVariable": "HDINEW",
    "Distance": 48,
    "Code": "\r\r'       If IY% = 1 Then\r'            power_EnergyNetExport = ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'        AMAX(0.001, WENM))\r'       Else\r'            power_EnergyNetExport = (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM))\r'       End If\r\r'dkb 2014/10/06 - As per Tim Smith's request, power_EnergyNetExport is not allowed to go below 0 - START\r'dkb 2014/10/23 - new EnergyNetExport specification - START\r'clp 2016/08/25 - adding energy production variable\rIf IY% = 1 Then\r'    power_EnergyNetExport = AMAX(0, ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, (XS(R%, Ener) / WEPBYEAR) - ((MS(R%, Ener) / WEPBYEAR))) / AMAX(0.001, WENXM)\r\rEnTot = 0\rFor E = 1 To Renew 'Oil, gas, coal, hydro, nuclear, renewable\rIf E <= Hydro Then\rEnTot = EnTot + ENP(R%, E)\r'bbh 2011/10/16\r'Else\r'   EnTot = EnTot + ENP(R%, e%) '* 0.5\rEnd If\rNext E\r\rpower_EnProd = EnTot / WENProd\r\rElse\r'   power_EnergyNetExport = AMAX(0, (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, SENX(R%) - SENM(R%)) / AMAX(0.001, WENXM)\rpower_EnProd = SEnTotal(R%) / WENProd\r\rEnd If\r"
  },
  {
    "Variable": "POWERGPI",
    "UsesVariable": "ENP",
    "Distance": 68,
    "Code": "\r\r'       If IY% = 1 Then\r'            power_EnergyNetExport = ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'        AMAX(0.001, WENM))\r'       Else\r'            power_EnergyNetExport = (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM))\r'       End If\r\r'dkb 2014/10/06 - As per Tim Smith's request, power_EnergyNetExport is not allowed to go below 0 - START\r'dkb 2014/10/23 - new EnergyNetExport specification - START\r'clp 2016/08/25 - adding energy production variable\rIf IY% = 1 Then\r'    power_EnergyNetExport = AMAX(0, ((XS(R%, Ener) / WEPBYEAR) / AMAX(0.001, WENX)) - ((MS(R%, Ener) / WEPBYEAR) / _\r'AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, (XS(R%, Ener) / WEPBYEAR) - ((MS(R%, Ener) / WEPBYEAR))) / AMAX(0.001, WENXM)\r\rEnTot = 0\rFor E = 1 To Renew 'Oil, gas, coal, hydro, nuclear, renewable\rIf E <= Hydro Then\rEnTot = EnTot + ENP(R%, E)\r'bbh 2011/10/16\r'Else\r'   EnTot = EnTot + ENP(R%, e%) '* 0.5\rEnd If\rNext E\r\rpower_EnProd = EnTot / WENProd\r\rElse\r'   power_EnergyNetExport = AMAX(0, (SENX(R%) / AMAX(0.001, WENX) - SENM(R%) / AMAX(0.001, WENM)))\rpower_EnergyNetExport = AMAX(0, SENX(R%) - SENM(R%)) / AMAX(0.001, WENXM)\rpower_EnProd = SEnTotal(R%) / WENProd\r\rEnd If\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "wpwghtpow",
    "Distance": 96,
    "Code": "0"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "GDPPC",
    "Distance": 76,
    "Code": "0"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "GDPPCP",
    "Distance": 75,
    "Code": "0"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "DIPLOEMBASSY",
    "Distance": 53,
    "Code": "0"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "DIPLOEMBASSYMAX",
    "Distance": 53,
    "Code": "\r\r'dkb 2014/10/27 - Not using save variables for first year - START\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\rIf IY% = 1 Then\r'power_embassy = ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((DIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((DIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'(0.33 * ((DIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'(0.17 * (((DIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r\rpower_embassy = DIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = DIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = DIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * DIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\rpower_dpi = CSng(((((99.83 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                    (35.49 * (DIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                    (7.34 * ((DIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                    AMAX(0.001, WDPI))\r'power_dpi = (((0.5 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (DIPLOIGO(R%) / DIPLOIGOMAX)) + _\r' (0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\r\rElse\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\r'power_embassy = ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'   (0.33 * ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'  (0.17 * (((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r' AMAX(0.001, WDPI)\rpower_embassy = SDIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = SDIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = SDIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\r'power_dpi = ((((0.5 * SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * SDIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\rpower_dpi = CSng(((((99.83 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                                (35.49 * (SDIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                                (7.34 * ((SDIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                                AMAX(0.001, WDPI))\r\r''power_dpi = (((0.5 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (SDIPLOIGO(R%) / DIPLOIGOMAX)) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\rEnd If\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "DIPLOIGO",
    "Distance": 53,
    "Code": "0"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "DIPLOIGOMAX",
    "Distance": 53,
    "Code": "\r\r'dkb 2014/10/27 - Not using save variables for first year - START\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\rIf IY% = 1 Then\r'power_embassy = ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((DIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((DIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'(0.33 * ((DIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'(0.17 * (((DIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r\rpower_embassy = DIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = DIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = DIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * DIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\rpower_dpi = CSng(((((99.83 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                    (35.49 * (DIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                    (7.34 * ((DIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                    AMAX(0.001, WDPI))\r'power_dpi = (((0.5 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (DIPLOIGO(R%) / DIPLOIGOMAX)) + _\r' (0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\r\rElse\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\r'power_embassy = ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'   (0.33 * ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'  (0.17 * (((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r' AMAX(0.001, WDPI)\rpower_embassy = SDIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = SDIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = SDIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\r'power_dpi = ((((0.5 * SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * SDIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\rpower_dpi = CSng(((((99.83 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                                (35.49 * (SDIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                                (7.34 * ((SDIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                                AMAX(0.001, WDPI))\r\r''power_dpi = (((0.5 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (SDIPLOIGO(R%) / DIPLOIGOMAX)) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\rEnd If\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "DIPLOTREATY",
    "Distance": 53,
    "Code": "0"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "DIPLOTREATYMAX",
    "Distance": 53,
    "Code": "\r\r'dkb 2014/10/27 - Not using save variables for first year - START\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\rIf IY% = 1 Then\r'power_embassy = ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((DIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((DIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'(0.33 * ((DIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'(0.17 * (((DIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r\rpower_embassy = DIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = DIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = DIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * DIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\rpower_dpi = CSng(((((99.83 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                    (35.49 * (DIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                    (7.34 * ((DIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                    AMAX(0.001, WDPI))\r'power_dpi = (((0.5 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (DIPLOIGO(R%) / DIPLOIGOMAX)) + _\r' (0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\r\rElse\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\r'power_embassy = ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'   (0.33 * ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'  (0.17 * (((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r' AMAX(0.001, WDPI)\rpower_embassy = SDIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = SDIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = SDIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\r'power_dpi = ((((0.5 * SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * SDIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\rpower_dpi = CSng(((((99.83 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                                (35.49 * (SDIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                                (7.34 * ((SDIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                                AMAX(0.001, WDPI))\r\r''power_dpi = (((0.5 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (SDIPLOIGO(R%) / DIPLOIGOMAX)) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\rEnd If\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "GOVREV",
    "Distance": 53,
    "Code": "0"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "GDP",
    "Distance": 84,
    "Code": "0"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "WGDP",
    "Distance": 84,
    "Code": "\r'jrs 2020/11/19 power_milPPP = SGDSMil(R%) * GDPP(R%) / GDP(R%) / AMAX(0.001, WGDSMIL)\rpower_gdp_gdppcp = GDP(R%) * GDPPCP(R%) / AMAX(0.001, WTECHmix)\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "GOVCON",
    "Distance": 81,
    "Code": "\r'jrs 2020/11/19 power_milPPP = SGDSMil(R%) * GDPP(R%) / GDP(R%) / AMAX(0.001, WGDSMIL)\rpower_gdp_gdppcp = GDP(R%) * GDPPCP(R%) / AMAX(0.001, WTECHmix)\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "CPOW",
    "Distance": 77,
    "Code": "\r'jrs 2020/11/19 power_milPPP = SGDSMil(R%) * GDPP(R%) / GDP(R%) / AMAX(0.001, WGDSMIL)\rpower_gdp_gdppcp = GDP(R%) * GDPPCP(R%) / AMAX(0.001, WTECHmix)\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "WCPOW",
    "Distance": 77,
    "Code": "\r'jrs 2020/11/19 power_milPPP = SGDSMil(R%) * GDPP(R%) / GDP(R%) / AMAX(0.001, WGDSMIL)\rpower_gdp_gdppcp = GDP(R%) * GDPPCP(R%) / AMAX(0.001, WTECHmix)\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "NPOW",
    "Distance": 76,
    "Code": "\r'jrs 2020/11/19 power_milPPP = SGDSMil(R%) * GDPP(R%) / GDP(R%) / AMAX(0.001, WGDSMIL)\rpower_gdp_gdppcp = GDP(R%) * GDPPCP(R%) / AMAX(0.001, WTECHmix)\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "WNPOW",
    "Distance": 76,
    "Code": "\r'jrs 2020/11/19 power_milPPP = SGDSMil(R%) * GDPP(R%) / GDP(R%) / AMAX(0.001, WGDSMIL)\rpower_gdp_gdppcp = GDP(R%) * GDPPCP(R%) / AMAX(0.001, WTECHmix)\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "GOVNUCWP",
    "Distance": 75,
    "Code": "\r'jrs 2020/11/19 power_milPPP = SGDSMil(R%) * GDPP(R%) / GDP(R%) / AMAX(0.001, WGDSMIL)\rpower_gdp_gdppcp = GDP(R%) * GDPPCP(R%) / AMAX(0.001, WTECHmix)\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "ENX",
    "Distance": 68,
    "Code": "\r'jrs 2020/11/19 power_milPPP = SGDSMil(R%) * GDPP(R%) / GDP(R%) / AMAX(0.001, WGDSMIL)\rpower_gdp_gdppcp = GDP(R%) * GDPPCP(R%) / AMAX(0.001, WTECHmix)\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "ENM",
    "Distance": 68,
    "Code": "\r'jrs 2020/11/19 power_milPPP = SGDSMil(R%) * GDPP(R%) / GDP(R%) / AMAX(0.001, WGDSMIL)\rpower_gdp_gdppcp = GDP(R%) * GDPPCP(R%) / AMAX(0.001, WTECHmix)\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "XS",
    "Distance": 72,
    "Code": "\r'jrs 2020/11/19 power_milPPP = SGDSMil(R%) * GDPP(R%) / GDP(R%) / AMAX(0.001, WGDSMIL)\rpower_gdp_gdppcp = GDP(R%) * GDPPCP(R%) / AMAX(0.001, WTECHmix)\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "WEPBYEAR",
    "Distance": 72,
    "Code": "\r'jrs 2020/11/19 power_milPPP = SGDSMil(R%) * GDPP(R%) / GDP(R%) / AMAX(0.001, WGDSMIL)\rpower_gdp_gdppcp = GDP(R%) * GDPPCP(R%) / AMAX(0.001, WTECHmix)\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "MS",
    "Distance": 72,
    "Code": "\r'jrs 2020/11/19 power_milPPP = SGDSMil(R%) * GDPP(R%) / GDP(R%) / AMAX(0.001, WGDSMIL)\rpower_gdp_gdppcp = GDP(R%) * GDPPCP(R%) / AMAX(0.001, WTECHmix)\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "X",
    "Distance": 66,
    "Code": "\r'jrs 2020/11/19 power_milPPP = SGDSMil(R%) * GDPP(R%) / GDP(R%) / AMAX(0.001, WGDSMIL)\rpower_gdp_gdppcp = GDP(R%) * GDPPCP(R%) / AMAX(0.001, WTECHmix)\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "M",
    "Distance": 66,
    "Code": "\r'jrs 2020/11/19 power_milPPP = SGDSMil(R%) * GDPP(R%) / GDP(R%) / AMAX(0.001, WGDSMIL)\rpower_gdp_gdppcp = GDP(R%) * GDPPCP(R%) / AMAX(0.001, WTECHmix)\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "XFDIFIN",
    "Distance": 65,
    "Code": "\r'jrs 2020/11/19 power_milPPP = SGDSMil(R%) * GDPP(R%) / GDP(R%) / AMAX(0.001, WGDSMIL)\rpower_gdp_gdppcp = GDP(R%) * GDPPCP(R%) / AMAX(0.001, WTECHmix)\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "AID",
    "Distance": 64,
    "Code": "\r'jrs 2020/11/19 power_milPPP = SGDSMil(R%) * GDPP(R%) / GDP(R%) / AMAX(0.001, WGDSMIL)\rpower_gdp_gdppcp = GDP(R%) * GDPPCP(R%) / AMAX(0.001, WTECHmix)\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "POPWORKING",
    "Distance": 63,
    "Code": "\r'jrs 2020/11/19 power_milPPP = SGDSMil(R%) * GDPP(R%) / GDP(R%) / AMAX(0.001, WGDSMIL)\rpower_gdp_gdppcp = GDP(R%) * GDPPCP(R%) / AMAX(0.001, WTECHmix)\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "HDINEW",
    "Distance": 63,
    "Code": "0"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "KS",
    "Distance": 60,
    "Code": "\r'jrs 2020/11/19 power_milPPP = SGDSMil(R%) * GDPP(R%) / GDP(R%) / AMAX(0.001, WGDSMIL)\rpower_gdp_gdppcp = GDP(R%) * GDPPCP(R%) / AMAX(0.001, WTECHmix)\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "POP",
    "Distance": 50,
    "Code": "0"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "INCOMELT365LN",
    "Distance": 50,
    "Code": "\r'jrs 2020/11/19 power_milPPP = SGDSMil(R%) * GDPP(R%) / GDP(R%) / AMAX(0.001, WGDSMIL)\rpower_gdp_gdppcp = GDP(R%) * GDPPCP(R%) / AMAX(0.001, WTECHmix)\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "POP15TO65",
    "Distance": 50,
    "Code": "\r'jrs 2020/11/19 power_milPPP = SGDSMil(R%) * GDPP(R%) / GDP(R%) / AMAX(0.001, WGDSMIL)\rpower_gdp_gdppcp = GDP(R%) * GDPPCP(R%) / AMAX(0.001, WTECHmix)\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "RANDDEXP",
    "Distance": 61,
    "Code": "\r'jrs 2020/11/19 power_milPPP = SGDSMil(R%) * GDPP(R%) / GDP(R%) / AMAX(0.001, WGDSMIL)\rpower_gdp_gdppcp = GDP(R%) * GDPPCP(R%) / AMAX(0.001, WTECHmix)\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "WPOP",
    "Distance": 85,
    "Code": "\rpower_mil = SGDSMil(R%) / AMAX(0.001, WGDSMIL)\r"
  },
  {
    "Variable": "POWERHH",
    "UsesVariable": "GDPP",
    "Distance": 84,
    "Code": "0"
  },
  {
    "Variable": "POWERHHMI",
    "UsesVariable": "POP",
    "Distance": 83,
    "Code": "\r\r'dkb 2014/10/27 - Not using save variables for first year - START\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\rIf IY% = 1 Then\r'power_embassy = ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((DIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((DIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'(0.33 * ((DIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'(0.17 * (((DIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r\rpower_embassy = DIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = DIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = DIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * DIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\rpower_dpi = CSng(((((99.83 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                    (35.49 * (DIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                    (7.34 * ((DIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                    AMAX(0.001, WDPI))\r'power_dpi = (((0.5 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (DIPLOIGO(R%) / DIPLOIGOMAX)) + _\r' (0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\r\rElse\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\r'power_embassy = ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'   (0.33 * ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'  (0.17 * (((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r' AMAX(0.001, WDPI)\rpower_embassy = SDIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = SDIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = SDIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\r'power_dpi = ((((0.5 * SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * SDIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\rpower_dpi = CSng(((((99.83 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                                (35.49 * (SDIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                                (7.34 * ((SDIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                                AMAX(0.001, WDPI))\r\r''power_dpi = (((0.5 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (SDIPLOIGO(R%) / DIPLOIGOMAX)) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\rEnd If\r\r\r'dkb 2014/10/27 - Not using save variables for first year - START\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\rIf IY% = 1 Then\r'power_embassy = ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((DIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((DIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'(0.33 * ((DIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'(0.17 * (((DIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r\rpower_embassy = DIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = DIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = DIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * DIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\rpower_dpi = CSng(((((99.83 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                    (35.49 * (DIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                    (7.34 * ((DIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                    AMAX(0.001, WDPI))\r'power_dpi = (((0.5 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (DIPLOIGO(R%) / DIPLOIGOMAX)) + _\r' (0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\r\rElse\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\r'power_embassy = ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'   (0.33 * ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'  (0.17 * (((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r' AMAX(0.001, WDPI)\rpower_embassy = SDIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = SDIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = SDIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\r'power_dpi = ((((0.5 * SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * SDIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\rpower_dpi = CSng(((((99.83 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                                (35.49 * (SDIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                                (7.34 * ((SDIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                                AMAX(0.001, WDPI))\r\r''power_dpi = (((0.5 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (SDIPLOIGO(R%) / DIPLOIGOMAX)) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\rEnd If\r\rIf SGOVNUCWP(R%) > 0 Then\rpower_GovNucWP = CSng(Log(SGOVNUCWP(R%)) / AMAX(0.001, WGOVNUCWP))\rEnd If\r\r\r'dkb 2014/10/27 - Not using save variables for first year - START\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\rIf IY% = 1 Then\r'power_embassy = ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((DIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((DIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'(0.33 * ((DIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'(0.17 * (((DIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r\rpower_embassy = DIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = DIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = DIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * DIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\rpower_dpi = CSng(((((99.83 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                    (35.49 * (DIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                    (7.34 * ((DIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                    AMAX(0.001, WDPI))\r'power_dpi = (((0.5 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (DIPLOIGO(R%) / DIPLOIGOMAX)) + _\r' (0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\r\rElse\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\r'power_embassy = ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'   (0.33 * ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'  (0.17 * (((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r' AMAX(0.001, WDPI)\rpower_embassy = SDIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = SDIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = SDIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\r'power_dpi = ((((0.5 * SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * SDIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\rpower_dpi = CSng(((((99.83 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                                (35.49 * (SDIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                                (7.34 * ((SDIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                                AMAX(0.001, WDPI))\r\r''power_dpi = (((0.5 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (SDIPLOIGO(R%) / DIPLOIGOMAX)) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\rEnd If\r\rpower_mil = SGDSMil(R%) / AMAX(0.001, WGDSMIL)\r\rpower_techp = GDPP(R%) * GDPPCP(R%) / AMAX(0.001, WTECHP)\r\rpower_GDPPPP = GDPP(R%) / AMAX(0.001, WGDPPPP)\rCOMPLETE STRUCTURE:Next R%:913|\r\r'bbh 2011/11/19 Changes throughout R% Loop\rFor R% = 1 To NR%\r'dkb 2014/09/24 - Added new POWERGPI variable and corresponding (hardcoded) components. _\r'Restructured And cleaned the following block to allow for reuse of base POWER components _\r'accross 3 POWER measures - START\rpower_pop = POP(R%) / AMAX(0.001, WPOP)\r\rpowerHHMI_treaty = CSng(power_treaty * 0.1)\r\rpowerHHMI_igo = CSng(power_igo * 0.2)\r\rpowerHHMI_GovNucWP = CSng(power_GovNucWP * 0.25)\r\rpowerHHMI_embassy = CSng(power_embassy * 0.3)\r\rpowerHHMI_mil = CSng(power_mil * 0.9)\r\rpowerHHMI_techp = CSng(power_techp * 0.3)\r\rpowerHHMI_GDPPPP = CSng(power_GDPPPP * 1.1)\r\r'dkb 2014/09/24 - Hardcoding POWERGPI components - END\r\r'If RegName(R%) = \"United States of America\" Then Stop\r\r'dkb 2014/09/24 - Hardcoding POWERHHMI components - START\rpowerHHMI_pop = CSng(power_pop * 0.8)\r\r\rPOWERHHMI(R%) = powerHHMI_pop + powerHHMI_GDPPPP + powerHHMI_techp + powerHHMI_mil +\r                powerHHMI_embassy + powerHHMI_GovNucWP + powerHHMI_igo + powerHHMI_treaty\r\r\r'If RegName(R%) = \"United States of America\" Then Stop\r\rPOWERHHMI(R%) = CSng(AMAX(-0.1, POWERHHMI(R%) / AMAX(0.001, 3.95) * 100))\r\r\rPOWERHHMI(R%) = AMAX(0.000001, Amin(90, POWERHHMI(R%)))\r"
  },
  {
    "Variable": "POWERHHMI",
    "UsesVariable": "WPOP",
    "Distance": 83,
    "Code": "\r\r'dkb 2014/10/27 - Not using save variables for first year - START\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\rIf IY% = 1 Then\r'power_embassy = ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((DIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((DIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'(0.33 * ((DIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'(0.17 * (((DIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r\rpower_embassy = DIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = DIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = DIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * DIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\rpower_dpi = CSng(((((99.83 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                    (35.49 * (DIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                    (7.34 * ((DIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                    AMAX(0.001, WDPI))\r'power_dpi = (((0.5 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (DIPLOIGO(R%) / DIPLOIGOMAX)) + _\r' (0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\r\rElse\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\r'power_embassy = ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'   (0.33 * ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'  (0.17 * (((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r' AMAX(0.001, WDPI)\rpower_embassy = SDIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = SDIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = SDIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\r'power_dpi = ((((0.5 * SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * SDIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\rpower_dpi = CSng(((((99.83 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                                (35.49 * (SDIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                                (7.34 * ((SDIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                                AMAX(0.001, WDPI))\r\r''power_dpi = (((0.5 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (SDIPLOIGO(R%) / DIPLOIGOMAX)) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\rEnd If\r"
  },
  {
    "Variable": "POWERHHMI",
    "UsesVariable": "GDPP",
    "Distance": 82,
    "Code": "0"
  },
  {
    "Variable": "POWERHHMI",
    "UsesVariable": "GDPPCP",
    "Distance": 80,
    "Code": "\r\r'dkb 2014/10/27 - Not using save variables for first year - START\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\rIf IY% = 1 Then\r'power_embassy = ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((DIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((DIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'(0.33 * ((DIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'(0.17 * (((DIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r\rpower_embassy = DIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = DIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = DIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * DIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\rpower_dpi = CSng(((((99.83 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                    (35.49 * (DIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                    (7.34 * ((DIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                    AMAX(0.001, WDPI))\r'power_dpi = (((0.5 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (DIPLOIGO(R%) / DIPLOIGOMAX)) + _\r' (0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\r\rElse\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\r'power_embassy = ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'   (0.33 * ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'  (0.17 * (((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r' AMAX(0.001, WDPI)\rpower_embassy = SDIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = SDIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = SDIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\r'power_dpi = ((((0.5 * SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * SDIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\rpower_dpi = CSng(((((99.83 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                                (35.49 * (SDIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                                (7.34 * ((SDIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                                AMAX(0.001, WDPI))\r\r''power_dpi = (((0.5 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (SDIPLOIGO(R%) / DIPLOIGOMAX)) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\rEnd If\r"
  },
  {
    "Variable": "POWERHHMI",
    "UsesVariable": "DIPLOEMBASSY",
    "Distance": 52,
    "Code": "\r\r'dkb 2014/10/27 - Not using save variables for first year - START\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\rIf IY% = 1 Then\r'power_embassy = ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((DIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((DIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'(0.33 * ((DIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'(0.17 * (((DIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r\rpower_embassy = DIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = DIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = DIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * DIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\rpower_dpi = CSng(((((99.83 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                    (35.49 * (DIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                    (7.34 * ((DIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                    AMAX(0.001, WDPI))\r'power_dpi = (((0.5 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (DIPLOIGO(R%) / DIPLOIGOMAX)) + _\r' (0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\r\rElse\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\r'power_embassy = ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'   (0.33 * ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'  (0.17 * (((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r' AMAX(0.001, WDPI)\rpower_embassy = SDIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = SDIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = SDIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\r'power_dpi = ((((0.5 * SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * SDIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\rpower_dpi = CSng(((((99.83 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                                (35.49 * (SDIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                                (7.34 * ((SDIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                                AMAX(0.001, WDPI))\r\r''power_dpi = (((0.5 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (SDIPLOIGO(R%) / DIPLOIGOMAX)) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\rEnd If\r"
  },
  {
    "Variable": "POWERHHMI",
    "UsesVariable": "GOVNUCWP",
    "Distance": 72,
    "Code": "\r\r'dkb 2014/10/27 - Not using save variables for first year - START\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\rIf IY% = 1 Then\r'power_embassy = ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((DIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((DIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'(0.33 * ((DIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'(0.17 * (((DIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r\rpower_embassy = DIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = DIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = DIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * DIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\rpower_dpi = CSng(((((99.83 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                    (35.49 * (DIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                    (7.34 * ((DIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                    AMAX(0.001, WDPI))\r'power_dpi = (((0.5 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (DIPLOIGO(R%) / DIPLOIGOMAX)) + _\r' (0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\r\rElse\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\r'power_embassy = ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'   (0.33 * ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'  (0.17 * (((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r' AMAX(0.001, WDPI)\rpower_embassy = SDIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = SDIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = SDIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\r'power_dpi = ((((0.5 * SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * SDIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\rpower_dpi = CSng(((((99.83 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                                (35.49 * (SDIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                                (7.34 * ((SDIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                                AMAX(0.001, WDPI))\r\r''power_dpi = (((0.5 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (SDIPLOIGO(R%) / DIPLOIGOMAX)) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\rEnd If\r"
  },
  {
    "Variable": "POWERHHMI",
    "UsesVariable": "DIPLOIGO",
    "Distance": 51,
    "Code": "\r\r'dkb 2014/10/27 - Not using save variables for first year - START\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\rIf IY% = 1 Then\r'power_embassy = ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((DIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((DIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'(0.33 * ((DIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'(0.17 * (((DIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r\rpower_embassy = DIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = DIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = DIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * DIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\rpower_dpi = CSng(((((99.83 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                    (35.49 * (DIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                    (7.34 * ((DIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                    AMAX(0.001, WDPI))\r'power_dpi = (((0.5 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (DIPLOIGO(R%) / DIPLOIGOMAX)) + _\r' (0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\r\rElse\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\r'power_embassy = ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'   (0.33 * ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'  (0.17 * (((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r' AMAX(0.001, WDPI)\rpower_embassy = SDIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = SDIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = SDIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\r'power_dpi = ((((0.5 * SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * SDIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\rpower_dpi = CSng(((((99.83 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                                (35.49 * (SDIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                                (7.34 * ((SDIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                                AMAX(0.001, WDPI))\r\r''power_dpi = (((0.5 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (SDIPLOIGO(R%) / DIPLOIGOMAX)) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\rEnd If\r"
  },
  {
    "Variable": "POWERHHMI",
    "UsesVariable": "DIPLOTREATY",
    "Distance": 50,
    "Code": "\r\r'dkb 2014/10/27 - Not using save variables for first year - START\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\rIf IY% = 1 Then\r'power_embassy = ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((DIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((DIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((DIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'(0.33 * ((DIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'(0.17 * (((DIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r\rpower_embassy = DIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = DIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = DIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * DIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\rpower_dpi = CSng(((((99.83 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                    (35.49 * (DIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                    (7.34 * ((DIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                    AMAX(0.001, WDPI))\r'power_dpi = (((0.5 * (DIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (DIPLOIGO(R%) / DIPLOIGOMAX)) + _\r' (0.17 * (DIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\r\rElse\r'clp 2016/08/23 - removing unstandardizing; now using absolute values\r'power_embassy = ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / AMAX(0.001, WDPIBN)\r'power_igo = ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / AMAX(0.001, WDPIMN)\r'power_treaty = ((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / AMAX(0.001, WDPIILN)\r'power_dpi = ((((0.5 * ((SDIPLOEMBASSY(R%) * 32.48639) + 39.42253) / ((DIPLOEMBASSYMAX * 32.48639) + 39.42253))) + _\r'   (0.33 * ((SDIPLOIGO(R%) * 129.6466) + 244.7328) / ((DIPLOIGOMAX * 129.6466) + 244.7328)) + _\r'  (0.17 * (((SDIPLOTREATY(R%) * 747.6514) + 906.7255) / ((DIPLOTREATYMAX * 747.6514) + 906.7255)))) * GOVREV(R%)) / _\r' AMAX(0.001, WDPI)\rpower_embassy = SDIPLOEMBASSY(R%) / AMAX(0.001, WDPIBN)\rpower_igo = SDIPLOIGO(R%) / AMAX(0.001, WDPIMN)\rpower_treaty = SDIPLOTREATY(R%) / AMAX(0.001, WDPIILN)\r'clp 2016/08/24 - updating dpi calculation to match Tim's new formulation\r'power_dpi = ((((0.5 * SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + _\r'(0.33 * SDIPLOIGO(R%) / DIPLOIGOMAX) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / _\r'AMAX(0.001, WDPI)\rpower_dpi = CSng(((((99.83 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX) ^ 2)) +\r                                (35.49 * (SDIPLOIGO(R%) / DIPLOIGOMAX) ^ 2) +\r                                (7.34 * ((SDIPLOTREATY(R%) / DIPLOTREATYMAX) ^ 1.5))) * GOVREV(R%)) /\r                                AMAX(0.001, WDPI))\r\r''power_dpi = (((0.5 * (SDIPLOEMBASSY(R%) / DIPLOEMBASSYMAX)) + (0.33 * (SDIPLOIGO(R%) / DIPLOIGOMAX)) + _\r'(0.17 * (SDIPLOTREATY(R%) / DIPLOTREATYMAX))) * GOVREV(R%)) / AMAX(0.001, WDPI)\rEnd If\r"
  },
  {
    "Variable": "PPPCONV",
    "UsesVariable": "GDPPCP",
    "Distance": 2087,
    "Code": "0"
  },
  {
    "Variable": "PPPCONV",
    "UsesVariable": "GDPPC",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "PPPCONV",
    "UsesVariable": "GDPPOT",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "PPPCONV",
    "UsesVariable": "POP",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "PPPCONV",
    "UsesVariable": "GDP",
    "Distance": 1921,
    "Code": "0"
  },
  {
    "Variable": "PPPCONV",
    "UsesVariable": "gdprext",
    "Distance": 0,
    "Code": "\r\r'dsr 2016/05/04 Set bGDPPCPExogenous = False, otherwise get run-to-run like error\rbGDPPCPExogenous = False\r"
  },
  {
    "Variable": "PQLI",
    "UsesVariable": "LIT",
    "Distance": 0,
    "Code": "\rPQLI(R%) = (LIT(R%) + PQLILife + PQLIInfMor) / 3.0!\r\rIf PQLI(R%) > 100 Then PQLI(R%) = 100\r\rIf PQLI(R%) < 0 Then PQLI(R%) = 0!\r"
  },
  {
    "Variable": "PQLI",
    "UsesVariable": "LIFEXP",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "PQLI",
    "UsesVariable": "lifexpmin",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "PQLI",
    "UsesVariable": "infmormax",
    "Distance": 1,
    "Code": "\r'mti LifeExp/ gender May 2006\rLifExpMaxHDI = AMAX(LifExpMaxHDI, lifexpmin + 1)\r"
  },
  {
    "Variable": "PQLI",
    "UsesVariable": "INFMOR",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "PRI",
    "UsesVariable": "elprst1",
    "Distance": 1,
    "Code": "\r'ExcessSt(R%) = ExcessSt(R%) + Diff1 'bbh 2020/07/01 moved below to pick up ag, en\rIf SST(R%, S%) < StBase(R%, S%) * dstl Then\rDiff2 = ST(R%, S%) - SST(R%, S%) * (1.0! + igdprcor(R%))\rElse\rDiff2 = ST(R%, S%) - SST(R%, S%)\r'If SST several times base, IGDPRCor can set up postive loop on price\rEnd If\r\r'If RegName$(R%) = \"Afghanistan\" And S% = 6 Then Stop\r\rDiff1 = ST(R%, S%) - StBase(R%, S%) * dstl\r\r\r'   First Year: Compute Initial Stocks and Recompute Stock Ratio\r'       Based on Computed VADD\r'   ------------------------------------------------------------\rFor S% = 1 To NSec%\rims(R%, S%) = MS(R%, S%)\r'bbh 2020/08/03 Start; need to switch stock base from ZS to VADD because over time\r'   the ratio of ZS/VADD changes (in China manufacturing almost doubles); VADD/PFD more stable\r'   Perhaps should even be PFD given the close link of PFD to stock accummulation\r'   Problem with ZS is that over time the swings of ST and CAPUT become reinforcing and very large\rStBase(R%, S%) = ZS(R%, S%) + ims(R%, S%)\r'StBase(R%, S%) = PFD(R%, S%) + ims(R%, S%) 'bbh 2022/10/27\rMovAvgMS(R%, S%) = ims(R%, S%) 'bbh 2022/10/27\r'StBase(R%, S%) = VADD(R%, S%) + ims(R%, S%)\r'bbh 2020/08/03 end\rSMS(R%, S%) = MS(R%, S%) 'bbh 2019/09/13\r\r'mti 2018/10/01 Start\r'            sms(R%, S%) = MS(R%, S%)\r'            StBase(R%, S%) = ZS(R%, S%) + sms(R%, S%)\r'mti 2018/10/01 End\r\rST(R%, S%) = StBase(R%, S%) * dstl\rNext S%\r\rFor S% = 1 To NSec%\r'If RegName$(R%) = \"China\" And S% = 2 Then Stop\r\r'bbh 2020/08/03 Start\rStBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%) 'bbh 2021/09/30 ims DOES NOT grow and fixed causes problems, e.g. Vietnam materials\r'StBase(R%, S%) = PFD(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%) 'bbh 2022/10/27\r'StBase(R%, S%) = PFD(R%, S%) + MovAvgMS(R%, S%) 'bbh 2022/10/27 Replaced line above for more control over import contribution to stock need\r'StBase(R%, S%) = zsp(R%, S%) + ims(R%, S%) 'bbh 2021/09/21 ims itself grows; GTPPOT/GDPI was causing problems\r'for countries like China with large stock demands\r'StBase(R%, S%) = VADD(R%, S%) + ims(R%, S%) * GDPPOT(R%) / GDPI(R%)\r'bbh 2020/08/03 end\r\r'mti 2018/10/01 Start\r'            StBase(R%, S%) = zsp(R%, S%) + sms(R%, S%)\r'mti 2018/10/01 End\rIf ((S% > Ener) OrElse (S% = Agri AndAlso agon < 0.9) OrElse (S% = Ener AndAlso enon < 0.9)) Then\rDiff1 = SST(R%, S%) - dstl * StBase(R%, S%)\r'Diff2 = sst(R%, S%) - SSTS(R%, S%) * (1! + igdpr(R%))\rDiff2 = SST(R%, S%) - SSTS(R%, S%) * (1.0! + igdprcor(R%))\rCall ADJSTR(StBase(R%, S%), Diff1, Diff2, elinst1, elinst2, Mul)\r'mti 2018/07/02 Start\rIDS(R%, S%) = IGCF(R%) * IDK(R%, S%) * idsm(R%, S%) * Mul\r'mti 2018/07/02 End\rEnd If\rMinIDS = IDK(R%, S%) * IGCF(R%) * 0.5!\r'If GRPS(1, R%) = \"Guinea Bissau\" And S% = 2 And IY >= 7 Then Stop\rIDS(R%, S%) = AMAX(MinIDS, Amin(IDS(R%, S%), IGCF(R%)))\r\r\r\rIf S% = 1 Then\rIDS(R%, S%) = CSng(Amin(IGCF(R%) * 0.3, Amin(IGCF(R%) * sidk(R%, S%) * 2.5, IDS(R%, S%))))\r'If RegName$(R%) = \"Congo, Democratic Republic Of\" And IY% >= 50 Then Stop\rEnd If\rIf S% = 2 Then\r'jrs 2022/04/18\r'if IGCF(R%) * sidk(R%, S%) > 0.1 then\r'jrs 2022/05/02 If GRPS(1, R%) <> \"Guinea Bissau\" Or context.HistoricMode = True Then\rIf ennoprodsw(R%) = 0 Or context.HistoricMode = True Then\rIDS(R%, S%) = CSng(Amin(IGCF(R%) * 0.5, Amin(IGCF(R%) * sidk(R%, S%) * 3, IDS(R%, S%))))\rEnd If\rEnd If\r\rtids = tids + IDS(R%, S%)\rNext S%\r\rCall ADJSTR(StBase(R%, S%), Diff1, Diff2, elprst1, elprst2, Mul)\r\r'If RegName$(R%) = \"Qatar\" And IY% >= 90 And S% = 4 Then Stop\rPRI(R%, S%) = spri(R%, S%) * Mul\r\rPRI(R%, S%) = 0.98! * PRI(R%, S%) + 0.02!\r\r'To rebase non-physical submodel prices towards 1 over time;\r'They can drift because of productivity differences;\r'   trade changes preserve drift\r'In absence of changing cost structure,\r'   there is no basis for change over time\rPRI(R%, S%) = AMAX(0.01, Amin(PRI(R%, S%), 100))\r"
  },
  {
    "Variable": "PRI",
    "UsesVariable": "elprst2",
    "Distance": 1,
    "Code": "\r'ExcessSt(R%) = ExcessSt(R%) + Diff1 'bbh 2020/07/01 moved below to pick up ag, en\rIf SST(R%, S%) < StBase(R%, S%) * dstl Then\rDiff2 = ST(R%, S%) - SST(R%, S%) * (1.0! + igdprcor(R%))\rElse\rDiff2 = ST(R%, S%) - SST(R%, S%)\r'If SST several times base, IGDPRCor can set up postive loop on price\rEnd If\r"
  },
  {
    "Variable": "PRI",
    "UsesVariable": "GDPPOT",
    "Distance": 145,
    "Code": "0"
  },
  {
    "Variable": "PRI",
    "UsesVariable": "ZS",
    "Distance": 1982,
    "Code": "0"
  },
  {
    "Variable": "PRI",
    "UsesVariable": "ST",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "PRI",
    "UsesVariable": "dstl",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "PRI",
    "UsesVariable": "MS",
    "Distance": 1823,
    "Code": "0"
  },
  {
    "Variable": "PRI",
    "UsesVariable": "GDP",
    "Distance": 1848,
    "Code": "0"
  },
  {
    "Variable": "PRI",
    "UsesVariable": "FPRI",
    "Distance": 0,
    "Code": "\rPRI(R%, 1) = FPRI(R%, 1) / swapi(1)\r\rPRI(R%, S%) = 1.0!\r"
  },
  {
    "Variable": "PRI",
    "UsesVariable": "WAP",
    "Distance": 478,
    "Code": "\r\rFor f% = 1 To 3\rswapi(f%) = WAP(f%)\rswxc(f%) = 1\rswmd(f%) = 1\rGlobalSurDefRate(f%) = 0 'bbh 2022/10/27\rSGlobalSurDefRate(f%) = 0 'bbh 2022/11/28\rWTFoodType(f%) = 0 'bbh 2022/10/27 Initialize global trade by food type\rFor R% = 1 To NR%\rWTFoodType(f%) = WTFoodType(f%) + AGX(R%, f%)\rNext R%\rNext f%\r"
  },
  {
    "Variable": "PRI",
    "UsesVariable": "ENPRI",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "PROTEINPC",
    "UsesVariable": "CLPC",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "QE",
    "UsesVariable": "qem",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "QE",
    "UsesVariable": "etechadv",
    "Distance": 345,
    "Code": "0"
  },
  {
    "Variable": "QE",
    "UsesVariable": "resorm",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "QE",
    "UsesVariable": "resor",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "QE",
    "UsesVariable": "resorunconm",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "QE",
    "UsesVariable": "resoruncon",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "QE",
    "UsesVariable": "ENP",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "QE",
    "UsesVariable": "enpgasmax",
    "Distance": 293,
    "Code": "\r'dkb 2014/08/06 - END\rFor e% = 1 To Renew  'Oil, gas, coal, hydro, nuclear, renewable\rENST(R%) = ENST(R%) + ENP(R%, e%) * dstlen\rENDEM(R%) = ENDEM(R%) + ENP(R%, e%)\rsump = sump + ENP(R%, e%)\rSUMPR = SUMPR + ENP(R%, e%) * ENPRR(R%, e%)\rSmoothENP(R%, e%) = ENP(R%, e%)\r'jrs 2023/10/25\rSENPTOT(R%) = SENPTOT(R%) + ENP(R%, e%)\rNext e%\r"
  },
  {
    "Variable": "QEUNCON",
    "UsesVariable": "qeunconm",
    "Distance": 0,
    "Code": "\r\r'jrs 2013/04/19\rFor e% = 1 To NET% 'All Forms\rBQEUC(R%, e%) = QEUNCON(R%, e%)\rSQEUC(R%, e%) = QEUNCON(R%, e%)\rNext e%\r\r\r'jrs 2013/04/19\rFor e% = 1 To NET%\rBQEUC(R%, e%) = BQEUC(R%, e%) * (1 - etechadvuncon(e%))\rQEUNCON(R%, e%) = AMAX(0.01, Amin(SQEUC(R%, e%) * qeunconm(R%, e%), 1000))\rNext e%\r"
  },
  {
    "Variable": "RANDDEXP",
    "UsesVariable": "GDS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "RANDDEXP",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "RANDDEXP",
    "UsesVariable": "gdsm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "RANDDEXP",
    "UsesVariable": "gdsnormalize",
    "Distance": 0,
    "Code": "\r'mti 2016/12/09 End\r\r\r'mti 2016/07/16 end\r\r'mti 2016/01/07 - end\r\r'If GRPS(1, R) = \"United States of America\" And IY + FirstYear - 1 = 2100 Then Stop\r'jrs 2014/05/26 *** end ***\r'If RegName(R%) = \"Gambia\" Then Stop\r\rIf gdsnormalize <> 1 Then\r'bbh 2015/03/25 start Back out gdsm in rump RANDEXP to avoid negative rump and total after normalizaton\r'RANDDEXP(R%) = RANDDEXP(R%) - GDS(R%, RandD) / AMAX(0.001, GDP(R%))\rRANDDEXP(R%) = RANDDEXP(R%) - GDS(R%, RandD) / AMAX(0.001, GDP(R%)) * 100 / gdsm(R%, RandD)\rEnd If\r"
  },
  {
    "Variable": "RANDDEXP",
    "UsesVariable": "randdexpm",
    "Distance": 29,
    "Code": "0"
  },
  {
    "Variable": "RANDDEXP",
    "UsesVariable": "GDPPCP",
    "Distance": 33,
    "Code": "0"
  },
  {
    "Variable": "RESER",
    "UsesVariable": "ENP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "RESER",
    "UsesVariable": "resorm",
    "Distance": 37,
    "Code": "0"
  },
  {
    "Variable": "RESER",
    "UsesVariable": "resor",
    "Distance": 37,
    "Code": "0"
  },
  {
    "Variable": "RESER",
    "UsesVariable": "resorunconm",
    "Distance": 37,
    "Code": "0"
  },
  {
    "Variable": "RESER",
    "UsesVariable": "resoruncon",
    "Distance": 37,
    "Code": "0"
  },
  {
    "Variable": "RESER",
    "UsesVariable": "rdm",
    "Distance": 6,
    "Code": "\r'both on resources remaining and intensity of current exploitation\rIf reterm < 0 Then reterm = 0\r\rDim wep_term = (1.0! + (WEP - iwep) / AMAX(iwep, 0.001) * elasdi)\r\rDim rdi_aug = (rdi(e%) + rdinr(e%) * zy)\r\rIf e% = Oil Then\r'jrs 2013/04/22 ResorBase = resor(R%, Oil) * resorm(R%, Oil) + _\r'resor(R%, 5) * resorm(R%, 5) * enresunce(R%)\rResorBase = resor(R%, Oil) * resorm(R%, Oil) +\r                    resoruncon(R%, Oil) * resorunconm(R%, Oil) * enresunce(R%)\rresor_rem = (ResorBase - CUMPR(R%, e%) - RESER(R%, e%))\r\r'bbh 2013/05/24 note:  enresunce is set in IFs.mdb/CountryParameters.  It is given a non-zero value only for\r'    Canada (0.3).\r'When deal with issues here (constraint of rd), also look at where enresunce is used on capital costs.\rElse\r'resor_rem = (resor(R%, e%) * resorm(R%, e%) - CUMPR(R%, e%) - RESER(R%, e%))\rresor_rem = (ResorTot(R%, e%) - CUMPR(R%, e%) - RESER(R%, e%))\rEnd If\r\rDim rd = rdi_aug * wep_term * reterm * rdm(R%, e%)\r"
  },
  {
    "Variable": "RESER",
    "UsesVariable": "rdi",
    "Distance": 8,
    "Code": "\r'ttt 2019/10/08 Already ReDim\r'XPriceTermLag(R%) = 0\r'MPriceTermLag(R%) = 0\r'\r'     First Year:  Initialize Production Costs and Cumulative Production\r'     ------------------------------------------------------------------\r\rFor e% = 1 To NET% 'All Forms\rBQE(R%, e%) = QE(R%, e%)\rsqe(R%, e%) = QE(R%, e%)\rCUMPR(R%, e%) = 0!\rNext e%\r\r'If RegName$(R%) = \"Tonga\" And e% = Hydro Then Stop\rElse\r'                fac = 1!\r'                If (e% = Oil) Then fac = SENPR(R%)\r'                CUMPR(R%, e%) = CUMPR(R%, e%) + ENP(R%, e%) * fac\rCUMPR(R%, e%) = CUMPR(R%, e%) + ENP(R%, e%)\r\r'  BBH 7/14/04 V5.01 End\r'bbh2013/06/09 start\r'\r'     First Year:  Initialize Undiscovered Resources\r'     ----------------------------------------------\rFor e% = 1 To NET%\rFor R% = 1 To NR%\rResorTot(R%, e%) = resorm(R%, e%) * resor(R%, e%) + resorunconm(R%, e%) * resoruncon(R%, e%)\rNext R%\rNext e%\r\rFor e% = 1 To Renew  'Oil, gas, coal, hydro, nuclear, renewable\r'jrs 2021/11/30 If (tineed(R%) >= 0.001) Then Maldives blows up in 1961\r'jrs 2022/03/25 If (tineed(R%) >= 0.0001) Then Guinea Bissau blows up in 2009\rIf (tineed(R%) >= 0.00001) Then\rineed(R%, e%) = inen * ineed(R%, e%) * eninvtm(R%, e%) / tineed(R%)\rDim KEN_Shr = ineed(R%, e%) - sken(R%, e%) / lke(e%)  'jrs 2021/11/15 changed to sken\rken(R%, e%) = (sken(R%, e%) + KEN_Shr) * (1 - CIVDM(R%))  'jrs 2021/11/15 changed to sken\rken(R%, e%) = AMAX(0.00001, ken(R%, e%)) 'bbh 2013/11/20\r'ken(R%, e%) = AMAX(0.001, ken(R%, e%))\r'jrs 2021/11/15\r'sken(R%, e%) = ken(R%, e%)   'bbh 2023/12/31+ replace this with if-then below\r'The reason: oil production and export value =>GDP in early/exogenous years and grows much even as exogenous values of GDP jump + and -\r'in large swings; model forces non ag/en sectors to absorb all of swings in exog GDP creating huge stock messes for other sectors\r'and setting up crazy behavior for early post exog GDP years and longer term; need to constrain oil production to smooth all out\r'   WHen the base year of IFs is beyond huge swings in GDP and oil is smaller share of GDP, probably take this if-then out and let model compute\r'   changes in oil production\rIf (GRPS(1, R) = \"Sudan South\") And e% = 1 And IY% < 10 Then\rsken(R%, e%) = CSng(sken(R%, e%) * 1.03) 'bbh 2023/12/31+\rElseIf (GRPS(1, R) = \"Sudan South\") And e% = 1 And IY% >= 10 Then\rsken(R%, e%) = CSng(sken(R%, e%) * ConvergeOverTimeFromStartYear(1.03, 1, 20, 10))\r'ConvergeOverTimeFromStartYear(ByVal Base As Single, ByVal Target As Single, ByVal YearsToConverge As Integer, Optional StartYr As Integer = 2) As Single\rElse\rsken(R%, e%) = ken(R%, e%)\rEnd If\r\rEnd If\rIf IY% >= 2 Then    'If recompute 1st year, changes initial values\r'jrs 2022/04/12 ENPRR(R%, e%) = ineed(R%, e%) / ken(R%, e%) - 1.0! / lke(e%)\rENPRR(R%, e%) = CSng(ineed(R%, e%) / AMAX(ken(R%, e%), 0.00001) - 1.0! / lke(e%))\r'If RegName$(R%) = \"China\" And e% = Nucl Then Stop\r\rEnd If\r\r'     bbh2013/06/09\r'     All Years 2:  Undiscovered Resources\r'     ----------------------------------------------\rResorTot(R%, e%) = resorm(R%, e%) * resor(R%, e%) +\r                    resorunconm(R%, e%) * resoruncon(R%, e%) '* enresunce(R%) 'was used earlier for synoil\r'may need to revitalize and use enresunce\rNext e%\r"
  },
  {
    "Variable": "RESER",
    "UsesVariable": "rdinr",
    "Distance": 8,
    "Code": "\r'ttt 2019/10/08 Already ReDim\r'XPriceTermLag(R%) = 0\r'MPriceTermLag(R%) = 0\r'\r'     First Year:  Initialize Production Costs and Cumulative Production\r'     ------------------------------------------------------------------\r\rFor e% = 1 To NET% 'All Forms\rBQE(R%, e%) = QE(R%, e%)\rsqe(R%, e%) = QE(R%, e%)\rCUMPR(R%, e%) = 0!\rNext e%\r"
  },
  {
    "Variable": "RESER",
    "UsesVariable": "WEP",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "RESER",
    "UsesVariable": "elasdi",
    "Distance": 7,
    "Code": "\riwep = WEP\r"
  },
  {
    "Variable": "RESER",
    "UsesVariable": "WENP",
    "Distance": 11,
    "Code": "\r'bbh2013/06/09 start\r'\r'     First Year:  Initialize Undiscovered Resources\r'     ----------------------------------------------\r'jrs 2013/04/22 NET%\rFor e% = 1 To Hydro  'Oil, gas, coal, hydro\rwunro(e%) = 0!\rFor R% = 1 To NR%\rIf e% < Hydro Then\rRESER(R%, e%) = AMAX(RESER(R%, e%), 10 * ENP(R%, e%))\r'Not good form to be changing RESER from preprocessor value in 1st year\r'in ENP were also changed, could lead to run to run\r'This code perhaps should be in preprocessor; but would constrain resorm changes\rElseIf e% = Hydro Then 'jrs 2013/04/22 added e% = Hydro\rRESER(R%, e%) = AMAX(RESER(R%, e%), 2 * ENP(R%, e%))\rEnd If\r'bbh2013/06/09\r'wunro(e%) = wunro(e%) + _\r'AMAX(resorm(R%, e%) * resor(R%, e%) - RESER(R%, e%), 0)\rwunro(e%) = wunro(e%) +\r                        AMAX(ResorTot(R%, e%) - RESER(R%, e%), 0)\r'If GRPS(1, R) = \"Bosnia\" And e% = Coal Then Stop\rSResProdR(R%, e%) = CSng(Math.Round(RESER(R%, e%) / ENP(R%, e%), 5))\rNext R%\rNext e%\r"
  },
  {
    "Variable": "RETRAT",
    "UsesVariable": "YL",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "RETRAT",
    "UsesVariable": "CLD",
    "Distance": 1,
    "Code": "\r'   BBH 1/25/04 Begin V5_0\r'RETCap = LD(R%, 1) * (HypothYL - byl(R%)) 'Yield Incr with Invest in Cap\r'RETLD = SYL(R%) / CLD(R%)   'Yield Increase with Investment in Land\r' = SYL * (LD + 1/CLD) - SYL * LD\r'RETRAT(R%) = RETLD / AMAX(RETCap, 0.001)\r'RETCAP = LD(R%, 1) * (HypothYL - byl(R%)) 'Yield Incr with Invest in Cap\r' wv 2021/03/01 changed reference to the CompYL (capital L)\rDim RETCAP = LD(R%, 1) * (HypothYL - CompYL)\r"
  },
  {
    "Variable": "RETRAT",
    "UsesVariable": "LD",
    "Distance": 2,
    "Code": "\r'   BBH 1/25/04 Begin V5_0\r'RETCap = LD(R%, 1) * (HypothYL - byl(R%)) 'Yield Incr with Invest in Cap\r'RETLD = SYL(R%) / CLD(R%)   'Yield Increase with Investment in Land\r' = SYL * (LD + 1/CLD) - SYL * LD\r'RETRAT(R%) = RETLD / AMAX(RETCap, 0.001)\r'RETCAP = LD(R%, 1) * (HypothYL - byl(R%)) 'Yield Incr with Invest in Cap\r' wv 2021/03/01 changed reference to the CompYL (capital L)\rDim RETCAP = LD(R%, 1) * (HypothYL - CompYL)\r"
  },
  {
    "Variable": "RETRAT",
    "UsesVariable": "AGTEC",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "RETRAT",
    "UsesVariable": "ylexp",
    "Distance": 566,
    "Code": "0"
  },
  {
    "Variable": "RETRAT",
    "UsesVariable": "KAG",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "RETRAT",
    "UsesVariable": "LABS",
    "Distance": 602,
    "Code": "0"
  },
  {
    "Variable": "RETRAT",
    "UsesVariable": "YIELDINT",
    "Distance": 762,
    "Code": "0"
  },
  {
    "Variable": "RETRAT",
    "UsesVariable": "CDALF",
    "Distance": 491,
    "Code": "0"
  },
  {
    "Variable": "SAMADMISSION",
    "UsesVariable": "samadmissionadd",
    "Distance": 0,
    "Code": "\r\r'jrs 2016/02/17 adding total averted\r'jrs 2016/03/01 MALNCHPSAMINC(R%) = MALNCHPSAMINC(R%) + SAMADMISSION(R%) / 100 * SAMAVERTED(R%) / 100 * MALNCHPSAM(R%) * (1 + malnchpsamadj)\r\rIf samavertedm(R%) <> 1 OrElse samadmissionm(R%) <> 1 OrElse samadmissionadd(R%) <> 0 Then\rDiffAdmission = (SAMADMISSION(R%) + samadmissionadd(R%)) * samadmissionm(R%) - SAMADMISSION(R%) 'jrs 2016/02/13\rDiffAdmission = AMAX(Amin(DiffAdmission, 100 - SAMADMISSION(R%)), -1 * SAMADMISSION(R%))\rSAMADMISSION(R%) = (SAMADMISSION(R%) + samadmissionadd(R%)) * samadmissionm(R%)\r'dkb 2015/12/18 - Bounding SAMADMISSION to 100%. Mostly affecting for countries with large samadmshift (small samadcomp)\rSAMADMISSION(R%) = AMAX(Amin(SAMADMISSION(R%), 100), 0)\r'jrs 2016/02/13\rIf DiffAdmission <> 0 Then\rIf SAMADMISSIONTOTCOST(R%) = 0 Then 'jrs 2016/02/15\r'jrs 2016/04/05 I had not removed the extra + 1 that went with malnchpsamadj, so I was mult by 2.6 instead of 1.6\rSAMADMISSIONTOTCOST(R%) = (MALNCHPSAM(R%) * (malnchpsamadj)) * SAMADMISSION(R%) * POP0TO5(R%) / 10000 * samadmissioncost(R%)\rElseIf SAMADMISSION(R%) - DiffAdmission > 0 Then\rSAMADMISSIONTOTCOST(R%) = SAMADMISSIONTOTCOST(R%) * SAMADMISSION(R%) / (SAMADMISSION(R%) - DiffAdmission)\rEnd If\rEnd If\r\rDiffAverted = SAMAVERTED(R%) * (samavertedm(R%) - 1)\rDiffAverted = AMAX(Amin(DiffAverted, 100 - SAMAVERTED(R%)), -1 * SAMAVERTED(R%))\rSAMAVERTED(R%) = SAMAVERTED(R%) * samavertedm(R%)\r'jrs 2016/01/28\rSAMAVERTED(R%) = Amin(SAMAVERTED(R%), 100)\rEnd If\r\r\r'jrs 2016/02/17 adding total averted\r'jrs 2016/03/01 MALNCHPSAMINC(R%) = MALNCHPSAMINC(R%) + SAMADMISSION(R%) / 100 * SAMAVERTED(R%) / 100 * MALNCHPSAM(R%) * (1 + malnchpsamadj)\r\rIf samavertedm(R%) <> 1 OrElse samadmissionm(R%) <> 1 OrElse samadmissionadd(R%) <> 0 Then\rDiffAdmission = (SAMADMISSION(R%) + samadmissionadd(R%)) * samadmissionm(R%) - SAMADMISSION(R%) 'jrs 2016/02/13\rDiffAdmission = AMAX(Amin(DiffAdmission, 100 - SAMADMISSION(R%)), -1 * SAMADMISSION(R%))\rSAMADMISSION(R%) = (SAMADMISSION(R%) + samadmissionadd(R%)) * samadmissionm(R%)\r'dkb 2015/12/18 - Bounding SAMADMISSION to 100%. Mostly affecting for countries with large samadmshift (small samadcomp)\rSAMADMISSION(R%) = AMAX(Amin(SAMADMISSION(R%), 100), 0)\r'jrs 2016/02/13\rIf DiffAdmission <> 0 Then\rIf SAMADMISSIONTOTCOST(R%) = 0 Then 'jrs 2016/02/15\r'jrs 2016/04/05 I had not removed the extra + 1 that went with malnchpsamadj, so I was mult by 2.6 instead of 1.6\rSAMADMISSIONTOTCOST(R%) = (MALNCHPSAM(R%) * (malnchpsamadj)) * SAMADMISSION(R%) * POP0TO5(R%) / 10000 * samadmissioncost(R%)\rElseIf SAMADMISSION(R%) - DiffAdmission > 0 Then\rSAMADMISSIONTOTCOST(R%) = SAMADMISSIONTOTCOST(R%) * SAMADMISSION(R%) / (SAMADMISSION(R%) - DiffAdmission)\rEnd If\rEnd If\r\rDiffAverted = SAMAVERTED(R%) * (samavertedm(R%) - 1)\rDiffAverted = AMAX(Amin(DiffAverted, 100 - SAMAVERTED(R%)), -1 * SAMAVERTED(R%))\rSAMAVERTED(R%) = SAMAVERTED(R%) * samavertedm(R%)\r'jrs 2016/01/28\rSAMAVERTED(R%) = Amin(SAMAVERTED(R%), 100)\rEnd If\r"
  },
  {
    "Variable": "SAMADMISSION",
    "UsesVariable": "samadmissionm",
    "Distance": 0,
    "Code": "\r\r'jrs 2016/02/17 adding total averted\r'jrs 2016/03/01 MALNCHPSAMINC(R%) = MALNCHPSAMINC(R%) + SAMADMISSION(R%) / 100 * SAMAVERTED(R%) / 100 * MALNCHPSAM(R%) * (1 + malnchpsamadj)\r\rIf samavertedm(R%) <> 1 OrElse samadmissionm(R%) <> 1 OrElse samadmissionadd(R%) <> 0 Then\rDiffAdmission = (SAMADMISSION(R%) + samadmissionadd(R%)) * samadmissionm(R%) - SAMADMISSION(R%) 'jrs 2016/02/13\rDiffAdmission = AMAX(Amin(DiffAdmission, 100 - SAMADMISSION(R%)), -1 * SAMADMISSION(R%))\rSAMADMISSION(R%) = (SAMADMISSION(R%) + samadmissionadd(R%)) * samadmissionm(R%)\r'dkb 2015/12/18 - Bounding SAMADMISSION to 100%. Mostly affecting for countries with large samadmshift (small samadcomp)\rSAMADMISSION(R%) = AMAX(Amin(SAMADMISSION(R%), 100), 0)\r'jrs 2016/02/13\rIf DiffAdmission <> 0 Then\rIf SAMADMISSIONTOTCOST(R%) = 0 Then 'jrs 2016/02/15\r'jrs 2016/04/05 I had not removed the extra + 1 that went with malnchpsamadj, so I was mult by 2.6 instead of 1.6\rSAMADMISSIONTOTCOST(R%) = (MALNCHPSAM(R%) * (malnchpsamadj)) * SAMADMISSION(R%) * POP0TO5(R%) / 10000 * samadmissioncost(R%)\rElseIf SAMADMISSION(R%) - DiffAdmission > 0 Then\rSAMADMISSIONTOTCOST(R%) = SAMADMISSIONTOTCOST(R%) * SAMADMISSION(R%) / (SAMADMISSION(R%) - DiffAdmission)\rEnd If\rEnd If\r\rDiffAverted = SAMAVERTED(R%) * (samavertedm(R%) - 1)\rDiffAverted = AMAX(Amin(DiffAverted, 100 - SAMAVERTED(R%)), -1 * SAMAVERTED(R%))\rSAMAVERTED(R%) = SAMAVERTED(R%) * samavertedm(R%)\r'jrs 2016/01/28\rSAMAVERTED(R%) = Amin(SAMAVERTED(R%), 100)\rEnd If\r"
  },
  {
    "Variable": "SAMADMISSION",
    "UsesVariable": "GDPPCP",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "SAMADMISSION",
    "UsesVariable": "samadmissionsw",
    "Distance": 44,
    "Code": "0"
  },
  {
    "Variable": "SAMADMISSIONTOTCOST",
    "UsesVariable": "SAMADMISSION",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SAMADMISSIONTOTCOST",
    "UsesVariable": "samadmissionadd",
    "Distance": 5,
    "Code": "\r\r'jrs 2016/02/17 adding total averted\r'jrs 2016/03/01 MALNCHPSAMINC(R%) = MALNCHPSAMINC(R%) + SAMADMISSION(R%) / 100 * SAMAVERTED(R%) / 100 * MALNCHPSAM(R%) * (1 + malnchpsamadj)\r\rIf samavertedm(R%) <> 1 OrElse samadmissionm(R%) <> 1 OrElse samadmissionadd(R%) <> 0 Then\rDiffAdmission = (SAMADMISSION(R%) + samadmissionadd(R%)) * samadmissionm(R%) - SAMADMISSION(R%) 'jrs 2016/02/13\rDiffAdmission = AMAX(Amin(DiffAdmission, 100 - SAMADMISSION(R%)), -1 * SAMADMISSION(R%))\rSAMADMISSION(R%) = (SAMADMISSION(R%) + samadmissionadd(R%)) * samadmissionm(R%)\r'dkb 2015/12/18 - Bounding SAMADMISSION to 100%. Mostly affecting for countries with large samadmshift (small samadcomp)\rSAMADMISSION(R%) = AMAX(Amin(SAMADMISSION(R%), 100), 0)\r'jrs 2016/02/13\rIf DiffAdmission <> 0 Then\rIf SAMADMISSIONTOTCOST(R%) = 0 Then 'jrs 2016/02/15\r'jrs 2016/04/05 I had not removed the extra + 1 that went with malnchpsamadj, so I was mult by 2.6 instead of 1.6\rSAMADMISSIONTOTCOST(R%) = (MALNCHPSAM(R%) * (malnchpsamadj)) * SAMADMISSION(R%) * POP0TO5(R%) / 10000 * samadmissioncost(R%)\rElseIf SAMADMISSION(R%) - DiffAdmission > 0 Then\rSAMADMISSIONTOTCOST(R%) = SAMADMISSIONTOTCOST(R%) * SAMADMISSION(R%) / (SAMADMISSION(R%) - DiffAdmission)\rEnd If\rEnd If\r\rDiffAverted = SAMAVERTED(R%) * (samavertedm(R%) - 1)\rDiffAverted = AMAX(Amin(DiffAverted, 100 - SAMAVERTED(R%)), -1 * SAMAVERTED(R%))\rSAMAVERTED(R%) = SAMAVERTED(R%) * samavertedm(R%)\r'jrs 2016/01/28\rSAMAVERTED(R%) = Amin(SAMAVERTED(R%), 100)\rEnd If\r"
  },
  {
    "Variable": "SAMADMISSIONTOTCOST",
    "UsesVariable": "samadmissionm",
    "Distance": 5,
    "Code": "\r\r'jrs 2016/02/17 adding total averted\r'jrs 2016/03/01 MALNCHPSAMINC(R%) = MALNCHPSAMINC(R%) + SAMADMISSION(R%) / 100 * SAMAVERTED(R%) / 100 * MALNCHPSAM(R%) * (1 + malnchpsamadj)\r\rIf samavertedm(R%) <> 1 OrElse samadmissionm(R%) <> 1 OrElse samadmissionadd(R%) <> 0 Then\rDiffAdmission = (SAMADMISSION(R%) + samadmissionadd(R%)) * samadmissionm(R%) - SAMADMISSION(R%) 'jrs 2016/02/13\rDiffAdmission = AMAX(Amin(DiffAdmission, 100 - SAMADMISSION(R%)), -1 * SAMADMISSION(R%))\rSAMADMISSION(R%) = (SAMADMISSION(R%) + samadmissionadd(R%)) * samadmissionm(R%)\r'dkb 2015/12/18 - Bounding SAMADMISSION to 100%. Mostly affecting for countries with large samadmshift (small samadcomp)\rSAMADMISSION(R%) = AMAX(Amin(SAMADMISSION(R%), 100), 0)\r'jrs 2016/02/13\rIf DiffAdmission <> 0 Then\rIf SAMADMISSIONTOTCOST(R%) = 0 Then 'jrs 2016/02/15\r'jrs 2016/04/05 I had not removed the extra + 1 that went with malnchpsamadj, so I was mult by 2.6 instead of 1.6\rSAMADMISSIONTOTCOST(R%) = (MALNCHPSAM(R%) * (malnchpsamadj)) * SAMADMISSION(R%) * POP0TO5(R%) / 10000 * samadmissioncost(R%)\rElseIf SAMADMISSION(R%) - DiffAdmission > 0 Then\rSAMADMISSIONTOTCOST(R%) = SAMADMISSIONTOTCOST(R%) * SAMADMISSION(R%) / (SAMADMISSION(R%) - DiffAdmission)\rEnd If\rEnd If\r\rDiffAverted = SAMAVERTED(R%) * (samavertedm(R%) - 1)\rDiffAverted = AMAX(Amin(DiffAverted, 100 - SAMAVERTED(R%)), -1 * SAMAVERTED(R%))\rSAMAVERTED(R%) = SAMAVERTED(R%) * samavertedm(R%)\r'jrs 2016/01/28\rSAMAVERTED(R%) = Amin(SAMAVERTED(R%), 100)\rEnd If\r"
  },
  {
    "Variable": "SAMADMISSIONTOTCOST",
    "UsesVariable": "MALNCHPSAM",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SAMADMISSIONTOTCOST",
    "UsesVariable": "malnchpsamadj",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SAMADMISSIONTOTCOST",
    "UsesVariable": "POP0TO5",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SAMADMISSIONTOTCOST",
    "UsesVariable": "samadmissioncost",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SAMADMISSIONTOTCOST",
    "UsesVariable": "SAMAVERTED",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SAMAVERTED",
    "UsesVariable": "samavertedm",
    "Distance": 0,
    "Code": "\r\r'jrs 2016/02/17 adding total averted\r'jrs 2016/03/01 MALNCHPSAMINC(R%) = MALNCHPSAMINC(R%) + SAMADMISSION(R%) / 100 * SAMAVERTED(R%) / 100 * MALNCHPSAM(R%) * (1 + malnchpsamadj)\r\rIf samavertedm(R%) <> 1 OrElse samadmissionm(R%) <> 1 OrElse samadmissionadd(R%) <> 0 Then\rDiffAdmission = (SAMADMISSION(R%) + samadmissionadd(R%)) * samadmissionm(R%) - SAMADMISSION(R%) 'jrs 2016/02/13\rDiffAdmission = AMAX(Amin(DiffAdmission, 100 - SAMADMISSION(R%)), -1 * SAMADMISSION(R%))\rSAMADMISSION(R%) = (SAMADMISSION(R%) + samadmissionadd(R%)) * samadmissionm(R%)\r'dkb 2015/12/18 - Bounding SAMADMISSION to 100%. Mostly affecting for countries with large samadmshift (small samadcomp)\rSAMADMISSION(R%) = AMAX(Amin(SAMADMISSION(R%), 100), 0)\r'jrs 2016/02/13\rIf DiffAdmission <> 0 Then\rIf SAMADMISSIONTOTCOST(R%) = 0 Then 'jrs 2016/02/15\r'jrs 2016/04/05 I had not removed the extra + 1 that went with malnchpsamadj, so I was mult by 2.6 instead of 1.6\rSAMADMISSIONTOTCOST(R%) = (MALNCHPSAM(R%) * (malnchpsamadj)) * SAMADMISSION(R%) * POP0TO5(R%) / 10000 * samadmissioncost(R%)\rElseIf SAMADMISSION(R%) - DiffAdmission > 0 Then\rSAMADMISSIONTOTCOST(R%) = SAMADMISSIONTOTCOST(R%) * SAMADMISSION(R%) / (SAMADMISSION(R%) - DiffAdmission)\rEnd If\rEnd If\r\rDiffAverted = SAMAVERTED(R%) * (samavertedm(R%) - 1)\rDiffAverted = AMAX(Amin(DiffAverted, 100 - SAMAVERTED(R%)), -1 * SAMAVERTED(R%))\rSAMAVERTED(R%) = SAMAVERTED(R%) * samavertedm(R%)\r'jrs 2016/01/28\rSAMAVERTED(R%) = Amin(SAMAVERTED(R%), 100)\rEnd If\r\r\r'jrs 2016/02/17 adding total averted\r'jrs 2016/03/01 MALNCHPSAMINC(R%) = MALNCHPSAMINC(R%) + SAMADMISSION(R%) / 100 * SAMAVERTED(R%) / 100 * MALNCHPSAM(R%) * (1 + malnchpsamadj)\r\rIf samavertedm(R%) <> 1 OrElse samadmissionm(R%) <> 1 OrElse samadmissionadd(R%) <> 0 Then\rDiffAdmission = (SAMADMISSION(R%) + samadmissionadd(R%)) * samadmissionm(R%) - SAMADMISSION(R%) 'jrs 2016/02/13\rDiffAdmission = AMAX(Amin(DiffAdmission, 100 - SAMADMISSION(R%)), -1 * SAMADMISSION(R%))\rSAMADMISSION(R%) = (SAMADMISSION(R%) + samadmissionadd(R%)) * samadmissionm(R%)\r'dkb 2015/12/18 - Bounding SAMADMISSION to 100%. Mostly affecting for countries with large samadmshift (small samadcomp)\rSAMADMISSION(R%) = AMAX(Amin(SAMADMISSION(R%), 100), 0)\r'jrs 2016/02/13\rIf DiffAdmission <> 0 Then\rIf SAMADMISSIONTOTCOST(R%) = 0 Then 'jrs 2016/02/15\r'jrs 2016/04/05 I had not removed the extra + 1 that went with malnchpsamadj, so I was mult by 2.6 instead of 1.6\rSAMADMISSIONTOTCOST(R%) = (MALNCHPSAM(R%) * (malnchpsamadj)) * SAMADMISSION(R%) * POP0TO5(R%) / 10000 * samadmissioncost(R%)\rElseIf SAMADMISSION(R%) - DiffAdmission > 0 Then\rSAMADMISSIONTOTCOST(R%) = SAMADMISSIONTOTCOST(R%) * SAMADMISSION(R%) / (SAMADMISSION(R%) - DiffAdmission)\rEnd If\rEnd If\r\rDiffAverted = SAMAVERTED(R%) * (samavertedm(R%) - 1)\rDiffAverted = AMAX(Amin(DiffAverted, 100 - SAMAVERTED(R%)), -1 * SAMAVERTED(R%))\rSAMAVERTED(R%) = SAMAVERTED(R%) * samavertedm(R%)\r'jrs 2016/01/28\rSAMAVERTED(R%) = Amin(SAMAVERTED(R%), 100)\rEnd If\r"
  },
  {
    "Variable": "SAMAVERTED",
    "UsesVariable": "samavertedconvyr",
    "Distance": 0,
    "Code": "\r'dkb 2015/12/18 - Adding convergance\r'SAMADMISSION(R%) = ConvergeOverTime(SAMADMISSION(R%), 100, 100)\r\r'If GRPS(1, R%) = \"India\" AndAlso IY >= 9 Then Stop\r\r'jrs 2016/02/17\r'            'jrs 2016/02/04\r'            If SAMADMISSION(R%) = 100 AndAlso SAMAVERTED(R%) = 100 Then\r'                'jrs 2016/01/26\r'                SAMADMISSIONTOTCOST(R%) = (MALNCHPSAM(R%) + MALNCHPSAMINC(R%)) * Amin(SAMADMISSION(R%) * samadmissionm(R%), 100) * POP0TO5(R%) / 10000 * samadmissioncost(R%)\r'            Else\r'                'Using the Pre endogenous averted value of SAM\r'                'PREEndogAvertedSAM = SAM / (1-Adm/100*Avert/100)\r'                SAMADMISSIONTOTCOST(R%) = (MALNCHPSAM(R%) + MALNCHPSAMINC(R%)) / (1 - SAMADMISSION(R%) / 100 * SAMAVERTED(R%) / 100) * Amin(SAMADMISSION(R%) * samadmissionm(R%), 100) * POP0TO5(R%) / 10000 * samadmissioncost(R%)\r'            End If\r'If GRPS(1, R) = \"Niger\" AndAlso FirstYear + IY - 1 = 2016 Then Stop\r\r'jrs 2016/03/01\r'            If SAMADMISSION(R%) = 100 AndAlso SAMAVERTED(R%) = 100 Then\r'                SAMADMISSIONTOTCOST(R%) = (MALNCHPSAM(R%) * (1 + malnchpsamadj)) * SAMADMISSION(R%) * POP0TO5(R%) / 10000 * samadmissioncost(R%)\r'            Else\r'                SAMADMISSIONTOTCOST(R%) = (MALNCHPSAM(R%) / (1 - SAMADMISSION(R%) / 100 * SAMAVERTED(R%) / 100) * (1 + malnchpsamadj)) * SAMADMISSION(R%) * POP0TO5(R%) / 10000 * samadmissioncost(R%)\r'            End If\r\r'All years but first\r'-------------------\r'SAM cured\r'dkb 2015/12/09 - Changing convegence (origionally to 100 over 50 years)\r'dkb 2015/12/18 - Convergence looks too artifical. Now holding at initial values.\rSAMAVERTED(R%) = ConvergeOverTime(sSAMAVERTED(R%), 100, samavertedconvyr)  'jrs 2016/03/08 changed from 100 to samavertedconvbyr\r"
  },
  {
    "Variable": "SANITATION",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SANITATION",
    "UsesVariable": "HHSIZE",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SANITATION",
    "UsesVariable": "WATWASTETREAT",
    "Distance": 17,
    "Code": "\r\r'Waste Water Treatment\rPhysStckDmndThou = WATWASTETREAT(R%) * POP(R%) * 10 'thoUSAnd connections\r"
  },
  {
    "Variable": "SANITATION",
    "UsesVariable": "sanitationexovals",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SANITATION",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "\rIf sanitationexovals(R%, 3) > -100 Then\rSANITATION(R%, 3) = sanitationexovals(R%, 3)\rEnd If\r"
  },
  {
    "Variable": "SANITATION",
    "UsesVariable": "sanitationtrgtyr",
    "Distance": 2,
    "Code": "\r\r'mti 2014/05/28 - start\r'sPreBudSanitation(R%) = SANITATION(R%, 3)\r'mti 2021/08/10 End\r'mti 2014/05/28 - end\r\r'mti May Day 2012 - start\r'mti October 20, 2011 - start\r'iSanitationNone(R%) = SANITATION(R%, 1)\r'mti October 20, 2011 - end\riSanitationHH(R%) = SANITATION(R%, 3)\r\r\r\r\r'mti April 05, 2012 -start\r'End If\r'mti April 05, 2012 -end\r'mti July 18, 2011 - end\r\r'mti May 05, 2011 - start\r'parameter goal seek - start\rIf sanitationtrgtyr(R%) > 0 Then\r'If sINFRAELECACC(R%, Urban) < 100 Then\r'mti June 08, 2011 - start\r'                        RatChange = Amin(1, 0.05 / AMAX(0.001, SSANITATION(R%, 1)))\r'\r'                        'ConvTime = AMAX(3, sanitationtrgtyr(R%)- 5 - IY) ' 30  'years\r'                        ConvTime = AMAX(1, sanitationtrgtyr(R%)- IY)  ' 30  'years\r'                        'mti June 08, 2011 - end\r'                        cGrowthRateTarget = RatChange ^ (1 / ConvTime) - 1\r'                        SANITATIONNoTrgt = SSANITATION(R%, 1) * (1 + cGrowthRateTarget)\r\r'mti October 20, 2011 - start\r'                        DistTrgt = AMAX(0, SSANITATION(R%, 1) - 0)\r'                        TimeLeft = AMAX(1, sanitationtrgtyr(R%) + 2 - IY)\r\r'                        SANITATIONNoTrgt = AMAX(0, SSANITATION(R%, 1) - DistTrgt / TimeLeft)\r\r'mti May Day 2012 - start\r'-----old code --- 0% None\r'SANITATIONNoTrgt = iSanitationNone(R%) - Amin(sanitationtrgtyr(R%), IY) * iSanitationNone(R%) / sanitationtrgtyr(R%)\r\r'mti October 20, 2011 - end\r\r'mti June 08, 2011 -end\r\r'                        SANITATIONNoInitCast = SANITATION(R%, 1)\r'                        SANITATION(R%, 1) = Amin(SANITATIONNoInitCast, SANITATIONNoTrgt)\r'\r'                        tdef = SANITATIONNoInitCast - SANITATION(R%, 1)\r'\r'                        If tdef > 0 Then\r'                            tother = SANITATION(R%, 2) + SANITATION(R%, 3)\r'                            SANITATION(R%, 2) = SANITATION(R%, 2) + tdef * SANITATION(R%, 2) / tother\r'                            SANITATION(R%, 3) = SANITATION(R%, 3) + tdef * SANITATION(R%, 3) / tother\r'                        End If\r\r'                   If RegName(R%) = \"Burundi\" Then Stop\r\r'-----new code --- 100% to HH\r'mti July 25, 2012 - start\r'SanitationHHTrgt = Amin(100, iSanitationHH(R%) + Amin(sanitationtrgtyr(R%), IY) * (sanitationtrgtval(R%) - iSanitationHH(R%)) / sanitationtrgtyr(R%))\rDim SanitationHHTrgt = Amin(100, iSanitationHH(R%) + Amin(sanitationtrgtyr(R%), IY - 1) * (sanitationtrgtval(R%) - iSanitationHH(R%)) / sanitationtrgtyr(R%))\r'mti July 25, 2012 - end\rDim SanitationHHInitCast = SANITATION(R%, 3)\rSANITATION(R%, 3) = AMAX(SanitationHHInitCast, SanitationHHTrgt)\r\rDim tdef = SANITATION(R%, 3) - SanitationHHInitCast\r\rIf tdef > 0 Then\rDim tother = SANITATION(R%, 1) + SANITATION(R%, 2)\rSANITATION(R%, 1) = SANITATION(R%, 1) - tdef * SANITATION(R%, 1) / tother\r'Sanitation2ndCatInitCast = SanitationBF(R%, 2)\rSANITATION(R%, 2) = SANITATION(R%, 2) - tdef * SANITATION(R%, 2) / tother\rEnd If\r\r'mti May Day 2012 - end\r'End If\rEnd If\r\r\r\r\r'mti April 05, 2012 -start\r'End If\r'mti April 05, 2012 -end\r'mti July 18, 2011 - end\r\r'mti May 05, 2011 - start\r'parameter goal seek - start\rIf sanitationtrgtyr(R%) > 0 Then\r'If sINFRAELECACC(R%, Urban) < 100 Then\r'mti June 08, 2011 - start\r'                        RatChange = Amin(1, 0.05 / AMAX(0.001, SSANITATION(R%, 1)))\r'\r'                        'ConvTime = AMAX(3, sanitationtrgtyr(R%)- 5 - IY) ' 30  'years\r'                        ConvTime = AMAX(1, sanitationtrgtyr(R%)- IY)  ' 30  'years\r'                        'mti June 08, 2011 - end\r'                        cGrowthRateTarget = RatChange ^ (1 / ConvTime) - 1\r'                        SANITATIONNoTrgt = SSANITATION(R%, 1) * (1 + cGrowthRateTarget)\r\r'mti October 20, 2011 - start\r'                        DistTrgt = AMAX(0, SSANITATION(R%, 1) - 0)\r'                        TimeLeft = AMAX(1, sanitationtrgtyr(R%) + 2 - IY)\r\r'                        SANITATIONNoTrgt = AMAX(0, SSANITATION(R%, 1) - DistTrgt / TimeLeft)\r\r'mti May Day 2012 - start\r'-----old code --- 0% None\r'SANITATIONNoTrgt = iSanitationNone(R%) - Amin(sanitationtrgtyr(R%), IY) * iSanitationNone(R%) / sanitationtrgtyr(R%)\r\r'mti October 20, 2011 - end\r\r'mti June 08, 2011 -end\r\r'                        SANITATIONNoInitCast = SANITATION(R%, 1)\r'                        SANITATION(R%, 1) = Amin(SANITATIONNoInitCast, SANITATIONNoTrgt)\r'\r'                        tdef = SANITATIONNoInitCast - SANITATION(R%, 1)\r'\r'                        If tdef > 0 Then\r'                            tother = SANITATION(R%, 2) + SANITATION(R%, 3)\r'                            SANITATION(R%, 2) = SANITATION(R%, 2) + tdef * SANITATION(R%, 2) / tother\r'                            SANITATION(R%, 3) = SANITATION(R%, 3) + tdef * SANITATION(R%, 3) / tother\r'                        End If\r\r'                   If RegName(R%) = \"Burundi\" Then Stop\r\r'-----new code --- 100% to HH\r'mti July 25, 2012 - start\r'SanitationHHTrgt = Amin(100, iSanitationHH(R%) + Amin(sanitationtrgtyr(R%), IY) * (sanitationtrgtval(R%) - iSanitationHH(R%)) / sanitationtrgtyr(R%))\rDim SanitationHHTrgt = Amin(100, iSanitationHH(R%) + Amin(sanitationtrgtyr(R%), IY - 1) * (sanitationtrgtval(R%) - iSanitationHH(R%)) / sanitationtrgtyr(R%))\r'mti July 25, 2012 - end\rDim SanitationHHInitCast = SANITATION(R%, 3)\rSANITATION(R%, 3) = AMAX(SanitationHHInitCast, SanitationHHTrgt)\r\rDim tdef = SANITATION(R%, 3) - SanitationHHInitCast\r\rIf tdef > 0 Then\rDim tother = SANITATION(R%, 1) + SANITATION(R%, 2)\rSANITATION(R%, 1) = SANITATION(R%, 1) - tdef * SANITATION(R%, 1) / tother\r'Sanitation2ndCatInitCast = SanitationBF(R%, 2)\rSANITATION(R%, 2) = SANITATION(R%, 2) - tdef * SANITATION(R%, 2) / tother\rEnd If\r\r'mti May Day 2012 - end\r'End If\rEnd If\r\r\r\r\r'mti April 05, 2012 -start\r'End If\r'mti April 05, 2012 -end\r'mti July 18, 2011 - end\r\r'mti May 05, 2011 - start\r'parameter goal seek - start\rIf sanitationtrgtyr(R%) > 0 Then\r'If sINFRAELECACC(R%, Urban) < 100 Then\r'mti June 08, 2011 - start\r'                        RatChange = Amin(1, 0.05 / AMAX(0.001, SSANITATION(R%, 1)))\r'\r'                        'ConvTime = AMAX(3, sanitationtrgtyr(R%)- 5 - IY) ' 30  'years\r'                        ConvTime = AMAX(1, sanitationtrgtyr(R%)- IY)  ' 30  'years\r'                        'mti June 08, 2011 - end\r'                        cGrowthRateTarget = RatChange ^ (1 / ConvTime) - 1\r'                        SANITATIONNoTrgt = SSANITATION(R%, 1) * (1 + cGrowthRateTarget)\r\r'mti October 20, 2011 - start\r'                        DistTrgt = AMAX(0, SSANITATION(R%, 1) - 0)\r'                        TimeLeft = AMAX(1, sanitationtrgtyr(R%) + 2 - IY)\r\r'                        SANITATIONNoTrgt = AMAX(0, SSANITATION(R%, 1) - DistTrgt / TimeLeft)\r\r'mti May Day 2012 - start\r'-----old code --- 0% None\r'SANITATIONNoTrgt = iSanitationNone(R%) - Amin(sanitationtrgtyr(R%), IY) * iSanitationNone(R%) / sanitationtrgtyr(R%)\r\r'mti October 20, 2011 - end\r\r'mti June 08, 2011 -end\r\r'                        SANITATIONNoInitCast = SANITATION(R%, 1)\r'                        SANITATION(R%, 1) = Amin(SANITATIONNoInitCast, SANITATIONNoTrgt)\r'\r'                        tdef = SANITATIONNoInitCast - SANITATION(R%, 1)\r'\r'                        If tdef > 0 Then\r'                            tother = SANITATION(R%, 2) + SANITATION(R%, 3)\r'                            SANITATION(R%, 2) = SANITATION(R%, 2) + tdef * SANITATION(R%, 2) / tother\r'                            SANITATION(R%, 3) = SANITATION(R%, 3) + tdef * SANITATION(R%, 3) / tother\r'                        End If\r\r'                   If RegName(R%) = \"Burundi\" Then Stop\r\r'-----new code --- 100% to HH\r'mti July 25, 2012 - start\r'SanitationHHTrgt = Amin(100, iSanitationHH(R%) + Amin(sanitationtrgtyr(R%), IY) * (sanitationtrgtval(R%) - iSanitationHH(R%)) / sanitationtrgtyr(R%))\rDim SanitationHHTrgt = Amin(100, iSanitationHH(R%) + Amin(sanitationtrgtyr(R%), IY - 1) * (sanitationtrgtval(R%) - iSanitationHH(R%)) / sanitationtrgtyr(R%))\r'mti July 25, 2012 - end\rDim SanitationHHInitCast = SANITATION(R%, 3)\rSANITATION(R%, 3) = AMAX(SanitationHHInitCast, SanitationHHTrgt)\r\rDim tdef = SANITATION(R%, 3) - SanitationHHInitCast\r\rIf tdef > 0 Then\rDim tother = SANITATION(R%, 1) + SANITATION(R%, 2)\rSANITATION(R%, 1) = SANITATION(R%, 1) - tdef * SANITATION(R%, 1) / tother\r'Sanitation2ndCatInitCast = SanitationBF(R%, 2)\rSANITATION(R%, 2) = SANITATION(R%, 2) - tdef * SANITATION(R%, 2) / tother\rEnd If\r\r'mti May Day 2012 - end\r'End If\rEnd If\r\r\r\r\r'mti April 05, 2012 -start\r'End If\r'mti April 05, 2012 -end\r'mti July 18, 2011 - end\r\r'mti May 05, 2011 - start\r'parameter goal seek - start\rIf sanitationtrgtyr(R%) > 0 Then\r'If sINFRAELECACC(R%, Urban) < 100 Then\r'mti June 08, 2011 - start\r'                        RatChange = Amin(1, 0.05 / AMAX(0.001, SSANITATION(R%, 1)))\r'\r'                        'ConvTime = AMAX(3, sanitationtrgtyr(R%)- 5 - IY) ' 30  'years\r'                        ConvTime = AMAX(1, sanitationtrgtyr(R%)- IY)  ' 30  'years\r'                        'mti June 08, 2011 - end\r'                        cGrowthRateTarget = RatChange ^ (1 / ConvTime) - 1\r'                        SANITATIONNoTrgt = SSANITATION(R%, 1) * (1 + cGrowthRateTarget)\r\r'mti October 20, 2011 - start\r'                        DistTrgt = AMAX(0, SSANITATION(R%, 1) - 0)\r'                        TimeLeft = AMAX(1, sanitationtrgtyr(R%) + 2 - IY)\r\r'                        SANITATIONNoTrgt = AMAX(0, SSANITATION(R%, 1) - DistTrgt / TimeLeft)\r\r'mti May Day 2012 - start\r'-----old code --- 0% None\r'SANITATIONNoTrgt = iSanitationNone(R%) - Amin(sanitationtrgtyr(R%), IY) * iSanitationNone(R%) / sanitationtrgtyr(R%)\r\r'mti October 20, 2011 - end\r\r'mti June 08, 2011 -end\r\r'                        SANITATIONNoInitCast = SANITATION(R%, 1)\r'                        SANITATION(R%, 1) = Amin(SANITATIONNoInitCast, SANITATIONNoTrgt)\r'\r'                        tdef = SANITATIONNoInitCast - SANITATION(R%, 1)\r'\r'                        If tdef > 0 Then\r'                            tother = SANITATION(R%, 2) + SANITATION(R%, 3)\r'                            SANITATION(R%, 2) = SANITATION(R%, 2) + tdef * SANITATION(R%, 2) / tother\r'                            SANITATION(R%, 3) = SANITATION(R%, 3) + tdef * SANITATION(R%, 3) / tother\r'                        End If\r\r'                   If RegName(R%) = \"Burundi\" Then Stop\r\r'-----new code --- 100% to HH\r'mti July 25, 2012 - start\r'SanitationHHTrgt = Amin(100, iSanitationHH(R%) + Amin(sanitationtrgtyr(R%), IY) * (sanitationtrgtval(R%) - iSanitationHH(R%)) / sanitationtrgtyr(R%))\rDim SanitationHHTrgt = Amin(100, iSanitationHH(R%) + Amin(sanitationtrgtyr(R%), IY - 1) * (sanitationtrgtval(R%) - iSanitationHH(R%)) / sanitationtrgtyr(R%))\r'mti July 25, 2012 - end\rDim SanitationHHInitCast = SANITATION(R%, 3)\rSANITATION(R%, 3) = AMAX(SanitationHHInitCast, SanitationHHTrgt)\r\rDim tdef = SANITATION(R%, 3) - SanitationHHInitCast\r\rIf tdef > 0 Then\rDim tother = SANITATION(R%, 1) + SANITATION(R%, 2)\rSANITATION(R%, 1) = SANITATION(R%, 1) - tdef * SANITATION(R%, 1) / tother\r'Sanitation2ndCatInitCast = SanitationBF(R%, 2)\rSANITATION(R%, 2) = SANITATION(R%, 2) - tdef * SANITATION(R%, 2) / tother\rEnd If\r\r'mti May Day 2012 - end\r'End If\rEnd If\r\r\r\r\r'mti April 05, 2012 -start\r'End If\r'mti April 05, 2012 -end\r'mti July 18, 2011 - end\r\r'mti May 05, 2011 - start\r'parameter goal seek - start\rIf sanitationtrgtyr(R%) > 0 Then\r'If sINFRAELECACC(R%, Urban) < 100 Then\r'mti June 08, 2011 - start\r'                        RatChange = Amin(1, 0.05 / AMAX(0.001, SSANITATION(R%, 1)))\r'\r'                        'ConvTime = AMAX(3, sanitationtrgtyr(R%)- 5 - IY) ' 30  'years\r'                        ConvTime = AMAX(1, sanitationtrgtyr(R%)- IY)  ' 30  'years\r'                        'mti June 08, 2011 - end\r'                        cGrowthRateTarget = RatChange ^ (1 / ConvTime) - 1\r'                        SANITATIONNoTrgt = SSANITATION(R%, 1) * (1 + cGrowthRateTarget)\r\r'mti October 20, 2011 - start\r'                        DistTrgt = AMAX(0, SSANITATION(R%, 1) - 0)\r'                        TimeLeft = AMAX(1, sanitationtrgtyr(R%) + 2 - IY)\r\r'                        SANITATIONNoTrgt = AMAX(0, SSANITATION(R%, 1) - DistTrgt / TimeLeft)\r\r'mti May Day 2012 - start\r'-----old code --- 0% None\r'SANITATIONNoTrgt = iSanitationNone(R%) - Amin(sanitationtrgtyr(R%), IY) * iSanitationNone(R%) / sanitationtrgtyr(R%)\r\r'mti October 20, 2011 - end\r\r'mti June 08, 2011 -end\r\r'                        SANITATIONNoInitCast = SANITATION(R%, 1)\r'                        SANITATION(R%, 1) = Amin(SANITATIONNoInitCast, SANITATIONNoTrgt)\r'\r'                        tdef = SANITATIONNoInitCast - SANITATION(R%, 1)\r'\r'                        If tdef > 0 Then\r'                            tother = SANITATION(R%, 2) + SANITATION(R%, 3)\r'                            SANITATION(R%, 2) = SANITATION(R%, 2) + tdef * SANITATION(R%, 2) / tother\r'                            SANITATION(R%, 3) = SANITATION(R%, 3) + tdef * SANITATION(R%, 3) / tother\r'                        End If\r\r'                   If RegName(R%) = \"Burundi\" Then Stop\r\r'-----new code --- 100% to HH\r'mti July 25, 2012 - start\r'SanitationHHTrgt = Amin(100, iSanitationHH(R%) + Amin(sanitationtrgtyr(R%), IY) * (sanitationtrgtval(R%) - iSanitationHH(R%)) / sanitationtrgtyr(R%))\rDim SanitationHHTrgt = Amin(100, iSanitationHH(R%) + Amin(sanitationtrgtyr(R%), IY - 1) * (sanitationtrgtval(R%) - iSanitationHH(R%)) / sanitationtrgtyr(R%))\r'mti July 25, 2012 - end\rDim SanitationHHInitCast = SANITATION(R%, 3)\rSANITATION(R%, 3) = AMAX(SanitationHHInitCast, SanitationHHTrgt)\r\rDim tdef = SANITATION(R%, 3) - SanitationHHInitCast\r\rIf tdef > 0 Then\rDim tother = SANITATION(R%, 1) + SANITATION(R%, 2)\rSANITATION(R%, 1) = SANITATION(R%, 1) - tdef * SANITATION(R%, 1) / tother\r'Sanitation2ndCatInitCast = SanitationBF(R%, 2)\rSANITATION(R%, 2) = SANITATION(R%, 2) - tdef * SANITATION(R%, 2) / tother\rEnd If\r\r'mti May Day 2012 - end\r'End If\rEnd If\r\r\r\r\r'mti April 05, 2012 -start\r'End If\r'mti April 05, 2012 -end\r'mti July 18, 2011 - end\r\r'mti May 05, 2011 - start\r'parameter goal seek - start\rIf sanitationtrgtyr(R%) > 0 Then\r'If sINFRAELECACC(R%, Urban) < 100 Then\r'mti June 08, 2011 - start\r'                        RatChange = Amin(1, 0.05 / AMAX(0.001, SSANITATION(R%, 1)))\r'\r'                        'ConvTime = AMAX(3, sanitationtrgtyr(R%)- 5 - IY) ' 30  'years\r'                        ConvTime = AMAX(1, sanitationtrgtyr(R%)- IY)  ' 30  'years\r'                        'mti June 08, 2011 - end\r'                        cGrowthRateTarget = RatChange ^ (1 / ConvTime) - 1\r'                        SANITATIONNoTrgt = SSANITATION(R%, 1) * (1 + cGrowthRateTarget)\r\r'mti October 20, 2011 - start\r'                        DistTrgt = AMAX(0, SSANITATION(R%, 1) - 0)\r'                        TimeLeft = AMAX(1, sanitationtrgtyr(R%) + 2 - IY)\r\r'                        SANITATIONNoTrgt = AMAX(0, SSANITATION(R%, 1) - DistTrgt / TimeLeft)\r\r'mti May Day 2012 - start\r'-----old code --- 0% None\r'SANITATIONNoTrgt = iSanitationNone(R%) - Amin(sanitationtrgtyr(R%), IY) * iSanitationNone(R%) / sanitationtrgtyr(R%)\r\r'mti October 20, 2011 - end\r\r'mti June 08, 2011 -end\r\r'                        SANITATIONNoInitCast = SANITATION(R%, 1)\r'                        SANITATION(R%, 1) = Amin(SANITATIONNoInitCast, SANITATIONNoTrgt)\r'\r'                        tdef = SANITATIONNoInitCast - SANITATION(R%, 1)\r'\r'                        If tdef > 0 Then\r'                            tother = SANITATION(R%, 2) + SANITATION(R%, 3)\r'                            SANITATION(R%, 2) = SANITATION(R%, 2) + tdef * SANITATION(R%, 2) / tother\r'                            SANITATION(R%, 3) = SANITATION(R%, 3) + tdef * SANITATION(R%, 3) / tother\r'                        End If\r\r'                   If RegName(R%) = \"Burundi\" Then Stop\r\r'-----new code --- 100% to HH\r'mti July 25, 2012 - start\r'SanitationHHTrgt = Amin(100, iSanitationHH(R%) + Amin(sanitationtrgtyr(R%), IY) * (sanitationtrgtval(R%) - iSanitationHH(R%)) / sanitationtrgtyr(R%))\rDim SanitationHHTrgt = Amin(100, iSanitationHH(R%) + Amin(sanitationtrgtyr(R%), IY - 1) * (sanitationtrgtval(R%) - iSanitationHH(R%)) / sanitationtrgtyr(R%))\r'mti July 25, 2012 - end\rDim SanitationHHInitCast = SANITATION(R%, 3)\rSANITATION(R%, 3) = AMAX(SanitationHHInitCast, SanitationHHTrgt)\r\rDim tdef = SANITATION(R%, 3) - SanitationHHInitCast\r\rIf tdef > 0 Then\rDim tother = SANITATION(R%, 1) + SANITATION(R%, 2)\rSANITATION(R%, 1) = SANITATION(R%, 1) - tdef * SANITATION(R%, 1) / tother\r'Sanitation2ndCatInitCast = SanitationBF(R%, 2)\rSANITATION(R%, 2) = SANITATION(R%, 2) - tdef * SANITATION(R%, 2) / tother\rEnd If\r\r'mti May Day 2012 - end\r'End If\rEnd If\r\r\r\r\r'mti April 05, 2012 -start\r'End If\r'mti April 05, 2012 -end\r'mti July 18, 2011 - end\r\r'mti May 05, 2011 - start\r'parameter goal seek - start\rIf sanitationtrgtyr(R%) > 0 Then\r'If sINFRAELECACC(R%, Urban) < 100 Then\r'mti June 08, 2011 - start\r'                        RatChange = Amin(1, 0.05 / AMAX(0.001, SSANITATION(R%, 1)))\r'\r'                        'ConvTime = AMAX(3, sanitationtrgtyr(R%)- 5 - IY) ' 30  'years\r'                        ConvTime = AMAX(1, sanitationtrgtyr(R%)- IY)  ' 30  'years\r'                        'mti June 08, 2011 - end\r'                        cGrowthRateTarget = RatChange ^ (1 / ConvTime) - 1\r'                        SANITATIONNoTrgt = SSANITATION(R%, 1) * (1 + cGrowthRateTarget)\r\r'mti October 20, 2011 - start\r'                        DistTrgt = AMAX(0, SSANITATION(R%, 1) - 0)\r'                        TimeLeft = AMAX(1, sanitationtrgtyr(R%) + 2 - IY)\r\r'                        SANITATIONNoTrgt = AMAX(0, SSANITATION(R%, 1) - DistTrgt / TimeLeft)\r\r'mti May Day 2012 - start\r'-----old code --- 0% None\r'SANITATIONNoTrgt = iSanitationNone(R%) - Amin(sanitationtrgtyr(R%), IY) * iSanitationNone(R%) / sanitationtrgtyr(R%)\r\r'mti October 20, 2011 - end\r\r'mti June 08, 2011 -end\r\r'                        SANITATIONNoInitCast = SANITATION(R%, 1)\r'                        SANITATION(R%, 1) = Amin(SANITATIONNoInitCast, SANITATIONNoTrgt)\r'\r'                        tdef = SANITATIONNoInitCast - SANITATION(R%, 1)\r'\r'                        If tdef > 0 Then\r'                            tother = SANITATION(R%, 2) + SANITATION(R%, 3)\r'                            SANITATION(R%, 2) = SANITATION(R%, 2) + tdef * SANITATION(R%, 2) / tother\r'                            SANITATION(R%, 3) = SANITATION(R%, 3) + tdef * SANITATION(R%, 3) / tother\r'                        End If\r\r'                   If RegName(R%) = \"Burundi\" Then Stop\r\r'-----new code --- 100% to HH\r'mti July 25, 2012 - start\r'SanitationHHTrgt = Amin(100, iSanitationHH(R%) + Amin(sanitationtrgtyr(R%), IY) * (sanitationtrgtval(R%) - iSanitationHH(R%)) / sanitationtrgtyr(R%))\rDim SanitationHHTrgt = Amin(100, iSanitationHH(R%) + Amin(sanitationtrgtyr(R%), IY - 1) * (sanitationtrgtval(R%) - iSanitationHH(R%)) / sanitationtrgtyr(R%))\r'mti July 25, 2012 - end\rDim SanitationHHInitCast = SANITATION(R%, 3)\rSANITATION(R%, 3) = AMAX(SanitationHHInitCast, SanitationHHTrgt)\r\rDim tdef = SANITATION(R%, 3) - SanitationHHInitCast\r\rIf tdef > 0 Then\rDim tother = SANITATION(R%, 1) + SANITATION(R%, 2)\rSANITATION(R%, 1) = SANITATION(R%, 1) - tdef * SANITATION(R%, 1) / tother\r'Sanitation2ndCatInitCast = SanitationBF(R%, 2)\rSANITATION(R%, 2) = SANITATION(R%, 2) - tdef * SANITATION(R%, 2) / tother\rEnd If\r\r'mti May Day 2012 - end\r'End If\rEnd If\r\r\r\r\r'mti April 05, 2012 -start\r'End If\r'mti April 05, 2012 -end\r'mti July 18, 2011 - end\r\r'mti May 05, 2011 - start\r'parameter goal seek - start\rIf sanitationtrgtyr(R%) > 0 Then\r'If sINFRAELECACC(R%, Urban) < 100 Then\r'mti June 08, 2011 - start\r'                        RatChange = Amin(1, 0.05 / AMAX(0.001, SSANITATION(R%, 1)))\r'\r'                        'ConvTime = AMAX(3, sanitationtrgtyr(R%)- 5 - IY) ' 30  'years\r'                        ConvTime = AMAX(1, sanitationtrgtyr(R%)- IY)  ' 30  'years\r'                        'mti June 08, 2011 - end\r'                        cGrowthRateTarget = RatChange ^ (1 / ConvTime) - 1\r'                        SANITATIONNoTrgt = SSANITATION(R%, 1) * (1 + cGrowthRateTarget)\r\r'mti October 20, 2011 - start\r'                        DistTrgt = AMAX(0, SSANITATION(R%, 1) - 0)\r'                        TimeLeft = AMAX(1, sanitationtrgtyr(R%) + 2 - IY)\r\r'                        SANITATIONNoTrgt = AMAX(0, SSANITATION(R%, 1) - DistTrgt / TimeLeft)\r\r'mti May Day 2012 - start\r'-----old code --- 0% None\r'SANITATIONNoTrgt = iSanitationNone(R%) - Amin(sanitationtrgtyr(R%), IY) * iSanitationNone(R%) / sanitationtrgtyr(R%)\r\r'mti October 20, 2011 - end\r\r'mti June 08, 2011 -end\r\r'                        SANITATIONNoInitCast = SANITATION(R%, 1)\r'                        SANITATION(R%, 1) = Amin(SANITATIONNoInitCast, SANITATIONNoTrgt)\r'\r'                        tdef = SANITATIONNoInitCast - SANITATION(R%, 1)\r'\r'                        If tdef > 0 Then\r'                            tother = SANITATION(R%, 2) + SANITATION(R%, 3)\r'                            SANITATION(R%, 2) = SANITATION(R%, 2) + tdef * SANITATION(R%, 2) / tother\r'                            SANITATION(R%, 3) = SANITATION(R%, 3) + tdef * SANITATION(R%, 3) / tother\r'                        End If\r\r'                   If RegName(R%) = \"Burundi\" Then Stop\r\r'-----new code --- 100% to HH\r'mti July 25, 2012 - start\r'SanitationHHTrgt = Amin(100, iSanitationHH(R%) + Amin(sanitationtrgtyr(R%), IY) * (sanitationtrgtval(R%) - iSanitationHH(R%)) / sanitationtrgtyr(R%))\rDim SanitationHHTrgt = Amin(100, iSanitationHH(R%) + Amin(sanitationtrgtyr(R%), IY - 1) * (sanitationtrgtval(R%) - iSanitationHH(R%)) / sanitationtrgtyr(R%))\r'mti July 25, 2012 - end\rDim SanitationHHInitCast = SANITATION(R%, 3)\rSANITATION(R%, 3) = AMAX(SanitationHHInitCast, SanitationHHTrgt)\r\rDim tdef = SANITATION(R%, 3) - SanitationHHInitCast\r\rIf tdef > 0 Then\rDim tother = SANITATION(R%, 1) + SANITATION(R%, 2)\rSANITATION(R%, 1) = SANITATION(R%, 1) - tdef * SANITATION(R%, 1) / tother\r'Sanitation2ndCatInitCast = SanitationBF(R%, 2)\rSANITATION(R%, 2) = SANITATION(R%, 2) - tdef * SANITATION(R%, 2) / tother\rEnd If\r\r'mti May Day 2012 - end\r'End If\rEnd If\r\r\r\r\r'mti April 05, 2012 -start\r'End If\r'mti April 05, 2012 -end\r'mti July 18, 2011 - end\r\r'mti May 05, 2011 - start\r'parameter goal seek - start\rIf sanitationtrgtyr(R%) > 0 Then\r'If sINFRAELECACC(R%, Urban) < 100 Then\r'mti June 08, 2011 - start\r'                        RatChange = Amin(1, 0.05 / AMAX(0.001, SSANITATION(R%, 1)))\r'\r'                        'ConvTime = AMAX(3, sanitationtrgtyr(R%)- 5 - IY) ' 30  'years\r'                        ConvTime = AMAX(1, sanitationtrgtyr(R%)- IY)  ' 30  'years\r'                        'mti June 08, 2011 - end\r'                        cGrowthRateTarget = RatChange ^ (1 / ConvTime) - 1\r'                        SANITATIONNoTrgt = SSANITATION(R%, 1) * (1 + cGrowthRateTarget)\r\r'mti October 20, 2011 - start\r'                        DistTrgt = AMAX(0, SSANITATION(R%, 1) - 0)\r'                        TimeLeft = AMAX(1, sanitationtrgtyr(R%) + 2 - IY)\r\r'                        SANITATIONNoTrgt = AMAX(0, SSANITATION(R%, 1) - DistTrgt / TimeLeft)\r\r'mti May Day 2012 - start\r'-----old code --- 0% None\r'SANITATIONNoTrgt = iSanitationNone(R%) - Amin(sanitationtrgtyr(R%), IY) * iSanitationNone(R%) / sanitationtrgtyr(R%)\r\r'mti October 20, 2011 - end\r\r'mti June 08, 2011 -end\r\r'                        SANITATIONNoInitCast = SANITATION(R%, 1)\r'                        SANITATION(R%, 1) = Amin(SANITATIONNoInitCast, SANITATIONNoTrgt)\r'\r'                        tdef = SANITATIONNoInitCast - SANITATION(R%, 1)\r'\r'                        If tdef > 0 Then\r'                            tother = SANITATION(R%, 2) + SANITATION(R%, 3)\r'                            SANITATION(R%, 2) = SANITATION(R%, 2) + tdef * SANITATION(R%, 2) / tother\r'                            SANITATION(R%, 3) = SANITATION(R%, 3) + tdef * SANITATION(R%, 3) / tother\r'                        End If\r\r'                   If RegName(R%) = \"Burundi\" Then Stop\r\r'-----new code --- 100% to HH\r'mti July 25, 2012 - start\r'SanitationHHTrgt = Amin(100, iSanitationHH(R%) + Amin(sanitationtrgtyr(R%), IY) * (sanitationtrgtval(R%) - iSanitationHH(R%)) / sanitationtrgtyr(R%))\rDim SanitationHHTrgt = Amin(100, iSanitationHH(R%) + Amin(sanitationtrgtyr(R%), IY - 1) * (sanitationtrgtval(R%) - iSanitationHH(R%)) / sanitationtrgtyr(R%))\r'mti July 25, 2012 - end\rDim SanitationHHInitCast = SANITATION(R%, 3)\rSANITATION(R%, 3) = AMAX(SanitationHHInitCast, SanitationHHTrgt)\r\rDim tdef = SANITATION(R%, 3) - SanitationHHInitCast\r\rIf tdef > 0 Then\rDim tother = SANITATION(R%, 1) + SANITATION(R%, 2)\rSANITATION(R%, 1) = SANITATION(R%, 1) - tdef * SANITATION(R%, 1) / tother\r'Sanitation2ndCatInitCast = SanitationBF(R%, 2)\rSANITATION(R%, 2) = SANITATION(R%, 2) - tdef * SANITATION(R%, 2) / tother\rEnd If\r\r'mti May Day 2012 - end\r'End If\rEnd If\r\r\r\r\r'mti April 05, 2012 -start\r'End If\r'mti April 05, 2012 -end\r'mti July 18, 2011 - end\r\r'mti May 05, 2011 - start\r'parameter goal seek - start\rIf sanitationtrgtyr(R%) > 0 Then\r'If sINFRAELECACC(R%, Urban) < 100 Then\r'mti June 08, 2011 - start\r'                        RatChange = Amin(1, 0.05 / AMAX(0.001, SSANITATION(R%, 1)))\r'\r'                        'ConvTime = AMAX(3, sanitationtrgtyr(R%)- 5 - IY) ' 30  'years\r'                        ConvTime = AMAX(1, sanitationtrgtyr(R%)- IY)  ' 30  'years\r'                        'mti June 08, 2011 - end\r'                        cGrowthRateTarget = RatChange ^ (1 / ConvTime) - 1\r'                        SANITATIONNoTrgt = SSANITATION(R%, 1) * (1 + cGrowthRateTarget)\r\r'mti October 20, 2011 - start\r'                        DistTrgt = AMAX(0, SSANITATION(R%, 1) - 0)\r'                        TimeLeft = AMAX(1, sanitationtrgtyr(R%) + 2 - IY)\r\r'                        SANITATIONNoTrgt = AMAX(0, SSANITATION(R%, 1) - DistTrgt / TimeLeft)\r\r'mti May Day 2012 - start\r'-----old code --- 0% None\r'SANITATIONNoTrgt = iSanitationNone(R%) - Amin(sanitationtrgtyr(R%), IY) * iSanitationNone(R%) / sanitationtrgtyr(R%)\r\r'mti October 20, 2011 - end\r\r'mti June 08, 2011 -end\r\r'                        SANITATIONNoInitCast = SANITATION(R%, 1)\r'                        SANITATION(R%, 1) = Amin(SANITATIONNoInitCast, SANITATIONNoTrgt)\r'\r'                        tdef = SANITATIONNoInitCast - SANITATION(R%, 1)\r'\r'                        If tdef > 0 Then\r'                            tother = SANITATION(R%, 2) + SANITATION(R%, 3)\r'                            SANITATION(R%, 2) = SANITATION(R%, 2) + tdef * SANITATION(R%, 2) / tother\r'                            SANITATION(R%, 3) = SANITATION(R%, 3) + tdef * SANITATION(R%, 3) / tother\r'                        End If\r\r'                   If RegName(R%) = \"Burundi\" Then Stop\r\r'-----new code --- 100% to HH\r'mti July 25, 2012 - start\r'SanitationHHTrgt = Amin(100, iSanitationHH(R%) + Amin(sanitationtrgtyr(R%), IY) * (sanitationtrgtval(R%) - iSanitationHH(R%)) / sanitationtrgtyr(R%))\rDim SanitationHHTrgt = Amin(100, iSanitationHH(R%) + Amin(sanitationtrgtyr(R%), IY - 1) * (sanitationtrgtval(R%) - iSanitationHH(R%)) / sanitationtrgtyr(R%))\r'mti July 25, 2012 - end\rDim SanitationHHInitCast = SANITATION(R%, 3)\rSANITATION(R%, 3) = AMAX(SanitationHHInitCast, SanitationHHTrgt)\r\rDim tdef = SANITATION(R%, 3) - SanitationHHInitCast\r\rIf tdef > 0 Then\rDim tother = SANITATION(R%, 1) + SANITATION(R%, 2)\rSANITATION(R%, 1) = SANITATION(R%, 1) - tdef * SANITATION(R%, 1) / tother\r'Sanitation2ndCatInitCast = SanitationBF(R%, 2)\rSANITATION(R%, 2) = SANITATION(R%, 2) - tdef * SANITATION(R%, 2) / tother\rEnd If\r\r'mti May Day 2012 - end\r'End If\rEnd If\r\r\r\r\r'mti April 05, 2012 -start\r'End If\r'mti April 05, 2012 -end\r'mti July 18, 2011 - end\r\r'mti May 05, 2011 - start\r'parameter goal seek - start\rIf sanitationtrgtyr(R%) > 0 Then\r'If sINFRAELECACC(R%, Urban) < 100 Then\r'mti June 08, 2011 - start\r'                        RatChange = Amin(1, 0.05 / AMAX(0.001, SSANITATION(R%, 1)))\r'\r'                        'ConvTime = AMAX(3, sanitationtrgtyr(R%)- 5 - IY) ' 30  'years\r'                        ConvTime = AMAX(1, sanitationtrgtyr(R%)- IY)  ' 30  'years\r'                        'mti June 08, 2011 - end\r'                        cGrowthRateTarget = RatChange ^ (1 / ConvTime) - 1\r'                        SANITATIONNoTrgt = SSANITATION(R%, 1) * (1 + cGrowthRateTarget)\r\r'mti October 20, 2011 - start\r'                        DistTrgt = AMAX(0, SSANITATION(R%, 1) - 0)\r'                        TimeLeft = AMAX(1, sanitationtrgtyr(R%) + 2 - IY)\r\r'                        SANITATIONNoTrgt = AMAX(0, SSANITATION(R%, 1) - DistTrgt / TimeLeft)\r\r'mti May Day 2012 - start\r'-----old code --- 0% None\r'SANITATIONNoTrgt = iSanitationNone(R%) - Amin(sanitationtrgtyr(R%), IY) * iSanitationNone(R%) / sanitationtrgtyr(R%)\r\r'mti October 20, 2011 - end\r\r'mti June 08, 2011 -end\r\r'                        SANITATIONNoInitCast = SANITATION(R%, 1)\r'                        SANITATION(R%, 1) = Amin(SANITATIONNoInitCast, SANITATIONNoTrgt)\r'\r'                        tdef = SANITATIONNoInitCast - SANITATION(R%, 1)\r'\r'                        If tdef > 0 Then\r'                            tother = SANITATION(R%, 2) + SANITATION(R%, 3)\r'                            SANITATION(R%, 2) = SANITATION(R%, 2) + tdef * SANITATION(R%, 2) / tother\r'                            SANITATION(R%, 3) = SANITATION(R%, 3) + tdef * SANITATION(R%, 3) / tother\r'                        End If\r\r'                   If RegName(R%) = \"Burundi\" Then Stop\r\r'-----new code --- 100% to HH\r'mti July 25, 2012 - start\r'SanitationHHTrgt = Amin(100, iSanitationHH(R%) + Amin(sanitationtrgtyr(R%), IY) * (sanitationtrgtval(R%) - iSanitationHH(R%)) / sanitationtrgtyr(R%))\rDim SanitationHHTrgt = Amin(100, iSanitationHH(R%) + Amin(sanitationtrgtyr(R%), IY - 1) * (sanitationtrgtval(R%) - iSanitationHH(R%)) / sanitationtrgtyr(R%))\r'mti July 25, 2012 - end\rDim SanitationHHInitCast = SANITATION(R%, 3)\rSANITATION(R%, 3) = AMAX(SanitationHHInitCast, SanitationHHTrgt)\r\rDim tdef = SANITATION(R%, 3) - SanitationHHInitCast\r\rIf tdef > 0 Then\rDim tother = SANITATION(R%, 1) + SANITATION(R%, 2)\rSANITATION(R%, 1) = SANITATION(R%, 1) - tdef * SANITATION(R%, 1) / tother\r'Sanitation2ndCatInitCast = SanitationBF(R%, 2)\rSANITATION(R%, 2) = SANITATION(R%, 2) - tdef * SANITATION(R%, 2) / tother\rEnd If\r\r'mti May Day 2012 - end\r'End If\rEnd If\r\r\r\rFor j = 1 To 3\rSSANITATION(R%, j) = SANITATION(R%, j)\rsssanitation(R%, j) = SANITATION(R%, j)\r'mti 2021/08/10 start\rsPreBudSanitation(R%, j) = SANITATION(R%, j)\rNext j\r\r'parameter goal seek - end\r'mti May 05, 2011 - start\r\r'mti 2014/05/28 - start\r'See if curve has shifted up by extra money in the previous year (for improved cat only)\r'mti 2021/08/10 start\r'SanitImpShiftPrevYear = AMAX(0, (SSANITATION(R%, 3) - sPreBudSanitation(R%))) 'percent point\rDim SanitImpShiftPrevYear = AMAX(0, (SSANITATION(R%, 3) - sPreBudSanitation(R%, 3))) 'percent point\r\r'mti 2021/08/10 end\r'might be an issue in a multiplier scenario; as SICTBROAD will have multiplier effect; and SBroad(R, 3)  is saved pre-multiplier\r\r'      If RegName(R%) = \"Saudi Arabia\" And IY >= 7 Then Stop\r\r'In case curve has shifted up (by extra money in the previous year, demand signal needs to be sent so that it could continue to stay there\rSANITATION(R%, 3) = Amin(100, SANITATION(R%, 3) + SanitImpShiftPrevYear)\r\rDim calsanitation2 = SANITATION(R%, 1) + SANITATION(R%, 2)\r\r\rDim Calsanitation1 = 100 - SANITATION(R%, 3)\r\r\rIf calsanitation2 > 0 Then\rSANITATION(R%, 1) = Amin(100, AMAX(0, SANITATION(R%, 1) * Calsanitation1 / calsanitation2))\rSANITATION(R%, 2) = Amin(100, AMAX(0, SANITATION(R%, 2) * Calsanitation1 / calsanitation2))\rEnd If\r\rDim calsanitation2 = SANITATION(R%, 1) + SANITATION(R%, 2)\r\r\rDim Calsanitation1 = 100 - SANITATION(R%, 3)\r\r\rIf calsanitation2 > 0 Then\rSANITATION(R%, 1) = Amin(100, AMAX(0, SANITATION(R%, 1) * Calsanitation1 / calsanitation2))\rSANITATION(R%, 2) = Amin(100, AMAX(0, SANITATION(R%, 2) * Calsanitation1 / calsanitation2))\rEnd If\r\r\r'mti 2014/05/28 - end\rElse 'Sanitation Hold swith is On\rFor j = 1 To 3\rSANITATION(R%, j) = SSANITATION(R%, j)\rNext j\r\r"
  },
  {
    "Variable": "SANITATION",
    "UsesVariable": "sanitationtrgtval",
    "Distance": 2,
    "Code": "\r\r'mti 2014/05/28 - start\r'sPreBudSanitation(R%) = SANITATION(R%, 3)\r'mti 2021/08/10 End\r'mti 2014/05/28 - end\r\r'mti May Day 2012 - start\r'mti October 20, 2011 - start\r'iSanitationNone(R%) = SANITATION(R%, 1)\r'mti October 20, 2011 - end\riSanitationHH(R%) = SANITATION(R%, 3)\r"
  },
  {
    "Variable": "SANITATION",
    "UsesVariable": "sanitationm",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "SANITATION",
    "UsesVariable": "GDPPCP",
    "Distance": 20,
    "Code": "0"
  },
  {
    "Variable": "SANITATION",
    "UsesVariable": "EDYRSAG25",
    "Distance": 20,
    "Code": "0"
  },
  {
    "Variable": "SANITATION",
    "UsesVariable": "sanitnoconsetar",
    "Distance": 1,
    "Code": "\r'jrs 2009/04/24 change to Additive Shift Factor\r'SANITATIONShift(R%, 3) = SANITATION(R%, 3) / calSANITATION\rSANITATIONShift(R%, 3) = SANITATION(R%, 3) - calsanitation\r\r'mti 2021/08/10 start\r'                If SANITATIONShift(R%, 1) > 0 Then\r'                    SanNoAdd = ConvergeOverTime(SANITATIONShift(R%, 1), 0, watsanconv)  '100\r'                Else\r'                    SanNoAdd = SANITATIONShift(R%, 1) '+ ConvergeOverTime(SANITATIONShift(R%, 1), 0, 1000)\r'                End If\rSanNoAdd = ConvergeOverTime(SANITATIONShift(R%, 1), 0, watsanconv)  '100\r\r\rcalsanitation = CSng(s1 / (1 + s1 + s2) * 100)\r\r'mti 2021/08/10 End\r'mti July 18, 2011 -end\r\r'mti October 20, 2011 -start\r'BBH/JRS SE approach\r'dkb 2013/09/16 added dimension 1 to sanitnoconsetar and sanitnoconseyrtar\r\rIf sanitnoconsetar(R%) <> 0 Then\r'mti April 05, 2012 - start\r'SanNoSE = 12.8\rDim SanNoSE = 10\r'mti April 05, 2012 -end\r'mti July 05, 2012 - target bound\rEffectSE = StdErrorAdditiveShift(CSng(SanNoSE), CSng(calsanitation), CSng(SanNoAdd), CSng(SANITATIONShift(R%, 1)),\r                        CSng(sanitnoconsetar(R%)), CInt(FirstYear + sanitnoconseyrtar(R%)), FirstYear + IY - 1, FirstYear)\rEnd If\r\rwatsanconv = 75 '50\r\r'jrs 2009/04/24 change to Additive Shift Factor\r'SANITATIONShift(R%, 3) = SANITATION(R%, 3) / calSANITATION\rSANITATIONShift(R%, 3) = SANITATION(R%, 3) - calsanitation\r\r'mti February 2011 Infarstructure -end\rDim s2 = Math.Exp(calsanitation)\r\r\rDim s1 = Math.Exp(calsanitation)\r\r'mti 2021/08/10 End\r'mti July 18, 2011 -end\r\r'mti October 20, 2011 -start\r'BBH/JRS SE approach\r'dkb 2013/09/16 added dimension 1 to sanitnoconsetar and sanitnoconseyrtar\r\rIf sanitnoconsetar(R%) <> 0 Then\r'mti April 05, 2012 - start\r'SanNoSE = 12.8\rDim SanNoSE = 10\r'mti April 05, 2012 -end\r'mti July 05, 2012 - target bound\rEffectSE = StdErrorAdditiveShift(CSng(SanNoSE), CSng(calsanitation), CSng(SanNoAdd), CSng(SANITATIONShift(R%, 1)),\r                        CSng(sanitnoconsetar(R%)), CInt(FirstYear + sanitnoconseyrtar(R%)), FirstYear + IY - 1, FirstYear)\rEnd If\r\r'mti 2021/08/10 start\r'                If SANITATIONShift(R%, 1) > 0 Then\r'                    SanNoAdd = ConvergeOverTime(SANITATIONShift(R%, 1), 0, watsanconv)  '100\r'                Else\r'                    SanNoAdd = SANITATIONShift(R%, 1) '+ ConvergeOverTime(SANITATIONShift(R%, 1), 0, 1000)\r'                End If\rSanNoAdd = ConvergeOverTime(SANITATIONShift(R%, 1), 0, watsanconv)  '100\r\r\rcalsanitation = CSng(s1 / (1 + s1 + s2) * 100)\r\r\r'mti note: JRS original model did not have upper and lower bounds here; Check if that makes a difference\r'If IY + FirstYear - 1 = 2044 And GRPS(1, R) = \"Liberia\" Then Stop\rSANITATION(R%, 1) = calsanitation + SanNoAdd + EffectSE\r\r'mti October 20, 2011 - end\r\rSANITATION(R%, 1) = AMAX(Amin(SANITATION(R%, 1), 100), 0)\r\r\r'Governance Regulatory Quality (using Efectiveness)\r'substracting -2.5 since forecast runs from 0 to 5\r'while historic variables run from -2.5 to 2.5 (used to find regression)\r'----------------------------------------------------------------------\r'jrs 2009/10/16 not used anymore Gov = GOVREGQUAL(R) - 2.5\r'GiniExtended\r'------------\r'mti February 2011 Infarstructure - start\r'jrs 2009/10/16 GiniExt = GINIDOM(R) * 100\r'Poverty = SINCOMELT1LN(R%) / POP(R%) * 100\r'Poverty = SINCOMELT1CS(R%) / POP(R%) * 100\rDim Poverty = SINCOMELT1CS(R%) / sPOPTotal(R%) * 100\r"
  },
  {
    "Variable": "SANITATION",
    "UsesVariable": "sanitnoconseyrtar",
    "Distance": 1,
    "Code": "\r'jrs 2009/04/24 change to Additive Shift Factor\r'SANITATIONShift(R%, 3) = SANITATION(R%, 3) / calSANITATION\rSANITATIONShift(R%, 3) = SANITATION(R%, 3) - calsanitation\r"
  },
  {
    "Variable": "SANITATION",
    "UsesVariable": "GDS",
    "Distance": 122,
    "Code": "0"
  },
  {
    "Variable": "SANITATION",
    "UsesVariable": "GDP",
    "Distance": 122,
    "Code": "0"
  },
  {
    "Variable": "SANITATION",
    "UsesVariable": "igdpr",
    "Distance": 136,
    "Code": "0"
  },
  {
    "Variable": "SANITATION",
    "UsesVariable": "POPR",
    "Distance": 136,
    "Code": "0"
  },
  {
    "Variable": "SANITATION",
    "UsesVariable": "sanithldsw",
    "Distance": 0,
    "Code": "\r'mti Dec 12, 2010 - end\r'             If IY >= 69 And RegName(R%) = \"DominicanRep\" Then Stop\r'             If SANITATION(R%, 1) < 0 And RegName(R%) = \"DominicanRep\" Then Stop\r'mti Dec 12, 2010 - start\rIf sanithldsw = 0 Then\r'jrs 2009/12/22\rFor j = 1 To 3\rsssanitation(R%, j) = SSANITATION(R%, j)\rSSANITATION(R%, j) = SANITATION(R%, j)\rNext j\rEnd If\r"
  },
  {
    "Variable": "SANITATIONCOST",
    "UsesVariable": "sanitationcostm",
    "Distance": 0,
    "Code": "\r'mti February 2011 Infarstructure - start\r'----------sanitation connection cost---------\r'            SanitConadded = AMAX(0, (SANITATION(R%, 3) * POP(R%) / HHSIZE(R%) - SSANITATION(R%, 3) * CDbl(sPOPTOTAL(R%)) / sHHSIZEWS(R%)) * 10000)\rCalcInfraUnitCost(R%, 10, 5, sanitationcostupper, sanitationcostlower, sGDPPCP(R%), SANITATIONCOST(R%))\r\r'mti April 2011 -start\rSANITATIONCOST(R%) = SANITATIONCOST(R%) * sanitationcostm(R%)\r"
  },
  {
    "Variable": "SANITATIONIMPCOST",
    "UsesVariable": "sanitationimpcostm",
    "Distance": 0,
    "Code": "\rCalcInfraInvest(CDbl(SanitDemThousands), CDbl(sSanitThousands),\r                            DeppcntWS(SanitationHH), SANITATIONCOST(R%), INFRAINVESTNEW(R%, SanitationHH), INFRAINVESTMAINT(R%, SanitationHH))\r\r\r\r'----------sanitation Other Improved cost---------\r'            SanitConadded = AMAX(0, (SANITATION(R%, 3) * POP(R%) / HHSIZE(R%) - SSANITATION(R%, 3) * CDbl(sPOPTOTAL(R%)) / sHHSIZEWS(R%)) * 10000)\rCalcInfraUnitCost(R%, 10, 5, sanitationimpcostupper, sanitationimpcostlower, sGDPPCP(R%), SANITATIONIMPCOST(R%))\r\rSANITATIONIMPCOST(R%) = SANITATIONIMPCOST(R%) * sanitationimpcostm(R%)\r"
  },
  {
    "Variable": "SANITHH",
    "UsesVariable": "POPURBAN",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "SANITHH",
    "UsesVariable": "SANITHHDEM",
    "Distance": 0,
    "Code": "\r\r'mti 2022/08/17\rPublic Sub IFsInfraWATSANNew2AllbutFirstYear(context As IForecastContext)\rDim Loc As Integer\rFor R% = 1 To NR%\r'mti 2022/09/16 start\rFor Loc% = 1 To 2       '3-> national; done in all years\rFor Srvc% = 1 To 5\rWATERHH(R%, Srvc%, Loc%) = WATERHHDEM(R%, Srvc%, Loc%)   '..DEM is desired demand (=base forecast + scenario; before financial impact)\rSANITHH(R%, Srvc%, Loc%) = SANITHHDEM(R%, Srvc%, Loc%)\rNext\rNext Loc%\r\r\r'mti 2022/09/29 start\r'One final normalization\rFor Loc% = 1 To 2\rDim SumSanitHH As Single = 0\r\rFor Srvc% = 1 To 5\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\r\rNext\rFor Srvc% = 1 To 5\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) / AMAX(0.0001, SumSanitHH) * 100\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) / AMAX(0.0001, SumWaterHH) * 100\rNext\rNext Loc%\r"
  },
  {
    "Variable": "SANITHH",
    "UsesVariable": "sanithhbasictrgtval",
    "Distance": 6,
    "Code": "\r'mti 2022/09/21 End\r'mti 2022/09/12 end\r\r\r\r'******** End Sanitation  ***************\r\r'mti 2022/11/23 start\r'Initializing variables for target start year and sttart value\rFor Loc% = 1 To 3           '2   '3\rWaterHHSafeTrgtStartValue(R%, Loc) = Nothing\rSANITHHSafeTrgtStartValue(R%, Loc) = Nothing\rWaterHHSafeTrgtStartYr(R%, Loc) = 0\rSANITHHSafeTrgtStartYr(R%, Loc) = 0\r\rWaterHHBasicTrgtStartValue(R%, Loc) = Nothing\rSanitHHBasicTrgtStartValue(R%, Loc) = Nothing\rWaterHHBasicTrgtStartYr(R%, Loc) = 0\rSanitHHBasicTrgtStartYr(R%, Loc) = 0\rNext Loc%\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not SanitHHBasicTrgtStartValue(R%, Loc).HasValue Then\rSanitHHBasicTrgtStartValue(R%, Loc) = sSanitHH(R%, SafelyManaged, Loc%) + sSanitHH(R%, Basic, Loc%)\rEnd If\rIf SanitHHBasicTrgtStartYr(R%, Loc) = 0 Then\rSanitHHBasicTrgtStartYr(R%, Loc) = IY '\rEnd If\rDim TrgtPathVal = AMAX(SANITHH(R%, SafelyManaged, Loc%) + SANITHH(R%, Basic, Loc%),\r                                    ConvergeOverTimeFromStartYear(CSng(SanitHHBasicTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), SanitHHBasicTrgtStartYr(R%, Loc)))\r\r'iAtLeastBasic = iSanitHH(R%, SafelyManaged, Loc%) + iSanitHH(R%, Basic, Loc%)\r'TrgtPathVal = ConvergeOverTime(iAtLeastBasic, TargetVal, TargetYear)\r'mti 2022/11/23 End\r\r'Normalize Safely Managed and Basic\rSumSanitHH = 0\rFor Srvc% = 4 To 5\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 4 To 5\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * TrgtPathVal / SumSanitHH\rNext Srvc%\rEnd If\r\r'Normalize the other 3 categories\rSumSanitHH = 0\rFor Srvc% = 1 To 3\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 1 To 3\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * (100 - SANITHH(R%, SafelyManaged, Loc%) - SANITHH(R%, Basic, Loc%)) / SumSanitHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not SanitHHBasicTrgtStartValue(R%, Loc).HasValue Then\rSanitHHBasicTrgtStartValue(R%, Loc) = sSanitHH(R%, SafelyManaged, Loc%) + sSanitHH(R%, Basic, Loc%)\rEnd If\rIf SanitHHBasicTrgtStartYr(R%, Loc) = 0 Then\rSanitHHBasicTrgtStartYr(R%, Loc) = IY '\rEnd If\rDim TrgtPathVal = AMAX(SANITHH(R%, SafelyManaged, Loc%) + SANITHH(R%, Basic, Loc%),\r                                    ConvergeOverTimeFromStartYear(CSng(SanitHHBasicTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), SanitHHBasicTrgtStartYr(R%, Loc)))\r\r'iAtLeastBasic = iSanitHH(R%, SafelyManaged, Loc%) + iSanitHH(R%, Basic, Loc%)\r'TrgtPathVal = ConvergeOverTime(iAtLeastBasic, TargetVal, TargetYear)\r'mti 2022/11/23 End\r\r'Normalize Safely Managed and Basic\rSumSanitHH = 0\rFor Srvc% = 4 To 5\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 4 To 5\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * TrgtPathVal / SumSanitHH\rNext Srvc%\rEnd If\r\r'Normalize the other 3 categories\rSumSanitHH = 0\rFor Srvc% = 1 To 3\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 1 To 3\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * (100 - SANITHH(R%, SafelyManaged, Loc%) - SANITHH(R%, Basic, Loc%)) / SumSanitHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf sanithhbasictrgtyr(R%, National) <> 0 Then   'National overrides urban and rural\rTargetYear = sanithhbasictrgtyr(R%, National)\rTargetVal = sanithhbasictrgtval(R%, National)\rEnd If\r\rIf sanithhbasictrgtyr(R%, National) <> 0 Then   'National overrides urban and rural\rTargetYear = sanithhbasictrgtyr(R%, National)\rTargetVal = sanithhbasictrgtval(R%, National)\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not SanitHHBasicTrgtStartValue(R%, Loc).HasValue Then\rSanitHHBasicTrgtStartValue(R%, Loc) = sSanitHH(R%, SafelyManaged, Loc%) + sSanitHH(R%, Basic, Loc%)\rEnd If\rIf SanitHHBasicTrgtStartYr(R%, Loc) = 0 Then\rSanitHHBasicTrgtStartYr(R%, Loc) = IY '\rEnd If\rDim TrgtPathVal = AMAX(SANITHH(R%, SafelyManaged, Loc%) + SANITHH(R%, Basic, Loc%),\r                                    ConvergeOverTimeFromStartYear(CSng(SanitHHBasicTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), SanitHHBasicTrgtStartYr(R%, Loc)))\r\r'iAtLeastBasic = iSanitHH(R%, SafelyManaged, Loc%) + iSanitHH(R%, Basic, Loc%)\r'TrgtPathVal = ConvergeOverTime(iAtLeastBasic, TargetVal, TargetYear)\r'mti 2022/11/23 End\r\r'Normalize Safely Managed and Basic\rSumSanitHH = 0\rFor Srvc% = 4 To 5\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 4 To 5\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * TrgtPathVal / SumSanitHH\rNext Srvc%\rEnd If\r\r'Normalize the other 3 categories\rSumSanitHH = 0\rFor Srvc% = 1 To 3\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 1 To 3\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * (100 - SANITHH(R%, SafelyManaged, Loc%) - SANITHH(R%, Basic, Loc%)) / SumSanitHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not SanitHHBasicTrgtStartValue(R%, Loc).HasValue Then\rSanitHHBasicTrgtStartValue(R%, Loc) = sSanitHH(R%, SafelyManaged, Loc%) + sSanitHH(R%, Basic, Loc%)\rEnd If\rIf SanitHHBasicTrgtStartYr(R%, Loc) = 0 Then\rSanitHHBasicTrgtStartYr(R%, Loc) = IY '\rEnd If\rDim TrgtPathVal = AMAX(SANITHH(R%, SafelyManaged, Loc%) + SANITHH(R%, Basic, Loc%),\r                                    ConvergeOverTimeFromStartYear(CSng(SanitHHBasicTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), SanitHHBasicTrgtStartYr(R%, Loc)))\r\r'iAtLeastBasic = iSanitHH(R%, SafelyManaged, Loc%) + iSanitHH(R%, Basic, Loc%)\r'TrgtPathVal = ConvergeOverTime(iAtLeastBasic, TargetVal, TargetYear)\r'mti 2022/11/23 End\r\r'Normalize Safely Managed and Basic\rSumSanitHH = 0\rFor Srvc% = 4 To 5\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 4 To 5\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * TrgtPathVal / SumSanitHH\rNext Srvc%\rEnd If\r\r'Normalize the other 3 categories\rSumSanitHH = 0\rFor Srvc% = 1 To 3\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 1 To 3\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * (100 - SANITHH(R%, SafelyManaged, Loc%) - SANITHH(R%, Basic, Loc%)) / SumSanitHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not SanitHHBasicTrgtStartValue(R%, Loc).HasValue Then\rSanitHHBasicTrgtStartValue(R%, Loc) = sSanitHH(R%, SafelyManaged, Loc%) + sSanitHH(R%, Basic, Loc%)\rEnd If\rIf SanitHHBasicTrgtStartYr(R%, Loc) = 0 Then\rSanitHHBasicTrgtStartYr(R%, Loc) = IY '\rEnd If\rDim TrgtPathVal = AMAX(SANITHH(R%, SafelyManaged, Loc%) + SANITHH(R%, Basic, Loc%),\r                                    ConvergeOverTimeFromStartYear(CSng(SanitHHBasicTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), SanitHHBasicTrgtStartYr(R%, Loc)))\r\r'iAtLeastBasic = iSanitHH(R%, SafelyManaged, Loc%) + iSanitHH(R%, Basic, Loc%)\r'TrgtPathVal = ConvergeOverTime(iAtLeastBasic, TargetVal, TargetYear)\r'mti 2022/11/23 End\r\r'Normalize Safely Managed and Basic\rSumSanitHH = 0\rFor Srvc% = 4 To 5\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 4 To 5\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * TrgtPathVal / SumSanitHH\rNext Srvc%\rEnd If\r\r'Normalize the other 3 categories\rSumSanitHH = 0\rFor Srvc% = 1 To 3\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 1 To 3\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * (100 - SANITHH(R%, SafelyManaged, Loc%) - SANITHH(R%, Basic, Loc%)) / SumSanitHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not SanitHHBasicTrgtStartValue(R%, Loc).HasValue Then\rSanitHHBasicTrgtStartValue(R%, Loc) = sSanitHH(R%, SafelyManaged, Loc%) + sSanitHH(R%, Basic, Loc%)\rEnd If\rIf SanitHHBasicTrgtStartYr(R%, Loc) = 0 Then\rSanitHHBasicTrgtStartYr(R%, Loc) = IY '\rEnd If\rDim TrgtPathVal = AMAX(SANITHH(R%, SafelyManaged, Loc%) + SANITHH(R%, Basic, Loc%),\r                                    ConvergeOverTimeFromStartYear(CSng(SanitHHBasicTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), SanitHHBasicTrgtStartYr(R%, Loc)))\r\r'iAtLeastBasic = iSanitHH(R%, SafelyManaged, Loc%) + iSanitHH(R%, Basic, Loc%)\r'TrgtPathVal = ConvergeOverTime(iAtLeastBasic, TargetVal, TargetYear)\r'mti 2022/11/23 End\r\r'Normalize Safely Managed and Basic\rSumSanitHH = 0\rFor Srvc% = 4 To 5\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 4 To 5\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * TrgtPathVal / SumSanitHH\rNext Srvc%\rEnd If\r\r'Normalize the other 3 categories\rSumSanitHH = 0\rFor Srvc% = 1 To 3\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 1 To 3\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * (100 - SANITHH(R%, SafelyManaged, Loc%) - SANITHH(R%, Basic, Loc%)) / SumSanitHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not SanitHHBasicTrgtStartValue(R%, Loc).HasValue Then\rSanitHHBasicTrgtStartValue(R%, Loc) = sSanitHH(R%, SafelyManaged, Loc%) + sSanitHH(R%, Basic, Loc%)\rEnd If\rIf SanitHHBasicTrgtStartYr(R%, Loc) = 0 Then\rSanitHHBasicTrgtStartYr(R%, Loc) = IY '\rEnd If\rDim TrgtPathVal = AMAX(SANITHH(R%, SafelyManaged, Loc%) + SANITHH(R%, Basic, Loc%),\r                                    ConvergeOverTimeFromStartYear(CSng(SanitHHBasicTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), SanitHHBasicTrgtStartYr(R%, Loc)))\r\r'iAtLeastBasic = iSanitHH(R%, SafelyManaged, Loc%) + iSanitHH(R%, Basic, Loc%)\r'TrgtPathVal = ConvergeOverTime(iAtLeastBasic, TargetVal, TargetYear)\r'mti 2022/11/23 End\r\r'Normalize Safely Managed and Basic\rSumSanitHH = 0\rFor Srvc% = 4 To 5\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 4 To 5\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * TrgtPathVal / SumSanitHH\rNext Srvc%\rEnd If\r\r'Normalize the other 3 categories\rSumSanitHH = 0\rFor Srvc% = 1 To 3\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 1 To 3\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * (100 - SANITHH(R%, SafelyManaged, Loc%) - SANITHH(R%, Basic, Loc%)) / SumSanitHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not SanitHHBasicTrgtStartValue(R%, Loc).HasValue Then\rSanitHHBasicTrgtStartValue(R%, Loc) = sSanitHH(R%, SafelyManaged, Loc%) + sSanitHH(R%, Basic, Loc%)\rEnd If\rIf SanitHHBasicTrgtStartYr(R%, Loc) = 0 Then\rSanitHHBasicTrgtStartYr(R%, Loc) = IY '\rEnd If\rDim TrgtPathVal = AMAX(SANITHH(R%, SafelyManaged, Loc%) + SANITHH(R%, Basic, Loc%),\r                                    ConvergeOverTimeFromStartYear(CSng(SanitHHBasicTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), SanitHHBasicTrgtStartYr(R%, Loc)))\r\r'iAtLeastBasic = iSanitHH(R%, SafelyManaged, Loc%) + iSanitHH(R%, Basic, Loc%)\r'TrgtPathVal = ConvergeOverTime(iAtLeastBasic, TargetVal, TargetYear)\r'mti 2022/11/23 End\r\r'Normalize Safely Managed and Basic\rSumSanitHH = 0\rFor Srvc% = 4 To 5\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 4 To 5\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * TrgtPathVal / SumSanitHH\rNext Srvc%\rEnd If\r\r'Normalize the other 3 categories\rSumSanitHH = 0\rFor Srvc% = 1 To 3\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 1 To 3\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * (100 - SANITHH(R%, SafelyManaged, Loc%) - SANITHH(R%, Basic, Loc%)) / SumSanitHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not SanitHHBasicTrgtStartValue(R%, Loc).HasValue Then\rSanitHHBasicTrgtStartValue(R%, Loc) = sSanitHH(R%, SafelyManaged, Loc%) + sSanitHH(R%, Basic, Loc%)\rEnd If\rIf SanitHHBasicTrgtStartYr(R%, Loc) = 0 Then\rSanitHHBasicTrgtStartYr(R%, Loc) = IY '\rEnd If\rDim TrgtPathVal = AMAX(SANITHH(R%, SafelyManaged, Loc%) + SANITHH(R%, Basic, Loc%),\r                                    ConvergeOverTimeFromStartYear(CSng(SanitHHBasicTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), SanitHHBasicTrgtStartYr(R%, Loc)))\r\r'iAtLeastBasic = iSanitHH(R%, SafelyManaged, Loc%) + iSanitHH(R%, Basic, Loc%)\r'TrgtPathVal = ConvergeOverTime(iAtLeastBasic, TargetVal, TargetYear)\r'mti 2022/11/23 End\r\r'Normalize Safely Managed and Basic\rSumSanitHH = 0\rFor Srvc% = 4 To 5\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 4 To 5\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * TrgtPathVal / SumSanitHH\rNext Srvc%\rEnd If\r\r'Normalize the other 3 categories\rSumSanitHH = 0\rFor Srvc% = 1 To 3\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 1 To 3\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * (100 - SANITHH(R%, SafelyManaged, Loc%) - SANITHH(R%, Basic, Loc%)) / SumSanitHH\rNext Srvc%\rEnd If\r\rEnd If\r"
  },
  {
    "Variable": "SANITHH",
    "UsesVariable": "sanithhbasictrgtyr",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "SANITHH",
    "UsesVariable": "sanithhsafetrgtval",
    "Distance": 3,
    "Code": "\r'mti 2022/09/21 End\r'mti 2022/09/12 end\r\r\r\r'******** End Sanitation  ***************\r\r'mti 2022/11/23 start\r'Initializing variables for target start year and sttart value\rFor Loc% = 1 To 3           '2   '3\rWaterHHSafeTrgtStartValue(R%, Loc) = Nothing\rSANITHHSafeTrgtStartValue(R%, Loc) = Nothing\rWaterHHSafeTrgtStartYr(R%, Loc) = 0\rSANITHHSafeTrgtStartYr(R%, Loc) = 0\r\rWaterHHBasicTrgtStartValue(R%, Loc) = Nothing\rSanitHHBasicTrgtStartValue(R%, Loc) = Nothing\rWaterHHBasicTrgtStartYr(R%, Loc) = 0\rSanitHHBasicTrgtStartYr(R%, Loc) = 0\rNext Loc%\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not SANITHHSafeTrgtStartValue(R%, Loc).HasValue Then\rSANITHHSafeTrgtStartValue(R%, Loc) = sSanitHH(R%, SafelyManaged, Loc%)\rEnd If\rIf SANITHHSafeTrgtStartYr(R%, Loc) = 0 Then\rSANITHHSafeTrgtStartYr(R%, Loc) = IY '\rEnd If\rSANITHH(R%, SafelyManaged, Loc%) = AMAX(SANITHH(R%, SafelyManaged, Loc%), ConvergeOverTimeFromStartYear(CSng(SANITHHSafeTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), SANITHHSafeTrgtStartYr(R%, Loc)))\r'SANITHH(R%, SafelyManaged, Loc%) = AMAX(SANITHH(R%, SafelyManaged, Loc%), ConvergeOverTime(iSANITHH(R%, SafelyManaged, Loc%), TargetVal, TargetYear))\r'mti 2022/11/23 End\r\r'Normalize the other 4 categories\rSumSanitHH = 0\rFor Srvc% = 1 To 4\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 1 To 4\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * (100 - SANITHH(R%, SafelyManaged, Loc%)) / SumSanitHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf sanithhsafetrgtyr(R%, National) <> 0 Then   'National overrides urban and rural\rTargetYear = sanithhsafetrgtyr(R%, National)\rTargetVal = sanithhsafetrgtval(R%, National)\rEnd If\r\rIf sanithhsafetrgtyr(R%, National) <> 0 Then   'National overrides urban and rural\rTargetYear = sanithhsafetrgtyr(R%, National)\rTargetVal = sanithhsafetrgtval(R%, National)\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not SANITHHSafeTrgtStartValue(R%, Loc).HasValue Then\rSANITHHSafeTrgtStartValue(R%, Loc) = sSanitHH(R%, SafelyManaged, Loc%)\rEnd If\rIf SANITHHSafeTrgtStartYr(R%, Loc) = 0 Then\rSANITHHSafeTrgtStartYr(R%, Loc) = IY '\rEnd If\rSANITHH(R%, SafelyManaged, Loc%) = AMAX(SANITHH(R%, SafelyManaged, Loc%), ConvergeOverTimeFromStartYear(CSng(SANITHHSafeTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), SANITHHSafeTrgtStartYr(R%, Loc)))\r'SANITHH(R%, SafelyManaged, Loc%) = AMAX(SANITHH(R%, SafelyManaged, Loc%), ConvergeOverTime(iSANITHH(R%, SafelyManaged, Loc%), TargetVal, TargetYear))\r'mti 2022/11/23 End\r\r'Normalize the other 4 categories\rSumSanitHH = 0\rFor Srvc% = 1 To 4\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 1 To 4\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * (100 - SANITHH(R%, SafelyManaged, Loc%)) / SumSanitHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not SANITHHSafeTrgtStartValue(R%, Loc).HasValue Then\rSANITHHSafeTrgtStartValue(R%, Loc) = sSanitHH(R%, SafelyManaged, Loc%)\rEnd If\rIf SANITHHSafeTrgtStartYr(R%, Loc) = 0 Then\rSANITHHSafeTrgtStartYr(R%, Loc) = IY '\rEnd If\rSANITHH(R%, SafelyManaged, Loc%) = AMAX(SANITHH(R%, SafelyManaged, Loc%), ConvergeOverTimeFromStartYear(CSng(SANITHHSafeTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), SANITHHSafeTrgtStartYr(R%, Loc)))\r'SANITHH(R%, SafelyManaged, Loc%) = AMAX(SANITHH(R%, SafelyManaged, Loc%), ConvergeOverTime(iSANITHH(R%, SafelyManaged, Loc%), TargetVal, TargetYear))\r'mti 2022/11/23 End\r\r'Normalize the other 4 categories\rSumSanitHH = 0\rFor Srvc% = 1 To 4\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 1 To 4\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * (100 - SANITHH(R%, SafelyManaged, Loc%)) / SumSanitHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not SANITHHSafeTrgtStartValue(R%, Loc).HasValue Then\rSANITHHSafeTrgtStartValue(R%, Loc) = sSanitHH(R%, SafelyManaged, Loc%)\rEnd If\rIf SANITHHSafeTrgtStartYr(R%, Loc) = 0 Then\rSANITHHSafeTrgtStartYr(R%, Loc) = IY '\rEnd If\rSANITHH(R%, SafelyManaged, Loc%) = AMAX(SANITHH(R%, SafelyManaged, Loc%), ConvergeOverTimeFromStartYear(CSng(SANITHHSafeTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), SANITHHSafeTrgtStartYr(R%, Loc)))\r'SANITHH(R%, SafelyManaged, Loc%) = AMAX(SANITHH(R%, SafelyManaged, Loc%), ConvergeOverTime(iSANITHH(R%, SafelyManaged, Loc%), TargetVal, TargetYear))\r'mti 2022/11/23 End\r\r'Normalize the other 4 categories\rSumSanitHH = 0\rFor Srvc% = 1 To 4\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 1 To 4\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * (100 - SANITHH(R%, SafelyManaged, Loc%)) / SumSanitHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not SANITHHSafeTrgtStartValue(R%, Loc).HasValue Then\rSANITHHSafeTrgtStartValue(R%, Loc) = sSanitHH(R%, SafelyManaged, Loc%)\rEnd If\rIf SANITHHSafeTrgtStartYr(R%, Loc) = 0 Then\rSANITHHSafeTrgtStartYr(R%, Loc) = IY '\rEnd If\rSANITHH(R%, SafelyManaged, Loc%) = AMAX(SANITHH(R%, SafelyManaged, Loc%), ConvergeOverTimeFromStartYear(CSng(SANITHHSafeTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), SANITHHSafeTrgtStartYr(R%, Loc)))\r'SANITHH(R%, SafelyManaged, Loc%) = AMAX(SANITHH(R%, SafelyManaged, Loc%), ConvergeOverTime(iSANITHH(R%, SafelyManaged, Loc%), TargetVal, TargetYear))\r'mti 2022/11/23 End\r\r'Normalize the other 4 categories\rSumSanitHH = 0\rFor Srvc% = 1 To 4\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 1 To 4\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * (100 - SANITHH(R%, SafelyManaged, Loc%)) / SumSanitHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not SANITHHSafeTrgtStartValue(R%, Loc).HasValue Then\rSANITHHSafeTrgtStartValue(R%, Loc) = sSanitHH(R%, SafelyManaged, Loc%)\rEnd If\rIf SANITHHSafeTrgtStartYr(R%, Loc) = 0 Then\rSANITHHSafeTrgtStartYr(R%, Loc) = IY '\rEnd If\rSANITHH(R%, SafelyManaged, Loc%) = AMAX(SANITHH(R%, SafelyManaged, Loc%), ConvergeOverTimeFromStartYear(CSng(SANITHHSafeTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), SANITHHSafeTrgtStartYr(R%, Loc)))\r'SANITHH(R%, SafelyManaged, Loc%) = AMAX(SANITHH(R%, SafelyManaged, Loc%), ConvergeOverTime(iSANITHH(R%, SafelyManaged, Loc%), TargetVal, TargetYear))\r'mti 2022/11/23 End\r\r'Normalize the other 4 categories\rSumSanitHH = 0\rFor Srvc% = 1 To 4\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumSanitHH > 0 Then\rFor Srvc% = 1 To 4\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * (100 - SANITHH(R%, SafelyManaged, Loc%)) / SumSanitHH\rNext Srvc%\rEnd If\r\rEnd If\r\r'mti 2022/09/21 End\r'mti 2022/09/12 end\r\r\r\r'******** End Sanitation  ***************\r\r'mti 2022/11/23 start\r'Initializing variables for target start year and sttart value\rFor Loc% = 1 To 3           '2   '3\rWaterHHSafeTrgtStartValue(R%, Loc) = Nothing\rSANITHHSafeTrgtStartValue(R%, Loc) = Nothing\rWaterHHSafeTrgtStartYr(R%, Loc) = 0\rSANITHHSafeTrgtStartYr(R%, Loc) = 0\r\rWaterHHBasicTrgtStartValue(R%, Loc) = Nothing\rSanitHHBasicTrgtStartValue(R%, Loc) = Nothing\rWaterHHBasicTrgtStartYr(R%, Loc) = 0\rSanitHHBasicTrgtStartYr(R%, Loc) = 0\rNext Loc%\r'mti 2022/11/23 end\r\r\r\rIFsInfraWATSANNewAllYears(context)\r\r"
  },
  {
    "Variable": "SANITHH",
    "UsesVariable": "sanithhsafetrgtyr",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "SANITHH",
    "UsesVariable": "sanithhm",
    "Distance": 0,
    "Code": "\rFor Srvc% = 1 To 5\r'mti 2022/09/12 Start\rSANITHH(R%, Srvc%, Loc%) = Amin(100, SANITHH(R%, Srvc%, Loc%) * If(sanithhm(R%, Srvc%, National) <> 1, sanithhm(R%, Srvc%, National), sanithhm(R%, Srvc%, Loc%)))\r\rNext\r\r'Apply scenario paprameter - multiplier base 1   'Note - mutiplier on national will be implemented as same multiplier on rural and urban,\rSumSanitHH = 0\r\r'mti 2022/09/12 End\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\r\rNext\r\rFor Srvc% = 1 To 5 'normalize to 100%\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) / AMAX(0.0001, SumSanitHH) * 100\r\r'mti 2022/09/21 End\r'mti 2022/09/12 end\r\r\r\r'******** End Sanitation  ***************\r\r'mti 2022/11/23 start\r'Initializing variables for target start year and sttart value\rFor Loc% = 1 To 3           '2   '3\rWaterHHSafeTrgtStartValue(R%, Loc) = Nothing\rSANITHHSafeTrgtStartValue(R%, Loc) = Nothing\rWaterHHSafeTrgtStartYr(R%, Loc) = 0\rSANITHHSafeTrgtStartYr(R%, Loc) = 0\r\rWaterHHBasicTrgtStartValue(R%, Loc) = Nothing\rSanitHHBasicTrgtStartValue(R%, Loc) = Nothing\rWaterHHBasicTrgtStartYr(R%, Loc) = 0\rSanitHHBasicTrgtStartYr(R%, Loc) = 0\rNext Loc%\r"
  },
  {
    "Variable": "SANITHH",
    "UsesVariable": "gdprext",
    "Distance": 100,
    "Code": "\rDim CurGr As Single\rIf (SanitHHGR(R%, Srvc%, Loc%) <> -9999) And sSANITHHModel(R%, Srvc%, Loc%) <> 0 Then\r'China use sSANITHHModelPlus(R%, Srvc%, Loc%) instead\r'mti 2022/10/04 start\r'This is growth rate branch; MA_FCT is weight for smoothed convergence\r'CurGrowth = ConvergeOverTime(CurGrowth, SanitHHGR(R%, Srvc%, Loc%), 10)\r'mti 2022/10/04 end\rDim MA_Fct = 0.1\r'mti 2022/10/04 start\r'if SANITHH_Model = 0; it would give large negative growth rates;\r'may be hold SanitHHGR(R%, Srvc%, Loc%) same at that point, especially if it is negative (it would be negtaive, as it is coming down)\r'mti 2022/10/04 end\r\rIf COVIDShk_WS = 0 Then\rCurGr = CSng(AMAX(-0.1, Amin(0.1, MA_Fct * (SANITHH_Model / sSANITHHModel(R%, Srvc%, Loc%) - 1) + (1 - MA_Fct) * SanitHHGR(R%, Srvc%, Loc%))))\rSanitHHGR(R%, Srvc%, Loc%) = CurGr\rElse\rCurGr = CSng(AMAX(-0.1, Amin(0.1, 0.4 * (SANITHH_Model / sSANITHHModel(R%, Srvc%, Loc%) - 1) + 0.6 * SanitHHGR(R%, Srvc%, Loc%))))\rEnd If\rSANITHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sSANITHHModelPlus(R%, Srvc%, Loc%) * (1 + CurGr)))\r'mti 2022/09/29 End\r'mti 2022/10/04 start\rElse\rIf SanitHHGR(R%, Srvc%, Loc%) <> -9999 Then\rSanitHHGR(R%, Srvc%, Loc%) = CSng(0.85 * SanitHHGR(R%, Srvc%, Loc%))  'smoother convergence of growth rate to zero\rSANITHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sSANITHHModelPlus(R%, Srvc%, Loc%) * (1 + SanitHHGR(R%, Srvc%, Loc%))))\rEnd If\r'mti 2022/10/04 End\rEnd If\r\rIf IY% - 1 + FirstYear = 2021 And gdprext(USAidx) < 0 Then COVIDShk_WS = 1\r\rDim CurGr As Single\rIf (SanitHHGR(R%, Srvc%, Loc%) <> -9999) And sSANITHHModel(R%, Srvc%, Loc%) <> 0 Then\r'China use sSANITHHModelPlus(R%, Srvc%, Loc%) instead\r'mti 2022/10/04 start\r'This is growth rate branch; MA_FCT is weight for smoothed convergence\r'CurGrowth = ConvergeOverTime(CurGrowth, SanitHHGR(R%, Srvc%, Loc%), 10)\r'mti 2022/10/04 end\rDim MA_Fct = 0.1\r'mti 2022/10/04 start\r'if SANITHH_Model = 0; it would give large negative growth rates;\r'may be hold SanitHHGR(R%, Srvc%, Loc%) same at that point, especially if it is negative (it would be negtaive, as it is coming down)\r'mti 2022/10/04 end\r\rIf COVIDShk_WS = 0 Then\rCurGr = CSng(AMAX(-0.1, Amin(0.1, MA_Fct * (SANITHH_Model / sSANITHHModel(R%, Srvc%, Loc%) - 1) + (1 - MA_Fct) * SanitHHGR(R%, Srvc%, Loc%))))\rSanitHHGR(R%, Srvc%, Loc%) = CurGr\rElse\rCurGr = CSng(AMAX(-0.1, Amin(0.1, 0.4 * (SANITHH_Model / sSANITHHModel(R%, Srvc%, Loc%) - 1) + 0.6 * SanitHHGR(R%, Srvc%, Loc%))))\rEnd If\rSANITHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sSANITHHModelPlus(R%, Srvc%, Loc%) * (1 + CurGr)))\r'mti 2022/09/29 End\r'mti 2022/10/04 start\rElse\rIf SanitHHGR(R%, Srvc%, Loc%) <> -9999 Then\rSanitHHGR(R%, Srvc%, Loc%) = CSng(0.85 * SanitHHGR(R%, Srvc%, Loc%))  'smoother convergence of growth rate to zero\rSANITHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sSANITHHModelPlus(R%, Srvc%, Loc%) * (1 + SanitHHGR(R%, Srvc%, Loc%))))\rEnd If\r'mti 2022/10/04 End\rEnd If\r\r\r'mti 2022/09/12 start\r'mti 2022/09/21 start\rFor Loc% = 1 To 3           '2   '3\rFor Srvc% = 1 To 5\rSANITHHDEM(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\rSanitHHBF(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\r'mti 2022/09/27 start\rsSANITHHModel(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\r'mti 2022/09/27 end\r'mti 2022/09/29 start\rsSANITHHModelPlus(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\r'mti 2022/09/29 end\r\r'mti 2022/10/27 Start\rsSanitHHBF(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\r'mti 2022/10/27 End\r\rNext Srvc%\rNext Loc%\r\r\r'mti 2022/09/21 end\r'Apply scenario paprameter - multiplier base 1   'Note - mutiplier on national will be implemented as same multiplier on rural and urban,\r'mti 2022/09/06 start\r'SANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * If(sanithhm(R%, Srvc%, National) <> 1, sanithhm(R%, Srvc%, National), sanithhm(R%, Srvc%, Loc%))\r'mti 2022/09/06 End\r'mti 2022/09/27 start\r'If RegName(R%) = \"Mexico\" Then Stop\rDim SANITHH_Model = SANITHH(R%, Srvc%, Loc%)\r\rDim CurGr As Single\rIf (SanitHHGR(R%, Srvc%, Loc%) <> -9999) And sSANITHHModel(R%, Srvc%, Loc%) <> 0 Then\r'China use sSANITHHModelPlus(R%, Srvc%, Loc%) instead\r'mti 2022/10/04 start\r'This is growth rate branch; MA_FCT is weight for smoothed convergence\r'CurGrowth = ConvergeOverTime(CurGrowth, SanitHHGR(R%, Srvc%, Loc%), 10)\r'mti 2022/10/04 end\rDim MA_Fct = 0.1\r'mti 2022/10/04 start\r'if SANITHH_Model = 0; it would give large negative growth rates;\r'may be hold SanitHHGR(R%, Srvc%, Loc%) same at that point, especially if it is negative (it would be negtaive, as it is coming down)\r'mti 2022/10/04 end\r\rIf COVIDShk_WS = 0 Then\rCurGr = CSng(AMAX(-0.1, Amin(0.1, MA_Fct * (SANITHH_Model / sSANITHHModel(R%, Srvc%, Loc%) - 1) + (1 - MA_Fct) * SanitHHGR(R%, Srvc%, Loc%))))\rSanitHHGR(R%, Srvc%, Loc%) = CurGr\rElse\rCurGr = CSng(AMAX(-0.1, Amin(0.1, 0.4 * (SANITHH_Model / sSANITHHModel(R%, Srvc%, Loc%) - 1) + 0.6 * SanitHHGR(R%, Srvc%, Loc%))))\rEnd If\rSANITHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sSANITHHModelPlus(R%, Srvc%, Loc%) * (1 + CurGr)))\r'mti 2022/09/29 End\r'mti 2022/10/04 start\rElse\rIf SanitHHGR(R%, Srvc%, Loc%) <> -9999 Then\rSanitHHGR(R%, Srvc%, Loc%) = CSng(0.85 * SanitHHGR(R%, Srvc%, Loc%))  'smoother convergence of growth rate to zero\rSANITHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sSANITHHModelPlus(R%, Srvc%, Loc%) * (1 + SanitHHGR(R%, Srvc%, Loc%))))\rEnd If\r'mti 2022/10/04 End\rEnd If\r\r\r'mti 2022/09/12 start\r'mti 2022/09/21 start\rFor Loc% = 1 To 3           '2   '3\rFor Srvc% = 1 To 5\rSANITHHDEM(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\rSanitHHBF(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\r'mti 2022/09/27 start\rsSANITHHModel(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\r'mti 2022/09/27 end\r'mti 2022/09/29 start\rsSANITHHModelPlus(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\r'mti 2022/09/29 end\r\r'mti 2022/10/27 Start\rsSanitHHBF(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\r'mti 2022/10/27 End\r\rNext Srvc%\rNext Loc%\r\rDim CurGr As Single\rIf (SanitHHGR(R%, Srvc%, Loc%) <> -9999) And sSANITHHModel(R%, Srvc%, Loc%) <> 0 Then\r'China use sSANITHHModelPlus(R%, Srvc%, Loc%) instead\r'mti 2022/10/04 start\r'This is growth rate branch; MA_FCT is weight for smoothed convergence\r'CurGrowth = ConvergeOverTime(CurGrowth, SanitHHGR(R%, Srvc%, Loc%), 10)\r'mti 2022/10/04 end\rDim MA_Fct = 0.1\r'mti 2022/10/04 start\r'if SANITHH_Model = 0; it would give large negative growth rates;\r'may be hold SanitHHGR(R%, Srvc%, Loc%) same at that point, especially if it is negative (it would be negtaive, as it is coming down)\r'mti 2022/10/04 end\r\rIf COVIDShk_WS = 0 Then\rCurGr = CSng(AMAX(-0.1, Amin(0.1, MA_Fct * (SANITHH_Model / sSANITHHModel(R%, Srvc%, Loc%) - 1) + (1 - MA_Fct) * SanitHHGR(R%, Srvc%, Loc%))))\rSanitHHGR(R%, Srvc%, Loc%) = CurGr\rElse\rCurGr = CSng(AMAX(-0.1, Amin(0.1, 0.4 * (SANITHH_Model / sSANITHHModel(R%, Srvc%, Loc%) - 1) + 0.6 * SanitHHGR(R%, Srvc%, Loc%))))\rEnd If\rSANITHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sSANITHHModelPlus(R%, Srvc%, Loc%) * (1 + CurGr)))\r'mti 2022/09/29 End\r'mti 2022/10/04 start\rElse\rIf SanitHHGR(R%, Srvc%, Loc%) <> -9999 Then\rSanitHHGR(R%, Srvc%, Loc%) = CSng(0.85 * SanitHHGR(R%, Srvc%, Loc%))  'smoother convergence of growth rate to zero\rSANITHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sSANITHHModelPlus(R%, Srvc%, Loc%) * (1 + SanitHHGR(R%, Srvc%, Loc%))))\rEnd If\r'mti 2022/10/04 End\rEnd If\r\r\r'mti 2022/09/12 start\r'mti 2022/09/21 start\rFor Loc% = 1 To 3           '2   '3\rFor Srvc% = 1 To 5\rSANITHHDEM(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\rSanitHHBF(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\r'mti 2022/09/27 start\rsSANITHHModel(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\r'mti 2022/09/27 end\r'mti 2022/09/29 start\rsSANITHHModelPlus(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\r'mti 2022/09/29 end\r\r'mti 2022/10/27 Start\rsSanitHHBF(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\r'mti 2022/10/27 End\r\rNext Srvc%\rNext Loc%\r\r\r'mti 2022/09/21 end\r'Apply scenario paprameter - multiplier base 1   'Note - mutiplier on national will be implemented as same multiplier on rural and urban,\r'mti 2022/09/06 start\r'SANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) * If(sanithhm(R%, Srvc%, National) <> 1, sanithhm(R%, Srvc%, National), sanithhm(R%, Srvc%, Loc%))\r'mti 2022/09/06 End\r'mti 2022/09/27 start\r'If RegName(R%) = \"Mexico\" Then Stop\rDim SANITHH_Model = SANITHH(R%, Srvc%, Loc%)\r\rDim CurGr As Single\rIf (SanitHHGR(R%, Srvc%, Loc%) <> -9999) And sSANITHHModel(R%, Srvc%, Loc%) <> 0 Then\r'China use sSANITHHModelPlus(R%, Srvc%, Loc%) instead\r'mti 2022/10/04 start\r'This is growth rate branch; MA_FCT is weight for smoothed convergence\r'CurGrowth = ConvergeOverTime(CurGrowth, SanitHHGR(R%, Srvc%, Loc%), 10)\r'mti 2022/10/04 end\rDim MA_Fct = 0.1\r'mti 2022/10/04 start\r'if SANITHH_Model = 0; it would give large negative growth rates;\r'may be hold SanitHHGR(R%, Srvc%, Loc%) same at that point, especially if it is negative (it would be negtaive, as it is coming down)\r'mti 2022/10/04 end\r\rIf COVIDShk_WS = 0 Then\rCurGr = CSng(AMAX(-0.1, Amin(0.1, MA_Fct * (SANITHH_Model / sSANITHHModel(R%, Srvc%, Loc%) - 1) + (1 - MA_Fct) * SanitHHGR(R%, Srvc%, Loc%))))\rSanitHHGR(R%, Srvc%, Loc%) = CurGr\rElse\rCurGr = CSng(AMAX(-0.1, Amin(0.1, 0.4 * (SANITHH_Model / sSANITHHModel(R%, Srvc%, Loc%) - 1) + 0.6 * SanitHHGR(R%, Srvc%, Loc%))))\rEnd If\rSANITHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sSANITHHModelPlus(R%, Srvc%, Loc%) * (1 + CurGr)))\r'mti 2022/09/29 End\r'mti 2022/10/04 start\rElse\rIf SanitHHGR(R%, Srvc%, Loc%) <> -9999 Then\rSanitHHGR(R%, Srvc%, Loc%) = CSng(0.85 * SanitHHGR(R%, Srvc%, Loc%))  'smoother convergence of growth rate to zero\rSANITHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sSANITHHModelPlus(R%, Srvc%, Loc%) * (1 + SanitHHGR(R%, Srvc%, Loc%))))\rEnd If\r'mti 2022/10/04 End\rEnd If\r\rDim CurGr As Single\rIf (SanitHHGR(R%, Srvc%, Loc%) <> -9999) And sSANITHHModel(R%, Srvc%, Loc%) <> 0 Then\r'China use sSANITHHModelPlus(R%, Srvc%, Loc%) instead\r'mti 2022/10/04 start\r'This is growth rate branch; MA_FCT is weight for smoothed convergence\r'CurGrowth = ConvergeOverTime(CurGrowth, SanitHHGR(R%, Srvc%, Loc%), 10)\r'mti 2022/10/04 end\rDim MA_Fct = 0.1\r'mti 2022/10/04 start\r'if SANITHH_Model = 0; it would give large negative growth rates;\r'may be hold SanitHHGR(R%, Srvc%, Loc%) same at that point, especially if it is negative (it would be negtaive, as it is coming down)\r'mti 2022/10/04 end\r\rIf COVIDShk_WS = 0 Then\rCurGr = CSng(AMAX(-0.1, Amin(0.1, MA_Fct * (SANITHH_Model / sSANITHHModel(R%, Srvc%, Loc%) - 1) + (1 - MA_Fct) * SanitHHGR(R%, Srvc%, Loc%))))\rSanitHHGR(R%, Srvc%, Loc%) = CurGr\rElse\rCurGr = CSng(AMAX(-0.1, Amin(0.1, 0.4 * (SANITHH_Model / sSANITHHModel(R%, Srvc%, Loc%) - 1) + 0.6 * SanitHHGR(R%, Srvc%, Loc%))))\rEnd If\rSANITHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sSANITHHModelPlus(R%, Srvc%, Loc%) * (1 + CurGr)))\r'mti 2022/09/29 End\r'mti 2022/10/04 start\rElse\rIf SanitHHGR(R%, Srvc%, Loc%) <> -9999 Then\rSanitHHGR(R%, Srvc%, Loc%) = CSng(0.85 * SanitHHGR(R%, Srvc%, Loc%))  'smoother convergence of growth rate to zero\rSANITHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sSANITHHModelPlus(R%, Srvc%, Loc%) * (1 + SanitHHGR(R%, Srvc%, Loc%))))\rEnd If\r'mti 2022/10/04 End\rEnd If\r\rDim CurGr As Single\rIf (SanitHHGR(R%, Srvc%, Loc%) <> -9999) And sSANITHHModel(R%, Srvc%, Loc%) <> 0 Then\r'China use sSANITHHModelPlus(R%, Srvc%, Loc%) instead\r'mti 2022/10/04 start\r'This is growth rate branch; MA_FCT is weight for smoothed convergence\r'CurGrowth = ConvergeOverTime(CurGrowth, SanitHHGR(R%, Srvc%, Loc%), 10)\r'mti 2022/10/04 end\rDim MA_Fct = 0.1\r'mti 2022/10/04 start\r'if SANITHH_Model = 0; it would give large negative growth rates;\r'may be hold SanitHHGR(R%, Srvc%, Loc%) same at that point, especially if it is negative (it would be negtaive, as it is coming down)\r'mti 2022/10/04 end\r\rIf COVIDShk_WS = 0 Then\rCurGr = CSng(AMAX(-0.1, Amin(0.1, MA_Fct * (SANITHH_Model / sSANITHHModel(R%, Srvc%, Loc%) - 1) + (1 - MA_Fct) * SanitHHGR(R%, Srvc%, Loc%))))\rSanitHHGR(R%, Srvc%, Loc%) = CurGr\rElse\rCurGr = CSng(AMAX(-0.1, Amin(0.1, 0.4 * (SANITHH_Model / sSANITHHModel(R%, Srvc%, Loc%) - 1) + 0.6 * SanitHHGR(R%, Srvc%, Loc%))))\rEnd If\rSANITHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sSANITHHModelPlus(R%, Srvc%, Loc%) * (1 + CurGr)))\r'mti 2022/09/29 End\r'mti 2022/10/04 start\rElse\rIf SanitHHGR(R%, Srvc%, Loc%) <> -9999 Then\rSanitHHGR(R%, Srvc%, Loc%) = CSng(0.85 * SanitHHGR(R%, Srvc%, Loc%))  'smoother convergence of growth rate to zero\rSANITHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sSANITHHModelPlus(R%, Srvc%, Loc%) * (1 + SanitHHGR(R%, Srvc%, Loc%))))\rEnd If\r'mti 2022/10/04 End\rEnd If\r\rDim CurGr As Single\rIf (SanitHHGR(R%, Srvc%, Loc%) <> -9999) And sSANITHHModel(R%, Srvc%, Loc%) <> 0 Then\r'China use sSANITHHModelPlus(R%, Srvc%, Loc%) instead\r'mti 2022/10/04 start\r'This is growth rate branch; MA_FCT is weight for smoothed convergence\r'CurGrowth = ConvergeOverTime(CurGrowth, SanitHHGR(R%, Srvc%, Loc%), 10)\r'mti 2022/10/04 end\rDim MA_Fct = 0.1\r'mti 2022/10/04 start\r'if SANITHH_Model = 0; it would give large negative growth rates;\r'may be hold SanitHHGR(R%, Srvc%, Loc%) same at that point, especially if it is negative (it would be negtaive, as it is coming down)\r'mti 2022/10/04 end\r\rIf COVIDShk_WS = 0 Then\rCurGr = CSng(AMAX(-0.1, Amin(0.1, MA_Fct * (SANITHH_Model / sSANITHHModel(R%, Srvc%, Loc%) - 1) + (1 - MA_Fct) * SanitHHGR(R%, Srvc%, Loc%))))\rSanitHHGR(R%, Srvc%, Loc%) = CurGr\rElse\rCurGr = CSng(AMAX(-0.1, Amin(0.1, 0.4 * (SANITHH_Model / sSANITHHModel(R%, Srvc%, Loc%) - 1) + 0.6 * SanitHHGR(R%, Srvc%, Loc%))))\rEnd If\rSANITHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sSANITHHModelPlus(R%, Srvc%, Loc%) * (1 + CurGr)))\r'mti 2022/09/29 End\r'mti 2022/10/04 start\rElse\rIf SanitHHGR(R%, Srvc%, Loc%) <> -9999 Then\rSanitHHGR(R%, Srvc%, Loc%) = CSng(0.85 * SanitHHGR(R%, Srvc%, Loc%))  'smoother convergence of growth rate to zero\rSANITHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sSANITHHModelPlus(R%, Srvc%, Loc%) * (1 + SanitHHGR(R%, Srvc%, Loc%))))\rEnd If\r'mti 2022/10/04 End\rEnd If\r\r\r'mti 2022/09/12 start\r'mti 2022/09/21 start\rFor Loc% = 1 To 3           '2   '3\rFor Srvc% = 1 To 5\rSANITHHDEM(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\rSanitHHBF(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\r'mti 2022/09/27 start\rsSANITHHModel(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\r'mti 2022/09/27 end\r'mti 2022/09/29 start\rsSANITHHModelPlus(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\r'mti 2022/09/29 end\r\r'mti 2022/10/27 Start\rsSanitHHBF(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\r'mti 2022/10/27 End\r\rNext Srvc%\rNext Loc%\r\rDim CurGr As Single\rIf (SanitHHGR(R%, Srvc%, Loc%) <> -9999) And sSANITHHModel(R%, Srvc%, Loc%) <> 0 Then\r'China use sSANITHHModelPlus(R%, Srvc%, Loc%) instead\r'mti 2022/10/04 start\r'This is growth rate branch; MA_FCT is weight for smoothed convergence\r'CurGrowth = ConvergeOverTime(CurGrowth, SanitHHGR(R%, Srvc%, Loc%), 10)\r'mti 2022/10/04 end\rDim MA_Fct = 0.1\r'mti 2022/10/04 start\r'if SANITHH_Model = 0; it would give large negative growth rates;\r'may be hold SanitHHGR(R%, Srvc%, Loc%) same at that point, especially if it is negative (it would be negtaive, as it is coming down)\r'mti 2022/10/04 end\r\rIf COVIDShk_WS = 0 Then\rCurGr = CSng(AMAX(-0.1, Amin(0.1, MA_Fct * (SANITHH_Model / sSANITHHModel(R%, Srvc%, Loc%) - 1) + (1 - MA_Fct) * SanitHHGR(R%, Srvc%, Loc%))))\rSanitHHGR(R%, Srvc%, Loc%) = CurGr\rElse\rCurGr = CSng(AMAX(-0.1, Amin(0.1, 0.4 * (SANITHH_Model / sSANITHHModel(R%, Srvc%, Loc%) - 1) + 0.6 * SanitHHGR(R%, Srvc%, Loc%))))\rEnd If\rSANITHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sSANITHHModelPlus(R%, Srvc%, Loc%) * (1 + CurGr)))\r'mti 2022/09/29 End\r'mti 2022/10/04 start\rElse\rIf SanitHHGR(R%, Srvc%, Loc%) <> -9999 Then\rSanitHHGR(R%, Srvc%, Loc%) = CSng(0.85 * SanitHHGR(R%, Srvc%, Loc%))  'smoother convergence of growth rate to zero\rSANITHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sSANITHHModelPlus(R%, Srvc%, Loc%) * (1 + SanitHHGR(R%, Srvc%, Loc%))))\rEnd If\r'mti 2022/10/04 End\rEnd If\r\r\rDim SumSanitHH As Single = 0\r\r'mti 2022/09/29 end\r'mti 2022/09/29 start\rSumSanitHH = SumSanitHH + SANITHH(R%, Srvc%, Loc%)\r\rNext\r'mti 2022/09/27 start\rFor Srvc% = 1 To 5\r'normalize to 100%\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) / AMAX(0.0001, SumSanitHH) * 100\r\r\r'mti 2022/09/12 start\r'mti 2022/09/21 start\rFor Loc% = 1 To 3           '2   '3\rFor Srvc% = 1 To 5\rSANITHHDEM(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\rSanitHHBF(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\r'mti 2022/09/27 start\rsSANITHHModel(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\r'mti 2022/09/27 end\r'mti 2022/09/29 start\rsSANITHHModelPlus(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\r'mti 2022/09/29 end\r\r'mti 2022/10/27 Start\rsSanitHHBF(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%)\r'mti 2022/10/27 End\r\rNext Srvc%\rNext Loc%\r\rNext\r'mti 2022/09/27 end\r'mti 2022/09/29 End\r\r'Base forecast growth not more than 5 ppt of base forecast of previous yesr; decline not more than 2% (based on growth rate data    'mti 2022/10/04 comment update\r'mti 2022/09/21 Start\rSANITHH(R%, SafelyManaged, Loc%) = AMAX(SanitHHBF(R%, SafelyManaged, Loc%) - 2, Amin(SanitHHBF(R%, SafelyManaged, Loc%) + 5, SANITHH(R%, SafelyManaged, Loc%)))\r\rDim SumSANITHH4 As Single = 0\r\rDim SumSanitHH4Req = 100 - SANITHH(R%, SafelyManaged, Loc%)\r\rFor Srvc% = 1 To 4\rSumSANITHH4 = SumSANITHH4 + SANITHH(R%, Srvc%, Loc%)\r\rNext\rFor Srvc% = 1 To 4\r'mti 2022/09/26 start\r'SANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) / AMAX(0.0001, SumSanitHH4) * SumSanitHH4Req\rIf SumSANITHH4 > 0 Then\r'normalize\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) / SumSANITHH4 * SumSanitHH4Req\rElseIf SumSanitHH4Req > 0 Then\r'all (lower) 4 cat are 0; but safelymnaged not 0\rSANITHH(R%, Srvc%, Loc%) = SumSanitHH4Req / 4\rEnd If\r\rDim SumSanitHH4Req = 100 - SANITHH(R%, SafelyManaged, Loc%)\r\rNext\rFor Srvc% = 1 To 4\r'mti 2022/09/26 start\r'SANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) / AMAX(0.0001, SumSanitHH4) * SumSanitHH4Req\rIf SumSANITHH4 > 0 Then\r'normalize\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) / SumSANITHH4 * SumSanitHH4Req\rElseIf SumSanitHH4Req > 0 Then\r'all (lower) 4 cat are 0; but safelymnaged not 0\rSANITHH(R%, Srvc%, Loc%) = SumSanitHH4Req / 4\rEnd If\r"
  },
  {
    "Variable": "SANITHHDEM",
    "UsesVariable": "POPURBAN",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "SANITHHDEM",
    "UsesVariable": "SANITHH",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SANITHHDEMPOP",
    "UsesVariable": "SANITHHDEM",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SANITHHDEMPOP",
    "UsesVariable": "POPURBAN",
    "Distance": 0,
    "Code": "\rSANITHHDEMPOP(R%, Srvc%, Urban) = SANITHHDEM(R%, Srvc%, Urban) * POPURBAN(R%) / 100\r"
  },
  {
    "Variable": "SANITHHDEMPOP",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r\rSANITHHDEMPOP(R%, Srvc%, National) = SANITHHDEM(R%, Srvc%, National) * POP(R%) / 100\r"
  },
  {
    "Variable": "SANITHHPOP",
    "UsesVariable": "SANITHH",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SANITHHPOP",
    "UsesVariable": "POPURBAN",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "SANITHHPOP",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r\rSANITHHPOP(R%, Srvc%, National) = SANITHH(R%, Srvc%, National) * POP(R%) / 100\r"
  },
  {
    "Variable": "SAVINGS",
    "UsesVariable": "HHSAV",
    "Distance": 0,
    "Code": "\r\r'bbh 2021/07/07 start  Moved these here from locations where FORSAV and FORSAVRPA not calculated yet;\r'   Also useful to have all savings logic in one place\r'     All Steps:  Foreign and Total Savings\r'     -------------------------\r\rFor R% = 1 To NR%\r'bbh 2022/09/05 Subtracted XWORKREMIT from FORSAVRPA and FORSAV; had been commented out but should be in computation\rFORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) - XWORKREMIT(R%)   'Price adjusted compatible with XDEBTRPA\r'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'FORSAV(R%) = M(R%) - X(R%) - AID(R%) '- XWORKEMIT(R%)\rFORSAV(R%) = M(R%) - X(R%) - AID(R%) - XWORKREMIT(R%) 'bbh 2022/12/13 remittances belong here, had been changed in 7.91 but change was not commented\rFor S% = 1 To NSec% 'bbh 2022/12/13 For-Next added as also with CURACT logic given SMTariffRev inclusion in GOVREV\rFORSAV(R%) = FORSAV(R%) - SMTariffRev(R%, S%)\rFORSAVRPA(R%) = FORSAVRPA(R%) - SMTariffRev(R%, S%)\rNext S%\rSAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\rSAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'            If RegName$(R%) = \"Ethiopia\" Then Stop\rNext R%\r"
  },
  {
    "Variable": "SAVINGS",
    "UsesVariable": "FIRMSAV",
    "Distance": 0,
    "Code": "\r\r'bbh 2021/07/07 start  Moved these here from locations where FORSAV and FORSAVRPA not calculated yet;\r'   Also useful to have all savings logic in one place\r'     All Steps:  Foreign and Total Savings\r'     -------------------------\r\rFor R% = 1 To NR%\r'bbh 2022/09/05 Subtracted XWORKREMIT from FORSAVRPA and FORSAV; had been commented out but should be in computation\rFORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) - XWORKREMIT(R%)   'Price adjusted compatible with XDEBTRPA\r'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'FORSAV(R%) = M(R%) - X(R%) - AID(R%) '- XWORKEMIT(R%)\rFORSAV(R%) = M(R%) - X(R%) - AID(R%) - XWORKREMIT(R%) 'bbh 2022/12/13 remittances belong here, had been changed in 7.91 but change was not commented\rFor S% = 1 To NSec% 'bbh 2022/12/13 For-Next added as also with CURACT logic given SMTariffRev inclusion in GOVREV\rFORSAV(R%) = FORSAV(R%) - SMTariffRev(R%, S%)\rFORSAVRPA(R%) = FORSAVRPA(R%) - SMTariffRev(R%, S%)\rNext S%\rSAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\rSAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'            If RegName$(R%) = \"Ethiopia\" Then Stop\rNext R%\r"
  },
  {
    "Variable": "SAVINGS",
    "UsesVariable": "GOVBAL",
    "Distance": 0,
    "Code": "\r\r'bbh 2021/07/07 start  Moved these here from locations where FORSAV and FORSAVRPA not calculated yet;\r'   Also useful to have all savings logic in one place\r'     All Steps:  Foreign and Total Savings\r'     -------------------------\r\rFor R% = 1 To NR%\r'bbh 2022/09/05 Subtracted XWORKREMIT from FORSAVRPA and FORSAV; had been commented out but should be in computation\rFORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) - XWORKREMIT(R%)   'Price adjusted compatible with XDEBTRPA\r'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'FORSAV(R%) = M(R%) - X(R%) - AID(R%) '- XWORKEMIT(R%)\rFORSAV(R%) = M(R%) - X(R%) - AID(R%) - XWORKREMIT(R%) 'bbh 2022/12/13 remittances belong here, had been changed in 7.91 but change was not commented\rFor S% = 1 To NSec% 'bbh 2022/12/13 For-Next added as also with CURACT logic given SMTariffRev inclusion in GOVREV\rFORSAV(R%) = FORSAV(R%) - SMTariffRev(R%, S%)\rFORSAVRPA(R%) = FORSAVRPA(R%) - SMTariffRev(R%, S%)\rNext S%\rSAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\rSAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'            If RegName$(R%) = \"Ethiopia\" Then Stop\rNext R%\r"
  },
  {
    "Variable": "SAVINGS",
    "UsesVariable": "FORSAV",
    "Distance": 0,
    "Code": "\r\r'bbh 2021/07/07 start  Moved these here from locations where FORSAV and FORSAVRPA not calculated yet;\r'   Also useful to have all savings logic in one place\r'     All Steps:  Foreign and Total Savings\r'     -------------------------\r\rFor R% = 1 To NR%\r'bbh 2022/09/05 Subtracted XWORKREMIT from FORSAVRPA and FORSAV; had been commented out but should be in computation\rFORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) - XWORKREMIT(R%)   'Price adjusted compatible with XDEBTRPA\r'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'FORSAV(R%) = M(R%) - X(R%) - AID(R%) '- XWORKEMIT(R%)\rFORSAV(R%) = M(R%) - X(R%) - AID(R%) - XWORKREMIT(R%) 'bbh 2022/12/13 remittances belong here, had been changed in 7.91 but change was not commented\rFor S% = 1 To NSec% 'bbh 2022/12/13 For-Next added as also with CURACT logic given SMTariffRev inclusion in GOVREV\rFORSAV(R%) = FORSAV(R%) - SMTariffRev(R%, S%)\rFORSAVRPA(R%) = FORSAVRPA(R%) - SMTariffRev(R%, S%)\rNext S%\rSAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\rSAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'            If RegName$(R%) = \"Ethiopia\" Then Stop\rNext R%\r"
  },
  {
    "Variable": "SAVINGSRPA",
    "UsesVariable": "HHSAV",
    "Distance": 0,
    "Code": "\r\r'bbh 2021/07/07 start  Moved these here from locations where FORSAV and FORSAVRPA not calculated yet;\r'   Also useful to have all savings logic in one place\r'     All Steps:  Foreign and Total Savings\r'     -------------------------\r\rFor R% = 1 To NR%\r'bbh 2022/09/05 Subtracted XWORKREMIT from FORSAVRPA and FORSAV; had been commented out but should be in computation\rFORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) - XWORKREMIT(R%)   'Price adjusted compatible with XDEBTRPA\r'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'FORSAV(R%) = M(R%) - X(R%) - AID(R%) '- XWORKEMIT(R%)\rFORSAV(R%) = M(R%) - X(R%) - AID(R%) - XWORKREMIT(R%) 'bbh 2022/12/13 remittances belong here, had been changed in 7.91 but change was not commented\rFor S% = 1 To NSec% 'bbh 2022/12/13 For-Next added as also with CURACT logic given SMTariffRev inclusion in GOVREV\rFORSAV(R%) = FORSAV(R%) - SMTariffRev(R%, S%)\rFORSAVRPA(R%) = FORSAVRPA(R%) - SMTariffRev(R%, S%)\rNext S%\rSAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\rSAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'            If RegName$(R%) = \"Ethiopia\" Then Stop\rNext R%\r\r'bbh 2021/07/07 end\r\r"
  },
  {
    "Variable": "SAVINGSRPA",
    "UsesVariable": "FIRMSAV",
    "Distance": 0,
    "Code": "\r\r'bbh 2021/07/07 start  Moved these here from locations where FORSAV and FORSAVRPA not calculated yet;\r'   Also useful to have all savings logic in one place\r'     All Steps:  Foreign and Total Savings\r'     -------------------------\r\rFor R% = 1 To NR%\r'bbh 2022/09/05 Subtracted XWORKREMIT from FORSAVRPA and FORSAV; had been commented out but should be in computation\rFORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) - XWORKREMIT(R%)   'Price adjusted compatible with XDEBTRPA\r'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'FORSAV(R%) = M(R%) - X(R%) - AID(R%) '- XWORKEMIT(R%)\rFORSAV(R%) = M(R%) - X(R%) - AID(R%) - XWORKREMIT(R%) 'bbh 2022/12/13 remittances belong here, had been changed in 7.91 but change was not commented\rFor S% = 1 To NSec% 'bbh 2022/12/13 For-Next added as also with CURACT logic given SMTariffRev inclusion in GOVREV\rFORSAV(R%) = FORSAV(R%) - SMTariffRev(R%, S%)\rFORSAVRPA(R%) = FORSAVRPA(R%) - SMTariffRev(R%, S%)\rNext S%\rSAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\rSAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'            If RegName$(R%) = \"Ethiopia\" Then Stop\rNext R%\r\r'bbh 2021/07/07 end\r\r"
  },
  {
    "Variable": "SAVINGSRPA",
    "UsesVariable": "GOVBAL",
    "Distance": 0,
    "Code": "\r\r'bbh 2021/07/07 start  Moved these here from locations where FORSAV and FORSAVRPA not calculated yet;\r'   Also useful to have all savings logic in one place\r'     All Steps:  Foreign and Total Savings\r'     -------------------------\r\rFor R% = 1 To NR%\r'bbh 2022/09/05 Subtracted XWORKREMIT from FORSAVRPA and FORSAV; had been commented out but should be in computation\rFORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) - XWORKREMIT(R%)   'Price adjusted compatible with XDEBTRPA\r'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'FORSAV(R%) = M(R%) - X(R%) - AID(R%) '- XWORKEMIT(R%)\rFORSAV(R%) = M(R%) - X(R%) - AID(R%) - XWORKREMIT(R%) 'bbh 2022/12/13 remittances belong here, had been changed in 7.91 but change was not commented\rFor S% = 1 To NSec% 'bbh 2022/12/13 For-Next added as also with CURACT logic given SMTariffRev inclusion in GOVREV\rFORSAV(R%) = FORSAV(R%) - SMTariffRev(R%, S%)\rFORSAVRPA(R%) = FORSAVRPA(R%) - SMTariffRev(R%, S%)\rNext S%\rSAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\rSAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'            If RegName$(R%) = \"Ethiopia\" Then Stop\rNext R%\r\r'bbh 2021/07/07 end\r\r"
  },
  {
    "Variable": "SAVINGSRPA",
    "UsesVariable": "FORSAVRPA",
    "Distance": 0,
    "Code": "\r\r'bbh 2021/07/07 start  Moved these here from locations where FORSAV and FORSAVRPA not calculated yet;\r'   Also useful to have all savings logic in one place\r'     All Steps:  Foreign and Total Savings\r'     -------------------------\r\rFor R% = 1 To NR%\r'bbh 2022/09/05 Subtracted XWORKREMIT from FORSAVRPA and FORSAV; had been commented out but should be in computation\rFORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) - XWORKREMIT(R%)   'Price adjusted compatible with XDEBTRPA\r'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'FORSAV(R%) = M(R%) - X(R%) - AID(R%) '- XWORKEMIT(R%)\rFORSAV(R%) = M(R%) - X(R%) - AID(R%) - XWORKREMIT(R%) 'bbh 2022/12/13 remittances belong here, had been changed in 7.91 but change was not commented\rFor S% = 1 To NSec% 'bbh 2022/12/13 For-Next added as also with CURACT logic given SMTariffRev inclusion in GOVREV\rFORSAV(R%) = FORSAV(R%) - SMTariffRev(R%, S%)\rFORSAVRPA(R%) = FORSAVRPA(R%) - SMTariffRev(R%, S%)\rNext S%\rSAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\rSAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'            If RegName$(R%) = \"Ethiopia\" Then Stop\rNext R%\r\r'bbh 2021/07/07 end\r\r"
  },
  {
    "Variable": "SDEATH",
    "UsesVariable": "POP",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "SDEATH",
    "UsesVariable": "CLNEED",
    "Distance": 23,
    "Code": "0"
  },
  {
    "Variable": "SDEATH",
    "UsesVariable": "clsexp",
    "Distance": 23,
    "Code": "0"
  },
  {
    "Variable": "SDEATH",
    "UsesVariable": "CLAVAL",
    "Distance": 26,
    "Code": "0"
  },
  {
    "Variable": "SDEATH",
    "UsesVariable": "agon",
    "Distance": 26,
    "Code": "0"
  },
  {
    "Variable": "SFCIVILWARUCDP",
    "UsesVariable": "sfintlwaradd",
    "Distance": 0,
    "Code": "\r'Otherwise calculation below will introduce run to run\r\rFor R% = 1 To NR%\r'bbh 2011/06/18 begin\r'        contiguityadd = 0\r'        For ICount% = 1 To NR%\r'            If contiguity(R%, ICount%) <= 3 Then  '1= land contiguity; 2 = 0-12 miles; 3 = 12-24 miles\r'                If SFINTLWARALL(ICount%) >= 0.2 Then  'Enough risk next door to add to yours\r'                    contiguityadd = contiguityadd + 0.1\r'                End If\r'            End If\r'        Next ICount%\r'        contiguityadd = Amin(0.4, contiguityadd)\r'        If contiguityadd > 0 And GDPPCP(R%) > 10 Then 'phase down Contiguity impact as approach GDPPCP of $15K\r'            contiguityadd = contiguityadd * AMAX(0, (15 - GDPPCP(R%)) / 5)\r\r'        SFINTLWARALL(R%) = Amin(1, SFINTLWARALL(R%) + contiguityadd)\r'        End If\r'If RegName$(R%) = \"Azerbaijan\" Then Stop\r'If GRPS(1, R%) = \"Nigeria\" And FirstYear + IY - 1 >= 2056 Then Stop\rSFINTLWARALL(R%) = AMAX(0, Amin(1, SFINTLWARALL(R%) + ContiguityIntlWarAdd(R%) - ContiguityIntlWarAddI(R%)))\r'bbh 2011/06/18 begin\r'If RegName(R%) = \"Kazakhstan\" Then Stop\r'jrs 2024/05/20\rIf sfcivilwarucdpsw = 0 Then\r'bbh 2011/10/5\rIf sfmassrep(R%) >= 0.01 Then SFINTLWARALL(R%) = SFINTLWARALL(R%) * sfmassrep(R%)\r'If sfmassrep(R%) > 0.5 Then SFINTLWARALL(R%) = SFINTLWARALL(R%) * 0.1\rSFINTLWARALL(R%) = AMAX(0, Amin(1, SFINTLWARALL(R%) + sfintlwaradd(R%)))\rElse\rIf sfmassrep(R%) >= 0.01 Then SFCIVILWARUCDP(R%) = SFCIVILWARUCDP(R%) * sfmassrep(R%)\r\rSFCIVILWARUCDP(R%) = AMAX(0, Amin(1, SFCIVILWARUCDP(R%) + sfintlwaradd(R%)))\rEnd If\r'BBH 2011/04/02 end\r'If IY% > 40 And RegName$(R%) = \"Iran\" Then Stop\r\r'jrs 2021/08/04 Exogenous Models\rIf ifsexomodelid > 0 Then\rDim old As Single\rold = SFINTLWARALL(R%)\rReplaceVarWithExogenousForecastxReg(\"SFINTLWARALL\", \"\", \"\", CStr(FirstYear + IY - 1), R%, context)\r'if there's a change update saved variable\rIf old <> SFINTLWARALL(R%) Then\rssfintlwarallLoc(R%) = AMAX(0, Amin(1, SFINTLWARALL(R%) + sfintlwaradd(R%)))\rEnd If\r'jrs 2024/05/20\rReplaceVarWithExogenousForecastxReg(\"SFCIVILWARUCDP\", \"\", \"\", CStr(FirstYear + IY - 1), R%, context)\rEnd If\r\r'       bbh 2011/09/21 Tie change in magnitude to change in probability instead of simple, separate function\r'        Call AnalFunc(\"State Failure from Internal War, magnitude\", _\r'            Array(GDPPCP(R%), democterm, infmorterm, TradeTerm, educ15term), prediction)\r'        prediction = AMAX(0.001, prediction)\r'        historybased = AMAX(0.0001, Amin(5, SFINTLWARMAGRI(R%) * prediction))\r'        If sfusehist < 0.5 Then\r'            SFINTLWARMAG(R%) = AMAX(0.0001, Amin(1, prediction))\r'        ElseIf sfusehist > 1.5 Then\r'            SFINTLWARMAG(R%) = ConvergeOverTime(historybased, prediction, sfconv)\r'                'Base, Target, Years\r'        Else\r'            SFINTLWARMAG(R%) = historybased\r'        End If\r'SFINTLWARMAG(R%) = SFINTLWARMAGI(R%) * Amin(3, SFINTLWARALL(R%) / SFINTLWARALLI(R%))\rSFINTLWARMAG(R%) = SFINTLWARMAGI(R%) * Amin(3, SFINTLWARALL(R%) / SFINTLWARALLI(R%)) * sfintlwarmagm(R%) 'dkb 2019/01/22 - adding multiplier on internal war magnitude\r'jrs 2016/01/13\rSSFINTLWARMAG(R%) = SFINTLWARMAG(R%)\r\r\r'   All but First 2:  Save Education Years for Govt Effectiveness\r'   -------------------------------------------------------------\r\rsedyrsag15(R%) = EDYRSAG15(R%, 3)\r'bbh 2011/08/19\rsedyrsag15fem(R%) = EDYRSAG15(R%, 2)\r\r\r\rNext R%\r"
  },
  {
    "Variable": "SFCIVILWARUCDP",
    "UsesVariable": "sfcivilwarucdpsw",
    "Distance": 0,
    "Code": "\r'Otherwise calculation below will introduce run to run\r\rFor R% = 1 To NR%\r'bbh 2011/06/18 begin\r'        contiguityadd = 0\r'        For ICount% = 1 To NR%\r'            If contiguity(R%, ICount%) <= 3 Then  '1= land contiguity; 2 = 0-12 miles; 3 = 12-24 miles\r'                If SFINTLWARALL(ICount%) >= 0.2 Then  'Enough risk next door to add to yours\r'                    contiguityadd = contiguityadd + 0.1\r'                End If\r'            End If\r'        Next ICount%\r'        contiguityadd = Amin(0.4, contiguityadd)\r'        If contiguityadd > 0 And GDPPCP(R%) > 10 Then 'phase down Contiguity impact as approach GDPPCP of $15K\r'            contiguityadd = contiguityadd * AMAX(0, (15 - GDPPCP(R%)) / 5)\r\r'        SFINTLWARALL(R%) = Amin(1, SFINTLWARALL(R%) + contiguityadd)\r'        End If\r'If RegName$(R%) = \"Azerbaijan\" Then Stop\r'If GRPS(1, R%) = \"Nigeria\" And FirstYear + IY - 1 >= 2056 Then Stop\rSFINTLWARALL(R%) = AMAX(0, Amin(1, SFINTLWARALL(R%) + ContiguityIntlWarAdd(R%) - ContiguityIntlWarAddI(R%)))\r'bbh 2011/06/18 begin\r'If RegName(R%) = \"Kazakhstan\" Then Stop\r'jrs 2024/05/20\rIf sfcivilwarucdpsw = 0 Then\r'bbh 2011/10/5\rIf sfmassrep(R%) >= 0.01 Then SFINTLWARALL(R%) = SFINTLWARALL(R%) * sfmassrep(R%)\r'If sfmassrep(R%) > 0.5 Then SFINTLWARALL(R%) = SFINTLWARALL(R%) * 0.1\rSFINTLWARALL(R%) = AMAX(0, Amin(1, SFINTLWARALL(R%) + sfintlwaradd(R%)))\rElse\rIf sfmassrep(R%) >= 0.01 Then SFCIVILWARUCDP(R%) = SFCIVILWARUCDP(R%) * sfmassrep(R%)\r\rSFCIVILWARUCDP(R%) = AMAX(0, Amin(1, SFCIVILWARUCDP(R%) + sfintlwaradd(R%)))\rEnd If\r'BBH 2011/04/02 end\r'If IY% > 40 And RegName$(R%) = \"Iran\" Then Stop\r\r'jrs 2021/08/04 Exogenous Models\rIf ifsexomodelid > 0 Then\rDim old As Single\rold = SFINTLWARALL(R%)\rReplaceVarWithExogenousForecastxReg(\"SFINTLWARALL\", \"\", \"\", CStr(FirstYear + IY - 1), R%, context)\r'if there's a change update saved variable\rIf old <> SFINTLWARALL(R%) Then\rssfintlwarallLoc(R%) = AMAX(0, Amin(1, SFINTLWARALL(R%) + sfintlwaradd(R%)))\rEnd If\r'jrs 2024/05/20\rReplaceVarWithExogenousForecastxReg(\"SFCIVILWARUCDP\", \"\", \"\", CStr(FirstYear + IY - 1), R%, context)\rEnd If\r\r'       bbh 2011/09/21 Tie change in magnitude to change in probability instead of simple, separate function\r'        Call AnalFunc(\"State Failure from Internal War, magnitude\", _\r'            Array(GDPPCP(R%), democterm, infmorterm, TradeTerm, educ15term), prediction)\r'        prediction = AMAX(0.001, prediction)\r'        historybased = AMAX(0.0001, Amin(5, SFINTLWARMAGRI(R%) * prediction))\r'        If sfusehist < 0.5 Then\r'            SFINTLWARMAG(R%) = AMAX(0.0001, Amin(1, prediction))\r'        ElseIf sfusehist > 1.5 Then\r'            SFINTLWARMAG(R%) = ConvergeOverTime(historybased, prediction, sfconv)\r'                'Base, Target, Years\r'        Else\r'            SFINTLWARMAG(R%) = historybased\r'        End If\r'SFINTLWARMAG(R%) = SFINTLWARMAGI(R%) * Amin(3, SFINTLWARALL(R%) / SFINTLWARALLI(R%))\rSFINTLWARMAG(R%) = SFINTLWARMAGI(R%) * Amin(3, SFINTLWARALL(R%) / SFINTLWARALLI(R%)) * sfintlwarmagm(R%) 'dkb 2019/01/22 - adding multiplier on internal war magnitude\r'jrs 2016/01/13\rSSFINTLWARMAG(R%) = SFINTLWARMAG(R%)\r\r\r'   All but First 2:  Save Education Years for Govt Effectiveness\r'   -------------------------------------------------------------\r\rsedyrsag15(R%) = EDYRSAG15(R%, 3)\r'bbh 2011/08/19\rsedyrsag15fem(R%) = EDYRSAG15(R%, 2)\r\r\r\rNext R%\r"
  },
  {
    "Variable": "SFCIVILWARUCDP",
    "UsesVariable": "sfmassrep",
    "Distance": 0,
    "Code": "\r'Otherwise calculation below will introduce run to run\r\rFor R% = 1 To NR%\r'bbh 2011/06/18 begin\r'        contiguityadd = 0\r'        For ICount% = 1 To NR%\r'            If contiguity(R%, ICount%) <= 3 Then  '1= land contiguity; 2 = 0-12 miles; 3 = 12-24 miles\r'                If SFINTLWARALL(ICount%) >= 0.2 Then  'Enough risk next door to add to yours\r'                    contiguityadd = contiguityadd + 0.1\r'                End If\r'            End If\r'        Next ICount%\r'        contiguityadd = Amin(0.4, contiguityadd)\r'        If contiguityadd > 0 And GDPPCP(R%) > 10 Then 'phase down Contiguity impact as approach GDPPCP of $15K\r'            contiguityadd = contiguityadd * AMAX(0, (15 - GDPPCP(R%)) / 5)\r\r'        SFINTLWARALL(R%) = Amin(1, SFINTLWARALL(R%) + contiguityadd)\r'        End If\r'If RegName$(R%) = \"Azerbaijan\" Then Stop\r'If GRPS(1, R%) = \"Nigeria\" And FirstYear + IY - 1 >= 2056 Then Stop\rSFINTLWARALL(R%) = AMAX(0, Amin(1, SFINTLWARALL(R%) + ContiguityIntlWarAdd(R%) - ContiguityIntlWarAddI(R%)))\r'bbh 2011/06/18 begin\r'If RegName(R%) = \"Kazakhstan\" Then Stop\r'jrs 2024/05/20\rIf sfcivilwarucdpsw = 0 Then\r'bbh 2011/10/5\rIf sfmassrep(R%) >= 0.01 Then SFINTLWARALL(R%) = SFINTLWARALL(R%) * sfmassrep(R%)\r'If sfmassrep(R%) > 0.5 Then SFINTLWARALL(R%) = SFINTLWARALL(R%) * 0.1\rSFINTLWARALL(R%) = AMAX(0, Amin(1, SFINTLWARALL(R%) + sfintlwaradd(R%)))\rElse\rIf sfmassrep(R%) >= 0.01 Then SFCIVILWARUCDP(R%) = SFCIVILWARUCDP(R%) * sfmassrep(R%)\r\rSFCIVILWARUCDP(R%) = AMAX(0, Amin(1, SFCIVILWARUCDP(R%) + sfintlwaradd(R%)))\rEnd If\r'BBH 2011/04/02 end\r'If IY% > 40 And RegName$(R%) = \"Iran\" Then Stop\r\r'jrs 2021/08/04 Exogenous Models\rIf ifsexomodelid > 0 Then\rDim old As Single\rold = SFINTLWARALL(R%)\rReplaceVarWithExogenousForecastxReg(\"SFINTLWARALL\", \"\", \"\", CStr(FirstYear + IY - 1), R%, context)\r'if there's a change update saved variable\rIf old <> SFINTLWARALL(R%) Then\rssfintlwarallLoc(R%) = AMAX(0, Amin(1, SFINTLWARALL(R%) + sfintlwaradd(R%)))\rEnd If\r'jrs 2024/05/20\rReplaceVarWithExogenousForecastxReg(\"SFCIVILWARUCDP\", \"\", \"\", CStr(FirstYear + IY - 1), R%, context)\rEnd If\r\r'       bbh 2011/09/21 Tie change in magnitude to change in probability instead of simple, separate function\r'        Call AnalFunc(\"State Failure from Internal War, magnitude\", _\r'            Array(GDPPCP(R%), democterm, infmorterm, TradeTerm, educ15term), prediction)\r'        prediction = AMAX(0.001, prediction)\r'        historybased = AMAX(0.0001, Amin(5, SFINTLWARMAGRI(R%) * prediction))\r'        If sfusehist < 0.5 Then\r'            SFINTLWARMAG(R%) = AMAX(0.0001, Amin(1, prediction))\r'        ElseIf sfusehist > 1.5 Then\r'            SFINTLWARMAG(R%) = ConvergeOverTime(historybased, prediction, sfconv)\r'                'Base, Target, Years\r'        Else\r'            SFINTLWARMAG(R%) = historybased\r'        End If\r'SFINTLWARMAG(R%) = SFINTLWARMAGI(R%) * Amin(3, SFINTLWARALL(R%) / SFINTLWARALLI(R%))\rSFINTLWARMAG(R%) = SFINTLWARMAGI(R%) * Amin(3, SFINTLWARALL(R%) / SFINTLWARALLI(R%)) * sfintlwarmagm(R%) 'dkb 2019/01/22 - adding multiplier on internal war magnitude\r'jrs 2016/01/13\rSSFINTLWARMAG(R%) = SFINTLWARMAG(R%)\r\r\r'   All but First 2:  Save Education Years for Govt Effectiveness\r'   -------------------------------------------------------------\r\rsedyrsag15(R%) = EDYRSAG15(R%, 3)\r'bbh 2011/08/19\rsedyrsag15fem(R%) = EDYRSAG15(R%, 2)\r\r\r\rNext R%\r"
  },
  {
    "Variable": "SFCIVILWARUCDP",
    "UsesVariable": "INFMOR",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "SFCIVILWARUCDP",
    "UsesVariable": "YTHBULGE",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "SFCIVILWARUCDP",
    "UsesVariable": "GDPR",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "SFCIVILWARUCDP",
    "UsesVariable": "DEMOCPOLYARCHY",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "SFCIVILWARUCDP",
    "UsesVariable": "X",
    "Distance": 30,
    "Code": "0"
  },
  {
    "Variable": "SFCIVILWARUCDP",
    "UsesVariable": "M",
    "Distance": 30,
    "Code": "0"
  },
  {
    "Variable": "SFCIVILWARUCDP",
    "UsesVariable": "GDP",
    "Distance": 30,
    "Code": "0"
  },
  {
    "Variable": "SFCIVILWARUCDP",
    "UsesVariable": "GDPPCP",
    "Distance": 704,
    "Code": "0"
  },
  {
    "Variable": "SFCIVILWARUCDP",
    "UsesVariable": "SFINTLWARALL",
    "Distance": 706,
    "Code": "0"
  },
  {
    "Variable": "SFDEM",
    "UsesVariable": "INFMOR",
    "Distance": 1,
    "Code": "COMPLETE STRUCTURE:Next R:1565|\r\rFor R = 1 To NR\r'Call AnalFunc(\"State Failure Probability from Demographic pressure (2015)\", Array(INFMOR(R), POP(R), POPR(R), YTHBULGE(R) * 100, MIGRANTS(R)), Est, Array(\"INFMOR\", \"POP\", \"POPR\", \"YTHBULGE\", \"MIGRANTS\"))\r\rCall AnalFunc(\"State Failure Probability from Demographic pressure (2015)\",\r                    New Single() {INFMOR(R), POP(R), POPR(R), YTHBULGE(R) * 100, MIGRANTS(R)}, Est,\r                    New String() {\"INFMOR\", \"POP\", \"POPR\", \"YTHBULGE\", \"MIGRANTS\"}, context)\r\r\rSFDEM(R) = Est\r"
  },
  {
    "Variable": "SFDEM",
    "UsesVariable": "POP",
    "Distance": 1,
    "Code": "COMPLETE STRUCTURE:Next R:1565|\r\rFor R = 1 To NR\r'Call AnalFunc(\"State Failure Probability from Demographic pressure (2015)\", Array(INFMOR(R), POP(R), POPR(R), YTHBULGE(R) * 100, MIGRANTS(R)), Est, Array(\"INFMOR\", \"POP\", \"POPR\", \"YTHBULGE\", \"MIGRANTS\"))\r\rCall AnalFunc(\"State Failure Probability from Demographic pressure (2015)\",\r                    New Single() {INFMOR(R), POP(R), POPR(R), YTHBULGE(R) * 100, MIGRANTS(R)}, Est,\r                    New String() {\"INFMOR\", \"POP\", \"POPR\", \"YTHBULGE\", \"MIGRANTS\"}, context)\r"
  },
  {
    "Variable": "SFDEM",
    "UsesVariable": "POPR",
    "Distance": 1,
    "Code": "COMPLETE STRUCTURE:Next R:1565|\r\rFor R = 1 To NR\r'Call AnalFunc(\"State Failure Probability from Demographic pressure (2015)\", Array(INFMOR(R), POP(R), POPR(R), YTHBULGE(R) * 100, MIGRANTS(R)), Est, Array(\"INFMOR\", \"POP\", \"POPR\", \"YTHBULGE\", \"MIGRANTS\"))\r\rCall AnalFunc(\"State Failure Probability from Demographic pressure (2015)\",\r                    New Single() {INFMOR(R), POP(R), POPR(R), YTHBULGE(R) * 100, MIGRANTS(R)}, Est,\r                    New String() {\"INFMOR\", \"POP\", \"POPR\", \"YTHBULGE\", \"MIGRANTS\"}, context)\r"
  },
  {
    "Variable": "SFDEM",
    "UsesVariable": "YTHBULGE",
    "Distance": 1,
    "Code": "COMPLETE STRUCTURE:Next R:1565|\r\rFor R = 1 To NR\r'Call AnalFunc(\"State Failure Probability from Demographic pressure (2015)\", Array(INFMOR(R), POP(R), POPR(R), YTHBULGE(R) * 100, MIGRANTS(R)), Est, Array(\"INFMOR\", \"POP\", \"POPR\", \"YTHBULGE\", \"MIGRANTS\"))\r\rCall AnalFunc(\"State Failure Probability from Demographic pressure (2015)\",\r                    New Single() {INFMOR(R), POP(R), POPR(R), YTHBULGE(R) * 100, MIGRANTS(R)}, Est,\r                    New String() {\"INFMOR\", \"POP\", \"POPR\", \"YTHBULGE\", \"MIGRANTS\"}, context)\r"
  },
  {
    "Variable": "SFDEM",
    "UsesVariable": "MIGRANTS",
    "Distance": 1,
    "Code": "COMPLETE STRUCTURE:Next R:1565|\r\rFor R = 1 To NR\r'Call AnalFunc(\"State Failure Probability from Demographic pressure (2015)\", Array(INFMOR(R), POP(R), POPR(R), YTHBULGE(R) * 100, MIGRANTS(R)), Est, Array(\"INFMOR\", \"POP\", \"POPR\", \"YTHBULGE\", \"MIGRANTS\"))\r\rCall AnalFunc(\"State Failure Probability from Demographic pressure (2015)\",\r                    New Single() {INFMOR(R), POP(R), POPR(R), YTHBULGE(R) * 100, MIGRANTS(R)}, Est,\r                    New String() {\"INFMOR\", \"POP\", \"POPR\", \"YTHBULGE\", \"MIGRANTS\"}, context)\r"
  },
  {
    "Variable": "SFECONDEV",
    "UsesVariable": "GDPPCP",
    "Distance": 1,
    "Code": "\r'the second driver is GDPPCR, GDP per Capita Growth\r'(GDPPC2 - GDPPC1)/GDPPC1 * 100\r'GDPPC1 = GDP1/POP1\r'GDPPC2 = GDP1*(1+GDPGR/100)/ (POP1*(1+POPGR/100))\r'Call AnalFunc(\"State Failure Probability from Economic pressure (2015)\", Array(GDPPCP(R), ((1 + GDPR(R) / 100) * (1 - 1 / (1 + POPR(R) / 100)) / (POPR(R) / 100) - 1) * 100, LIFEXP(R, 3)), Est, Array(\"GDPPCP\", \"LOGGDPPCR\", \"LIFEXP\"))\r\rCall AnalFunc(\"State Failure Probability from Economic pressure (2015)\",\r                    New Single() {GDPPCP(R), ((1 + GDPR(R) / 100) * (1 - 1 / (1 + POPR(R) / 100)) / (POPR(R) / 100) - 1) * 100, LIFEXP(R, 3)}, Est,\r                    New String() {\"GDPPCP\", \"LOGGDPPCR\", \"LIFEXP\"}, context)\r\r\rSFECONDEV(R) = Est\r"
  },
  {
    "Variable": "SFECONDEV",
    "UsesVariable": "GDPR",
    "Distance": 1,
    "Code": "\r'the second driver is GDPPCR, GDP per Capita Growth\r'(GDPPC2 - GDPPC1)/GDPPC1 * 100\r'GDPPC1 = GDP1/POP1\r'GDPPC2 = GDP1*(1+GDPGR/100)/ (POP1*(1+POPGR/100))\r'Call AnalFunc(\"State Failure Probability from Economic pressure (2015)\", Array(GDPPCP(R), ((1 + GDPR(R) / 100) * (1 - 1 / (1 + POPR(R) / 100)) / (POPR(R) / 100) - 1) * 100, LIFEXP(R, 3)), Est, Array(\"GDPPCP\", \"LOGGDPPCR\", \"LIFEXP\"))\r\rCall AnalFunc(\"State Failure Probability from Economic pressure (2015)\",\r                    New Single() {GDPPCP(R), ((1 + GDPR(R) / 100) * (1 - 1 / (1 + POPR(R) / 100)) / (POPR(R) / 100) - 1) * 100, LIFEXP(R, 3)}, Est,\r                    New String() {\"GDPPCP\", \"LOGGDPPCR\", \"LIFEXP\"}, context)\r"
  },
  {
    "Variable": "SFECONDEV",
    "UsesVariable": "POPR",
    "Distance": 1,
    "Code": "\r'the second driver is GDPPCR, GDP per Capita Growth\r'(GDPPC2 - GDPPC1)/GDPPC1 * 100\r'GDPPC1 = GDP1/POP1\r'GDPPC2 = GDP1*(1+GDPGR/100)/ (POP1*(1+POPGR/100))\r'Call AnalFunc(\"State Failure Probability from Economic pressure (2015)\", Array(GDPPCP(R), ((1 + GDPR(R) / 100) * (1 - 1 / (1 + POPR(R) / 100)) / (POPR(R) / 100) - 1) * 100, LIFEXP(R, 3)), Est, Array(\"GDPPCP\", \"LOGGDPPCR\", \"LIFEXP\"))\r\rCall AnalFunc(\"State Failure Probability from Economic pressure (2015)\",\r                    New Single() {GDPPCP(R), ((1 + GDPR(R) / 100) * (1 - 1 / (1 + POPR(R) / 100)) / (POPR(R) / 100) - 1) * 100, LIFEXP(R, 3)}, Est,\r                    New String() {\"GDPPCP\", \"LOGGDPPCR\", \"LIFEXP\"}, context)\r"
  },
  {
    "Variable": "SFECONDEV",
    "UsesVariable": "LIFEXP",
    "Distance": 1,
    "Code": "\r'the second driver is GDPPCR, GDP per Capita Growth\r'(GDPPC2 - GDPPC1)/GDPPC1 * 100\r'GDPPC1 = GDP1/POP1\r'GDPPC2 = GDP1*(1+GDPGR/100)/ (POP1*(1+POPGR/100))\r'Call AnalFunc(\"State Failure Probability from Economic pressure (2015)\", Array(GDPPCP(R), ((1 + GDPR(R) / 100) * (1 - 1 / (1 + POPR(R) / 100)) / (POPR(R) / 100) - 1) * 100, LIFEXP(R, 3)), Est, Array(\"GDPPCP\", \"LOGGDPPCR\", \"LIFEXP\"))\r\rCall AnalFunc(\"State Failure Probability from Economic pressure (2015)\",\r                    New Single() {GDPPCP(R), ((1 + GDPR(R) / 100) * (1 - 1 / (1 + POPR(R) / 100)) / (POPR(R) / 100) - 1) * 100, LIFEXP(R, 3)}, Est,\r                    New String() {\"GDPPCP\", \"LOGGDPPCR\", \"LIFEXP\"}, context)\r"
  },
  {
    "Variable": "SFIMBAL",
    "UsesVariable": "DEMOCPOLITY",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "SFIMBAL",
    "UsesVariable": "LIFEXP",
    "Distance": 1,
    "Code": "\r\r'jrs 2024/06/11\r'Call XYTABL(\"GDP/Capita (PPP 2011) Versus Democracy (all years) Log\", GDPPCP(R%), EstDem, context)\rCall XYTABL(TFDemocracy, GDPPCP(R%), EstDem, context)\r"
  },
  {
    "Variable": "SFIMBAL",
    "UsesVariable": "YTHBULGE",
    "Distance": 1,
    "Code": "\r\rCall XYTABL(\"GDP/Capita (PPP 2011) Versus Life Expectancy (all years) Log\", GDPPCP(R%), EstLif, context)\r"
  },
  {
    "Variable": "SFIMBAL",
    "UsesVariable": "GDPPCP",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "SFINSTABALL",
    "UsesVariable": "sfusehist",
    "Distance": 338,
    "Code": "0"
  },
  {
    "Variable": "SFINSTABALL",
    "UsesVariable": "GDPPCP",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "SFINSTABALL",
    "UsesVariable": "DEMOCPOLITY",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "SFINSTABALL",
    "UsesVariable": "INFMOR",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "SFINSTABALL",
    "UsesVariable": "X",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "SFINSTABALL",
    "UsesVariable": "M",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "SFINSTABALL",
    "UsesVariable": "GDP",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "SFINSTABALL",
    "UsesVariable": "EDYRSAG15",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "SFINSTABALL",
    "UsesVariable": "WPOP",
    "Distance": 17,
    "Code": "0"
  },
  {
    "Variable": "SFINSTABALL",
    "UsesVariable": "POP",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "SFINSTABALL",
    "UsesVariable": "ifsexomodelid",
    "Distance": 353,
    "Code": "0"
  },
  {
    "Variable": "SFINSTABALL",
    "UsesVariable": "sfconv",
    "Distance": 0,
    "Code": "\r\r\rPrediction = AMAX(0.001, Prediction)\r\rhistorybased = AMAX(0.0001, Amin(1, SFINSTABALLRI(R%) * Prediction))\r\rIf sfusehist < 0.5 Then\rSFINSTABALL(R%) = AMAX(0.0001, Amin(1, Prediction))\rElseIf sfusehist > 1.5 Then\rSFINSTABALL(R%) = ConvergeOverTime(historybased, Prediction, sfconv)\r'Base, Target, Years\rElse\rSFINSTABALL(R%) = historybased\rEnd If\r"
  },
  {
    "Variable": "SFINSTABMAG",
    "UsesVariable": "sfusehist",
    "Distance": 341,
    "Code": "0"
  },
  {
    "Variable": "SFINSTABMAG",
    "UsesVariable": "GDPPCP",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "SFINSTABMAG",
    "UsesVariable": "DEMOCPOLITY",
    "Distance": 17,
    "Code": "0"
  },
  {
    "Variable": "SFINSTABMAG",
    "UsesVariable": "INFMOR",
    "Distance": 19,
    "Code": "0"
  },
  {
    "Variable": "SFINSTABMAG",
    "UsesVariable": "X",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "SFINSTABMAG",
    "UsesVariable": "M",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "SFINSTABMAG",
    "UsesVariable": "GDP",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "SFINSTABMAG",
    "UsesVariable": "EDYRSAG15",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "SFINSTABMAG",
    "UsesVariable": "WPOP",
    "Distance": 23,
    "Code": "0"
  },
  {
    "Variable": "SFINSTABMAG",
    "UsesVariable": "POP",
    "Distance": 24,
    "Code": "0"
  },
  {
    "Variable": "SFINSTABMAG",
    "UsesVariable": "ifsexomodelid",
    "Distance": 359,
    "Code": "0"
  },
  {
    "Variable": "SFINSTABMAG",
    "UsesVariable": "sfconv",
    "Distance": 0,
    "Code": "\r\rPrediction = AMAX(0.001, Prediction)\r\rhistorybased = AMAX(0.0001, Amin(5, SFINSTABMAGRI(R%) * Prediction))\r\rIf sfusehist < 0.5 Then\rSFINSTABMAG(R%) = AMAX(0.0001, Amin(1, Prediction))\rElseIf sfusehist > 1.5 Then\rSFINSTABMAG(R%) = ConvergeOverTime(historybased, Prediction, sfconv)\r'Base, Target, Years\rElse\rSFINSTABMAG(R%) = historybased\rEnd If\r"
  },
  {
    "Variable": "SFINTLWARALL",
    "UsesVariable": "sfintlwaradd",
    "Distance": 0,
    "Code": "\r'Otherwise calculation below will introduce run to run\r\rFor R% = 1 To NR%\r'bbh 2011/06/18 begin\r'        contiguityadd = 0\r'        For ICount% = 1 To NR%\r'            If contiguity(R%, ICount%) <= 3 Then  '1= land contiguity; 2 = 0-12 miles; 3 = 12-24 miles\r'                If SFINTLWARALL(ICount%) >= 0.2 Then  'Enough risk next door to add to yours\r'                    contiguityadd = contiguityadd + 0.1\r'                End If\r'            End If\r'        Next ICount%\r'        contiguityadd = Amin(0.4, contiguityadd)\r'        If contiguityadd > 0 And GDPPCP(R%) > 10 Then 'phase down Contiguity impact as approach GDPPCP of $15K\r'            contiguityadd = contiguityadd * AMAX(0, (15 - GDPPCP(R%)) / 5)\r\r'        SFINTLWARALL(R%) = Amin(1, SFINTLWARALL(R%) + contiguityadd)\r'        End If\r'If RegName$(R%) = \"Azerbaijan\" Then Stop\r'If GRPS(1, R%) = \"Nigeria\" And FirstYear + IY - 1 >= 2056 Then Stop\rSFINTLWARALL(R%) = AMAX(0, Amin(1, SFINTLWARALL(R%) + ContiguityIntlWarAdd(R%) - ContiguityIntlWarAddI(R%)))\r'bbh 2011/06/18 begin\r'If RegName(R%) = \"Kazakhstan\" Then Stop\r'jrs 2024/05/20\rIf sfcivilwarucdpsw = 0 Then\r'bbh 2011/10/5\rIf sfmassrep(R%) >= 0.01 Then SFINTLWARALL(R%) = SFINTLWARALL(R%) * sfmassrep(R%)\r'If sfmassrep(R%) > 0.5 Then SFINTLWARALL(R%) = SFINTLWARALL(R%) * 0.1\rSFINTLWARALL(R%) = AMAX(0, Amin(1, SFINTLWARALL(R%) + sfintlwaradd(R%)))\rElse\rIf sfmassrep(R%) >= 0.01 Then SFCIVILWARUCDP(R%) = SFCIVILWARUCDP(R%) * sfmassrep(R%)\r\rSFCIVILWARUCDP(R%) = AMAX(0, Amin(1, SFCIVILWARUCDP(R%) + sfintlwaradd(R%)))\rEnd If\r'BBH 2011/04/02 end\r'If IY% > 40 And RegName$(R%) = \"Iran\" Then Stop\r\r'jrs 2021/08/04 Exogenous Models\rIf ifsexomodelid > 0 Then\rDim old As Single\rold = SFINTLWARALL(R%)\rReplaceVarWithExogenousForecastxReg(\"SFINTLWARALL\", \"\", \"\", CStr(FirstYear + IY - 1), R%, context)\r'if there's a change update saved variable\rIf old <> SFINTLWARALL(R%) Then\rssfintlwarallLoc(R%) = AMAX(0, Amin(1, SFINTLWARALL(R%) + sfintlwaradd(R%)))\rEnd If\r'jrs 2024/05/20\rReplaceVarWithExogenousForecastxReg(\"SFCIVILWARUCDP\", \"\", \"\", CStr(FirstYear + IY - 1), R%, context)\rEnd If\r\r'       bbh 2011/09/21 Tie change in magnitude to change in probability instead of simple, separate function\r'        Call AnalFunc(\"State Failure from Internal War, magnitude\", _\r'            Array(GDPPCP(R%), democterm, infmorterm, TradeTerm, educ15term), prediction)\r'        prediction = AMAX(0.001, prediction)\r'        historybased = AMAX(0.0001, Amin(5, SFINTLWARMAGRI(R%) * prediction))\r'        If sfusehist < 0.5 Then\r'            SFINTLWARMAG(R%) = AMAX(0.0001, Amin(1, prediction))\r'        ElseIf sfusehist > 1.5 Then\r'            SFINTLWARMAG(R%) = ConvergeOverTime(historybased, prediction, sfconv)\r'                'Base, Target, Years\r'        Else\r'            SFINTLWARMAG(R%) = historybased\r'        End If\r'SFINTLWARMAG(R%) = SFINTLWARMAGI(R%) * Amin(3, SFINTLWARALL(R%) / SFINTLWARALLI(R%))\rSFINTLWARMAG(R%) = SFINTLWARMAGI(R%) * Amin(3, SFINTLWARALL(R%) / SFINTLWARALLI(R%)) * sfintlwarmagm(R%) 'dkb 2019/01/22 - adding multiplier on internal war magnitude\r'jrs 2016/01/13\rSSFINTLWARMAG(R%) = SFINTLWARMAG(R%)\r\r\r'   All but First 2:  Save Education Years for Govt Effectiveness\r'   -------------------------------------------------------------\r\rsedyrsag15(R%) = EDYRSAG15(R%, 3)\r'bbh 2011/08/19\rsedyrsag15fem(R%) = EDYRSAG15(R%, 2)\r\r\r\rNext R%\r"
  },
  {
    "Variable": "SFINTLWARALL",
    "UsesVariable": "sfmassrep",
    "Distance": 0,
    "Code": "\r'Otherwise calculation below will introduce run to run\r\rFor R% = 1 To NR%\r'bbh 2011/06/18 begin\r'        contiguityadd = 0\r'        For ICount% = 1 To NR%\r'            If contiguity(R%, ICount%) <= 3 Then  '1= land contiguity; 2 = 0-12 miles; 3 = 12-24 miles\r'                If SFINTLWARALL(ICount%) >= 0.2 Then  'Enough risk next door to add to yours\r'                    contiguityadd = contiguityadd + 0.1\r'                End If\r'            End If\r'        Next ICount%\r'        contiguityadd = Amin(0.4, contiguityadd)\r'        If contiguityadd > 0 And GDPPCP(R%) > 10 Then 'phase down Contiguity impact as approach GDPPCP of $15K\r'            contiguityadd = contiguityadd * AMAX(0, (15 - GDPPCP(R%)) / 5)\r\r'        SFINTLWARALL(R%) = Amin(1, SFINTLWARALL(R%) + contiguityadd)\r'        End If\r'If RegName$(R%) = \"Azerbaijan\" Then Stop\r'If GRPS(1, R%) = \"Nigeria\" And FirstYear + IY - 1 >= 2056 Then Stop\rSFINTLWARALL(R%) = AMAX(0, Amin(1, SFINTLWARALL(R%) + ContiguityIntlWarAdd(R%) - ContiguityIntlWarAddI(R%)))\r'bbh 2011/06/18 begin\r'If RegName(R%) = \"Kazakhstan\" Then Stop\r'jrs 2024/05/20\rIf sfcivilwarucdpsw = 0 Then\r'bbh 2011/10/5\rIf sfmassrep(R%) >= 0.01 Then SFINTLWARALL(R%) = SFINTLWARALL(R%) * sfmassrep(R%)\r'If sfmassrep(R%) > 0.5 Then SFINTLWARALL(R%) = SFINTLWARALL(R%) * 0.1\rSFINTLWARALL(R%) = AMAX(0, Amin(1, SFINTLWARALL(R%) + sfintlwaradd(R%)))\rElse\rIf sfmassrep(R%) >= 0.01 Then SFCIVILWARUCDP(R%) = SFCIVILWARUCDP(R%) * sfmassrep(R%)\r\rSFCIVILWARUCDP(R%) = AMAX(0, Amin(1, SFCIVILWARUCDP(R%) + sfintlwaradd(R%)))\rEnd If\r'BBH 2011/04/02 end\r'If IY% > 40 And RegName$(R%) = \"Iran\" Then Stop\r\r'jrs 2021/08/04 Exogenous Models\rIf ifsexomodelid > 0 Then\rDim old As Single\rold = SFINTLWARALL(R%)\rReplaceVarWithExogenousForecastxReg(\"SFINTLWARALL\", \"\", \"\", CStr(FirstYear + IY - 1), R%, context)\r'if there's a change update saved variable\rIf old <> SFINTLWARALL(R%) Then\rssfintlwarallLoc(R%) = AMAX(0, Amin(1, SFINTLWARALL(R%) + sfintlwaradd(R%)))\rEnd If\r'jrs 2024/05/20\rReplaceVarWithExogenousForecastxReg(\"SFCIVILWARUCDP\", \"\", \"\", CStr(FirstYear + IY - 1), R%, context)\rEnd If\r\r'       bbh 2011/09/21 Tie change in magnitude to change in probability instead of simple, separate function\r'        Call AnalFunc(\"State Failure from Internal War, magnitude\", _\r'            Array(GDPPCP(R%), democterm, infmorterm, TradeTerm, educ15term), prediction)\r'        prediction = AMAX(0.001, prediction)\r'        historybased = AMAX(0.0001, Amin(5, SFINTLWARMAGRI(R%) * prediction))\r'        If sfusehist < 0.5 Then\r'            SFINTLWARMAG(R%) = AMAX(0.0001, Amin(1, prediction))\r'        ElseIf sfusehist > 1.5 Then\r'            SFINTLWARMAG(R%) = ConvergeOverTime(historybased, prediction, sfconv)\r'                'Base, Target, Years\r'        Else\r'            SFINTLWARMAG(R%) = historybased\r'        End If\r'SFINTLWARMAG(R%) = SFINTLWARMAGI(R%) * Amin(3, SFINTLWARALL(R%) / SFINTLWARALLI(R%))\rSFINTLWARMAG(R%) = SFINTLWARMAGI(R%) * Amin(3, SFINTLWARALL(R%) / SFINTLWARALLI(R%)) * sfintlwarmagm(R%) 'dkb 2019/01/22 - adding multiplier on internal war magnitude\r'jrs 2016/01/13\rSSFINTLWARMAG(R%) = SFINTLWARMAG(R%)\r\r\r'   All but First 2:  Save Education Years for Govt Effectiveness\r'   -------------------------------------------------------------\r\rsedyrsag15(R%) = EDYRSAG15(R%, 3)\r'bbh 2011/08/19\rsedyrsag15fem(R%) = EDYRSAG15(R%, 2)\r\r\r\rNext R%\r"
  },
  {
    "Variable": "SFINTLWARALL",
    "UsesVariable": "GDPPCP",
    "Distance": 726,
    "Code": "0"
  },
  {
    "Variable": "SFINTLWARALL",
    "UsesVariable": "SFCIVILWARUCDP",
    "Distance": 729,
    "Code": "0"
  },
  {
    "Variable": "SFINTLWARALL",
    "UsesVariable": "wpextinterv",
    "Distance": 1,
    "Code": "\rIf growthratediff > 0 Then\recongrowthadd = CSng(growthratediff * 0.04)\rEnd If\r"
  },
  {
    "Variable": "SFINTLWARALL",
    "UsesVariable": "DEMOCPOLITY",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "SFINTLWARALL",
    "UsesVariable": "YTHBULGE",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "SFINTLWARALL",
    "UsesVariable": "GDPR",
    "Distance": 6,
    "Code": "\rgdprmovavg(R%) = igdpr(R%)\r\r'BBH 2011/04/02\rYTHBULGEI(R%) = YTHBULGE(R%)\r"
  },
  {
    "Variable": "SFINTLWARALL",
    "UsesVariable": "igdpr",
    "Distance": 441,
    "Code": "\rgdprmovavg(R%) = igdpr(R%)\r"
  },
  {
    "Variable": "SFINTLWARALL",
    "UsesVariable": "INFMOR",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "SFINTLWARALL",
    "UsesVariable": "X",
    "Distance": 27,
    "Code": "0"
  },
  {
    "Variable": "SFINTLWARALL",
    "UsesVariable": "M",
    "Distance": 27,
    "Code": "0"
  },
  {
    "Variable": "SFINTLWARALL",
    "UsesVariable": "GDP",
    "Distance": 27,
    "Code": "0"
  },
  {
    "Variable": "SFINTLWARALL",
    "UsesVariable": "EDYRSAG15",
    "Distance": 24,
    "Code": "0"
  },
  {
    "Variable": "SFINTLWARALL",
    "UsesVariable": "sfconv",
    "Distance": 0,
    "Code": "\r\r\r'bbh 07/29/2011 end\r\rPrediction = AMAX(0.001, Prediction)\r\r'If RegName$(R%) = \"Azerbaijan\" Then Stop\r'bbh 2011/06/18 begin\rhistorybased = AMAX(0.0001, Amin(1, SFINTLWARALLADD(R%) + Prediction))\r\r'If GRPS(1, R%) = \"Russian Federation\" Then Stop\rIf sfusehist < 0.5 Then  'use analytical formulation only; no adjustment to history\rSFINTLWARALL(R%) = AMAX(0.0001, Amin(1, Prediction))\rElseIf sfusehist > 1.5 Then 'use analytical formulation adjusted to history, converging to analystic only\rSFINTLWARALL(R%) = ConvergeOverTime(historybased, Prediction, sfconv)\r'Base, Target, Years\rElse 'use analytical formulation adjusted to history\rSFINTLWARALL(R%) = historybased\rEnd If\r"
  },
  {
    "Variable": "SFINTLWARALL",
    "UsesVariable": "sfusehist",
    "Distance": 0,
    "Code": "\r\r\r'bbh 07/29/2011 end\r\rPrediction = AMAX(0.001, Prediction)\r\r'If GRPS(1, R%) = \"Russian Federation\" Then Stop\rIf sfusehist < 0.5 Then  'use analytical formulation only; no adjustment to history\rSFINTLWARALL(R%) = AMAX(0.0001, Amin(1, Prediction))\rElseIf sfusehist > 1.5 Then 'use analytical formulation adjusted to history, converging to analystic only\rSFINTLWARALL(R%) = ConvergeOverTime(historybased, Prediction, sfconv)\r'Base, Target, Years\rElse 'use analytical formulation adjusted to history\rSFINTLWARALL(R%) = historybased\rEnd If\r"
  },
  {
    "Variable": "SFINTLWARMAG",
    "UsesVariable": "SFINTLWARALL",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SFINTLWARMAG",
    "UsesVariable": "sfintlwarmagm",
    "Distance": 0,
    "Code": "\r'jrs 2024/05/23\r'If GRPS(1, R%) = \"Russian Federation\" Then\r'    Dim objWriter = New System.IO.StreamWriter(PutFdrvRun + \"SFCIVILWARUCDP.txt\", append:=False)\r'    objWriter.WriteLine(ContiguityIntlWarAdd(R%).ToString)\r'    objWriter.Close()\r'End If\r'jrs 2024/05/17 *** end ***\r\r'bbh 2011/09/21\rSFINTLWARALLI(R%) = AMAX(0.001, SFINTLWARALL(R%))\r"
  },
  {
    "Variable": "SFINTLWARMAG",
    "UsesVariable": "sfusehist",
    "Distance": 371,
    "Code": "\r'jrs 2024/05/23\r'If GRPS(1, R%) = \"Russian Federation\" Then\r'    Dim objWriter = New System.IO.StreamWriter(PutFdrvRun + \"SFCIVILWARUCDP.txt\", append:=False)\r'    objWriter.WriteLine(ContiguityIntlWarAdd(R%).ToString)\r'    objWriter.Close()\r'End If\r'jrs 2024/05/17 *** end ***\r\r'bbh 2011/09/21\rSFINTLWARALLI(R%) = AMAX(0.001, SFINTLWARALL(R%))\r"
  },
  {
    "Variable": "SOCIETALVIOLENCEDEATHS",
    "UsesVariable": "SVDTHSSOCIETALVIOLENCETOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SOCIETALVIOLENCEDEATHS",
    "UsesVariable": "POP",
    "Distance": 17,
    "Code": "0"
  },
  {
    "Variable": "SSWELTAX",
    "UsesVariable": "HHGOVSS",
    "Distance": 0,
    "Code": "\r\rPrivate Sub AggrRev(R As Integer)\r'mti 2017/03/16 New Proc\r\rSSWELTAX(R%) = HHGOVSS(R%, Unskilled) + HHGOVSS(R%, Skilled) + FIRMGOVSS(R%)\rGOVREV(R%) = HHTAX(R%, Unskilled) + HHTAX(R%, Skilled) + FIRMTAX(R%) +\r            INDIRECTTAX(R%) + SSWELTAX(R%)\r'bbh 2019/09/13 start\rFor S% = 1 To NSec%\r'GOVREV(R%) = GOVREV(R%) + MTARIFFREV(R%, S%)\rGOVREV(R%) = GOVREV(R%) + SMTariffRev(R%, S%) 'dkb 2019/10/22\rNext S%\r'bbh 2019/09/13 end\rTAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOTRPA(R%))\rGOVREVDOM(R%) = GOVREV(R%)\rIf AID(R%) > 0 Then GOVREV(R%) = GOVREV(R%) + AID(R%) 'Receipts\r\r'GrantPortion = AID(R%) * (1 - aidlp)\r'GOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%)\r'bbh 2022/12/20 Register net flows on revenue side; not done on either side in preprocessor\rGOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%) - XWBLNFOUT(R%) - XIMFCRFOUT(R%)\r\r\rEnd Sub\r"
  },
  {
    "Variable": "SSWELTAX",
    "UsesVariable": "FIRMGOVSS",
    "Distance": 0,
    "Code": "\r\rPrivate Sub AggrRev(R As Integer)\r'mti 2017/03/16 New Proc\r\rSSWELTAX(R%) = HHGOVSS(R%, Unskilled) + HHGOVSS(R%, Skilled) + FIRMGOVSS(R%)\rGOVREV(R%) = HHTAX(R%, Unskilled) + HHTAX(R%, Skilled) + FIRMTAX(R%) +\r            INDIRECTTAX(R%) + SSWELTAX(R%)\r'bbh 2019/09/13 start\rFor S% = 1 To NSec%\r'GOVREV(R%) = GOVREV(R%) + MTARIFFREV(R%, S%)\rGOVREV(R%) = GOVREV(R%) + SMTariffRev(R%, S%) 'dkb 2019/10/22\rNext S%\r'bbh 2019/09/13 end\rTAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOTRPA(R%))\rGOVREVDOM(R%) = GOVREV(R%)\rIf AID(R%) > 0 Then GOVREV(R%) = GOVREV(R%) + AID(R%) 'Receipts\r\r'GrantPortion = AID(R%) * (1 - aidlp)\r'GOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%)\r'bbh 2022/12/20 Register net flows on revenue side; not done on either side in preprocessor\rGOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%) - XWBLNFOUT(R%) - XIMFCRFOUT(R%)\r\r\rEnd Sub\r"
  },
  {
    "Variable": "SSWELTAXR",
    "UsesVariable": "GDPPCP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "SSWELTAXR",
    "UsesVariable": "govrevtrgtval",
    "Distance": 11,
    "Code": "\r\r'        TAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOT(R%))\rPreTAXRA = AMAX(1, PreGOVREV / AMAX(0.0001, GDPPOTRPA(R%)) * 100)\r\r\r'        TAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOT(R%))\rPreTAXRA = AMAX(1, PreGOVREV / AMAX(0.0001, GDPPOTRPA(R%)) * 100)\rCOMPLETE STRUCTURE:End If:6255|\r'If IY% = 2 Then PreTAXRAi(R%) = PreTAXRA\r\rIf govrevtrgtyr > 1 AndAlso govrevtrgtval(R%) > 1 AndAlso PreTAXRA < govrevtrgtval(R%) Then\rTaxTar = PreTAXRA + (govrevtrgtval(R%) - PreTAXRA) / govrevtrgtyr * Amin(IY%, govrevtrgtyr)\rCOMPLETE STRUCTURE:End If:6255|\r'If RegName$(R%) = \"Chad\" And IY% >= 15 Then Stop\rIf PreTAXRA < TaxTar Then\rTaxTarMul = TaxTar / PreTAXRA\r\rSSWELTAXR(R%) = SSWELTAXR(R%) * TaxTarMul\r"
  },
  {
    "Variable": "SSWELTAXR",
    "UsesVariable": "govrevtrgtyr",
    "Distance": 11,
    "Code": "\r\r'        TAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOT(R%))\rPreTAXRA = AMAX(1, PreGOVREV / AMAX(0.0001, GDPPOTRPA(R%)) * 100)\r"
  },
  {
    "Variable": "SSWELTAXR",
    "UsesVariable": "HHTAX",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "SSWELTAXR",
    "UsesVariable": "FIRMTAX",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "SSWELTAXR",
    "UsesVariable": "INDIRECTTAX",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "SSWELTAXR",
    "UsesVariable": "VADD",
    "Distance": 533,
    "Code": "0"
  },
  {
    "Variable": "SSWELTAXR",
    "UsesVariable": "WP",
    "Distance": 533,
    "Code": "0"
  },
  {
    "Variable": "SSWELTAXR",
    "UsesVariable": "HHGOVSS",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "SSWELTAXR",
    "UsesVariable": "FIRMGOVSS",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "SSWELTAXR",
    "UsesVariable": "taxinfadjm",
    "Distance": 3,
    "Code": "\r'mti 2015/06/09 - end\r'If RegName$(R%) = \"Peru\" And IY% >= 6 Then Stop\r\r'mti 2016/11/02 Start\rTaxInfAdjustmentFac(R%) = CSng(1 + taxinfadjm(R%) * AMAX(-0.5, Amin(0.5, (ExDefInfGDPi(R%) - ExDefInfGDP))))\r\rSSWELTAXR(R%) = SSWELTAXR(R%) * TaxInfAdjustmentFac(R%)\r"
  },
  {
    "Variable": "SSWELTAXR",
    "UsesVariable": "GDPSHADOWSHR",
    "Distance": 1946,
    "Code": "0"
  },
  {
    "Variable": "SSWELTAXR",
    "UsesVariable": "gdpshadowon",
    "Distance": 1946,
    "Code": "0"
  },
  {
    "Variable": "ST",
    "UsesVariable": "PFD",
    "Distance": 0,
    "Code": "\rST(R%, S%) = SST(R%, S%) + PFD(R%, S%) + MS(R%, S%) - st_red\r\r\r'                If S% = 1 Or S% = 2 Then 'bbh 2022/12/13 If-End If to bound ag/en stock levels from PFD calc; not working, need variation\r'                    ST(R%, S%) = Amin(ST(R%, S%), 3 * StBase(R%, S%) * dstl)\r'                    If ST(R%, S%) < 0 Then ST(R%, S%) = AMAX(ST(R%, S%), -3 * StBase(R%, S%) * dstl)\r'                End If\r\r'bbh 2020/08/29 Following line addition avoids disequilibrium through exogenous period, even COVID\r'bbh 2020/11/22  Commented out the line below because was\r'not avoiding, but causing disequilibirum AFTER COVID period with exogenous thru 2021 or 2025\r'If gdprext(R%) > -70 Then ST(R%, S%) = StBase(R%, S%) * dstl\r\r'bbh 2020/11/22 start Tested but did not use block below; shifted adjustment post intervention to CAPUT in CapacityUtil\r'                If (gdprext(R%) > -70) And (IY% - 1 + FirstYear = 2025) Then\r'                    ST(R%, S%) = StBase(R%, S%) * dstl\r'                    SST(R%, S%) = ST(R%, S%)\r'                    PRI(R%, S%) = 1\r'                End If\r'bbh 2020/11/22 end\r\r'bbh 2020/11/14 above line does not allow some adjustments prior to end of exogenous period and then transients; bigger without it\rST(R%, S%) = AMAX(-10000, Amin(ST(R%, S%), 10000))\r"
  },
  {
    "Variable": "ST",
    "UsesVariable": "MS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ST",
    "UsesVariable": "CS",
    "Distance": 1,
    "Code": "COMPLETE STRUCTURE:End If 'bbh 2022/12/13 End of block that has been restricting ST calc to sectors 3-6; if don't restrict, PFD calc of ag stocks behaves badly:5962|\rIf ((S% > Ener) OrElse (S% = Agri AndAlso agon < 0.9) OrElse\r                    (S% = Ener AndAlso enon < 0.9)) Then\r'bbh 2022/12/13 Tried commented If-End If statements out so as to allow PFD based calc of stock change and accumulation.\r'Learned that there are huge ST values for ag in some countries if do that and it greatly changes behavior of model\rst_red = CS(R%, S%) + INVS(R%, S%) + GS(R%, S%) + XS(R%, S%)\r"
  },
  {
    "Variable": "ST",
    "UsesVariable": "INVS",
    "Distance": 1,
    "Code": "COMPLETE STRUCTURE:End If 'bbh 2022/12/13 End of block that has been restricting ST calc to sectors 3-6; if don't restrict, PFD calc of ag stocks behaves badly:5962|\rIf ((S% > Ener) OrElse (S% = Agri AndAlso agon < 0.9) OrElse\r                    (S% = Ener AndAlso enon < 0.9)) Then\r'bbh 2022/12/13 Tried commented If-End If statements out so as to allow PFD based calc of stock change and accumulation.\r'Learned that there are huge ST values for ag in some countries if do that and it greatly changes behavior of model\rst_red = CS(R%, S%) + INVS(R%, S%) + GS(R%, S%) + XS(R%, S%)\r"
  },
  {
    "Variable": "ST",
    "UsesVariable": "GS",
    "Distance": 1,
    "Code": "COMPLETE STRUCTURE:End If 'bbh 2022/12/13 End of block that has been restricting ST calc to sectors 3-6; if don't restrict, PFD calc of ag stocks behaves badly:5962|\rIf ((S% > Ener) OrElse (S% = Agri AndAlso agon < 0.9) OrElse\r                    (S% = Ener AndAlso enon < 0.9)) Then\r'bbh 2022/12/13 Tried commented If-End If statements out so as to allow PFD based calc of stock change and accumulation.\r'Learned that there are huge ST values for ag in some countries if do that and it greatly changes behavior of model\rst_red = CS(R%, S%) + INVS(R%, S%) + GS(R%, S%) + XS(R%, S%)\r"
  },
  {
    "Variable": "ST",
    "UsesVariable": "XS",
    "Distance": 1,
    "Code": "COMPLETE STRUCTURE:End If 'bbh 2022/12/13 End of block that has been restricting ST calc to sectors 3-6; if don't restrict, PFD calc of ag stocks behaves badly:5962|\rIf ((S% > Ener) OrElse (S% = Agri AndAlso agon < 0.9) OrElse\r                    (S% = Ener AndAlso enon < 0.9)) Then\r'bbh 2022/12/13 Tried commented If-End If statements out so as to allow PFD based calc of stock change and accumulation.\r'Learned that there are huge ST values for ag in some countries if do that and it greatly changes behavior of model\rst_red = CS(R%, S%) + INVS(R%, S%) + GS(R%, S%) + XS(R%, S%)\r"
  },
  {
    "Variable": "ST",
    "UsesVariable": "dstl",
    "Distance": 0,
    "Code": "\r\r'   First Year: Compute Initial Stocks and Recompute Stock Ratio\r'       Based on Computed VADD\r'   ------------------------------------------------------------\rFor S% = 1 To NSec%\rims(R%, S%) = MS(R%, S%)\r'bbh 2020/08/03 Start; need to switch stock base from ZS to VADD because over time\r'   the ratio of ZS/VADD changes (in China manufacturing almost doubles); VADD/PFD more stable\r'   Perhaps should even be PFD given the close link of PFD to stock accummulation\r'   Problem with ZS is that over time the swings of ST and CAPUT become reinforcing and very large\rStBase(R%, S%) = ZS(R%, S%) + ims(R%, S%)\r'StBase(R%, S%) = PFD(R%, S%) + ims(R%, S%) 'bbh 2022/10/27\rMovAvgMS(R%, S%) = ims(R%, S%) 'bbh 2022/10/27\r'StBase(R%, S%) = VADD(R%, S%) + ims(R%, S%)\r'bbh 2020/08/03 end\rSMS(R%, S%) = MS(R%, S%) 'bbh 2019/09/13\r\r'mti 2018/10/01 Start\r'            sms(R%, S%) = MS(R%, S%)\r'            StBase(R%, S%) = ZS(R%, S%) + sms(R%, S%)\r'mti 2018/10/01 End\r\rST(R%, S%) = StBase(R%, S%) * dstl\rNext S%\r\r\r'   First Year: Compute Initial Stocks and Recompute Stock Ratio\r'       Based on Computed VADD\r'   ------------------------------------------------------------\rFor S% = 1 To NSec%\rims(R%, S%) = MS(R%, S%)\r'bbh 2020/08/03 Start; need to switch stock base from ZS to VADD because over time\r'   the ratio of ZS/VADD changes (in China manufacturing almost doubles); VADD/PFD more stable\r'   Perhaps should even be PFD given the close link of PFD to stock accummulation\r'   Problem with ZS is that over time the swings of ST and CAPUT become reinforcing and very large\rStBase(R%, S%) = ZS(R%, S%) + ims(R%, S%)\r'StBase(R%, S%) = PFD(R%, S%) + ims(R%, S%) 'bbh 2022/10/27\rMovAvgMS(R%, S%) = ims(R%, S%) 'bbh 2022/10/27\r'StBase(R%, S%) = VADD(R%, S%) + ims(R%, S%)\r'bbh 2020/08/03 end\rSMS(R%, S%) = MS(R%, S%) 'bbh 2019/09/13\r\r'mti 2018/10/01 Start\r'            sms(R%, S%) = MS(R%, S%)\r'            StBase(R%, S%) = ZS(R%, S%) + sms(R%, S%)\r'mti 2018/10/01 End\r\rST(R%, S%) = StBase(R%, S%) * dstl\rNext S%\r"
  },
  {
    "Variable": "ST",
    "UsesVariable": "ZS",
    "Distance": 3,
    "Code": "\r\r'   First Year: Compute Initial Stocks and Recompute Stock Ratio\r'       Based on Computed VADD\r'   ------------------------------------------------------------\rFor S% = 1 To NSec%\rims(R%, S%) = MS(R%, S%)\r'bbh 2020/08/03 Start; need to switch stock base from ZS to VADD because over time\r'   the ratio of ZS/VADD changes (in China manufacturing almost doubles); VADD/PFD more stable\r'   Perhaps should even be PFD given the close link of PFD to stock accummulation\r'   Problem with ZS is that over time the swings of ST and CAPUT become reinforcing and very large\rStBase(R%, S%) = ZS(R%, S%) + ims(R%, S%)\r'StBase(R%, S%) = PFD(R%, S%) + ims(R%, S%) 'bbh 2022/10/27\rMovAvgMS(R%, S%) = ims(R%, S%) 'bbh 2022/10/27\r'StBase(R%, S%) = VADD(R%, S%) + ims(R%, S%)\r'bbh 2020/08/03 end\rSMS(R%, S%) = MS(R%, S%) 'bbh 2019/09/13\r\r'mti 2018/10/01 Start\r'            sms(R%, S%) = MS(R%, S%)\r'            StBase(R%, S%) = ZS(R%, S%) + sms(R%, S%)\r'mti 2018/10/01 End\r\rST(R%, S%) = StBase(R%, S%) * dstl\rNext S%\r"
  },
  {
    "Variable": "ST",
    "UsesVariable": "FSTOCK",
    "Distance": 0,
    "Code": "\r\rST(R%, 1) = FSF(R%) * (FSTOCK(R%, 1) * swapi(1) + FSTOCK(R%, 2) * swapi(2) + FSTOCK(R%, 3) * swapi(3))\r"
  },
  {
    "Variable": "ST",
    "UsesVariable": "WAP",
    "Distance": 477,
    "Code": "\r\rFor f% = 1 To 3\rswapi(f%) = WAP(f%)\rswxc(f%) = 1\rswmd(f%) = 1\rGlobalSurDefRate(f%) = 0 'bbh 2022/10/27\rSGlobalSurDefRate(f%) = 0 'bbh 2022/11/28\rWTFoodType(f%) = 0 'bbh 2022/10/27 Initialize global trade by food type\rFor R% = 1 To NR%\rWTFoodType(f%) = WTFoodType(f%) + AGX(R%, f%)\rNext R%\rNext f%\r"
  },
  {
    "Variable": "ST",
    "UsesVariable": "ENST",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:End Sub:2822|COMPLETE STRUCTURE:Next R%:2822|\rPrivate Sub SubAllYears()\rFor R% = 1 To NR%\r'     All Years:  Translation for Economic Model\r'     ------------------------------------------\rST(R%, Ener) = ENST(R%) * iwepbyear  'ENPRII(R%)\r"
  },
  {
    "Variable": "ST",
    "UsesVariable": "WEPBYEAR",
    "Distance": 400,
    "Code": "\riwepbyear = WEPBYEAR\r"
  },
  {
    "Variable": "SURVSE",
    "UsesVariable": "survseadd",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SURVSE",
    "UsesVariable": "mprconv",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "SURVSE",
    "UsesVariable": "cultshse",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "SURVSE",
    "UsesVariable": "CULTREG",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "SURVSE",
    "UsesVariable": "GDPPCP",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSCHIL",
    "UsesVariable": "SVDTHSCHILTOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSCHIL",
    "UsesVariable": "POP",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSCHIL",
    "UsesVariable": "svmulm",
    "Distance": 0,
    "Code": "\r\rChilShift(R%) = CSng(SVDTHSCHIL(R%) / (Amin(AMAX(Exp(ChilEst), 0.000001), 21)))\r\r'3b. Violence against children\r'Call AnalFunc(\"Interpersonal deaths per 100000 people\", Array(GINIDOM(R%) * 100, YTHBULGE(R%) * 100), ChilEst, Array(\"GINIDOM\", \"Youthbulge\"))\r\rCall AnalFunc(\"Interpersonal deaths per 100000 people\",\r                    New Single() {GINIDOM(R%) * 100, YTHBULGE(R%) * 100}, ChilEst,\r                    New String() {\"GINIDOM\", \"Youthbulge\"}, context)\r\r\r\rSVDTHSCHIL(R%) = CSng(Amin(AMAX(Exp(ChilEst) * ChilShift(R%), 0.000001), 21) * svmulm(R%, 4))\r"
  },
  {
    "Variable": "SVDTHSCHIL",
    "UsesVariable": "GINIDOM",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSCHIL",
    "UsesVariable": "YTHBULGE",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSCHIL",
    "UsesVariable": "SVDTHSOTHERINTERPERSON",
    "Distance": 5,
    "Code": "\rpoptotalterm = (AdultMaleTerm + WomenTerm + ChildrenTerm)\r"
  },
  {
    "Variable": "SVDTHSCHIL",
    "UsesVariable": "SVDTHSWOMEN",
    "Distance": 5,
    "Code": "\r'dkb 2020/02/24 *** end ***\r\r'kbn 2018/04/27 Start-Violence Model\r'kbn 2018/06/26- Start- Enter descriptions in code for violence model below\r'-----------Violence model (First Year)-----------------------\r'Violence model in the first year proceeds in following sequence\r'1. Create Population terms for total deaths using the age structure variables in the population model\r'2. Normalize deaths in the violence model to those in the population model if normalization switch is on or if violence forward linkage is on\r'3. Define shift factors for the violence model\r'4. Compute total number of deaths using the death rates and age structure calculated in 1. above\r'5. Recalculate total death rate using total number of deaths\r'6. Compute the HOMICIDE index for the first year\r'7. Save variable values for the first year\r'kbn 2018/06/26 End\r\r'1. kbn 2018/05/16 create population terms for total deaths computation using 'agedst' from POPULAT\rAdultMaleTerm = ((agedst(4, R%, 1) + agedst(5, R%, 1) + agedst(6, R%, 1) + agedst(7, R%, 1) + agedst(8, R%, 1) + agedst(9, R%, 1) + agedst(10, R%, 1) +\r                agedst(11, R%, 1) + agedst(12, R%, 1) + agedst(13, R%, 1) + agedst(14, R%, 1) + agedst(15, R%, 1) + agedst(16, R%, 1) + agedst(17, R%, 1) + agedst(18, R%, 1) + agedst(19, R%, 1) + agedst(20, R%, 1) + agedst(21, R%, 1)) * 1000000)\r"
  },
  {
    "Variable": "SVDTHSCHIL",
    "UsesVariable": "SVDTHSCONFLICT",
    "Distance": 5,
    "Code": "\rChildrenTerm = (agedst(0, R%, 1) + agedst(0, R%, 2) + agedst(1, R%, 1) + agedst(1, R%, 2) + agedst(2, R%, 1) + agedst(2, R%, 2) + agedst(3, R%, 1) + agedst(3, R%, 2)) * 1000000\r\rWomenTerm = ((agedst(4, R%, 2) + agedst(5, R%, 2) + agedst(6, R%, 2) + agedst(7, R%, 2) + agedst(8, R%, 2) + agedst(9, R%, 2) + agedst(10, R%, 2) +\r                agedst(11, R%, 2) + agedst(12, R%, 2) + agedst(13, R%, 2) + agedst(14, R%, 2) + agedst(15, R%, 2) + agedst(16, R%, 2) + agedst(17, R%, 2) + agedst(18, R%, 2) + agedst(19, R%, 2) + agedst(20, R%, 2) + agedst(21, R%, 2)) * 1000000)\r"
  },
  {
    "Variable": "SVDTHSCHIL",
    "UsesVariable": "SVDTHSPOLICS",
    "Distance": 5,
    "Code": "\rpoptotalterm = (AdultMaleTerm + WomenTerm + ChildrenTerm)\r"
  },
  {
    "Variable": "SVDTHSCHIL",
    "UsesVariable": "SVDTHSSELFHARM",
    "Distance": 5,
    "Code": "\rpoptotalterm = (AdultMaleTerm + WomenTerm + ChildrenTerm)\r"
  },
  {
    "Variable": "SVDTHSCHILTOT",
    "UsesVariable": "SVDTHSCHIL",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSCHILTOT",
    "UsesVariable": "svdthsadd",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSCHILTOT",
    "UsesVariable": "POP",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSCONFLICT",
    "UsesVariable": "SVDTHSCONFLICTTOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSCONFLICT",
    "UsesVariable": "POP",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSCONFLICT",
    "UsesVariable": "svmulm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSCONFLICT",
    "UsesVariable": "SFINTLWARMAG",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSCONFLICT",
    "UsesVariable": "SVDTHSOTHERINTERPERSON",
    "Distance": 1,
    "Code": "\rChildrenTerm = (agedst(0, R%, 1) + agedst(0, R%, 2) + agedst(1, R%, 1) + agedst(1, R%, 2) + agedst(2, R%, 1) + agedst(2, R%, 2) + agedst(3, R%, 1) + agedst(3, R%, 2)) * 1000000\r\rWomenTerm = ((agedst(4, R%, 2) + agedst(5, R%, 2) + agedst(6, R%, 2) + agedst(7, R%, 2) + agedst(8, R%, 2) + agedst(9, R%, 2) + agedst(10, R%, 2) +\r                agedst(11, R%, 2) + agedst(12, R%, 2) + agedst(13, R%, 2) + agedst(14, R%, 2) + agedst(15, R%, 2) + agedst(16, R%, 2) + agedst(17, R%, 2) + agedst(18, R%, 2) + agedst(19, R%, 2) + agedst(20, R%, 2) + agedst(21, R%, 2)) * 1000000)\r\r'dkb 2020/02/24 *** end ***\r\r'kbn 2018/04/27 Start-Violence Model\r'kbn 2018/06/26- Start- Enter descriptions in code for violence model below\r'-----------Violence model (First Year)-----------------------\r'Violence model in the first year proceeds in following sequence\r'1. Create Population terms for total deaths using the age structure variables in the population model\r'2. Normalize deaths in the violence model to those in the population model if normalization switch is on or if violence forward linkage is on\r'3. Define shift factors for the violence model\r'4. Compute total number of deaths using the death rates and age structure calculated in 1. above\r'5. Recalculate total death rate using total number of deaths\r'6. Compute the HOMICIDE index for the first year\r'7. Save variable values for the first year\r'kbn 2018/06/26 End\r\r'1. kbn 2018/05/16 create population terms for total deaths computation using 'agedst' from POPULAT\rAdultMaleTerm = ((agedst(4, R%, 1) + agedst(5, R%, 1) + agedst(6, R%, 1) + agedst(7, R%, 1) + agedst(8, R%, 1) + agedst(9, R%, 1) + agedst(10, R%, 1) +\r                agedst(11, R%, 1) + agedst(12, R%, 1) + agedst(13, R%, 1) + agedst(14, R%, 1) + agedst(15, R%, 1) + agedst(16, R%, 1) + agedst(17, R%, 1) + agedst(18, R%, 1) + agedst(19, R%, 1) + agedst(20, R%, 1) + agedst(21, R%, 1)) * 1000000)\r\r'kbn 2018/05/16-End\r\r\r'2. kbn 2018/05/31-Start- Normalize violence deaths to Intentional Injuries in the Health Model\r' AdjustedViolenceTerm  is the total number of deaths from intentional injuries\r' SVTerm is the calculated value of societal violence deaths in the violence model\r'kbn 2018/06/26-Start Introduce normalization switch below\r\r\rIf svvionormsw > 0 Or svtohlsw > 0 Then\r\r\rAdjustedViolenceTerm = (SDEATHIntIj(R%) * 1000000)\rSVTerm = (((SSVDTHSOTHERINTERPERSON(R%) / 100000) * AdultMaleTerm + (SSVDTHSWOMEN(R%) / 100000) * WomenTerm + (SSVDTHSCHIL(R%) / 100000) * ChildrenTerm _\r                                                      + (SSVDTHSCONFLICT(R%) / 100000) * poptotalterm + (SSVDTHSPOLICS(R%) / 100000) * poptotalterm + (SSVDTHSSELFHARM(R%) / 100000) * poptotalterm) / poptotalterm) * 100000\r\rSVDTHSCONFLICT(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSCONFLICT(R%) * poptotalterm) / (SVTerm * poptotalterm))) / poptotalterm) * 100000)\rSVDTHSOTHERINTERPERSON(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSOTHERINTERPERSON(R%) * AdultMaleTerm) / (SVTerm * poptotalterm))) / AdultMaleTerm) * 100000)\rSVDTHSWOMENCHILDREN(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSWOMENCHILDREN(R%) * (WomenTerm + ChildrenTerm)) / (SVTerm * poptotalterm))) / (WomenTerm + ChildrenTerm)) * 100000)\rSVDTHSWOMEN(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSWOMEN(R%) * WomenTerm) / (SVTerm * poptotalterm))) / WomenTerm) * 100000)\rSVDTHSCHIL(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSCHIL(R%) * ChildrenTerm) / (SVTerm * poptotalterm))) / ChildrenTerm) * 100000)\rSVDTHSPOLICS(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSPOLICS(R%) * poptotalterm) / (SVTerm * poptotalterm))) / poptotalterm) * 100000)\rSVDTHSSELFHARM(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSSELFHARM(R%) * poptotalterm) / (SVTerm * poptotalterm))) / poptotalterm) * 100000)\r\rEnd If\r\rpoptotalterm = (AdultMaleTerm + WomenTerm + ChildrenTerm)\r\r'kbn 2018/05/16-End\r\r\r'2. kbn 2018/05/31-Start- Normalize violence deaths to Intentional Injuries in the Health Model\r' AdjustedViolenceTerm  is the total number of deaths from intentional injuries\r' SVTerm is the calculated value of societal violence deaths in the violence model\r'kbn 2018/06/26-Start Introduce normalization switch below\r\r\rIf svvionormsw > 0 Or svtohlsw > 0 Then\r\r\rAdjustedViolenceTerm = (SDEATHIntIj(R%) * 1000000)\rSVTerm = (((SSVDTHSOTHERINTERPERSON(R%) / 100000) * AdultMaleTerm + (SSVDTHSWOMEN(R%) / 100000) * WomenTerm + (SSVDTHSCHIL(R%) / 100000) * ChildrenTerm _\r                                                      + (SSVDTHSCONFLICT(R%) / 100000) * poptotalterm + (SSVDTHSPOLICS(R%) / 100000) * poptotalterm + (SSVDTHSSELFHARM(R%) / 100000) * poptotalterm) / poptotalterm) * 100000\r\rSVDTHSCONFLICT(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSCONFLICT(R%) * poptotalterm) / (SVTerm * poptotalterm))) / poptotalterm) * 100000)\rSVDTHSOTHERINTERPERSON(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSOTHERINTERPERSON(R%) * AdultMaleTerm) / (SVTerm * poptotalterm))) / AdultMaleTerm) * 100000)\rSVDTHSWOMENCHILDREN(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSWOMENCHILDREN(R%) * (WomenTerm + ChildrenTerm)) / (SVTerm * poptotalterm))) / (WomenTerm + ChildrenTerm)) * 100000)\rSVDTHSWOMEN(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSWOMEN(R%) * WomenTerm) / (SVTerm * poptotalterm))) / WomenTerm) * 100000)\rSVDTHSCHIL(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSCHIL(R%) * ChildrenTerm) / (SVTerm * poptotalterm))) / ChildrenTerm) * 100000)\rSVDTHSPOLICS(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSPOLICS(R%) * poptotalterm) / (SVTerm * poptotalterm))) / poptotalterm) * 100000)\rSVDTHSSELFHARM(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSSELFHARM(R%) * poptotalterm) / (SVTerm * poptotalterm))) / poptotalterm) * 100000)\r\rEnd If\r\r'kbn 2018/05/16-End\r\r\r'2. kbn 2018/05/31-Start- Normalize violence deaths to Intentional Injuries in the Health Model\r' AdjustedViolenceTerm  is the total number of deaths from intentional injuries\r' SVTerm is the calculated value of societal violence deaths in the violence model\r'kbn 2018/06/26-Start Introduce normalization switch below\r\r\rIf svvionormsw > 0 Or svtohlsw > 0 Then\r\r\rAdjustedViolenceTerm = (SDEATHIntIj(R%) * 1000000)\rSVTerm = (((SSVDTHSOTHERINTERPERSON(R%) / 100000) * AdultMaleTerm + (SSVDTHSWOMEN(R%) / 100000) * WomenTerm + (SSVDTHSCHIL(R%) / 100000) * ChildrenTerm _\r                                                      + (SSVDTHSCONFLICT(R%) / 100000) * poptotalterm + (SSVDTHSPOLICS(R%) / 100000) * poptotalterm + (SSVDTHSSELFHARM(R%) / 100000) * poptotalterm) / poptotalterm) * 100000\r\rSVDTHSCONFLICT(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSCONFLICT(R%) * poptotalterm) / (SVTerm * poptotalterm))) / poptotalterm) * 100000)\rSVDTHSOTHERINTERPERSON(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSOTHERINTERPERSON(R%) * AdultMaleTerm) / (SVTerm * poptotalterm))) / AdultMaleTerm) * 100000)\rSVDTHSWOMENCHILDREN(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSWOMENCHILDREN(R%) * (WomenTerm + ChildrenTerm)) / (SVTerm * poptotalterm))) / (WomenTerm + ChildrenTerm)) * 100000)\rSVDTHSWOMEN(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSWOMEN(R%) * WomenTerm) / (SVTerm * poptotalterm))) / WomenTerm) * 100000)\rSVDTHSCHIL(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSCHIL(R%) * ChildrenTerm) / (SVTerm * poptotalterm))) / ChildrenTerm) * 100000)\rSVDTHSPOLICS(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSPOLICS(R%) * poptotalterm) / (SVTerm * poptotalterm))) / poptotalterm) * 100000)\rSVDTHSSELFHARM(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSSELFHARM(R%) * poptotalterm) / (SVTerm * poptotalterm))) / poptotalterm) * 100000)\r\rEnd If\r"
  },
  {
    "Variable": "SVDTHSCONFLICT",
    "UsesVariable": "SVDTHSWOMEN",
    "Distance": 1,
    "Code": "\r'dkb 2020/02/24 *** end ***\r\r'kbn 2018/04/27 Start-Violence Model\r'kbn 2018/06/26- Start- Enter descriptions in code for violence model below\r'-----------Violence model (First Year)-----------------------\r'Violence model in the first year proceeds in following sequence\r'1. Create Population terms for total deaths using the age structure variables in the population model\r'2. Normalize deaths in the violence model to those in the population model if normalization switch is on or if violence forward linkage is on\r'3. Define shift factors for the violence model\r'4. Compute total number of deaths using the death rates and age structure calculated in 1. above\r'5. Recalculate total death rate using total number of deaths\r'6. Compute the HOMICIDE index for the first year\r'7. Save variable values for the first year\r'kbn 2018/06/26 End\r\r'1. kbn 2018/05/16 create population terms for total deaths computation using 'agedst' from POPULAT\rAdultMaleTerm = ((agedst(4, R%, 1) + agedst(5, R%, 1) + agedst(6, R%, 1) + agedst(7, R%, 1) + agedst(8, R%, 1) + agedst(9, R%, 1) + agedst(10, R%, 1) +\r                agedst(11, R%, 1) + agedst(12, R%, 1) + agedst(13, R%, 1) + agedst(14, R%, 1) + agedst(15, R%, 1) + agedst(16, R%, 1) + agedst(17, R%, 1) + agedst(18, R%, 1) + agedst(19, R%, 1) + agedst(20, R%, 1) + agedst(21, R%, 1)) * 1000000)\r"
  },
  {
    "Variable": "SVDTHSCONFLICT",
    "UsesVariable": "SVDTHSCHIL",
    "Distance": 1,
    "Code": "\rWomenTerm = ((agedst(4, R%, 2) + agedst(5, R%, 2) + agedst(6, R%, 2) + agedst(7, R%, 2) + agedst(8, R%, 2) + agedst(9, R%, 2) + agedst(10, R%, 2) +\r                agedst(11, R%, 2) + agedst(12, R%, 2) + agedst(13, R%, 2) + agedst(14, R%, 2) + agedst(15, R%, 2) + agedst(16, R%, 2) + agedst(17, R%, 2) + agedst(18, R%, 2) + agedst(19, R%, 2) + agedst(20, R%, 2) + agedst(21, R%, 2)) * 1000000)\r"
  },
  {
    "Variable": "SVDTHSCONFLICT",
    "UsesVariable": "SVDTHSPOLICS",
    "Distance": 1,
    "Code": "\rpoptotalterm = (AdultMaleTerm + WomenTerm + ChildrenTerm)\r\rChildrenTerm = (agedst(0, R%, 1) + agedst(0, R%, 2) + agedst(1, R%, 1) + agedst(1, R%, 2) + agedst(2, R%, 1) + agedst(2, R%, 2) + agedst(3, R%, 1) + agedst(3, R%, 2)) * 1000000\r"
  },
  {
    "Variable": "SVDTHSCONFLICT",
    "UsesVariable": "SVDTHSSELFHARM",
    "Distance": 1,
    "Code": "\rpoptotalterm = (AdultMaleTerm + WomenTerm + ChildrenTerm)\r"
  },
  {
    "Variable": "SVDTHSCONFLICTTOT",
    "UsesVariable": "SVDTHSCONFLICT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSCONFLICTTOT",
    "UsesVariable": "svdthsadd",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSCONFLICTTOT",
    "UsesVariable": "POP",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSOTHERINTERPERSON",
    "UsesVariable": "SVDTHSOTHERINTERTOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSOTHERINTERPERSON",
    "UsesVariable": "POP",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSOTHERINTERPERSON",
    "UsesVariable": "svmulm",
    "Distance": 0,
    "Code": "\rsHomicideEstimate(R%) = HomicideEstimate(R%)\r\r\r'SVDTHSOTHERINTERPERSON(R%) = Amin(AMAX(Exp(HomicideEst) + (HomicideShift(R%), 0, 100), 0.000001), 208) * svmulm(R%, 5)\r'SVDTHSOTHERINTERPERSON(R%) = Amin(AMAX(Exp(HomicideEst) * HomicideShift(R%), 0.00001), 208) * svmulm(R%, 5)\rHomicideEstimate(R%) = CSng(Amin(AMAX(Exp(HomicideEst), 0.000001), 208))\r\rSVDTHSOTHERINTERPERSON(R%) = SSVDTHSOTHERINTERPERSON(R%) * HomicideEstimate(R%) / sHomicideEstimate(R%) * svmulm(R%, 5)\r"
  },
  {
    "Variable": "SVDTHSOTHERINTERPERSON",
    "UsesVariable": "GINIDOM",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSOTHERINTERPERSON",
    "UsesVariable": "YTHBULGE",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSOTHERINTERPERSON",
    "UsesVariable": "SVDTHSWOMEN",
    "Distance": 2,
    "Code": "\r'dkb 2020/02/24 *** end ***\r\r'kbn 2018/04/27 Start-Violence Model\r'kbn 2018/06/26- Start- Enter descriptions in code for violence model below\r'-----------Violence model (First Year)-----------------------\r'Violence model in the first year proceeds in following sequence\r'1. Create Population terms for total deaths using the age structure variables in the population model\r'2. Normalize deaths in the violence model to those in the population model if normalization switch is on or if violence forward linkage is on\r'3. Define shift factors for the violence model\r'4. Compute total number of deaths using the death rates and age structure calculated in 1. above\r'5. Recalculate total death rate using total number of deaths\r'6. Compute the HOMICIDE index for the first year\r'7. Save variable values for the first year\r'kbn 2018/06/26 End\r\r'1. kbn 2018/05/16 create population terms for total deaths computation using 'agedst' from POPULAT\rAdultMaleTerm = ((agedst(4, R%, 1) + agedst(5, R%, 1) + agedst(6, R%, 1) + agedst(7, R%, 1) + agedst(8, R%, 1) + agedst(9, R%, 1) + agedst(10, R%, 1) +\r                agedst(11, R%, 1) + agedst(12, R%, 1) + agedst(13, R%, 1) + agedst(14, R%, 1) + agedst(15, R%, 1) + agedst(16, R%, 1) + agedst(17, R%, 1) + agedst(18, R%, 1) + agedst(19, R%, 1) + agedst(20, R%, 1) + agedst(21, R%, 1)) * 1000000)\r"
  },
  {
    "Variable": "SVDTHSOTHERINTERPERSON",
    "UsesVariable": "SVDTHSCHIL",
    "Distance": 2,
    "Code": "\rWomenTerm = ((agedst(4, R%, 2) + agedst(5, R%, 2) + agedst(6, R%, 2) + agedst(7, R%, 2) + agedst(8, R%, 2) + agedst(9, R%, 2) + agedst(10, R%, 2) +\r                agedst(11, R%, 2) + agedst(12, R%, 2) + agedst(13, R%, 2) + agedst(14, R%, 2) + agedst(15, R%, 2) + agedst(16, R%, 2) + agedst(17, R%, 2) + agedst(18, R%, 2) + agedst(19, R%, 2) + agedst(20, R%, 2) + agedst(21, R%, 2)) * 1000000)\r"
  },
  {
    "Variable": "SVDTHSOTHERINTERPERSON",
    "UsesVariable": "SVDTHSCONFLICT",
    "Distance": 2,
    "Code": "\rChildrenTerm = (agedst(0, R%, 1) + agedst(0, R%, 2) + agedst(1, R%, 1) + agedst(1, R%, 2) + agedst(2, R%, 1) + agedst(2, R%, 2) + agedst(3, R%, 1) + agedst(3, R%, 2)) * 1000000\r"
  },
  {
    "Variable": "SVDTHSOTHERINTERPERSON",
    "UsesVariable": "SVDTHSPOLICS",
    "Distance": 2,
    "Code": "\rpoptotalterm = (AdultMaleTerm + WomenTerm + ChildrenTerm)\r"
  },
  {
    "Variable": "SVDTHSOTHERINTERPERSON",
    "UsesVariable": "SVDTHSSELFHARM",
    "Distance": 2,
    "Code": "\rpoptotalterm = (AdultMaleTerm + WomenTerm + ChildrenTerm)\r"
  },
  {
    "Variable": "SVDTHSOTHERINTERTOT",
    "UsesVariable": "SVDTHSOTHERINTERPERSON",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSOTHERINTERTOT",
    "UsesVariable": "svdthsadd",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSOTHERINTERTOT",
    "UsesVariable": "POP",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSPOLICS",
    "UsesVariable": "SVDTHSPOLICSTOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSPOLICS",
    "UsesVariable": "POP",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSPOLICS",
    "UsesVariable": "svmulm",
    "Distance": 0,
    "Code": "\rsPoliceEstimate(R%) = PoliceEstimate(R%)\r\r\r\rPoliceEstimate(R%) = CSng(Amin(AMAX(Exp(Amin(PoliceVioEst, 3)), 0.000001), 2))\r\rSVDTHSPOLICS(R%) = SSVDTHSPOLICS(R%) * PoliceEstimate(R%) / sPoliceEstimate(R%) * svmulm(R%, 3)\r\r\r'jrs 2023/03/13\rIf SSVDTHSPOLICS(R%) > 0 Then\rIf SVDTHSPOLICS(R%) > SSVDTHSPOLICS(R%) And ((SVDTHSPOLICS(R%) - SSVDTHSPOLICS(R%)) / SSVDTHSPOLICS(R%)) > 0.02 Then\rSVDTHSPOLICS(R%) = CSng(SSVDTHSPOLICS(R%) * 1.02)\rEnd If\rEnd If\r"
  },
  {
    "Variable": "SVDTHSPOLICS",
    "UsesVariable": "SVDTHSOTHERINTERPERSON",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSPOLICS",
    "UsesVariable": "GOVCORRUPT",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSPOLICS",
    "UsesVariable": "SVDTHSWOMEN",
    "Distance": 6,
    "Code": "\r'dkb 2020/02/24 *** end ***\r\r'kbn 2018/04/27 Start-Violence Model\r'kbn 2018/06/26- Start- Enter descriptions in code for violence model below\r'-----------Violence model (First Year)-----------------------\r'Violence model in the first year proceeds in following sequence\r'1. Create Population terms for total deaths using the age structure variables in the population model\r'2. Normalize deaths in the violence model to those in the population model if normalization switch is on or if violence forward linkage is on\r'3. Define shift factors for the violence model\r'4. Compute total number of deaths using the death rates and age structure calculated in 1. above\r'5. Recalculate total death rate using total number of deaths\r'6. Compute the HOMICIDE index for the first year\r'7. Save variable values for the first year\r'kbn 2018/06/26 End\r\r'1. kbn 2018/05/16 create population terms for total deaths computation using 'agedst' from POPULAT\rAdultMaleTerm = ((agedst(4, R%, 1) + agedst(5, R%, 1) + agedst(6, R%, 1) + agedst(7, R%, 1) + agedst(8, R%, 1) + agedst(9, R%, 1) + agedst(10, R%, 1) +\r                agedst(11, R%, 1) + agedst(12, R%, 1) + agedst(13, R%, 1) + agedst(14, R%, 1) + agedst(15, R%, 1) + agedst(16, R%, 1) + agedst(17, R%, 1) + agedst(18, R%, 1) + agedst(19, R%, 1) + agedst(20, R%, 1) + agedst(21, R%, 1)) * 1000000)\r"
  },
  {
    "Variable": "SVDTHSPOLICS",
    "UsesVariable": "SVDTHSCHIL",
    "Distance": 6,
    "Code": "\rWomenTerm = ((agedst(4, R%, 2) + agedst(5, R%, 2) + agedst(6, R%, 2) + agedst(7, R%, 2) + agedst(8, R%, 2) + agedst(9, R%, 2) + agedst(10, R%, 2) +\r                agedst(11, R%, 2) + agedst(12, R%, 2) + agedst(13, R%, 2) + agedst(14, R%, 2) + agedst(15, R%, 2) + agedst(16, R%, 2) + agedst(17, R%, 2) + agedst(18, R%, 2) + agedst(19, R%, 2) + agedst(20, R%, 2) + agedst(21, R%, 2)) * 1000000)\r"
  },
  {
    "Variable": "SVDTHSPOLICS",
    "UsesVariable": "SVDTHSCONFLICT",
    "Distance": 6,
    "Code": "\rChildrenTerm = (agedst(0, R%, 1) + agedst(0, R%, 2) + agedst(1, R%, 1) + agedst(1, R%, 2) + agedst(2, R%, 1) + agedst(2, R%, 2) + agedst(3, R%, 1) + agedst(3, R%, 2)) * 1000000\r"
  },
  {
    "Variable": "SVDTHSPOLICS",
    "UsesVariable": "SVDTHSSELFHARM",
    "Distance": 6,
    "Code": "\rpoptotalterm = (AdultMaleTerm + WomenTerm + ChildrenTerm)\r"
  },
  {
    "Variable": "SVDTHSPOLICSTOT",
    "UsesVariable": "SVDTHSPOLICS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSPOLICSTOT",
    "UsesVariable": "svdthsadd",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSPOLICSTOT",
    "UsesVariable": "POP",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSSELFHARM",
    "UsesVariable": "SVDTHSSELFHARMTOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSSELFHARM",
    "UsesVariable": "POP",
    "Distance": 16,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSSELFHARM",
    "UsesVariable": "svmulm",
    "Distance": 0,
    "Code": "\rsSelfHarmEstimate(R%) = SelfHarmEstimate(R%)\r\rSelfHarmEstimate(R%) = SelfHarmEst\r\r'kbn 2018/05/17-End\r'kbn 2018/06/26 End\rSVDTHSSELFHARM(R%) = SSVDTHSSELFHARM(R%) * SelfHarmEstimate(R%) / sSelfHarmEstimate(R%) * svmulm(R%, 1)\r\r'SVDTHSSELFHARM(R%) = Amin(AMAX(SelfHarmEst * SelfHarmShift(R%), 0.000001), 53) * svmulm(R%, 1)\r\r'Since we are driving self harm,Police violence with deaths of women and children and homicides, we are retricting upward year on year growth to 2%\r'jrs 2023/03/13\rIf SVDTHSSELFHARM(R%) > 0 Then\rIf SVDTHSSELFHARM(R%) > SSVDTHSSELFHARM(R%) And ((SVDTHSSELFHARM(R%) - SSVDTHSSELFHARM(R%)) / SVDTHSSELFHARM(R%)) > 0.02 Then\rSVDTHSSELFHARM(R%) = CSng(SSVDTHSSELFHARM(R%) * 1.02)\rEnd If\rEnd If\r"
  },
  {
    "Variable": "SVDTHSSELFHARM",
    "UsesVariable": "SVDTHSWOMENCHILDREN",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSSELFHARM",
    "UsesVariable": "svvionormsw",
    "Distance": 0,
    "Code": "\r'kbn 2018/05/16-End\r\r\r'2. kbn 2018/05/31-Start- Normalize violence deaths to Intentional Injuries in the Health Model\r' AdjustedViolenceTerm  is the total number of deaths from intentional injuries\r' SVTerm is the calculated value of societal violence deaths in the violence model\r'kbn 2018/06/26-Start Introduce normalization switch below\r\r\rIf svvionormsw > 0 Or svtohlsw > 0 Then\r\r\rAdjustedViolenceTerm = (SDEATHIntIj(R%) * 1000000)\rSVTerm = (((SSVDTHSOTHERINTERPERSON(R%) / 100000) * AdultMaleTerm + (SSVDTHSWOMEN(R%) / 100000) * WomenTerm + (SSVDTHSCHIL(R%) / 100000) * ChildrenTerm _\r                                                      + (SSVDTHSCONFLICT(R%) / 100000) * poptotalterm + (SSVDTHSPOLICS(R%) / 100000) * poptotalterm + (SSVDTHSSELFHARM(R%) / 100000) * poptotalterm) / poptotalterm) * 100000\r\rSVDTHSCONFLICT(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSCONFLICT(R%) * poptotalterm) / (SVTerm * poptotalterm))) / poptotalterm) * 100000)\rSVDTHSOTHERINTERPERSON(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSOTHERINTERPERSON(R%) * AdultMaleTerm) / (SVTerm * poptotalterm))) / AdultMaleTerm) * 100000)\rSVDTHSWOMENCHILDREN(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSWOMENCHILDREN(R%) * (WomenTerm + ChildrenTerm)) / (SVTerm * poptotalterm))) / (WomenTerm + ChildrenTerm)) * 100000)\rSVDTHSWOMEN(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSWOMEN(R%) * WomenTerm) / (SVTerm * poptotalterm))) / WomenTerm) * 100000)\rSVDTHSCHIL(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSCHIL(R%) * ChildrenTerm) / (SVTerm * poptotalterm))) / ChildrenTerm) * 100000)\rSVDTHSPOLICS(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSPOLICS(R%) * poptotalterm) / (SVTerm * poptotalterm))) / poptotalterm) * 100000)\rSVDTHSSELFHARM(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSSELFHARM(R%) * poptotalterm) / (SVTerm * poptotalterm))) / poptotalterm) * 100000)\r\rEnd If\r\rpoptotalterm = (AdultMaleTerm + WomenTerm + ChildrenTerm)\r\r'kbn 2018/05/16-End\r\r\r'2. kbn 2018/05/31-Start- Normalize violence deaths to Intentional Injuries in the Health Model\r' AdjustedViolenceTerm  is the total number of deaths from intentional injuries\r' SVTerm is the calculated value of societal violence deaths in the violence model\r'kbn 2018/06/26-Start Introduce normalization switch below\r\r\rIf svvionormsw > 0 Or svtohlsw > 0 Then\r\r\rAdjustedViolenceTerm = (SDEATHIntIj(R%) * 1000000)\rSVTerm = (((SSVDTHSOTHERINTERPERSON(R%) / 100000) * AdultMaleTerm + (SSVDTHSWOMEN(R%) / 100000) * WomenTerm + (SSVDTHSCHIL(R%) / 100000) * ChildrenTerm _\r                                                      + (SSVDTHSCONFLICT(R%) / 100000) * poptotalterm + (SSVDTHSPOLICS(R%) / 100000) * poptotalterm + (SSVDTHSSELFHARM(R%) / 100000) * poptotalterm) / poptotalterm) * 100000\r\rSVDTHSCONFLICT(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSCONFLICT(R%) * poptotalterm) / (SVTerm * poptotalterm))) / poptotalterm) * 100000)\rSVDTHSOTHERINTERPERSON(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSOTHERINTERPERSON(R%) * AdultMaleTerm) / (SVTerm * poptotalterm))) / AdultMaleTerm) * 100000)\rSVDTHSWOMENCHILDREN(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSWOMENCHILDREN(R%) * (WomenTerm + ChildrenTerm)) / (SVTerm * poptotalterm))) / (WomenTerm + ChildrenTerm)) * 100000)\rSVDTHSWOMEN(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSWOMEN(R%) * WomenTerm) / (SVTerm * poptotalterm))) / WomenTerm) * 100000)\rSVDTHSCHIL(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSCHIL(R%) * ChildrenTerm) / (SVTerm * poptotalterm))) / ChildrenTerm) * 100000)\rSVDTHSPOLICS(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSPOLICS(R%) * poptotalterm) / (SVTerm * poptotalterm))) / poptotalterm) * 100000)\rSVDTHSSELFHARM(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSSELFHARM(R%) * poptotalterm) / (SVTerm * poptotalterm))) / poptotalterm) * 100000)\r\rEnd If\r\r'kbn 2018/05/16-End\r\r\r'2. kbn 2018/05/31-Start- Normalize violence deaths to Intentional Injuries in the Health Model\r' AdjustedViolenceTerm  is the total number of deaths from intentional injuries\r' SVTerm is the calculated value of societal violence deaths in the violence model\r'kbn 2018/06/26-Start Introduce normalization switch below\r\r\rIf svvionormsw > 0 Or svtohlsw > 0 Then\r\r\rAdjustedViolenceTerm = (SDEATHIntIj(R%) * 1000000)\rSVTerm = (((SSVDTHSOTHERINTERPERSON(R%) / 100000) * AdultMaleTerm + (SSVDTHSWOMEN(R%) / 100000) * WomenTerm + (SSVDTHSCHIL(R%) / 100000) * ChildrenTerm _\r                                                      + (SSVDTHSCONFLICT(R%) / 100000) * poptotalterm + (SSVDTHSPOLICS(R%) / 100000) * poptotalterm + (SSVDTHSSELFHARM(R%) / 100000) * poptotalterm) / poptotalterm) * 100000\r\rSVDTHSCONFLICT(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSCONFLICT(R%) * poptotalterm) / (SVTerm * poptotalterm))) / poptotalterm) * 100000)\rSVDTHSOTHERINTERPERSON(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSOTHERINTERPERSON(R%) * AdultMaleTerm) / (SVTerm * poptotalterm))) / AdultMaleTerm) * 100000)\rSVDTHSWOMENCHILDREN(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSWOMENCHILDREN(R%) * (WomenTerm + ChildrenTerm)) / (SVTerm * poptotalterm))) / (WomenTerm + ChildrenTerm)) * 100000)\rSVDTHSWOMEN(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSWOMEN(R%) * WomenTerm) / (SVTerm * poptotalterm))) / WomenTerm) * 100000)\rSVDTHSCHIL(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSCHIL(R%) * ChildrenTerm) / (SVTerm * poptotalterm))) / ChildrenTerm) * 100000)\rSVDTHSPOLICS(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSPOLICS(R%) * poptotalterm) / (SVTerm * poptotalterm))) / poptotalterm) * 100000)\rSVDTHSSELFHARM(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSSELFHARM(R%) * poptotalterm) / (SVTerm * poptotalterm))) / poptotalterm) * 100000)\r\rEnd If\r"
  },
  {
    "Variable": "SVDTHSSELFHARM",
    "UsesVariable": "svtohlsw",
    "Distance": 0,
    "Code": "\r'kbn 2018/05/16-End\r\r\r'2. kbn 2018/05/31-Start- Normalize violence deaths to Intentional Injuries in the Health Model\r' AdjustedViolenceTerm  is the total number of deaths from intentional injuries\r' SVTerm is the calculated value of societal violence deaths in the violence model\r'kbn 2018/06/26-Start Introduce normalization switch below\r\r\rIf svvionormsw > 0 Or svtohlsw > 0 Then\r\r\rAdjustedViolenceTerm = (SDEATHIntIj(R%) * 1000000)\rSVTerm = (((SSVDTHSOTHERINTERPERSON(R%) / 100000) * AdultMaleTerm + (SSVDTHSWOMEN(R%) / 100000) * WomenTerm + (SSVDTHSCHIL(R%) / 100000) * ChildrenTerm _\r                                                      + (SSVDTHSCONFLICT(R%) / 100000) * poptotalterm + (SSVDTHSPOLICS(R%) / 100000) * poptotalterm + (SSVDTHSSELFHARM(R%) / 100000) * poptotalterm) / poptotalterm) * 100000\r\rSVDTHSCONFLICT(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSCONFLICT(R%) * poptotalterm) / (SVTerm * poptotalterm))) / poptotalterm) * 100000)\rSVDTHSOTHERINTERPERSON(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSOTHERINTERPERSON(R%) * AdultMaleTerm) / (SVTerm * poptotalterm))) / AdultMaleTerm) * 100000)\rSVDTHSWOMENCHILDREN(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSWOMENCHILDREN(R%) * (WomenTerm + ChildrenTerm)) / (SVTerm * poptotalterm))) / (WomenTerm + ChildrenTerm)) * 100000)\rSVDTHSWOMEN(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSWOMEN(R%) * WomenTerm) / (SVTerm * poptotalterm))) / WomenTerm) * 100000)\rSVDTHSCHIL(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSCHIL(R%) * ChildrenTerm) / (SVTerm * poptotalterm))) / ChildrenTerm) * 100000)\rSVDTHSPOLICS(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSPOLICS(R%) * poptotalterm) / (SVTerm * poptotalterm))) / poptotalterm) * 100000)\rSVDTHSSELFHARM(R%) = CSng(((AdjustedViolenceTerm * ((SVDTHSSELFHARM(R%) * poptotalterm) / (SVTerm * poptotalterm))) / poptotalterm) * 100000)\r\rEnd If\r"
  },
  {
    "Variable": "SVDTHSSELFHARM",
    "UsesVariable": "SVDTHSOTHERINTERPERSON",
    "Distance": 7,
    "Code": "\rChildrenTerm = (agedst(0, R%, 1) + agedst(0, R%, 2) + agedst(1, R%, 1) + agedst(1, R%, 2) + agedst(2, R%, 1) + agedst(2, R%, 2) + agedst(3, R%, 1) + agedst(3, R%, 2)) * 1000000\r\rWomenTerm = ((agedst(4, R%, 2) + agedst(5, R%, 2) + agedst(6, R%, 2) + agedst(7, R%, 2) + agedst(8, R%, 2) + agedst(9, R%, 2) + agedst(10, R%, 2) +\r                agedst(11, R%, 2) + agedst(12, R%, 2) + agedst(13, R%, 2) + agedst(14, R%, 2) + agedst(15, R%, 2) + agedst(16, R%, 2) + agedst(17, R%, 2) + agedst(18, R%, 2) + agedst(19, R%, 2) + agedst(20, R%, 2) + agedst(21, R%, 2)) * 1000000)\r\r'dkb 2020/02/24 *** end ***\r\r'kbn 2018/04/27 Start-Violence Model\r'kbn 2018/06/26- Start- Enter descriptions in code for violence model below\r'-----------Violence model (First Year)-----------------------\r'Violence model in the first year proceeds in following sequence\r'1. Create Population terms for total deaths using the age structure variables in the population model\r'2. Normalize deaths in the violence model to those in the population model if normalization switch is on or if violence forward linkage is on\r'3. Define shift factors for the violence model\r'4. Compute total number of deaths using the death rates and age structure calculated in 1. above\r'5. Recalculate total death rate using total number of deaths\r'6. Compute the HOMICIDE index for the first year\r'7. Save variable values for the first year\r'kbn 2018/06/26 End\r\r'1. kbn 2018/05/16 create population terms for total deaths computation using 'agedst' from POPULAT\rAdultMaleTerm = ((agedst(4, R%, 1) + agedst(5, R%, 1) + agedst(6, R%, 1) + agedst(7, R%, 1) + agedst(8, R%, 1) + agedst(9, R%, 1) + agedst(10, R%, 1) +\r                agedst(11, R%, 1) + agedst(12, R%, 1) + agedst(13, R%, 1) + agedst(14, R%, 1) + agedst(15, R%, 1) + agedst(16, R%, 1) + agedst(17, R%, 1) + agedst(18, R%, 1) + agedst(19, R%, 1) + agedst(20, R%, 1) + agedst(21, R%, 1)) * 1000000)\r"
  },
  {
    "Variable": "SVDTHSSELFHARM",
    "UsesVariable": "SVDTHSWOMEN",
    "Distance": 7,
    "Code": "\r'dkb 2020/02/24 *** end ***\r\r'kbn 2018/04/27 Start-Violence Model\r'kbn 2018/06/26- Start- Enter descriptions in code for violence model below\r'-----------Violence model (First Year)-----------------------\r'Violence model in the first year proceeds in following sequence\r'1. Create Population terms for total deaths using the age structure variables in the population model\r'2. Normalize deaths in the violence model to those in the population model if normalization switch is on or if violence forward linkage is on\r'3. Define shift factors for the violence model\r'4. Compute total number of deaths using the death rates and age structure calculated in 1. above\r'5. Recalculate total death rate using total number of deaths\r'6. Compute the HOMICIDE index for the first year\r'7. Save variable values for the first year\r'kbn 2018/06/26 End\r\r'1. kbn 2018/05/16 create population terms for total deaths computation using 'agedst' from POPULAT\rAdultMaleTerm = ((agedst(4, R%, 1) + agedst(5, R%, 1) + agedst(6, R%, 1) + agedst(7, R%, 1) + agedst(8, R%, 1) + agedst(9, R%, 1) + agedst(10, R%, 1) +\r                agedst(11, R%, 1) + agedst(12, R%, 1) + agedst(13, R%, 1) + agedst(14, R%, 1) + agedst(15, R%, 1) + agedst(16, R%, 1) + agedst(17, R%, 1) + agedst(18, R%, 1) + agedst(19, R%, 1) + agedst(20, R%, 1) + agedst(21, R%, 1)) * 1000000)\r"
  },
  {
    "Variable": "SVDTHSSELFHARM",
    "UsesVariable": "SVDTHSCHIL",
    "Distance": 7,
    "Code": "\rWomenTerm = ((agedst(4, R%, 2) + agedst(5, R%, 2) + agedst(6, R%, 2) + agedst(7, R%, 2) + agedst(8, R%, 2) + agedst(9, R%, 2) + agedst(10, R%, 2) +\r                agedst(11, R%, 2) + agedst(12, R%, 2) + agedst(13, R%, 2) + agedst(14, R%, 2) + agedst(15, R%, 2) + agedst(16, R%, 2) + agedst(17, R%, 2) + agedst(18, R%, 2) + agedst(19, R%, 2) + agedst(20, R%, 2) + agedst(21, R%, 2)) * 1000000)\r"
  },
  {
    "Variable": "SVDTHSSELFHARM",
    "UsesVariable": "SVDTHSCONFLICT",
    "Distance": 7,
    "Code": "\rChildrenTerm = (agedst(0, R%, 1) + agedst(0, R%, 2) + agedst(1, R%, 1) + agedst(1, R%, 2) + agedst(2, R%, 1) + agedst(2, R%, 2) + agedst(3, R%, 1) + agedst(3, R%, 2)) * 1000000\r"
  },
  {
    "Variable": "SVDTHSSELFHARM",
    "UsesVariable": "SVDTHSPOLICS",
    "Distance": 7,
    "Code": "\rpoptotalterm = (AdultMaleTerm + WomenTerm + ChildrenTerm)\r"
  },
  {
    "Variable": "SVDTHSSELFHARMTOT",
    "UsesVariable": "SVDTHSSELFHARM",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSSELFHARMTOT",
    "UsesVariable": "svdthsadd",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSSELFHARMTOT",
    "UsesVariable": "POP",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSSOCIETALVIOLENCETOT",
    "UsesVariable": "SVDTHSOTHERINTERTOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSSOCIETALVIOLENCETOT",
    "UsesVariable": "SVDTHSPOLICSTOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSSOCIETALVIOLENCETOT",
    "UsesVariable": "SVDTHSCHILTOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSSOCIETALVIOLENCETOT",
    "UsesVariable": "SVDTHSWOMENTOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSSOCIETALVIOLENCETOT",
    "UsesVariable": "SVDTHSSELFHARMTOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSSOCIETALVIOLENCETOT",
    "UsesVariable": "SVDTHSCONFLICTTOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSSOCIETALVIOLENCETOT",
    "UsesVariable": "svdthsadd",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSWOMEN",
    "UsesVariable": "SVDTHSWOMENTOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSWOMEN",
    "UsesVariable": "POP",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSWOMEN",
    "UsesVariable": "svmulm",
    "Distance": 0,
    "Code": "\r\rWomenshift(R%) = CSng(SVDTHSWOMEN(R%) / (Amin(AMAX(Exp(WomenEst), 0.000001), 21)))\r\r'3a. Violence against women\r'Call AnalFunc(\"Interpersonal deaths per 100000 people\", Array(GINIDOM(R%) * 100, YTHBULGE(R%) * 100), WomenEst, Array(\"GINIDOM\", \"Youthbulge\"))\r\rCall AnalFunc(\"Interpersonal deaths per 100000 people\",\r                    New Single() {GINIDOM(R%) * 100, YTHBULGE(R%) * 100}, WomenEst,\r                    New String() {\"GINIDOM\", \"Youthbulge\"}, context)\r\r\rSVDTHSWOMEN(R%) = CSng(Amin(AMAX(Exp(WomenEst) * Womenshift(R%), 0.00001), 21) * svmulm(R%, 4))\r"
  },
  {
    "Variable": "SVDTHSWOMEN",
    "UsesVariable": "GINIDOM",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSWOMEN",
    "UsesVariable": "YTHBULGE",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSWOMEN",
    "UsesVariable": "SVDTHSOTHERINTERPERSON",
    "Distance": 4,
    "Code": "\rpoptotalterm = (AdultMaleTerm + WomenTerm + ChildrenTerm)\r"
  },
  {
    "Variable": "SVDTHSWOMEN",
    "UsesVariable": "SVDTHSCHIL",
    "Distance": 4,
    "Code": "\rWomenTerm = ((agedst(4, R%, 2) + agedst(5, R%, 2) + agedst(6, R%, 2) + agedst(7, R%, 2) + agedst(8, R%, 2) + agedst(9, R%, 2) + agedst(10, R%, 2) +\r                agedst(11, R%, 2) + agedst(12, R%, 2) + agedst(13, R%, 2) + agedst(14, R%, 2) + agedst(15, R%, 2) + agedst(16, R%, 2) + agedst(17, R%, 2) + agedst(18, R%, 2) + agedst(19, R%, 2) + agedst(20, R%, 2) + agedst(21, R%, 2)) * 1000000)\r\r'dkb 2020/02/24 *** end ***\r\r'kbn 2018/04/27 Start-Violence Model\r'kbn 2018/06/26- Start- Enter descriptions in code for violence model below\r'-----------Violence model (First Year)-----------------------\r'Violence model in the first year proceeds in following sequence\r'1. Create Population terms for total deaths using the age structure variables in the population model\r'2. Normalize deaths in the violence model to those in the population model if normalization switch is on or if violence forward linkage is on\r'3. Define shift factors for the violence model\r'4. Compute total number of deaths using the death rates and age structure calculated in 1. above\r'5. Recalculate total death rate using total number of deaths\r'6. Compute the HOMICIDE index for the first year\r'7. Save variable values for the first year\r'kbn 2018/06/26 End\r\r'1. kbn 2018/05/16 create population terms for total deaths computation using 'agedst' from POPULAT\rAdultMaleTerm = ((agedst(4, R%, 1) + agedst(5, R%, 1) + agedst(6, R%, 1) + agedst(7, R%, 1) + agedst(8, R%, 1) + agedst(9, R%, 1) + agedst(10, R%, 1) +\r                agedst(11, R%, 1) + agedst(12, R%, 1) + agedst(13, R%, 1) + agedst(14, R%, 1) + agedst(15, R%, 1) + agedst(16, R%, 1) + agedst(17, R%, 1) + agedst(18, R%, 1) + agedst(19, R%, 1) + agedst(20, R%, 1) + agedst(21, R%, 1)) * 1000000)\r"
  },
  {
    "Variable": "SVDTHSWOMEN",
    "UsesVariable": "SVDTHSCONFLICT",
    "Distance": 4,
    "Code": "\rChildrenTerm = (agedst(0, R%, 1) + agedst(0, R%, 2) + agedst(1, R%, 1) + agedst(1, R%, 2) + agedst(2, R%, 1) + agedst(2, R%, 2) + agedst(3, R%, 1) + agedst(3, R%, 2)) * 1000000\r"
  },
  {
    "Variable": "SVDTHSWOMEN",
    "UsesVariable": "SVDTHSPOLICS",
    "Distance": 4,
    "Code": "\rpoptotalterm = (AdultMaleTerm + WomenTerm + ChildrenTerm)\r"
  },
  {
    "Variable": "SVDTHSWOMEN",
    "UsesVariable": "SVDTHSSELFHARM",
    "Distance": 4,
    "Code": "\rpoptotalterm = (AdultMaleTerm + WomenTerm + ChildrenTerm)\r"
  },
  {
    "Variable": "SVDTHSWOMENCHILDREN",
    "UsesVariable": "svmulm",
    "Distance": 0,
    "Code": "\rsHomicideEstimate(R%) = HomicideEstimate(R%)\r\r\r'SVDTHSOTHERINTERPERSON(R%) = Amin(AMAX(Exp(HomicideEst) + (HomicideShift(R%), 0, 100), 0.000001), 208) * svmulm(R%, 5)\r'SVDTHSOTHERINTERPERSON(R%) = Amin(AMAX(Exp(HomicideEst) * HomicideShift(R%), 0.00001), 208) * svmulm(R%, 5)\rHomicideEstimate(R%) = CSng(Amin(AMAX(Exp(HomicideEst), 0.000001), 208))\r\r\r\r'SVDTHSWOMENCHILDREN(R%) = Amin(AMAX(Exp(WomenandChilEst) + ConvergeOverTime(WomenandChilshift(R%), 0, 100), 0.000001), 21) * svmulm(R%, 4)\r'SVDTHSWOMENCHILDREN(R%) = Amin(AMAX(Exp(WomenandChilEst) * WomenandChilshift(R%), 0.00001), 21) * svmulm(R%, 4)\rSVDTHSWOMENCHILDREN(R%) = SSVDTHSWOMENCHILDREN(R%) * HomicideEstimate(R%) / sHomicideEstimate(R%) * svmulm(R%, 4)\r"
  },
  {
    "Variable": "SVDTHSWOMENCHILDREN",
    "UsesVariable": "GINIDOM",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSWOMENCHILDREN",
    "UsesVariable": "YTHBULGE",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSWOMENCHILDREN",
    "UsesVariable": "POP",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSWOMENCHILDREN",
    "UsesVariable": "SVDTHSOTHERINTERPERSON",
    "Distance": 3,
    "Code": "\rpoptotalterm = (AdultMaleTerm + WomenTerm + ChildrenTerm)\r"
  },
  {
    "Variable": "SVDTHSWOMENCHILDREN",
    "UsesVariable": "SVDTHSWOMEN",
    "Distance": 3,
    "Code": "\r'dkb 2020/02/24 *** end ***\r\r'kbn 2018/04/27 Start-Violence Model\r'kbn 2018/06/26- Start- Enter descriptions in code for violence model below\r'-----------Violence model (First Year)-----------------------\r'Violence model in the first year proceeds in following sequence\r'1. Create Population terms for total deaths using the age structure variables in the population model\r'2. Normalize deaths in the violence model to those in the population model if normalization switch is on or if violence forward linkage is on\r'3. Define shift factors for the violence model\r'4. Compute total number of deaths using the death rates and age structure calculated in 1. above\r'5. Recalculate total death rate using total number of deaths\r'6. Compute the HOMICIDE index for the first year\r'7. Save variable values for the first year\r'kbn 2018/06/26 End\r\r'1. kbn 2018/05/16 create population terms for total deaths computation using 'agedst' from POPULAT\rAdultMaleTerm = ((agedst(4, R%, 1) + agedst(5, R%, 1) + agedst(6, R%, 1) + agedst(7, R%, 1) + agedst(8, R%, 1) + agedst(9, R%, 1) + agedst(10, R%, 1) +\r                agedst(11, R%, 1) + agedst(12, R%, 1) + agedst(13, R%, 1) + agedst(14, R%, 1) + agedst(15, R%, 1) + agedst(16, R%, 1) + agedst(17, R%, 1) + agedst(18, R%, 1) + agedst(19, R%, 1) + agedst(20, R%, 1) + agedst(21, R%, 1)) * 1000000)\r"
  },
  {
    "Variable": "SVDTHSWOMENCHILDREN",
    "UsesVariable": "SVDTHSCHIL",
    "Distance": 3,
    "Code": "\rWomenTerm = ((agedst(4, R%, 2) + agedst(5, R%, 2) + agedst(6, R%, 2) + agedst(7, R%, 2) + agedst(8, R%, 2) + agedst(9, R%, 2) + agedst(10, R%, 2) +\r                agedst(11, R%, 2) + agedst(12, R%, 2) + agedst(13, R%, 2) + agedst(14, R%, 2) + agedst(15, R%, 2) + agedst(16, R%, 2) + agedst(17, R%, 2) + agedst(18, R%, 2) + agedst(19, R%, 2) + agedst(20, R%, 2) + agedst(21, R%, 2)) * 1000000)\r"
  },
  {
    "Variable": "SVDTHSWOMENCHILDREN",
    "UsesVariable": "SVDTHSCONFLICT",
    "Distance": 3,
    "Code": "\rChildrenTerm = (agedst(0, R%, 1) + agedst(0, R%, 2) + agedst(1, R%, 1) + agedst(1, R%, 2) + agedst(2, R%, 1) + agedst(2, R%, 2) + agedst(3, R%, 1) + agedst(3, R%, 2)) * 1000000\r"
  },
  {
    "Variable": "SVDTHSWOMENCHILDREN",
    "UsesVariable": "SVDTHSPOLICS",
    "Distance": 3,
    "Code": "\rpoptotalterm = (AdultMaleTerm + WomenTerm + ChildrenTerm)\r"
  },
  {
    "Variable": "SVDTHSWOMENCHILDREN",
    "UsesVariable": "SVDTHSSELFHARM",
    "Distance": 3,
    "Code": "\rpoptotalterm = (AdultMaleTerm + WomenTerm + ChildrenTerm)\r"
  },
  {
    "Variable": "SVDTHSWOMENTOT",
    "UsesVariable": "SVDTHSWOMEN",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSWOMENTOT",
    "UsesVariable": "svdthsadd",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "SVDTHSWOMENTOT",
    "UsesVariable": "POP",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "TAXRA",
    "UsesVariable": "GOVREV",
    "Distance": 0,
    "Code": "\r\rPrivate Sub AggrRev(R As Integer)\r'mti 2017/03/16 New Proc\r\rSSWELTAX(R%) = HHGOVSS(R%, Unskilled) + HHGOVSS(R%, Skilled) + FIRMGOVSS(R%)\rGOVREV(R%) = HHTAX(R%, Unskilled) + HHTAX(R%, Skilled) + FIRMTAX(R%) +\r            INDIRECTTAX(R%) + SSWELTAX(R%)\r'bbh 2019/09/13 start\rFor S% = 1 To NSec%\r'GOVREV(R%) = GOVREV(R%) + MTARIFFREV(R%, S%)\rGOVREV(R%) = GOVREV(R%) + SMTariffRev(R%, S%) 'dkb 2019/10/22\rNext S%\r'bbh 2019/09/13 end\rTAXRA(R%) = GOVREV(R%) / AMAX(0.0001, GDPPOTRPA(R%))\rGOVREVDOM(R%) = GOVREV(R%)\rIf AID(R%) > 0 Then GOVREV(R%) = GOVREV(R%) + AID(R%) 'Receipts\r\r'GrantPortion = AID(R%) * (1 - aidlp)\r'GOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%)\r'bbh 2022/12/20 Register net flows on revenue side; not done on either side in preprocessor\rGOVREV(R%) = GOVREV(R%) + XWBLNFIN(R%) + XIMFCRFIN(R%) - XWBLNFOUT(R%) - XIMFCRFOUT(R%)\r\r\rEnd Sub\r"
  },
  {
    "Variable": "TAXRA",
    "UsesVariable": "GDP",
    "Distance": 1239,
    "Code": "\rGDPPOTRPA(R%) = GDP(R%)\r"
  },
  {
    "Variable": "TEFF",
    "UsesVariable": "CLIMECONIMP",
    "Distance": 5,
    "Code": "\r'bbh 2021/05/15 end\r\r'mti 2014/11/27 - start\r\r'bbh 2019/03/15 start\r'tefinfadjm(R%) = 0 'bbh 2023/12/06 test\rInfImpTEF = TefInfAdjustFac * tefinfadjm(R%)\r\rtef(R%, S%) = tef(R%, S%) * (1 + MFPGROWTH(R%, S%))\r\r'mti 2014/11/27 - end\r\r'   All but First 1:  TEF Adjustment Factor from Climate Change\r'   --------------------------------------------------------------------------------\r'bbh 2019/03/15 moved climate change here from inside loop only for exogenous growth rates\r\r'climeconimpstk = 10 'bbh 2023/12/06 probably raise limit on parameter in IFsvar and change in files\r\rClimImpTEF = SClimEconImp(R%) / 100 * climeconimpstk 'bbh 2020/02/24 two lines\r\r'tef(R%, S%) = tef(R%, S%) * (1 + TefInfAdjustFac * tefinfadjm(R%))\rtef(R%, S%) = tef(R%, S%) * (1 + InfImpTEF)\r\r'ClimImpTEF = -SClimEconImp(R%) / 100 * climeconimpstk\r'tef(R%, S%) = tef(R%, S%) * (1 - SClimEconImp(R%) / 100 * climeconimpstk)\r'bbh 2020/02/24 start\r'The impact on tef is cumulative across time; hence the impact of climate on tef each year\r'   should probably be only the increasing impact of climate change, not the cumulative\r'   from year 1; otherwise double counting/compounding\rtef(R%, S%) = tef(R%, S%) * (1 - (ClimImpTEF - SClimImpTEF(R%, S%)))\r\r'bbh 2019/03/15 end\rtef(R%, S%) = AMAX(0.01, Amin(tef(R%, S%), 100000))\r\r\r'mti October 03, 2011 -start\rTEFF(R%, S%) = tef(R%, S%)\r"
  },
  {
    "Variable": "TEFF",
    "UsesVariable": "climeconimpstk",
    "Distance": 5,
    "Code": "\r'bbh 2021/05/15 end\r\r'mti 2014/11/27 - start\r\r'bbh 2019/03/15 start\r'tefinfadjm(R%) = 0 'bbh 2023/12/06 test\rInfImpTEF = TefInfAdjustFac * tefinfadjm(R%)\r"
  },
  {
    "Variable": "TEFF",
    "UsesVariable": "MFPGROWTH",
    "Distance": 11,
    "Code": "\r'If GRPS(1, R) = \"Sudan South\" Then Stop\rFor S% = 1 To NSec%\rtef(R%, S%) = 1\r\r'mti October 03, 2011 -start\rTEFF(R%, S%) = tef(R%, S%)\r'mti October 03, 2011 - end\r\r'   First Year:  Expenditure Sums\r'   -----------------------------\rC(R%) = C(R%) + CS(R%, S%)\rGOVCON(R%) = GOVCON(R%) + GS(R%, S%)\r'If RegName$(R%) = \"China\" Then Stop\rI(R%) = I(R%) + INVS(R%, S%)\rCAPUT(R%, S%) = caputtar\r'SCAPUT(r%, s%) = caputtar 'bbh 2020/07/15\rNext S%\rCOMPLETE STRUCTURE:Next S%:5771|COMPLETE STRUCTURE:End If:5771|\r'jrs 2016/09/22 *** end ***\r\r'bbh 2020/12/17 start\rFor S% = 1 To NSec%\rIf ((S% > Ener) Or (S% = Agri And agon < 0.9) Or (S% = Ener And enon < 0.9)) Then\r'bbh 2020/08/26 start\r'If gdprext(R%) > -70 Then 'shock period; divide shock between downward TEF and CAPUT\r'If GRPS(1, R%) = \"Mongolia\" And S% = 3 And IY% >= 2 Then Stop\rIf (IY% - 1 + FirstYear < 2020) Or (IY% - 1 + FirstYear > 2021) Then 'Non shock years\r'If IY% <= 5 Then\r'Found that dividing \"error\" between tef and CAPUT in years before 2020 was making the error\r'continue to grow across some countries like Angola over time becuase VADD equation was continuing to diverge\r'from gdprext; these changes were being made to facilitate COVID shock analysis in 2020 and 2021 so\r'divided period of gdprext growth into shock years (2020-21) and other; should be ok if base year changes\r'may wish to handle via parameter\r'bbh 2020/11/14 start wrapped else TEF line in if-then-else\r'                        If (gdprext(R%) >= -65) And (IY% - 1 + FirstYear > 2021) Then\r'                            'If still exogenous, recognize that tef adjustment needed already offset by CAPUT change\r'                            tef(R%, S%) = tef(R%, S%) * (1 + adjgr + (caputtar - CAPUT(R%, S%)))\r'                        Else\rIf (IY% - 1 + FirstYear > 2021) Then 'All adjustment is to TEF when exogenous years extend past shock\r'assumes exogenous is properly adjusting GDP in subsequent years for shock impact and recovery\rtef(R%, S%) = tef(R%, S%) * (1 + adjgr)\rCAPUT(R%, S%) = caputtar\rSCAPUT(R%, S%) = CAPUT(R%, S%)\rElse 'before 2020\rtef(R%, S%) = tef(R%, S%) * (1 + adjgr)\rEnd If\r'                        End If\r'bbh 2020/11/14 end\rElse 'for 2020 and 2021 only; could generalize with new parameter that indicated econshockyr\r'bbh 2020/10/14 start; from hard-coded to parameter use\rIf COVIDShock < 1 Then  '2020-2021 not COVID shock years (as in No COVID scenario and for unaffected countries)\rtef(R%, S%) = tef(R%, S%) * (1 + adjgr)\rCAPUT(R%, S%) = caputtar\rSCAPUT(R%, S%) = CAPUT(R%, S%)\rElse '2020-2021 COVID shock years\rtef(R%, S%) = tef(R%, S%) * (1 + adjgr * tfpshockadjshr(R%))\rCAPUT(R%, S%) = CAPUT(R%, S%) * (1 + adjgr * (1 - tfpshockadjshr(R%)))\rIf IY% - 1 + FirstYear = 2020 Then\rSCAPUT(R%, S%) = caputtar 'Cannot carry forward a shock-year catch-up to VADD; is lost production\rElse 'This approach basically assumes that 2021 year in pandemic is not so affected by extraordinary CAPUT reduction\rSCAPUT(R%, S%) = CAPUT(R%, S%)\rEnd If\rEnd If\r\r'                        tef(R%, S%) = tef(R%, S%) * (1 + adjgr * 0.2)\r'                        CAPUT(R%, S%) = CAPUT(R%, S%) * (1 + adjgr * 0.8)\r'bbh 2020/10/14 start;\rEnd If\r\r'jrs 2016/09/22 *** end ***\r\r'bbh 2020/12/17 start\rFor S% = 1 To NSec%\rIf ((S% > Ener) Or (S% = Agri And agon < 0.9) Or (S% = Ener And enon < 0.9)) Then\r'bbh 2020/08/26 start\r'If gdprext(R%) > -70 Then 'shock period; divide shock between downward TEF and CAPUT\r'If GRPS(1, R%) = \"Mongolia\" And S% = 3 And IY% >= 2 Then Stop\rIf (IY% - 1 + FirstYear < 2020) Or (IY% - 1 + FirstYear > 2021) Then 'Non shock years\r'If IY% <= 5 Then\r'Found that dividing \"error\" between tef and CAPUT in years before 2020 was making the error\r'continue to grow across some countries like Angola over time becuase VADD equation was continuing to diverge\r'from gdprext; these changes were being made to facilitate COVID shock analysis in 2020 and 2021 so\r'divided period of gdprext growth into shock years (2020-21) and other; should be ok if base year changes\r'may wish to handle via parameter\r'bbh 2020/11/14 start wrapped else TEF line in if-then-else\r'                        If (gdprext(R%) >= -65) And (IY% - 1 + FirstYear > 2021) Then\r'                            'If still exogenous, recognize that tef adjustment needed already offset by CAPUT change\r'                            tef(R%, S%) = tef(R%, S%) * (1 + adjgr + (caputtar - CAPUT(R%, S%)))\r'                        Else\rIf (IY% - 1 + FirstYear > 2021) Then 'All adjustment is to TEF when exogenous years extend past shock\r'assumes exogenous is properly adjusting GDP in subsequent years for shock impact and recovery\rtef(R%, S%) = tef(R%, S%) * (1 + adjgr)\rCAPUT(R%, S%) = caputtar\rSCAPUT(R%, S%) = CAPUT(R%, S%)\rElse 'before 2020\rtef(R%, S%) = tef(R%, S%) * (1 + adjgr)\rEnd If\r'                        End If\r'bbh 2020/11/14 end\rElse 'for 2020 and 2021 only; could generalize with new parameter that indicated econshockyr\r'bbh 2020/10/14 start; from hard-coded to parameter use\rIf COVIDShock < 1 Then  '2020-2021 not COVID shock years (as in No COVID scenario and for unaffected countries)\rtef(R%, S%) = tef(R%, S%) * (1 + adjgr)\rCAPUT(R%, S%) = caputtar\rSCAPUT(R%, S%) = CAPUT(R%, S%)\rElse '2020-2021 COVID shock years\rtef(R%, S%) = tef(R%, S%) * (1 + adjgr * tfpshockadjshr(R%))\rCAPUT(R%, S%) = CAPUT(R%, S%) * (1 + adjgr * (1 - tfpshockadjshr(R%)))\rIf IY% - 1 + FirstYear = 2020 Then\rSCAPUT(R%, S%) = caputtar 'Cannot carry forward a shock-year catch-up to VADD; is lost production\rElse 'This approach basically assumes that 2021 year in pandemic is not so affected by extraordinary CAPUT reduction\rSCAPUT(R%, S%) = CAPUT(R%, S%)\rEnd If\rEnd If\r\r'                        tef(R%, S%) = tef(R%, S%) * (1 + adjgr * 0.2)\r'                        CAPUT(R%, S%) = CAPUT(R%, S%) * (1 + adjgr * 0.8)\r'bbh 2020/10/14 start;\rEnd If\r\r'jrs 2016/09/22 *** end ***\r\r'bbh 2020/12/17 start\rFor S% = 1 To NSec%\rIf ((S% > Ener) Or (S% = Agri And agon < 0.9) Or (S% = Ener And enon < 0.9)) Then\r'bbh 2020/08/26 start\r'If gdprext(R%) > -70 Then 'shock period; divide shock between downward TEF and CAPUT\r'If GRPS(1, R%) = \"Mongolia\" And S% = 3 And IY% >= 2 Then Stop\rIf (IY% - 1 + FirstYear < 2020) Or (IY% - 1 + FirstYear > 2021) Then 'Non shock years\r'If IY% <= 5 Then\r'Found that dividing \"error\" between tef and CAPUT in years before 2020 was making the error\r'continue to grow across some countries like Angola over time becuase VADD equation was continuing to diverge\r'from gdprext; these changes were being made to facilitate COVID shock analysis in 2020 and 2021 so\r'divided period of gdprext growth into shock years (2020-21) and other; should be ok if base year changes\r'may wish to handle via parameter\r'bbh 2020/11/14 start wrapped else TEF line in if-then-else\r'                        If (gdprext(R%) >= -65) And (IY% - 1 + FirstYear > 2021) Then\r'                            'If still exogenous, recognize that tef adjustment needed already offset by CAPUT change\r'                            tef(R%, S%) = tef(R%, S%) * (1 + adjgr + (caputtar - CAPUT(R%, S%)))\r'                        Else\rIf (IY% - 1 + FirstYear > 2021) Then 'All adjustment is to TEF when exogenous years extend past shock\r'assumes exogenous is properly adjusting GDP in subsequent years for shock impact and recovery\rtef(R%, S%) = tef(R%, S%) * (1 + adjgr)\rCAPUT(R%, S%) = caputtar\rSCAPUT(R%, S%) = CAPUT(R%, S%)\rElse 'before 2020\rtef(R%, S%) = tef(R%, S%) * (1 + adjgr)\rEnd If\r'                        End If\r'bbh 2020/11/14 end\rElse 'for 2020 and 2021 only; could generalize with new parameter that indicated econshockyr\r'bbh 2020/10/14 start; from hard-coded to parameter use\rIf COVIDShock < 1 Then  '2020-2021 not COVID shock years (as in No COVID scenario and for unaffected countries)\rtef(R%, S%) = tef(R%, S%) * (1 + adjgr)\rCAPUT(R%, S%) = caputtar\rSCAPUT(R%, S%) = CAPUT(R%, S%)\rElse '2020-2021 COVID shock years\rtef(R%, S%) = tef(R%, S%) * (1 + adjgr * tfpshockadjshr(R%))\rCAPUT(R%, S%) = CAPUT(R%, S%) * (1 + adjgr * (1 - tfpshockadjshr(R%)))\rIf IY% - 1 + FirstYear = 2020 Then\rSCAPUT(R%, S%) = caputtar 'Cannot carry forward a shock-year catch-up to VADD; is lost production\rElse 'This approach basically assumes that 2021 year in pandemic is not so affected by extraordinary CAPUT reduction\rSCAPUT(R%, S%) = CAPUT(R%, S%)\rEnd If\rEnd If\r\r'                        tef(R%, S%) = tef(R%, S%) * (1 + adjgr * 0.2)\r'                        CAPUT(R%, S%) = CAPUT(R%, S%) * (1 + adjgr * 0.8)\r'bbh 2020/10/14 start;\rEnd If\r\r'jrs 2016/09/22 *** end ***\r\r'bbh 2020/12/17 start\rFor S% = 1 To NSec%\rIf ((S% > Ener) Or (S% = Agri And agon < 0.9) Or (S% = Ener And enon < 0.9)) Then\r'bbh 2020/08/26 start\r'If gdprext(R%) > -70 Then 'shock period; divide shock between downward TEF and CAPUT\r'If GRPS(1, R%) = \"Mongolia\" And S% = 3 And IY% >= 2 Then Stop\rIf (IY% - 1 + FirstYear < 2020) Or (IY% - 1 + FirstYear > 2021) Then 'Non shock years\r'If IY% <= 5 Then\r'Found that dividing \"error\" between tef and CAPUT in years before 2020 was making the error\r'continue to grow across some countries like Angola over time becuase VADD equation was continuing to diverge\r'from gdprext; these changes were being made to facilitate COVID shock analysis in 2020 and 2021 so\r'divided period of gdprext growth into shock years (2020-21) and other; should be ok if base year changes\r'may wish to handle via parameter\r'bbh 2020/11/14 start wrapped else TEF line in if-then-else\r'                        If (gdprext(R%) >= -65) And (IY% - 1 + FirstYear > 2021) Then\r'                            'If still exogenous, recognize that tef adjustment needed already offset by CAPUT change\r'                            tef(R%, S%) = tef(R%, S%) * (1 + adjgr + (caputtar - CAPUT(R%, S%)))\r'                        Else\rIf (IY% - 1 + FirstYear > 2021) Then 'All adjustment is to TEF when exogenous years extend past shock\r'assumes exogenous is properly adjusting GDP in subsequent years for shock impact and recovery\rtef(R%, S%) = tef(R%, S%) * (1 + adjgr)\rCAPUT(R%, S%) = caputtar\rSCAPUT(R%, S%) = CAPUT(R%, S%)\rElse 'before 2020\rtef(R%, S%) = tef(R%, S%) * (1 + adjgr)\rEnd If\r'                        End If\r'bbh 2020/11/14 end\rElse 'for 2020 and 2021 only; could generalize with new parameter that indicated econshockyr\r'bbh 2020/10/14 start; from hard-coded to parameter use\rIf COVIDShock < 1 Then  '2020-2021 not COVID shock years (as in No COVID scenario and for unaffected countries)\rtef(R%, S%) = tef(R%, S%) * (1 + adjgr)\rCAPUT(R%, S%) = caputtar\rSCAPUT(R%, S%) = CAPUT(R%, S%)\rElse '2020-2021 COVID shock years\rtef(R%, S%) = tef(R%, S%) * (1 + adjgr * tfpshockadjshr(R%))\rCAPUT(R%, S%) = CAPUT(R%, S%) * (1 + adjgr * (1 - tfpshockadjshr(R%)))\rIf IY% - 1 + FirstYear = 2020 Then\rSCAPUT(R%, S%) = caputtar 'Cannot carry forward a shock-year catch-up to VADD; is lost production\rElse 'This approach basically assumes that 2021 year in pandemic is not so affected by extraordinary CAPUT reduction\rSCAPUT(R%, S%) = CAPUT(R%, S%)\rEnd If\rEnd If\r\r'                        tef(R%, S%) = tef(R%, S%) * (1 + adjgr * 0.2)\r'                        CAPUT(R%, S%) = CAPUT(R%, S%) * (1 + adjgr * 0.8)\r'bbh 2020/10/14 start;\rEnd If\r\r\r'cda(R%, S%) = cda(R%, S%) * (1 + adjgr * 0.8)\r'cda(R%, S%) = cda(R%, S%) * (1 + adjgr)\r'SVADD(R%, S%) = VADD(R%, S%) * (1 + adjgr * 0.2)\r'bbh 2020/09/10 start\r'                    If IY% - 1 + FirstYear = 2020 Then\r'                        SCAPUT(R%, S%) = caputtar 'Cannot carry forward a shock-year catch-up to VADD; is lost production\r'                    Else\r'                        SCAPUT(R%, S%) = CAPUT(R%, S%)\r'                    End If\r'bbh 2020/12/17 end\r\r'CAPUT(R%, S%) = caputtar\r'bbh 2020/09/10 end\r'SCAPUT(R%, S%) = CAPUT(R%, S%) 'bbh:  cannot carry forward a catch-up to VADD; is lost production\r'Else 'gdprext representing mostly variations in productivity change\r'tef(R%, S%) = tef(R%, S%) * (1 + adjgr)\r'End If\r'If RegName$(R%) = \"Angola\" And S% = 4 And IY% >= 6 Then Stop\r'bbh 2019/03/15 moved climate impact from here to TEF changes outside of this exogenous growth rate section\r'tef(R%, S%) = tef(R%, S%) * (1 - SClimEconImp(R%) / 100 * climeconimpstk) 'bbh 2017/10/25\rtef(R%, S%) = AMAX(0.01, Amin(tef(R%, S%), 100000))\r"
  },
  {
    "Variable": "TEFF",
    "UsesVariable": "tefinfadjm",
    "Distance": 10,
    "Code": "\r'bbh 2015/03/28 end\rTefInfAdjustFac = TefInfAdjustFac - 1\r"
  },
  {
    "Variable": "TEFF",
    "UsesVariable": "tfpshockadjshr",
    "Distance": 431,
    "Code": "0"
  },
  {
    "Variable": "TEFF",
    "UsesVariable": "VADD",
    "Distance": 450,
    "Code": "0"
  },
  {
    "Variable": "TEFF",
    "UsesVariable": "GDPSHADOWSHR",
    "Distance": 39,
    "Code": "0"
  },
  {
    "Variable": "TEFF",
    "UsesVariable": "gdpshadowon",
    "Distance": 39,
    "Code": "0"
  },
  {
    "Variable": "TEFF",
    "UsesVariable": "gdprext",
    "Distance": 444,
    "Code": "0"
  },
  {
    "Variable": "TEFF",
    "UsesVariable": "GDPPCP",
    "Distance": 42,
    "Code": "0"
  },
  {
    "Variable": "TEFF",
    "UsesVariable": "LABINFORMSHR",
    "Distance": 36,
    "Code": "0"
  },
  {
    "Variable": "TEFF",
    "UsesVariable": "agon",
    "Distance": 448,
    "Code": "0"
  },
  {
    "Variable": "TEFF",
    "UsesVariable": "enon",
    "Distance": 448,
    "Code": "0"
  },
  {
    "Variable": "TERMTR",
    "UsesVariable": "XS",
    "Distance": 36,
    "Code": "0"
  },
  {
    "Variable": "TERMTR",
    "UsesVariable": "PRI",
    "Distance": 36,
    "Code": "0"
  },
  {
    "Variable": "TERMTR",
    "UsesVariable": "nsdiv",
    "Distance": 36,
    "Code": "\rGDPPCI(R%) = GDPPC(R%)\r\rFor R% = 1 To NR%\rEXM1 = EXRATE(R%) / termtrm\rEXM2 = EXRATE(R%) * termtrm\rFor S% = 1 To NSec%\rSum = Sum + ZS(R%, S%)\rIf GDPPCI(R%) >= nsdiv Then\rTN = TN + XS(R%, S%)\rTWN = TWN + XS(R%, S%) * PRI(R%, S%) * EXM1\rElse\rTS = TS + XS(R%, S%)\rTWS = TWS + XS(R%, S%) * PRI(R%, S%) * EXM2\rEnd If\rNext S%\rNext R%\r"
  },
  {
    "Variable": "TERMTR",
    "UsesVariable": "EXRATE",
    "Distance": 41,
    "Code": "0"
  },
  {
    "Variable": "TERMTR",
    "UsesVariable": "termtrm",
    "Distance": 41,
    "Code": "0"
  },
  {
    "Variable": "TERMTR",
    "UsesVariable": "GDPPC",
    "Distance": 343,
    "Code": "\rFor R% = 1 To NR%\rEXM1 = EXRATE(R%) / termtrm\rEXM2 = EXRATE(R%) * termtrm\rFor S% = 1 To NSec%\rSum = Sum + ZS(R%, S%)\rIf GDPPCI(R%) >= nsdiv Then\rTN = TN + XS(R%, S%)\rTWN = TWN + XS(R%, S%) * PRI(R%, S%) * EXM1\rElse\rTS = TS + XS(R%, S%)\rTWS = TWS + XS(R%, S%) * PRI(R%, S%) * EXM2\rEnd If\rNext S%\rNext R%\r"
  },
  {
    "Variable": "TES",
    "UsesVariable": "CARANN",
    "Distance": 0,
    "Code": "\r\rTES(R%) = CARANN(R%) * 1000 / GDP(R%) 'kilograms of carbon/ unit of GDP\r"
  },
  {
    "Variable": "TES",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "\r\rTES(R%) = CARANN(R%) * 1000 / GDP(R%) 'kilograms of carbon/ unit of GDP\r"
  },
  {
    "Variable": "TFR",
    "UsesVariable": "tfrexovals",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "TFR",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "TFR",
    "UsesVariable": "tfrmin",
    "Distance": 38,
    "Code": "0"
  },
  {
    "Variable": "TFR",
    "UsesVariable": "hltfrconv",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "TFR",
    "UsesVariable": "hltfragestop",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "TFR",
    "UsesVariable": "hltfrpeaklevel",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "TFR",
    "UsesVariable": "hltfragepeak",
    "Distance": 14,
    "Code": "0"
  },
  {
    "Variable": "TFR",
    "UsesVariable": "hltfragehalflife",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "TFR",
    "UsesVariable": "tfrm",
    "Distance": 0,
    "Code": "\rminbound = Amin(mininit, tfrmin(R%))\r\r'TFR(R%) = AMAX(minbound, Amin(TFR(R%), 10))\rTFR(R%) = AMAX(minbound, Amin(TFR(R%) * tfrm(R%), 10))\r\r'Else\r'   TFR(R%) = AMAX(TFRMinR(R%), Amin(TFR(R%), 10))\r'bbh 2013/11/19 begin\r\rIf TFRGR(R%).HasValue Then\rTFRgrComp = (TFR(R%) - stfr(R%)) / AMAX(0.01, stfr(R%))\rTFRgrSmoothed = ConvergeOverTime(CSng(TFRGR(R%)), TFRgrComp, 10)\rTFR(R%) = stfr(R%) * (1 + TFRgrSmoothed)\r'dsr 2016/05/04 Do not write stfr here as it can change later\r'stfr(R%) = TFR(R%)\rEnd If\r\r'Else\r'   TFR(R%) = AMAX(TFRMinR(R%), Amin(TFR(R%), 10))\r'bbh 2013/11/19 begin\r\rIf TFRGR(R%).HasValue Then\rTFRgrComp = (TFR(R%) - stfr(R%)) / AMAX(0.01, stfr(R%))\rTFRgrSmoothed = ConvergeOverTime(CSng(TFRGR(R%)), TFRgrComp, 10)\rTFR(R%) = stfr(R%) * (1 + TFRgrSmoothed)\r'dsr 2016/05/04 Do not write stfr here as it can change later\r'stfr(R%) = TFR(R%)\rEnd If\r\r'Else\r'   TFR(R%) = AMAX(TFRMinR(R%), Amin(TFR(R%), 10))\r'bbh 2013/11/19 begin\r\rIf TFRGR(R%).HasValue Then\rTFRgrComp = (TFR(R%) - stfr(R%)) / AMAX(0.01, stfr(R%))\rTFRgrSmoothed = ConvergeOverTime(CSng(TFRGR(R%)), TFRgrComp, 10)\rTFR(R%) = stfr(R%) * (1 + TFRgrSmoothed)\r'dsr 2016/05/04 Do not write stfr here as it can change later\r'stfr(R%) = TFR(R%)\rEnd If\r'           TFR(R%) = AMAX(minbound, Amin(TFR(R%) * tfrm(R%), 10))\r'If RegName$(R%) = \"Sudan South\" Then Stop\r"
  },
  {
    "Variable": "TFR",
    "UsesVariable": "tfrconv",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "TFR",
    "UsesVariable": "ttfrr",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:End Sub:13997|\r\rPublic Sub ifsPOP2AllYears(context As IForecastContext)\rDim zy As Integer\rDim ConAdd, concomp, concomp2, contrbase, contrcomp As Single\rDim contrexcess As Single, tfrcompi As Single, tfrcomptar As Single\rDim tfrcomptar2 As Single, TimeFAc As Single, TFRMinReg As Single\rDim mininit As Single, minbound As Single\rDim TFRgrComp As Single, TFRgrSmoothed As Single\rDim ultmult As Double\rDim agehalflifeT As Single, ageinitT As Single, agepeakT As Single, agestopT As Single\rDim peaklevelT As Single\rDim fertdstm As Double\rDim PredHlthSpend As Single, hlthspendrgdp As Single, hlthshiftmax As Single, elaslifspnd As Single\rDim hlthcoef As Single, lifexpspendshift As Single, IncTerm1 As Single, IncTerm2 As Single\rDim BalTerm As Single, Headroom As Single, MaxIncrease As Single, ultlifetar As Single\rDim mFactorM As Single, mFactorF As Single, mfactor As Single\rDim clav As Single, clsf As Single\rDim MaleAIDSPortion As Single, maleaidsdths As Single, femaleaidsdths As Single, aidsdthscoh As Single\rDim ChilSdeath As Single, calcinf As Single, lagcoef As Single, cumMort As Single\rDim nqx As Single, POPMale As Double, POPFemale As Double\rDim infMort As Single, cohMort As Single\rDim lx, N, nax As Single\rDim DeathCount As Double\r'jrs 2020/08/31 Dim PNO As Single, PSO As Single, qlno As Single, qlso As Single\rDim POPURBANPOR As Single, PopLandRat As Single, PopUrbanRat As Single\r\r'   All Years 2\r'   -----------\rzy = IY% - 1\r\rTFR(R%) = TFR(R%) * (1 + zy * ttfrr) 'Technological/Cultural Shift\r"
  },
  {
    "Variable": "TFR",
    "UsesVariable": "EDYRSAG15",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "TFR",
    "UsesVariable": "CONTRUSE",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "TFR",
    "UsesVariable": "GDPPCP",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "TFR",
    "UsesVariable": "INFMOR",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "TFR",
    "UsesVariable": "ageofmarriagetfrelas",
    "Distance": 0,
    "Code": "\r'mti 2022/10/24 - AoM start\rIf context.HistoricMode = False Then\r'ageofmarriagetfrelas is elasticity of TFR to AoM (women); the next term is the change of AoM from the base case forecast\rTFR(R%) = TFR(R%) * (1 - ageofmarriagetfrelas(R%) * AGEOFMARRIAGE(R%, Female) * (1 - 1 / AMAX(0.00001, ageofmarriagem(R%, Female)))) 'residual impact of contraception\rEnd If\r"
  },
  {
    "Variable": "TFR",
    "UsesVariable": "AGEOFMARRIAGE",
    "Distance": 0,
    "Code": "\r'mti 2022/10/24 - AoM start\rIf context.HistoricMode = False Then\r'ageofmarriagetfrelas is elasticity of TFR to AoM (women); the next term is the change of AoM from the base case forecast\rTFR(R%) = TFR(R%) * (1 - ageofmarriagetfrelas(R%) * AGEOFMARRIAGE(R%, Female) * (1 - 1 / AMAX(0.00001, ageofmarriagem(R%, Female)))) 'residual impact of contraception\rEnd If\r"
  },
  {
    "Variable": "TFR",
    "UsesVariable": "ageofmarriagem",
    "Distance": 0,
    "Code": "\r'mti 2022/10/24 - AoM start\rIf context.HistoricMode = False Then\r'ageofmarriagetfrelas is elasticity of TFR to AoM (women); the next term is the change of AoM from the base case forecast\rTFR(R%) = TFR(R%) * (1 - ageofmarriagetfrelas(R%) * AGEOFMARRIAGE(R%, Female) * (1 - 1 / AMAX(0.00001, ageofmarriagem(R%, Female)))) 'residual impact of contraception\rEnd If\r"
  },
  {
    "Variable": "TFR",
    "UsesVariable": "eltfrcon",
    "Distance": 0,
    "Code": "\r\r'   All Years 2:  Contraceptive Excess/Deficit\r'       Compute factor to influence TFR; carry impact over time because\r'       when contraception use reaches maximum, impact of time shift in use\r'       must be protected\r'   --------------------------------------------------------------------\r'        If ContrComp - ContrBase > ContrExcessMin(R%) Then\r'            ContrExcessMin(R%) = ContrComp - ContrBase\r'        End If\rcontrexcess = CONTRUSE(R%) - contrbase\r\r\rIf context.HistoricMode = False Then\rTFR(R%) = TFR(R%) - contrexcess * eltfrcon 'residual impact of contraception\r'on TFR, controlling for GDPPC effect, is linear\rEnd If\r"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "POWERHH",
    "Distance": 23,
    "Code": "0"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "GOVRISK",
    "Distance": 21,
    "Code": "0"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "WATUSE",
    "Distance": 20,
    "Code": "\rJoin MaxCOI In MaxCOIYearSQL On MaxCOI.COW1 Equals CI2.COW1 And MaxCOI.COW2 Equals CI2.COW2\rWhere MaxCOI.MaxVal2 > CI2.Year + 9 'jrs 2019/09/16 Review 2019-09-15\rGroup Value = CI2.Year By CI2.COW1, CI2.COW2 Into Data = Group, MaxYrMinus10 = Max(Value))\r\rJoin MaxCOI In MaxCOIYearSQL On MaxCOI.COW1 Equals CI2.COW1 And MaxCOI.COW2 Equals CI2.COW2\rWhere MaxCOI.MaxVal2 > CI2.Year + 9 'jrs 2019/09/16 Review 2019-09-15\rGroup Value = CI2.Year By CI2.COW1, CI2.COW2 Into Data = Group, MaxYrMinus10 = Max(Value))\r\rJoin MaxCOI In MaxCOIYearSQL On MaxCOI.COW1 Equals CI2.COW1 And MaxCOI.COW2 Equals CI2.COW2\rWhere MaxCOI.MaxVal2 > CI2.Year 'jrs 2019/09/16 Review 2019-09-15\rGroup Value = CI2.Year By CI2.COW1, CI2.COW2 Into Data = Group, MinYr = Max(Value))\r\rJoin MaxCOI In MaxCOIYearSQL On MaxCOI.COW1 Equals CI2.COW1 And MaxCOI.COW2 Equals CI2.COW2\rWhere MaxCOI.MaxVal2 > CI2.Year + 9 'jrs 2019/09/16 Review 2019-09-15\rGroup Value = CI2.Year By CI2.COW1, CI2.COW2 Into Data = Group, MaxYrMinus10 = Max(Value))\r\rJoin MaxCOI In MaxCOIYearSQL On MaxCOI.COW1 Equals CI2.COW1 And MaxCOI.COW2 Equals CI2.COW2\rWhere MaxCOI.MaxVal2 > CI2.Year + 9 'jrs 2019/09/16 Review 2019-09-15\rGroup Value = CI2.Year By CI2.COW1, CI2.COW2 Into Data = Group, MaxYrMinus10 = Max(Value))\r\rJoin MaxCOI In MaxCOIYearSQL On MaxCOI.COW1 Equals CI2.COW1 And MaxCOI.COW2 Equals CI2.COW2\rWhere MaxCOI.MaxVal2 > CI2.Year + 9 'jrs 2019/09/16 Review 2019-09-15\rGroup Value = CI2.Year By CI2.COW1, CI2.COW2 Into Data = Group, MaxYrMinus10 = Max(Value))\r\rJoin MaxCOI In MaxCOIYearSQL On MaxCOI.COW1 Equals CI2.COW1 And MaxCOI.COW2 Equals CI2.COW2\rWhere MaxCOI.MaxVal2 > CI2.Year + 9 'jrs 2019/09/16 Review 2019-09-15\rGroup Value = CI2.Year By CI2.COW1, CI2.COW2 Into Data = Group, MaxYrMinus10 = Max(Value))\r\rJoin MaxCOI In MaxCOIYearSQL On MaxCOI.COW1 Equals CI2.COW1 And MaxCOI.COW2 Equals CI2.COW2\rWhere MaxCOI.MaxVal2 > CI2.Year + 9 'jrs 2019/09/16 Review 2019-09-15\rGroup Value = CI2.Year By CI2.COW1, CI2.COW2 Into Data = Group, MaxYrMinus10 = Max(Value))\r\rJoin MaxCOI In MaxCOIYearSQL On MaxCOI.COW1 Equals CI2.COW1 And MaxCOI.COW2 Equals CI2.COW2\rWhere MaxCOI.MaxVal2 > CI2.Year + 9 'jrs 2019/09/16 Review 2019-09-15\rGroup Value = CI2.Year By CI2.COW1, CI2.COW2 Into Data = Group, MaxYrMinus10 = Max(Value))\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal = Max(Value))\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal = Max(Value))\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal = Max(Value))\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal = Max(Value))\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal = Max(Value))\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal = Max(Value))\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal = Max(Value))\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal = Max(Value))\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal = Max(Value))\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal = Max(Value))\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal = Max(Value))\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal = Max(Value))\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal = Max(Value))\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal = Max(Value))\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal = Max(Value))\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal = Max(Value))\r\r\r'jrs 2011/11/10\rIf IY = 1 Then\r'Find the mean of Realist Index\rFor R1 = 1 To NR - 1\rFor R2 = R1 + 1 To NR\rMeanReal = MeanReal + WPINDREAL(R1, R2)\rNext R2\rNext R1\r\rMeanReal = CSng(MeanReal / (NR * CLng(NR - 1) / 2))\r'Find the standard deviation\rFor R1 = 1 To NR - 1\rFor R2 = R1 + 1 To NR\rStdDevReal = CSng(StdDevReal + (WPINDREAL(R1, R2) - MeanReal) ^ 2)\rNext R2\rNext R1\rStdDevReal = CSng((StdDevReal / (NR * CLng(NR - 1) / 2)) ^ (1 / 2))\rEnd If\r\rJoin MaxCOI In MaxCOIYearSQL On MaxCOI.COW1 Equals CI2.COW1 And MaxCOI.COW2 Equals CI2.COW2\rWhere MaxCOI.MaxVal2 > CI2.Year 'jrs 2019/09/16 Review 2019-09-15\rGroup Value = CI2.Year By CI2.COW1, CI2.COW2 Into Data = Group, MinYr = Max(Value))\r\rJoin MaxCOI In MaxCOIYearSQL On MaxCOI.COW1 Equals CI2.COW1 And MaxCOI.COW2 Equals CI2.COW2\rWhere MaxCOI.MaxVal2 > CI2.Year 'jrs 2019/09/16 Review 2019-09-15\rGroup Value = CI2.Year By CI2.COW1, CI2.COW2 Into Data = Group, MinYr = Max(Value))\r\rENERGY = Amin(AMAX(ENERGY, 0), 1)\r\r'3. Water\r'If contiguity(r1, r2) < 6 Then\rIf SharedRiv(R1, R2) Then\rWATER = (WATUSE(R1) / watres(R1) + WATUSE(R2) / watres(R2)) / 2\rIf WATER > 1 Then\rWATER = 1\rElse\rWATER = CSng((WATER - 0.4) / 0.6)\rEnd If\rEnd If\r\r'2. Fragility\rIf GOVRISK(R1) > GOVRISK(R2) Then\rFragility = GOVRISK(R1) / MaxRiskIdx\rElse\rFragility = GOVRISK(R2) / MaxRiskIdx\rEnd If\r\rElse\r'1. Material Power\rIf POWERHH(R1) > POWERHH(R2) Then\rMatPow = (POWERHH(R1) + POWERHH(R2)) / (POWERHH(R1) * 2)\rElse\rMatPow = (POWERHH(R1) + POWERHH(R2)) / (POWERHH(R2) * 2)\rEnd If\r\rJoin MaxCOI In MaxCOIYearSQL On MaxCOI.COW1 Equals CI2.COW1 And MaxCOI.COW2 Equals CI2.COW2\rWhere MaxCOI.MaxVal2 > CI2.Year 'jrs 2019/09/16 Review 2019-09-15\rGroup Value = CI2.Year By CI2.COW1, CI2.COW2 Into Data = Group, MinYr = Max(Value))\r\rJoin MaxCOI In MaxCOIYearSQL On MaxCOI.COW1 Equals CI2.COW1 And MaxCOI.COW2 Equals CI2.COW2\rWhere MaxCOI.MaxVal2 > CI2.Year 'jrs 2019/09/16 Review 2019-09-15\rGroup Value = CI2.Year By CI2.COW1, CI2.COW2 Into Data = Group, MinYr = Max(Value))\r\rENERGY = Amin(AMAX(ENERGY, 0), 1)\r\r'3. Water\r'If contiguity(r1, r2) < 6 Then\rIf SharedRiv(R1, R2) Then\rWATER = (WATUSE(R1) / watres(R1) + WATUSE(R2) / watres(R2)) / 2\rIf WATER > 1 Then\rWATER = 1\rElse\rWATER = CSng((WATER - 0.4) / 0.6)\rEnd If\rEnd If\r\r'2. Fragility\rIf GOVRISK(R1) > GOVRISK(R2) Then\rFragility = GOVRISK(R1) / MaxRiskIdx\rElse\rFragility = GOVRISK(R2) / MaxRiskIdx\rEnd If\r\rElse\r'1. Material Power\rIf POWERHH(R1) > POWERHH(R2) Then\rMatPow = (POWERHH(R1) + POWERHH(R2)) / (POWERHH(R1) * 2)\rElse\rMatPow = (POWERHH(R1) + POWERHH(R2)) / (POWERHH(R2) * 2)\rEnd If\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal2 = Max(Value))\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal2 = Max(Value))\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal2 = Max(Value))\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal2 = Max(Value))\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal2 = Max(Value))\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal2 = Max(Value))\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal2 = Max(Value))\r\rWhere CI.StandCOI.HasValue\rGroup Value = CI.Year By CI.COW1, CI.COW2 Into Data = Group, MaxVal2 = Max(Value))\r\rENERGY = ENERGY + (WENP(Gas) / WENPT) * 80 * (RESER(R1, Gas) + RESER(R2, Gas)) / WRESER(Gas)\r\r'3. Water\r'If contiguity(r1, r2) < 6 Then\rIf SharedRiv(R1, R2) Then\rWATER = (WATUSE(R1) / watres(R1) + WATUSE(R2) / watres(R2)) / 2\rIf WATER > 1 Then\rWATER = 1\rElse\rWATER = CSng((WATER - 0.4) / 0.6)\rEnd If\rEnd If\r\rJoin MaxCOI In MaxCOIYearSQL On MaxCOI.COW1 Equals CI2.COW1 And MaxCOI.COW2 Equals CI2.COW2\rWhere MaxCOI.MaxVal2 > CI2.Year 'jrs 2019/09/16 Review 2019-09-15\rGroup Value = CI2.Year By CI2.COW1, CI2.COW2 Into Data = Group, MinYr = Max(Value))\r\r\r\rFor Each item In (From CI In db.GovConflict\rJoin CT1 In db.CountryTranslation On CT1.COWNumbers Equals CI.COW1.ToString\rJoin CT2 In db.CountryTranslation On CT2.COWNumbers Equals CI.COW2.ToString\rJoin MinCOIYear In MinCOIYearSQL On MinCOIYear.COW1 Equals CI.COW1 And MinCOIYear.COW2 Equals CI.COW2 And MinCOIYear.MinYr Equals CI.Year\rSelect Country1 = CT1.Country, Country2 = CT2.Country, StandCOI = CI.StandCOI, Year = CI.Year)\r\r\rR1 = context.Regionalization.First(Function(S) S.Key.Equals(item.Country1)).Value\r"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "watres",
    "Distance": 20,
    "Code": "\r\r\rFor Each item In (From CI In db.GovConflict\rJoin CT1 In db.CountryTranslation On CT1.COWNumbers Equals CI.COW1.ToString\rJoin CT2 In db.CountryTranslation On CT2.COWNumbers Equals CI.COW2.ToString\rJoin MinCOIYear In MinCOIYearSQL On MinCOIYear.COW1 Equals CI.COW1 And MinCOIYear.COW2 Equals CI.COW2 And MinCOIYear.MinYr Equals CI.Year\rSelect Country1 = CT1.Country, Country2 = CT2.Country, StandCOI = CI.StandCOI, Year = CI.Year)\r\r\rR1 = context.Regionalization.First(Function(S) S.Key.Equals(item.Country1)).Value\r"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "WENP",
    "Distance": 16,
    "Code": "\r'4. Energy\rENERGY = (WENP(Oil) / WENPT) * 80 * (RESER(R1, Oil) + RESER(R2, Oil)) / WRESER(Oil)\r\rR2 = context.Regionalization.First(Function(S) S.Key.Equals(item.Country2)).Value\r"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "RESER",
    "Distance": 16,
    "Code": "\rFor i = 1 To 6\rWENPT = WENPT + WENP(i)\rNext i\r"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "WRESER",
    "Distance": 16,
    "Code": "\rR2 = context.Regionalization.First(Function(S) S.Key.Equals(item.Country2)).Value\r\r\r\rFor Each item In (From CI In db.GovConflict\rJoin CT1 In db.CountryTranslation On CT1.COWNumbers Equals CI.COW1.ToString\rJoin CT2 In db.CountryTranslation On CT2.COWNumbers Equals CI.COW2.ToString\rJoin MinCOIYear In MinCOIYearSQL On MinCOIYear.COW1 Equals CI.COW1 And MinCOIYear.COW2 Equals CI.COW2 And MinCOIYear.MinYr Equals CI.Year\rSelect Country1 = CT1.Country, Country2 = CT2.Country, StandCOI = CI.StandCOI, Year = CI.Year)\r\r\rR1 = context.Regionalization.First(Function(S) S.Key.Equals(item.Country1)).Value\r"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "DEMOCPOLITY",
    "Distance": 51,
    "Code": "0"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "M",
    "Distance": 48,
    "Code": "0"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "X",
    "Distance": 48,
    "Code": "0"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "GDP",
    "Distance": 48,
    "Code": "0"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "GOVEMBED",
    "Distance": 50,
    "Code": "0"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "terdispute",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "wpterdisp",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "glocom",
    "Distance": 47,
    "Code": "0"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "wpcommun",
    "Distance": 47,
    "Code": "\r\rGLOCOMI = glocom\r"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "wpdemmin",
    "Distance": 15,
    "Code": "\rMinDemocI = Amin(DEMOCPOLITYI(act%), DEMOCPOLITYI(tar%))\r\r\r'           All but First 1:  Dyadic democracy terms,  joint and political distance\r'           --------------------------------------------------------------------\r\rMinDemoc = Amin(DEMOCPOLITY(act%), DEMOCPOLITY(tar%))\r"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "wpdemdist",
    "Distance": 12,
    "Code": "\rDemocDistI = Abs(DEMOCPOLITYI(act%) - DEMOCPOLITYI(tar%))\r\r\rDemocDist = Abs(DEMOCPOLITY(act%) - DEMOCPOLITY(tar%))\r"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "ally",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "wpally",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "wpsysgr",
    "Distance": 34,
    "Code": "\rIf IY% = 2 Then LongTermGDPR = WGDPR\r\r\r'   All but First 1:  Systemic Economic Growth Term\r'   ---------------------------------------------\r\rWGDPR = CSng((WGDP - SWGDP) / AMAX(0.001, SWGDP) * 100)\r\rAllyI(tar%, act%) = allyterm\r"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "wpgreat1",
    "Distance": 20,
    "Code": "0"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "wpgreat2",
    "Distance": 20,
    "Code": "0"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "wppowtran2",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "wppowtran1",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "WGDP",
    "Distance": 37,
    "Code": "0"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "wpgreatthresh",
    "Distance": 22,
    "Code": "0"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "wpgreatlev",
    "Distance": 22,
    "Code": "0"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "wpcon",
    "Distance": 45,
    "Code": "\r\r'           First Year: Power transition/ratio term\r'           ---------------------------------------\r\r'jrs 2021/12/05\rIf wppowhhsw = 0 Then\rIf POWER(act%) >= wpgreatlev And POWER(tar%) >= wpgreatlev Then\rPowerRatio = Amin(POWER(act%) / POWER(tar%), POWER(tar%) / POWER(act%))\rIf (PowerRatio >= wppowtran1) Then\rPowerTerm = CSng(wppowtran2 * (PowerRatio - wppowtran1) / 0.1)\rEnd If\rEnd If\rElse\rIf POWERHH(act%) >= wpgreatlev And POWERHH(tar%) >= wpgreatlev Then\rPowerRatio = Amin(POWERHH(act%) / POWERHH(tar%), POWERHH(tar%) / POWERHH(act%))\rIf (PowerRatio >= wppowtran1) Then\rPowerTerm = CSng(wppowtran2 * (PowerRatio - wppowtran1) / 0.1)\rEnd If\rEnd If\rEnd If\r"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "wpconsq",
    "Distance": 45,
    "Code": "\r\r'   All but First 1:  Threat Calculation, Power concentration term\r'   ------------------------------------------------------------\r\rConcenChange = AMAX(wpconmin, Amin(wpconmax, PCONGREAT)) -\r        AMAX(wpconmin, Amin(wpconmax, PConGreatI))\r"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "wptrade",
    "Distance": 41,
    "Code": "\r\r'   All but First 1:  Threat Calculation, Power concentration term\r'   ------------------------------------------------------------\r\rConcenChange = AMAX(wpconmin, Amin(wpconmax, PCONGREAT)) -\r        AMAX(wpconmin, Amin(wpconmax, PConGreatI))\r"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "WTRADE",
    "Distance": 41,
    "Code": "0"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "wpconmin",
    "Distance": 46,
    "Code": "\r\r'jrs 2021/12/05 using POWERHH when switch is on\rIf wppowhhsw = 0 Then\rIf POWER(tar%) <= wpgreatthresh Then\rGPowerNumb = 0\rElse\rGPowerNumb = (POWER(tar%) - wpgreatthresh) _\r                        / AMAX(1, (wpgreatlev - wpgreatthresh))\rEnd If\r\rIf POWER(act%) <= wpgreatthresh Then\rGPowerNumb = GPowerNumb\rElseIf POWER(act%) >= wpgreatlev Then\rGPowerNumb = GPowerNumb + 1\rElse\rGPowerNumb = GPowerNumb + (POWER(act%) - wpgreatthresh) _\r                        / (wpgreatlev - wpgreatthresh)\rEnd If\rElse\rGPowerNumb = (POWERHH(tar%) - wpgreatthresh) _\r                        / AMAX(1, (wpgreatlev - wpgreatthresh))\rEnd If\r\rIf POWERHH(act%) <= wpgreatthresh Then\rGPowerNumb = GPowerNumb\rElseIf POWERHH(act%) >= wpgreatlev Then\rGPowerNumb = GPowerNumb + 1\rElse\rGPowerNumb = GPowerNumb + (POWERHH(act%) - wpgreatthresh) _\r                        / (wpgreatlev - wpgreatthresh)\rEnd If\rEnd If\r"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "wpconmax",
    "Distance": 46,
    "Code": "\r\r'jrs 2021/12/05 using POWERHH when switch is on\rIf wppowhhsw = 0 Then\rIf POWER(tar%) <= wpgreatthresh Then\rGPowerNumb = 0\rElse\rGPowerNumb = (POWER(tar%) - wpgreatthresh) _\r                        / AMAX(1, (wpgreatlev - wpgreatthresh))\rEnd If\r\rIf POWER(act%) <= wpgreatthresh Then\rGPowerNumb = GPowerNumb\rElseIf POWER(act%) >= wpgreatlev Then\rGPowerNumb = GPowerNumb + 1\rElse\rGPowerNumb = GPowerNumb + (POWER(act%) - wpgreatthresh) _\r                        / (wpgreatlev - wpgreatthresh)\rEnd If\rElse\rGPowerNumb = (POWERHH(tar%) - wpgreatthresh) _\r                        / AMAX(1, (wpgreatlev - wpgreatthresh))\rEnd If\r\rIf POWERHH(act%) <= wpgreatthresh Then\rGPowerNumb = GPowerNumb\rElseIf POWERHH(act%) >= wpgreatlev Then\rGPowerNumb = GPowerNumb + 1\rElse\rGPowerNumb = GPowerNumb + (POWERHH(act%) - wpgreatthresh) _\r                        / (wpgreatlev - wpgreatthresh)\rEnd If\rEnd If\r"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "PCONGREAT",
    "Distance": 46,
    "Code": "0"
  },
  {
    "Variable": "THREAT",
    "UsesVariable": "wpthrconv",
    "Distance": 0,
    "Code": "\rIf tar% = act% Then ThreatIPred(act%, tar%) = 0\r\rIf wpthrconv = 1 Then\rTHREAT(act%, tar%) = ThreatIPred(act%, tar%)\rEnd If\r"
  },
  {
    "Variable": "THREATREC",
    "UsesVariable": "THREAT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "THREATSENT",
    "UsesVariable": "THREAT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "TRADEBAL",
    "UsesVariable": "X",
    "Distance": 0,
    "Code": "\rFor R% = 1 To NR%\rXRPA(R%) = XRPA(R%) / AMAX(0.01, WX) * WT\rMRPA(R%) = MRPA(R%) / AMAX(0.01, WM) * WT\r'TRADEBAL(R%) = XRPA(R%) - MRPA(R%)\rTRADEBAL(R%) = X(R%) - M(R%) 'bbh 2021/07/07\rSExRate(R%) = EXRATE(R%)\r'jrs 2014/04/11\r'             SX(R%) = X(R%)\r'             SM(R%) = M(R%)\rIf IY% > 1 Then\raidlp(R%) = AMAX(0, Amin(1, AIDLPI(R%) * aidlpm))\rEnd If\rIf AID(R%) > 0 Then 'Recipients\rSumAid = SumAid + AID(R%)\rSumAidLP = SumAidLP + AID(R%) * aidlp(R%)\rEnd If\rNext R%\r"
  },
  {
    "Variable": "TRADEBAL",
    "UsesVariable": "M",
    "Distance": 0,
    "Code": "\rFor R% = 1 To NR%\rXRPA(R%) = XRPA(R%) / AMAX(0.01, WX) * WT\rMRPA(R%) = MRPA(R%) / AMAX(0.01, WM) * WT\r'TRADEBAL(R%) = XRPA(R%) - MRPA(R%)\rTRADEBAL(R%) = X(R%) - M(R%) 'bbh 2021/07/07\rSExRate(R%) = EXRATE(R%)\r'jrs 2014/04/11\r'             SX(R%) = X(R%)\r'             SM(R%) = M(R%)\rIf IY% > 1 Then\raidlp(R%) = AMAX(0, Amin(1, AIDLPI(R%) * aidlpm))\rEnd If\rIf AID(R%) > 0 Then 'Recipients\rSumAid = SumAid + AID(R%)\rSumAidLP = SumAidLP + AID(R%) * aidlp(R%)\rEnd If\rNext R%\r"
  },
  {
    "Variable": "TRADSRAT",
    "UsesVariable": "tradsratadd",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "TRADSRAT",
    "UsesVariable": "mprconv",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "TRADSRAT",
    "UsesVariable": "cultshts",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "TRADSRAT",
    "UsesVariable": "CULTREG",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "TRADSRAT",
    "UsesVariable": "GDPPCP",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "TRUCKS",
    "UsesVariable": "TRUCKSTOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "TRUCKS",
    "UsesVariable": "trucksm",
    "Distance": 0,
    "Code": "\rFor cc% = 1 To 12 'Could use MaxVal(12) from IFs.grp\rTitle$ = \"TrucksTot Versus Trucks\" + GRPS$(12, cc%)\rCall XYTABL(Title$, TRUCKSTOT(R%) / AMAX(0.001, POP(R%)) / 1000000, truckscomp, context)\rCall XYTABL(Title$, CSng(truckstotpci(R%)), truckscomp2, context)\rIf truckscomp < 0.9 * truckscomp2 Then\rtruckscomp = CSng(0.9 * truckscomp2)\rEnd If\rIf truckscomp <= 0 Or truckscomp2 <= 0 Then\rtruckscomp = 1\rtruckscomp2 = 1\rEnd If\rDim TrucksMul = truckscomp / AMAX(0.000001, truckscomp2)\rTimeFAc = Amin(IY%, trucksconv)\rDim trucksbase = (trucksi(R%, cc%) *\r               (trucksconv - TimeFAc) + truckscomp * TimeFAc) / AMAX(1, trucksconv)\rTRUCKS(R%, cc%) = AMAX(0, trucksbase * TrucksMul) * TRUCKSTOT(R%) * trucksm(R%, cc%)\rTrucksTotCalc = TrucksTotCalc + TRUCKS(R%, cc%)\rNext cc%\r"
  },
  {
    "Variable": "TRUCKS",
    "UsesVariable": "trucksconv",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "TRUCKS",
    "UsesVariable": "POP",
    "Distance": 149,
    "Code": "\rtruckstotpci(R%) = TRUCKSTOT(R%) / AMAX(0.001, POP(R%)) / 1000000\r"
  },
  {
    "Variable": "TRUCKSALPC",
    "UsesVariable": "TRUCKSTOT",
    "Distance": 0,
    "Code": "\rTRUCKSALPC(R%) = TRUCKSTOT(R%) / AMAX(0.001, POP(R%) * 1000000)\r"
  },
  {
    "Variable": "TRUCKSALPC",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\rTRUCKSALPC(R%) = TRUCKSTOT(R%) / AMAX(0.001, POP(R%) * 1000000)\r"
  },
  {
    "Variable": "TRUCKSFL",
    "UsesVariable": "GDPPCP",
    "Distance": 0,
    "Code": "\r\r'jrs 2009/07/07 CARSFL(R%) = carstoti(R%) * Amin(15, 5 + GDPPCP(R%))\rTRUCKSFL(R%) = Truckstoti(R%) * Amin(15, 5 + GDPPCP(R%))\r"
  },
  {
    "Variable": "TRUCKSFLPC",
    "UsesVariable": "TRUCKSFL",
    "Distance": 0,
    "Code": "\r'jrs 2009/07/07 CARSFLPC(R%) = CARSFL(R%) / AMAX(0.001, POP(R%)) / 1000\rTRUCKSFLPC(R%) = TRUCKSFL(R%) / AMAX(0.001, POP(R%)) / 1000\r"
  },
  {
    "Variable": "TRUCKSFLPC",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r'jrs 2009/07/07 CARSFLPC(R%) = CARSFL(R%) / AMAX(0.001, POP(R%)) / 1000\rTRUCKSFLPC(R%) = TRUCKSFL(R%) / AMAX(0.001, POP(R%)) / 1000\r"
  },
  {
    "Variable": "TRUCKSTOT",
    "UsesVariable": "truckstotm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "TRUCKSTOT",
    "UsesVariable": "trucksconv",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "TRUCKSTOT",
    "UsesVariable": "GDP",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "TRUCKSTOT",
    "UsesVariable": "GDPPCP",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "TRUCKSTOT",
    "UsesVariable": "TRADSRAT",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "TRUCKSTOT",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "TRUCKSTOT",
    "UsesVariable": "SURVSE",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "UNPAIDLABOR",
    "UsesVariable": "unpaidlaborm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "UNPAIDLABOR",
    "UsesVariable": "LABPARR",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "UNPAIDLABOR",
    "UsesVariable": "POPMEDAGE",
    "Distance": 11,
    "Code": "0"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "gdprext",
    "Distance": 19,
    "Code": "\rsumvadds = TotalSVadd + TotalSVaddPhy\r\rTotalVadd = 0\r\r'The following four lines did not as precisely modify GDPR to gdprext as the new ones following\r'            sumcompgr = (SumVadd - sumvadds) / AMAX(0.0001, sumvadds)\r'            SumAdjGr = AMAX(-0.9, Amin(1.1, gdprext(R%) / 100 + mfpadd(R%) - sumcompgr))\r'            SumAdjGDP = SumAdjGr * SumVadd\r'            adjgr = SumAdjGDP / TotalVadd\r\rActualGDPInc = SumVadd - sumvadds\r\r'bbh 2017/10/20 start remove mfpadd becuase if gdpadjsw = 1, could pass through twice, aleady in TEF and used\r'   earlier for vadd\r'NeededGDPInc = sumvadds * (gdprext(R%) / 100 + mfpadd(R%))\rNeededGDPInc = sumvadds * (gdprext(R%) / 100)\r\rFor S% = 1 To NSec%\rIf ((S% > Ener) OrElse (S% = Agri AndAlso agon < 0.9) OrElse (S% = Ener AndAlso enon < 0.9)) Then\rTotalSVadd = TotalSVadd + sVADD(R%, S%)\rTotalVadd = TotalVadd + VADD(R%, S%)\rElse\rTotalSVaddPhy = TotalSVaddPhy + sVADD(R%, S%)\rTotalVaddPhy = TotalVaddPhy + VADD(R%, S%)\rEnd If\r'If RegName$(R%) = \"Ukraine\" And S% = 2 Then Stop\rNext S%\r\r'bbh 2017/10/20 end\rNeededNonPhyAdj = NeededGDPInc - ActualGDPInc\r\r'Load Base Case Adjustment\r'bbh 2017/10/20 start\r'The following block, if gdpadjsw=1 does the following:\r'   It reaches out to the GUI to draw upon the IFsBase.run to pull in values of GDPADJBASE that\r'   correspond to the values of adjgr when the base was last rebuilt; thus if the switch is on,\r'   any scenario changes (including gdprext, mfpadd, gdsm) will affect gdpr on top of base case adjustment related to gdprest;\r'   if full control in scenarios is wanted with gdprext (new values will totally control gdpr), set switch to 0\r'   simultaneously when making such full control changes with gdprext\r'bbh 2017/10/20 end\rIf gdpadjsw = 1 Then\rReDim GDPADJBASE(IY)\r'ttt Skip this line\r'        frm_MainMenu.IFsGUIctrl1.getLoadForDisplay \"GDPADJ\", -1, GRPS(1, R%), R%, \"\", -1, \"\", -1,\r'\"\", 1, True, True, False, 1, GDPADJBASE, 1, 1, FirstYear, FirstYear + IY - 1,\r'0, True, \"\", False\rIf dfBaseGDPADJ.RowCount > (IY - 1) * NR Then\rGDPADJBASE(IY) = CSng(dfBaseGDPADJ(getDataFrameIdxFromDims(CShort(FirstYear + IY - 1), FirstYear, CShort(R), CShort(NR))))\rEnd If\r\r'if it's 0, we're rebuilding the base, or no adjustment was needed, so do nothing\r'only if it's non 0\r'GDPf = GDPi1*(1+adj1)\r'GDPf = GDPi2*(1+adj2)\r'where GDPf is the same, so we want to preserve GDPi2/GDPi1, which is equal to (1+adj1)/(1+adj2)\r'Then we'll find a new GDPf * (1+adj1)/(1+adj2), but since GDPf = GDPi2 * (1+adj2), then we multiply times (1+adj1)/(1+adj2) both sides\r'and we get that the new GDPf2 = GDPi2 * (1+adj1)\rIf GDPADJBASE(IY) <> 0 Then\radjgr = GDPADJBASE(IY)\rEnd If\rEnd If\r\r'jrs 2019/09/26 adjgr = NeededNonPhyAdj / TotalVadd\radjgr = AMAX(-0.9, NeededNonPhyAdj / TotalVadd)\r\r'Load Base Case Adjustment\r'bbh 2017/10/20 start\r'The following block, if gdpadjsw=1 does the following:\r'   It reaches out to the GUI to draw upon the IFsBase.run to pull in values of GDPADJBASE that\r'   correspond to the values of adjgr when the base was last rebuilt; thus if the switch is on,\r'   any scenario changes (including gdprext, mfpadd, gdsm) will affect gdpr on top of base case adjustment related to gdprest;\r'   if full control in scenarios is wanted with gdprext (new values will totally control gdpr), set switch to 0\r'   simultaneously when making such full control changes with gdprext\r'bbh 2017/10/20 end\rIf gdpadjsw = 1 Then\rReDim GDPADJBASE(IY)\r'ttt Skip this line\r'        frm_MainMenu.IFsGUIctrl1.getLoadForDisplay \"GDPADJ\", -1, GRPS(1, R%), R%, \"\", -1, \"\", -1,\r'\"\", 1, True, True, False, 1, GDPADJBASE, 1, 1, FirstYear, FirstYear + IY - 1,\r'0, True, \"\", False\rIf dfBaseGDPADJ.RowCount > (IY - 1) * NR Then\rGDPADJBASE(IY) = CSng(dfBaseGDPADJ(getDataFrameIdxFromDims(CShort(FirstYear + IY - 1), FirstYear, CShort(R), CShort(NR))))\rEnd If\r\r'if it's 0, we're rebuilding the base, or no adjustment was needed, so do nothing\r'only if it's non 0\r'GDPf = GDPi1*(1+adj1)\r'GDPf = GDPi2*(1+adj2)\r'where GDPf is the same, so we want to preserve GDPi2/GDPi1, which is equal to (1+adj1)/(1+adj2)\r'Then we'll find a new GDPf * (1+adj1)/(1+adj2), but since GDPf = GDPi2 * (1+adj2), then we multiply times (1+adj1)/(1+adj2) both sides\r'and we get that the new GDPf2 = GDPi2 * (1+adj1)\rIf GDPADJBASE(IY) <> 0 Then\radjgr = GDPADJBASE(IY)\rEnd If\rEnd If\r\r'mti October 03, 2011 - end\rVADD(R%, S%) = VADD(R%, S%) * (1 + adjgr)\r'If RegName$(R%) = \"India\" And S% = 4 And IY% >= 7 Then Stop\r"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "agon",
    "Distance": 23,
    "Code": "0"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "enon",
    "Distance": 23,
    "Code": "0"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "CAPUT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "caputtar",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "ZS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "FDEM",
    "Distance": 1746,
    "Code": "0"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "FEDDEM",
    "Distance": 1746,
    "Code": "0"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "FMDEM",
    "Distance": 1746,
    "Code": "0"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "INDEM",
    "Distance": 1746,
    "Code": "0"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "inputictm",
    "Distance": 18,
    "Code": "0"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "inputservm",
    "Distance": 19,
    "Code": "0"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "inputmanum",
    "Distance": 20,
    "Code": "0"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "inputmatem",
    "Distance": 21,
    "Code": "0"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "inputenerm",
    "Distance": 22,
    "Code": "0"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "inputagrim",
    "Distance": 23,
    "Code": "0"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "ENRGDP",
    "Distance": 25,
    "Code": "0"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "GDPPC",
    "Distance": 1540,
    "Code": "0"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "CLIMECONIMP",
    "Distance": 7,
    "Code": "\r'bbh 2019/03/15 start\rClimImp = CSng(Amin(0.5, (SClimEconImp(R%) - ClimEconImpI(R%)) / 100)) 'bbh 2020/02/24 2 lines\r\r\rFor S% = 1 To NSec%\r\r'  All but First 2: Update CDALF and Sectoral Alphas\r'  -------------------------------------------------\r\ralphas(R%, S%) = CDALF(R%) * salphas(R%, S%)\ralphas(R%, S%) = AMAX(0, Amin(alphas(R%, S%), 1))\r\r'  All but First 2: Determine Potential Value Added\r'  ------------------------------------------------\rIf ((S% > Ener) OrElse (S% = Agri AndAlso agon < 0.9) OrElse (S% = Ener AndAlso enon < 0.9)) Then\rvadd_k = CSng(KS(R%, S%) ^ alphas(R%, S%))\rvadd_l = CSng(LABS(R%, S%) ^ (1.0! - alphas(R%, S%)))\r'If IY >= 2 And GRPS(1, R) = \"United States of America\" And S = 5 Then Stop\rVADD(R%, S%) = cda(R%, S%) * tef(R%, S%) * vadd_k * vadd_l\rIf climeconimpsw > 0.5 Then 'bbh 2017/10/04\r'bbh 2020/02/24 start\r'   2 forces can work to offset the impact of climate change on VADD:\r'    1. tef rises becuase some of the changes, like education advance, occur even\r'        without rise in GDPPCP; the residuals pass through to productivity rise relative\r'        to scenarios without climate change turned on\r'    2. When VADD is held back, it was slowing down rise in GDPPOT, SGDPPOTPCDALF and egdppcp (above)\r'        That was causing CDALPH to rise relative to the base case\r'        (capital share is higher in less developed countries); fixed in code for SGDPPOTPCDALF\r'    But Nordhaus parameterization of impact was net of all other effects including education etc/TEF\r'    Since that effect was cutting the impact of climate change on Value added by about 1/2,\r'    I doubled it here\r'VADD(R%, S%) = VADD(R%, S%) * (1 - ClimImp * 2)\rVADD(R%, S%) = VADD(R%, S%) * (1 - ClimImp)  'bbh 2022/06/23 Removed the factor of 2 shown in RCP analysis to be overshooting impact\r'Changed the sign so that the growth rate impact shows as negative with\r'    ClimImp being postive with impact; also changed so that shows\r'    full impact magnitude climb from year 1; was just difference\r'ECGRCLIMGDP(R%, S%) = -ClimImp * 2 * 100\rECGRCLIMGDP(R%, S%) = -ClimImp * 100 'bbh 2022/06/23 Removed the factor of 2 shown in RCP analysis to be overshooting impact\rEnd If\rVADD(R%, S%) = AMAX(0.0001, Amin(VADD(R%, S%), 100000))\rElseIf S% = Agri And envylchgm(R%) < 0.01 And climeconimpsw > 0.5 Then\r'bbh 2022/06/23 Added elseIF branch to possibly add general economy impact if direct climate impact on yield is simultaneously shut down\rZS(R%, S%) = ZS(R%, S%) * (1 - ClimImp)\rEnd If\r'If RegName$(R%) = \"Ukraine\" And S% = 2 Then Stop\rNext S%\r\r\rFor S% = 1 To NSec%\r\r'  All but First 2: Update CDALF and Sectoral Alphas\r'  -------------------------------------------------\r\ralphas(R%, S%) = CDALF(R%) * salphas(R%, S%)\ralphas(R%, S%) = AMAX(0, Amin(alphas(R%, S%), 1))\r\r'  All but First 2: Determine Potential Value Added\r'  ------------------------------------------------\rIf ((S% > Ener) OrElse (S% = Agri AndAlso agon < 0.9) OrElse (S% = Ener AndAlso enon < 0.9)) Then\rvadd_k = CSng(KS(R%, S%) ^ alphas(R%, S%))\rvadd_l = CSng(LABS(R%, S%) ^ (1.0! - alphas(R%, S%)))\r'If IY >= 2 And GRPS(1, R) = \"United States of America\" And S = 5 Then Stop\rVADD(R%, S%) = cda(R%, S%) * tef(R%, S%) * vadd_k * vadd_l\rIf climeconimpsw > 0.5 Then 'bbh 2017/10/04\r'bbh 2020/02/24 start\r'   2 forces can work to offset the impact of climate change on VADD:\r'    1. tef rises becuase some of the changes, like education advance, occur even\r'        without rise in GDPPCP; the residuals pass through to productivity rise relative\r'        to scenarios without climate change turned on\r'    2. When VADD is held back, it was slowing down rise in GDPPOT, SGDPPOTPCDALF and egdppcp (above)\r'        That was causing CDALPH to rise relative to the base case\r'        (capital share is higher in less developed countries); fixed in code for SGDPPOTPCDALF\r'    But Nordhaus parameterization of impact was net of all other effects including education etc/TEF\r'    Since that effect was cutting the impact of climate change on Value added by about 1/2,\r'    I doubled it here\r'VADD(R%, S%) = VADD(R%, S%) * (1 - ClimImp * 2)\rVADD(R%, S%) = VADD(R%, S%) * (1 - ClimImp)  'bbh 2022/06/23 Removed the factor of 2 shown in RCP analysis to be overshooting impact\r'Changed the sign so that the growth rate impact shows as negative with\r'    ClimImp being postive with impact; also changed so that shows\r'    full impact magnitude climb from year 1; was just difference\r'ECGRCLIMGDP(R%, S%) = -ClimImp * 2 * 100\rECGRCLIMGDP(R%, S%) = -ClimImp * 100 'bbh 2022/06/23 Removed the factor of 2 shown in RCP analysis to be overshooting impact\rEnd If\rVADD(R%, S%) = AMAX(0.0001, Amin(VADD(R%, S%), 100000))\rElseIf S% = Agri And envylchgm(R%) < 0.01 And climeconimpsw > 0.5 Then\r'bbh 2022/06/23 Added elseIF branch to possibly add general economy impact if direct climate impact on yield is simultaneously shut down\rZS(R%, S%) = ZS(R%, S%) * (1 - ClimImp)\rEnd If\r'If RegName$(R%) = \"Ukraine\" And S% = 2 Then Stop\rNext S%\r"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "KS",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "LABS",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "CDALF",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "salpha",
    "Distance": 1608,
    "Code": "0"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "GDPP",
    "Distance": 616,
    "Code": "\r\rFor S% = 1 To NSec%\rSUM1 = SUM1 + CDALF(R%) * VADD(R%, S%)\rSum2 = Sum2 + salpha(S%) * VADD(R%, S%)\rNext S%\r"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "igdpr",
    "Distance": 616,
    "Code": "\r\rFor S% = 1 To NSec%\rSUM1 = SUM1 + CDALF(R%) * VADD(R%, S%)\rSum2 = Sum2 + salpha(S%) * VADD(R%, S%)\rNext S%\r"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "POP",
    "Distance": 616,
    "Code": "\r\rFor S% = 1 To NSec%\rSUM1 = SUM1 + CDALF(R%) * VADD(R%, S%)\rSum2 = Sum2 + salpha(S%) * VADD(R%, S%)\rNext S%\r"
  },
  {
    "Variable": "VADD",
    "UsesVariable": "POPR",
    "Distance": 616,
    "Code": "\r\rFor S% = 1 To NSec%\rSUM1 = SUM1 + CDALF(R%) * VADD(R%, S%)\rSum2 = Sum2 + salpha(S%) * VADD(R%, S%)\rNext S%\r"
  },
  {
    "Variable": "VADDF",
    "UsesVariable": "VADD",
    "Distance": 0,
    "Code": "\rFor S% = 1 To NSec%\rVADDHHU(R%, S%) = VADDHHU(R%, S%) * (1 - CDALF(R%))\rHHINCEARN(R%, Unskilled) = HHINCEARN(R%, Unskilled) + VADDHHU(R%, S%)\rVADDHHS(R%, S%) = VADDHHS(R%, S%) * (1 - CDALF(R%))\rHHINCEARN(R%, Skilled) = HHINCEARN(R%, Skilled) + VADDHHS(R%, S%)\r'bbh 2020/08/05 Start\r'VADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'bbh 2020/08/20 start\r\r'bbh 2021/08/04 start  Total VADD finalized in IFsEco; household adjusts with CAPUT to help on stocks, above; change firm but leave VADD total alone\r'If CAPUT(R%, S%) > caputtar And gdprext(R%) < -70 Then\r'If CAPUT(R%, S%) > caputtar And gdprext(R%) > -70 Then 'bbh 2021/07/07 start 'bbh 2021/08/04\r'            If gdprext(R%) > -70 Then 'bbh 2021/08/04 Growth exogenous\r'                'VADDF(R%, S%) = (VADD(R%, S%) / ((CAPUT(R%, S%) / caputtar) ^ 0.5)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                VADDF(R%, S%) = (VADD(R%, S%) / (CAPUT(R%, S%) / caputtar)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                'VADDF(R%, S%) = (VaddPreCaput(R%, S%) / (CAPUT(R%, S%) / caputtar)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'            Else 'growth is endogenous\r'                VADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                'VADDF(R%, S%) = VaddPreCaput(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'            End If\rVADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'bbh 2021/08/04 end\r\r'bbh 2021/07/07 end\r'bbh 2020/08/20 end\r'bbh 2020/08/05 end\rFIRMEARN(R%) = FIRMEARN(R%) + VADDF(R%, S%)\rNext S%\r"
  },
  {
    "Variable": "VADDF",
    "UsesVariable": "VADDHHU",
    "Distance": 0,
    "Code": "\rFor S% = 1 To NSec%\rVADDHHU(R%, S%) = VADDHHU(R%, S%) * (1 - CDALF(R%))\rHHINCEARN(R%, Unskilled) = HHINCEARN(R%, Unskilled) + VADDHHU(R%, S%)\rVADDHHS(R%, S%) = VADDHHS(R%, S%) * (1 - CDALF(R%))\rHHINCEARN(R%, Skilled) = HHINCEARN(R%, Skilled) + VADDHHS(R%, S%)\r'bbh 2020/08/05 Start\r'VADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'bbh 2020/08/20 start\r\r'bbh 2021/08/04 start  Total VADD finalized in IFsEco; household adjusts with CAPUT to help on stocks, above; change firm but leave VADD total alone\r'If CAPUT(R%, S%) > caputtar And gdprext(R%) < -70 Then\r'If CAPUT(R%, S%) > caputtar And gdprext(R%) > -70 Then 'bbh 2021/07/07 start 'bbh 2021/08/04\r'            If gdprext(R%) > -70 Then 'bbh 2021/08/04 Growth exogenous\r'                'VADDF(R%, S%) = (VADD(R%, S%) / ((CAPUT(R%, S%) / caputtar) ^ 0.5)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                VADDF(R%, S%) = (VADD(R%, S%) / (CAPUT(R%, S%) / caputtar)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                'VADDF(R%, S%) = (VaddPreCaput(R%, S%) / (CAPUT(R%, S%) / caputtar)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'            Else 'growth is endogenous\r'                VADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                'VADDF(R%, S%) = VaddPreCaput(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'            End If\rVADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'bbh 2021/08/04 end\r\r'bbh 2021/07/07 end\r'bbh 2020/08/20 end\r'bbh 2020/08/05 end\rFIRMEARN(R%) = FIRMEARN(R%) + VADDF(R%, S%)\rNext S%\r"
  },
  {
    "Variable": "VADDF",
    "UsesVariable": "VADDHHS",
    "Distance": 0,
    "Code": "\rFor S% = 1 To NSec%\rVADDHHU(R%, S%) = VADDHHU(R%, S%) * (1 - CDALF(R%))\rHHINCEARN(R%, Unskilled) = HHINCEARN(R%, Unskilled) + VADDHHU(R%, S%)\rVADDHHS(R%, S%) = VADDHHS(R%, S%) * (1 - CDALF(R%))\rHHINCEARN(R%, Skilled) = HHINCEARN(R%, Skilled) + VADDHHS(R%, S%)\r'bbh 2020/08/05 Start\r'VADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'bbh 2020/08/20 start\r\r'bbh 2021/08/04 start  Total VADD finalized in IFsEco; household adjusts with CAPUT to help on stocks, above; change firm but leave VADD total alone\r'If CAPUT(R%, S%) > caputtar And gdprext(R%) < -70 Then\r'If CAPUT(R%, S%) > caputtar And gdprext(R%) > -70 Then 'bbh 2021/07/07 start 'bbh 2021/08/04\r'            If gdprext(R%) > -70 Then 'bbh 2021/08/04 Growth exogenous\r'                'VADDF(R%, S%) = (VADD(R%, S%) / ((CAPUT(R%, S%) / caputtar) ^ 0.5)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                VADDF(R%, S%) = (VADD(R%, S%) / (CAPUT(R%, S%) / caputtar)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                'VADDF(R%, S%) = (VaddPreCaput(R%, S%) / (CAPUT(R%, S%) / caputtar)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'            Else 'growth is endogenous\r'                VADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                'VADDF(R%, S%) = VaddPreCaput(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'            End If\rVADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'bbh 2021/08/04 end\r\r'bbh 2021/07/07 end\r'bbh 2020/08/20 end\r'bbh 2020/08/05 end\rFIRMEARN(R%) = FIRMEARN(R%) + VADDF(R%, S%)\rNext S%\r"
  },
  {
    "Variable": "VADDHHS",
    "UsesVariable": "CDALF",
    "Distance": 0,
    "Code": "\rFor S% = 1 To NSec%\rVADDHHU(R%, S%) = VADDHHU(R%, S%) * (1 - CDALF(R%))\rHHINCEARN(R%, Unskilled) = HHINCEARN(R%, Unskilled) + VADDHHU(R%, S%)\rVADDHHS(R%, S%) = VADDHHS(R%, S%) * (1 - CDALF(R%))\rHHINCEARN(R%, Skilled) = HHINCEARN(R%, Skilled) + VADDHHS(R%, S%)\r'bbh 2020/08/05 Start\r'VADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'bbh 2020/08/20 start\r\r'bbh 2021/08/04 start  Total VADD finalized in IFsEco; household adjusts with CAPUT to help on stocks, above; change firm but leave VADD total alone\r'If CAPUT(R%, S%) > caputtar And gdprext(R%) < -70 Then\r'If CAPUT(R%, S%) > caputtar And gdprext(R%) > -70 Then 'bbh 2021/07/07 start 'bbh 2021/08/04\r'            If gdprext(R%) > -70 Then 'bbh 2021/08/04 Growth exogenous\r'                'VADDF(R%, S%) = (VADD(R%, S%) / ((CAPUT(R%, S%) / caputtar) ^ 0.5)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                VADDF(R%, S%) = (VADD(R%, S%) / (CAPUT(R%, S%) / caputtar)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                'VADDF(R%, S%) = (VaddPreCaput(R%, S%) / (CAPUT(R%, S%) / caputtar)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'            Else 'growth is endogenous\r'                VADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                'VADDF(R%, S%) = VaddPreCaput(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'            End If\rVADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'bbh 2021/08/04 end\r\r'bbh 2021/07/07 end\r'bbh 2020/08/20 end\r'bbh 2020/08/05 end\rFIRMEARN(R%) = FIRMEARN(R%) + VADDF(R%, S%)\rNext S%\r"
  },
  {
    "Variable": "VADDHHS",
    "UsesVariable": "VADD",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "VADDHHS",
    "UsesVariable": "gdprext",
    "Distance": 0,
    "Code": "\rFor S% = 1 To NSec%\r'            VADDHHU(R%, S%) = VADD(R%, S%) * LaborF(R%, Unskilled, S%)\r'            VADDHHS(R%, S%) = VADD(R%, S%) * LaborF(R%, Skilled, S%)\r'            'LABWAGES(R%, S%, Unskilled) = VAddFromLab * LABWAGESSHRSKL(R%, S%, Unskilled) / 100 / AMAX(0.0001, LABEMPS(R%, S%, Unskilled))\r\rVADDHHU(R%, S%) = LABWAGES(R%, S%, Unskilled) * LABEMPS(R%, S%, Unskilled)\rVADDHHS(R%, S%) = LABWAGES(R%, S%, Skilled) * LABEMPS(R%, S%, Skilled)\r\r'  Debug.Print RegName(R%); \",\"; IY; \",\"; S%; \",\"; LABEMPS(R%, S%, Skilled); \",\"; LABEMPS(R%, S%, Unskilled); \",\"; LABWAGES(R%, S%, Skilled); \",\"; LABWAGES(R%, S%, Unskilled)\r\rVAddCalc = VADDHHU(R%, S%) + VADDHHS(R%, S%)\rVADDHHU(R%, S%) = VADDHHU(R%, S%) * VADD(R%, S%) / AMAX(0.001, VAddCalc)    ' (1 - alphas(R%, S%))\rVADDHHS(R%, S%) = VADDHHS(R%, S%) * VADD(R%, S%) / AMAX(0.001, VAddCalc)\r\r\r'                    VADDHHU(R%, S%) = VADDHHU(R%, S%) * VADD(R%, S%) * (1 - alphas(R%, S%)) / AMAX(0.001, VAddCalc)  ' (1 - alphas(R%, S%))\r'                    VADDHHS(R%, S%) = VADDHHS(R%, S%) * VADD(R%, S%) * (1 - alphas(R%, S%)) / AMAX(0.001, VAddCalc)\r\r\rVADDHHUTot = VADDHHUTot + VADDHHU(R%, S%)\rVADDHHSTot = VADDHHSTot + VADDHHS(R%, S%)\r\r\rNext S%\r"
  },
  {
    "Variable": "VADDHHS",
    "UsesVariable": "VADDHHU",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "VADDHHS",
    "UsesVariable": "LABWAGES",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "VADDHHS",
    "UsesVariable": "LABEMPS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "VADDHHU",
    "UsesVariable": "CDALF",
    "Distance": 0,
    "Code": "\rFor S% = 1 To NSec%\rVADDHHU(R%, S%) = VADDHHU(R%, S%) * (1 - CDALF(R%))\rHHINCEARN(R%, Unskilled) = HHINCEARN(R%, Unskilled) + VADDHHU(R%, S%)\rVADDHHS(R%, S%) = VADDHHS(R%, S%) * (1 - CDALF(R%))\rHHINCEARN(R%, Skilled) = HHINCEARN(R%, Skilled) + VADDHHS(R%, S%)\r'bbh 2020/08/05 Start\r'VADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'bbh 2020/08/20 start\r\r'bbh 2021/08/04 start  Total VADD finalized in IFsEco; household adjusts with CAPUT to help on stocks, above; change firm but leave VADD total alone\r'If CAPUT(R%, S%) > caputtar And gdprext(R%) < -70 Then\r'If CAPUT(R%, S%) > caputtar And gdprext(R%) > -70 Then 'bbh 2021/07/07 start 'bbh 2021/08/04\r'            If gdprext(R%) > -70 Then 'bbh 2021/08/04 Growth exogenous\r'                'VADDF(R%, S%) = (VADD(R%, S%) / ((CAPUT(R%, S%) / caputtar) ^ 0.5)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                VADDF(R%, S%) = (VADD(R%, S%) / (CAPUT(R%, S%) / caputtar)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                'VADDF(R%, S%) = (VaddPreCaput(R%, S%) / (CAPUT(R%, S%) / caputtar)) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'            Else 'growth is endogenous\r'                VADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'                'VADDF(R%, S%) = VaddPreCaput(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'            End If\rVADDF(R%, S%) = VADD(R%, S%) - VADDHHU(R%, S%) - VADDHHS(R%, S%)\r'bbh 2021/08/04 end\r\r'bbh 2021/07/07 end\r'bbh 2020/08/20 end\r'bbh 2020/08/05 end\rFIRMEARN(R%) = FIRMEARN(R%) + VADDF(R%, S%)\rNext S%\r"
  },
  {
    "Variable": "VADDHHU",
    "UsesVariable": "VADD",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "VADDHHU",
    "UsesVariable": "VADDHHS",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "VADDHHU",
    "UsesVariable": "LABWAGES",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "VADDHHU",
    "UsesVariable": "LABEMPS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "VEHICFLPC",
    "UsesVariable": "GDPPCP",
    "Distance": 135,
    "Code": "0"
  },
  {
    "Variable": "VEHICFLPC",
    "UsesVariable": "POP",
    "Distance": 136,
    "Code": "0"
  },
  {
    "Variable": "VEHICFLPC",
    "UsesVariable": "LANDAREA",
    "Distance": 136,
    "Code": "0"
  },
  {
    "Variable": "VEHICFLPC",
    "UsesVariable": "vehicflpcm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "VEHICLESTOT",
    "UsesVariable": "VEHICFLPC",
    "Distance": 0,
    "Code": "\r\r'jrs 2007/10/18, in units\rVEHICLESTOT(R%) = VEHICFLPC(R%) * POP(R%) * 1000\r"
  },
  {
    "Variable": "VEHICLESTOT",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r\r'jrs 2007/10/18, in units\rVEHICLESTOT(R%) = VEHICFLPC(R%) * POP(R%) * 1000\r"
  },
  {
    "Variable": "WAP",
    "UsesVariable": "fprimt1",
    "Distance": 1,
    "Code": "\rwcumstkbalancechangefish = wcumstkbalancechangefish + balance - sbalance(R%, 3)\r\rwcumstkbalancefish = wcumstkbalancefish + balance\r\rwstkbasefish = wstkbasefish + dmbase\r\r'dsr 2015/06/29 Calculate global fish price index based on global stocks and assign same value to all countries\r'Call ADJSTR(wstkbasefish, wcumstkbalancefish, wcumstkbalancechangefish, _\r'fprimt1 * 1.5, fprimt2 * 1.5, Mul)\rCall ADJSTR(wstkbasefish, wcumstkbalancefish, wcumstkbalancechangefish,\r        fprimt1 * 2.5!, fprimt2 * 2.5!, Mul)\r\rWAP(3) = WAP(3) * Mul\r"
  },
  {
    "Variable": "WAP",
    "UsesVariable": "fprimt2",
    "Distance": 1,
    "Code": "\rwcumstkbalancechangefish = wcumstkbalancechangefish + balance - sbalance(R%, 3)\r"
  },
  {
    "Variable": "WAP",
    "UsesVariable": "AGDEM",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "WAP",
    "UsesVariable": "AGP",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "WAP",
    "UsesVariable": "FSTOCK",
    "Distance": 56,
    "Code": "0"
  },
  {
    "Variable": "WAP",
    "UsesVariable": "dstl",
    "Distance": 614,
    "Code": "0"
  },
  {
    "Variable": "WAP",
    "UsesVariable": "ifsexomodelid",
    "Distance": 614,
    "Code": "0"
  },
  {
    "Variable": "WAP",
    "UsesVariable": "agstkadjsw",
    "Distance": 72,
    "Code": "0"
  },
  {
    "Variable": "WAP",
    "UsesVariable": "AGX",
    "Distance": 79,
    "Code": "0"
  },
  {
    "Variable": "WAP",
    "UsesVariable": "AGM",
    "Distance": 79,
    "Code": "0"
  },
  {
    "Variable": "WAP",
    "UsesVariable": "FPRI",
    "Distance": 1,
    "Code": "\r'   All but First 1:  World Price Computation\r'   -----------------------------------\r\rFor f% = 1 To 3\rDim TAGP = 0!\rDim TFPRI = 0!\rFor R% = 1 To NR%\r'jrs 2007/01/12 no double counting\rIf RegiontoSum(R%) Then\r'dsr 2015/06/15 Use post-loss production\rTAGP = TAGP + AGP(R%, f%)\r'            TFPRI = TFPRI + FPRI(r%, f%) * EXRATE(r%) * AGP(r%, f%)\r'dsr 2015/06/29 Simplify since same equation now used for all commodities\r'                If f% < 3 Then\r'                  TFPRI = TFPRI + FPRI(R%, f%) * AGP(R%, f%)\r'                Else\r'                  TFPRI = TFPRI + FPRI(R%, 3) * AGP(R%, f%)\r'                End If '(if f% < 3)\rTFPRI = TFPRI + FPRI(R%, f%) * AGP(R%, f%)\rEnd If\rNext R%\rWAP(f%) = TFPRI / TAGP\rNext f%\r\r'   All but First 1:  World Price Computation\r'   -----------------------------------\r\rFor f% = 1 To 3\rDim TAGP = 0!\rDim TFPRI = 0!\rFor R% = 1 To NR%\r'jrs 2007/01/12 no double counting\rIf RegiontoSum(R%) Then\r'dsr 2015/06/15 Use post-loss production\rTAGP = TAGP + AGP(R%, f%)\r'            TFPRI = TFPRI + FPRI(r%, f%) * EXRATE(r%) * AGP(r%, f%)\r'dsr 2015/06/29 Simplify since same equation now used for all commodities\r'                If f% < 3 Then\r'                  TFPRI = TFPRI + FPRI(R%, f%) * AGP(R%, f%)\r'                Else\r'                  TFPRI = TFPRI + FPRI(R%, 3) * AGP(R%, f%)\r'                End If '(if f% < 3)\rTFPRI = TFPRI + FPRI(R%, f%) * AGP(R%, f%)\rEnd If\rNext R%\rWAP(f%) = TFPRI / TAGP\rNext f%\r\r'   All but First 1:  World Price Computation\r'   -----------------------------------\r\rFor f% = 1 To 3\rDim TAGP = 0!\rDim TFPRI = 0!\rFor R% = 1 To NR%\r'jrs 2007/01/12 no double counting\rIf RegiontoSum(R%) Then\r'dsr 2015/06/15 Use post-loss production\rTAGP = TAGP + AGP(R%, f%)\r'            TFPRI = TFPRI + FPRI(r%, f%) * EXRATE(r%) * AGP(r%, f%)\r'dsr 2015/06/29 Simplify since same equation now used for all commodities\r'                If f% < 3 Then\r'                  TFPRI = TFPRI + FPRI(R%, f%) * AGP(R%, f%)\r'                Else\r'                  TFPRI = TFPRI + FPRI(R%, 3) * AGP(R%, f%)\r'                End If '(if f% < 3)\rTFPRI = TFPRI + FPRI(R%, f%) * AGP(R%, f%)\rEnd If\rNext R%\rWAP(f%) = TFPRI / TAGP\rNext f%\r\r'   All but First 1:  World Price Computation\r'   -----------------------------------\r\rFor f% = 1 To 3\rDim TAGP = 0!\rDim TFPRI = 0!\rFor R% = 1 To NR%\r'jrs 2007/01/12 no double counting\rIf RegiontoSum(R%) Then\r'dsr 2015/06/15 Use post-loss production\rTAGP = TAGP + AGP(R%, f%)\r'            TFPRI = TFPRI + FPRI(r%, f%) * EXRATE(r%) * AGP(r%, f%)\r'dsr 2015/06/29 Simplify since same equation now used for all commodities\r'                If f% < 3 Then\r'                  TFPRI = TFPRI + FPRI(R%, f%) * AGP(R%, f%)\r'                Else\r'                  TFPRI = TFPRI + FPRI(R%, 3) * AGP(R%, f%)\r'                End If '(if f% < 3)\rTFPRI = TFPRI + FPRI(R%, f%) * AGP(R%, f%)\rEnd If\rNext R%\rWAP(f%) = TFPRI / TAGP\rNext f%\r\r'   All but First 1:  World Price Computation\r'   -----------------------------------\r\rFor f% = 1 To 3\rDim TAGP = 0!\rDim TFPRI = 0!\rFor R% = 1 To NR%\r'jrs 2007/01/12 no double counting\rIf RegiontoSum(R%) Then\r'dsr 2015/06/15 Use post-loss production\rTAGP = TAGP + AGP(R%, f%)\r'            TFPRI = TFPRI + FPRI(r%, f%) * EXRATE(r%) * AGP(r%, f%)\r'dsr 2015/06/29 Simplify since same equation now used for all commodities\r'                If f% < 3 Then\r'                  TFPRI = TFPRI + FPRI(R%, f%) * AGP(R%, f%)\r'                Else\r'                  TFPRI = TFPRI + FPRI(R%, 3) * AGP(R%, f%)\r'                End If '(if f% < 3)\rTFPRI = TFPRI + FPRI(R%, f%) * AGP(R%, f%)\rEnd If\rNext R%\rWAP(f%) = TFPRI / TAGP\rNext f%\r\r'   All but First 1:  World Price Computation\r'   -----------------------------------\r\rFor f% = 1 To 3\rDim TAGP = 0!\rDim TFPRI = 0!\rFor R% = 1 To NR%\r'jrs 2007/01/12 no double counting\rIf RegiontoSum(R%) Then\r'dsr 2015/06/15 Use post-loss production\rTAGP = TAGP + AGP(R%, f%)\r'            TFPRI = TFPRI + FPRI(r%, f%) * EXRATE(r%) * AGP(r%, f%)\r'dsr 2015/06/29 Simplify since same equation now used for all commodities\r'                If f% < 3 Then\r'                  TFPRI = TFPRI + FPRI(R%, f%) * AGP(R%, f%)\r'                Else\r'                  TFPRI = TFPRI + FPRI(R%, 3) * AGP(R%, f%)\r'                End If '(if f% < 3)\rTFPRI = TFPRI + FPRI(R%, f%) * AGP(R%, f%)\rEnd If\rNext R%\rWAP(f%) = TFPRI / TAGP\rNext f%\r"
  },
  {
    "Variable": "WASTEWATERSUPPLY",
    "UsesVariable": "WATPRICE",
    "Distance": 109,
    "Code": "COMPLETE STRUCTURE:End Sub:391|\r\rPublic Sub IfsWater1AllbutFirstYear(context As IForecastContext)\r'AllButFirst:\r\r'All But First: Wraps from previous years\r'----------------------------------------\r'ttt 2019/10/08 TakeOut\rArray.Copy(swatprice, WATPRICE, NR + 1)\rArray.Copy(sdemandsupplyratiowater, DemandSupplyRatioWater, NR + 1)\rArray.Copy(swatertotalsupply, WATERTOTALSUPPLY, NR + 1)\r\rFor R% = 1 To NR%\r'If RegName$(R%) = \"Jordan\" Then Stop\r'If RegName$(R%) = \"Saudi Arabia\" Then Stop\r'ttt 2019/10/08 TakenOut\r'WATPRICE(R%) = swatprice(R%)\rDim proportionchangeinwatprice = (swatprice(R%) - 100.0!) / 100.0!\r\r'sgh 2018/02/14 - END\r'    swatwithdground(R%) = WATERWITHDRAWAL(R%, 2)\r'    swatwithdground(R%) = WATRESEXPLOITRENEW(R%, 2)\r'    WATERWITHDRAWAL(R%, 2) = swatwithdground(R%)\r'If RegName$(R%) = \"Nicaragua\" Then Stop\r\r'    WASTEWATERSUPPLY(R%, 3) = Amin(WASTEWATERSUPPLY(R%, 2), WASTEWATERSUPPLY(R%, 3) * (1 + (proportionchangeinwatprice * 0.5)))\r'    sWastewaterTreatedReused(R%) = WASTEWATERSUPPLY(R%, 3)\r\r'Constrain treated wastewater by price\rWASTEWATERSUPPLY(R%, 2) = CSng(Amin(WASTEWATERSUPPLY(R%, 1), WASTEWATERSUPPLY(R%, 2) * (1 + (proportionchangeinwatprice * 0.5))))\r"
  },
  {
    "Variable": "WASTEWATERSUPPLY",
    "UsesVariable": "wastewatportreatreusedm",
    "Distance": 0,
    "Code": "\r'If RegName$(R%) = \"Iran\" Then Stop\r'sgh 2014/03/09\rReusedPortionTreated(R%) = WASTEWATERSUPPLY(R%, 3) / WASTEWATERSUPPLY(R%, 2)\r\r\r'    WASTEWATERSUPPLY(R%, 3) = WASTEWATERSUPPLY(R%, 2) * ReusedPortionTreated(R%) * (1 + (0.005 * _\r'        DemandSupplyRatio(R%)))\r\r'bbh 2019/04/02\rWASTEWATERSUPPLY(R%, 3) = WASTEWATERSUPPLY(R%, 2) * ReusedPortionTreated(R%) * wastewatportreatreusedm(R%)\r\rWASTEWATERSUPPLY(R%, 3) = AMAX(0, Amin(WASTEWATERSUPPLY(R%, 2), WASTEWATERSUPPLY(R%, 3)))\r"
  },
  {
    "Variable": "WASTEWATERSUPPLY",
    "UsesVariable": "wastewatertreatedm",
    "Distance": 0,
    "Code": "\rResidTreated(R%) = ExpectedTreated(R%) - WASTEWATERSUPPLY(R%, 2)\r\r\r'sgh 2014/05/09\r'if user enters wastewaterportiontreated then use that portion instead\rExpectedTreated(R%) = TreatedPortionProduced(R%) * WASTEWATERSUPPLY(R%, 1)\r\r\rIf wastewaterportiontreated(R%) <> 0 Then\rWASTEWATERSUPPLY(R%, 2) = wastewaterportiontreated(R%) * WASTEWATERSUPPLY(R%, 1)\rElse\rWASTEWATERSUPPLY(R%, 2) = (ExpectedTreated(R%) - ResidTreated(R%)) * wastewatertreatedm(R%)\r'Resid(ual)Treated is absolute amount computed in first year, not changed over time\rEnd If\r\r\r'bbh 2019/04/02 start\r'    If WASTEWATERSUPPLY(R%, 2) < 0 Then\r'        WASTEWATERSUPPLY(R%, 2) = 0\r'    End If\rWASTEWATERSUPPLY(R%, 2) = AMAX(0, Amin(WASTEWATERSUPPLY(R%, 1), WASTEWATERSUPPLY(R%, 2)))\r"
  },
  {
    "Variable": "WASTEWATERSUPPLY",
    "UsesVariable": "wastewaterportiontreated",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WASTEWATERSUPPLY",
    "UsesVariable": "GDPPCP",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "WASTEWATERSUPPLY",
    "UsesVariable": "WATDEMAND",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "WATDEMAND",
    "UsesVariable": "LANDIRAREAACTUAL",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WATDEMAND",
    "UsesVariable": "waterdemandm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WATDEMAND",
    "UsesVariable": "watdemandelas",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WATDEMAND",
    "UsesVariable": "WATPRICE",
    "Distance": 97,
    "Code": "0"
  },
  {
    "Variable": "WATDEMAND",
    "UsesVariable": "VADD",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "WATDEMAND",
    "UsesVariable": "INFRAELECPROD",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "WATDEMAND",
    "UsesVariable": "GDPPCP",
    "Distance": 15,
    "Code": "0"
  },
  {
    "Variable": "WATDEMAND",
    "UsesVariable": "ENP",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "WATDEMAND",
    "UsesVariable": "WATERTOTALSUPPLY",
    "Distance": 17,
    "Code": "0"
  },
  {
    "Variable": "WATDEMAND",
    "UsesVariable": "POP",
    "Distance": 17,
    "Code": "0"
  },
  {
    "Variable": "WATDEMAND",
    "UsesVariable": "POPURBAN",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "WATDEMAND",
    "UsesVariable": "WATSAFE",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "WATDEMAND",
    "UsesVariable": "LANDIRAREAEQUIP",
    "Distance": 69,
    "Code": "\rswatdemandag(R%) = WATDEMAND(R%, 3)\r"
  },
  {
    "Variable": "WATDEMPERHA",
    "UsesVariable": "WATDEMAND",
    "Distance": 0,
    "Code": "\rWATDEMPERHA(R%) = WATDEMAND(R%, 3) / LANDIRAREAACTUAL(R%) * 1000000\r"
  },
  {
    "Variable": "WATDEMPERHA",
    "UsesVariable": "LANDIRAREAACTUAL",
    "Distance": 0,
    "Code": "\rWATDEMPERHA(R%) = WATDEMAND(R%, 3) / LANDIRAREAACTUAL(R%) * 1000000\r"
  },
  {
    "Variable": "WATERDESALINATED",
    "UsesVariable": "waterdesalinatedgr",
    "Distance": 0,
    "Code": "\r'If RegName$(R%) = \"Nicaragua\" Then Stop\r'If RegName$(R%) = \"Rwanda\" Then Stop\r\r'sgh 2018/01/18 - START\r'If RegName$(R%) = \"Saudi Arabia\" Then Stop\r'If RegName$(R%) = \"Egypt\" AndAlso IY% >= 21 Then Stop\r\rCall ADJSTR(100, (swatprice(R%) * Mul) - 100, ((swatprice(R%) * Mul) - swatprice(R%)),\r                desali, desald, mul2)\r\rWATERDESALINATED(R%) = Amin(swaterdesalinated(R%) * mul2,\r                swaterdesalinated(R%) * (1 + (waterdesalinatedgr(R%) / 100)))\r"
  },
  {
    "Variable": "WATERDESALINATED",
    "UsesVariable": "WATPRICE",
    "Distance": 1,
    "Code": "\r'If RegName$(R%) = \"Nicaragua\" Then Stop\r'If RegName$(R%) = \"Rwanda\" Then Stop\r\r'sgh 2018/01/18 - START\r'If RegName$(R%) = \"Saudi Arabia\" Then Stop\r'If RegName$(R%) = \"Egypt\" AndAlso IY% >= 21 Then Stop\r\rCall ADJSTR(100, (swatprice(R%) * Mul) - 100, ((swatprice(R%) * Mul) - swatprice(R%)),\r                desali, desald, mul2)\r"
  },
  {
    "Variable": "WATERDESALINATED",
    "UsesVariable": "desali",
    "Distance": 1,
    "Code": "\rCall ADJSTR(1, DemandSupplyRatioWater(R%) - 1, (DemandSupplyRatioWater(R%) - sdemandsupplyratiowater(R%)),\r        watprii, watprid, Mul)\r"
  },
  {
    "Variable": "WATERDESALINATED",
    "UsesVariable": "desald",
    "Distance": 1,
    "Code": "\rCall ADJSTR(1, DemandSupplyRatioWater(R%) - 1, (DemandSupplyRatioWater(R%) - sdemandsupplyratiowater(R%)),\r        watprii, watprid, Mul)\r"
  },
  {
    "Variable": "WATERDESALINATED",
    "UsesVariable": "watprii",
    "Distance": 2,
    "Code": "\rsdemandsupplyratiowater(R%) = iDemandSupplyRatioWater(R%)\r\rIf DemandSupplyRatioWater(R%) < 0 Then DemandSupplyRatioWater(R%) = 0.01\r"
  },
  {
    "Variable": "WATERDESALINATED",
    "UsesVariable": "watprid",
    "Distance": 2,
    "Code": "\rsdemandsupplyratiowater(R%) = iDemandSupplyRatioWater(R%)\r"
  },
  {
    "Variable": "WATERDESALINATED",
    "UsesVariable": "WATERTOTALSUPPLY",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "WATERDESALINATED",
    "UsesVariable": "WATDEMAND",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "WATERDESALINATED",
    "UsesVariable": "waterdesalinatedm",
    "Distance": 0,
    "Code": "\r'If RegName$(R%) = \"Saudi Arabia\" Then Stop\r'    WATERDESALINATED(R%) = Amin(swaterDesalinated(R%) * (1 + (waterdesalinatedgr(R%) / 100) * _\r'        (isharedemanddesal(R%) / ShareDemandDesal(R%)) ^ (1 / 20)), (remainingdesalpot(R%) / 20) + swaterDesalinated(R%))\r\r'sgh 2018/01/18 - START\r'do that after price is adjusted\r'    WATERDESALINATED(R%) = Amin(swaterdesalinated(R%) * (1 + (proportionchangeinwatprice * 0.5)), _\r'        swaterdesalinated(R%) * (1 + (waterdesalinatedgr(R%) / 100)))\r'sgh 2018/01/18 - END\r\r'If RegName$(R%) = \"Bahrain\" AndAlso IY% > 10 Then Stop\r'sgh 2014/09/04\r\r\r'sgh 2014/05/29\r'Do not let desalinted water force total water supply higher than total water demand.\r'If watertotaldemand(R%) < WATERTOTALSUPPLY(R%) AndAlso RegName$(R%) = \"Saudi Arabia\" Then Stop\r'    WATERTOTALDEMAND(R%) = WATDEMAND(R%, 1) + WATDEMAND(R%, 2) + WATDEMAND(R%, 3)\r'    If WATERTOTALSUPPLY(R%) > watertotaldemand(R%) AndAlso _\r'        WATERDESALINATED(R%) > watertotaldemand(R%) - sTotalWaterSupplyNoDesal(R%) _\r'            AndAlso watertotaldemand(R%) - sTotalWaterSupplyNoDesal(R%) > 0 Then\r''If RegName$(R%) = \"United States of America\" Then Stop\r'            WATERDESALINATED(R%) = AMAX((watertotaldemand(R%) - sTotalWaterSupplyNoDesal(R%)), swaterDesalinated(R%) * 0.98)\r'    End If\r'sgh 2014/05/29\r\r'sgh 2014/05/29\r'Limit exploitable surface water growth to .5% or 1/40 of remaining potential, whichever\r'is smaller. The maximum exploitable surface water (MaxExploitSurface) is 20% higher\r'than the initial exploitable surface water resources (iwatresexploitrenewsurface). This growth\r'in exploitable surface water does not include secondary water however i.e. treated wastewater that\r'is not directly reused. Thus, this must be subtracted from surface exploitable first.\r'If RegName$(R%) = \"Saudi Arabia\" AndAlso IY% > 10 Then Stop\r'    swaterdesalinated(R%) = WATERDESALINATED(R%)\rWATERDESALINATED(R%) = swaterdesalinated(R%) * waterdesalinatedm(R%)\r"
  },
  {
    "Variable": "WATERFILTERED",
    "UsesVariable": "waterfilteredm",
    "Distance": 0,
    "Code": "\r\r'mti July 25, 2012 -moved this - moved back to where it was to avoid run to run\r'sGDPPCP(R%) = GDPPCP(R%)\r\r'mti February 2011 Infarstructure - end\r\r\r'******** All Years but first: Water and Sanitation *********************\r'***************************** end *************************************\r'********'sum infrastructure investment across all infrastructure types (all years but 1): sum for first year is at IFsInfra (since that is called later\r'mti 2022/09/26 start\rIf watsafenewsw < 1 Then    'forward/funding linkage from watsan old (3 category)\r'mti 2022/09/26 End\rINFRAINVESTNEW(R%, InfraTot) = 0\rINFRAINVESTMAINT(R%, InfraTot) = 0\r\rINFRAINVESTNEWPUB(R%, InfraTot) = 0\rINFRAINVESTMAINTPUB(R%, InfraTot) = 0\r\rFor j = 1 To InfraTot - 1\rINFRAINVESTNEW(R%, InfraTot) = INFRAINVESTNEW(R%, InfraTot) + INFRAINVESTNEW(R%, j)\rINFRAINVESTMAINT(R%, InfraTot) = INFRAINVESTMAINT(R%, InfraTot) + INFRAINVESTMAINT(R%, j)\r\rINFRAINVESTNEWPUB(R%, InfraTot) = INFRAINVESTNEWPUB(R%, InfraTot) + INFRAINVESTNEWPUB(R%, j)\rINFRAINVESTMAINTPUB(R%, InfraTot) = INFRAINVESTMAINTPUB(R%, InfraTot) + INFRAINVESTMAINTPUB(R%, j)\rNext\r'mti 2022/09/26 start\rEnd If 'watsafenewsw < 1 Then\r'mti 2022/09/26 End\r\r'If RegName(R%) = \"Albania\" And IY = 2 Then Debug.Print HealthExp, sGDPPCP(R%), SEDYRSAG25(R%), Poverty, RuralPop, WATSAFE(R%, 3)\r'mti 2015/03/04 - start\rFor j = 1 To 3\rWATERFILTERED(R%, j) = AMAX(0, Amin(100, WATERFILTERED(R%, j) * waterfilteredm(R%, j)))\rNext j\r'mti 2015/03/04 -end\r\rNext 'R%\r\r'mti 2022/08/17 start\r'    If IY > 1 Then\r'     CalcInfraindices\r'    End If\r'mti August 07, 2012\r'mti 2022/08/17 end\r"
  },
  {
    "Variable": "WATERHH",
    "UsesVariable": "POPURBAN",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "WATERHH",
    "UsesVariable": "WATERHHDEM",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:End Sub:14751|\r\r'mti 2022/08/17\rPublic Sub IFsInfraWATSANNew2AllbutFirstYear(context As IForecastContext)\rDim Loc As Integer\rFor R% = 1 To NR%\r'mti 2022/09/16 start\rFor Loc% = 1 To 2       '3-> national; done in all years\rFor Srvc% = 1 To 5\rWATERHH(R%, Srvc%, Loc%) = WATERHHDEM(R%, Srvc%, Loc%)   '..DEM is desired demand (=base forecast + scenario; before financial impact)\rSANITHH(R%, Srvc%, Loc%) = SANITHHDEM(R%, Srvc%, Loc%)\rNext\rNext Loc%\r\rDim SumWaterHH As Single = 0\r\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\r\rNext\rFor Srvc% = 1 To 5\rSANITHH(R%, Srvc%, Loc%) = SANITHH(R%, Srvc%, Loc%) / AMAX(0.0001, SumSanitHH) * 100\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) / AMAX(0.0001, SumWaterHH) * 100\rNext\rNext Loc%\r"
  },
  {
    "Variable": "WATERHH",
    "UsesVariable": "waterhhbasictrgtval",
    "Distance": 6,
    "Code": "\r'mti 2022/09/21 End\r'mti 2022/09/12 end\r\r\r\r'******** End Sanitation  ***************\r\r'mti 2022/11/23 start\r'Initializing variables for target start year and sttart value\rFor Loc% = 1 To 3           '2   '3\rWaterHHSafeTrgtStartValue(R%, Loc) = Nothing\rSANITHHSafeTrgtStartValue(R%, Loc) = Nothing\rWaterHHSafeTrgtStartYr(R%, Loc) = 0\rSANITHHSafeTrgtStartYr(R%, Loc) = 0\r\rWaterHHBasicTrgtStartValue(R%, Loc) = Nothing\rSanitHHBasicTrgtStartValue(R%, Loc) = Nothing\rWaterHHBasicTrgtStartYr(R%, Loc) = 0\rSanitHHBasicTrgtStartYr(R%, Loc) = 0\rNext Loc%\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not WaterHHBasicTrgtStartValue(R%, Loc).HasValue Then\rWaterHHBasicTrgtStartValue(R%, Loc) = sWaterHH(R%, SafelyManaged, Loc%) + sWaterHH(R%, Basic, Loc%)\rEnd If\rIf WaterHHBasicTrgtStartYr(R%, Loc) = 0 Then\rWaterHHBasicTrgtStartYr(R%, Loc) = IY '\rEnd If\rDim TrgtPathVal = AMAX(WATERHH(R%, SafelyManaged, Loc%) + WATERHH(R%, Basic, Loc%),\r                                    ConvergeOverTimeFromStartYear(CSng(WaterHHBasicTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), WaterHHBasicTrgtStartYr(R%, Loc)))\r\r'iAtLeastBasic = iWaterHH(R%, SafelyManaged, Loc%) + iWaterHH(R%, Basic, Loc%)\r'TrgtPathVal = ConvergeOverTime(iAtLeastBasic, TargetVal, TargetYear)\r'mti 2022/11/23 End\r\r'Normalize Safely Managed and Basic\rSumWaterHH = 0\rFor Srvc% = 4 To 5\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 4 To 5\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * TrgtPathVal / SumWaterHH\rNext Srvc%\rEnd If\r\r'Normalize the other 3 categories\rSumWaterHH = 0\rFor Srvc% = 1 To 3\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 1 To 3\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * (100 - WATERHH(R%, SafelyManaged, Loc%) - WATERHH(R%, Basic, Loc%)) / SumWaterHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not WaterHHBasicTrgtStartValue(R%, Loc).HasValue Then\rWaterHHBasicTrgtStartValue(R%, Loc) = sWaterHH(R%, SafelyManaged, Loc%) + sWaterHH(R%, Basic, Loc%)\rEnd If\rIf WaterHHBasicTrgtStartYr(R%, Loc) = 0 Then\rWaterHHBasicTrgtStartYr(R%, Loc) = IY '\rEnd If\rDim TrgtPathVal = AMAX(WATERHH(R%, SafelyManaged, Loc%) + WATERHH(R%, Basic, Loc%),\r                                    ConvergeOverTimeFromStartYear(CSng(WaterHHBasicTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), WaterHHBasicTrgtStartYr(R%, Loc)))\r\r'iAtLeastBasic = iWaterHH(R%, SafelyManaged, Loc%) + iWaterHH(R%, Basic, Loc%)\r'TrgtPathVal = ConvergeOverTime(iAtLeastBasic, TargetVal, TargetYear)\r'mti 2022/11/23 End\r\r'Normalize Safely Managed and Basic\rSumWaterHH = 0\rFor Srvc% = 4 To 5\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 4 To 5\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * TrgtPathVal / SumWaterHH\rNext Srvc%\rEnd If\r\r'Normalize the other 3 categories\rSumWaterHH = 0\rFor Srvc% = 1 To 3\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 1 To 3\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * (100 - WATERHH(R%, SafelyManaged, Loc%) - WATERHH(R%, Basic, Loc%)) / SumWaterHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf waterhhbasictrgtyr(R%, National) <> 0 Then   'National overrides urban and rural\rTargetYear = waterhhbasictrgtyr(R%, National)\rTargetVal = waterhhbasictrgtval(R%, National)\rEnd If\r\rIf waterhhbasictrgtyr(R%, National) <> 0 Then   'National overrides urban and rural\rTargetYear = waterhhbasictrgtyr(R%, National)\rTargetVal = waterhhbasictrgtval(R%, National)\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not WaterHHBasicTrgtStartValue(R%, Loc).HasValue Then\rWaterHHBasicTrgtStartValue(R%, Loc) = sWaterHH(R%, SafelyManaged, Loc%) + sWaterHH(R%, Basic, Loc%)\rEnd If\rIf WaterHHBasicTrgtStartYr(R%, Loc) = 0 Then\rWaterHHBasicTrgtStartYr(R%, Loc) = IY '\rEnd If\rDim TrgtPathVal = AMAX(WATERHH(R%, SafelyManaged, Loc%) + WATERHH(R%, Basic, Loc%),\r                                    ConvergeOverTimeFromStartYear(CSng(WaterHHBasicTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), WaterHHBasicTrgtStartYr(R%, Loc)))\r\r'iAtLeastBasic = iWaterHH(R%, SafelyManaged, Loc%) + iWaterHH(R%, Basic, Loc%)\r'TrgtPathVal = ConvergeOverTime(iAtLeastBasic, TargetVal, TargetYear)\r'mti 2022/11/23 End\r\r'Normalize Safely Managed and Basic\rSumWaterHH = 0\rFor Srvc% = 4 To 5\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 4 To 5\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * TrgtPathVal / SumWaterHH\rNext Srvc%\rEnd If\r\r'Normalize the other 3 categories\rSumWaterHH = 0\rFor Srvc% = 1 To 3\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 1 To 3\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * (100 - WATERHH(R%, SafelyManaged, Loc%) - WATERHH(R%, Basic, Loc%)) / SumWaterHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not WaterHHBasicTrgtStartValue(R%, Loc).HasValue Then\rWaterHHBasicTrgtStartValue(R%, Loc) = sWaterHH(R%, SafelyManaged, Loc%) + sWaterHH(R%, Basic, Loc%)\rEnd If\rIf WaterHHBasicTrgtStartYr(R%, Loc) = 0 Then\rWaterHHBasicTrgtStartYr(R%, Loc) = IY '\rEnd If\rDim TrgtPathVal = AMAX(WATERHH(R%, SafelyManaged, Loc%) + WATERHH(R%, Basic, Loc%),\r                                    ConvergeOverTimeFromStartYear(CSng(WaterHHBasicTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), WaterHHBasicTrgtStartYr(R%, Loc)))\r\r'iAtLeastBasic = iWaterHH(R%, SafelyManaged, Loc%) + iWaterHH(R%, Basic, Loc%)\r'TrgtPathVal = ConvergeOverTime(iAtLeastBasic, TargetVal, TargetYear)\r'mti 2022/11/23 End\r\r'Normalize Safely Managed and Basic\rSumWaterHH = 0\rFor Srvc% = 4 To 5\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 4 To 5\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * TrgtPathVal / SumWaterHH\rNext Srvc%\rEnd If\r\r'Normalize the other 3 categories\rSumWaterHH = 0\rFor Srvc% = 1 To 3\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 1 To 3\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * (100 - WATERHH(R%, SafelyManaged, Loc%) - WATERHH(R%, Basic, Loc%)) / SumWaterHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not WaterHHBasicTrgtStartValue(R%, Loc).HasValue Then\rWaterHHBasicTrgtStartValue(R%, Loc) = sWaterHH(R%, SafelyManaged, Loc%) + sWaterHH(R%, Basic, Loc%)\rEnd If\rIf WaterHHBasicTrgtStartYr(R%, Loc) = 0 Then\rWaterHHBasicTrgtStartYr(R%, Loc) = IY '\rEnd If\rDim TrgtPathVal = AMAX(WATERHH(R%, SafelyManaged, Loc%) + WATERHH(R%, Basic, Loc%),\r                                    ConvergeOverTimeFromStartYear(CSng(WaterHHBasicTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), WaterHHBasicTrgtStartYr(R%, Loc)))\r\r'iAtLeastBasic = iWaterHH(R%, SafelyManaged, Loc%) + iWaterHH(R%, Basic, Loc%)\r'TrgtPathVal = ConvergeOverTime(iAtLeastBasic, TargetVal, TargetYear)\r'mti 2022/11/23 End\r\r'Normalize Safely Managed and Basic\rSumWaterHH = 0\rFor Srvc% = 4 To 5\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 4 To 5\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * TrgtPathVal / SumWaterHH\rNext Srvc%\rEnd If\r\r'Normalize the other 3 categories\rSumWaterHH = 0\rFor Srvc% = 1 To 3\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 1 To 3\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * (100 - WATERHH(R%, SafelyManaged, Loc%) - WATERHH(R%, Basic, Loc%)) / SumWaterHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not WaterHHBasicTrgtStartValue(R%, Loc).HasValue Then\rWaterHHBasicTrgtStartValue(R%, Loc) = sWaterHH(R%, SafelyManaged, Loc%) + sWaterHH(R%, Basic, Loc%)\rEnd If\rIf WaterHHBasicTrgtStartYr(R%, Loc) = 0 Then\rWaterHHBasicTrgtStartYr(R%, Loc) = IY '\rEnd If\rDim TrgtPathVal = AMAX(WATERHH(R%, SafelyManaged, Loc%) + WATERHH(R%, Basic, Loc%),\r                                    ConvergeOverTimeFromStartYear(CSng(WaterHHBasicTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), WaterHHBasicTrgtStartYr(R%, Loc)))\r\r'iAtLeastBasic = iWaterHH(R%, SafelyManaged, Loc%) + iWaterHH(R%, Basic, Loc%)\r'TrgtPathVal = ConvergeOverTime(iAtLeastBasic, TargetVal, TargetYear)\r'mti 2022/11/23 End\r\r'Normalize Safely Managed and Basic\rSumWaterHH = 0\rFor Srvc% = 4 To 5\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 4 To 5\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * TrgtPathVal / SumWaterHH\rNext Srvc%\rEnd If\r\r'Normalize the other 3 categories\rSumWaterHH = 0\rFor Srvc% = 1 To 3\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 1 To 3\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * (100 - WATERHH(R%, SafelyManaged, Loc%) - WATERHH(R%, Basic, Loc%)) / SumWaterHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not WaterHHBasicTrgtStartValue(R%, Loc).HasValue Then\rWaterHHBasicTrgtStartValue(R%, Loc) = sWaterHH(R%, SafelyManaged, Loc%) + sWaterHH(R%, Basic, Loc%)\rEnd If\rIf WaterHHBasicTrgtStartYr(R%, Loc) = 0 Then\rWaterHHBasicTrgtStartYr(R%, Loc) = IY '\rEnd If\rDim TrgtPathVal = AMAX(WATERHH(R%, SafelyManaged, Loc%) + WATERHH(R%, Basic, Loc%),\r                                    ConvergeOverTimeFromStartYear(CSng(WaterHHBasicTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), WaterHHBasicTrgtStartYr(R%, Loc)))\r\r'iAtLeastBasic = iWaterHH(R%, SafelyManaged, Loc%) + iWaterHH(R%, Basic, Loc%)\r'TrgtPathVal = ConvergeOverTime(iAtLeastBasic, TargetVal, TargetYear)\r'mti 2022/11/23 End\r\r'Normalize Safely Managed and Basic\rSumWaterHH = 0\rFor Srvc% = 4 To 5\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 4 To 5\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * TrgtPathVal / SumWaterHH\rNext Srvc%\rEnd If\r\r'Normalize the other 3 categories\rSumWaterHH = 0\rFor Srvc% = 1 To 3\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 1 To 3\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * (100 - WATERHH(R%, SafelyManaged, Loc%) - WATERHH(R%, Basic, Loc%)) / SumWaterHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not WaterHHBasicTrgtStartValue(R%, Loc).HasValue Then\rWaterHHBasicTrgtStartValue(R%, Loc) = sWaterHH(R%, SafelyManaged, Loc%) + sWaterHH(R%, Basic, Loc%)\rEnd If\rIf WaterHHBasicTrgtStartYr(R%, Loc) = 0 Then\rWaterHHBasicTrgtStartYr(R%, Loc) = IY '\rEnd If\rDim TrgtPathVal = AMAX(WATERHH(R%, SafelyManaged, Loc%) + WATERHH(R%, Basic, Loc%),\r                                    ConvergeOverTimeFromStartYear(CSng(WaterHHBasicTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), WaterHHBasicTrgtStartYr(R%, Loc)))\r\r'iAtLeastBasic = iWaterHH(R%, SafelyManaged, Loc%) + iWaterHH(R%, Basic, Loc%)\r'TrgtPathVal = ConvergeOverTime(iAtLeastBasic, TargetVal, TargetYear)\r'mti 2022/11/23 End\r\r'Normalize Safely Managed and Basic\rSumWaterHH = 0\rFor Srvc% = 4 To 5\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 4 To 5\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * TrgtPathVal / SumWaterHH\rNext Srvc%\rEnd If\r\r'Normalize the other 3 categories\rSumWaterHH = 0\rFor Srvc% = 1 To 3\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 1 To 3\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * (100 - WATERHH(R%, SafelyManaged, Loc%) - WATERHH(R%, Basic, Loc%)) / SumWaterHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not WaterHHBasicTrgtStartValue(R%, Loc).HasValue Then\rWaterHHBasicTrgtStartValue(R%, Loc) = sWaterHH(R%, SafelyManaged, Loc%) + sWaterHH(R%, Basic, Loc%)\rEnd If\rIf WaterHHBasicTrgtStartYr(R%, Loc) = 0 Then\rWaterHHBasicTrgtStartYr(R%, Loc) = IY '\rEnd If\rDim TrgtPathVal = AMAX(WATERHH(R%, SafelyManaged, Loc%) + WATERHH(R%, Basic, Loc%),\r                                    ConvergeOverTimeFromStartYear(CSng(WaterHHBasicTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), WaterHHBasicTrgtStartYr(R%, Loc)))\r\r'iAtLeastBasic = iWaterHH(R%, SafelyManaged, Loc%) + iWaterHH(R%, Basic, Loc%)\r'TrgtPathVal = ConvergeOverTime(iAtLeastBasic, TargetVal, TargetYear)\r'mti 2022/11/23 End\r\r'Normalize Safely Managed and Basic\rSumWaterHH = 0\rFor Srvc% = 4 To 5\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 4 To 5\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * TrgtPathVal / SumWaterHH\rNext Srvc%\rEnd If\r\r'Normalize the other 3 categories\rSumWaterHH = 0\rFor Srvc% = 1 To 3\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 1 To 3\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * (100 - WATERHH(R%, SafelyManaged, Loc%) - WATERHH(R%, Basic, Loc%)) / SumWaterHH\rNext Srvc%\rEnd If\r\rEnd If\r"
  },
  {
    "Variable": "WATERHH",
    "UsesVariable": "waterhhbasictrgtyr",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "WATERHH",
    "UsesVariable": "waterhhsafetrgtval",
    "Distance": 3,
    "Code": "\r'mti 2022/09/21 End\r'mti 2022/09/12 end\r\r\r\r'******** End Sanitation  ***************\r\r'mti 2022/11/23 start\r'Initializing variables for target start year and sttart value\rFor Loc% = 1 To 3           '2   '3\rWaterHHSafeTrgtStartValue(R%, Loc) = Nothing\rSANITHHSafeTrgtStartValue(R%, Loc) = Nothing\rWaterHHSafeTrgtStartYr(R%, Loc) = 0\rSANITHHSafeTrgtStartYr(R%, Loc) = 0\r\rWaterHHBasicTrgtStartValue(R%, Loc) = Nothing\rSanitHHBasicTrgtStartValue(R%, Loc) = Nothing\rWaterHHBasicTrgtStartYr(R%, Loc) = 0\rSanitHHBasicTrgtStartYr(R%, Loc) = 0\rNext Loc%\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not WaterHHSafeTrgtStartValue(R%, Loc).HasValue Then\rWaterHHSafeTrgtStartValue(R%, Loc) = sWaterHH(R%, SafelyManaged, Loc%)\rEnd If\rIf WaterHHSafeTrgtStartYr(R%, Loc) = 0 Then\rWaterHHSafeTrgtStartYr(R%, Loc) = IY '\rEnd If\rWATERHH(R%, SafelyManaged, Loc%) = AMAX(WATERHH(R%, SafelyManaged, Loc%), ConvergeOverTimeFromStartYear(CSng(WaterHHSafeTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), WaterHHSafeTrgtStartYr(R%, Loc)))\r'WATERHH(R%, SafelyManaged, Loc%) = AMAX(WATERHH(R%, SafelyManaged, Loc%), ConvergeOverTime(iWaterHH(R%, SafelyManaged, Loc%), TargetVal, TargetYear))\r'mti 2022/11/23 End\r\r'Normalize the other 4 categories\rSumWaterHH = 0\rFor Srvc% = 1 To 4\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 1 To 4\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * (100 - WATERHH(R%, SafelyManaged, Loc%)) / SumWaterHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf waterhhsafetrgtyr(R%, National) <> 0 Then   'National overrides urban and rural\rTargetYear = waterhhsafetrgtyr(R%, National)\rTargetVal = waterhhsafetrgtval(R%, National)\rEnd If\r\rIf waterhhsafetrgtyr(R%, National) <> 0 Then   'National overrides urban and rural\rTargetYear = waterhhsafetrgtyr(R%, National)\rTargetVal = waterhhsafetrgtval(R%, National)\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not WaterHHSafeTrgtStartValue(R%, Loc).HasValue Then\rWaterHHSafeTrgtStartValue(R%, Loc) = sWaterHH(R%, SafelyManaged, Loc%)\rEnd If\rIf WaterHHSafeTrgtStartYr(R%, Loc) = 0 Then\rWaterHHSafeTrgtStartYr(R%, Loc) = IY '\rEnd If\rWATERHH(R%, SafelyManaged, Loc%) = AMAX(WATERHH(R%, SafelyManaged, Loc%), ConvergeOverTimeFromStartYear(CSng(WaterHHSafeTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), WaterHHSafeTrgtStartYr(R%, Loc)))\r'WATERHH(R%, SafelyManaged, Loc%) = AMAX(WATERHH(R%, SafelyManaged, Loc%), ConvergeOverTime(iWaterHH(R%, SafelyManaged, Loc%), TargetVal, TargetYear))\r'mti 2022/11/23 End\r\r'Normalize the other 4 categories\rSumWaterHH = 0\rFor Srvc% = 1 To 4\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 1 To 4\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * (100 - WATERHH(R%, SafelyManaged, Loc%)) / SumWaterHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not WaterHHSafeTrgtStartValue(R%, Loc).HasValue Then\rWaterHHSafeTrgtStartValue(R%, Loc) = sWaterHH(R%, SafelyManaged, Loc%)\rEnd If\rIf WaterHHSafeTrgtStartYr(R%, Loc) = 0 Then\rWaterHHSafeTrgtStartYr(R%, Loc) = IY '\rEnd If\rWATERHH(R%, SafelyManaged, Loc%) = AMAX(WATERHH(R%, SafelyManaged, Loc%), ConvergeOverTimeFromStartYear(CSng(WaterHHSafeTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), WaterHHSafeTrgtStartYr(R%, Loc)))\r'WATERHH(R%, SafelyManaged, Loc%) = AMAX(WATERHH(R%, SafelyManaged, Loc%), ConvergeOverTime(iWaterHH(R%, SafelyManaged, Loc%), TargetVal, TargetYear))\r'mti 2022/11/23 End\r\r'Normalize the other 4 categories\rSumWaterHH = 0\rFor Srvc% = 1 To 4\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 1 To 4\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * (100 - WATERHH(R%, SafelyManaged, Loc%)) / SumWaterHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not WaterHHSafeTrgtStartValue(R%, Loc).HasValue Then\rWaterHHSafeTrgtStartValue(R%, Loc) = sWaterHH(R%, SafelyManaged, Loc%)\rEnd If\rIf WaterHHSafeTrgtStartYr(R%, Loc) = 0 Then\rWaterHHSafeTrgtStartYr(R%, Loc) = IY '\rEnd If\rWATERHH(R%, SafelyManaged, Loc%) = AMAX(WATERHH(R%, SafelyManaged, Loc%), ConvergeOverTimeFromStartYear(CSng(WaterHHSafeTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), WaterHHSafeTrgtStartYr(R%, Loc)))\r'WATERHH(R%, SafelyManaged, Loc%) = AMAX(WATERHH(R%, SafelyManaged, Loc%), ConvergeOverTime(iWaterHH(R%, SafelyManaged, Loc%), TargetVal, TargetYear))\r'mti 2022/11/23 End\r\r'Normalize the other 4 categories\rSumWaterHH = 0\rFor Srvc% = 1 To 4\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 1 To 4\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * (100 - WATERHH(R%, SafelyManaged, Loc%)) / SumWaterHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not WaterHHSafeTrgtStartValue(R%, Loc).HasValue Then\rWaterHHSafeTrgtStartValue(R%, Loc) = sWaterHH(R%, SafelyManaged, Loc%)\rEnd If\rIf WaterHHSafeTrgtStartYr(R%, Loc) = 0 Then\rWaterHHSafeTrgtStartYr(R%, Loc) = IY '\rEnd If\rWATERHH(R%, SafelyManaged, Loc%) = AMAX(WATERHH(R%, SafelyManaged, Loc%), ConvergeOverTimeFromStartYear(CSng(WaterHHSafeTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), WaterHHSafeTrgtStartYr(R%, Loc)))\r'WATERHH(R%, SafelyManaged, Loc%) = AMAX(WATERHH(R%, SafelyManaged, Loc%), ConvergeOverTime(iWaterHH(R%, SafelyManaged, Loc%), TargetVal, TargetYear))\r'mti 2022/11/23 End\r\r'Normalize the other 4 categories\rSumWaterHH = 0\rFor Srvc% = 1 To 4\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 1 To 4\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * (100 - WATERHH(R%, SafelyManaged, Loc%)) / SumWaterHH\rNext Srvc%\rEnd If\r\rEnd If\r\rIf TargetYear > 0 Then\r'mti 2022/11/23 start\rIf Not WaterHHSafeTrgtStartValue(R%, Loc).HasValue Then\rWaterHHSafeTrgtStartValue(R%, Loc) = sWaterHH(R%, SafelyManaged, Loc%)\rEnd If\rIf WaterHHSafeTrgtStartYr(R%, Loc) = 0 Then\rWaterHHSafeTrgtStartYr(R%, Loc) = IY '\rEnd If\rWATERHH(R%, SafelyManaged, Loc%) = AMAX(WATERHH(R%, SafelyManaged, Loc%), ConvergeOverTimeFromStartYear(CSng(WaterHHSafeTrgtStartValue(R%, Loc)), TargetVal, CInt(TargetYear), WaterHHSafeTrgtStartYr(R%, Loc)))\r'WATERHH(R%, SafelyManaged, Loc%) = AMAX(WATERHH(R%, SafelyManaged, Loc%), ConvergeOverTime(iWaterHH(R%, SafelyManaged, Loc%), TargetVal, TargetYear))\r'mti 2022/11/23 End\r\r'Normalize the other 4 categories\rSumWaterHH = 0\rFor Srvc% = 1 To 4\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\rNext Srvc%\rIf SumWaterHH > 0 Then\rFor Srvc% = 1 To 4\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) * (100 - WATERHH(R%, SafelyManaged, Loc%)) / SumWaterHH\rNext Srvc%\rEnd If\r\rEnd If\r\r'mti 2022/09/21 End\r'mti 2022/09/12 end\r\r\r\r'******** End Sanitation  ***************\r\r'mti 2022/11/23 start\r'Initializing variables for target start year and sttart value\rFor Loc% = 1 To 3           '2   '3\rWaterHHSafeTrgtStartValue(R%, Loc) = Nothing\rSANITHHSafeTrgtStartValue(R%, Loc) = Nothing\rWaterHHSafeTrgtStartYr(R%, Loc) = 0\rSANITHHSafeTrgtStartYr(R%, Loc) = 0\r\rWaterHHBasicTrgtStartValue(R%, Loc) = Nothing\rSanitHHBasicTrgtStartValue(R%, Loc) = Nothing\rWaterHHBasicTrgtStartYr(R%, Loc) = 0\rSanitHHBasicTrgtStartYr(R%, Loc) = 0\rNext Loc%\r"
  },
  {
    "Variable": "WATERHH",
    "UsesVariable": "waterhhsafetrgtyr",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "WATERHH",
    "UsesVariable": "waterhhm",
    "Distance": 0,
    "Code": "\rFor Srvc% = 1 To 5\r'mti 2022/09/12 Start\rWATERHH(R%, Srvc%, Loc%) = Amin(100, WATERHH(R%, Srvc%, Loc%) * If(waterhhm(R%, Srvc%, National) <> 1, waterhhm(R%, Srvc%, National), waterhhm(R%, Srvc%, Loc%)))\r\rNext\r\r'Apply scenario paprameter - multiplier base 1   'Note - mutiplier on national will be implemented as same multiplier on rural and urban,\rSumWaterHH = 0\r\r'mti 2022/09/12 End\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\r\rNext\rFor Srvc% = 1 To 5 'normalize to 100%\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) / AMAX(0.0001, SumWaterHH) * 100\r\r'mti 2022/09/21 End\r'mti 2022/09/12 end\r\r\r\r'******** End Sanitation  ***************\r\r'mti 2022/11/23 start\r'Initializing variables for target start year and sttart value\rFor Loc% = 1 To 3           '2   '3\rWaterHHSafeTrgtStartValue(R%, Loc) = Nothing\rSANITHHSafeTrgtStartValue(R%, Loc) = Nothing\rWaterHHSafeTrgtStartYr(R%, Loc) = 0\rSANITHHSafeTrgtStartYr(R%, Loc) = 0\r\rWaterHHBasicTrgtStartValue(R%, Loc) = Nothing\rSanitHHBasicTrgtStartValue(R%, Loc) = Nothing\rWaterHHBasicTrgtStartYr(R%, Loc) = 0\rSanitHHBasicTrgtStartYr(R%, Loc) = 0\rNext Loc%\r"
  },
  {
    "Variable": "WATERHH",
    "UsesVariable": "gdprext",
    "Distance": 32,
    "Code": "\rIf WaterHHGR(R%, Srvc%, Loc%) <> -9999 And sWATERHHModel(R%, Srvc%, Loc%) <> 0 Then\r\rDim MA_Fct = 0.1\rDim CurGr As Single\rIf COVIDShk_WS = 0 Then\rCurGr = CSng(AMAX(-0.1, Amin(0.1, MA_Fct * (WaterHH_Model / sWATERHHModel(R%, Srvc%, Loc%) - 1) + (1 - MA_Fct) * WaterHHGR(R%, Srvc%, Loc%))))\rWaterHHGR(R%, Srvc%, Loc%) = CurGr\rElse\rCurGr = CSng(AMAX(-0.1, Amin(0.1, 0.4 * (WaterHH_Model / sWATERHHModel(R%, Srvc%, Loc%) - 1) + 0.6 * WaterHHGR(R%, Srvc%, Loc%))))\rEnd If\r\r'WaterHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWaterHHModel(R%, Srvc%, Loc%) * (1 + CurGr)))\rWATERHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWATERHHModelPlus(R%, Srvc%, Loc%) * (1 + CurGr)))\r'mti 2022/10/04 start\rElse\rIf WaterHHGR(R%, Srvc%, Loc%) <> -9999 Then\rWaterHHGR(R%, Srvc%, Loc%) = CSng(0.85 * WaterHHGR(R%, Srvc%, Loc%))   'smoother convergence of growth rate to zero\rWATERHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWATERHHModelPlus(R%, Srvc%, Loc%) * (1 + WaterHHGR(R%, Srvc%, Loc%))))\rEnd If\r'mti 2022/10/04 End\r\rEnd If\r\rIf IY% - 1 + FirstYear = 2021 And gdprext(USAidx) < 0 Then COVIDShk_WS = 1\r\rIf WaterHHGR(R%, Srvc%, Loc%) <> -9999 And sWATERHHModel(R%, Srvc%, Loc%) <> 0 Then\r\rDim MA_Fct = 0.1\rDim CurGr As Single\rIf COVIDShk_WS = 0 Then\rCurGr = CSng(AMAX(-0.1, Amin(0.1, MA_Fct * (WaterHH_Model / sWATERHHModel(R%, Srvc%, Loc%) - 1) + (1 - MA_Fct) * WaterHHGR(R%, Srvc%, Loc%))))\rWaterHHGR(R%, Srvc%, Loc%) = CurGr\rElse\rCurGr = CSng(AMAX(-0.1, Amin(0.1, 0.4 * (WaterHH_Model / sWATERHHModel(R%, Srvc%, Loc%) - 1) + 0.6 * WaterHHGR(R%, Srvc%, Loc%))))\rEnd If\r\r'WaterHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWaterHHModel(R%, Srvc%, Loc%) * (1 + CurGr)))\rWATERHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWATERHHModelPlus(R%, Srvc%, Loc%) * (1 + CurGr)))\r'mti 2022/10/04 start\rElse\rIf WaterHHGR(R%, Srvc%, Loc%) <> -9999 Then\rWaterHHGR(R%, Srvc%, Loc%) = CSng(0.85 * WaterHHGR(R%, Srvc%, Loc%))   'smoother convergence of growth rate to zero\rWATERHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWATERHHModelPlus(R%, Srvc%, Loc%) * (1 + WaterHHGR(R%, Srvc%, Loc%))))\rEnd If\r'mti 2022/10/04 End\r\rEnd If\r\r\r'mti 2022/09/12 start\r'mti 2022/09/21 start\rFor Loc% = 1 To 3       '2       '3\rFor Srvc% = 1 To 5\rWATERHHDEM(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\rWaterHHBF(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\r'mti 2022/10/04 start\rsWATERHHModel(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\rsWATERHHModelPlus(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\r'mti 2022/10/04 end\r\r'mti 2022/10/27 Start\rsWaterHHBF(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\r'mti 2022/10/27 End\r\rNext Srvc%\rNext Loc%\r\r'mti 2022/09/21 end\r\r'mti 2022/09/29 start\rDim WaterHH_Model = WATERHH(R%, Srvc%, Loc%) 'this now hold current year's model-based estimate\r\rIf WaterHHGR(R%, Srvc%, Loc%) <> -9999 And sWATERHHModel(R%, Srvc%, Loc%) <> 0 Then\r\rDim MA_Fct = 0.1\rDim CurGr As Single\rIf COVIDShk_WS = 0 Then\rCurGr = CSng(AMAX(-0.1, Amin(0.1, MA_Fct * (WaterHH_Model / sWATERHHModel(R%, Srvc%, Loc%) - 1) + (1 - MA_Fct) * WaterHHGR(R%, Srvc%, Loc%))))\rWaterHHGR(R%, Srvc%, Loc%) = CurGr\rElse\rCurGr = CSng(AMAX(-0.1, Amin(0.1, 0.4 * (WaterHH_Model / sWATERHHModel(R%, Srvc%, Loc%) - 1) + 0.6 * WaterHHGR(R%, Srvc%, Loc%))))\rEnd If\r\r'WaterHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWaterHHModel(R%, Srvc%, Loc%) * (1 + CurGr)))\rWATERHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWATERHHModelPlus(R%, Srvc%, Loc%) * (1 + CurGr)))\r'mti 2022/10/04 start\rElse\rIf WaterHHGR(R%, Srvc%, Loc%) <> -9999 Then\rWaterHHGR(R%, Srvc%, Loc%) = CSng(0.85 * WaterHHGR(R%, Srvc%, Loc%))   'smoother convergence of growth rate to zero\rWATERHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWATERHHModelPlus(R%, Srvc%, Loc%) * (1 + WaterHHGR(R%, Srvc%, Loc%))))\rEnd If\r'mti 2022/10/04 End\r\rEnd If\r\r\r'mti 2022/09/12 start\r'mti 2022/09/21 start\rFor Loc% = 1 To 3       '2       '3\rFor Srvc% = 1 To 5\rWATERHHDEM(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\rWaterHHBF(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\r'mti 2022/10/04 start\rsWATERHHModel(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\rsWATERHHModelPlus(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\r'mti 2022/10/04 end\r\r'mti 2022/10/27 Start\rsWaterHHBF(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\r'mti 2022/10/27 End\r\rNext Srvc%\rNext Loc%\r\rIf WaterHHGR(R%, Srvc%, Loc%) <> -9999 And sWATERHHModel(R%, Srvc%, Loc%) <> 0 Then\r\rDim MA_Fct = 0.1\rDim CurGr As Single\rIf COVIDShk_WS = 0 Then\rCurGr = CSng(AMAX(-0.1, Amin(0.1, MA_Fct * (WaterHH_Model / sWATERHHModel(R%, Srvc%, Loc%) - 1) + (1 - MA_Fct) * WaterHHGR(R%, Srvc%, Loc%))))\rWaterHHGR(R%, Srvc%, Loc%) = CurGr\rElse\rCurGr = CSng(AMAX(-0.1, Amin(0.1, 0.4 * (WaterHH_Model / sWATERHHModel(R%, Srvc%, Loc%) - 1) + 0.6 * WaterHHGR(R%, Srvc%, Loc%))))\rEnd If\r\r'WaterHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWaterHHModel(R%, Srvc%, Loc%) * (1 + CurGr)))\rWATERHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWATERHHModelPlus(R%, Srvc%, Loc%) * (1 + CurGr)))\r'mti 2022/10/04 start\rElse\rIf WaterHHGR(R%, Srvc%, Loc%) <> -9999 Then\rWaterHHGR(R%, Srvc%, Loc%) = CSng(0.85 * WaterHHGR(R%, Srvc%, Loc%))   'smoother convergence of growth rate to zero\rWATERHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWATERHHModelPlus(R%, Srvc%, Loc%) * (1 + WaterHHGR(R%, Srvc%, Loc%))))\rEnd If\r'mti 2022/10/04 End\r\rEnd If\r\r\r'mti 2022/09/12 start\r'mti 2022/09/21 start\rFor Loc% = 1 To 3       '2       '3\rFor Srvc% = 1 To 5\rWATERHHDEM(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\rWaterHHBF(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\r'mti 2022/10/04 start\rsWATERHHModel(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\rsWATERHHModelPlus(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\r'mti 2022/10/04 end\r\r'mti 2022/10/27 Start\rsWaterHHBF(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\r'mti 2022/10/27 End\r\rNext Srvc%\rNext Loc%\r\r'mti 2022/09/21 end\r\r'mti 2022/09/29 start\rDim WaterHH_Model = WATERHH(R%, Srvc%, Loc%) 'this now hold current year's model-based estimate\r\rIf WaterHHGR(R%, Srvc%, Loc%) <> -9999 And sWATERHHModel(R%, Srvc%, Loc%) <> 0 Then\r\rDim MA_Fct = 0.1\rDim CurGr As Single\rIf COVIDShk_WS = 0 Then\rCurGr = CSng(AMAX(-0.1, Amin(0.1, MA_Fct * (WaterHH_Model / sWATERHHModel(R%, Srvc%, Loc%) - 1) + (1 - MA_Fct) * WaterHHGR(R%, Srvc%, Loc%))))\rWaterHHGR(R%, Srvc%, Loc%) = CurGr\rElse\rCurGr = CSng(AMAX(-0.1, Amin(0.1, 0.4 * (WaterHH_Model / sWATERHHModel(R%, Srvc%, Loc%) - 1) + 0.6 * WaterHHGR(R%, Srvc%, Loc%))))\rEnd If\r\r'WaterHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWaterHHModel(R%, Srvc%, Loc%) * (1 + CurGr)))\rWATERHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWATERHHModelPlus(R%, Srvc%, Loc%) * (1 + CurGr)))\r'mti 2022/10/04 start\rElse\rIf WaterHHGR(R%, Srvc%, Loc%) <> -9999 Then\rWaterHHGR(R%, Srvc%, Loc%) = CSng(0.85 * WaterHHGR(R%, Srvc%, Loc%))   'smoother convergence of growth rate to zero\rWATERHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWATERHHModelPlus(R%, Srvc%, Loc%) * (1 + WaterHHGR(R%, Srvc%, Loc%))))\rEnd If\r'mti 2022/10/04 End\r\rEnd If\r\rIf WaterHHGR(R%, Srvc%, Loc%) <> -9999 And sWATERHHModel(R%, Srvc%, Loc%) <> 0 Then\r\rDim MA_Fct = 0.1\rDim CurGr As Single\rIf COVIDShk_WS = 0 Then\rCurGr = CSng(AMAX(-0.1, Amin(0.1, MA_Fct * (WaterHH_Model / sWATERHHModel(R%, Srvc%, Loc%) - 1) + (1 - MA_Fct) * WaterHHGR(R%, Srvc%, Loc%))))\rWaterHHGR(R%, Srvc%, Loc%) = CurGr\rElse\rCurGr = CSng(AMAX(-0.1, Amin(0.1, 0.4 * (WaterHH_Model / sWATERHHModel(R%, Srvc%, Loc%) - 1) + 0.6 * WaterHHGR(R%, Srvc%, Loc%))))\rEnd If\r\r'WaterHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWaterHHModel(R%, Srvc%, Loc%) * (1 + CurGr)))\rWATERHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWATERHHModelPlus(R%, Srvc%, Loc%) * (1 + CurGr)))\r'mti 2022/10/04 start\rElse\rIf WaterHHGR(R%, Srvc%, Loc%) <> -9999 Then\rWaterHHGR(R%, Srvc%, Loc%) = CSng(0.85 * WaterHHGR(R%, Srvc%, Loc%))   'smoother convergence of growth rate to zero\rWATERHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWATERHHModelPlus(R%, Srvc%, Loc%) * (1 + WaterHHGR(R%, Srvc%, Loc%))))\rEnd If\r'mti 2022/10/04 End\r\rEnd If\r\rIf WaterHHGR(R%, Srvc%, Loc%) <> -9999 And sWATERHHModel(R%, Srvc%, Loc%) <> 0 Then\r\rDim MA_Fct = 0.1\rDim CurGr As Single\rIf COVIDShk_WS = 0 Then\rCurGr = CSng(AMAX(-0.1, Amin(0.1, MA_Fct * (WaterHH_Model / sWATERHHModel(R%, Srvc%, Loc%) - 1) + (1 - MA_Fct) * WaterHHGR(R%, Srvc%, Loc%))))\rWaterHHGR(R%, Srvc%, Loc%) = CurGr\rElse\rCurGr = CSng(AMAX(-0.1, Amin(0.1, 0.4 * (WaterHH_Model / sWATERHHModel(R%, Srvc%, Loc%) - 1) + 0.6 * WaterHHGR(R%, Srvc%, Loc%))))\rEnd If\r\r'WaterHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWaterHHModel(R%, Srvc%, Loc%) * (1 + CurGr)))\rWATERHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWATERHHModelPlus(R%, Srvc%, Loc%) * (1 + CurGr)))\r'mti 2022/10/04 start\rElse\rIf WaterHHGR(R%, Srvc%, Loc%) <> -9999 Then\rWaterHHGR(R%, Srvc%, Loc%) = CSng(0.85 * WaterHHGR(R%, Srvc%, Loc%))   'smoother convergence of growth rate to zero\rWATERHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWATERHHModelPlus(R%, Srvc%, Loc%) * (1 + WaterHHGR(R%, Srvc%, Loc%))))\rEnd If\r'mti 2022/10/04 End\r\rEnd If\r\rIf WaterHHGR(R%, Srvc%, Loc%) <> -9999 And sWATERHHModel(R%, Srvc%, Loc%) <> 0 Then\r\rDim MA_Fct = 0.1\rDim CurGr As Single\rIf COVIDShk_WS = 0 Then\rCurGr = CSng(AMAX(-0.1, Amin(0.1, MA_Fct * (WaterHH_Model / sWATERHHModel(R%, Srvc%, Loc%) - 1) + (1 - MA_Fct) * WaterHHGR(R%, Srvc%, Loc%))))\rWaterHHGR(R%, Srvc%, Loc%) = CurGr\rElse\rCurGr = CSng(AMAX(-0.1, Amin(0.1, 0.4 * (WaterHH_Model / sWATERHHModel(R%, Srvc%, Loc%) - 1) + 0.6 * WaterHHGR(R%, Srvc%, Loc%))))\rEnd If\r\r'WaterHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWaterHHModel(R%, Srvc%, Loc%) * (1 + CurGr)))\rWATERHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWATERHHModelPlus(R%, Srvc%, Loc%) * (1 + CurGr)))\r'mti 2022/10/04 start\rElse\rIf WaterHHGR(R%, Srvc%, Loc%) <> -9999 Then\rWaterHHGR(R%, Srvc%, Loc%) = CSng(0.85 * WaterHHGR(R%, Srvc%, Loc%))   'smoother convergence of growth rate to zero\rWATERHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWATERHHModelPlus(R%, Srvc%, Loc%) * (1 + WaterHHGR(R%, Srvc%, Loc%))))\rEnd If\r'mti 2022/10/04 End\r\rEnd If\r\r\r'mti 2022/09/12 start\r'mti 2022/09/21 start\rFor Loc% = 1 To 3       '2       '3\rFor Srvc% = 1 To 5\rWATERHHDEM(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\rWaterHHBF(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\r'mti 2022/10/04 start\rsWATERHHModel(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\rsWATERHHModelPlus(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\r'mti 2022/10/04 end\r\r'mti 2022/10/27 Start\rsWaterHHBF(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\r'mti 2022/10/27 End\r\rNext Srvc%\rNext Loc%\r\rIf WaterHHGR(R%, Srvc%, Loc%) <> -9999 And sWATERHHModel(R%, Srvc%, Loc%) <> 0 Then\r\rDim MA_Fct = 0.1\rDim CurGr As Single\rIf COVIDShk_WS = 0 Then\rCurGr = CSng(AMAX(-0.1, Amin(0.1, MA_Fct * (WaterHH_Model / sWATERHHModel(R%, Srvc%, Loc%) - 1) + (1 - MA_Fct) * WaterHHGR(R%, Srvc%, Loc%))))\rWaterHHGR(R%, Srvc%, Loc%) = CurGr\rElse\rCurGr = CSng(AMAX(-0.1, Amin(0.1, 0.4 * (WaterHH_Model / sWATERHHModel(R%, Srvc%, Loc%) - 1) + 0.6 * WaterHHGR(R%, Srvc%, Loc%))))\rEnd If\r\r'WaterHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWaterHHModel(R%, Srvc%, Loc%) * (1 + CurGr)))\rWATERHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWATERHHModelPlus(R%, Srvc%, Loc%) * (1 + CurGr)))\r'mti 2022/10/04 start\rElse\rIf WaterHHGR(R%, Srvc%, Loc%) <> -9999 Then\rWaterHHGR(R%, Srvc%, Loc%) = CSng(0.85 * WaterHHGR(R%, Srvc%, Loc%))   'smoother convergence of growth rate to zero\rWATERHH(R%, Srvc%, Loc%) = Amin(100, AMAX(0, sWATERHHModelPlus(R%, Srvc%, Loc%) * (1 + WaterHHGR(R%, Srvc%, Loc%))))\rEnd If\r'mti 2022/10/04 End\r\rEnd If\r\r' If RegName(R%) = \"Maldives\" And Loc = Rural And IY >= 4 Then Stop\rDim SumWaterHH As Single = 0\r\r\r\rSumWaterHH = SumWaterHH + WATERHH(R%, Srvc%, Loc%)\r\rNext\rFor Srvc% = 1 To 5\r'normalize to 100%\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) / AMAX(0.0001, SumWaterHH) * 100\r\r\r'mti 2022/09/12 start\r'mti 2022/09/21 start\rFor Loc% = 1 To 3       '2       '3\rFor Srvc% = 1 To 5\rWATERHHDEM(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\rWaterHHBF(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\r'mti 2022/10/04 start\rsWATERHHModel(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\rsWATERHHModelPlus(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\r'mti 2022/10/04 end\r\r'mti 2022/10/27 Start\rsWaterHHBF(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%)\r'mti 2022/10/27 End\r\rNext Srvc%\rNext Loc%\r\rNext\r'mti 2022/09/29 end\r\r'mti 2022/09/21 Start\rWATERHH(R%, SafelyManaged, Loc%) = AMAX(WaterHHBF(R%, SafelyManaged, Loc%) - 2, Amin(WaterHHBF(R%, SafelyManaged, Loc%) + 5, WATERHH(R%, SafelyManaged, Loc%)))\r\rDim SumWaterHH4 As Single = 0\r\rDim SumWaterHH4Req = 100 - WATERHH(R%, SafelyManaged, Loc%)\r\rFor Srvc% = 1 To 4\rSumWaterHH4 = SumWaterHH4 + WATERHH(R%, Srvc%, Loc%)\r\rNext\rFor Srvc% = 1 To 4\r'mti 2022/09/26 start\rIf SumWaterHH4 > 0 Then\r'normalize\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) / SumWaterHH4 * SumWaterHH4Req\rElseIf SumWaterHH4Req > 0 Then\r'all (lower) 4 cat are 0; but safelymnaged not 0\rWATERHH(R%, Srvc%, Loc%) = SumWaterHH4Req / 4\rEnd If\r\rDim SumWaterHH4Req = 100 - WATERHH(R%, SafelyManaged, Loc%)\r\rNext\rFor Srvc% = 1 To 4\r'mti 2022/09/26 start\rIf SumWaterHH4 > 0 Then\r'normalize\rWATERHH(R%, Srvc%, Loc%) = WATERHH(R%, Srvc%, Loc%) / SumWaterHH4 * SumWaterHH4Req\rElseIf SumWaterHH4Req > 0 Then\r'all (lower) 4 cat are 0; but safelymnaged not 0\rWATERHH(R%, Srvc%, Loc%) = SumWaterHH4Req / 4\rEnd If\r"
  },
  {
    "Variable": "WATERHHDEM",
    "UsesVariable": "POPURBAN",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "WATERHHDEM",
    "UsesVariable": "WATERHH",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WATERHHDEMPOP",
    "UsesVariable": "WATERHHDEM",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WATERHHDEMPOP",
    "UsesVariable": "POPURBAN",
    "Distance": 0,
    "Code": "\rWATERHHDEMPOP(R%, Srvc%, Urban) = WATERHHDEM(R%, Srvc%, Urban) * POPURBAN(R%) / 100\r"
  },
  {
    "Variable": "WATERHHDEMPOP",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r\rWATERHHDEMPOP(R%, Srvc%, National) = WATERHHDEM(R%, Srvc%, National) * POP(R%) / 100\r"
  },
  {
    "Variable": "WATERHHPOP",
    "UsesVariable": "WATERHH",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WATERHHPOP",
    "UsesVariable": "POPURBAN",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "WATERHHPOP",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:Next R%:14344|COMPLETE STRUCTURE:Next Srvc%:14342|\r'jrs 2020/08/31 end\r\r'mti 2022/09/30 Start\rFor R% = 1 To NR%\rFor Srvc% = 1 To 5\r'Number of people - done here, as the Infrastr module only uses pop from a year back for routine sequence issues\rWATERHHPOP(R%, Srvc%, National) = WATERHH(R%, Srvc%, National) * POP(R%) / 100\r"
  },
  {
    "Variable": "WATERRESFOSSIL",
    "UsesVariable": "WATERWITHDRAWAL",
    "Distance": 0,
    "Code": "\r\r'sgh 2018/01/04 - START\r'    swaterresfossil(R%) = swaterresfossil(R%) - swatwithdfossilground(R%)\rswaterresfossil(R%) = swaterresfossil(R%) - WATERWITHDRAWAL(R%, 3)\r"
  },
  {
    "Variable": "WATERTOTALSUPPLY",
    "UsesVariable": "WATERWITHDRAWAL",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WATERTOTALSUPPLY",
    "UsesVariable": "WASTEWATERSUPPLY",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WATERTOTALSUPPLY",
    "UsesVariable": "WATERDESALINATED",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WATERTOTALSUPPLY",
    "UsesVariable": "WATDEMAND",
    "Distance": 194,
    "Code": "0"
  },
  {
    "Variable": "WATERWITHDRAWAL",
    "UsesVariable": "WATRESEXPLOITRENEW",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WATERWITHDRAWAL",
    "UsesVariable": "WATPRICE",
    "Distance": 107,
    "Code": "0"
  },
  {
    "Variable": "WATERWITHDRAWAL",
    "UsesVariable": "waterwithdrawalm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WATERWITHDRAWAL",
    "UsesVariable": "WATERRESFOSSIL",
    "Distance": 0,
    "Code": "\r'If RegName$(R%) = \"Nicaragua\" Then Stop\r\rswatwithdfossilground(R%) = WATERWITHDRAWAL(R%, 3)\r\r\r'sgh 2018/01/04 - START\rWATERWITHDRAWAL(R%, 3) = Amin(swatwithdfossilground(R%), (swaterresfossil(R%) / 25))\r\r'If RegName$(R%) = \"UAE\" Then Stop\r'sgh 2018/01/04 - END\r\r'sgh 2017/01/23\rIf WATERWITHDRAWAL(R%, 3) <= 0 Then\rWATERWITHDRAWAL(R%, 3) = 0.001\rEnd If\r"
  },
  {
    "Variable": "WATERWITHDRAWAL",
    "UsesVariable": "waterrenewconverge",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WATERWITHDRAWAL",
    "UsesVariable": "igdpr",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WATPRICE",
    "UsesVariable": "watprii",
    "Distance": 5,
    "Code": "\rsdemandsupplyratiowater(R%) = iDemandSupplyRatioWater(R%)\r\rIf DemandSupplyRatioWater(R%) < 0 Then DemandSupplyRatioWater(R%) = 0.01\r\rCall ADJSTR(1, DemandSupplyRatioWater(R%) - 1, (DemandSupplyRatioWater(R%) - sdemandsupplyratiowater(R%)),\r        watprii, watprid, Mul)\r\r'If RegName$(R%) = \"Saudi Arabia\" AndAlso IY% > 10 Then Stop\r'sgh 2018/01/18 - END\r'bbh 2022/11/28 WATPRICE for some countries extreme and for NZ and Kenya oscillating; Slovakia collapsing\r'   Badly needs structural attention but also messing up water feedback to ag yields for such countries, so temporary constraints here, next 3 lines\rMul = CSng(Amin(1.02, AMAX(0.99, Mul))) 'water price more likely to rise than fall, constraints added surpassed by few countries without them\r\rWATPRICE(R%) = swatprice(R%) * Mul 'This might usefully be augmented with scenario multiplier on WATPRICE or ability to exogenous specifiy or switch to turn off\r\rWATPRICE(R%) = Amin(250, AMAX(50, WATPRICE(R%)))\r"
  },
  {
    "Variable": "WATPRICE",
    "UsesVariable": "watprid",
    "Distance": 5,
    "Code": "\rsdemandsupplyratiowater(R%) = iDemandSupplyRatioWater(R%)\r"
  },
  {
    "Variable": "WATPRICE",
    "UsesVariable": "WATERTOTALSUPPLY",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "WATPRICE",
    "UsesVariable": "WATDEMAND",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "WATRESEXPLOITRENEW",
    "UsesVariable": "watresexploitrenewm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WATRESEXPLOITRENEW",
    "UsesVariable": "WASTEWATERSUPPLY",
    "Distance": 106,
    "Code": "0"
  },
  {
    "Variable": "WATSAFE",
    "UsesVariable": "watsafenewsw",
    "Distance": 0,
    "Code": "\r\r'jrs 2020/06/08 WATSAFE(R%, 1) = CSng(Math.Round(AMAX(0, 100 - WATSAFE(R%, 3) - WATSAFE(R%, 2)), 4))\rWATSAFE(R%, 1) = AMAX(0, 100 - WATSAFE(R%, 3) - WATSAFE(R%, 2))\r\r'mti 2022/09/25 start\r"
  },
  {
    "Variable": "WATSAFE",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WATSAFE",
    "UsesVariable": "HHSIZE",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WATSAFE",
    "UsesVariable": "watsafeexovals",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WATSAFE",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "\rIf watsafeexovals(R%, 3) > -100 Then\rWATSAFE(R%, 3) = watsafeexovals(R%, 3)\rEnd If\r"
  },
  {
    "Variable": "WATSAFE",
    "UsesVariable": "SANITATION",
    "Distance": 130,
    "Code": "0"
  },
  {
    "Variable": "WATSAFE",
    "UsesVariable": "watsafetrgtval",
    "Distance": 2,
    "Code": "\r\r'mti 2014/05/28 - start\r'sPreBudWATSAFE(R%) = WATSAFE(R%, 3)\r'mti 2014/05/28 - end\r'mti 2021/08/10 end  sPreBudWATSAFE(R%, j)\r\r'mti October 20, 2011 - start\riWatSafeNone(R%) = WATSAFE(R%, 1)\r\r'mti May 05, 2011 - start\r'parameter goal seek - start\rIf watsafetrgtyr(R%) > 0 Then\r'If sINFRAELECACC(R%, Urban) < 100 Then\r'mti June 08, 2011 - start\r'                        RatChange = Amin(1, 0.05 / AMAX(0.001, SWATSAFE(R%, 1)))\r'\r'\r'                        'ConvTime = AMAX(3, watsafetrgtyr(R%)- 5 - IY) ' 30  'years\r'                        ConvTime = AMAX(1, watsafetrgtyr(R%)- IY)  ' 30  'years\r'                        'mti June 08, 2011 - end\r'\r'                        cGrowthRateTarget = RatChange ^ (1 / ConvTime) - 1\r'                        watsafeNoTrgt = SWATSAFE(R%, 1) * (1 + cGrowthRateTarget)\r'         If RegName(R%) = \"Chad\" And IY >= 2 Then Stop\r\r\r'mti October 20, 2011 - start\r'                        DistTrgt = AMAX(0, SWATSAFE(R%, 1) - 0)\r'                        TimeLeft = AMAX(1, watsafetrgtyr(R%) + 2 - IY)\r\r'WATSAFENoTrgt = AMAX(0, SWATSAFE(R%, 1) - DistTrgt / TimeLeft)\r'mti May Day 2012 - start\r'WATSAFENoTrgt = iWatSafeNone(R%) - Amin(watsafetrgtyr(R%), IY) * iWatSafeNone(R%) / watsafetrgtyr(R%)\r\r'mti July 25, 2012 - start\r'WATSAFENoTrgt = iWatSafeNone(R%) + watsafetrgtval(R%) - Amin(watsafetrgtyr(R%), IY) * iWatSafeNone(R%) / watsafetrgtyr(R%)\rDim WATSAFENoTrgt = iWatSafeNone(R%) + watsafetrgtval(R%) - Amin(watsafetrgtyr(R%), IY - 1) * iWatSafeNone(R%) / watsafetrgtyr(R%)\r'mti July 25, 2012 - end\r\r'mti May Day 2012 - end\r'mti October 20, 2011 - end\r'mti June 08, 2011 -end\r\r\rDim watsafeNoInitCast = WATSAFE(R%, 1)\r\r'hard target cannot be worse than base case\rWATSAFE(R%, 1) = Amin(watsafeNoInitCast, WATSAFENoTrgt)\r\r'mti October 20, 2011 - start\rDim tdef = watsafeNoInitCast - WATSAFE(R%, 1)\rIf tdef > 0 Then\rDim tother = WATSAFE(R%, 2) + WATSAFE(R%, 3)\rWATSAFE(R%, 2) = WATSAFE(R%, 2) + tdef * WATSAFE(R%, 2) / tother\rWATSAFE(R%, 3) = WATSAFE(R%, 3) + tdef * WATSAFE(R%, 3) / tother\rEnd If\r\r'this will increase improved (not much of hh con) for countries historically high in improved - like Cameroon\r'                        tdef = SWATSAFE(R%, 1) - WATSAFE(R%, 1)\r'                        If tdef > 0 Then\r'                            tother = SWATSAFE(R%, 2) + SWATSAFE(R%, 3)\r'                            WATSAFE(R%, 2) = SWATSAFE(R%, 2) + tdef * SWATSAFE(R%, 2) / tother\r'                            WATSAFE(R%, 3) = SWATSAFE(R%, 3) + tdef * SWATSAFE(R%, 3) / tother\r'                        End If\r\r'mti October 20, 2011 - end\r\r'End If\rEnd If\r\r'mti May 05, 2011 - start\r'parameter goal seek - start\rIf watsafetrgtyr(R%) > 0 Then\r'If sINFRAELECACC(R%, Urban) < 100 Then\r'mti June 08, 2011 - start\r'                        RatChange = Amin(1, 0.05 / AMAX(0.001, SWATSAFE(R%, 1)))\r'\r'\r'                        'ConvTime = AMAX(3, watsafetrgtyr(R%)- 5 - IY) ' 30  'years\r'                        ConvTime = AMAX(1, watsafetrgtyr(R%)- IY)  ' 30  'years\r'                        'mti June 08, 2011 - end\r'\r'                        cGrowthRateTarget = RatChange ^ (1 / ConvTime) - 1\r'                        watsafeNoTrgt = SWATSAFE(R%, 1) * (1 + cGrowthRateTarget)\r'         If RegName(R%) = \"Chad\" And IY >= 2 Then Stop\r\r\r'mti October 20, 2011 - start\r'                        DistTrgt = AMAX(0, SWATSAFE(R%, 1) - 0)\r'                        TimeLeft = AMAX(1, watsafetrgtyr(R%) + 2 - IY)\r\r'WATSAFENoTrgt = AMAX(0, SWATSAFE(R%, 1) - DistTrgt / TimeLeft)\r'mti May Day 2012 - start\r'WATSAFENoTrgt = iWatSafeNone(R%) - Amin(watsafetrgtyr(R%), IY) * iWatSafeNone(R%) / watsafetrgtyr(R%)\r\r'mti July 25, 2012 - start\r'WATSAFENoTrgt = iWatSafeNone(R%) + watsafetrgtval(R%) - Amin(watsafetrgtyr(R%), IY) * iWatSafeNone(R%) / watsafetrgtyr(R%)\rDim WATSAFENoTrgt = iWatSafeNone(R%) + watsafetrgtval(R%) - Amin(watsafetrgtyr(R%), IY - 1) * iWatSafeNone(R%) / watsafetrgtyr(R%)\r'mti July 25, 2012 - end\r\r'mti May Day 2012 - end\r'mti October 20, 2011 - end\r'mti June 08, 2011 -end\r\r\rDim watsafeNoInitCast = WATSAFE(R%, 1)\r\r'hard target cannot be worse than base case\rWATSAFE(R%, 1) = Amin(watsafeNoInitCast, WATSAFENoTrgt)\r\r'mti October 20, 2011 - start\rDim tdef = watsafeNoInitCast - WATSAFE(R%, 1)\rIf tdef > 0 Then\rDim tother = WATSAFE(R%, 2) + WATSAFE(R%, 3)\rWATSAFE(R%, 2) = WATSAFE(R%, 2) + tdef * WATSAFE(R%, 2) / tother\rWATSAFE(R%, 3) = WATSAFE(R%, 3) + tdef * WATSAFE(R%, 3) / tother\rEnd If\r\r'this will increase improved (not much of hh con) for countries historically high in improved - like Cameroon\r'                        tdef = SWATSAFE(R%, 1) - WATSAFE(R%, 1)\r'                        If tdef > 0 Then\r'                            tother = SWATSAFE(R%, 2) + SWATSAFE(R%, 3)\r'                            WATSAFE(R%, 2) = SWATSAFE(R%, 2) + tdef * SWATSAFE(R%, 2) / tother\r'                            WATSAFE(R%, 3) = SWATSAFE(R%, 3) + tdef * SWATSAFE(R%, 3) / tother\r'                        End If\r\r'mti October 20, 2011 - end\r\r'End If\rEnd If\r\r'mti May 05, 2011 - start\r'parameter goal seek - start\rIf watsafetrgtyr(R%) > 0 Then\r'If sINFRAELECACC(R%, Urban) < 100 Then\r'mti June 08, 2011 - start\r'                        RatChange = Amin(1, 0.05 / AMAX(0.001, SWATSAFE(R%, 1)))\r'\r'\r'                        'ConvTime = AMAX(3, watsafetrgtyr(R%)- 5 - IY) ' 30  'years\r'                        ConvTime = AMAX(1, watsafetrgtyr(R%)- IY)  ' 30  'years\r'                        'mti June 08, 2011 - end\r'\r'                        cGrowthRateTarget = RatChange ^ (1 / ConvTime) - 1\r'                        watsafeNoTrgt = SWATSAFE(R%, 1) * (1 + cGrowthRateTarget)\r'         If RegName(R%) = \"Chad\" And IY >= 2 Then Stop\r\r\r'mti October 20, 2011 - start\r'                        DistTrgt = AMAX(0, SWATSAFE(R%, 1) - 0)\r'                        TimeLeft = AMAX(1, watsafetrgtyr(R%) + 2 - IY)\r\r'WATSAFENoTrgt = AMAX(0, SWATSAFE(R%, 1) - DistTrgt / TimeLeft)\r'mti May Day 2012 - start\r'WATSAFENoTrgt = iWatSafeNone(R%) - Amin(watsafetrgtyr(R%), IY) * iWatSafeNone(R%) / watsafetrgtyr(R%)\r\r'mti July 25, 2012 - start\r'WATSAFENoTrgt = iWatSafeNone(R%) + watsafetrgtval(R%) - Amin(watsafetrgtyr(R%), IY) * iWatSafeNone(R%) / watsafetrgtyr(R%)\rDim WATSAFENoTrgt = iWatSafeNone(R%) + watsafetrgtval(R%) - Amin(watsafetrgtyr(R%), IY - 1) * iWatSafeNone(R%) / watsafetrgtyr(R%)\r'mti July 25, 2012 - end\r\r'mti May Day 2012 - end\r'mti October 20, 2011 - end\r'mti June 08, 2011 -end\r\r\rDim watsafeNoInitCast = WATSAFE(R%, 1)\r\r'hard target cannot be worse than base case\rWATSAFE(R%, 1) = Amin(watsafeNoInitCast, WATSAFENoTrgt)\r\r'mti October 20, 2011 - start\rDim tdef = watsafeNoInitCast - WATSAFE(R%, 1)\rIf tdef > 0 Then\rDim tother = WATSAFE(R%, 2) + WATSAFE(R%, 3)\rWATSAFE(R%, 2) = WATSAFE(R%, 2) + tdef * WATSAFE(R%, 2) / tother\rWATSAFE(R%, 3) = WATSAFE(R%, 3) + tdef * WATSAFE(R%, 3) / tother\rEnd If\r\r'this will increase improved (not much of hh con) for countries historically high in improved - like Cameroon\r'                        tdef = SWATSAFE(R%, 1) - WATSAFE(R%, 1)\r'                        If tdef > 0 Then\r'                            tother = SWATSAFE(R%, 2) + SWATSAFE(R%, 3)\r'                            WATSAFE(R%, 2) = SWATSAFE(R%, 2) + tdef * SWATSAFE(R%, 2) / tother\r'                            WATSAFE(R%, 3) = SWATSAFE(R%, 3) + tdef * SWATSAFE(R%, 3) / tother\r'                        End If\r\r'mti October 20, 2011 - end\r\r'End If\rEnd If\r"
  },
  {
    "Variable": "WATSAFE",
    "UsesVariable": "watsafetrgtyr",
    "Distance": 2,
    "Code": "\r\r'mti 2014/05/28 - start\r'sPreBudWATSAFE(R%) = WATSAFE(R%, 3)\r'mti 2014/05/28 - end\r'mti 2021/08/10 end  sPreBudWATSAFE(R%, j)\r\r'mti October 20, 2011 - start\riWatSafeNone(R%) = WATSAFE(R%, 1)\r"
  },
  {
    "Variable": "WATSAFE",
    "UsesVariable": "watsafem",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "WATSAFE",
    "UsesVariable": "GDPPCP",
    "Distance": 20,
    "Code": "0"
  },
  {
    "Variable": "WATSAFE",
    "UsesVariable": "EDYRSAG25",
    "Distance": 20,
    "Code": "0"
  },
  {
    "Variable": "WATSAFE",
    "UsesVariable": "POPURBAN",
    "Distance": 151,
    "Code": "0"
  },
  {
    "Variable": "WATSAFE",
    "UsesVariable": "POPR",
    "Distance": 265,
    "Code": "0"
  },
  {
    "Variable": "WATSAFE",
    "UsesVariable": "POPURBGR",
    "Distance": 264,
    "Code": "0"
  },
  {
    "Variable": "WATSAFE",
    "UsesVariable": "watsafenoconsetar",
    "Distance": 1,
    "Code": "\r'jrs 2009/04/24 change to Additive Shift Factor\r'WATSAFEshift(R%, 3) = WATSAFE(R%, 3) / calWATSAFE\rWATSAFEShift(R%, 3) = WATSAFE(R%, 3) - calWATSAFE\r\r'mti 2021/08/10 start\r'                If WATSAFEShift(R%, 1) > 0 Then\r'                    WatSafeNoAdd = ConvergeOverTime(WATSAFEShift(R%, 1), 0, watsanconv)  '100\r'                Else\r'                    WatSafeNoAdd = WATSAFEShift(R%, 1)  '+ ConvergeOverTime(WATSAFEShift(R%, 1), 0, 1000)\r'                End If\rWatSafeNoAdd = ConvergeOverTime(WATSAFEShift(R%, 1), 0, watsanconv)  '100\r\r\r\rcalWATSAFE = CSng(s1 / (1 + s1 + s2) * 100)\r\rIf watsafenoconsetar(R%) <> 0 Then\r'mti April 05, 2012 - start\r'WatSafeNoSE = 8.2\rWatSafeNoSE = 6\r'mti April 05, 2012 - end\rEffectSE = StdErrorAdditiveShift(CSng(WatSafeNoSE), CSng(calWATSAFE), CSng(WatSafeNoAdd), CSng(WATSAFEShift(R%, 1)),\r                    CSng(watsafenoconsetar(R%)), CInt(FirstYear + watsafenoconseyrtar(R%)), FirstYear + IY - 1, FirstYear)\rEnd If\r\rwatsanconv = 75 '50\r\r'jrs 2009/04/24 change to Additive Shift Factor\r'WATSAFEshift(R%, 3) = WATSAFE(R%, 3) / calWATSAFE\rWATSAFEShift(R%, 3) = WATSAFE(R%, 3) - calWATSAFE\r\r'mti February 2011 Infarstructure - end\rDim s2 = Math.Exp(calWATSAFE)\r\r'mti February 2011 Infarstructure - end\rDim s1 = Math.Exp(calWATSAFE)\r\rIf watsafenoconsetar(R%) <> 0 Then\r'mti April 05, 2012 - start\r'WatSafeNoSE = 8.2\rWatSafeNoSE = 6\r'mti April 05, 2012 - end\rEffectSE = StdErrorAdditiveShift(CSng(WatSafeNoSE), CSng(calWATSAFE), CSng(WatSafeNoAdd), CSng(WATSAFEShift(R%, 1)),\r                    CSng(watsafenoconsetar(R%)), CInt(FirstYear + watsafenoconseyrtar(R%)), FirstYear + IY - 1, FirstYear)\rEnd If\r\r'mti 2021/08/10 start\r'                If WATSAFEShift(R%, 1) > 0 Then\r'                    WatSafeNoAdd = ConvergeOverTime(WATSAFEShift(R%, 1), 0, watsanconv)  '100\r'                Else\r'                    WatSafeNoAdd = WATSAFEShift(R%, 1)  '+ ConvergeOverTime(WATSAFEShift(R%, 1), 0, 1000)\r'                End If\rWatSafeNoAdd = ConvergeOverTime(WATSAFEShift(R%, 1), 0, watsanconv)  '100\r\r\r\rcalWATSAFE = CSng(s1 / (1 + s1 + s2) * 100)\r\r\r'mti note: JRS original model did not have upper and lower bounds here; Check if that makes a difference\r'If IY = 6 And GRPS(1, R) = \"Iceland\" Then Stop\rWATSAFE(R%, 1) = calWATSAFE + WatSafeNoAdd + EffectSE\r\r'mti October 20, 2011 - end\r\r\r'jrs 2009/07/07\r'                WATSAFE(R%, 1) = WATSAFE(R%, 1) * watsafem(R%, 1)\r\rWATSAFE(R%, 1) = AMAX(Amin(WATSAFE(R%, 1), 100), 0)\r"
  },
  {
    "Variable": "WATSAFE",
    "UsesVariable": "watsafenoconseyrtar",
    "Distance": 1,
    "Code": "\r'jrs 2009/04/24 change to Additive Shift Factor\r'WATSAFEshift(R%, 3) = WATSAFE(R%, 3) / calWATSAFE\rWATSAFEShift(R%, 3) = WATSAFE(R%, 3) - calWATSAFE\r"
  },
  {
    "Variable": "WATSAFE",
    "UsesVariable": "GDS",
    "Distance": 250,
    "Code": "0"
  },
  {
    "Variable": "WATSAFE",
    "UsesVariable": "GDP",
    "Distance": 250,
    "Code": "0"
  },
  {
    "Variable": "WATSAFE",
    "UsesVariable": "igdpr",
    "Distance": 264,
    "Code": "0"
  },
  {
    "Variable": "WATSAFE",
    "UsesVariable": "watsafhldsw",
    "Distance": 0,
    "Code": "\r'mti Dec 12, 2010 - start\rIf watsafhldsw = 0 Then\r'jrs 2009/12/23\rFor j = 1 To 3\r'jrs 2020/06/08 SWATSAFE(R%, j) = CSng(Math.Round(WATSAFE(R%, j), 4))\rSWATSAFE(R%, j) = WATSAFE(R%, j)\rNext j\rEnd If\r"
  },
  {
    "Variable": "WATSAFECOST",
    "UsesVariable": "watsafecostm",
    "Distance": 0,
    "Code": "\r'  If RegName(R%) = \"Angola\" Then Stop\r'mti February 2011 Infarstructure - start\r'Water - Safe Water Connection Cost\r'            WatSafeConAdded = AMAX(0, (WATSAFE(R%, 3) * POP(R%) / HHSIZE(R%) - SWATSAFE(R%, 3) * CDbl(sPOPTOTAL(R%)) / sHHSIZEWS(R%)) * 10000)\rCalcInfraUnitCost(R%, 10, 5, watsafecostupper, watsafecostlower, sGDPPCP(R%), WATSAFECOST(R%))\r'mti April 2011 -start\rWATSAFECOST(R%) = WATSAFECOST(R%) * watsafecostm(R%)\r"
  },
  {
    "Variable": "WATSAFEIMPCOST",
    "UsesVariable": "watsafeimpcostm",
    "Distance": 0,
    "Code": "\r\rCalcInfraInvest(CDbl(WatSafeDemThousands), CDbl(sWatSafeThousands),\r                            DeppcntWS(SafeWaterHH), WATSAFECOST(R%), INFRAINVESTNEW(R%, SafeWaterHH), INFRAINVESTMAINT(R%, SafeWaterHH))\r\r\r'----------Safe Water Other Improved cost---------\r'            SanitConadded = AMAX(0, (SANITATION(R%, 3) * POP(R%) / HHSIZE(R%) - SSANITATION(R%, 3) * CDbl(sPOPTOTAL(R%)) / sHHSIZEWS(R%)) * 10000)\rCalcInfraUnitCost(R%, 10, 5, watsafeimpcostupper, watsafeimpcostlower, sGDPPCP(R%), WATSAFEIMPCOST(R%))\r\rWATSAFEIMPCOST(R%) = WATSAFEIMPCOST(R%) * watsafeimpcostm(R%)\r"
  },
  {
    "Variable": "WATUSE",
    "UsesVariable": "WATUSEPC",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WATUSE",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WATUSEPC",
    "UsesVariable": "AGP",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "WATUSEPC",
    "UsesVariable": "POP",
    "Distance": 5,
    "Code": "0"
  },
  {
    "Variable": "WATUSEPC",
    "UsesVariable": "aglossprodm",
    "Distance": 371,
    "Code": "\rCall XYTABL(\"GDP/Capita (PPP 2011) Versus Crop Production Losses (Linear fixed effect)\", GDPPCP(R%), aglossprodcropfunc, context)\r\r'kbn 2017/09/13 Add multiplier aglossprodm below  'bbh 2017/09/23 revised location of multiplier\rDim aglossprodcrop = Amin(AMAX(aglossprodcropfunc * aglossprodm(R%, 1), 2), 20) 'Losses capped here\r"
  },
  {
    "Variable": "WATUSEPC",
    "UsesVariable": "GDPPCP",
    "Distance": 372,
    "Code": "\rCall XYTABL(\"GDP/Capita (PPP 2011) Versus Crop Production Losses (Linear fixed effect)\", GDPPCP(R%), aglossprodcropfunc, context)\r"
  },
  {
    "Variable": "WATWASTE",
    "UsesVariable": "WATWASTETREAT",
    "Distance": 0,
    "Code": "\r\r'adjust watawste if needed\rWATWASTE(R%) = AMAX(WATWASTETREAT(R%), WATWASTE(R%))\r\r'if yes, put the extra in the box cart\r\r\r'mti June 04, 2012 -end\r"
  },
  {
    "Variable": "WATWASTE",
    "UsesVariable": "SANITATION",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WATWASTE",
    "UsesVariable": "watwastem",
    "Distance": 0,
    "Code": "\r'mti July 18, 2011 - END\r\r'mti note: multiplier not applied in other infrastructures\rWATWASTE(R%) = WATWASTE(R%) * watwastem(R%)\r"
  },
  {
    "Variable": "WATWASTE",
    "UsesVariable": "GDPPCP",
    "Distance": 12,
    "Code": "0"
  },
  {
    "Variable": "WATWASTE",
    "UsesVariable": "POPURBAN",
    "Distance": 13,
    "Code": "0"
  },
  {
    "Variable": "WATWASTE",
    "UsesVariable": "POP",
    "Distance": 283,
    "Code": "0"
  },
  {
    "Variable": "WATWASTETREAT",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WATWASTETREAT",
    "UsesVariable": "WATWASTE",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WATWASTETREAT",
    "UsesVariable": "watwastetreatm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WATWASTETREAT",
    "UsesVariable": "GDPPCP",
    "Distance": 6,
    "Code": "0"
  },
  {
    "Variable": "WATWASTETREAT",
    "UsesVariable": "SANITATION",
    "Distance": 23,
    "Code": "0"
  },
  {
    "Variable": "WATWASTETREAT",
    "UsesVariable": "watwastetreatsetar",
    "Distance": 1,
    "Code": "\r\r\r'mti August 22, 2011 -start\r'new model is as % of pop\r'PcntColTreated = 100 * WATWASTETREAT(R%) / WATWASTE(R%)\r'mti Sep 12, 2011 - end\rWatWasteTreatShift(R%) = WATWASTETREAT(R%) - Prediction\r\rIf WatWasteTreatShift(R%) < 0 Then\rWWTAdd = ConvergeOverTime(WatWasteTreatShift(R%), 0, 25)\rElse 'slower/no downward convergence\rWWTAdd = ConvergeOverTime(WatWasteTreatShift(R%), 0, 250)\rEnd If\r\rPrediction = CSng(SSANITATION(R%, 3) / (1 + Math.Exp(2.339779 - 0.042719 * GDPPCP(R%) - 0.041923 * PopUrbanTerm)))\r\r\r'mti July 25, 2012 -start\r'            'base forecast (needed to protect finance)\r'            PredictionBF = SANITATIONBF(R%, 3) / (1 + Exp(2.339779 - 0.042719 * GDPPCP(R%) - 0.041923 * PopUrbanTerm))\r'\r'            If PredictionBF > Prediction1 Then\r'                'percentage controlled by predicted values only\r'                cWatWasteGrowthRateFunctionBF = (PredictionBF - Prediction1) / AMAX(0.001, Prediction1)\r'            Else\r'                cWatWasteGrowthRateFunctionBF = 0.000005 'negligible growth\r'            End If\r'\r'\r'\r'            If PredictionBF > PreMultWATWASTEBF(R%) Then ' SWatWaste(R%)\r'                RatChange = PredictionBF / AMAX(PreMultWATWASTEBF(R%), 0.001) ' SWatWaste(R%)\r'\r'                'needs faster convergence at lower rates\r'                ConvTime = Amin(40, (Int(PreMultWATWASTEBF(R%) / 5) + 1) * 5) '30  'years) ' SWatWaste(R%)\r'                cWatWasteGrowthRatePositionBF = RatChange ^ (1 / ConvTime) - 1 'can be negative\r'            Else\r'                cWatWasteGrowthRatePositionBF = 0.000005 'negligible growth\r'            End If\r'\r'\r'\r'            If Not IsNull(WatWasteGRBF(R%)) Then\r'                '--Growth Rate -----\r'                WatWasteGRBF(R%) = 0.8 * WatWasteGRBF(R%) + 0.05 * cWatWasteGrowthRateFunctionBF + 0.15 * cWatWasteGrowthRatePositionBF\r'                WATWASTEBF(R%) = PreMultWATWASTEBF(R%) * (1 + WatWasteGRBF(R%)) ' SWatWaste(R%)\r'            Else\r'                If WatWasteColShift(R%) < 0 Then\r'                    WATWASTEBF(R%) = PredictionBF + ConvergeOverTime(WatWasteColShift(R%), 0, 25)\r'                Else 'slower/no downward convergence\r'                    WATWASTEBF(R%) = PredictionBF + ConvergeOverTime(WatWasteColShift(R%), 0, 250)\r'                End If\r'                WatWasteGRBF(R%) = (WATWASTEBF(R%) / sWATWASTE(R%)) - 1\r'            End If\r'\r'            PreMultWATWASTEBF(R%) = Amin(SANITATIONBF(R%, 3), WATWASTEBF(R%))\r'            WATWASTEBF(R%) = Amin(SANITATIONBF(R%, 3), WATWASTEBF(R%))\r'mti July 25, 2012 - end\r\r\r\r'WATWASTE(R%) = SANITATION(R%, 3) ' model revision : watwaste = sanitation- HH 'WATWASTE(R%) * watwastem(R%)\r\r\r'mti July 25, 2012 -end\r'mti August 17, 2011 -end\r\r' If RegName(R%) = \"Ghana\" And IY% = 2 Then Debug.Print IY; WATWASTE(R%); SWatWaste(R%); POPURBAN(R%); POP(R%); SANITATION(R%, 3); SSANITATION(R%, 3); GDPPCP(R%); sGDPPCP(R%); sPOPTOTAL(R%); sPOPRURAL(R%); WATWASTEGR(R%); cWatWasteGrowthRateFunction; cWatWasteGrowthRatePosition\r\r\r'If R% = 75 Then Stop\r' If RegName(R%) = \"India\" Then Stop\r'---All Year But First: % connected to wastewater treatment system------------\r'mti - (moving average) Growth rate approach will be problematic when one variable converges to other;\r'With initial data/prediction gap on the first one not yet merged, the second one might converge and thus get a miniscule growth rate\r'with moving average this slower growth rate subsequently creates a divergence for some time\r'mti Sep 12, 2011 - start\r'Prediction = WATWASTE(R%) / (1 + Exp(1.036711 - 0.42925 * WATWASTE(R%)))\rPrediction = CSng(100 / (1 + Math.Exp(2.4821024086192 - 0.0382380937051429 * sGDPPCP(R%) - 0.0288342684215034 * WATWASTE(R%))))\r\r'dkb 2013/09/18 added dimension 1 to watwastetreatsetar and watwastetreateseyrtar\rIf watwastetreatsetar(R%) <> 0 Then\rDim WWTSE As Single = 18.8\r'mti July 05, 2012 -parameter for 100% bound\rEffectSE = StdErrorAdditiveShift(CSng(WWTSE), CSng(Prediction), CSng(WWTAdd), CSng(WatWasteTreatShift(R%)),\r                CSng(watwastetreatsetar(R%)), CInt(FirstYear + watwastetreatseyrtar(R%)), FirstYear + IY - 1, FirstYear, 100)\rEnd If\r\r\r\r'mti August 22, 2011 -start\r'new model is as % of pop\r'PcntColTreated = 100 * WATWASTETREAT(R%) / WATWASTE(R%)\r'mti Sep 12, 2011 - end\rWatWasteTreatShift(R%) = WATWASTETREAT(R%) - Prediction\r\r'mti 2022/10/20 End\r\r'mti July 25, 2012 - start\r\r'mti August 17, 2011 - start\rDim PopUrbanTerm = 100 * POPURBAN(R%) / POP(R%)\r\r'mti Dec 12, 2010 - start\r''******** All Years but first: Water and Sanitation *********************\r''***************************** end *************************************\r\r'mti February 2011 Infarstructure -start\r'All Years but first: WasteWater\r'--------------------------------------\r\r'   If RegName(R%) = \"Ethiopia\" And IY >= 12 Then Stop\r'---% connected to wastewater collection system------------\r\r'mti February 28, 2012  -watwaste revert to older model\r\r'mti August 17, 2011 -start\r'PopUrbanTerm = 100 * POPURBAN(R%) / POP(R%)\rDim PopUrbanTerm = 100 * SPOPURBAN(R%) / sPOPTotal(R%)\r"
  },
  {
    "Variable": "WATWASTETREAT",
    "UsesVariable": "watwastetreatseyrtar",
    "Distance": 1,
    "Code": "\r\r\r'mti August 22, 2011 -start\r'new model is as % of pop\r'PcntColTreated = 100 * WATWASTETREAT(R%) / WATWASTE(R%)\r'mti Sep 12, 2011 - end\rWatWasteTreatShift(R%) = WATWASTETREAT(R%) - Prediction\r"
  },
  {
    "Variable": "WATWASTETREAT",
    "UsesVariable": "POPURBAN",
    "Distance": 24,
    "Code": "0"
  },
  {
    "Variable": "WATWASTETREAT",
    "UsesVariable": "igdpr",
    "Distance": 391,
    "Code": "0"
  },
  {
    "Variable": "WATWASTETREAT",
    "UsesVariable": "POPR",
    "Distance": 391,
    "Code": "0"
  },
  {
    "Variable": "WATWASTETREATCOST",
    "UsesVariable": "watwastetreatcostm",
    "Distance": 0,
    "Code": "\r'single global cost and multiplier\r\r'mti October 20, 2011 - start\r'mti February 28, 2012 - start\r'            WATWASTETREATCOST(R%) = watwastetreatcostglobal * (ConvergeOverTime(INFRACOSTADJFAC(R%), 1, 100))\r'            'WATWASTETREATCOST(R%) = iWatWasteTreatCost(R%) * watwastetreatcostm(R%)  'multiplier on cost; cost is per person\r\rCalcInfraUnitCost(R%, 10, 5, watwastetreatcostupper, watwastetreatcostlower, sGDPPCP(R%), WATWASTETREATCOST(R%))\r'mti February 28, 2012 -end\r\rWATWASTETREATCOST(R%) = WATWASTETREATCOST(R%) * watwastetreatcostm(R%)  'multiplier on cost; cost is per person\r"
  },
  {
    "Variable": "WCLPC",
    "UsesVariable": "WPOP",
    "Distance": 0,
    "Code": "\rFor R% = 1 To NR%\rSum = Sum + CLAVAL(R%)\rCLPC(R%, 4) = AMAX(1500, CLAVAL(R%) / POP(R%))\rNext R%\r\rWCLPC = Sum / WPOP\r"
  },
  {
    "Variable": "WCLPC",
    "UsesVariable": "CLAVAL",
    "Distance": 2,
    "Code": "\r\r'   All Years 2: Calories per Capita\r'   -------------------------------\rDim Sum As Single\rSum = 0\r"
  },
  {
    "Variable": "WCPOW",
    "UsesVariable": "CPOW",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WENP",
    "UsesVariable": "ENP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WEP",
    "UsesVariable": "ENPRI",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "WEP",
    "UsesVariable": "ENP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "WEP",
    "UsesVariable": "WEPBYEAR",
    "Distance": 246,
    "Code": "\rTENPRI = 0!\r"
  },
  {
    "Variable": "WEP",
    "UsesVariable": "EXRATE",
    "Distance": 8,
    "Code": "\rDim TENPRI As Single = 0\r"
  },
  {
    "Variable": "WEPBYEAR",
    "UsesVariable": "WEP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WFORST",
    "UsesVariable": "LD",
    "Distance": 0,
    "Code": "\r'jrs 2007/01/12 no double counting\rIf RegiontoSum(R%) Then\rWFORST = WFORST + LD(R%, 3)\rEnd If\r"
  },
  {
    "Variable": "WGDP",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WGDPPC",
    "UsesVariable": "WGDP",
    "Distance": 0,
    "Code": "\rWGDPPC = WGDP / WPOP\r\r"
  },
  {
    "Variable": "WGDPPC",
    "UsesVariable": "WPOP",
    "Distance": 0,
    "Code": "\rWGDPPC = WGDP / WPOP\r\r"
  },
  {
    "Variable": "WLIFE",
    "UsesVariable": "WPOP",
    "Distance": 0,
    "Code": "\rWLIFE = WLIFE / WPOP\r'jrs 2020/08/31 begin\r'move to ifsPop3 after calculation of PQLI\r'qlno = qlno / AMAX(PNO, 1)\r'qlso = qlso / AMAX(PSO, 1)\r'NSPQLI = CSng(qlno / AMAX(qlso, 0.01))\r'jrs 2020/08/31 end\r"
  },
  {
    "Variable": "WLIFE",
    "UsesVariable": "LIFEXP",
    "Distance": 0,
    "Code": "\r'jrs 2020/08/31 begin\r'move to ifsPop3 after calculation of PQLI\r'PNO = 0!\r'PSO = 0!\r'qlno = 0!\r'qlso = 0!\r'jrs 2020/08/31 end\r\rFor R% = 1 To NR%\rPOPR(R%) = (CBR(R%) - CDR(R%)) / 1000.0! * 100.0! + MIGRATE(R%)\r\r'If RegName$(R%) = \"Kuwait\" Then Stop\r\rWPOPR = WPOPR + POPR(R%) * POP(R%)\r'mti LifeExp/ gender May 2006\rWLIFE = WLIFE + LIFEXP(R%, 3) * POP(R%)\r'        WLIFE = WLIFE + LIFEXP(R%) * POP(R%)\r\r'jrs 2020/08/31 begin\r'move to ifsPop3 after calculation of PQLI\r'If GDPPCI(R%) > nsdiv Then\r'    PNO = PNO + POP(R%)\r'    qlno = qlno + POP(R%) * PQLI(R%)\r'Else\r'    PSO = PSO + POP(R%)\r'    qlso = qlso + POP(R%) * PQLI(R%)\r'End If\r'jrs 2020/08/31 end\r\rNext R%\r"
  },
  {
    "Variable": "WLIFE",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r'jrs 2020/08/31 begin\r'move to ifsPop3 after calculation of PQLI\r'PNO = 0!\r'PSO = 0!\r'qlno = 0!\r'qlso = 0!\r'jrs 2020/08/31 end\r\rFor R% = 1 To NR%\rPOPR(R%) = (CBR(R%) - CDR(R%)) / 1000.0! * 100.0! + MIGRATE(R%)\r\r'If RegName$(R%) = \"Kuwait\" Then Stop\r\rWPOPR = WPOPR + POPR(R%) * POP(R%)\r'mti LifeExp/ gender May 2006\rWLIFE = WLIFE + LIFEXP(R%, 3) * POP(R%)\r'        WLIFE = WLIFE + LIFEXP(R%) * POP(R%)\r\r'jrs 2020/08/31 begin\r'move to ifsPop3 after calculation of PQLI\r'If GDPPCI(R%) > nsdiv Then\r'    PNO = PNO + POP(R%)\r'    qlno = qlno + POP(R%) * PQLI(R%)\r'Else\r'    PSO = PSO + POP(R%)\r'    qlso = qlso + POP(R%) * PQLI(R%)\r'End If\r'jrs 2020/08/31 end\r\rNext R%\r"
  },
  {
    "Variable": "WLIT",
    "UsesVariable": "WPOP",
    "Distance": 0,
    "Code": "\r\r\r\r\r\r\r\r'   All Years 3:  Global Indicators\r'   -------------------------------\r\rWLIT = WLIT / WPOP\r"
  },
  {
    "Variable": "WLIT",
    "UsesVariable": "LIT",
    "Distance": 0,
    "Code": "\rWLIT = WLIT + LIT(R%) * POP(R%)\r"
  },
  {
    "Variable": "WLIT",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\rWLIT = WLIT + LIT(R%) * POP(R%)\r"
  },
  {
    "Variable": "WNPOW",
    "UsesVariable": "NPOW",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "workageretire",
    "UsesVariable": "WORKAGERETIREND",
    "Distance": 4,
    "Code": "\r'bbh 2014/06/18 start\rIf workageretirendpctuse(R%) > 0 Then\r'If RegName$(R%) = \"United States of America\" Then Stop\r'Find Savings needed at needed retirement age\r'Annuity of 20 during working years PV = C * [(1-(1+i)^-n)/i]\r'                SavingsNew(R%) = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - WORKAGERETIREND(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r'                'Find current and original Savings\r'                SavingsCurrent = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - workageretire(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r'                SavingsOld(R%) = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - WorkAgeRetireI(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r'                SavingsNeeded(R%) = SavingsNew(R%) - SavingsOld(R%)\r'                SavingsCoveredRatio = (SavingsCurrent - SavingsOld(R%)) / AMAX(0.001, SavingsNeeded(R%)) * 100\r'                SavingsAdj = workageretirendpctuse(R%) - SavingsCoveredRatio\r'                RetireYearsAdj = (WORKAGERETIREND(R%) - WorkAgeRetireI(R%)) * SavingsAdj / 100 / 2 '/2 to avoid oscillation\r\rRetireYearsAdjNeed = (WORKAGERETIREND(R%) - WorkAgeRetireI(R%)) * workageretirendpctuse(R%) / 100\rRetireYearsAdjActual = workageretire(R%) - WorkAgeRetireI(R%)\rRetireYearsAdj = (RetireYearsAdjNeed - RetireYearsAdjActual) / 2 '/2 to avoid oscillation\rIf RetireYearsAdj < 0 Then RetireYearsAdj = RetireYearsAdj / 10 'Greatly slow downside adjust\r\rworkageretire(R%) = workageretire(R%) + RetireYearsAdj\rsworkageretire(R%) = workageretire(R%)\r\r''                'Find Savings needed at needed retirement age\r''                'Annuity of 20 during working years PV = C * [(1-(1+i)^-n)/i]\r'                SavingsNew(R%) = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - WORKAGERETIREND(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r'                'Find current Savings\r'                SavingsOld(R%) = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - workageretire(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r\r'                'Find hole in $\r'                SavingsNeeded(R%) = SavingsNew(R%) - SavingsOld(R%)\r'                'Find retirement age to fill in percentage of hole\r'                'n = - ln(C/i - PV)/ln(1+i)\r'                'bbh 2013/08/05 start\r'                    'The original line below was blowing up in 2011 with workageretirendpctuse=100 for afghan (more generally also)\r'                    '   Second term of log in numerator was provding a very large negative number and blowing up log calc\r'                'WorkYearsNew = -Log((100 - workercon) / savingsdiscountrt(R%) / 100 - _\r'                    (SavingsOld(R%) + SavingsNeeded(R%) * workageretirendpctuse(R%))) / Log(1 + savingsdiscountrt(R%) / 100)\r'                'bbh tried replacing the above with the version below, which seems to better convert percent to decimal\r'                '   But it produced a very large negative WorkYearsNew for Afghan in 2011\r'                ' WorkYearsNew = -Log((100 - workercon) / (savingsdiscountrt(R%) / 100) - _\r'                    (SavingsOld(R%) + SavingsNeeded(R%) * (workageretirendpctuse(R%) / 100))) / Log(1 + savingsdiscountrt(R%) / 100)\r'                'bbh replaced line below with new lines followoing it\r'                'workageretire(R%) = Round(WorkAgeEntry(R%) + WorkYearsNew, 0)\r'                WorkLifeNeeded = WORKAGERETIREND(R%) - WorkAgeEntry(R%)\r'                WorkLifeNow = sworkageretire(R%) - WorkAgeEntry(R%)\r'                WorkLifeDif = WorkLifeNeeded - WorkLifeNow\r'                workageretire(R%) = WorkAgeEntry(R%) + WorkLifeNow + (WorkLifeDif * workageretirendpctuse(R%) / 100) / 2\r'                    '1/2 to avoid oscillation\r'                workageretire(R%) = AMAX(workageretire(R%), WorkAgeEntry(R%) + 5)\r'                workageretire(R%) = AMAX(workageretire(R%), 65) 'kludge line until analyze why drops with lifexp 200\r'                sworkageretire(R%) = workageretire(R%)\r'                'bbh 2013/08/05 end\rEnd If\r\r'bbh 2014/06/18 start\rIf workageretirendpctuse(R%) > 0 Then\r'If RegName$(R%) = \"United States of America\" Then Stop\r'Find Savings needed at needed retirement age\r'Annuity of 20 during working years PV = C * [(1-(1+i)^-n)/i]\r'                SavingsNew(R%) = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - WORKAGERETIREND(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r'                'Find current and original Savings\r'                SavingsCurrent = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - workageretire(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r'                SavingsOld(R%) = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - WorkAgeRetireI(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r'                SavingsNeeded(R%) = SavingsNew(R%) - SavingsOld(R%)\r'                SavingsCoveredRatio = (SavingsCurrent - SavingsOld(R%)) / AMAX(0.001, SavingsNeeded(R%)) * 100\r'                SavingsAdj = workageretirendpctuse(R%) - SavingsCoveredRatio\r'                RetireYearsAdj = (WORKAGERETIREND(R%) - WorkAgeRetireI(R%)) * SavingsAdj / 100 / 2 '/2 to avoid oscillation\r\rRetireYearsAdjNeed = (WORKAGERETIREND(R%) - WorkAgeRetireI(R%)) * workageretirendpctuse(R%) / 100\rRetireYearsAdjActual = workageretire(R%) - WorkAgeRetireI(R%)\rRetireYearsAdj = (RetireYearsAdjNeed - RetireYearsAdjActual) / 2 '/2 to avoid oscillation\rIf RetireYearsAdj < 0 Then RetireYearsAdj = RetireYearsAdj / 10 'Greatly slow downside adjust\r\rworkageretire(R%) = workageretire(R%) + RetireYearsAdj\rsworkageretire(R%) = workageretire(R%)\r\r''                'Find Savings needed at needed retirement age\r''                'Annuity of 20 during working years PV = C * [(1-(1+i)^-n)/i]\r'                SavingsNew(R%) = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - WORKAGERETIREND(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r'                'Find current Savings\r'                SavingsOld(R%) = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - workageretire(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r\r'                'Find hole in $\r'                SavingsNeeded(R%) = SavingsNew(R%) - SavingsOld(R%)\r'                'Find retirement age to fill in percentage of hole\r'                'n = - ln(C/i - PV)/ln(1+i)\r'                'bbh 2013/08/05 start\r'                    'The original line below was blowing up in 2011 with workageretirendpctuse=100 for afghan (more generally also)\r'                    '   Second term of log in numerator was provding a very large negative number and blowing up log calc\r'                'WorkYearsNew = -Log((100 - workercon) / savingsdiscountrt(R%) / 100 - _\r'                    (SavingsOld(R%) + SavingsNeeded(R%) * workageretirendpctuse(R%))) / Log(1 + savingsdiscountrt(R%) / 100)\r'                'bbh tried replacing the above with the version below, which seems to better convert percent to decimal\r'                '   But it produced a very large negative WorkYearsNew for Afghan in 2011\r'                ' WorkYearsNew = -Log((100 - workercon) / (savingsdiscountrt(R%) / 100) - _\r'                    (SavingsOld(R%) + SavingsNeeded(R%) * (workageretirendpctuse(R%) / 100))) / Log(1 + savingsdiscountrt(R%) / 100)\r'                'bbh replaced line below with new lines followoing it\r'                'workageretire(R%) = Round(WorkAgeEntry(R%) + WorkYearsNew, 0)\r'                WorkLifeNeeded = WORKAGERETIREND(R%) - WorkAgeEntry(R%)\r'                WorkLifeNow = sworkageretire(R%) - WorkAgeEntry(R%)\r'                WorkLifeDif = WorkLifeNeeded - WorkLifeNow\r'                workageretire(R%) = WorkAgeEntry(R%) + WorkLifeNow + (WorkLifeDif * workageretirendpctuse(R%) / 100) / 2\r'                    '1/2 to avoid oscillation\r'                workageretire(R%) = AMAX(workageretire(R%), WorkAgeEntry(R%) + 5)\r'                workageretire(R%) = AMAX(workageretire(R%), 65) 'kludge line until analyze why drops with lifexp 200\r'                sworkageretire(R%) = workageretire(R%)\r'                'bbh 2013/08/05 end\rEnd If\r\r'bbh 2014/06/18 start\rIf workageretirendpctuse(R%) > 0 Then\r'If RegName$(R%) = \"United States of America\" Then Stop\r'Find Savings needed at needed retirement age\r'Annuity of 20 during working years PV = C * [(1-(1+i)^-n)/i]\r'                SavingsNew(R%) = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - WORKAGERETIREND(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r'                'Find current and original Savings\r'                SavingsCurrent = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - workageretire(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r'                SavingsOld(R%) = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - WorkAgeRetireI(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r'                SavingsNeeded(R%) = SavingsNew(R%) - SavingsOld(R%)\r'                SavingsCoveredRatio = (SavingsCurrent - SavingsOld(R%)) / AMAX(0.001, SavingsNeeded(R%)) * 100\r'                SavingsAdj = workageretirendpctuse(R%) - SavingsCoveredRatio\r'                RetireYearsAdj = (WORKAGERETIREND(R%) - WorkAgeRetireI(R%)) * SavingsAdj / 100 / 2 '/2 to avoid oscillation\r\rRetireYearsAdjNeed = (WORKAGERETIREND(R%) - WorkAgeRetireI(R%)) * workageretirendpctuse(R%) / 100\rRetireYearsAdjActual = workageretire(R%) - WorkAgeRetireI(R%)\rRetireYearsAdj = (RetireYearsAdjNeed - RetireYearsAdjActual) / 2 '/2 to avoid oscillation\rIf RetireYearsAdj < 0 Then RetireYearsAdj = RetireYearsAdj / 10 'Greatly slow downside adjust\r\rworkageretire(R%) = workageretire(R%) + RetireYearsAdj\rsworkageretire(R%) = workageretire(R%)\r\r''                'Find Savings needed at needed retirement age\r''                'Annuity of 20 during working years PV = C * [(1-(1+i)^-n)/i]\r'                SavingsNew(R%) = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - WORKAGERETIREND(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r'                'Find current Savings\r'                SavingsOld(R%) = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - workageretire(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r\r'                'Find hole in $\r'                SavingsNeeded(R%) = SavingsNew(R%) - SavingsOld(R%)\r'                'Find retirement age to fill in percentage of hole\r'                'n = - ln(C/i - PV)/ln(1+i)\r'                'bbh 2013/08/05 start\r'                    'The original line below was blowing up in 2011 with workageretirendpctuse=100 for afghan (more generally also)\r'                    '   Second term of log in numerator was provding a very large negative number and blowing up log calc\r'                'WorkYearsNew = -Log((100 - workercon) / savingsdiscountrt(R%) / 100 - _\r'                    (SavingsOld(R%) + SavingsNeeded(R%) * workageretirendpctuse(R%))) / Log(1 + savingsdiscountrt(R%) / 100)\r'                'bbh tried replacing the above with the version below, which seems to better convert percent to decimal\r'                '   But it produced a very large negative WorkYearsNew for Afghan in 2011\r'                ' WorkYearsNew = -Log((100 - workercon) / (savingsdiscountrt(R%) / 100) - _\r'                    (SavingsOld(R%) + SavingsNeeded(R%) * (workageretirendpctuse(R%) / 100))) / Log(1 + savingsdiscountrt(R%) / 100)\r'                'bbh replaced line below with new lines followoing it\r'                'workageretire(R%) = Round(WorkAgeEntry(R%) + WorkYearsNew, 0)\r'                WorkLifeNeeded = WORKAGERETIREND(R%) - WorkAgeEntry(R%)\r'                WorkLifeNow = sworkageretire(R%) - WorkAgeEntry(R%)\r'                WorkLifeDif = WorkLifeNeeded - WorkLifeNow\r'                workageretire(R%) = WorkAgeEntry(R%) + WorkLifeNow + (WorkLifeDif * workageretirendpctuse(R%) / 100) / 2\r'                    '1/2 to avoid oscillation\r'                workageretire(R%) = AMAX(workageretire(R%), WorkAgeEntry(R%) + 5)\r'                workageretire(R%) = AMAX(workageretire(R%), 65) 'kludge line until analyze why drops with lifexp 200\r'                sworkageretire(R%) = workageretire(R%)\r'                'bbh 2013/08/05 end\rEnd If\r\r'bbh 2014/06/18 start\rIf workageretirendpctuse(R%) > 0 Then\r'If RegName$(R%) = \"United States of America\" Then Stop\r'Find Savings needed at needed retirement age\r'Annuity of 20 during working years PV = C * [(1-(1+i)^-n)/i]\r'                SavingsNew(R%) = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - WORKAGERETIREND(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r'                'Find current and original Savings\r'                SavingsCurrent = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - workageretire(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r'                SavingsOld(R%) = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - WorkAgeRetireI(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r'                SavingsNeeded(R%) = SavingsNew(R%) - SavingsOld(R%)\r'                SavingsCoveredRatio = (SavingsCurrent - SavingsOld(R%)) / AMAX(0.001, SavingsNeeded(R%)) * 100\r'                SavingsAdj = workageretirendpctuse(R%) - SavingsCoveredRatio\r'                RetireYearsAdj = (WORKAGERETIREND(R%) - WorkAgeRetireI(R%)) * SavingsAdj / 100 / 2 '/2 to avoid oscillation\r\rRetireYearsAdjNeed = (WORKAGERETIREND(R%) - WorkAgeRetireI(R%)) * workageretirendpctuse(R%) / 100\rRetireYearsAdjActual = workageretire(R%) - WorkAgeRetireI(R%)\rRetireYearsAdj = (RetireYearsAdjNeed - RetireYearsAdjActual) / 2 '/2 to avoid oscillation\rIf RetireYearsAdj < 0 Then RetireYearsAdj = RetireYearsAdj / 10 'Greatly slow downside adjust\r\rworkageretire(R%) = workageretire(R%) + RetireYearsAdj\rsworkageretire(R%) = workageretire(R%)\r\r''                'Find Savings needed at needed retirement age\r''                'Annuity of 20 during working years PV = C * [(1-(1+i)^-n)/i]\r'                SavingsNew(R%) = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - WORKAGERETIREND(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r'                'Find current Savings\r'                SavingsOld(R%) = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - workageretire(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r\r'                'Find hole in $\r'                SavingsNeeded(R%) = SavingsNew(R%) - SavingsOld(R%)\r'                'Find retirement age to fill in percentage of hole\r'                'n = - ln(C/i - PV)/ln(1+i)\r'                'bbh 2013/08/05 start\r'                    'The original line below was blowing up in 2011 with workageretirendpctuse=100 for afghan (more generally also)\r'                    '   Second term of log in numerator was provding a very large negative number and blowing up log calc\r'                'WorkYearsNew = -Log((100 - workercon) / savingsdiscountrt(R%) / 100 - _\r'                    (SavingsOld(R%) + SavingsNeeded(R%) * workageretirendpctuse(R%))) / Log(1 + savingsdiscountrt(R%) / 100)\r'                'bbh tried replacing the above with the version below, which seems to better convert percent to decimal\r'                '   But it produced a very large negative WorkYearsNew for Afghan in 2011\r'                ' WorkYearsNew = -Log((100 - workercon) / (savingsdiscountrt(R%) / 100) - _\r'                    (SavingsOld(R%) + SavingsNeeded(R%) * (workageretirendpctuse(R%) / 100))) / Log(1 + savingsdiscountrt(R%) / 100)\r'                'bbh replaced line below with new lines followoing it\r'                'workageretire(R%) = Round(WorkAgeEntry(R%) + WorkYearsNew, 0)\r'                WorkLifeNeeded = WORKAGERETIREND(R%) - WorkAgeEntry(R%)\r'                WorkLifeNow = sworkageretire(R%) - WorkAgeEntry(R%)\r'                WorkLifeDif = WorkLifeNeeded - WorkLifeNow\r'                workageretire(R%) = WorkAgeEntry(R%) + WorkLifeNow + (WorkLifeDif * workageretirendpctuse(R%) / 100) / 2\r'                    '1/2 to avoid oscillation\r'                workageretire(R%) = AMAX(workageretire(R%), WorkAgeEntry(R%) + 5)\r'                workageretire(R%) = AMAX(workageretire(R%), 65) 'kludge line until analyze why drops with lifexp 200\r'                sworkageretire(R%) = workageretire(R%)\r'                'bbh 2013/08/05 end\rEnd If\r\r'bbh 2014/06/18 start\rIf workageretirendpctuse(R%) > 0 Then\r'If RegName$(R%) = \"United States of America\" Then Stop\r'Find Savings needed at needed retirement age\r'Annuity of 20 during working years PV = C * [(1-(1+i)^-n)/i]\r'                SavingsNew(R%) = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - WORKAGERETIREND(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r'                'Find current and original Savings\r'                SavingsCurrent = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - workageretire(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r'                SavingsOld(R%) = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - WorkAgeRetireI(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r'                SavingsNeeded(R%) = SavingsNew(R%) - SavingsOld(R%)\r'                SavingsCoveredRatio = (SavingsCurrent - SavingsOld(R%)) / AMAX(0.001, SavingsNeeded(R%)) * 100\r'                SavingsAdj = workageretirendpctuse(R%) - SavingsCoveredRatio\r'                RetireYearsAdj = (WORKAGERETIREND(R%) - WorkAgeRetireI(R%)) * SavingsAdj / 100 / 2 '/2 to avoid oscillation\r\rRetireYearsAdjNeed = (WORKAGERETIREND(R%) - WorkAgeRetireI(R%)) * workageretirendpctuse(R%) / 100\rRetireYearsAdjActual = workageretire(R%) - WorkAgeRetireI(R%)\rRetireYearsAdj = (RetireYearsAdjNeed - RetireYearsAdjActual) / 2 '/2 to avoid oscillation\rIf RetireYearsAdj < 0 Then RetireYearsAdj = RetireYearsAdj / 10 'Greatly slow downside adjust\r\rworkageretire(R%) = workageretire(R%) + RetireYearsAdj\rsworkageretire(R%) = workageretire(R%)\r\r''                'Find Savings needed at needed retirement age\r''                'Annuity of 20 during working years PV = C * [(1-(1+i)^-n)/i]\r'                SavingsNew(R%) = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - WORKAGERETIREND(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r'                'Find current Savings\r'                SavingsOld(R%) = 20 * ((1 - (1 + savingsdiscountrt(R%) / 100) ^ (workageentry(R%) - workageretire(R%))) / _\r'                    (savingsdiscountrt(R%) / 100))\r\r'                'Find hole in $\r'                SavingsNeeded(R%) = SavingsNew(R%) - SavingsOld(R%)\r'                'Find retirement age to fill in percentage of hole\r'                'n = - ln(C/i - PV)/ln(1+i)\r'                'bbh 2013/08/05 start\r'                    'The original line below was blowing up in 2011 with workageretirendpctuse=100 for afghan (more generally also)\r'                    '   Second term of log in numerator was provding a very large negative number and blowing up log calc\r'                'WorkYearsNew = -Log((100 - workercon) / savingsdiscountrt(R%) / 100 - _\r'                    (SavingsOld(R%) + SavingsNeeded(R%) * workageretirendpctuse(R%))) / Log(1 + savingsdiscountrt(R%) / 100)\r'                'bbh tried replacing the above with the version below, which seems to better convert percent to decimal\r'                '   But it produced a very large negative WorkYearsNew for Afghan in 2011\r'                ' WorkYearsNew = -Log((100 - workercon) / (savingsdiscountrt(R%) / 100) - _\r'                    (SavingsOld(R%) + SavingsNeeded(R%) * (workageretirendpctuse(R%) / 100))) / Log(1 + savingsdiscountrt(R%) / 100)\r'                'bbh replaced line below with new lines followoing it\r'                'workageretire(R%) = Round(WorkAgeEntry(R%) + WorkYearsNew, 0)\r'                WorkLifeNeeded = WORKAGERETIREND(R%) - WorkAgeEntry(R%)\r'                WorkLifeNow = sworkageretire(R%) - WorkAgeEntry(R%)\r'                WorkLifeDif = WorkLifeNeeded - WorkLifeNow\r'                workageretire(R%) = WorkAgeEntry(R%) + WorkLifeNow + (WorkLifeDif * workageretirendpctuse(R%) / 100) / 2\r'                    '1/2 to avoid oscillation\r'                workageretire(R%) = AMAX(workageretire(R%), WorkAgeEntry(R%) + 5)\r'                workageretire(R%) = AMAX(workageretire(R%), 65) 'kludge line until analyze why drops with lifexp 200\r'                sworkageretire(R%) = workageretire(R%)\r'                'bbh 2013/08/05 end\rEnd If\r"
  },
  {
    "Variable": "workageretire",
    "UsesVariable": "workageretirendpctuse",
    "Distance": 4,
    "Code": "0"
  },
  {
    "Variable": "workageretire",
    "UsesVariable": "HHRETIRENEED",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "workageretire",
    "UsesVariable": "CRETIRE",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WORKAGERETIREND",
    "UsesVariable": "LIFEXP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WORKAGERETIREND",
    "UsesVariable": "workageentry",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WORKAGERETIREND",
    "UsesVariable": "savingsdiscountrt",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WORKAGERETIREND",
    "UsesVariable": "workageretire",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "WP",
    "UsesVariable": "agon",
    "Distance": 0,
    "Code": "\rFor R% = 1 To NR%\r'            WorldVadd(S%) = WorldVadd(S%) + VADD(R%, S%)\r'            WorldVaddWP(S%) = WorldVaddWP(S%) + VADD(R%, S%) * WP(S%)\rTWorldVadd = TWorldVadd + VADD(R%, S%)\rTWorldVaddWP = TWorldVaddWP + VADD(R%, S%) * WP(S%)\rNext R%\r\r\rFor R% = 1 To NR%\r'            WorldVadd(S%) = WorldVadd(S%) + VADD(R%, S%)\r'            WorldVaddWP(S%) = WorldVaddWP(S%) + VADD(R%, S%) * WP(S%)\rTWorldVadd = TWorldVadd + VADD(R%, S%)\rTWorldVaddWP = TWorldVaddWP + VADD(R%, S%) * WP(S%)\rNext R%\r\r\r''jrs 2008/11/07\r'If IY > 21 Then\r'    Open FdrvRun$ & \"ifslog.txt\" For Append As #500\r'    Print #500, \"Normalize Global Prices\"\r'    Close #500\r'End If\r'   All but First 4:  Normalize Global Prices\r'   -----------------------------------------\r\rFor S% = 1 To NSec%\rIf ((S% > Ener) OrElse (S% = Agri AndAlso agon < 0.9) OrElse (S% = Ener AndAlso enon < 0.9)) Then\r\r'WP(S%) = WP(S%) * WorldVadd(S%) / WorldVaddWP(S%)\rWP(S%) = WP(S%) * TWorldVadd / TWorldVaddWP\rEnd If\rSWP(S%) = WP(S%)\rNext S%\r"
  },
  {
    "Variable": "WP",
    "UsesVariable": "enon",
    "Distance": 0,
    "Code": "\rFor R% = 1 To NR%\r'            WorldVadd(S%) = WorldVadd(S%) + VADD(R%, S%)\r'            WorldVaddWP(S%) = WorldVaddWP(S%) + VADD(R%, S%) * WP(S%)\rTWorldVadd = TWorldVadd + VADD(R%, S%)\rTWorldVaddWP = TWorldVaddWP + VADD(R%, S%) * WP(S%)\rNext R%\r\r"
  },
  {
    "Variable": "WP",
    "UsesVariable": "VADD",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "WP",
    "UsesVariable": "WEP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WP",
    "UsesVariable": "WAP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WP",
    "UsesVariable": "PRI",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "WP",
    "UsesVariable": "EXRATE",
    "Distance": 2,
    "Code": "\r'If RegName$(R%) = \"Unitd Kingdm\" Then Stop\r\r\r'   All but First 2:  Adjustments to Intersectoral Flows with Ag Model Computations and Recomputation of ZS, VADD\r'       (for Stock Base and Capacity Utilization)\r'   ------------------------------------------------------\r\rFor column% = 1 To NSec%\rints(R%, column%) = 0!\rintsp = 0!\rFor row = 1 To NSec%\r'If IY% + 2016 = 2018 And RegName$(R%) = \"United States of America\" And row = 2 And column% = 5 Then Stop    'AgINTSFlows\r'If IY% + 2016 = 2020 And RegName$(R%) = \"United States of America\" And row = 2 And column% = 5 Then Stop\rintsp = intsp + AMat(R%, row, column%)\rNext row\rcond = (column% > Ener) Or\r                                (column% = Agri And agon < 0.9) Or (column% = Ener And enon < 0.9)\rintsp = CSng(Amin(0.95, intsp))\rIf cond Then\rZS(R%, column%) = VADD(R%, column%) / (1 - intsp)\rElse\rVADD(R%, column%) = ZS(R%, column%) * (1 - intsp) 'ZS from sectoral models\rEnd If\rFor row = 1 To NSec%\rints(row, column%) = ZS(R%, column%) * AMat(R%, row, column%)\r'If IY% + 2016 = 2018 And RegName$(R%) = \"United States of America\" And row = 2 And column% = 5 Then Stop\r'If IY% + 2016 = 2040 And RegName$(R%) = \"United States of America\" And row = 2 And column% = 5 Then Stop\rNext row\r\rzsp(R%, column%) = ZS(R%, column%)\rGDPPOT(R%) = GDPPOT(R%) + VADD(R%, column%)\rGDPPOTRPA(R%) = GDPPOTRPA(R%) + VADD(R%, column%) * SWP(column%)\rNext column%\r"
  },
  {
    "Variable": "WP",
    "UsesVariable": "ZS",
    "Distance": 121,
    "Code": "0"
  },
  {
    "Variable": "wpgreatlev",
    "UsesVariable": "wpgreatthresh",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WPOP",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r\r'bbh 2020/03/09 2 lines\rCall MigrationGross(context)\r'sgh dkb 2013/8/21 move call to migration up so that ECON model uses modified migration rate\r'Call Migration(context)\r\rFor R% = 1 To NR%\r\r'sgh dkb 2013/08/21 use MIGRATE(R%) instead of migrater(R%) so that ECON model uses modified migration rate\r'       POPR(R%) = (SCBR(R%) - SCDR(R%)) / 1000! * 100! + migrater(R%)\rPOPR(R%) = (SCBR(R%) - SCDR(R%)) / 1000.0! * 100.0! + MIGRATE(R%)\r'If RegName$(R%) = \"Italy\" Then Stop\rPOPR(R%) = Amin(7, AMAX(-2, POPR(R%)))\r'Note:  migrater for Kuwait history huge; must bound this\r' Initial estimate; natural population only\r\r'jrs 2007/01/09 no double counting\r'If RegiontoSum(R%) Then\rWPOP = WPOP + POP(R%)\r'End If\r'        wpop1550 = wpop1550 + SPOP15to50(R%)\r\r'jrs 2010/04/23\r'       All years: Median Age of population\r'       ------------------------------------\r'       Half the population is younger, and half is older\rPOPMEDAGE(R%) = 0\rFor j = 1 To NCohorts\r'Adding up population by 5-year age category\rIf POPMEDAGE(R%) + agedst(j%, R%, 1) + agedst(j%, R%, 2) < POP(R%) / 2 Then\rPOPMEDAGE(R%) = CSng(POPMEDAGE(R%) + agedst(j%, R%, 1) + agedst(j%, R%, 2))\rElse\rIf j > 2 AndAlso j < NCohorts Then\r'Adding up population by 1-year age category\rFor k = 5 To 1 Step -1\rIf POPMEDAGE(R%) + fagedst(j% * 5 - k, R%, 1) + fagedst(j% * 5 - k, R%, 2) < POP(R%) / 2 Then\rPOPMEDAGE(R%) = CSng(POPMEDAGE(R%) + fagedst(j% * 5 - k, R%, 1) + fagedst(j% * 5 - k, R%, 2))\rElse\r'Portion of the year that is missing to reach 50% of the population\r'(POP(R%) / 2 - POPMEDAGE(R%)) / (fagedst(j% * 5 - k, R%, 1) + fagedst(j% * 5 - k, R%, 2))\rPOPMEDAGE(R%) = CSng(j * 5 - k + (POP(R%) / 2 - POPMEDAGE(R%)) / (fagedst(j% * 5 - k, R%, 1) + fagedst(j% * 5 - k, R%, 2)))\rExit For\rEnd If\rNext k\rEnd If\rExit For\rEnd If\rNext j\r\rNext R%\r"
  },
  {
    "Variable": "WPOPR",
    "UsesVariable": "WPOP",
    "Distance": 0,
    "Code": "\r\r'   All Years 2: Malnourished Children (0-5 Years of Age)\r'bbh 2019/06/02 ifsPopMALN malnchpi, smalncomp, smalnmul, CLPCi, malnchpsami, smalnsamcomp, samadmshift, sSAMAVERTED, _\r'malnpoppi, smalnpopmul\rifsPopMALN(malnchpi, MalnChilCompI, smalnmul, CLPCi, malnchpsami, smalnsamcomp, samadmshift, sSAMAVERTED,\r            malnpoppi, smalnpopmul, MalnChilShift, SMalnChP, context) 'bbh 2019/06/02\r\r'   All Years 2: Malnourished Population\r'   -------------------------------------\r'ifsPopMALN\r\r'   All Years 2:  Global Indicators\r'   -------------------------------\rWPOPR = WPOPR / WPOP\r"
  },
  {
    "Variable": "WPOPR",
    "UsesVariable": "POPR",
    "Distance": 0,
    "Code": "\r'jrs 2020/08/31 begin\r'move to ifsPop3 after calculation of PQLI\r'PNO = 0!\r'PSO = 0!\r'qlno = 0!\r'qlso = 0!\r'jrs 2020/08/31 end\r\rFor R% = 1 To NR%\rPOPR(R%) = (CBR(R%) - CDR(R%)) / 1000.0! * 100.0! + MIGRATE(R%)\r\r'If RegName$(R%) = \"Kuwait\" Then Stop\r\rWPOPR = WPOPR + POPR(R%) * POP(R%)\r'mti LifeExp/ gender May 2006\rWLIFE = WLIFE + LIFEXP(R%, 3) * POP(R%)\r'        WLIFE = WLIFE + LIFEXP(R%) * POP(R%)\r\r'jrs 2020/08/31 begin\r'move to ifsPop3 after calculation of PQLI\r'If GDPPCI(R%) > nsdiv Then\r'    PNO = PNO + POP(R%)\r'    qlno = qlno + POP(R%) * PQLI(R%)\r'Else\r'    PSO = PSO + POP(R%)\r'    qlso = qlso + POP(R%) * PQLI(R%)\r'End If\r'jrs 2020/08/31 end\r\rNext R%\r"
  },
  {
    "Variable": "WPOPR",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\r'jrs 2020/08/31 begin\r'move to ifsPop3 after calculation of PQLI\r'PNO = 0!\r'PSO = 0!\r'qlno = 0!\r'qlso = 0!\r'jrs 2020/08/31 end\r\rFor R% = 1 To NR%\rPOPR(R%) = (CBR(R%) - CDR(R%)) / 1000.0! * 100.0! + MIGRATE(R%)\r\r'If RegName$(R%) = \"Kuwait\" Then Stop\r\rWPOPR = WPOPR + POPR(R%) * POP(R%)\r'mti LifeExp/ gender May 2006\rWLIFE = WLIFE + LIFEXP(R%, 3) * POP(R%)\r'        WLIFE = WLIFE + LIFEXP(R%) * POP(R%)\r\r'jrs 2020/08/31 begin\r'move to ifsPop3 after calculation of PQLI\r'If GDPPCI(R%) > nsdiv Then\r'    PNO = PNO + POP(R%)\r'    qlno = qlno + POP(R%) * PQLI(R%)\r'Else\r'    PSO = PSO + POP(R%)\r'    qlso = qlso + POP(R%) * PQLI(R%)\r'End If\r'jrs 2020/08/31 end\r\rNext R%\r"
  },
  {
    "Variable": "WPQLI",
    "UsesVariable": "WPOP",
    "Distance": 0,
    "Code": "\rWPQLI = WPQLI / WPOP\r"
  },
  {
    "Variable": "WPQLI",
    "UsesVariable": "PQLI",
    "Distance": 0,
    "Code": "\rWPQLI = WPQLI + PQLI(R%) * POP(R%)\r"
  },
  {
    "Variable": "WPQLI",
    "UsesVariable": "POP",
    "Distance": 0,
    "Code": "\rWPQLI = WPQLI + PQLI(R%) * POP(R%)\r"
  },
  {
    "Variable": "WRESER",
    "UsesVariable": "RESER",
    "Distance": 0,
    "Code": "\r'\r'     All Years 2:  Indicators of Global Energy Resources\r'     ---------------------------------------------------\rFor e% = 1 To NER%  'Oil, gas, coal, hydro\rWRESER(e%) = 0!\rWRESOR(e%) = 0!\rFor R% = 1 To NR%\rWRESER(e%) = WRESER(e%) + RESER(R%, e%)\r'bbh 2013/06/09 May want to revisit and have WRESORUNCON\r'WRESOR(e%) = WRESOR(e%) + resor(R%, e%) * resorm(R%, e%)\rWRESOR(e%) = WRESOR(e%) + ResorTot(R%, e%)\rNext R%\rNext e%\r"
  },
  {
    "Variable": "WRESOR",
    "UsesVariable": "resorm",
    "Distance": 48,
    "Code": "0"
  },
  {
    "Variable": "WRESOR",
    "UsesVariable": "resor",
    "Distance": 48,
    "Code": "0"
  },
  {
    "Variable": "WRESOR",
    "UsesVariable": "resorunconm",
    "Distance": 48,
    "Code": "0"
  },
  {
    "Variable": "WRESOR",
    "UsesVariable": "resoruncon",
    "Distance": 48,
    "Code": "0"
  },
  {
    "Variable": "WTEMP",
    "UsesVariable": "wtempadd",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WTEMP",
    "UsesVariable": "CO2PPM",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "WTEMP",
    "UsesVariable": "envclimsens",
    "Distance": 2,
    "Code": "\r\r'bbh 2022/04/26 start Move DeltaWT and WTEMP from late and bottom of procedure to here to replace old function use\rDim DeltaWT As Single, CO2PPM1990 As Single\rIf context.HistoricMode = False Then\r'source:\r'http://cdiac.ornl.gov/ftp/trends/co2/maunaloa.co2\rCO2PPM1990 = 354.19\rDeltaWT = CSng(envclimsens / Math.Log(2) * Math.Log(CO2PPM / CO2PPM1990))\rIf IY = 1 Then\r'finding WTEMP for 1990, based on CO2 levels of 350\r'Call XYTABL(\"CO2 PPM Versus Global Temperature\", CO2PPM1990, SWTEMP)\r'using data from Historic Table temperatures (Dale)\r'Source: http://www.ncdc.noaa.gov/oa/climate/research/anomalies/index.html#mean\rSWTEMP = 14.2861  'In 2020 Dale Rothman suggested could be 14.43C in Climate change and impact.docx p6 comment\rEnd If\r\r'bbh 2019/04/06\r'WTEMP = SWTEMP + DeltaWT\rWTEMP = SWTEMP + DeltaWT + wtempadd\r'SWTEMP is actually an intial value not an accrued stock (DelatWT is from 1990)\rElse\rCall XYTABL(\"CO2 PPM Versus Global Temperature\", CO2PPM, WTEMP, context)\rWTEMP = WTEMP + wtempadd\rEnd If\r"
  },
  {
    "Variable": "WTHREAT",
    "UsesVariable": "THREAT",
    "Distance": 0,
    "Code": "\rFor act% = 1 To NR%\rFor tar% = 1 To NR%\rWTHREAT = WTHREAT + THREAT(act%, tar%)\rNext tar%\rNext act%\r\r'TempNr = NR%\r'Tempdiv = (TempNr * (TempNr - 1))\r'TempCalc = WTHREAT / Tempdiv\r'WTHREAT = TempCalc\r'WTHREAT = WTHREAT / (NR% * (NR% - 1))\rWTHREAT = CSng(WTHREAT / (CDbl(NR%) * CDbl(NR% - 1)))\r"
  },
  {
    "Variable": "WTRADE",
    "UsesVariable": "WGDP",
    "Distance": 0,
    "Code": "\rWT = (WM + WX) / 2\r\rWTRADE = WT / WGDP * 100\r"
  },
  {
    "Variable": "WTRADE",
    "UsesVariable": "MRPA",
    "Distance": 4,
    "Code": "\rWM = 0!\r\r\r'     All Steps:  Terms of Trade - Exogenous Change\r'     ---------------------------------------------\r\rWX = 0!\r\rFor R% = 1 To NR%\rIf GDPPCI(R%) < nsdiv Then\rXRPA(R%) = XRPA(R%) * termtrm\rMRPA(R%) = MRPA(R%) / termtrm\rElse\rXRPA(R%) = XRPA(R%) / termtrm\rMRPA(R%) = MRPA(R%) * termtrm\rEnd If\r'bbh 2021/07/07 start Worked on this, but then moved to end of IFsEcoIntl\r'                 FORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) ' - XWORKEMIT(R%) 'Price adjusted compatible with XDEBTRPA\r'                 'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'                 'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'                    FIRMSAV (R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'                 FORSAV(R%) = M(R%) - X(R%) - AID(R%) ' - XWORKEMIT(R%) 'bbh 2021/07/07\r'                 SAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\r'                 SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'                 If RegName$(R%) = \"Ethiopia\" Then Stop\r'bbh 2021/07/07 end\rWX = WX + XRPA(R%)\rWM = WM + MRPA(R%)\rNext R%\r\rWM = 0!\r\rFor R% = 1 To NR%\rIf GDPPCI(R%) < nsdiv Then\rXRPA(R%) = XRPA(R%) * termtrm\rMRPA(R%) = MRPA(R%) / termtrm\rElse\rXRPA(R%) = XRPA(R%) / termtrm\rMRPA(R%) = MRPA(R%) * termtrm\rEnd If\r'bbh 2021/07/07 start Worked on this, but then moved to end of IFsEcoIntl\r'                 FORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) ' - XWORKEMIT(R%) 'Price adjusted compatible with XDEBTRPA\r'                 'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'                 'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'                    FIRMSAV (R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'                 FORSAV(R%) = M(R%) - X(R%) - AID(R%) ' - XWORKEMIT(R%) 'bbh 2021/07/07\r'                 SAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\r'                 SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'                 If RegName$(R%) = \"Ethiopia\" Then Stop\r'bbh 2021/07/07 end\rWX = WX + XRPA(R%)\rWM = WM + MRPA(R%)\rNext R%\r\r\r'     All Steps:  Relative-price Adjusted Trade and Payments Balances\r'     ---------------------------------------------------------------\rWX = AMAX(0.01, WX)\r\rWM = AMAX(0.01, WM)\r"
  },
  {
    "Variable": "WTRADE",
    "UsesVariable": "XRPA",
    "Distance": 5,
    "Code": "\r\r'     All Steps:  Terms of Trade - Exogenous Change\r'     ---------------------------------------------\r\rWX = 0!\r"
  },
  {
    "Variable": "X",
    "UsesVariable": "XS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XARMS",
    "UsesVariable": "MARMS",
    "Distance": 1,
    "Code": "\r\r'jrs 2022/04/04\r'All but First 5: Arms Exports and Imports\r'-------------------------------------------\rDim globalSumOfImports, globalSumOfExports As Single\rglobalSumOfImports = 0\r\r\rFor R% = 1 To NR%\rXARMS(R%) = (GDP(R%) * iXARMSTOGDP(R%) + xarmsadd(R%)) * xarmsm(R%)\rMARMS(R%) = CSng(Amin((GDP(R%) * iMARMSTOGDP(R%) + marmsadd(R%)) * marmsm(R%), sgds(R%, Mil) * armsimmaxpctmilexp(R%))) 'clp 11/16/2022 adding armsimmaxpctmilexp\rglobalSumOfExports = globalSumOfExports + XARMS(R%)\rglobalSumOfImports = globalSumOfImports + MARMS(R%)\rNext R%\r\r\rFor R% = 1 To NR%\rXARMS(R%) = (GDP(R%) * iXARMSTOGDP(R%) + xarmsadd(R%)) * xarmsm(R%)\rMARMS(R%) = CSng(Amin((GDP(R%) * iMARMSTOGDP(R%) + marmsadd(R%)) * marmsm(R%), sgds(R%, Mil) * armsimmaxpctmilexp(R%))) 'clp 11/16/2022 adding armsimmaxpctmilexp\rglobalSumOfExports = globalSumOfExports + XARMS(R%)\rglobalSumOfImports = globalSumOfImports + MARMS(R%)\rNext R%\r\r\r'Normalize\rFor R% = 1 To NR%\rXARMS(R%) = XARMS(R%) * globalSumOfImports / globalSumOfExports\rNext R%\r\r\r''jrs 2008/11/07\r'If IY > 21 Then\r'    Open FdrvRun$ & \"ifslog.txt\" For Append As #500\r'    Print #500, \"End Of Call4\"\r'    Close #500\r'End If\r' GoTo AllSteps 'need to compute trade on 4th step for Interntional Politics\rifsECOAllYears(context, IFUN)\r\r"
  },
  {
    "Variable": "XARMS",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XARMS",
    "UsesVariable": "xarmsadd",
    "Distance": 0,
    "Code": "\r\r'jrs 2022/04/04\r'First Year 1: Arms to GDP ratio\r'---------------------------------\riXARMSTOGDP(R%) = XARMS(R%) / GDP(R%)\r"
  },
  {
    "Variable": "XARMS",
    "UsesVariable": "xarmsm",
    "Distance": 0,
    "Code": "\r\r'jrs 2022/04/04\r'First Year 1: Arms to GDP ratio\r'---------------------------------\riXARMSTOGDP(R%) = XARMS(R%) / GDP(R%)\r"
  },
  {
    "Variable": "XDEBTRPA",
    "UsesVariable": "CURACT",
    "Distance": 0,
    "Code": "\rIf IY% = 1 Then\rSXNFA(R%) = XNFA(R%)\rSXNIIP(R%) = XNIIP(R%)\rElse\rXNFA(R%) = SXNFA(R%) + CURACTDATATOP(R%) 'Is %; includes all Current account terms\rSXNFA(R%) = XNFA(R%)\r'ssxdebtrpa(R%) = sxdebtrpa(R%)\rssxdebtrpapercent(R%) = sxdebtrpa(R%) / GDPPOT(R%) * 100 'Save XDEBT as % of GDP for comparison with current values in computing EXRATE\r'If RegName$(R%) = \"Luxembourg\" And IY% >= 77 Then Stop\rXDEBTRPA(R%) = sxdebtrpa(R%) - CURACT(R%) 'Leaving out CURACTNETPRI/Intereset for now; if go there, could use next line\r'XDEBTRPA(R%) = -XNFA(R%) / 100 * GDPPOT(R%) 'Conceptually XDEBTRPA was like XNIIP; now like XNFA but opposite sign\rsxdebtrpa(R%) = XDEBTRPA(R%)\r'If RegName$(R%) = \"Luxembourg\" And IY% >= 77 Then Stop\rXNIIP(R%) = SXNIIP(R%) + (XPORTFOUT(R%) - XPORTFIN(R%) + XFDIFOUT(R%) - XFDIFIN(R%)) / GDPPOT(R%) * 100\rSXNIIP(R%) = XNIIP(R%)\rEnd If\r"
  },
  {
    "Variable": "XDEBTRPA",
    "UsesVariable": "XGOVTDEBT",
    "Distance": 0,
    "Code": "\rCall ScaleMeOrig(GLOBALIZ, GLOBALIZI)\r'Call ScaleMe(GLOBALIZ)\r'jrs 2016/05/11 *** this section was moved from IFUN = 2  End ****\r\r'ttt 2019/10/08 TakeOut\rArray.Copy(X, SX, NR + 1)\rArray.Copy(M, SM, NR + 1)\rFor R% = 1 To NR%\r'ttt 2019/10/08 TakenOut\r'SX(R%) = X(R%)\r'SM(R%) = M(R%)\r\r''       Government External Debt Changes Needed/Available for Balancing\r''           Could be Short-term, Mid- to Long-Term; IFI sources, etc.\r''       ---------------------------------------------------------------\rIf AID(R%) > 0 Then\rLoanPortion = AID(R%) * aidlp(R%)\rElse 'Donors\rLoanPortion = AID(R%) * WorldAidLP\rEnd If\rsxgovtdebtb(R%) = XGOVTDEBTB(R%) + XGOVTDEBTBF(R%) + LoanPortion\r'bbh 2022/06/23 XIMFCREDIT and XWBLOANS are stocks\rsxgovtdebt(R%) = sxgovtdebtb(R%) + XIMFCREDIT(R%) + XWBLOANS(R%) 'Basic Govt Debt + IFIs\r'Need to build dynamics for IFIs;\r'Ukraine especially problematic with growing IFI debt\r\r'        'bbh 2014/04/02 This code now called 2 times in ModelRun; line below can only be computed once\r'        '   or it makes ssxdebtrpa = XDEBTRPA\r'        If IFUN = 2 Then\r'            ssxdebtrpa(R%) = XDEBTRPA(R%)\r'        End If\r'XFIRMDEBT(R%) = 0 'bbh 2021/09/21 Test of this did not work\rsxdebtrpa(R%) = sxgovtdebt(R%) + XFIRMDEBT(R%) 'Total External Debt\r\r'Only dynamics on XFIRMDEBT is simple 3% growth every year but first, and\r'     allocation of all CURACT, CapActLim to govt is wrong, so can't trust\r'     evolution of XGOVTDEBTB and XFIRMDEBT\r'Need to link XGOVTDEBT back to GOVTDEBTD when can trust XGOVTDEBTB\r\r'Jan 19, 2006 Next step thoughts\r'Put only obvious changes in XGOVTDEBT into it - net IFI flows; loan portion of aid\r'Put other items into broader XFIRMDEBT and therefore also XDEBTRPA\r'Then move to tying XGOVTDEBT back to GOVDEBT,\r'   with GOVTDEBTD always being non-negative\r'Will probably need to somehow break interest and\r'debt repayment out of govt expenditures = look at SeriesGovtPPGDebtService%Rev\r'Rapid drop in US CURACT deficit after 2000 is very problematic; need to specify\r'   role of leader as market of last resort?\r\rNext R%\r"
  },
  {
    "Variable": "XDEBTRPA",
    "UsesVariable": "XFIRMDEBT",
    "Distance": 0,
    "Code": "\rCall ScaleMeOrig(GLOBALIZ, GLOBALIZI)\r'Call ScaleMe(GLOBALIZ)\r'jrs 2016/05/11 *** this section was moved from IFUN = 2  End ****\r\r'ttt 2019/10/08 TakeOut\rArray.Copy(X, SX, NR + 1)\rArray.Copy(M, SM, NR + 1)\rFor R% = 1 To NR%\r'ttt 2019/10/08 TakenOut\r'SX(R%) = X(R%)\r'SM(R%) = M(R%)\r\r''       Government External Debt Changes Needed/Available for Balancing\r''           Could be Short-term, Mid- to Long-Term; IFI sources, etc.\r''       ---------------------------------------------------------------\rIf AID(R%) > 0 Then\rLoanPortion = AID(R%) * aidlp(R%)\rElse 'Donors\rLoanPortion = AID(R%) * WorldAidLP\rEnd If\rsxgovtdebtb(R%) = XGOVTDEBTB(R%) + XGOVTDEBTBF(R%) + LoanPortion\r'bbh 2022/06/23 XIMFCREDIT and XWBLOANS are stocks\rsxgovtdebt(R%) = sxgovtdebtb(R%) + XIMFCREDIT(R%) + XWBLOANS(R%) 'Basic Govt Debt + IFIs\r'Need to build dynamics for IFIs;\r'Ukraine especially problematic with growing IFI debt\r\r'        'bbh 2014/04/02 This code now called 2 times in ModelRun; line below can only be computed once\r'        '   or it makes ssxdebtrpa = XDEBTRPA\r'        If IFUN = 2 Then\r'            ssxdebtrpa(R%) = XDEBTRPA(R%)\r'        End If\r'XFIRMDEBT(R%) = 0 'bbh 2021/09/21 Test of this did not work\rsxdebtrpa(R%) = sxgovtdebt(R%) + XFIRMDEBT(R%) 'Total External Debt\r\r'Only dynamics on XFIRMDEBT is simple 3% growth every year but first, and\r'     allocation of all CURACT, CapActLim to govt is wrong, so can't trust\r'     evolution of XGOVTDEBTB and XFIRMDEBT\r'Need to link XGOVTDEBT back to GOVTDEBTD when can trust XGOVTDEBTB\r\r'Jan 19, 2006 Next step thoughts\r'Put only obvious changes in XGOVTDEBT into it - net IFI flows; loan portion of aid\r'Put other items into broader XFIRMDEBT and therefore also XDEBTRPA\r'Then move to tying XGOVTDEBT back to GOVDEBT,\r'   with GOVTDEBTD always being non-negative\r'Will probably need to somehow break interest and\r'debt repayment out of govt expenditures = look at SeriesGovtPPGDebtService%Rev\r'Rapid drop in US CURACT deficit after 2000 is very problematic; need to specify\r'   role of leader as market of last resort?\r\rNext R%\r"
  },
  {
    "Variable": "XFDIFIN",
    "UsesVariable": "xfdifinm",
    "Distance": 0,
    "Code": "\rFDIAdjFac = CSng(Amin(0.5, AMAX(-0.5, lifexpterm * 0.05)))\r\r'have cut parameter back from .09 in empirical analysis; compound\r'effects in dynamic analysis with stock change\r'bbh 2019/03/15 1 line changed, 1 added\r'XFDIFIN(R%) = XFDIFIN(R%) + FDIAdjFac * XFDIFIN(R%)\rXFDIFIN(R%) = (XFDIFIN(R%) + FDIAdjFac * XFDIFIN(R%)) * xfdifinm(R%)\r\r\r'   All but First:  FDI country/region flows in and out - life expect (health adjust)\r'   ---------------------------------------------------------------------------------\r'jrs 2014/09/16\rDim WSumXFDIFIN As Single, WSumXFDIFINPReAdj As Single, WSumXFDIFOUT As Single, lifexpcomp As Single, lifexpterm As Single, lifexpgap As Single\rDim FDIAdjFac As Single\r\rWSumXFDIFIN = 0\r\rWSumXFDIFINPReAdj = 0\r\r'If RegName$(R%) = \"China\" And IY% = 35 Then Stop\rWSumXFDIFIN = WSumXFDIFIN + XFDIFIN(R%)\r\r'bbh 2013/08/03 end\r\rWSumXFDIFINPReAdj = WSumXFDIFINPReAdj + XFDIFIN(R%)\r\r'If IY% >= 34 Then Stop\rFor R% = 1 To NR%\rXFDIFIN(R%) = XFDIFIN(R%) * WSumXFDIFINPReAdj / WSumXFDIFIN\r'If RegName$(R%) = \"China\" Then Stop\rXFDIFOUT(R%) = XFDIFOUT(R%) * WSumXFDIFINPReAdj / WSumXFDIFOUT\r'If RegName$(R%) = \"China\" And IY% >= 34 Then Stop\rNext R%\r"
  },
  {
    "Variable": "XFDIFIN",
    "UsesVariable": "XFDISTOCK",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XFDIFIN",
    "UsesVariable": "lks",
    "Distance": 2,
    "Code": "\r'   All but First:  FDI country/region flows in and out - initial\r'   -------------------------------------------------------------\r'jrs 2014/09/16\rDim DepreciatedStockIn As Single, DepreciatedStockOut As Single\r\rFor R% = 1 To NR%\r'mti June 2010 - run to run historical -start\rDepreciatedStockIn = sxfdistock(R%) - sxfdistock(R%) / slks(Manu)\rDepreciatedStockOut = sxfdistout(R%) - sxfdistout(R%) / slks(Manu)\r'mti June 2010 - run to run historical - end\rXFDIFIN(R%) = AMAX(sxfdistock(R%) * 0.01, XFDISTOCK(R%) - DepreciatedStockIn)\r\r'If RegName$(R%) = \"China\" Then Stop\r'If IY = 18 And GRPS(1, R) = \"Israel\" Then Stop\rXFDIFOUT(R%) = AMAX(sxfdistout(R%) * 0.01, XFDISTOUT(R%) - DepreciatedStockOut)\rNext R%\r"
  },
  {
    "Variable": "XFDIFOUT",
    "UsesVariable": "XFDIFIN",
    "Distance": 7,
    "Code": "\rWSumXFDIFINPReAdj = 0\r\rWSumXFDIFOUT = WSumXFDIFOUT + XFDIFOUT(R%)\r\r'bbh 2013/08/03 end\r\rWSumXFDIFINPReAdj = WSumXFDIFINPReAdj + XFDIFIN(R%)\r\r'If IY% >= 34 Then Stop\rFor R% = 1 To NR%\rXFDIFIN(R%) = XFDIFIN(R%) * WSumXFDIFINPReAdj / WSumXFDIFIN\r'If RegName$(R%) = \"China\" Then Stop\rXFDIFOUT(R%) = XFDIFOUT(R%) * WSumXFDIFINPReAdj / WSumXFDIFOUT\r'If RegName$(R%) = \"China\" And IY% >= 34 Then Stop\rNext R%\r"
  },
  {
    "Variable": "XFDIFOUT",
    "UsesVariable": "xfdifoutm",
    "Distance": 0,
    "Code": "\rXFDIFOUT(R%) = XFDIFOUT(R%) * xfdifoutm(R%)\r\rWSumXFDIFOUT = 0\r"
  },
  {
    "Variable": "XFDIFOUT",
    "UsesVariable": "XFDISTOUT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XFDIFOUT",
    "UsesVariable": "lks",
    "Distance": 2,
    "Code": "\r'   All but First:  FDI country/region flows in and out - initial\r'   -------------------------------------------------------------\r'jrs 2014/09/16\rDim DepreciatedStockIn As Single, DepreciatedStockOut As Single\r\rFor R% = 1 To NR%\r'mti June 2010 - run to run historical -start\rDepreciatedStockIn = sxfdistock(R%) - sxfdistock(R%) / slks(Manu)\rDepreciatedStockOut = sxfdistout(R%) - sxfdistout(R%) / slks(Manu)\r'mti June 2010 - run to run historical - end\rXFDIFIN(R%) = AMAX(sxfdistock(R%) * 0.01, XFDISTOCK(R%) - DepreciatedStockIn)\r\r'If RegName$(R%) = \"China\" Then Stop\r'If IY = 18 And GRPS(1, R) = \"Israel\" Then Stop\rXFDIFOUT(R%) = AMAX(sxfdistout(R%) * 0.01, XFDISTOUT(R%) - DepreciatedStockOut)\rNext R%\r"
  },
  {
    "Variable": "XFDISTOCK",
    "UsesVariable": "elfdilifexp",
    "Distance": 49,
    "Code": "0"
  },
  {
    "Variable": "XFDISTOCK",
    "UsesVariable": "WGDP",
    "Distance": 51,
    "Code": "0"
  },
  {
    "Variable": "XFDISTOCK",
    "UsesVariable": "xfdiwgradd",
    "Distance": 51,
    "Code": "0"
  },
  {
    "Variable": "XFDISTOCK",
    "UsesVariable": "xfdiwgrm",
    "Distance": 51,
    "Code": "0"
  },
  {
    "Variable": "XFDISTOCK",
    "UsesVariable": "GDP",
    "Distance": 2213,
    "Code": "0"
  },
  {
    "Variable": "XFDISTOCK",
    "UsesVariable": "WPOP",
    "Distance": 57,
    "Code": "0"
  },
  {
    "Variable": "XFDISTOCK",
    "UsesVariable": "LIFEXP",
    "Distance": 58,
    "Code": "0"
  },
  {
    "Variable": "XFDISTOCK",
    "UsesVariable": "POP",
    "Distance": 58,
    "Code": "0"
  },
  {
    "Variable": "XFDISTOCK",
    "UsesVariable": "XFDIFIN",
    "Distance": 0,
    "Code": "\rFor R% = 1 To NR%\r'bbh 2016/02/17 2 lines lks to slks\rXFDISTOCK(R%) = sxfdistock(R%) + XFDIFIN(R%) - sxfdistock(R%) / slks(Manu)\rXFDISTOUT(R%) = sxfdistout(R%) + XFDIFOUT(R%) - sxfdistout(R%) / slks(Manu)\r'If IY% >= 4 And RegName$(R%) = \"Unitd Kingdm\" Then Stop\rWSumXFDIFINPReAdj = WSumXFDIFINPReAdj + XFDIFIN(R%)\r'If RegName$(R%) = \"China\" And IY% >= 34 Then Stop\rWStockIn = WStockIn + XFDISTOCK(R%)\rWStockOut = WStockOut + XFDISTOUT(R%)\rNext R%\r"
  },
  {
    "Variable": "XFDISTOCK",
    "UsesVariable": "lks",
    "Distance": 0,
    "Code": "\rFor R% = 1 To NR%\r'bbh 2016/02/17 2 lines lks to slks\rXFDISTOCK(R%) = sxfdistock(R%) + XFDIFIN(R%) - sxfdistock(R%) / slks(Manu)\rXFDISTOUT(R%) = sxfdistout(R%) + XFDIFOUT(R%) - sxfdistout(R%) / slks(Manu)\r'If IY% >= 4 And RegName$(R%) = \"Unitd Kingdm\" Then Stop\rWSumXFDIFINPReAdj = WSumXFDIFINPReAdj + XFDIFIN(R%)\r'If RegName$(R%) = \"China\" And IY% >= 34 Then Stop\rWStockIn = WStockIn + XFDISTOCK(R%)\rWStockOut = WStockOut + XFDISTOUT(R%)\rNext R%\r"
  },
  {
    "Variable": "XFDISTOCK",
    "UsesVariable": "GDPPOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XFDISTOCK",
    "UsesVariable": "xfdistockm",
    "Distance": 1,
    "Code": "\r'If RegName$(R%) = \"United States of America\" And IY% >= 20 Then Stop\r\rfdir = ConvergeOverTime(sxfdistockr(R%), xfdistockr(R%), 10)\r\r\rfdiratio = ConvergeOverTime(SXFDIGDPIn(R%), fdiratio, 100)\r"
  },
  {
    "Variable": "XFDISTOCK",
    "UsesVariable": "xfdistockr",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "XFDISTOCK",
    "UsesVariable": "GDPPCP",
    "Distance": 5,
    "Code": "COMPLETE STRUCTURE:Next R%:6837|\r\r'   All but First:  FDI country/region stocks in and out\r'   ----------------------------------------------------\r'jrs 2014/09/16\rDim fdiratio As Single, XFDICalcConv As Single, fdir As Single, XFDICalcGroRate As Single\r\r'  If IY% = 4 Then Open PutFdrv$ + \"Runfiles\\\" + \"Debug.dat\" For Output As #6\rFor R% = 1 To NR%\r'jrs 2024/06/12 TbName$ = \"GDP/Capita (PPP) Versus FDI Stock Inflows Over GDP (2000)\"\rCall XYTABL(TbNameFDIStockInf, GDPPCP(R%), fdiratio, context)\r"
  },
  {
    "Variable": "xfdistockr",
    "UsesVariable": "XFDISTOCK",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "xfdistockr",
    "UsesVariable": "XFDIFIN",
    "Distance": 1,
    "Code": "\rIf XFDISTOCK(R%) > 0.001 Then\rFDIGrowth = XFDIFIN(R%) - XFDISTOCK(R%) / lks(Manu)\r'SXFDISTOCKR(R%) = (XFDIFIN(R%) / XFDISTOCK(R%)) * 100\rsxfdistockr(R%) = (FDIGrowth / XFDISTOCK(R%)) * 100\rEnd If\r"
  },
  {
    "Variable": "xfdistockr",
    "UsesVariable": "lks",
    "Distance": 1,
    "Code": "\rIf XFDISTOCK(R%) > 0.001 Then\rFDIGrowth = XFDIFIN(R%) - XFDISTOCK(R%) / lks(Manu)\r'SXFDISTOCKR(R%) = (XFDIFIN(R%) / XFDISTOCK(R%)) * 100\rsxfdistockr(R%) = (FDIGrowth / XFDISTOCK(R%)) * 100\rEnd If\r"
  },
  {
    "Variable": "XFDISTOUT",
    "UsesVariable": "elfdilifexp",
    "Distance": 50,
    "Code": "0"
  },
  {
    "Variable": "XFDISTOUT",
    "UsesVariable": "WGDP",
    "Distance": 52,
    "Code": "0"
  },
  {
    "Variable": "XFDISTOUT",
    "UsesVariable": "xfdiwgradd",
    "Distance": 52,
    "Code": "0"
  },
  {
    "Variable": "XFDISTOUT",
    "UsesVariable": "xfdiwgrm",
    "Distance": 52,
    "Code": "0"
  },
  {
    "Variable": "XFDISTOUT",
    "UsesVariable": "XFDISTOCK",
    "Distance": 2216,
    "Code": "0"
  },
  {
    "Variable": "XFDISTOUT",
    "UsesVariable": "GDP",
    "Distance": 2214,
    "Code": "0"
  },
  {
    "Variable": "XFDISTOUT",
    "UsesVariable": "WPOP",
    "Distance": 58,
    "Code": "0"
  },
  {
    "Variable": "XFDISTOUT",
    "UsesVariable": "LIFEXP",
    "Distance": 59,
    "Code": "0"
  },
  {
    "Variable": "XFDISTOUT",
    "UsesVariable": "POP",
    "Distance": 59,
    "Code": "0"
  },
  {
    "Variable": "XFDISTOUT",
    "UsesVariable": "XFDIFOUT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XFDISTOUT",
    "UsesVariable": "lks",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XFDISTOUT",
    "UsesVariable": "GDPPOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XFDISTOUT",
    "UsesVariable": "xfdistoutm",
    "Distance": 0,
    "Code": "\rfdir = ConvergeOverTime(SXFDISTOUTR(R%), xfdistockr(R%), 10)\r\r'Base, Target, Years\rXFDISTOUT(R%) = XFDISTOUT(R%) * (1 + fdir / 100) * xfdistoutm(R%)\r"
  },
  {
    "Variable": "XFDISTOUT",
    "UsesVariable": "xfdistockr",
    "Distance": 1,
    "Code": "\rIf XFDISTOUT(R%) > 0.001 Then\rFDIGrowth = XFDIFOUT(R%) - XFDISTOUT(R%) / lks(Manu)\rSXFDISTOUTR(R%) = FDIGrowth / XFDISTOUT(R%) * 100\rEnd If\r"
  },
  {
    "Variable": "XFDISTOUT",
    "UsesVariable": "GDPPCP",
    "Distance": 2,
    "Code": "\r'If RegName$(R%) = \"China\" Then Stop\r\r'jrs 2024/06/12 TbName$ = \"GDP/Capita (PPP) Versus FDI Stock Outflows Over GDP (2000)\"\rCall XYTABL(TbNameFDIStockOut, GDPPCP(R%), fdiratio, context)\r"
  },
  {
    "Variable": "XGOVTDEBT",
    "UsesVariable": "XGOVTDEBTB",
    "Distance": 0,
    "Code": "\rCall ScaleMeOrig(GLOBALIZ, GLOBALIZI)\r'Call ScaleMe(GLOBALIZ)\r'jrs 2016/05/11 *** this section was moved from IFUN = 2  End ****\r\r'ttt 2019/10/08 TakeOut\rArray.Copy(X, SX, NR + 1)\rArray.Copy(M, SM, NR + 1)\rFor R% = 1 To NR%\r'ttt 2019/10/08 TakenOut\r'SX(R%) = X(R%)\r'SM(R%) = M(R%)\r\r''       Government External Debt Changes Needed/Available for Balancing\r''           Could be Short-term, Mid- to Long-Term; IFI sources, etc.\r''       ---------------------------------------------------------------\rIf AID(R%) > 0 Then\rLoanPortion = AID(R%) * aidlp(R%)\rElse 'Donors\rLoanPortion = AID(R%) * WorldAidLP\rEnd If\rsxgovtdebtb(R%) = XGOVTDEBTB(R%) + XGOVTDEBTBF(R%) + LoanPortion\r'bbh 2022/06/23 XIMFCREDIT and XWBLOANS are stocks\rsxgovtdebt(R%) = sxgovtdebtb(R%) + XIMFCREDIT(R%) + XWBLOANS(R%) 'Basic Govt Debt + IFIs\r'Need to build dynamics for IFIs;\r'Ukraine especially problematic with growing IFI debt\r\r'        'bbh 2014/04/02 This code now called 2 times in ModelRun; line below can only be computed once\r'        '   or it makes ssxdebtrpa = XDEBTRPA\r'        If IFUN = 2 Then\r'            ssxdebtrpa(R%) = XDEBTRPA(R%)\r'        End If\r'XFIRMDEBT(R%) = 0 'bbh 2021/09/21 Test of this did not work\rsxdebtrpa(R%) = sxgovtdebt(R%) + XFIRMDEBT(R%) 'Total External Debt\r\r'Only dynamics on XFIRMDEBT is simple 3% growth every year but first, and\r'     allocation of all CURACT, CapActLim to govt is wrong, so can't trust\r'     evolution of XGOVTDEBTB and XFIRMDEBT\r'Need to link XGOVTDEBT back to GOVTDEBTD when can trust XGOVTDEBTB\r\r'Jan 19, 2006 Next step thoughts\r'Put only obvious changes in XGOVTDEBT into it - net IFI flows; loan portion of aid\r'Put other items into broader XFIRMDEBT and therefore also XDEBTRPA\r'Then move to tying XGOVTDEBT back to GOVDEBT,\r'   with GOVTDEBTD always being non-negative\r'Will probably need to somehow break interest and\r'debt repayment out of govt expenditures = look at SeriesGovtPPGDebtService%Rev\r'Rapid drop in US CURACT deficit after 2000 is very problematic; need to specify\r'   role of leader as market of last resort?\r\rNext R%\r"
  },
  {
    "Variable": "XGOVTDEBT",
    "UsesVariable": "XIMFCREDIT",
    "Distance": 0,
    "Code": "\rCall ScaleMeOrig(GLOBALIZ, GLOBALIZI)\r'Call ScaleMe(GLOBALIZ)\r'jrs 2016/05/11 *** this section was moved from IFUN = 2  End ****\r\r'ttt 2019/10/08 TakeOut\rArray.Copy(X, SX, NR + 1)\rArray.Copy(M, SM, NR + 1)\rFor R% = 1 To NR%\r'ttt 2019/10/08 TakenOut\r'SX(R%) = X(R%)\r'SM(R%) = M(R%)\r\r''       Government External Debt Changes Needed/Available for Balancing\r''           Could be Short-term, Mid- to Long-Term; IFI sources, etc.\r''       ---------------------------------------------------------------\rIf AID(R%) > 0 Then\rLoanPortion = AID(R%) * aidlp(R%)\rElse 'Donors\rLoanPortion = AID(R%) * WorldAidLP\rEnd If\rsxgovtdebtb(R%) = XGOVTDEBTB(R%) + XGOVTDEBTBF(R%) + LoanPortion\r'bbh 2022/06/23 XIMFCREDIT and XWBLOANS are stocks\rsxgovtdebt(R%) = sxgovtdebtb(R%) + XIMFCREDIT(R%) + XWBLOANS(R%) 'Basic Govt Debt + IFIs\r'Need to build dynamics for IFIs;\r'Ukraine especially problematic with growing IFI debt\r\r'        'bbh 2014/04/02 This code now called 2 times in ModelRun; line below can only be computed once\r'        '   or it makes ssxdebtrpa = XDEBTRPA\r'        If IFUN = 2 Then\r'            ssxdebtrpa(R%) = XDEBTRPA(R%)\r'        End If\r'XFIRMDEBT(R%) = 0 'bbh 2021/09/21 Test of this did not work\rsxdebtrpa(R%) = sxgovtdebt(R%) + XFIRMDEBT(R%) 'Total External Debt\r\r'Only dynamics on XFIRMDEBT is simple 3% growth every year but first, and\r'     allocation of all CURACT, CapActLim to govt is wrong, so can't trust\r'     evolution of XGOVTDEBTB and XFIRMDEBT\r'Need to link XGOVTDEBT back to GOVTDEBTD when can trust XGOVTDEBTB\r\r'Jan 19, 2006 Next step thoughts\r'Put only obvious changes in XGOVTDEBT into it - net IFI flows; loan portion of aid\r'Put other items into broader XFIRMDEBT and therefore also XDEBTRPA\r'Then move to tying XGOVTDEBT back to GOVDEBT,\r'   with GOVTDEBTD always being non-negative\r'Will probably need to somehow break interest and\r'debt repayment out of govt expenditures = look at SeriesGovtPPGDebtService%Rev\r'Rapid drop in US CURACT deficit after 2000 is very problematic; need to specify\r'   role of leader as market of last resort?\r\rNext R%\r"
  },
  {
    "Variable": "XGOVTDEBT",
    "UsesVariable": "XWBLOANS",
    "Distance": 0,
    "Code": "\rCall ScaleMeOrig(GLOBALIZ, GLOBALIZI)\r'Call ScaleMe(GLOBALIZ)\r'jrs 2016/05/11 *** this section was moved from IFUN = 2  End ****\r\r'ttt 2019/10/08 TakeOut\rArray.Copy(X, SX, NR + 1)\rArray.Copy(M, SM, NR + 1)\rFor R% = 1 To NR%\r'ttt 2019/10/08 TakenOut\r'SX(R%) = X(R%)\r'SM(R%) = M(R%)\r\r''       Government External Debt Changes Needed/Available for Balancing\r''           Could be Short-term, Mid- to Long-Term; IFI sources, etc.\r''       ---------------------------------------------------------------\rIf AID(R%) > 0 Then\rLoanPortion = AID(R%) * aidlp(R%)\rElse 'Donors\rLoanPortion = AID(R%) * WorldAidLP\rEnd If\rsxgovtdebtb(R%) = XGOVTDEBTB(R%) + XGOVTDEBTBF(R%) + LoanPortion\r'bbh 2022/06/23 XIMFCREDIT and XWBLOANS are stocks\rsxgovtdebt(R%) = sxgovtdebtb(R%) + XIMFCREDIT(R%) + XWBLOANS(R%) 'Basic Govt Debt + IFIs\r'Need to build dynamics for IFIs;\r'Ukraine especially problematic with growing IFI debt\r\r'        'bbh 2014/04/02 This code now called 2 times in ModelRun; line below can only be computed once\r'        '   or it makes ssxdebtrpa = XDEBTRPA\r'        If IFUN = 2 Then\r'            ssxdebtrpa(R%) = XDEBTRPA(R%)\r'        End If\r'XFIRMDEBT(R%) = 0 'bbh 2021/09/21 Test of this did not work\rsxdebtrpa(R%) = sxgovtdebt(R%) + XFIRMDEBT(R%) 'Total External Debt\r\r'Only dynamics on XFIRMDEBT is simple 3% growth every year but first, and\r'     allocation of all CURACT, CapActLim to govt is wrong, so can't trust\r'     evolution of XGOVTDEBTB and XFIRMDEBT\r'Need to link XGOVTDEBT back to GOVTDEBTD when can trust XGOVTDEBTB\r\r'Jan 19, 2006 Next step thoughts\r'Put only obvious changes in XGOVTDEBT into it - net IFI flows; loan portion of aid\r'Put other items into broader XFIRMDEBT and therefore also XDEBTRPA\r'Then move to tying XGOVTDEBT back to GOVDEBT,\r'   with GOVTDEBTD always being non-negative\r'Will probably need to somehow break interest and\r'debt repayment out of govt expenditures = look at SeriesGovtPPGDebtService%Rev\r'Rapid drop in US CURACT deficit after 2000 is very problematic; need to specify\r'   role of leader as market of last resort?\r\rNext R%\r"
  },
  {
    "Variable": "XGOVTDEBTB",
    "UsesVariable": "XGOVTDEBTBF",
    "Distance": 0,
    "Code": "\rCall ScaleMeOrig(GLOBALIZ, GLOBALIZI)\r'Call ScaleMe(GLOBALIZ)\r'jrs 2016/05/11 *** this section was moved from IFUN = 2  End ****\r\r'ttt 2019/10/08 TakeOut\rArray.Copy(X, SX, NR + 1)\rArray.Copy(M, SM, NR + 1)\rFor R% = 1 To NR%\r'ttt 2019/10/08 TakenOut\r'SX(R%) = X(R%)\r'SM(R%) = M(R%)\r\r''       Government External Debt Changes Needed/Available for Balancing\r''           Could be Short-term, Mid- to Long-Term; IFI sources, etc.\r''       ---------------------------------------------------------------\rIf AID(R%) > 0 Then\rLoanPortion = AID(R%) * aidlp(R%)\rElse 'Donors\rLoanPortion = AID(R%) * WorldAidLP\rEnd If\rsxgovtdebtb(R%) = XGOVTDEBTB(R%) + XGOVTDEBTBF(R%) + LoanPortion\r'bbh 2022/06/23 XIMFCREDIT and XWBLOANS are stocks\rsxgovtdebt(R%) = sxgovtdebtb(R%) + XIMFCREDIT(R%) + XWBLOANS(R%) 'Basic Govt Debt + IFIs\r'Need to build dynamics for IFIs;\r'Ukraine especially problematic with growing IFI debt\r\r'        'bbh 2014/04/02 This code now called 2 times in ModelRun; line below can only be computed once\r'        '   or it makes ssxdebtrpa = XDEBTRPA\r'        If IFUN = 2 Then\r'            ssxdebtrpa(R%) = XDEBTRPA(R%)\r'        End If\r'XFIRMDEBT(R%) = 0 'bbh 2021/09/21 Test of this did not work\rsxdebtrpa(R%) = sxgovtdebt(R%) + XFIRMDEBT(R%) 'Total External Debt\r\r'Only dynamics on XFIRMDEBT is simple 3% growth every year but first, and\r'     allocation of all CURACT, CapActLim to govt is wrong, so can't trust\r'     evolution of XGOVTDEBTB and XFIRMDEBT\r'Need to link XGOVTDEBT back to GOVTDEBTD when can trust XGOVTDEBTB\r\r'Jan 19, 2006 Next step thoughts\r'Put only obvious changes in XGOVTDEBT into it - net IFI flows; loan portion of aid\r'Put other items into broader XFIRMDEBT and therefore also XDEBTRPA\r'Then move to tying XGOVTDEBT back to GOVDEBT,\r'   with GOVTDEBTD always being non-negative\r'Will probably need to somehow break interest and\r'debt repayment out of govt expenditures = look at SeriesGovtPPGDebtService%Rev\r'Rapid drop in US CURACT deficit after 2000 is very problematic; need to specify\r'   role of leader as market of last resort?\r\rNext R%\r"
  },
  {
    "Variable": "XGOVTDEBTB",
    "UsesVariable": "AID",
    "Distance": 1,
    "Code": "0"
  },
  {
    "Variable": "XGOVTDEBTB",
    "UsesVariable": "aidlp",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "XGOVTDEBTBF",
    "UsesVariable": "CURACT",
    "Distance": 0,
    "Code": "\r\r'       Government External Debt Changes Needed/Available for Balancing\r'           Could be Short-term, Mid- to Long-Term; IFI sources, etc.\r'       ---------------------------------------------------------------\r\r'XGOVTDEBTBF(R%) = -CURACT(R%) - capactlim + delxreserves 'Basic Govt Debt\rXGOVTDEBTBF(R%) = -CURACT(R%) - CapActLim '+ delxreserves\r'bbh 2022/06/23 End changes to govt debt flows;\r'Reserves as liability in one country are asset elsewhere, so until spread\r'   across origin-target countries should not add to debt\r'Net IMF and WB contributions to capactlim are not now being balanced by\r'   subscriptions as asset\r'Ultimately, world sum of XGOVTEDBTF should be 0\r\r'        GrantPortion = AID(R%) * (1 - aidlp)\r\r'bbh 2014/04/02 This code now called 2 times in ModelRun; line below can only be computed once\r'   or it makes ssxdebtrpa = XDEBTRPA\r'jrs 2014/04/11 If IFUN = 2 Then\r'ssxdebtrpa(R%) = XDEBTRPA(R%) 'bbh 2022/06/23\r'jrs 2014/04/11 End If\r\r"
  },
  {
    "Variable": "XGOVTDEBTBF",
    "UsesVariable": "XIMFCRFIN",
    "Distance": 1,
    "Code": "\r\r'bbh 2022/06/23 Start changes to govt debt flows; govt not reponsible for FDI and portfolio debt\r'   Those belong in net international investment position and firm postions; but responsible for IFI debt\r'       Capital Account\r'       -----------------------------------------------------\r\rCapActLim = XIMFCRFIN(R%) - XIMFCRFOUT(R%) _\r                + XWBLNFIN(R%) - XWBLNFOUT(R%)\r"
  },
  {
    "Variable": "XGOVTDEBTBF",
    "UsesVariable": "XIMFCRFOUT",
    "Distance": 1,
    "Code": "\r\r'bbh 2022/06/23 Start changes to govt debt flows; govt not reponsible for FDI and portfolio debt\r'   Those belong in net international investment position and firm postions; but responsible for IFI debt\r'       Capital Account\r'       -----------------------------------------------------\r\rCapActLim = XIMFCRFIN(R%) - XIMFCRFOUT(R%) _\r                + XWBLNFIN(R%) - XWBLNFOUT(R%)\r"
  },
  {
    "Variable": "XGOVTDEBTBF",
    "UsesVariable": "XWBLNFIN",
    "Distance": 1,
    "Code": "\r\r'bbh 2022/06/23 Start changes to govt debt flows; govt not reponsible for FDI and portfolio debt\r'   Those belong in net international investment position and firm postions; but responsible for IFI debt\r'       Capital Account\r'       -----------------------------------------------------\r\rCapActLim = XIMFCRFIN(R%) - XIMFCRFOUT(R%) _\r                + XWBLNFIN(R%) - XWBLNFOUT(R%)\r"
  },
  {
    "Variable": "XGOVTDEBTBF",
    "UsesVariable": "XWBLNFOUT",
    "Distance": 1,
    "Code": "\r\r'bbh 2022/06/23 Start changes to govt debt flows; govt not reponsible for FDI and portfolio debt\r'   Those belong in net international investment position and firm postions; but responsible for IFI debt\r'       Capital Account\r'       -----------------------------------------------------\r\rCapActLim = XIMFCRFIN(R%) - XIMFCRFOUT(R%) _\r                + XWBLNFIN(R%) - XWBLNFOUT(R%)\r"
  },
  {
    "Variable": "XIMFCREDIT",
    "UsesVariable": "XIMFCRFIN",
    "Distance": 0,
    "Code": "\rFor R% = 1 To NR%\rXIMFCRFIN(R%) = XIMFCRFIN(R%) * XIMFCRNewTot / AMAX(0.001, XIMFCRCompTot)\rSXIMFCRFIN(R%) = XIMFCRFIN(R%)\rXIMFCREDIT(R%) = SXIMFCREDIT(R%) + XIMFCRFIN(R%) - XIMFCRFOUT(R%) - XIMFSUBF(R%)\rSXIMFCREDIT(R%) = XIMFCREDIT(R%)\rNext R%\r"
  },
  {
    "Variable": "XIMFCREDIT",
    "UsesVariable": "XIMFCRFOUT",
    "Distance": 0,
    "Code": "\rFor R% = 1 To NR%\rXIMFCRFIN(R%) = XIMFCRFIN(R%) * XIMFCRNewTot / AMAX(0.001, XIMFCRCompTot)\rSXIMFCRFIN(R%) = XIMFCRFIN(R%)\rXIMFCREDIT(R%) = SXIMFCREDIT(R%) + XIMFCRFIN(R%) - XIMFCRFOUT(R%) - XIMFSUBF(R%)\rSXIMFCREDIT(R%) = XIMFCREDIT(R%)\rNext R%\r"
  },
  {
    "Variable": "XIMFCREDIT",
    "UsesVariable": "XIMFSUBF",
    "Distance": 0,
    "Code": "\rFor R% = 1 To NR%\rXIMFCRFIN(R%) = XIMFCRFIN(R%) * XIMFCRNewTot / AMAX(0.001, XIMFCRCompTot)\rSXIMFCRFIN(R%) = XIMFCRFIN(R%)\rXIMFCREDIT(R%) = SXIMFCREDIT(R%) + XIMFCRFIN(R%) - XIMFCRFOUT(R%) - XIMFSUBF(R%)\rSXIMFCREDIT(R%) = XIMFCREDIT(R%)\rNext R%\r"
  },
  {
    "Variable": "XIMFCREDITTOT",
    "UsesVariable": "XIMFCREDIT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XIMFCREDITTOT",
    "UsesVariable": "ximfcreqr",
    "Distance": 0,
    "Code": "\r\rFor R% = 1 To NR%\r\r'   All but First:  IMF Credits\r'   ---------------------------\r\r'If SXIMFCREDIT(R%) > 0 Then 'borrowers, credit users 'bbh 2020/08/15\rIf XIMFCREDITI(R%) > -0.0001 Then  'borrowers, credit users  'bbh 2020/08/15 use of SXWBLOANS caused oscillation\r'           XIMFCRFOUT(R%) = SXIMFCREDIT(R%) * simfcrintr / 100 _\r' + SXIMFCREDIT(R%) / AMAX(1, ximfcrrepr)\rXIMFCRFOUT(R%) = SXIMFCREDIT(R%) * ximfcrintr / 100 _\r                    + SXIMFCREDIT(R%) / AMAX(1, ximfcrrepr) 'bbh 2020/08/15 Corrected simfcrintr to ximfcrintr\r\r'                                CXIMFCRFOUT(ICount%) = (CXIMFCREDIT(ICount%) * sximfcrintr / 100 _\r'                    + CXIMFCREDIT(ICount%) / AMAX(1, sximfcrrepr))\r\r'repayments, principal plus interest, as in preprocessor\rXIMFCRRepayTot = XIMFCRRepayTot + XIMFCRFOUT(R%)\rElse 'subscriber, contributor\r'XIMFCRFOUT(R%) = SXIMFCREDITTOT * ximfcreditr / 100 _\r'* XIMFCREDITSUBI(R%) / XIMFCREDITTOTI\rMaxSub = 0.001! * GDPPOT(R%)\rXIMFSUBF(R%) = Amin(MaxSub, SXIMFSUBF(R%) * (1 + ximfcreditr / 100))\rSXIMFSUBF(R%) = XIMFSUBF(R%)\rXIMFNewSubTot = XIMFNewSubTot + XIMFSUBF(R%)\rEnd If\r'TotalIMFRepayPlusSub = TotalIMFRepayPlusSub + XIMFCRFOUT(R%)\r\rNext R%\r\r\r'    TotalIMFAvailAssets = TotalIMFRepayPlusSub\r'    TotalIMFCredits = 0\r'    For R% = 1 To NR%\r'        XIMFCRFIN(R%) = TotalIMFAvailAssets * (XIMFCRFINI(R%) / AMAX(0.001, XIMFFLOWSINTOTI)) _\r'            * ximfcrfinm(R%)\r'        TotalIMFCredits = TotalIMFCredits + XIMFCRFIN(R%)\r'        XIMFCREDIT(R%) = SXIMFCREDIT(R%) + XIMFCRFIN(R%) - XIMFCRFOUT(R%)\r'        SXIMFCREDIT(R%) = XIMFCREDIT(R%)\r'    Next R%\r'    For R% = 1 To NR%\r'        XIMFCRFIN(R%) = XIMFCRFIN(R%) * TotalIMFAvailAssets / AMAX(0.001, TotalIMFCredits)\r'    Next R%\r\rFor R% = 1 To NR%\rXIMFCRFIN(R%) = XIMFFLOWSINTOTI * XIMFCREDITTOT / XIMFCREDITTOTI _\r            * (XIMFCRFINI(R%) / AMAX(0.001, XIMFFLOWSINTOTI))\rXIMFCRNewTot = XIMFCRNewTot + XIMFCRFIN(R%)\rNext R%\r\r\rFor R% = 1 To NR%\r\r'   All but First:  IMF Credits\r'   ---------------------------\r\r'If SXIMFCREDIT(R%) > 0 Then 'borrowers, credit users 'bbh 2020/08/15\rIf XIMFCREDITI(R%) > -0.0001 Then  'borrowers, credit users  'bbh 2020/08/15 use of SXWBLOANS caused oscillation\r'           XIMFCRFOUT(R%) = SXIMFCREDIT(R%) * simfcrintr / 100 _\r' + SXIMFCREDIT(R%) / AMAX(1, ximfcrrepr)\rXIMFCRFOUT(R%) = SXIMFCREDIT(R%) * ximfcrintr / 100 _\r                    + SXIMFCREDIT(R%) / AMAX(1, ximfcrrepr) 'bbh 2020/08/15 Corrected simfcrintr to ximfcrintr\r\r'                                CXIMFCRFOUT(ICount%) = (CXIMFCREDIT(ICount%) * sximfcrintr / 100 _\r'                    + CXIMFCREDIT(ICount%) / AMAX(1, sximfcrrepr))\r\r'repayments, principal plus interest, as in preprocessor\rXIMFCRRepayTot = XIMFCRRepayTot + XIMFCRFOUT(R%)\rElse 'subscriber, contributor\r'XIMFCRFOUT(R%) = SXIMFCREDITTOT * ximfcreditr / 100 _\r'* XIMFCREDITSUBI(R%) / XIMFCREDITTOTI\rMaxSub = 0.001! * GDPPOT(R%)\rXIMFSUBF(R%) = Amin(MaxSub, SXIMFSUBF(R%) * (1 + ximfcreditr / 100))\rSXIMFSUBF(R%) = XIMFSUBF(R%)\rXIMFNewSubTot = XIMFNewSubTot + XIMFSUBF(R%)\rEnd If\r'TotalIMFRepayPlusSub = TotalIMFRepayPlusSub + XIMFCRFOUT(R%)\r\rNext R%\r\rSXIMFCREDITTOT = XIMFCREDITTOT + XIMFCRRepayTot - XIMFCRNewTot + XIMFNewSubTot * ximfcreqr\r"
  },
  {
    "Variable": "XIMFCREDITTOT",
    "UsesVariable": "XIMFCRFOUT",
    "Distance": 7,
    "Code": "\rXIMFCRRepayTot = 0\r"
  },
  {
    "Variable": "XIMFCREDITTOT",
    "UsesVariable": "XIMFCRFIN",
    "Distance": 1,
    "Code": "\rXIMFCRNewTot = 0\r\r\rFor R% = 1 To NR%\r'        If XIMFCREDIT(R%) < 0 Then  ' subscribers; determine 1st year and total subscriptions\r'            XIMFCREDITSUBI(R%) = -XIMFCREDIT(R%)\r'                'assumes subscriptions set equal to credits in preprocessor\r'            XIMFCRFOUT(R%) = (SUMIMFFLOWSIN - SUMIMFFLOWSOUT) _\r'                * XIMFCREDITSUBI(R%) / XIMFCREDITTOT\r'        Else\r'            XIMFCREDITSUBI(R%) = 0\r'        End If\rIf XIMFCREDIT(R%) < 0 Then 'lenders\rXWBLOANSUBI(R%) = -XIMFCREDIT(R%)\rSXIMFSUBF(R%) = XIMFSUBF(R%)\rEnd If\rXIMFCRFINI(R%) = XIMFCRFIN(R%)\rSXIMFCRFIN(R%) = XIMFCRFIN(R%)\rXIMFCRFOUTI(R%) = XIMFCRFOUT(R%)\rXIMFCREDITI(R%) = XIMFCREDIT(R%) 'bbh 2020/08/15\r\r'   First Year:  IMF Lending Predictions\r'   ----------------------------------------------------------\r\rPrediction = XIMFCRFINI(R%) / GDPPOT(R%) * 100\rIMFCREDITPI(R%) = AMAX(0#, Amin(100, Prediction))\rNext R%\r"
  },
  {
    "Variable": "XIMFCREDITTOT",
    "UsesVariable": "XIMFSUBF",
    "Distance": 3,
    "Code": "\rXIMFNewSubTot = 0\r"
  },
  {
    "Variable": "XIMFCREDITTOT",
    "UsesVariable": "ximfcreditr",
    "Distance": 0,
    "Code": "\rSXIMFCREDITTOT = AMAX(0.0001, XIMFCREDITTOT) * (1 + ximfcreditr / 100) 'increased by new subscriptions\r"
  },
  {
    "Variable": "XIMFCRFIN",
    "UsesVariable": "GDPPOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XIMFCRFIN",
    "UsesVariable": "ximfcrfinm",
    "Distance": 0,
    "Code": "\r\rFor R% = 1 To NR%\r'        If XIMFCREDIT(R%) < 0 Then  ' subscribers; determine 1st year and total subscriptions\r'            XIMFCREDITSUBI(R%) = -XIMFCREDIT(R%)\r'                'assumes subscriptions set equal to credits in preprocessor\r'            XIMFCRFOUT(R%) = (SUMIMFFLOWSIN - SUMIMFFLOWSOUT) _\r'                * XIMFCREDITSUBI(R%) / XIMFCREDITTOT\r'        Else\r'            XIMFCREDITSUBI(R%) = 0\r'        End If\rIf XIMFCREDIT(R%) < 0 Then 'lenders\rXWBLOANSUBI(R%) = -XIMFCREDIT(R%)\rSXIMFSUBF(R%) = XIMFSUBF(R%)\rEnd If\rXIMFCRFINI(R%) = XIMFCRFIN(R%)\rSXIMFCRFIN(R%) = XIMFCRFIN(R%)\rXIMFCRFOUTI(R%) = XIMFCRFOUT(R%)\rXIMFCREDITI(R%) = XIMFCREDIT(R%) 'bbh 2020/08/15\r\r'   First Year:  IMF Lending Predictions\r'   ----------------------------------------------------------\r\rPrediction = XIMFCRFINI(R%) / GDPPOT(R%) * 100\rIMFCREDITPI(R%) = AMAX(0#, Amin(100, Prediction))\rNext R%\r"
  },
  {
    "Variable": "XIMFCRFIN",
    "UsesVariable": "GINIDOM",
    "Distance": 2531,
    "Code": "0"
  },
  {
    "Variable": "XIMFCRFIN",
    "UsesVariable": "INCOMELT190LN",
    "Distance": 2536,
    "Code": "\r\r'jrs 2015/11/18 *** begin ***\r'        'jrs 2014/05/20 *** begin ***\r'        meanconsumption11 = AMAX(0.0001, C(R%) * RatioGDP2011to2005GDP(R%) / AMAX(0.0001, POP(R%)) * PPPCONV(R%))\r'        LNMean11 = Log(meanconsumption11 * NSNARAT(R%) * 1000) _\r'            - 0.5 * (lnstddev ^ 2)\r'\r'        'bbh 2014/10/18 start\r'        'Prediction = CalcLogNormalCDF(365 * incpovlev, LNMean11, lnstddev)  'no multiplier\r'        Prediction = CalcLogNormalCDF(365 * incpovlev * RatioGDP2011to2005GDPUSA1, LNMean11, lnstddev)\r'        INCOMELT190LN(R%) = AMAX(0, Amin(0.9 * POP(R%), Prediction * POP(R%)))\r'        'Compute INCOMELT0.7LN2011\r'        'Prediction = CalcLogNormalCDF(255.5, LNMean11, lnstddev)  'no multiplier\r'        Prediction = CalcLogNormalCDF(255.5 * RatioGDP2011to2005GDPUSA07, LNMean11, lnstddev)  'no multiplier\r'        INCOMELT110LN(R%) = AMAX(0, Amin(0.9 * POP(R%), Prediction * POP(R%)))\r'        'bbh 2014/10/18 end\r'        'jrs 2014/05/20 *** end ***\r\r'       First Year:  Back-calculate Mean of Consumption for Log Normal $1.9 ($2011)\r'       --------------------------------------------------------------------------\rportionpoor = CSng(Amin(0.99, INCOMELT190LN(R%) / AMAX(0.0001, POP(R%))))\r\rportionpoor = CSng(Round(CDbl(portionpoor), 12)) 'jrs 2020/03/14 diffs with vb6\r\rNInv = CalcNormalInverse(portionpoor)\r\rNInv = CSng(Round(CDbl(NInv), 6)) 'jrs 2020/03/10 differences with vb6\r"
  },
  {
    "Variable": "XIMFCRFIN",
    "UsesVariable": "POP",
    "Distance": 2536,
    "Code": "\r\r'jrs 2015/11/18 *** begin ***\r'        'jrs 2014/05/20 *** begin ***\r'        meanconsumption11 = AMAX(0.0001, C(R%) * RatioGDP2011to2005GDP(R%) / AMAX(0.0001, POP(R%)) * PPPCONV(R%))\r'        LNMean11 = Log(meanconsumption11 * NSNARAT(R%) * 1000) _\r'            - 0.5 * (lnstddev ^ 2)\r'\r'        'bbh 2014/10/18 start\r'        'Prediction = CalcLogNormalCDF(365 * incpovlev, LNMean11, lnstddev)  'no multiplier\r'        Prediction = CalcLogNormalCDF(365 * incpovlev * RatioGDP2011to2005GDPUSA1, LNMean11, lnstddev)\r'        INCOMELT190LN(R%) = AMAX(0, Amin(0.9 * POP(R%), Prediction * POP(R%)))\r'        'Compute INCOMELT0.7LN2011\r'        'Prediction = CalcLogNormalCDF(255.5, LNMean11, lnstddev)  'no multiplier\r'        Prediction = CalcLogNormalCDF(255.5 * RatioGDP2011to2005GDPUSA07, LNMean11, lnstddev)  'no multiplier\r'        INCOMELT110LN(R%) = AMAX(0, Amin(0.9 * POP(R%), Prediction * POP(R%)))\r'        'bbh 2014/10/18 end\r'        'jrs 2014/05/20 *** end ***\r\r'       First Year:  Back-calculate Mean of Consumption for Log Normal $1.9 ($2011)\r'       --------------------------------------------------------------------------\rportionpoor = CSng(Amin(0.99, INCOMELT190LN(R%) / AMAX(0.0001, POP(R%))))\r"
  },
  {
    "Variable": "XIMFCRFIN",
    "UsesVariable": "XIMFCREDITTOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XIMFCRFOUT",
    "UsesVariable": "XIMFCREDIT",
    "Distance": 0,
    "Code": "\r\rFor R% = 1 To NR%\r\r'   All but First:  IMF Credits\r'   ---------------------------\r\r'If SXIMFCREDIT(R%) > 0 Then 'borrowers, credit users 'bbh 2020/08/15\rIf XIMFCREDITI(R%) > -0.0001 Then  'borrowers, credit users  'bbh 2020/08/15 use of SXWBLOANS caused oscillation\r'           XIMFCRFOUT(R%) = SXIMFCREDIT(R%) * simfcrintr / 100 _\r' + SXIMFCREDIT(R%) / AMAX(1, ximfcrrepr)\rXIMFCRFOUT(R%) = SXIMFCREDIT(R%) * ximfcrintr / 100 _\r                    + SXIMFCREDIT(R%) / AMAX(1, ximfcrrepr) 'bbh 2020/08/15 Corrected simfcrintr to ximfcrintr\r\r'                                CXIMFCRFOUT(ICount%) = (CXIMFCREDIT(ICount%) * sximfcrintr / 100 _\r'                    + CXIMFCREDIT(ICount%) / AMAX(1, sximfcrrepr))\r\r'repayments, principal plus interest, as in preprocessor\rXIMFCRRepayTot = XIMFCRRepayTot + XIMFCRFOUT(R%)\rElse 'subscriber, contributor\r'XIMFCRFOUT(R%) = SXIMFCREDITTOT * ximfcreditr / 100 _\r'* XIMFCREDITSUBI(R%) / XIMFCREDITTOTI\rMaxSub = 0.001! * GDPPOT(R%)\rXIMFSUBF(R%) = Amin(MaxSub, SXIMFSUBF(R%) * (1 + ximfcreditr / 100))\rSXIMFSUBF(R%) = XIMFSUBF(R%)\rXIMFNewSubTot = XIMFNewSubTot + XIMFSUBF(R%)\rEnd If\r'TotalIMFRepayPlusSub = TotalIMFRepayPlusSub + XIMFCRFOUT(R%)\r\rNext R%\r"
  },
  {
    "Variable": "XIMFCRFOUT",
    "UsesVariable": "ximfcrintr",
    "Distance": 0,
    "Code": "\r\rFor R% = 1 To NR%\r\r'   All but First:  IMF Credits\r'   ---------------------------\r\r'If SXIMFCREDIT(R%) > 0 Then 'borrowers, credit users 'bbh 2020/08/15\rIf XIMFCREDITI(R%) > -0.0001 Then  'borrowers, credit users  'bbh 2020/08/15 use of SXWBLOANS caused oscillation\r'           XIMFCRFOUT(R%) = SXIMFCREDIT(R%) * simfcrintr / 100 _\r' + SXIMFCREDIT(R%) / AMAX(1, ximfcrrepr)\rXIMFCRFOUT(R%) = SXIMFCREDIT(R%) * ximfcrintr / 100 _\r                    + SXIMFCREDIT(R%) / AMAX(1, ximfcrrepr) 'bbh 2020/08/15 Corrected simfcrintr to ximfcrintr\r\r'                                CXIMFCRFOUT(ICount%) = (CXIMFCREDIT(ICount%) * sximfcrintr / 100 _\r'                    + CXIMFCREDIT(ICount%) / AMAX(1, sximfcrrepr))\r\r'repayments, principal plus interest, as in preprocessor\rXIMFCRRepayTot = XIMFCRRepayTot + XIMFCRFOUT(R%)\rElse 'subscriber, contributor\r'XIMFCRFOUT(R%) = SXIMFCREDITTOT * ximfcreditr / 100 _\r'* XIMFCREDITSUBI(R%) / XIMFCREDITTOTI\rMaxSub = 0.001! * GDPPOT(R%)\rXIMFSUBF(R%) = Amin(MaxSub, SXIMFSUBF(R%) * (1 + ximfcreditr / 100))\rSXIMFSUBF(R%) = XIMFSUBF(R%)\rXIMFNewSubTot = XIMFNewSubTot + XIMFSUBF(R%)\rEnd If\r'TotalIMFRepayPlusSub = TotalIMFRepayPlusSub + XIMFCRFOUT(R%)\r\rNext R%\r"
  },
  {
    "Variable": "XIMFCRFOUT",
    "UsesVariable": "ximfcrrepr",
    "Distance": 0,
    "Code": "\r\rFor R% = 1 To NR%\r\r'   All but First:  IMF Credits\r'   ---------------------------\r\r'If SXIMFCREDIT(R%) > 0 Then 'borrowers, credit users 'bbh 2020/08/15\rIf XIMFCREDITI(R%) > -0.0001 Then  'borrowers, credit users  'bbh 2020/08/15 use of SXWBLOANS caused oscillation\r'           XIMFCRFOUT(R%) = SXIMFCREDIT(R%) * simfcrintr / 100 _\r' + SXIMFCREDIT(R%) / AMAX(1, ximfcrrepr)\rXIMFCRFOUT(R%) = SXIMFCREDIT(R%) * ximfcrintr / 100 _\r                    + SXIMFCREDIT(R%) / AMAX(1, ximfcrrepr) 'bbh 2020/08/15 Corrected simfcrintr to ximfcrintr\r\r'                                CXIMFCRFOUT(ICount%) = (CXIMFCREDIT(ICount%) * sximfcrintr / 100 _\r'                    + CXIMFCREDIT(ICount%) / AMAX(1, sximfcrrepr))\r\r'repayments, principal plus interest, as in preprocessor\rXIMFCRRepayTot = XIMFCRRepayTot + XIMFCRFOUT(R%)\rElse 'subscriber, contributor\r'XIMFCRFOUT(R%) = SXIMFCREDITTOT * ximfcreditr / 100 _\r'* XIMFCREDITSUBI(R%) / XIMFCREDITTOTI\rMaxSub = 0.001! * GDPPOT(R%)\rXIMFSUBF(R%) = Amin(MaxSub, SXIMFSUBF(R%) * (1 + ximfcreditr / 100))\rSXIMFSUBF(R%) = XIMFSUBF(R%)\rXIMFNewSubTot = XIMFNewSubTot + XIMFSUBF(R%)\rEnd If\r'TotalIMFRepayPlusSub = TotalIMFRepayPlusSub + XIMFCRFOUT(R%)\r\rNext R%\r"
  },
  {
    "Variable": "XIMFSUBF",
    "UsesVariable": "ximfcreditr",
    "Distance": 0,
    "Code": "\r\rFor R% = 1 To NR%\r\r'   All but First:  IMF Credits\r'   ---------------------------\r\r'If SXIMFCREDIT(R%) > 0 Then 'borrowers, credit users 'bbh 2020/08/15\rIf XIMFCREDITI(R%) > -0.0001 Then  'borrowers, credit users  'bbh 2020/08/15 use of SXWBLOANS caused oscillation\r'           XIMFCRFOUT(R%) = SXIMFCREDIT(R%) * simfcrintr / 100 _\r' + SXIMFCREDIT(R%) / AMAX(1, ximfcrrepr)\rXIMFCRFOUT(R%) = SXIMFCREDIT(R%) * ximfcrintr / 100 _\r                    + SXIMFCREDIT(R%) / AMAX(1, ximfcrrepr) 'bbh 2020/08/15 Corrected simfcrintr to ximfcrintr\r\r'                                CXIMFCRFOUT(ICount%) = (CXIMFCREDIT(ICount%) * sximfcrintr / 100 _\r'                    + CXIMFCREDIT(ICount%) / AMAX(1, sximfcrrepr))\r\r'repayments, principal plus interest, as in preprocessor\rXIMFCRRepayTot = XIMFCRRepayTot + XIMFCRFOUT(R%)\rElse 'subscriber, contributor\r'XIMFCRFOUT(R%) = SXIMFCREDITTOT * ximfcreditr / 100 _\r'* XIMFCREDITSUBI(R%) / XIMFCREDITTOTI\rMaxSub = 0.001! * GDPPOT(R%)\rXIMFSUBF(R%) = Amin(MaxSub, SXIMFSUBF(R%) * (1 + ximfcreditr / 100))\rSXIMFSUBF(R%) = XIMFSUBF(R%)\rXIMFNewSubTot = XIMFNewSubTot + XIMFSUBF(R%)\rEnd If\r'TotalIMFRepayPlusSub = TotalIMFRepayPlusSub + XIMFCRFOUT(R%)\r\rNext R%\r\r\rFor R% = 1 To NR%\r\r'   All but First:  IMF Credits\r'   ---------------------------\r\r'If SXIMFCREDIT(R%) > 0 Then 'borrowers, credit users 'bbh 2020/08/15\rIf XIMFCREDITI(R%) > -0.0001 Then  'borrowers, credit users  'bbh 2020/08/15 use of SXWBLOANS caused oscillation\r'           XIMFCRFOUT(R%) = SXIMFCREDIT(R%) * simfcrintr / 100 _\r' + SXIMFCREDIT(R%) / AMAX(1, ximfcrrepr)\rXIMFCRFOUT(R%) = SXIMFCREDIT(R%) * ximfcrintr / 100 _\r                    + SXIMFCREDIT(R%) / AMAX(1, ximfcrrepr) 'bbh 2020/08/15 Corrected simfcrintr to ximfcrintr\r\r'                                CXIMFCRFOUT(ICount%) = (CXIMFCREDIT(ICount%) * sximfcrintr / 100 _\r'                    + CXIMFCREDIT(ICount%) / AMAX(1, sximfcrrepr))\r\r'repayments, principal plus interest, as in preprocessor\rXIMFCRRepayTot = XIMFCRRepayTot + XIMFCRFOUT(R%)\rElse 'subscriber, contributor\r'XIMFCRFOUT(R%) = SXIMFCREDITTOT * ximfcreditr / 100 _\r'* XIMFCREDITSUBI(R%) / XIMFCREDITTOTI\rMaxSub = 0.001! * GDPPOT(R%)\rXIMFSUBF(R%) = Amin(MaxSub, SXIMFSUBF(R%) * (1 + ximfcreditr / 100))\rSXIMFSUBF(R%) = XIMFSUBF(R%)\rXIMFNewSubTot = XIMFNewSubTot + XIMFSUBF(R%)\rEnd If\r'TotalIMFRepayPlusSub = TotalIMFRepayPlusSub + XIMFCRFOUT(R%)\r\rNext R%\r"
  },
  {
    "Variable": "XIMFSUBF",
    "UsesVariable": "GDPPOT",
    "Distance": 1,
    "Code": "\r\rFor R% = 1 To NR%\r\r'   All but First:  IMF Credits\r'   ---------------------------\r\r'If SXIMFCREDIT(R%) > 0 Then 'borrowers, credit users 'bbh 2020/08/15\rIf XIMFCREDITI(R%) > -0.0001 Then  'borrowers, credit users  'bbh 2020/08/15 use of SXWBLOANS caused oscillation\r'           XIMFCRFOUT(R%) = SXIMFCREDIT(R%) * simfcrintr / 100 _\r' + SXIMFCREDIT(R%) / AMAX(1, ximfcrrepr)\rXIMFCRFOUT(R%) = SXIMFCREDIT(R%) * ximfcrintr / 100 _\r                    + SXIMFCREDIT(R%) / AMAX(1, ximfcrrepr) 'bbh 2020/08/15 Corrected simfcrintr to ximfcrintr\r\r'                                CXIMFCRFOUT(ICount%) = (CXIMFCREDIT(ICount%) * sximfcrintr / 100 _\r'                    + CXIMFCREDIT(ICount%) / AMAX(1, sximfcrrepr))\r\r'repayments, principal plus interest, as in preprocessor\rXIMFCRRepayTot = XIMFCRRepayTot + XIMFCRFOUT(R%)\rElse 'subscriber, contributor\r'XIMFCRFOUT(R%) = SXIMFCREDITTOT * ximfcreditr / 100 _\r'* XIMFCREDITSUBI(R%) / XIMFCREDITTOTI\rMaxSub = 0.001! * GDPPOT(R%)\rXIMFSUBF(R%) = Amin(MaxSub, SXIMFSUBF(R%) * (1 + ximfcreditr / 100))\rSXIMFSUBF(R%) = XIMFSUBF(R%)\rXIMFNewSubTot = XIMFNewSubTot + XIMFSUBF(R%)\rEnd If\r'TotalIMFRepayPlusSub = TotalIMFRepayPlusSub + XIMFCRFOUT(R%)\r\rNext R%\r"
  },
  {
    "Variable": "XIMFSUBF",
    "UsesVariable": "XIMFCREDIT",
    "Distance": 0,
    "Code": "\r\rFor R% = 1 To NR%\r'        If XIMFCREDIT(R%) < 0 Then  ' subscribers; determine 1st year and total subscriptions\r'            XIMFCREDITSUBI(R%) = -XIMFCREDIT(R%)\r'                'assumes subscriptions set equal to credits in preprocessor\r'            XIMFCRFOUT(R%) = (SUMIMFFLOWSIN - SUMIMFFLOWSOUT) _\r'                * XIMFCREDITSUBI(R%) / XIMFCREDITTOT\r'        Else\r'            XIMFCREDITSUBI(R%) = 0\r'        End If\rIf XIMFCREDIT(R%) < 0 Then 'lenders\rXWBLOANSUBI(R%) = -XIMFCREDIT(R%)\rSXIMFSUBF(R%) = XIMFSUBF(R%)\rEnd If\rXIMFCRFINI(R%) = XIMFCRFIN(R%)\rSXIMFCRFIN(R%) = XIMFCRFIN(R%)\rXIMFCRFOUTI(R%) = XIMFCRFOUT(R%)\rXIMFCREDITI(R%) = XIMFCREDIT(R%) 'bbh 2020/08/15\r\r'   First Year:  IMF Lending Predictions\r'   ----------------------------------------------------------\r\rPrediction = XIMFCRFINI(R%) / GDPPOT(R%) * 100\rIMFCREDITPI(R%) = AMAX(0#, Amin(100, Prediction))\rNext R%\r\r\rFor R% = 1 To NR%\r\r'   All but First:  IMF Credits\r'   ---------------------------\r\r'If SXIMFCREDIT(R%) > 0 Then 'borrowers, credit users 'bbh 2020/08/15\rIf XIMFCREDITI(R%) > -0.0001 Then  'borrowers, credit users  'bbh 2020/08/15 use of SXWBLOANS caused oscillation\r'           XIMFCRFOUT(R%) = SXIMFCREDIT(R%) * simfcrintr / 100 _\r' + SXIMFCREDIT(R%) / AMAX(1, ximfcrrepr)\rXIMFCRFOUT(R%) = SXIMFCREDIT(R%) * ximfcrintr / 100 _\r                    + SXIMFCREDIT(R%) / AMAX(1, ximfcrrepr) 'bbh 2020/08/15 Corrected simfcrintr to ximfcrintr\r\r'                                CXIMFCRFOUT(ICount%) = (CXIMFCREDIT(ICount%) * sximfcrintr / 100 _\r'                    + CXIMFCREDIT(ICount%) / AMAX(1, sximfcrrepr))\r\r'repayments, principal plus interest, as in preprocessor\rXIMFCRRepayTot = XIMFCRRepayTot + XIMFCRFOUT(R%)\rElse 'subscriber, contributor\r'XIMFCRFOUT(R%) = SXIMFCREDITTOT * ximfcreditr / 100 _\r'* XIMFCREDITSUBI(R%) / XIMFCREDITTOTI\rMaxSub = 0.001! * GDPPOT(R%)\rXIMFSUBF(R%) = Amin(MaxSub, SXIMFSUBF(R%) * (1 + ximfcreditr / 100))\rSXIMFSUBF(R%) = XIMFSUBF(R%)\rXIMFNewSubTot = XIMFNewSubTot + XIMFSUBF(R%)\rEnd If\r'TotalIMFRepayPlusSub = TotalIMFRepayPlusSub + XIMFCRFOUT(R%)\r\rNext R%\r"
  },
  {
    "Variable": "XNFA",
    "UsesVariable": "CURACTDATATOP",
    "Distance": 0,
    "Code": "\rIf IY% = 1 Then\rSXNFA(R%) = XNFA(R%)\rSXNIIP(R%) = XNIIP(R%)\rElse\rXNFA(R%) = SXNFA(R%) + CURACTDATATOP(R%) 'Is %; includes all Current account terms\rSXNFA(R%) = XNFA(R%)\r'ssxdebtrpa(R%) = sxdebtrpa(R%)\rssxdebtrpapercent(R%) = sxdebtrpa(R%) / GDPPOT(R%) * 100 'Save XDEBT as % of GDP for comparison with current values in computing EXRATE\r'If RegName$(R%) = \"Luxembourg\" And IY% >= 77 Then Stop\rXDEBTRPA(R%) = sxdebtrpa(R%) - CURACT(R%) 'Leaving out CURACTNETPRI/Intereset for now; if go there, could use next line\r'XDEBTRPA(R%) = -XNFA(R%) / 100 * GDPPOT(R%) 'Conceptually XDEBTRPA was like XNIIP; now like XNFA but opposite sign\rsxdebtrpa(R%) = XDEBTRPA(R%)\r'If RegName$(R%) = \"Luxembourg\" And IY% >= 77 Then Stop\rXNIIP(R%) = SXNIIP(R%) + (XPORTFOUT(R%) - XPORTFIN(R%) + XFDIFOUT(R%) - XFDIFIN(R%)) / GDPPOT(R%) * 100\rSXNIIP(R%) = XNIIP(R%)\rEnd If\r"
  },
  {
    "Variable": "XNIIP",
    "UsesVariable": "XPORTFOUT",
    "Distance": 0,
    "Code": "\rIf IY% = 1 Then\rSXNFA(R%) = XNFA(R%)\rSXNIIP(R%) = XNIIP(R%)\rElse\rXNFA(R%) = SXNFA(R%) + CURACTDATATOP(R%) 'Is %; includes all Current account terms\rSXNFA(R%) = XNFA(R%)\r'ssxdebtrpa(R%) = sxdebtrpa(R%)\rssxdebtrpapercent(R%) = sxdebtrpa(R%) / GDPPOT(R%) * 100 'Save XDEBT as % of GDP for comparison with current values in computing EXRATE\r'If RegName$(R%) = \"Luxembourg\" And IY% >= 77 Then Stop\rXDEBTRPA(R%) = sxdebtrpa(R%) - CURACT(R%) 'Leaving out CURACTNETPRI/Intereset for now; if go there, could use next line\r'XDEBTRPA(R%) = -XNFA(R%) / 100 * GDPPOT(R%) 'Conceptually XDEBTRPA was like XNIIP; now like XNFA but opposite sign\rsxdebtrpa(R%) = XDEBTRPA(R%)\r'If RegName$(R%) = \"Luxembourg\" And IY% >= 77 Then Stop\rXNIIP(R%) = SXNIIP(R%) + (XPORTFOUT(R%) - XPORTFIN(R%) + XFDIFOUT(R%) - XFDIFIN(R%)) / GDPPOT(R%) * 100\rSXNIIP(R%) = XNIIP(R%)\rEnd If\r"
  },
  {
    "Variable": "XNIIP",
    "UsesVariable": "XPORTFIN",
    "Distance": 0,
    "Code": "\rIf IY% = 1 Then\rSXNFA(R%) = XNFA(R%)\rSXNIIP(R%) = XNIIP(R%)\rElse\rXNFA(R%) = SXNFA(R%) + CURACTDATATOP(R%) 'Is %; includes all Current account terms\rSXNFA(R%) = XNFA(R%)\r'ssxdebtrpa(R%) = sxdebtrpa(R%)\rssxdebtrpapercent(R%) = sxdebtrpa(R%) / GDPPOT(R%) * 100 'Save XDEBT as % of GDP for comparison with current values in computing EXRATE\r'If RegName$(R%) = \"Luxembourg\" And IY% >= 77 Then Stop\rXDEBTRPA(R%) = sxdebtrpa(R%) - CURACT(R%) 'Leaving out CURACTNETPRI/Intereset for now; if go there, could use next line\r'XDEBTRPA(R%) = -XNFA(R%) / 100 * GDPPOT(R%) 'Conceptually XDEBTRPA was like XNIIP; now like XNFA but opposite sign\rsxdebtrpa(R%) = XDEBTRPA(R%)\r'If RegName$(R%) = \"Luxembourg\" And IY% >= 77 Then Stop\rXNIIP(R%) = SXNIIP(R%) + (XPORTFOUT(R%) - XPORTFIN(R%) + XFDIFOUT(R%) - XFDIFIN(R%)) / GDPPOT(R%) * 100\rSXNIIP(R%) = XNIIP(R%)\rEnd If\r"
  },
  {
    "Variable": "XNIIP",
    "UsesVariable": "XFDIFOUT",
    "Distance": 0,
    "Code": "\rIf IY% = 1 Then\rSXNFA(R%) = XNFA(R%)\rSXNIIP(R%) = XNIIP(R%)\rElse\rXNFA(R%) = SXNFA(R%) + CURACTDATATOP(R%) 'Is %; includes all Current account terms\rSXNFA(R%) = XNFA(R%)\r'ssxdebtrpa(R%) = sxdebtrpa(R%)\rssxdebtrpapercent(R%) = sxdebtrpa(R%) / GDPPOT(R%) * 100 'Save XDEBT as % of GDP for comparison with current values in computing EXRATE\r'If RegName$(R%) = \"Luxembourg\" And IY% >= 77 Then Stop\rXDEBTRPA(R%) = sxdebtrpa(R%) - CURACT(R%) 'Leaving out CURACTNETPRI/Intereset for now; if go there, could use next line\r'XDEBTRPA(R%) = -XNFA(R%) / 100 * GDPPOT(R%) 'Conceptually XDEBTRPA was like XNIIP; now like XNFA but opposite sign\rsxdebtrpa(R%) = XDEBTRPA(R%)\r'If RegName$(R%) = \"Luxembourg\" And IY% >= 77 Then Stop\rXNIIP(R%) = SXNIIP(R%) + (XPORTFOUT(R%) - XPORTFIN(R%) + XFDIFOUT(R%) - XFDIFIN(R%)) / GDPPOT(R%) * 100\rSXNIIP(R%) = XNIIP(R%)\rEnd If\r"
  },
  {
    "Variable": "XNIIP",
    "UsesVariable": "XFDIFIN",
    "Distance": 0,
    "Code": "\rIf IY% = 1 Then\rSXNFA(R%) = XNFA(R%)\rSXNIIP(R%) = XNIIP(R%)\rElse\rXNFA(R%) = SXNFA(R%) + CURACTDATATOP(R%) 'Is %; includes all Current account terms\rSXNFA(R%) = XNFA(R%)\r'ssxdebtrpa(R%) = sxdebtrpa(R%)\rssxdebtrpapercent(R%) = sxdebtrpa(R%) / GDPPOT(R%) * 100 'Save XDEBT as % of GDP for comparison with current values in computing EXRATE\r'If RegName$(R%) = \"Luxembourg\" And IY% >= 77 Then Stop\rXDEBTRPA(R%) = sxdebtrpa(R%) - CURACT(R%) 'Leaving out CURACTNETPRI/Intereset for now; if go there, could use next line\r'XDEBTRPA(R%) = -XNFA(R%) / 100 * GDPPOT(R%) 'Conceptually XDEBTRPA was like XNIIP; now like XNFA but opposite sign\rsxdebtrpa(R%) = XDEBTRPA(R%)\r'If RegName$(R%) = \"Luxembourg\" And IY% >= 77 Then Stop\rXNIIP(R%) = SXNIIP(R%) + (XPORTFOUT(R%) - XPORTFIN(R%) + XFDIFOUT(R%) - XFDIFIN(R%)) / GDPPOT(R%) * 100\rSXNIIP(R%) = XNIIP(R%)\rEnd If\r"
  },
  {
    "Variable": "XNIIP",
    "UsesVariable": "GDPPOT",
    "Distance": 0,
    "Code": "\rIf IY% = 1 Then\rSXNFA(R%) = XNFA(R%)\rSXNIIP(R%) = XNIIP(R%)\rElse\rXNFA(R%) = SXNFA(R%) + CURACTDATATOP(R%) 'Is %; includes all Current account terms\rSXNFA(R%) = XNFA(R%)\r'ssxdebtrpa(R%) = sxdebtrpa(R%)\rssxdebtrpapercent(R%) = sxdebtrpa(R%) / GDPPOT(R%) * 100 'Save XDEBT as % of GDP for comparison with current values in computing EXRATE\r'If RegName$(R%) = \"Luxembourg\" And IY% >= 77 Then Stop\rXDEBTRPA(R%) = sxdebtrpa(R%) - CURACT(R%) 'Leaving out CURACTNETPRI/Intereset for now; if go there, could use next line\r'XDEBTRPA(R%) = -XNFA(R%) / 100 * GDPPOT(R%) 'Conceptually XDEBTRPA was like XNIIP; now like XNFA but opposite sign\rsxdebtrpa(R%) = XDEBTRPA(R%)\r'If RegName$(R%) = \"Luxembourg\" And IY% >= 77 Then Stop\rXNIIP(R%) = SXNIIP(R%) + (XPORTFOUT(R%) - XPORTFIN(R%) + XFDIFOUT(R%) - XFDIFIN(R%)) / GDPPOT(R%) * 100\rSXNIIP(R%) = XNIIP(R%)\rEnd If\r"
  },
  {
    "Variable": "XPORTFIN",
    "UsesVariable": "XPORTFOLIO",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XPORTFOLIO",
    "UsesVariable": "WGDP",
    "Distance": 20,
    "Code": "0"
  },
  {
    "Variable": "XPORTFOLIO",
    "UsesVariable": "xportwgrm",
    "Distance": 20,
    "Code": "0"
  },
  {
    "Variable": "XPORTFOLIO",
    "UsesVariable": "GDP",
    "Distance": 2241,
    "Code": "0"
  },
  {
    "Variable": "XPORTFOLIO",
    "UsesVariable": "XPORTFIN",
    "Distance": 2239,
    "Code": "0"
  },
  {
    "Variable": "XPORTFOLIO",
    "UsesVariable": "GDPPOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XPORTFOLIO",
    "UsesVariable": "xportfoliom",
    "Distance": 0,
    "Code": "\r\rFor R% = 1 To NR%\r'If RegName$(R%) = \"Iceland\" And IY% >= 79 Then Stop\rIf XPortfolioI(R%) > 0 Then\rTbName$ = \"GDP/Capita (PPP) Versus Portfolio Stock Inflows Over GDP (2000)\"\rCall XYTABL(TbName$, GDPPCP(R%), PortfolioRatio, context)\rPortfolioRatio = ConvergeOverTime(SXPortGDPIn(R%), PortfolioRatio, 100)\rXPORTFOLIO(R%) = GDPPOT(R%) * PortfolioRatio\r'If RegName$(R%) = \"Luxembourg\" Then Stop\rPortfolioR = ConvergeOverTime(SXPortfolioR(R%), xportr(R%), 10)\r'Base, Target, Years\rXPORTFOLIO(R%) = XPORTFOLIO(R%) * (1 + PortfolioR / 100) * xportfoliom(R%)\rXPORTFOLIO(R%) = CSng(Amin(XPORTFOLIO(R%), 0.5 * GDPPOT(R%)))\rEnd If\r\r\rFor R% = 1 To NR%\r'If RegName$(R%) = \"Iceland\" And IY% >= 79 Then Stop\rIf XPortfolioI(R%) > 0 Then\rTbName$ = \"GDP/Capita (PPP) Versus Portfolio Stock Inflows Over GDP (2000)\"\rCall XYTABL(TbName$, GDPPCP(R%), PortfolioRatio, context)\rPortfolioRatio = ConvergeOverTime(SXPortGDPIn(R%), PortfolioRatio, 100)\rXPORTFOLIO(R%) = GDPPOT(R%) * PortfolioRatio\r'If RegName$(R%) = \"Luxembourg\" Then Stop\rPortfolioR = ConvergeOverTime(SXPortfolioR(R%), xportr(R%), 10)\r'Base, Target, Years\rXPORTFOLIO(R%) = XPORTFOLIO(R%) * (1 + PortfolioR / 100) * xportfoliom(R%)\rXPORTFOLIO(R%) = CSng(Amin(XPORTFOLIO(R%), 0.5 * GDPPOT(R%)))\rEnd If\r\rXPortfolioI(R%) = XPORTFOLIO(R%)\r"
  },
  {
    "Variable": "XPORTFOLIO",
    "UsesVariable": "xportr",
    "Distance": 1,
    "Code": "\rIf XPORTFOLIO(R%) > 0.001 Then\rSXPortfolioR(R%) = XPORTFIN(R%) / XPORTFOLIO(R%) * 100\rEnd If\r"
  },
  {
    "Variable": "XPORTFOLIO",
    "UsesVariable": "GDPPCP",
    "Distance": 2,
    "Code": "\r\rFor R% = 1 To NR%\r'If RegName$(R%) = \"Iceland\" And IY% >= 79 Then Stop\rIf XPortfolioI(R%) > 0 Then\rTbName$ = \"GDP/Capita (PPP) Versus Portfolio Stock Inflows Over GDP (2000)\"\rCall XYTABL(TbName$, GDPPCP(R%), PortfolioRatio, context)\rPortfolioRatio = ConvergeOverTime(SXPortGDPIn(R%), PortfolioRatio, 100)\rXPORTFOLIO(R%) = GDPPOT(R%) * PortfolioRatio\r'If RegName$(R%) = \"Luxembourg\" Then Stop\rPortfolioR = ConvergeOverTime(SXPortfolioR(R%), xportr(R%), 10)\r'Base, Target, Years\rXPORTFOLIO(R%) = XPORTFOLIO(R%) * (1 + PortfolioR / 100) * xportfoliom(R%)\rXPORTFOLIO(R%) = CSng(Amin(XPORTFOLIO(R%), 0.5 * GDPPOT(R%)))\rEnd If\r"
  },
  {
    "Variable": "XPORTFOUT",
    "UsesVariable": "XPORTSTOUT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XPORTSTOUT",
    "UsesVariable": "WGDP",
    "Distance": 21,
    "Code": "0"
  },
  {
    "Variable": "XPORTSTOUT",
    "UsesVariable": "xportwgrm",
    "Distance": 21,
    "Code": "0"
  },
  {
    "Variable": "XPORTSTOUT",
    "UsesVariable": "XPORTFOLIO",
    "Distance": 2241,
    "Code": "0"
  },
  {
    "Variable": "XPORTSTOUT",
    "UsesVariable": "GDP",
    "Distance": 2242,
    "Code": "0"
  },
  {
    "Variable": "XPORTSTOUT",
    "UsesVariable": "XPORTFIN",
    "Distance": 2240,
    "Code": "\rWPOrtFIn = 0\r\r\r'   First Year:  Portfolio Investment\r'   --------------------------------------\r\rWPortfolio = WPortfolio + XPORTFOLIO(R%)\r\rWPOrtFIn = WPOrtFIn + XPORTFIN(R%)\r\r"
  },
  {
    "Variable": "XPORTSTOUT",
    "UsesVariable": "GDPPOT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XPORTSTOUT",
    "UsesVariable": "xportstoutm",
    "Distance": 0,
    "Code": "\rPortfolioR = ConvergeOverTime(SXPORTSTOUTR(R%), xportr(R%), 10)\r\r'Base, Target, Years\rXPORTSTOUT(R%) = XPORTSTOUT(R%) * (1 + PortfolioR / 100) * xportstoutm(R%)\r"
  },
  {
    "Variable": "XPORTSTOUT",
    "UsesVariable": "xportr",
    "Distance": 1,
    "Code": "\rIf XPORTSTOUT(R%) > 0.001 Then\rSXPORTSTOUTR(R%) = XPORTFOUT(R%) / XPORTSTOUT(R%) * 100\rEnd If\r"
  },
  {
    "Variable": "XPORTSTOUT",
    "UsesVariable": "XPORTFOUT",
    "Distance": 2229,
    "Code": "\rIf XPORTSTOUT(R%) > 0.001 Then\rSXPORTSTOUTR(R%) = XPORTFOUT(R%) / XPORTSTOUT(R%) * 100\rEnd If\r"
  },
  {
    "Variable": "XPORTSTOUT",
    "UsesVariable": "GDPPCP",
    "Distance": 2,
    "Code": "\rCall XYTABL(TbName$, GDPPCP(R%), PortfolioRatio, context)\r"
  },
  {
    "Variable": "XRESERVES",
    "UsesVariable": "GDPPOT",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "XRESERVES",
    "UsesVariable": "govfinconv",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "XRESERVES",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "\r\r'   First Year:  International Financial Reserves\r'   ---------------------------------------------\r\rSXReserves(R%) = XRESERVES(R%) / 100 * GDP(R%)\r\r'bbh 2020/03/09 start comment out remittances block; handled now in subroutine called ealier\r''   First Year:  Worker Remittances\r''   -------------------------------\r\r''        If XWORKREMIT(R%) < 0 Then\r''        End If\r'If POPFOREIGN(R%) > 0 Then\r'    WWorkRemit = WWorkRemit - XWORKREMIT(R%)\r'    WPopForeign = WPopForeign + POPFOREIGN(R%)\r'End If\r\r"
  },
  {
    "Variable": "XRPA",
    "UsesVariable": "MRPA",
    "Distance": 7,
    "Code": "\rWM = 0!\r\r\r'     All Steps:  Terms of Trade - Exogenous Change\r'     ---------------------------------------------\r\rWX = 0!\r\rFor R% = 1 To NR%\rIf GDPPCI(R%) < nsdiv Then\rXRPA(R%) = XRPA(R%) * termtrm\rMRPA(R%) = MRPA(R%) / termtrm\rElse\rXRPA(R%) = XRPA(R%) / termtrm\rMRPA(R%) = MRPA(R%) * termtrm\rEnd If\r'bbh 2021/07/07 start Worked on this, but then moved to end of IFsEcoIntl\r'                 FORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) ' - XWORKEMIT(R%) 'Price adjusted compatible with XDEBTRPA\r'                 'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'                 'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'                    FIRMSAV (R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'                 FORSAV(R%) = M(R%) - X(R%) - AID(R%) ' - XWORKEMIT(R%) 'bbh 2021/07/07\r'                 SAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\r'                 SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'                 If RegName$(R%) = \"Ethiopia\" Then Stop\r'bbh 2021/07/07 end\rWX = WX + XRPA(R%)\rWM = WM + MRPA(R%)\rNext R%\r\rWM = 0!\r\rFor R% = 1 To NR%\rIf GDPPCI(R%) < nsdiv Then\rXRPA(R%) = XRPA(R%) * termtrm\rMRPA(R%) = MRPA(R%) / termtrm\rElse\rXRPA(R%) = XRPA(R%) / termtrm\rMRPA(R%) = MRPA(R%) * termtrm\rEnd If\r'bbh 2021/07/07 start Worked on this, but then moved to end of IFsEcoIntl\r'                 FORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) ' - XWORKEMIT(R%) 'Price adjusted compatible with XDEBTRPA\r'                 'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'                 'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'                    FIRMSAV (R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'                 FORSAV(R%) = M(R%) - X(R%) - AID(R%) ' - XWORKEMIT(R%) 'bbh 2021/07/07\r'                 SAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\r'                 SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'                 If RegName$(R%) = \"Ethiopia\" Then Stop\r'bbh 2021/07/07 end\rWX = WX + XRPA(R%)\rWM = WM + MRPA(R%)\rNext R%\r\r\r'     All Steps:  Terms of Trade - Exogenous Change\r'     ---------------------------------------------\r\rWX = 0!\r\r\r'     All Steps:  Relative-price Adjusted Trade and Payments Balances\r'     ---------------------------------------------------------------\rWX = AMAX(0.01, WX)\r\rWM = AMAX(0.01, WM)\r\r\r'     All Steps:  Terms of Trade - Exogenous Change\r'     ---------------------------------------------\r\rWX = 0!\r\rFor R% = 1 To NR%\rIf GDPPCI(R%) < nsdiv Then\rXRPA(R%) = XRPA(R%) * termtrm\rMRPA(R%) = MRPA(R%) / termtrm\rElse\rXRPA(R%) = XRPA(R%) / termtrm\rMRPA(R%) = MRPA(R%) * termtrm\rEnd If\r'bbh 2021/07/07 start Worked on this, but then moved to end of IFsEcoIntl\r'                 FORSAVRPA(R%) = MRPA(R%) - XRPA(R%) - AID(R%) ' - XWORKEMIT(R%) 'Price adjusted compatible with XDEBTRPA\r'                 'jrs 2020/08/28 moved to ifsEconSAM the members were not computed yet here\r'                 'SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + _\r'                    FIRMSAV (R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'                 FORSAV(R%) = M(R%) - X(R%) - AID(R%) ' - XWORKEMIT(R%) 'bbh 2021/07/07\r'                 SAVINGS(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAV(R%)\r'                 SAVINGSRPA(R%) = HHSAV(R%, Unskilled) + HHSAV(R%, Skilled) + FIRMSAV(R%) + GOVBAL(R%) + FORSAVRPA(R%)\r'                 If RegName$(R%) = \"Ethiopia\" Then Stop\r'bbh 2021/07/07 end\rWX = WX + XRPA(R%)\rWM = WM + MRPA(R%)\rNext R%\r\rWT = (WM + WX) / 2\r\r\r'     All Steps:  Relative-price Adjusted Trade and Payments Balances\r'     ---------------------------------------------------------------\rWX = AMAX(0.01, WX)\r\rFor R% = 1 To NR%\rXRPA(R%) = XRPA(R%) / AMAX(0.01, WX) * WT\rMRPA(R%) = MRPA(R%) / AMAX(0.01, WM) * WT\r'TRADEBAL(R%) = XRPA(R%) - MRPA(R%)\rTRADEBAL(R%) = X(R%) - M(R%) 'bbh 2021/07/07\rSExRate(R%) = EXRATE(R%)\r'jrs 2014/04/11\r'             SX(R%) = X(R%)\r'             SM(R%) = M(R%)\rIf IY% > 1 Then\raidlp(R%) = AMAX(0, Amin(1, AIDLPI(R%) * aidlpm))\rEnd If\rIf AID(R%) > 0 Then 'Recipients\rSumAid = SumAid + AID(R%)\rSumAidLP = SumAidLP + AID(R%) * aidlp(R%)\rEnd If\rNext R%\r"
  },
  {
    "Variable": "XRPA",
    "UsesVariable": "termtrm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XRPA",
    "UsesVariable": "XS",
    "Distance": 0,
    "Code": "\r\rPublic Sub IFsEcoIntl1AllYears(context As IForecastContext)\r'jrs 2014/09/16\rDim S As Integer, WX As Single, WM As Single, WT As Single, SumAid As Single, SumAidLP As Single\r\r'jrs 2014/04/11 *** using IFUN to avoid repeating calculation in IFUN = 3\r'If IFUN = 2 Then\rFor R% = 1 To NR%\r'         X(R%) = 0!\r'         M(R%) = 0!\rXRPA(R%) = 0\rMRPA(R%) = 0\r\r'     All Steps:  Trade and Relative Price-Adjusted Trade\r'     ---------------------------------------------------\r\rFor S% = 1 To NSec%\r'            X(R%) = X(R%) + XS(R%, S%)\r'            M(R%) = M(R%) + MS(R%, S%)\rXRPA(R%) = XRPA(R%) + XS(R%, S%) * WP(S%) '* PRI(r%, s%) * EXRATE(r%)\rMRPA(R%) = MRPA(R%) + MS(R%, S%) * WP(S%)\r\rNext S%\rNext R%\r"
  },
  {
    "Variable": "XRPA",
    "UsesVariable": "WP",
    "Distance": 0,
    "Code": "\r\rPublic Sub IFsEcoIntl1AllYears(context As IForecastContext)\r'jrs 2014/09/16\rDim S As Integer, WX As Single, WM As Single, WT As Single, SumAid As Single, SumAidLP As Single\r\r'jrs 2014/04/11 *** using IFUN to avoid repeating calculation in IFUN = 3\r'If IFUN = 2 Then\rFor R% = 1 To NR%\r'         X(R%) = 0!\r'         M(R%) = 0!\rXRPA(R%) = 0\rMRPA(R%) = 0\r\r'     All Steps:  Trade and Relative Price-Adjusted Trade\r'     ---------------------------------------------------\r\rFor S% = 1 To NSec%\r'            X(R%) = X(R%) + XS(R%, S%)\r'            M(R%) = M(R%) + MS(R%, S%)\rXRPA(R%) = XRPA(R%) + XS(R%, S%) * WP(S%) '* PRI(r%, s%) * EXRATE(r%)\rMRPA(R%) = MRPA(R%) + MS(R%, S%) * WP(S%)\r\rNext S%\rNext R%\r"
  },
  {
    "Variable": "XS",
    "UsesVariable": "bilateraltradeforwardlinksw",
    "Distance": 0,
    "Code": "\rPrivate Sub AdjustXSMS()\rDim i As Integer, j As Integer, k As Integer, TotVal As Single\r'Exports\rFor i = 1 To NR\rFor k = 1 To NSec\rTotVal = 0\rIf TotVal > 0 Then 'jrs 2017/01/12\rXS(i, k) = (1 - bilateraltradeforwardlinksw) * XS(i, k) + bilateraltradeforwardlinksw * TotVal / 1000000000\rEnd If\rNext k\rNext i\r'Imports\rFor i = 1 To NR\rFor k = 1 To NSec\rTotVal = 0\rIf TotVal > 0 Then 'jrs 2017/01/12\rMS(i, k) = (1 - bilateraltradeforwardlinksw) * MS(i, k) + bilateraltradeforwardlinksw * TotVal / 1000000000\rEnd If\rNext k\rNext i\rEnd Sub\r"
  },
  {
    "Variable": "XS",
    "UsesVariable": "xsm",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "XS",
    "UsesVariable": "MS",
    "Distance": 47,
    "Code": "0"
  },
  {
    "Variable": "XS",
    "UsesVariable": "gdprext",
    "Distance": 47,
    "Code": "0"
  },
  {
    "Variable": "XS",
    "UsesVariable": "xshift",
    "Distance": 47,
    "Code": "0"
  },
  {
    "Variable": "XS",
    "UsesVariable": "elasxinc",
    "Distance": 48,
    "Code": "0"
  },
  {
    "Variable": "XS",
    "UsesVariable": "ZS",
    "Distance": 48,
    "Code": "0"
  },
  {
    "Variable": "XS",
    "UsesVariable": "msm",
    "Distance": 9,
    "Code": "\r'If RegName$(R%) = \"United States of America\" And S% = 4 And IY% >= 2 Then Stop\r'  e) restrict import demand by absolute minimum\rIf md(R%, S%) < 0.0001 Then md(R%, S%) = 0.0001\r"
  },
  {
    "Variable": "XS",
    "UsesVariable": "PRI",
    "Distance": 45,
    "Code": "0"
  },
  {
    "Variable": "XS",
    "UsesVariable": "EXRATE",
    "Distance": 45,
    "Code": "0"
  },
  {
    "Variable": "XS",
    "UsesVariable": "XTARIFFTAXR",
    "Distance": 45,
    "Code": "0"
  },
  {
    "Variable": "XS",
    "UsesVariable": "WP",
    "Distance": 45,
    "Code": "0"
  },
  {
    "Variable": "XS",
    "UsesVariable": "elastrpr",
    "Distance": 45,
    "Code": "0"
  },
  {
    "Variable": "XS",
    "UsesVariable": "elxpr1",
    "Distance": 42,
    "Code": "0"
  },
  {
    "Variable": "XS",
    "UsesVariable": "elxpr2",
    "Distance": 41,
    "Code": "0"
  },
  {
    "Variable": "XS",
    "UsesVariable": "GDP",
    "Distance": 1789,
    "Code": "0"
  },
  {
    "Variable": "XS",
    "UsesVariable": "CS",
    "Distance": 30,
    "Code": "0"
  },
  {
    "Variable": "XS",
    "UsesVariable": "GS",
    "Distance": 30,
    "Code": "0"
  },
  {
    "Variable": "XS",
    "UsesVariable": "INVS",
    "Distance": 30,
    "Code": "0"
  },
  {
    "Variable": "XS",
    "UsesVariable": "ST",
    "Distance": 14,
    "Code": "\rM_Base = CS(R%, S%) + GS(R%, S%) + INVS(R%, S%) + ZS(R%, S%) '- PFD(R%, S%)\r"
  },
  {
    "Variable": "XS",
    "UsesVariable": "dstl",
    "Distance": 14,
    "Code": "\rM_Base = CS(R%, S%) + GS(R%, S%) + INVS(R%, S%) + ZS(R%, S%) '- PFD(R%, S%)\r"
  },
  {
    "Variable": "XS",
    "UsesVariable": "MTARIFFTAXR",
    "Distance": 22,
    "Code": "0"
  },
  {
    "Variable": "XS",
    "UsesVariable": "GDPPOT",
    "Distance": 99,
    "Code": "\rims(R%, S%) = MS(R%, S%)\r\r'If RegName$(R%) = \"Unitd Kingdm\" Then Stop\r\r\r'   All but First 2:  Adjustments to Intersectoral Flows with Ag Model Computations and Recomputation of ZS, VADD\r'       (for Stock Base and Capacity Utilization)\r'   ------------------------------------------------------\r\rFor column% = 1 To NSec%\rints(R%, column%) = 0!\rintsp = 0!\rFor row = 1 To NSec%\r'If IY% + 2016 = 2018 And RegName$(R%) = \"United States of America\" And row = 2 And column% = 5 Then Stop    'AgINTSFlows\r'If IY% + 2016 = 2020 And RegName$(R%) = \"United States of America\" And row = 2 And column% = 5 Then Stop\rintsp = intsp + AMat(R%, row, column%)\rNext row\rcond = (column% > Ener) Or\r                                (column% = Agri And agon < 0.9) Or (column% = Ener And enon < 0.9)\rintsp = CSng(Amin(0.95, intsp))\rIf cond Then\rZS(R%, column%) = VADD(R%, column%) / (1 - intsp)\rElse\rVADD(R%, column%) = ZS(R%, column%) * (1 - intsp) 'ZS from sectoral models\rEnd If\rFor row = 1 To NSec%\rints(row, column%) = ZS(R%, column%) * AMat(R%, row, column%)\r'If IY% + 2016 = 2018 And RegName$(R%) = \"United States of America\" And row = 2 And column% = 5 Then Stop\r'If IY% + 2016 = 2040 And RegName$(R%) = \"United States of America\" And row = 2 And column% = 5 Then Stop\rNext row\r\rzsp(R%, column%) = ZS(R%, column%)\rGDPPOT(R%) = GDPPOT(R%) + VADD(R%, column%)\rGDPPOTRPA(R%) = GDPPOTRPA(R%) + VADD(R%, column%) * SWP(column%)\rNext column%\r"
  },
  {
    "Variable": "XS",
    "UsesVariable": "elmpr1",
    "Distance": 40,
    "Code": "\rmprclag(R%, S%) = 0\r"
  },
  {
    "Variable": "XS",
    "UsesVariable": "elmpr2",
    "Distance": 39,
    "Code": "\rmprclag(R%, S%) = 0\r"
  },
  {
    "Variable": "XS",
    "UsesVariable": "bilateralsw",
    "Distance": 1292,
    "Code": "0"
  },
  {
    "Variable": "XS",
    "UsesVariable": "protecm",
    "Distance": 23,
    "Code": "0"
  },
  {
    "Variable": "XS",
    "UsesVariable": "AGXVALUE",
    "Distance": 0,
    "Code": "\r'dsr 2015/07/29 Need to balance value of trade by commodity and not just for agriculture as a whole\r'    WTRA = (WX + WM) / 2\rFor f% = 1 To 3\rDim WTRA = (WX(f%) + WM(f%)) / 2\rFor R% = 1 To NR%\r'             XS(R%, 1) = XS(R%, 1) * WTRA / AMAX(WX, 0.001)\r'             MS(R%, 1) = MS(R%, 1) * WTRA / AMAX(WM, 0.001)\rAGMVALUE(R%, f%) = CSng(AGMVALUE(R%, f%) * WTRA / AMAX(WM(f%), 0.001))\rAGXVALUE(R%, f%) = CSng(AGXVALUE(R%, f%) * WTRA / AMAX(WX(f%), 0.001))\rMS(R%, 1) = MS(R%, 1) + AGMVALUE(R%, f%)\rXS(R%, 1) = XS(R%, 1) + AGXVALUE(R%, f%)\rNext R%\rNext f%\r\r'ifsAgAllYears(2, context) 'ttt\r"
  },
  {
    "Variable": "XS",
    "UsesVariable": "ENX",
    "Distance": 0,
    "Code": "\r'If RegName$(R%) = \"Unitd Kingdm\" Then Stop\rXS(R%, Ener) = ENX(R%) * iwepbyear ' ENPRII(R%) 'for all but investment which is in\r\rXS(R%, 1) = 0\r"
  },
  {
    "Variable": "XS",
    "UsesVariable": "WEPBYEAR",
    "Distance": 413,
    "Code": "\riwepbyear = WEPBYEAR\r"
  },
  {
    "Variable": "XTARIFFTAXR",
    "UsesVariable": "XTARIFFREV",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XTARIFFTAXR",
    "UsesVariable": "XS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XWBFLOWS",
    "UsesVariable": "XWBLNFIN",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XWBFLOWS",
    "UsesVariable": "xwbsectar",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XWBFLOWS",
    "UsesVariable": "GOVHHTRNWEL",
    "Distance": 2240,
    "Code": "0"
  },
  {
    "Variable": "XWBLNFIN",
    "UsesVariable": "XWBLOANSTOT",
    "Distance": 9,
    "Code": "0"
  },
  {
    "Variable": "XWBLNFIN",
    "UsesVariable": "xwblnfinm",
    "Distance": 0,
    "Code": "\rwbloanspi(R%) = AMAX(0#, Amin(10, Prediction))\r\rDim Prediction = 0!\r\rFor R% = 1 To NR%\raidpergdp(R%) = AMAX(0, AID(R%) / GDPPOT(R%) * 100)\rCall AnalFunc(\"World Bank Loans as % of Recipient GDP\",\r            New Single() {GDPPCP(R%), GINIDOM(R%), aidpergdp(R%)}, Prediction,\r            New String() {\"GDPPCP\", \"GINIDOM\", \"AIDPERGDP\"}, context) 'jrs 2014/10/09 added DepVar Names to check order\rPrediction = AMAX(0#, Amin(10, Prediction))\rIf wbloanspi(R%) > 0 Then\rXWBLNFIN(R%) = XWBLNFIN(R%) * Prediction / wbloanspi(R%) * xwblnfinm(R%)\r'Multiplier will increase loans to one country at expense of others\r'   If want to increase WB loans overall look to xwbloanr\rEnd If\rxwblncomptot = xwblncomptot + XWBLNFIN(R%)\r'If R% <= 4 Then Stop\r'If RegName$(R%) = \"Angola\" Then Stop\rNext R%\r\rFor R% = 1 To NR%\raidpergdp(R%) = AMAX(0, AID(R%) / GDPPOT(R%) * 100)\rCall AnalFunc(\"World Bank Loans as % of Recipient GDP\",\r            New Single() {GDPPCP(R%), GINIDOM(R%), aidpergdp(R%)}, Prediction,\r            New String() {\"GDPPCP\", \"GINIDOM\", \"AIDPERGDP\"}, context) 'jrs 2014/10/09 added DepVar Names to check order\rPrediction = AMAX(0#, Amin(10, Prediction))\rIf wbloanspi(R%) > 0 Then\rXWBLNFIN(R%) = XWBLNFIN(R%) * Prediction / wbloanspi(R%) * xwblnfinm(R%)\r'Multiplier will increase loans to one country at expense of others\r'   If want to increase WB loans overall look to xwbloanr\rEnd If\rxwblncomptot = xwblncomptot + XWBLNFIN(R%)\r'If R% <= 4 Then Stop\r'If RegName$(R%) = \"Angola\" Then Stop\rNext R%\r\rFor R% = 1 To NR%\raidpergdp(R%) = AMAX(0, AID(R%) / GDPPOT(R%) * 100)\rCall AnalFunc(\"World Bank Loans as % of Recipient GDP\",\r            New Single() {GDPPCP(R%), GINIDOM(R%), aidpergdp(R%)}, Prediction,\r            New String() {\"GDPPCP\", \"GINIDOM\", \"AIDPERGDP\"}, context) 'jrs 2014/10/09 added DepVar Names to check order\rPrediction = AMAX(0#, Amin(10, Prediction))\rIf wbloanspi(R%) > 0 Then\rXWBLNFIN(R%) = XWBLNFIN(R%) * Prediction / wbloanspi(R%) * xwblnfinm(R%)\r'Multiplier will increase loans to one country at expense of others\r'   If want to increase WB loans overall look to xwbloanr\rEnd If\rxwblncomptot = xwblncomptot + XWBLNFIN(R%)\r'If R% <= 4 Then Stop\r'If RegName$(R%) = \"Angola\" Then Stop\rNext R%\r\rSUMWBFLOWSIN = 0\r"
  },
  {
    "Variable": "XWBLNFIN",
    "UsesVariable": "GDPPCP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "XWBLNFIN",
    "UsesVariable": "GINIDOM",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "XWBLNFIN",
    "UsesVariable": "AID",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "XWBLNFIN",
    "UsesVariable": "GDPPOT",
    "Distance": 3,
    "Code": "0"
  },
  {
    "Variable": "XWBLNFOUT",
    "UsesVariable": "XWBLOANS",
    "Distance": 0,
    "Code": "\r\r'   All but First:  WB Loans\r'   ------------------------\r\rFor R% = 1 To NR%\r'If SXWBLOANS(R%) > 0 Then 'borrowers, credit users 'bbh 2020/08/15\rIf XWBLOANSI(R%) > -0.0001 Then 'borrowers, credit users 'bbh 2020/08/15 use of SXWBLOANS caused oscillation\rXWBLNFOUT(R%) = SXWBLOANS(R%) * xwblnintr / 100 _\r                + SXWBLOANS(R%) / AMAX(1, xwblnrepr)\rxwblnrepaytot = xwblnrepaytot + XWBLNFOUT(R%)\r'repayments, principal plus interest, as in preprocessor\rElse 'subscriber, contributor\rMaxSub = 0.001! * GDPPOT(R%)\rXWBSUBF(R%) = Amin(MaxSub, SXWBSUBF(R%) * (1 + xwbloanr / 100))\rSXWBSUBF(R%) = XWBSUBF(R%)\rxwbnewsubtot = xwbnewsubtot + XWBSUBF(R%)\rXWBLNFOUT(R%) = XWBLNFOUTI(R%) 'bbh 2020/08/15 ; value should be 0 as set for subscribers in preprocessor\rEnd If\rNext R%\r\r\rFor R% = 1 To NR%\rIf XWBLOANS(R%) < 0 Then 'lenders\rXWBLOANSUBI(R%) = -XWBLOANS(R%)\rSXWBSUBF(R%) = XWBSUBF(R%)\rEnd If\rXWBLNFINI(R%) = XWBLNFIN(R%)\rXWBLNFOUTI(R%) = XWBLNFOUT(R%)\rXWBLOANSI(R%) = XWBLOANS(R%) 'bbh 2020/08/15 - keep track of whether borrowers or only subscribers to bank\rNext R%\r\r\r'   All but First:  WB Loans\r'   ------------------------\r\rFor R% = 1 To NR%\r'If SXWBLOANS(R%) > 0 Then 'borrowers, credit users 'bbh 2020/08/15\rIf XWBLOANSI(R%) > -0.0001 Then 'borrowers, credit users 'bbh 2020/08/15 use of SXWBLOANS caused oscillation\rXWBLNFOUT(R%) = SXWBLOANS(R%) * xwblnintr / 100 _\r                + SXWBLOANS(R%) / AMAX(1, xwblnrepr)\rxwblnrepaytot = xwblnrepaytot + XWBLNFOUT(R%)\r'repayments, principal plus interest, as in preprocessor\rElse 'subscriber, contributor\rMaxSub = 0.001! * GDPPOT(R%)\rXWBSUBF(R%) = Amin(MaxSub, SXWBSUBF(R%) * (1 + xwbloanr / 100))\rSXWBSUBF(R%) = XWBSUBF(R%)\rxwbnewsubtot = xwbnewsubtot + XWBSUBF(R%)\rXWBLNFOUT(R%) = XWBLNFOUTI(R%) 'bbh 2020/08/15 ; value should be 0 as set for subscribers in preprocessor\rEnd If\rNext R%\r"
  },
  {
    "Variable": "XWBLNFOUT",
    "UsesVariable": "xwblnintr",
    "Distance": 0,
    "Code": "\r\r'   All but First:  WB Loans\r'   ------------------------\r\rFor R% = 1 To NR%\r'If SXWBLOANS(R%) > 0 Then 'borrowers, credit users 'bbh 2020/08/15\rIf XWBLOANSI(R%) > -0.0001 Then 'borrowers, credit users 'bbh 2020/08/15 use of SXWBLOANS caused oscillation\rXWBLNFOUT(R%) = SXWBLOANS(R%) * xwblnintr / 100 _\r                + SXWBLOANS(R%) / AMAX(1, xwblnrepr)\rxwblnrepaytot = xwblnrepaytot + XWBLNFOUT(R%)\r'repayments, principal plus interest, as in preprocessor\rElse 'subscriber, contributor\rMaxSub = 0.001! * GDPPOT(R%)\rXWBSUBF(R%) = Amin(MaxSub, SXWBSUBF(R%) * (1 + xwbloanr / 100))\rSXWBSUBF(R%) = XWBSUBF(R%)\rxwbnewsubtot = xwbnewsubtot + XWBSUBF(R%)\rXWBLNFOUT(R%) = XWBLNFOUTI(R%) 'bbh 2020/08/15 ; value should be 0 as set for subscribers in preprocessor\rEnd If\rNext R%\r"
  },
  {
    "Variable": "XWBLNFOUT",
    "UsesVariable": "xwblnrepr",
    "Distance": 0,
    "Code": "\r\r'   All but First:  WB Loans\r'   ------------------------\r\rFor R% = 1 To NR%\r'If SXWBLOANS(R%) > 0 Then 'borrowers, credit users 'bbh 2020/08/15\rIf XWBLOANSI(R%) > -0.0001 Then 'borrowers, credit users 'bbh 2020/08/15 use of SXWBLOANS caused oscillation\rXWBLNFOUT(R%) = SXWBLOANS(R%) * xwblnintr / 100 _\r                + SXWBLOANS(R%) / AMAX(1, xwblnrepr)\rxwblnrepaytot = xwblnrepaytot + XWBLNFOUT(R%)\r'repayments, principal plus interest, as in preprocessor\rElse 'subscriber, contributor\rMaxSub = 0.001! * GDPPOT(R%)\rXWBSUBF(R%) = Amin(MaxSub, SXWBSUBF(R%) * (1 + xwbloanr / 100))\rSXWBSUBF(R%) = XWBSUBF(R%)\rxwbnewsubtot = xwbnewsubtot + XWBSUBF(R%)\rXWBLNFOUT(R%) = XWBLNFOUTI(R%) 'bbh 2020/08/15 ; value should be 0 as set for subscribers in preprocessor\rEnd If\rNext R%\r"
  },
  {
    "Variable": "XWBLOANS",
    "UsesVariable": "XWBLNFIN",
    "Distance": 0,
    "Code": "\rFor R% = 1 To NR%\rXWBLNFIN(R%) = XWBLNFIN(R%) / AMAX(0.001, xwblncomptot) * xwblnnewtot\rXWBLOANS(R%) = SXWBLOANS(R%) + XWBLNFIN(R%) - XWBLNFOUT(R%) - XWBSUBF(R%)\r'If XWBLOANS(R%) > 0 And R = 179 Then Stop\rSXWBLOANS(R%) = XWBLOANS(R%)\r'If RegName$(R%) = \"Angola\" Then Stop\rNext R%\r"
  },
  {
    "Variable": "XWBLOANS",
    "UsesVariable": "XWBLNFOUT",
    "Distance": 0,
    "Code": "\rFor R% = 1 To NR%\rXWBLNFIN(R%) = XWBLNFIN(R%) / AMAX(0.001, xwblncomptot) * xwblnnewtot\rXWBLOANS(R%) = SXWBLOANS(R%) + XWBLNFIN(R%) - XWBLNFOUT(R%) - XWBSUBF(R%)\r'If XWBLOANS(R%) > 0 And R = 179 Then Stop\rSXWBLOANS(R%) = XWBLOANS(R%)\r'If RegName$(R%) = \"Angola\" Then Stop\rNext R%\r"
  },
  {
    "Variable": "XWBLOANS",
    "UsesVariable": "XWBSUBF",
    "Distance": 0,
    "Code": "\rFor R% = 1 To NR%\rXWBLNFIN(R%) = XWBLNFIN(R%) / AMAX(0.001, xwblncomptot) * xwblnnewtot\rXWBLOANS(R%) = SXWBLOANS(R%) + XWBLNFIN(R%) - XWBLNFOUT(R%) - XWBSUBF(R%)\r'If XWBLOANS(R%) > 0 And R = 179 Then Stop\rSXWBLOANS(R%) = XWBLOANS(R%)\r'If RegName$(R%) = \"Angola\" Then Stop\rNext R%\r"
  },
  {
    "Variable": "XWBLOANSTOT",
    "UsesVariable": "XWBLOANS",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XWBLOANSTOT",
    "UsesVariable": "xwblneqr",
    "Distance": 0,
    "Code": "\r\r'   All but First:  WB Loans\r'   ------------------------\r\rFor R% = 1 To NR%\r'If SXWBLOANS(R%) > 0 Then 'borrowers, credit users 'bbh 2020/08/15\rIf XWBLOANSI(R%) > -0.0001 Then 'borrowers, credit users 'bbh 2020/08/15 use of SXWBLOANS caused oscillation\rXWBLNFOUT(R%) = SXWBLOANS(R%) * xwblnintr / 100 _\r                + SXWBLOANS(R%) / AMAX(1, xwblnrepr)\rxwblnrepaytot = xwblnrepaytot + XWBLNFOUT(R%)\r'repayments, principal plus interest, as in preprocessor\rElse 'subscriber, contributor\rMaxSub = 0.001! * GDPPOT(R%)\rXWBSUBF(R%) = Amin(MaxSub, SXWBSUBF(R%) * (1 + xwbloanr / 100))\rSXWBSUBF(R%) = XWBSUBF(R%)\rxwbnewsubtot = xwbnewsubtot + XWBSUBF(R%)\rXWBLNFOUT(R%) = XWBLNFOUTI(R%) 'bbh 2020/08/15 ; value should be 0 as set for subscribers in preprocessor\rEnd If\rNext R%\r\rxwblnnewtot = XWBFLOWSINTOTI * XWBLOANSTOT / XWBLOANSTOTI\r\r\r'   All but First:  WB Loans\r'   ------------------------\r\rFor R% = 1 To NR%\r'If SXWBLOANS(R%) > 0 Then 'borrowers, credit users 'bbh 2020/08/15\rIf XWBLOANSI(R%) > -0.0001 Then 'borrowers, credit users 'bbh 2020/08/15 use of SXWBLOANS caused oscillation\rXWBLNFOUT(R%) = SXWBLOANS(R%) * xwblnintr / 100 _\r                + SXWBLOANS(R%) / AMAX(1, xwblnrepr)\rxwblnrepaytot = xwblnrepaytot + XWBLNFOUT(R%)\r'repayments, principal plus interest, as in preprocessor\rElse 'subscriber, contributor\rMaxSub = 0.001! * GDPPOT(R%)\rXWBSUBF(R%) = Amin(MaxSub, SXWBSUBF(R%) * (1 + xwbloanr / 100))\rSXWBSUBF(R%) = XWBSUBF(R%)\rxwbnewsubtot = xwbnewsubtot + XWBSUBF(R%)\rXWBLNFOUT(R%) = XWBLNFOUTI(R%) 'bbh 2020/08/15 ; value should be 0 as set for subscribers in preprocessor\rEnd If\rNext R%\r\rsxwbloanstot = XWBLOANSTOT + xwblnrepaytot - xwblnnewtot + xwbnewsubtot * xwblneqr\r"
  },
  {
    "Variable": "XWBLOANSTOT",
    "UsesVariable": "XWBLNFOUT",
    "Distance": 8,
    "Code": "\r\rxwblnrepaytot = 0\r"
  },
  {
    "Variable": "XWBLOANSTOT",
    "UsesVariable": "XWBSUBF",
    "Distance": 4,
    "Code": "\rxwbnewsubtot = 0\r\rXWBLOANSTOTI = XWBLOANSTOT\r\rXWBFLOWSINTOTI = SUMWBFLOWSIN\r\r\rFor R% = 1 To NR%\rIf XWBLOANS(R%) < 0 Then 'lenders\rXWBLOANSUBI(R%) = -XWBLOANS(R%)\rSXWBSUBF(R%) = XWBSUBF(R%)\rEnd If\rXWBLNFINI(R%) = XWBLNFIN(R%)\rXWBLNFOUTI(R%) = XWBLNFOUT(R%)\rXWBLOANSI(R%) = XWBLOANS(R%) 'bbh 2020/08/15 - keep track of whether borrowers or only subscribers to bank\rNext R%\r"
  },
  {
    "Variable": "XWBLOANSTOT",
    "UsesVariable": "XWBLNFIN",
    "Distance": 2255,
    "Code": "\rSUMWBFLOWSIN = 0\r\r\r'   First Year:  WB Obligations, Flows\r'   -----------------------------------\rFor R% = 1 To NR%\rSXWBLOANS(R%) = XWBLOANS(R%)\rIf XWBLOANS(R%) > 0 Then ' borrowers\rSUMWBFLOWSIN = SUMWBFLOWSIN + XWBLNFIN(R%)\rSUMWBFLOWSOUT = SUMWBFLOWSOUT + XWBLNFOUT(R%)\rXWBLOANSTOT = XWBLOANSTOT + XWBLOANS(R%)\rEnd If\rNext R%\r"
  },
  {
    "Variable": "XWBLOANSTOT",
    "UsesVariable": "xwbloanr",
    "Distance": 0,
    "Code": "\rsxwbloanstot = AMAX(0.0001, XWBLOANSTOT) * (1 + xwbloanr / 100) 'increased by new subscriptions\r"
  },
  {
    "Variable": "XWBSUBF",
    "UsesVariable": "xwbloanr",
    "Distance": 0,
    "Code": "\r\r'   All but First:  WB Loans\r'   ------------------------\r\rFor R% = 1 To NR%\r'If SXWBLOANS(R%) > 0 Then 'borrowers, credit users 'bbh 2020/08/15\rIf XWBLOANSI(R%) > -0.0001 Then 'borrowers, credit users 'bbh 2020/08/15 use of SXWBLOANS caused oscillation\rXWBLNFOUT(R%) = SXWBLOANS(R%) * xwblnintr / 100 _\r                + SXWBLOANS(R%) / AMAX(1, xwblnrepr)\rxwblnrepaytot = xwblnrepaytot + XWBLNFOUT(R%)\r'repayments, principal plus interest, as in preprocessor\rElse 'subscriber, contributor\rMaxSub = 0.001! * GDPPOT(R%)\rXWBSUBF(R%) = Amin(MaxSub, SXWBSUBF(R%) * (1 + xwbloanr / 100))\rSXWBSUBF(R%) = XWBSUBF(R%)\rxwbnewsubtot = xwbnewsubtot + XWBSUBF(R%)\rXWBLNFOUT(R%) = XWBLNFOUTI(R%) 'bbh 2020/08/15 ; value should be 0 as set for subscribers in preprocessor\rEnd If\rNext R%\r\r\r'   All but First:  WB Loans\r'   ------------------------\r\rFor R% = 1 To NR%\r'If SXWBLOANS(R%) > 0 Then 'borrowers, credit users 'bbh 2020/08/15\rIf XWBLOANSI(R%) > -0.0001 Then 'borrowers, credit users 'bbh 2020/08/15 use of SXWBLOANS caused oscillation\rXWBLNFOUT(R%) = SXWBLOANS(R%) * xwblnintr / 100 _\r                + SXWBLOANS(R%) / AMAX(1, xwblnrepr)\rxwblnrepaytot = xwblnrepaytot + XWBLNFOUT(R%)\r'repayments, principal plus interest, as in preprocessor\rElse 'subscriber, contributor\rMaxSub = 0.001! * GDPPOT(R%)\rXWBSUBF(R%) = Amin(MaxSub, SXWBSUBF(R%) * (1 + xwbloanr / 100))\rSXWBSUBF(R%) = XWBSUBF(R%)\rxwbnewsubtot = xwbnewsubtot + XWBSUBF(R%)\rXWBLNFOUT(R%) = XWBLNFOUTI(R%) 'bbh 2020/08/15 ; value should be 0 as set for subscribers in preprocessor\rEnd If\rNext R%\r"
  },
  {
    "Variable": "XWBSUBF",
    "UsesVariable": "GDPPOT",
    "Distance": 1,
    "Code": "\r\r'   All but First:  WB Loans\r'   ------------------------\r\rFor R% = 1 To NR%\r'If SXWBLOANS(R%) > 0 Then 'borrowers, credit users 'bbh 2020/08/15\rIf XWBLOANSI(R%) > -0.0001 Then 'borrowers, credit users 'bbh 2020/08/15 use of SXWBLOANS caused oscillation\rXWBLNFOUT(R%) = SXWBLOANS(R%) * xwblnintr / 100 _\r                + SXWBLOANS(R%) / AMAX(1, xwblnrepr)\rxwblnrepaytot = xwblnrepaytot + XWBLNFOUT(R%)\r'repayments, principal plus interest, as in preprocessor\rElse 'subscriber, contributor\rMaxSub = 0.001! * GDPPOT(R%)\rXWBSUBF(R%) = Amin(MaxSub, SXWBSUBF(R%) * (1 + xwbloanr / 100))\rSXWBSUBF(R%) = XWBSUBF(R%)\rxwbnewsubtot = xwbnewsubtot + XWBSUBF(R%)\rXWBLNFOUT(R%) = XWBLNFOUTI(R%) 'bbh 2020/08/15 ; value should be 0 as set for subscribers in preprocessor\rEnd If\rNext R%\r"
  },
  {
    "Variable": "XWBSUBF",
    "UsesVariable": "XWBLOANS",
    "Distance": 0,
    "Code": "\r\rFor R% = 1 To NR%\rIf XWBLOANS(R%) < 0 Then 'lenders\rXWBLOANSUBI(R%) = -XWBLOANS(R%)\rSXWBSUBF(R%) = XWBSUBF(R%)\rEnd If\rXWBLNFINI(R%) = XWBLNFIN(R%)\rXWBLNFOUTI(R%) = XWBLNFOUT(R%)\rXWBLOANSI(R%) = XWBLOANS(R%) 'bbh 2020/08/15 - keep track of whether borrowers or only subscribers to bank\rNext R%\r\r\r'   All but First:  WB Loans\r'   ------------------------\r\rFor R% = 1 To NR%\r'If SXWBLOANS(R%) > 0 Then 'borrowers, credit users 'bbh 2020/08/15\rIf XWBLOANSI(R%) > -0.0001 Then 'borrowers, credit users 'bbh 2020/08/15 use of SXWBLOANS caused oscillation\rXWBLNFOUT(R%) = SXWBLOANS(R%) * xwblnintr / 100 _\r                + SXWBLOANS(R%) / AMAX(1, xwblnrepr)\rxwblnrepaytot = xwblnrepaytot + XWBLNFOUT(R%)\r'repayments, principal plus interest, as in preprocessor\rElse 'subscriber, contributor\rMaxSub = 0.001! * GDPPOT(R%)\rXWBSUBF(R%) = Amin(MaxSub, SXWBSUBF(R%) * (1 + xwbloanr / 100))\rSXWBSUBF(R%) = XWBSUBF(R%)\rxwbnewsubtot = xwbnewsubtot + XWBSUBF(R%)\rXWBLNFOUT(R%) = XWBLNFOUTI(R%) 'bbh 2020/08/15 ; value should be 0 as set for subscribers in preprocessor\rEnd If\rNext R%\r"
  },
  {
    "Variable": "XWORKREMIT",
    "UsesVariable": "XWORKREMITIN",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XWORKREMIT",
    "UsesVariable": "XWORKREMITOUT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XWORKREMITIN",
    "UsesVariable": "XWORKREMITOUT",
    "Distance": 4,
    "Code": "\rGloSumRemitOut = 0\rCOMPLETE STRUCTURE:End Sub:7867|\r\rSub RemittancesAllbutFirstYear(NR%)\r\rGloSumRemitIn = 0\r\rFor R% = 1 To NR% 'As GDPPC rises, remittances per worker rise, both directions\r'XWORKREMITOUT(R%) = POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%)\r'XWORKREMITIN(R%) = POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%)\r'bbh 2020/08/11 begin -- note to Jose, please add values of 1 to Global Parameters for\r'   xworkmremitoutm and xworkremitinm and then can replace 2 lnes above with 2 below:\r'        XWORKREMITOUT(R%) = POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%)\r'        XWORKREMITOUT(R%) = Amin(XWORKREMITOUT(R%), 0.2 * GDP(R%)) 'bbh 2020/11/12\r'        XWORKREMITIN(R%) = POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%) * xworkremitinm(R%)\r\r'bbh 2022/10/27 start Gradually phase down remittances per worker on assumption that as incomes rise everywhere, fewer migrants will go\r'   abroad to earn remittance money versus moving as among high-income countries today; .005 should become a parameter\rIf GRPS(1, R%) = \"Timor-Leste\" Then  'Addressing what appears to be outrageous outflows in base data year (when base is 2017)\rXWORKREMITOUT(R%) = CSng(POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%) * AMAX(0.05, (1 - IY% * 0.05)))\rElse\r'XWORKREMITOUT(R%) = CSng(POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%) * AMAX(0.05, (1 - IY% * 0.01)))\r'bbh 2024/03/24 replaced 0.01 above with 0.001 below\rXWORKREMITOUT(R%) = CSng(POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%) * AMAX(0.05, (1 - IY% * 0.001)))\rEnd If\rXWORKREMITOUT(R%) = CSng(Amin(XWORKREMITOUT(R%), 0.2 * GDP(R%))) 'bbh 2020/11/12\r'XWORKREMITIN(R%) = CSng(POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%) * xworkremitinm(R%) * AMAX(0.05, (1 - IY% * 0.01)))\r'bbh 2024/03/24 replaced 0.01 above with 0.001 below\rXWORKREMITIN(R%) = CSng(POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%) * xworkremitinm(R%) * AMAX(0.05, (1 - IY% * 0.001)))\r\r'bbh 2022/10/27 end\r'bbh 2020/08/11 end\rGloSumRemitOut = GloSumRemitOut + XWORKREMITOUT(R%)\rGloSumRemitIn = GloSumRemitIn + XWORKREMITIN(R%)\rNext R%\r\rFor R% = 1 To NR% 'As GDPPC rises, remittances per worker rise, both directions\r'XWORKREMITOUT(R%) = POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%)\r'XWORKREMITIN(R%) = POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%)\r'bbh 2020/08/11 begin -- note to Jose, please add values of 1 to Global Parameters for\r'   xworkmremitoutm and xworkremitinm and then can replace 2 lnes above with 2 below:\r'        XWORKREMITOUT(R%) = POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%)\r'        XWORKREMITOUT(R%) = Amin(XWORKREMITOUT(R%), 0.2 * GDP(R%)) 'bbh 2020/11/12\r'        XWORKREMITIN(R%) = POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%) * xworkremitinm(R%)\r\r'bbh 2022/10/27 start Gradually phase down remittances per worker on assumption that as incomes rise everywhere, fewer migrants will go\r'   abroad to earn remittance money versus moving as among high-income countries today; .005 should become a parameter\rIf GRPS(1, R%) = \"Timor-Leste\" Then  'Addressing what appears to be outrageous outflows in base data year (when base is 2017)\rXWORKREMITOUT(R%) = CSng(POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%) * AMAX(0.05, (1 - IY% * 0.05)))\rElse\r'XWORKREMITOUT(R%) = CSng(POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%) * AMAX(0.05, (1 - IY% * 0.01)))\r'bbh 2024/03/24 replaced 0.01 above with 0.001 below\rXWORKREMITOUT(R%) = CSng(POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%) * AMAX(0.05, (1 - IY% * 0.001)))\rEnd If\rXWORKREMITOUT(R%) = CSng(Amin(XWORKREMITOUT(R%), 0.2 * GDP(R%))) 'bbh 2020/11/12\r'XWORKREMITIN(R%) = CSng(POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%) * xworkremitinm(R%) * AMAX(0.05, (1 - IY% * 0.01)))\r'bbh 2024/03/24 replaced 0.01 above with 0.001 below\rXWORKREMITIN(R%) = CSng(POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%) * xworkremitinm(R%) * AMAX(0.05, (1 - IY% * 0.001)))\r\r'bbh 2022/10/27 end\r'bbh 2020/08/11 end\rGloSumRemitOut = GloSumRemitOut + XWORKREMITOUT(R%)\rGloSumRemitIn = GloSumRemitIn + XWORKREMITIN(R%)\rNext R%\r\rFor R% = 1 To NR% 'As GDPPC rises, remittances per worker rise, both directions\r'XWORKREMITOUT(R%) = POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%)\r'XWORKREMITIN(R%) = POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%)\r'bbh 2020/08/11 begin -- note to Jose, please add values of 1 to Global Parameters for\r'   xworkmremitoutm and xworkremitinm and then can replace 2 lnes above with 2 below:\r'        XWORKREMITOUT(R%) = POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%)\r'        XWORKREMITOUT(R%) = Amin(XWORKREMITOUT(R%), 0.2 * GDP(R%)) 'bbh 2020/11/12\r'        XWORKREMITIN(R%) = POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%) * xworkremitinm(R%)\r\r'bbh 2022/10/27 start Gradually phase down remittances per worker on assumption that as incomes rise everywhere, fewer migrants will go\r'   abroad to earn remittance money versus moving as among high-income countries today; .005 should become a parameter\rIf GRPS(1, R%) = \"Timor-Leste\" Then  'Addressing what appears to be outrageous outflows in base data year (when base is 2017)\rXWORKREMITOUT(R%) = CSng(POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%) * AMAX(0.05, (1 - IY% * 0.05)))\rElse\r'XWORKREMITOUT(R%) = CSng(POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%) * AMAX(0.05, (1 - IY% * 0.01)))\r'bbh 2024/03/24 replaced 0.01 above with 0.001 below\rXWORKREMITOUT(R%) = CSng(POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%) * AMAX(0.05, (1 - IY% * 0.001)))\rEnd If\rXWORKREMITOUT(R%) = CSng(Amin(XWORKREMITOUT(R%), 0.2 * GDP(R%))) 'bbh 2020/11/12\r'XWORKREMITIN(R%) = CSng(POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%) * xworkremitinm(R%) * AMAX(0.05, (1 - IY% * 0.01)))\r'bbh 2024/03/24 replaced 0.01 above with 0.001 below\rXWORKREMITIN(R%) = CSng(POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%) * xworkremitinm(R%) * AMAX(0.05, (1 - IY% * 0.001)))\r\r'bbh 2022/10/27 end\r'bbh 2020/08/11 end\rGloSumRemitOut = GloSumRemitOut + XWORKREMITOUT(R%)\rGloSumRemitIn = GloSumRemitIn + XWORKREMITIN(R%)\rNext R%\r\r'    GloSumRemit = (GloSumRemitOut + GloSumRemitIn) / 2\rGloSumRemit = Amin(GloSumRemitOut, GloSumRemitIn) 'bbh 2022/06/23  Averaging was jacking up outward remittances too much, e.g. Kuwait\r\r'Probably the out migration from poor countries was rising with POP and per immigrant receipts to rise fast with GDPPC, causing recipient countries to pay out too much\rFor R% = 1 To NR%\rXWORKREMITOUT(R%) = XWORKREMITOUT(R%) * GloSumRemit / GloSumRemitOut\rXWORKREMITIN(R%) = XWORKREMITIN(R%) * GloSumRemit / GloSumRemitIn\rNext R%\r"
  },
  {
    "Variable": "XWORKREMITIN",
    "UsesVariable": "POPFOREIGNOUT",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XWORKREMITIN",
    "UsesVariable": "GDPPC",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XWORKREMITIN",
    "UsesVariable": "xworkremitinm",
    "Distance": 0,
    "Code": "\r\rFor R% = 1 To NR%\rIf POPFOREIGNIN(R%) > 0 Then 'RemitPerWorker is ratio of remittance per worker relative to GDPPC\rRemitPerWorkerOut(R%) = XWORKREMITOUT(R%) / POPFOREIGNIN(R%) / GDPPC(R%)\r'bbh 2022/12/20 Added code to DataEcon to assure that if POPFOREIGNIN>0 there is value for XWORKREMITOUT (UAE and Singapore)\rElse 'In case scenarios or code send 0.0 POPFOREIGNIN above 0 in future years\rCall XYTABL(\"GDP/Capita Versus Remittances Sent Out per Foreign Worker (2017)\",\r                    GDPPC(R%), RemitSentPerWorker, context)\rRemitPerWorkerOut(R%) = RemitSentPerWorker\rEnd If\rIf POPFOREIGNOUT(R%) > 0 Then 'RemitPerWorkerIn(R%) is ratio of remittance per worker relative to GDPPC\rRemitPerWorkerIn(R%) = XWORKREMITIN(R%) / POPFOREIGNOUT(R%) / GDPPC(R%)\rElse\rCall XYTABL(\"GDP/Capita Versus Remittances Received per Worker Abroad (2017)\",\r                    GDPPC(R%), RemitReceivedPerWorker, context)\rRemitPerWorkerIn(R%) = RemitReceivedPerWorker\rEnd If\r'If RegName$(R) = \"United Arab Emirates\" Then Stop\rNext R%\r"
  },
  {
    "Variable": "XWORKREMITOUT",
    "UsesVariable": "XWORKREMITIN",
    "Distance": 2,
    "Code": "COMPLETE STRUCTURE:End Sub:7867|\r\rSub RemittancesAllbutFirstYear(NR%)\r\rGloSumRemitIn = 0\r\rGloSumRemitOut = 0\r\rGloSumRemitOut = 0\r\rFor R% = 1 To NR% 'As GDPPC rises, remittances per worker rise, both directions\r'XWORKREMITOUT(R%) = POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%)\r'XWORKREMITIN(R%) = POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%)\r'bbh 2020/08/11 begin -- note to Jose, please add values of 1 to Global Parameters for\r'   xworkmremitoutm and xworkremitinm and then can replace 2 lnes above with 2 below:\r'        XWORKREMITOUT(R%) = POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%)\r'        XWORKREMITOUT(R%) = Amin(XWORKREMITOUT(R%), 0.2 * GDP(R%)) 'bbh 2020/11/12\r'        XWORKREMITIN(R%) = POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%) * xworkremitinm(R%)\r\r'bbh 2022/10/27 start Gradually phase down remittances per worker on assumption that as incomes rise everywhere, fewer migrants will go\r'   abroad to earn remittance money versus moving as among high-income countries today; .005 should become a parameter\rIf GRPS(1, R%) = \"Timor-Leste\" Then  'Addressing what appears to be outrageous outflows in base data year (when base is 2017)\rXWORKREMITOUT(R%) = CSng(POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%) * AMAX(0.05, (1 - IY% * 0.05)))\rElse\r'XWORKREMITOUT(R%) = CSng(POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%) * AMAX(0.05, (1 - IY% * 0.01)))\r'bbh 2024/03/24 replaced 0.01 above with 0.001 below\rXWORKREMITOUT(R%) = CSng(POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%) * AMAX(0.05, (1 - IY% * 0.001)))\rEnd If\rXWORKREMITOUT(R%) = CSng(Amin(XWORKREMITOUT(R%), 0.2 * GDP(R%))) 'bbh 2020/11/12\r'XWORKREMITIN(R%) = CSng(POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%) * xworkremitinm(R%) * AMAX(0.05, (1 - IY% * 0.01)))\r'bbh 2024/03/24 replaced 0.01 above with 0.001 below\rXWORKREMITIN(R%) = CSng(POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%) * xworkremitinm(R%) * AMAX(0.05, (1 - IY% * 0.001)))\r\r'bbh 2022/10/27 end\r'bbh 2020/08/11 end\rGloSumRemitOut = GloSumRemitOut + XWORKREMITOUT(R%)\rGloSumRemitIn = GloSumRemitIn + XWORKREMITIN(R%)\rNext R%\r\rFor R% = 1 To NR% 'As GDPPC rises, remittances per worker rise, both directions\r'XWORKREMITOUT(R%) = POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%)\r'XWORKREMITIN(R%) = POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%)\r'bbh 2020/08/11 begin -- note to Jose, please add values of 1 to Global Parameters for\r'   xworkmremitoutm and xworkremitinm and then can replace 2 lnes above with 2 below:\r'        XWORKREMITOUT(R%) = POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%)\r'        XWORKREMITOUT(R%) = Amin(XWORKREMITOUT(R%), 0.2 * GDP(R%)) 'bbh 2020/11/12\r'        XWORKREMITIN(R%) = POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%) * xworkremitinm(R%)\r\r'bbh 2022/10/27 start Gradually phase down remittances per worker on assumption that as incomes rise everywhere, fewer migrants will go\r'   abroad to earn remittance money versus moving as among high-income countries today; .005 should become a parameter\rIf GRPS(1, R%) = \"Timor-Leste\" Then  'Addressing what appears to be outrageous outflows in base data year (when base is 2017)\rXWORKREMITOUT(R%) = CSng(POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%) * AMAX(0.05, (1 - IY% * 0.05)))\rElse\r'XWORKREMITOUT(R%) = CSng(POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%) * AMAX(0.05, (1 - IY% * 0.01)))\r'bbh 2024/03/24 replaced 0.01 above with 0.001 below\rXWORKREMITOUT(R%) = CSng(POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%) * AMAX(0.05, (1 - IY% * 0.001)))\rEnd If\rXWORKREMITOUT(R%) = CSng(Amin(XWORKREMITOUT(R%), 0.2 * GDP(R%))) 'bbh 2020/11/12\r'XWORKREMITIN(R%) = CSng(POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%) * xworkremitinm(R%) * AMAX(0.05, (1 - IY% * 0.01)))\r'bbh 2024/03/24 replaced 0.01 above with 0.001 below\rXWORKREMITIN(R%) = CSng(POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%) * xworkremitinm(R%) * AMAX(0.05, (1 - IY% * 0.001)))\r\r'bbh 2022/10/27 end\r'bbh 2020/08/11 end\rGloSumRemitOut = GloSumRemitOut + XWORKREMITOUT(R%)\rGloSumRemitIn = GloSumRemitIn + XWORKREMITIN(R%)\rNext R%\r\rFor R% = 1 To NR% 'As GDPPC rises, remittances per worker rise, both directions\r'XWORKREMITOUT(R%) = POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%)\r'XWORKREMITIN(R%) = POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%)\r'bbh 2020/08/11 begin -- note to Jose, please add values of 1 to Global Parameters for\r'   xworkmremitoutm and xworkremitinm and then can replace 2 lnes above with 2 below:\r'        XWORKREMITOUT(R%) = POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%)\r'        XWORKREMITOUT(R%) = Amin(XWORKREMITOUT(R%), 0.2 * GDP(R%)) 'bbh 2020/11/12\r'        XWORKREMITIN(R%) = POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%) * xworkremitinm(R%)\r\r'bbh 2022/10/27 start Gradually phase down remittances per worker on assumption that as incomes rise everywhere, fewer migrants will go\r'   abroad to earn remittance money versus moving as among high-income countries today; .005 should become a parameter\rIf GRPS(1, R%) = \"Timor-Leste\" Then  'Addressing what appears to be outrageous outflows in base data year (when base is 2017)\rXWORKREMITOUT(R%) = CSng(POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%) * AMAX(0.05, (1 - IY% * 0.05)))\rElse\r'XWORKREMITOUT(R%) = CSng(POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%) * AMAX(0.05, (1 - IY% * 0.01)))\r'bbh 2024/03/24 replaced 0.01 above with 0.001 below\rXWORKREMITOUT(R%) = CSng(POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%) * AMAX(0.05, (1 - IY% * 0.001)))\rEnd If\rXWORKREMITOUT(R%) = CSng(Amin(XWORKREMITOUT(R%), 0.2 * GDP(R%))) 'bbh 2020/11/12\r'XWORKREMITIN(R%) = CSng(POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%) * xworkremitinm(R%) * AMAX(0.05, (1 - IY% * 0.01)))\r'bbh 2024/03/24 replaced 0.01 above with 0.001 below\rXWORKREMITIN(R%) = CSng(POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%) * xworkremitinm(R%) * AMAX(0.05, (1 - IY% * 0.001)))\r\r'bbh 2022/10/27 end\r'bbh 2020/08/11 end\rGloSumRemitOut = GloSumRemitOut + XWORKREMITOUT(R%)\rGloSumRemitIn = GloSumRemitIn + XWORKREMITIN(R%)\rNext R%\r\r'    GloSumRemit = (GloSumRemitOut + GloSumRemitIn) / 2\rGloSumRemit = Amin(GloSumRemitOut, GloSumRemitIn) 'bbh 2022/06/23  Averaging was jacking up outward remittances too much, e.g. Kuwait\r\r'Probably the out migration from poor countries was rising with POP and per immigrant receipts to rise fast with GDPPC, causing recipient countries to pay out too much\rFor R% = 1 To NR%\rXWORKREMITOUT(R%) = XWORKREMITOUT(R%) * GloSumRemit / GloSumRemitOut\rXWORKREMITIN(R%) = XWORKREMITIN(R%) * GloSumRemit / GloSumRemitIn\rNext R%\r"
  },
  {
    "Variable": "XWORKREMITOUT",
    "UsesVariable": "GDP",
    "Distance": 0,
    "Code": "\rFor R% = 1 To NR% 'As GDPPC rises, remittances per worker rise, both directions\r'XWORKREMITOUT(R%) = POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%)\r'XWORKREMITIN(R%) = POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%)\r'bbh 2020/08/11 begin -- note to Jose, please add values of 1 to Global Parameters for\r'   xworkmremitoutm and xworkremitinm and then can replace 2 lnes above with 2 below:\r'        XWORKREMITOUT(R%) = POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%)\r'        XWORKREMITOUT(R%) = Amin(XWORKREMITOUT(R%), 0.2 * GDP(R%)) 'bbh 2020/11/12\r'        XWORKREMITIN(R%) = POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%) * xworkremitinm(R%)\r\r'bbh 2022/10/27 start Gradually phase down remittances per worker on assumption that as incomes rise everywhere, fewer migrants will go\r'   abroad to earn remittance money versus moving as among high-income countries today; .005 should become a parameter\rIf GRPS(1, R%) = \"Timor-Leste\" Then  'Addressing what appears to be outrageous outflows in base data year (when base is 2017)\rXWORKREMITOUT(R%) = CSng(POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%) * AMAX(0.05, (1 - IY% * 0.05)))\rElse\r'XWORKREMITOUT(R%) = CSng(POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%) * AMAX(0.05, (1 - IY% * 0.01)))\r'bbh 2024/03/24 replaced 0.01 above with 0.001 below\rXWORKREMITOUT(R%) = CSng(POPFOREIGNIN(R%) * RemitPerWorkerOut(R%) * GDPPC(R%) * xworkremitoutm(R%) * AMAX(0.05, (1 - IY% * 0.001)))\rEnd If\rXWORKREMITOUT(R%) = CSng(Amin(XWORKREMITOUT(R%), 0.2 * GDP(R%))) 'bbh 2020/11/12\r'XWORKREMITIN(R%) = CSng(POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%) * xworkremitinm(R%) * AMAX(0.05, (1 - IY% * 0.01)))\r'bbh 2024/03/24 replaced 0.01 above with 0.001 below\rXWORKREMITIN(R%) = CSng(POPFOREIGNOUT(R%) * RemitPerWorkerIn(R%) * GDPPC(R%) * xworkremitinm(R%) * AMAX(0.05, (1 - IY% * 0.001)))\r\r'bbh 2022/10/27 end\r'bbh 2020/08/11 end\rGloSumRemitOut = GloSumRemitOut + XWORKREMITOUT(R%)\rGloSumRemitIn = GloSumRemitIn + XWORKREMITIN(R%)\rNext R%\r"
  },
  {
    "Variable": "XWORKREMITOUT",
    "UsesVariable": "POPFOREIGNIN",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XWORKREMITOUT",
    "UsesVariable": "GDPPC",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "XWORKREMITOUT",
    "UsesVariable": "xworkremitoutm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "YIELDINT",
    "UsesVariable": "YL",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "YIELDINT",
    "UsesVariable": "AGTEC",
    "Distance": 499,
    "Code": "0"
  },
  {
    "Variable": "YL",
    "UsesVariable": "ylm",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "YL",
    "UsesVariable": "YIELDINT",
    "Distance": 321,
    "Code": "0"
  },
  {
    "Variable": "YL",
    "UsesVariable": "AGTEC",
    "Distance": 29,
    "Code": "0"
  },
  {
    "Variable": "YL",
    "UsesVariable": "ylexp",
    "Distance": 124,
    "Code": "0"
  },
  {
    "Variable": "YL",
    "UsesVariable": "KAG",
    "Distance": 160,
    "Code": "0"
  },
  {
    "Variable": "YL",
    "UsesVariable": "LABS",
    "Distance": 160,
    "Code": "0"
  },
  {
    "Variable": "YL",
    "UsesVariable": "CDALF",
    "Distance": 162,
    "Code": "0"
  },
  {
    "Variable": "YL",
    "UsesVariable": "LANDIRAREAACTUAL",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "YL",
    "UsesVariable": "YLIMPACTWATPRICE",
    "Distance": 1,
    "Code": "\rIrrigatedYield(R%) = CSng(NonIrrigatedYield(R%) * 3.25)\r\rIldc(R%) = LD(R%, 1)\r\rNonIrrigatedYield(R%) = NonIrrigatedYield(R%) * (1 + SENVYLCHG(R%) / 100)\r\rNonIrrigatedCropland(R%) = (Ildc(R%) * 1000) - IrrigatedCropland(R%)\r\r'bbh 2019/04/02  Adding multiplier linked back to water price\rIf watertoyieldswitch(R%) > 0.5 Then\rIrrigatedYield(R%) = IrrigatedYield(R%) * SYlImpactWatPrice(R%)\rEnd If\r"
  },
  {
    "Variable": "YL",
    "UsesVariable": "watertoyieldswitch",
    "Distance": 1,
    "Code": "\rIrrigatedYield(R%) = CSng(NonIrrigatedYield(R%) * 3.25)\r"
  },
  {
    "Variable": "YL",
    "UsesVariable": "ENVYLCHG",
    "Distance": 2,
    "Code": "\r\r'bbh 2018/4/19 start replaced 2.35 with 3.25, Steve and I recalculated\rNonIrrigatedYield(R%) = CSng((Ildc(R%) * 1000 * YL(R%)) / (NonIrrigatedCropland(R%) + (3.25 * IrrigatedCropland(R%))))\r\r'If IY% + 2016 >= 2035 And RegName$(R%) = \"Central African Republic\" Then Stop 'bbh 2022/12/13 Important debugging line in YL calculation\r\r'bbh 2020/12/10 start Pass through of yield changes from stocks to technology term\r'  logic is upside shift in production raises longer-term productivity some portion of the boost\r'  tried similar logic on downside, but it clobbers yield and forces up land use\r'   0.8 vs 0.5 has limited impact upside\r'wv 2021/04/22 this was messing up a lot of scenarios related to the agricultural model, because it was driving up yields through technology feedbacks. therefore commented the below line out\r'SAGTEC(R%) = CSng(SAGTEC(R%) * AMAX(1.0#, Mul ^ 0.8))\r'bbh 2020/12/10 end\r\r'dsr 2015/07/01 This block adjusts actual crop yields to reflect climate change\r'If RegName$(R%) = \"Russia\" AndAlso IY% <= 3 Then Stop\r'jrs 2009/12/09\r'        elasac(R%) = -0.02\r'        YL(R%) = YL(R%) * (1 + (sco2 - ico2) / ico2 * elasac(R%))\r'BBH 2009/12/10\r' wv 2021/03/01 moved this function of env yield change downwards, so that it only affects rainfed yields, not overall yields\r'YL(R%) = YL(R%) * (1 + SENVYLCHG(R%) / 100)\r\r'sgh 2018/01/04 - start\r'need to calculate differential yields before an exogenous multiplier is applied to irrigated land\rIrrigatedCropland(R%) = IrrigatedPortionCropland(R%) * (Ildc(R%) * 1000)\r\rIldc(R%) = LD(R%, 1)\r"
  },
  {
    "Variable": "YL",
    "UsesVariable": "LD",
    "Distance": 302,
    "Code": "0"
  },
  {
    "Variable": "YL",
    "UsesVariable": "AGDEM",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "YL",
    "UsesVariable": "AGP",
    "Distance": 8,
    "Code": "0"
  },
  {
    "Variable": "YL",
    "UsesVariable": "FSTOCK",
    "Distance": 7,
    "Code": "0"
  },
  {
    "Variable": "YL",
    "UsesVariable": "GDPPC",
    "Distance": 3,
    "Code": "\r'Call ADJSTR(1.0#, GlobalSurDefRate(1), GlobalSurDefRate(1) - SGlobalSurDefRate(1), -0.2, -0.4, mul2) 'bbh 2022/11/28 Augment national balancing with global\rCall ADJSTR(wdmbase / 186, GlobalSurDefRate(1), GlobalSurDefRate(1) - SGlobalSurDefRate(1), -0.2, -0.4, Mul2) 'bbh 2022/12/13  fix PID demand base replacing above, #1 was not comparable to country PID\r\ragdstl = CSng(dstl * 1.5)\r\r'ttt 2019/10/08 TakeOut\rArray.Copy(xsfi, xsf, xsfi.Length)\rArray.Copy(msfi, msf, msfi.Length)\rArray.Copy(ZSFI, ZSF, NR + 1)\rArray.Copy(CSFI, CSF, NR + 1)\rArray.Copy(FSFI, FSF, NR + 1)\r\rFor R% = 1 To NR%\r'XSF(R%) = ConvergeOverTime(XSFI(R%), WTarConvF, 50)\r'MSF(R%) = ConvergeOverTime(MSFI(R%), WTarConvF, 50)\r'ZSF(R%) = ConvergeOverTime(ZSFI(R%), WTarConvF, 50)\r'CSF(R%) = ConvergeOverTime(CSFI(R%), WTarConvF, 50)\r'For Eritrea, big push up in CS with converenge is problem\r'sgh 2015/07/24 - xsf and msf now have second dimension START\r'xsf and msf remain constant over time; i.e., no change in ratio of monetary value to price index\r'    xsf(R%) = xsfi(R%)\r'    msf(R%) = msfi(R%)\r'ttt 2019/10/08 TakenOut\r'For f% = 1 To 3\r'    xsf(R%, f%) = xsfi(R%, f%)\r'    msf(R%, f%) = msfi(R%, f%)\r'Next f%\r''sgh 2015/07/24 - xsf and msf now have second dimension  END\r'        If gdprext(R%) > -90 Then 'bbh 2021/09/30 start; did not work, but leave block, may revisit at some point\r'            ZSFI(R%) = ZSFI(R%) * (1 + gdprext(R%) / 100) '- IGDPRCor(R%)) 'igdpr(R%))\r'        Else\r'            ZSFI(R%) = sZSFI(R%)\r'        End If 'bbh 2021/09/30 end\r'ZSF(R%) = ZSFI(R%)\r'CSF(R%) = CSFI(R%)\r''FSF(R%) = ConvergeOverTime(FSFI(R%), WTarConvF, 50)\r'FSF(R%) = FSFI(R%) 'Stock targets different, physical, monetary\r'jrs 2007/01/12 no double counting\r'dsr 2015/07/01 Compute world crop demand base and balance, where balance equals stocks\r'    (including shortages) minus desired stocks, which are a fraction of the demand base\rIf RegiontoSum(R%) Then\r'Use post-loss production to compute demand base\rwdmbase = wdmbase + sagdem(R%, 1) + SAGP(R%, 1)\rdmbase = sagdem(R%, 1) + SAGP(R%, 1)\rwbalance = wbalance + scumstk(R%, 1) - dmbase * agdstl\rEnd If\rNext R%\r\r'If IY% + 2016 >= 2035 And RegName$(R%) = \"Central African Republic\" Then Stop 'bbh 2022/12/13 Important debugging line in YL calculation\r\r'        If Abs(((byl(R%) - YlShift(R%)) - (syl(R%) * (1 + ylgrbound))) / syl(R%)) < 0.05 * YL(R%) Then\r'            YL(R%) = YL(R%) + 0.05 * Abs((byl(R%) - YlShift(R%)) - (syl(R%) * (1 + ylgrbound)))\r'        End If\r'If IY% + 2016 >= 2094 And RegName$(R%) = \"Gambia\" Then Stop\r'        If Abs((byl(R%) - YlShift(R%)) - (syl(R%) * (1 + ylgrbound)) / syl(R%)) > 0.1 * syl(R%) Then\r'            YL(R%) = Amin(byl(R%) - YlShift(R%), syl(R%) * (1 + ylgrbound)) 'it is clear-cut that should use smaller calculation\r'        Else 'when the distance is less than 10 percent, use smaller but blend a bit toward the larger to slow down transitions when they are close\r'            YL(R%) = Amin(byl(R%) - YlShift(R%), syl(R%) * (1 + ylgrbound)) + 0.1 * Abs((byl(R%) - YlShift(R%)) - (syl(R%) * (1 + ylgrbound)))\r'        End If\r\r'        byl(R%) = Amin(byl(R%), syl(R%) * (1 + ylgrbound))\r'bbh 2022/10/27 The line above was preventing any adjustments upward of yield over time to persist going forward; line below allows\r'byl(R%) = Amin((byl(R%) + syl(R%)) / 2, syl(R%) * (1 + ylgrbound)) 'bbh 2022/11/28 Need different treatment given byl versus syl\r'        If byl(R%) > syl(R%) Then 'bbh 2022/11/28 Removed this if-then block when moved to YlShift approach\r'            byl(R%) = (byl(R%) + syl(R%)) / 2\r'        Else 'byl<=syl\r'            byl(R%) = Amin((byl(R%) + syl(R%)) / 2, syl(R%) * (1 + ylgrbound))\r'        End If 'bbh 2022/11/28 please keep this commented code up to YL equation\r\r'If IY% + 2016 >= 2067 And RegName$(R%) = \"Burundi\" Then Stop\r\r'If RegName$(R%) = \"Ethiopia\" Then Stop\r'dsr 2015/07/01 Calculate initial estimate of actual crop yield as base yield times a multiplier\r'YL(R%) = byl(R%) * ylm(R%)\r'dsr 2015/07/01 Use this initial yield estimate times crop land to compute potential crop production.\r'    This is used later in trade calculations\r'        agpp(R%, 1) = YL(R%) * LD(R%, 1)\r\r'dsr 2015/07/01 This block calculates an adjustment to actual crop yields based on crop balances\r'dsr 2015/06/26 Use crop demand and post loss production from previous year to calculate crop demand base\rdmbase = sagdem(R%, 1) + SAGP(R%, 1) 'bbh 2022/10/27 This had been deactivated for some reason\r\r\r'   First Year:  Profits and Prices\r'   -------------------------------\r\rFor f% = 1 To 3\rFPROFITR(R%, f%) = 1\rsfprofitr(R%, f%) = 1\rSSFProfitR(R%, f%) = 1\rsbalance(R%, f%) = 0\rSBalanceForYl(R%) = 0 'bbh 2022/11/28\rcumstk(R%, f%) = FSTOCK(R%, f%)\rscumstk(R%, f%) = cumstk(R%, f%)\rCumStkNegOK(R%, f%) = FSTOCK(R%, f%) 'bbh 2022/10/27 Added 2 lines allowing Negative Stocks\rSCumStkNegOK(R%, f%) = CumStkNegOK(R%, f%)\rscountryextrasurdef(R%, f%) = 0  'For trade adjustment\rNext f%\r"
  },
  {
    "Variable": "YL",
    "UsesVariable": "dstl",
    "Distance": 259,
    "Code": "\r'Call ADJSTR(1.0#, GlobalSurDefRate(1), GlobalSurDefRate(1) - SGlobalSurDefRate(1), -0.2, -0.4, mul2) 'bbh 2022/11/28 Augment national balancing with global\rCall ADJSTR(wdmbase / 186, GlobalSurDefRate(1), GlobalSurDefRate(1) - SGlobalSurDefRate(1), -0.2, -0.4, Mul2) 'bbh 2022/12/13  fix PID demand base replacing above, #1 was not comparable to country PID\r"
  },
  {
    "Variable": "YL",
    "UsesVariable": "ifsexomodelid",
    "Distance": 259,
    "Code": "\r'Call ADJSTR(1.0#, GlobalSurDefRate(1), GlobalSurDefRate(1) - SGlobalSurDefRate(1), -0.2, -0.4, mul2) 'bbh 2022/11/28 Augment national balancing with global\rCall ADJSTR(wdmbase / 186, GlobalSurDefRate(1), GlobalSurDefRate(1) - SGlobalSurDefRate(1), -0.2, -0.4, Mul2) 'bbh 2022/12/13  fix PID demand base replacing above, #1 was not comparable to country PID\r"
  },
  {
    "Variable": "YL",
    "UsesVariable": "aglossprodm",
    "Distance": 4,
    "Code": "\rCall XYTABL(\"GDP/Capita (PPP 2011) Versus Crop Production Losses (Linear fixed effect)\", GDPPCP(R%), aglossprodcropfunc, context)\r\r'kbn 2017/09/13 Add multiplier aglossprodm below  'bbh 2017/09/23 revised location of multiplier\rDim aglossprodcrop = Amin(AMAX(aglossprodcropfunc * aglossprodm(R%, 1), 2), 20) 'Losses capped here\r"
  },
  {
    "Variable": "YL",
    "UsesVariable": "GDPPCP",
    "Distance": 5,
    "Code": "\rCall XYTABL(\"GDP/Capita (PPP 2011) Versus Crop Production Losses (Linear fixed effect)\", GDPPCP(R%), aglossprodcropfunc, context)\r"
  },
  {
    "Variable": "YLIMPACTWATPRICE",
    "UsesVariable": "watpricetoylelas",
    "Distance": 0,
    "Code": "COMPLETE STRUCTURE:End Sub:391|\r\rPublic Sub IfsWater1AllbutFirstYear(context As IForecastContext)\r'AllButFirst:\r\r'All But First: Wraps from previous years\r'----------------------------------------\r'ttt 2019/10/08 TakeOut\rArray.Copy(swatprice, WATPRICE, NR + 1)\rArray.Copy(sdemandsupplyratiowater, DemandSupplyRatioWater, NR + 1)\rArray.Copy(swatertotalsupply, WATERTOTALSUPPLY, NR + 1)\r\rFor R% = 1 To NR%\r'If RegName$(R%) = \"Jordan\" Then Stop\r'If RegName$(R%) = \"Saudi Arabia\" Then Stop\r'ttt 2019/10/08 TakenOut\r'WATPRICE(R%) = swatprice(R%)\rDim proportionchangeinwatprice = (swatprice(R%) - 100.0!) / 100.0!\r\r\r'\r'    swaterperHA = (WATDEMAND(R%, 3) * 1000000 / LANDIRAREAACTUAL(R%))\r'    waterperha(R%) = (WATDEMAND(R%, 3) * 1000000 / LANDIRAREAACTUAL(R%)) * (1 + (proportionchangeinwatprice * watdemandelas(R%, 3)))\r'    changeInWaterPerHA = (waterperha(R%) - swaterperHA) / swaterperHA\r'    If changeInWaterPerHA < -0.02 Then\r'        waterperha(R%) = 0.98 * swaterperHA  'Does not let water price increase drive down demand by more than 2%\r'    End If\r'\r''sgh 2018/02/13 - START\r''save ag water demand before multiplier is used so that it doesn't grow exponentially\r'    WATDEMAND(R%, 3) = waterperha(R%) * LANDIRAREAACTUAL(R%) / 1000000   'price impact adjusted\r'    swatdemandag(R%) = WATDEMAND(R%, 3)    'price impact adjusted\r'    WATDEMAND(R%, 3) = WATDEMAND(R%, 3) * waterdemandm(R%, 3)\r''sgh 2018/02/13 - END\r'\r'\r'\r''bbh 2019/04/01 the expression below needed /1000000 or inside switch multiplier was  9.99999999917733E-07\r'    'that fix now needs to be explored with yield switch on\r'    'adjustedWaterPerHA = WATDEMAND(R%, 3) / LANDIRAREAACTUAL(R%)\r'    adjustedWaterPerHA = WATDEMAND(R%, 3) * 1000000 / LANDIRAREAACTUAL(R%)\r\r'bbh 2019/04/02 start Line below was basically comparing two copies of the same number, not working\r'syl(R%) = syl(R%) * ((1 + ((adjustedWaterPerHA - waterperha(R%)) / (waterperha(R%)))) ^ 1)\r'        IrrigationWatDepend = LANDIRAREAACTUAL(R%) / (LD(R%, 1) * 1000)\r'        YlImpactWatPrice(R%) = Amin(1.5, AMAX(0.5, 1 + (proportionchangeinwatprice * IrrigationWatDepend) * watpricetoylelas(R%)))\r'    If watertoyieldswitch(R%) > 0.5 Then\r'        YLIMPACTWATPRICE(R%) = Amin(1.5, AMAX(0.5, 1 + proportionchangeinwatprice * watpricetoylelas(R%)))\r'    Else\r'        YLIMPACTWATPRICE(R%) = 1\r'        'bbh 2019/04/02 end\r'    End If\rYLIMPACTWATPRICE(R%) = CSng(Amin(1.5, AMAX(0.5, 1 + proportionchangeinwatprice * watpricetoylelas(R%))))\r"
  },
  {
    "Variable": "YLIMPACTWATPRICE",
    "UsesVariable": "WATPRICE",
    "Distance": 102,
    "Code": "COMPLETE STRUCTURE:End Sub:391|\r\rPublic Sub IfsWater1AllbutFirstYear(context As IForecastContext)\r'AllButFirst:\r\r'All But First: Wraps from previous years\r'----------------------------------------\r'ttt 2019/10/08 TakeOut\rArray.Copy(swatprice, WATPRICE, NR + 1)\rArray.Copy(sdemandsupplyratiowater, DemandSupplyRatioWater, NR + 1)\rArray.Copy(swatertotalsupply, WATERTOTALSUPPLY, NR + 1)\r\rFor R% = 1 To NR%\r'If RegName$(R%) = \"Jordan\" Then Stop\r'If RegName$(R%) = \"Saudi Arabia\" Then Stop\r'ttt 2019/10/08 TakenOut\r'WATPRICE(R%) = swatprice(R%)\rDim proportionchangeinwatprice = (swatprice(R%) - 100.0!) / 100.0!\r"
  },
  {
    "Variable": "YLIMPACTWATPRICE",
    "UsesVariable": "ifsexomodelid",
    "Distance": 0,
    "Code": "\r' wv 2020/12/17 agpy *** end updating the maximum yield***\r\rSYlImpactWatPrice(R%) = 1 'bbh 2019/04/02\r\r' wv 2021/01/27 change the calculation of syl to be based on YL(R%), and not on byl(R%)\r' wv 2021/03/29 above was a mistake because changing it to yl made the effect of ylm carry forward\r' wv 2021/03/29 temporary fix, now used SCompYl but want to change to byl(R%)\r'syl(R%) = ylhw * SCompYL(R%) + (1 - ylhw) * syl(R%)\r'bbh 2022/10/27 syl needs to be based on yl, not byl; can back out ylm effect\r'If IY% + 2016 >= 2044 And RegName$(R%) = \"Central African Republic\" Then Stop\r'bbh 2022/11/28 With movement to YlShift logic, syl computation easier and with Yl; commented next 4 lines\r'            ylhwRev = ylhw 'bbh 2022/10/27 phase out historical memory when have very low stocks; 5 lines through syl(r%)=\r'            If (CumStk(R%, 1) / (AGP(R%, 1) + AGDEM(R%, 1)) / agdstl) < 1 Then 'are below target stock level, give more weight to\r'                ylhwRev = Amin(1, ylhw * agdstl / AMAX(0.05, CumStk(R%, 1) / (AGP(R%, 1) + AGDEM(R%, 1))))\r'            End If\r'            syl(R%) = ylhwRev * YL(R%) / ylm(R%) + (1 - ylhwRev) * syl(R%)\r'syl(R%) = ylhw * YL(R%) + (1 - ylhw) * syl(R%)\r'syl(R%) = ylhw * byl(R%) + (1 - ylhw) * syl(R%)\r'bbh 2019/04/02\rSYlImpactWatPrice(R%) = YLIMPACTWATPRICE(R%)\r"
  },
  {
    "Variable": "YTHBULGE",
    "UsesVariable": "POP",
    "Distance": 2,
    "Code": "0"
  },
  {
    "Variable": "ZS",
    "UsesVariable": "VADD",
    "Distance": 0,
    "Code": "0"
  },
  {
    "Variable": "ZS",
    "UsesVariable": "FDEM",
    "Distance": 1807,
    "Code": "0"
  },
  {
    "Variable": "ZS",
    "UsesVariable": "FEDDEM",
    "Distance": 1807,
    "Code": "0"
  },
  {
    "Variable": "ZS",
    "UsesVariable": "FMDEM",
    "Distance": 1807,
    "Code": "0"
  },
  {
    "Variable": "ZS",
    "UsesVariable": "INDEM",
    "Distance": 1807,
    "Code": "0"
  },
  {
    "Variable": "ZS",
    "UsesVariable": "inputictm",
    "Distance": 79,
    "Code": "0"
  },
  {
    "Variable": "ZS",
    "UsesVariable": "inputservm",
    "Distance": 80,
    "Code": "0"
  },
  {
    "Variable": "ZS",
    "UsesVariable": "inputmanum",
    "Distance": 81,
    "Code": "0"
  },
  {
    "Variable": "ZS",
    "UsesVariable": "inputmatem",
    "Distance": 82,
    "Code": "0"
  },
  {
    "Variable": "ZS",
    "UsesVariable": "inputenerm",
    "Distance": 83,
    "Code": "0"
  },
  {
    "Variable": "ZS",
    "UsesVariable": "inputagrim",
    "Distance": 84,
    "Code": "0"
  },
  {
    "Variable": "ZS",
    "UsesVariable": "ENRGDP",
    "Distance": 86,
    "Code": "0"
  },
  {
    "Variable": "ZS",
    "UsesVariable": "GDPPC",
    "Distance": 1601,
    "Code": "0"
  },
  {
    "Variable": "ZS",
    "UsesVariable": "CLIMECONIMP",
    "Distance": 10,
    "Code": "\r'bbh 2019/03/15 start\rClimImp = CSng(Amin(0.5, (SClimEconImp(R%) - ClimEconImpI(R%)) / 100)) 'bbh 2020/02/24 2 lines\r\r\rFor S% = 1 To NSec%\r\r'  All but First 2: Update CDALF and Sectoral Alphas\r'  -------------------------------------------------\r\ralphas(R%, S%) = CDALF(R%) * salphas(R%, S%)\ralphas(R%, S%) = AMAX(0, Amin(alphas(R%, S%), 1))\r\r'  All but First 2: Determine Potential Value Added\r'  ------------------------------------------------\rIf ((S% > Ener) OrElse (S% = Agri AndAlso agon < 0.9) OrElse (S% = Ener AndAlso enon < 0.9)) Then\rvadd_k = CSng(KS(R%, S%) ^ alphas(R%, S%))\rvadd_l = CSng(LABS(R%, S%) ^ (1.0! - alphas(R%, S%)))\r'If IY >= 2 And GRPS(1, R) = \"United States of America\" And S = 5 Then Stop\rVADD(R%, S%) = cda(R%, S%) * tef(R%, S%) * vadd_k * vadd_l\rIf climeconimpsw > 0.5 Then 'bbh 2017/10/04\r'bbh 2020/02/24 start\r'   2 forces can work to offset the impact of climate change on VADD:\r'    1. tef rises becuase some of the changes, like education advance, occur even\r'        without rise in GDPPCP; the residuals pass through to productivity rise relative\r'        to scenarios without climate change turned on\r'    2. When VADD is held back, it was slowing down rise in GDPPOT, SGDPPOTPCDALF and egdppcp (above)\r'        That was causing CDALPH to rise relative to the base case\r'        (capital share is higher in less developed countries); fixed in code for SGDPPOTPCDALF\r'    But Nordhaus parameterization of impact was net of all other effects including education etc/TEF\r'    Since that effect was cutting the impact of climate change on Value added by about 1/2,\r'    I doubled it here\r'VADD(R%, S%) = VADD(R%, S%) * (1 - ClimImp * 2)\rVADD(R%, S%) = VADD(R%, S%) * (1 - ClimImp)  'bbh 2022/06/23 Removed the factor of 2 shown in RCP analysis to be overshooting impact\r'Changed the sign so that the growth rate impact shows as negative with\r'    ClimImp being postive with impact; also changed so that shows\r'    full impact magnitude climb from year 1; was just difference\r'ECGRCLIMGDP(R%, S%) = -ClimImp * 2 * 100\rECGRCLIMGDP(R%, S%) = -ClimImp * 100 'bbh 2022/06/23 Removed the factor of 2 shown in RCP analysis to be overshooting impact\rEnd If\rVADD(R%, S%) = AMAX(0.0001, Amin(VADD(R%, S%), 100000))\rElseIf S% = Agri And envylchgm(R%) < 0.01 And climeconimpsw > 0.5 Then\r'bbh 2022/06/23 Added elseIF branch to possibly add general economy impact if direct climate impact on yield is simultaneously shut down\rZS(R%, S%) = ZS(R%, S%) * (1 - ClimImp)\rEnd If\r'If RegName$(R%) = \"Ukraine\" And S% = 2 Then Stop\rNext S%\r"
  },
  {
    "Variable": "ZS",
    "UsesVariable": "YL",
    "Distance": 0,
    "Code": "\r' If RegName$(R%) = \"China\" Then Stop\r\r'dsr 2015/06/09 Convert post-loss production in quantities to post-loss production in monetary values\r'If R = 79 And IY = 18 Then Stop\r'        ZS(R%, 1) = ZSF(R%) * (AGP(R%, 1) * swapi(1) _\r'+ AGP(R%, 2) * swapi(2) _\r'+ AGP(R%, 3) * swapi(3))\r'        ZS(R%, 1) = ZSF(R%) * (AGPppl(R%, 1) * swapi(1) _\r'+ AGPppl(R%, 2) * swapi(2) _\r'+ AGPppl(R%, 3) * swapi(3)) 'bbh 2021/09/30 AGP inflates AG VADD growth too much; tried AGPppl, but went to YL below\rZS(R%, 1) = ZSF(R%) * (YL(R%) * LDI(R%, 1)) * swapi(1) 'bbh 2021/09/30 AGP inflates AG VADD growth too much\rCOMPLETE STRUCTURE:Next S%:3964|\rFor S% = 1 To NSec%\r'jrs 2022/04/06 reduced limit for Energy\r'If S% = 2 Then\r'ZS(R%, S%) = AMAX(0.00000001, ZS(R%, S%)) 'Keep minimum at same value set as minimim in\r'Else\rZS(R%, S%) = AMAX(0.0001, ZS(R%, S%)) 'Keep minimum at same value set as minimim in\r"
  },
  {
    "Variable": "ZS",
    "UsesVariable": "LD",
    "Distance": 158,
    "Code": "\r\rFor f% = 1 To 3\rswapi(f%) = WAP(f%)\rswxc(f%) = 1\rswmd(f%) = 1\rGlobalSurDefRate(f%) = 0 'bbh 2022/10/27\rSGlobalSurDefRate(f%) = 0 'bbh 2022/11/28\rWTFoodType(f%) = 0 'bbh 2022/10/27 Initialize global trade by food type\rFor R% = 1 To NR%\rWTFoodType(f%) = WTFoodType(f%) + AGX(R%, f%)\rNext R%\rNext f%\r\rFor Land% = 1 To 5\rsld(R%, Land%) = LD(R%, Land%)\rLDI(R%, Land%) = LD(R%, Land%)\r'jrs 2023/11/10\rssld(R%, Land) = LD(R%, Land)\rNext Land%\r"
  },
  {
    "Variable": "ZS",
    "UsesVariable": "WAP",
    "Distance": 113,
    "Code": "\r\rFor f% = 1 To 3\rswapi(f%) = WAP(f%)\rswxc(f%) = 1\rswmd(f%) = 1\rGlobalSurDefRate(f%) = 0 'bbh 2022/10/27\rSGlobalSurDefRate(f%) = 0 'bbh 2022/11/28\rWTFoodType(f%) = 0 'bbh 2022/10/27 Initialize global trade by food type\rFor R% = 1 To NR%\rWTFoodType(f%) = WTFoodType(f%) + AGX(R%, f%)\rNext R%\rNext f%\r"
  },
  {
    "Variable": "ZS",
    "UsesVariable": "ENP",
    "Distance": 10,
    "Code": "0"
  },
  {
    "Variable": "ZS",
    "UsesVariable": "WEPBYEAR",
    "Distance": 412,
    "Code": "0"
  }
]